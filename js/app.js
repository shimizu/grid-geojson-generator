/*! For license information please see app.js.LICENSE.txt */
(()=>{var t={5318:t=>{t.exports=function(t){return t&&t.__esModule?t:{default:t}},t.exports.default=t.exports,t.exports.__esModule=!0},8:t=>{function e(n){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(t.exports=e=function(t){return typeof t},t.exports.default=t.exports,t.exports.__esModule=!0):(t.exports=e=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.default=t.exports,t.exports.__esModule=!0),e(n)}t.exports=e,t.exports.default=t.exports,t.exports.__esModule=!0},8082:(t,e,n)=>{"use strict";n.d(e,{Z:()=>d});var r=n(600),i=n(6497);const o={transitionDuration:0},s={transitionDuration:300,transitionEasing:t=>t,transitionInterruption:r.r.BREAK},a=t=>1-(1-t)*(1-t),l=["wheel"],u=["panstart","panmove","panend"],c=["pinchstart","pinchmove","pinchend"],h=["tripanstart","tripanmove","tripanend"],p=["doubletap"],f=["keydown"];class d{constructor(t,e={}){this.ControllerState=t,this.controllerState=null,this.controllerStateProps=null,this.eventManager=null,this.transitionManager=new r.Z(t,{...e,onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)});const n=this.linearTransitionProps;this._transition=n&&{...s,transitionInterpolator:new i.Z({transitionProps:n})},this._events=null,this._interactionState={isDragging:!1},this._customEvents=[],this.onViewStateChange=null,this.onStateChange=null,this.handleEvent=this.handleEvent.bind(this),this.setProps(e)}get linearTransitionProps(){return null}set events(t){this.toggleEvents(this._customEvents,!1),this.toggleEvents(t,!0),this._customEvents=t,this.setProps(this.controllerStateProps)}finalize(){for(const t in this._events)this._events[t]&&this.eventManager.off(t,this.handleEvent);this.transitionManager.finalize()}handleEvent(t){const{ControllerState:e}=this;this.controllerState=new e({makeViewport:this.makeViewport,...this.controllerStateProps,...this._state});const n=this._eventStartBlocked;switch(t.type){case"panstart":return!n&&this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return!n&&this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"tripanstart":return!n&&this._onTriplePanStart(t);case"tripanmove":return this._onTriplePan(t);case"tripanend":return this._onTriplePanEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}getCenter(t){const{x:e,y:n}=this.controllerStateProps,{offsetCenter:r}=t;return[r.x-e,r.y-n]}isPointInBounds(t,e){const{width:n,height:r}=this.controllerStateProps;if(e&&e.handled)return!1;const i=t[0]>=0&&t[0]<=n&&t[1]>=0&&t[1]<=r;return i&&e&&e.stopPropagation(),i}isFunctionKeyPressed(t){const{srcEvent:e}=t;return Boolean(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}isDragging(){return this._interactionState.isDragging}blockEvents(t){const e=setTimeout((()=>{this._eventStartBlocked===e&&(this._eventStartBlocked=null)}),t);this._eventStartBlocked=e}setProps(t){"onViewStateChange"in t&&(this.onViewStateChange=t.onViewStateChange),"onStateChange"in t&&(this.onStateChange=t.onStateChange),"makeViewport"in t&&(this.makeViewport=t.makeViewport),"dragMode"in t&&(this.dragMode=t.dragMode),this.controllerStateProps=t,"eventManager"in t&&this.eventManager!==t.eventManager&&(this.eventManager=t.eventManager,this._events={},this.toggleEvents(this._customEvents,!0)),"transitionInterpolator"in t||(t.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(t);let{inertia:e}=t;!0===e&&(e=300),this.inertia=e;const{scrollZoom:n=!0,dragPan:r=!0,dragRotate:i=!0,doubleClickZoom:o=!0,touchZoom:s=!0,touchRotate:a=!1,keyboard:d=!0}=t,g=Boolean(this.onViewStateChange);this.toggleEvents(l,g&&n),this.toggleEvents(u,g&&(r||i)),this.toggleEvents(c,g&&(s||a)),this.toggleEvents(h,g&&a),this.toggleEvents(p,g&&o),this.toggleEvents(f,g&&d),this.scrollZoom=n,this.dragPan=r,this.dragRotate=i,this.doubleClickZoom=o,this.touchZoom=s,this.touchRotate=a,this.keyboard=d}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(t,e){this.eventManager&&t.forEach((t=>{this._events[t]!==e&&(this._events[t]=e,e?this.eventManager.on(t,this.handleEvent):this.eventManager.off(t,this.handleEvent))}))}updateViewport(t,e={},n={}){const r={...t.getViewportProps(),...e},i=this.controllerState!==t;if(this._state=t.getState(),this._setInteractionState(n),i){const t=this.controllerState?this.controllerState.getViewportProps():null;this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:t})}}_onTransition(t){this.onViewStateChange&&(t.interactionState=this._interactionState,this.onViewStateChange(t))}_setInteractionState(t){Object.assign(this._interactionState,t),this.onStateChange&&this.onStateChange(this._interactionState)}_onPanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;let n=this.isFunctionKeyPressed(t)||t.rightButton;(this.invertPan||"pan"===this.dragMode)&&(n=!n);const r=this.controllerState[n?"panStart":"rotateStart"]({pos:e});return this._panMove=n,this.updateViewport(r,o,{isDragging:!0}),!0}_onPan(t){return!!this.isDragging()&&(this._panMove?this._onPanMove(t):this._onPanRotate(t))}_onPanEnd(t){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(t):this._onPanRotateEnd(t))}_onPanMove(t){if(!this.dragPan)return!1;const e=this.getCenter(t),n=this.controllerState.pan({pos:e});return this.updateViewport(n,o,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(t){const{inertia:e}=this;if(this.dragPan&&e&&t.velocity){const n=this.getCenter(t),r=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],i=this.controllerState.pan({pos:r}).panEnd();this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:a},{isDragging:!1,isPanning:!0})}else{const t=this.controllerState.panEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(t){if(!this.dragRotate)return!1;const e=this.getCenter(t),n=this.controllerState.rotate({pos:e});return this.updateViewport(n,o,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(t){const{inertia:e}=this;if(this.dragRotate&&e&&t.velocity){const n=this.getCenter(t),r=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],i=this.controllerState.rotate({pos:r}).rotateEnd();this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:a},{isDragging:!1,isRotating:!0})}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(t){if(!this.scrollZoom)return!1;t.preventDefault();const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const{speed:n=.01,smooth:r=!1}=this.scrollZoom,{delta:i}=t;let o=2/(1+Math.exp(-Math.abs(i*n)));i<0&&0!==o&&(o=1/o);const s=this.controllerState.zoom({pos:e,scale:o});return this.updateViewport(s,{...this._getTransitionProps({around:e}),transitionDuration:r?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.rotateStart({pos:e});return this.updateViewport(n,o,{isDragging:!0}),!0}_onTriplePan(t){if(!this.touchRotate)return!1;if(!this.isDragging())return!1;const e=this.getCenter(t);e[0]-=t.deltaX;const n=this.controllerState.rotate({pos:e});return this.updateViewport(n,o,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this;if(this.touchRotate&&e&&t.velocityY){const n=this.getCenter(t),r=[n[0],n[1]+=t.velocityY*e/2],i=this.controllerState.rotate({pos:r});this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:a},{isDragging:!1,isRotating:!0}),this.blockEvents(e)}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.zoomStart({pos:e}).rotateStart({pos:e});return this._startPinchRotation=t.rotation,this._lastPinchEvent=t,this.updateViewport(n,o,{isDragging:!0}),!0}_onPinch(t){if(!this.touchZoom&&!this.touchRotate)return!1;if(!this.isDragging())return!1;let e=this.controllerState;if(this.touchZoom){const{scale:n}=t,r=this.getCenter(t);e=e.zoom({pos:r,scale:n})}if(this.touchRotate){const{rotation:n}=t;e=e.rotate({deltaAngleX:this._startPinchRotation-n})}return this.updateViewport(e,o,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),this._lastPinchEvent=t,!0}_onPinchEnd(t){if(!this.isDragging())return!1;const{inertia:e,_lastPinchEvent:n}=this;if(this.touchZoom&&e&&n&&t.scale!==n.scale){const r=this.getCenter(t);let i=this.controllerState.rotateEnd();const o=Math.log2(t.scale),s=(o-Math.log2(n.scale))/(t.deltaTime-n.deltaTime),l=Math.pow(2,o+s*e/2);i=i.zoom({pos:r,scale:l}).zoomEnd(),this.updateViewport(i,{...this._getTransitionProps({around:r}),transitionDuration:e,transitionEasing:a},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(e)}else{const t=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return this._startPinchRotation=null,this._lastPinchEvent=null,!0}_onDoubleTap(t){if(!this.doubleClickZoom)return!1;const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.isFunctionKeyPressed(t),r=this.controllerState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(r,this._getTransitionProps({around:e}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(t){if(!this.keyboard)return!1;const e=this.isFunctionKeyPressed(t),{zoomSpeed:n,moveSpeed:r,rotateSpeedX:i,rotateSpeedY:o}=this.keyboard,{controllerState:s}=this;let a;const l={};switch(t.srcEvent.code){case"Minus":a=e?s.zoomOut(n).zoomOut(n):s.zoomOut(n),l.isZooming=!0;break;case"Equal":a=e?s.zoomIn(n).zoomIn(n):s.zoomIn(n),l.isZooming=!0;break;case"ArrowLeft":e?(a=s.rotateLeft(i),l.isRotating=!0):(a=s.moveLeft(r),l.isPanning=!0);break;case"ArrowRight":e?(a=s.rotateRight(i),l.isRotating=!0):(a=s.moveRight(r),l.isPanning=!0);break;case"ArrowUp":e?(a=s.rotateUp(o),l.isRotating=!0):(a=s.moveUp(r),l.isPanning=!0);break;case"ArrowDown":e?(a=s.rotateDown(o),l.isRotating=!0):(a=s.moveDown(r),l.isPanning=!0);break;default:return!1}return this.updateViewport(a,this._getTransitionProps(),l),!0}_getTransitionProps(t){const{_transition:e}=this;return e?t?{...e,transitionInterpolator:new i.Z({...t,transitionProps:this.linearTransitionProps,makeViewport:this.controllerState.makeViewport})}:e:o}}},6883:(t,e,n)=>{"use strict";n.d(e,{U:()=>l,Z:()=>u});var r=n(4034),i=n(8082),o=n(6442),s=n(7682),a=n(5304);class l extends o.Z{constructor({makeViewport:t,width:e,height:n,latitude:r,longitude:i,zoom:o,bearing:s=0,pitch:l=0,altitude:u=1.5,maxZoom:c=20,minZoom:h=0,maxPitch:p=60,minPitch:f=0,startPanLngLat:d,startZoomLngLat:g,startRotatePos:m,startBearing:A,startPitch:y,startZoom:_,normalize:v}={}){(0,a.Z)(Number.isFinite(i)),(0,a.Z)(Number.isFinite(r)),(0,a.Z)(Number.isFinite(o)),super({width:e,height:n,latitude:r,longitude:i,zoom:o,bearing:s,pitch:l,altitude:u,maxZoom:c,minZoom:h,maxPitch:p,minPitch:f,normalize:v}),this._state={startPanLngLat:d,startZoomLngLat:g,startRotatePos:m,startBearing:A,startPitch:y,startZoom:_},this.makeViewport=t}panStart({pos:t}){return this._getUpdatedState({startPanLngLat:this._unproject(t)})}pan({pos:t,startPos:e}){const n=this._state.startPanLngLat||this._unproject(e);if(!n)return this;const r=this.makeViewport(this._viewportProps).panByPosition(n,t);return this._getUpdatedState(r)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:n=0}){const{startRotatePos:r,startBearing:i,startPitch:o}=this._state;if(!r||!Number.isFinite(i)||!Number.isFinite(o))return this;let s;return s=t?this._calculateNewPitchAndBearing({...this._getRotationParams(t,r),startBearing:i,startPitch:o}):{bearing:i+e,pitch:o+n},this._getUpdatedState(s)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:t}){return this._getUpdatedState({startZoomLngLat:this._unproject(t),startZoom:this._viewportProps.zoom})}zoom({pos:t,startPos:e,scale:n}){let{startZoom:r,startZoomLngLat:i}=this._state;Number.isFinite(r)||(r=this._viewportProps.zoom,i=this._unproject(e)||this._unproject(t));const o=this._calculateNewZoom({scale:n,startZoom:r}),s=this.makeViewport({...this._viewportProps,zoom:o});return this._getUpdatedState({zoom:o,...s.panByPosition(i,t)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(t=2){return this._zoomFromCenter(t)}zoomOut(t=2){return this._zoomFromCenter(1/t)}moveLeft(t=100){return this._panFromCenter([t,0])}moveRight(t=100){return this._panFromCenter([-t,0])}moveUp(t=100){return this._panFromCenter([0,t])}moveDown(t=100){return this._panFromCenter([0,-t])}rotateLeft(t=15){return this._getUpdatedState({bearing:this._viewportProps.bearing-t})}rotateRight(t=15){return this._getUpdatedState({bearing:this._viewportProps.bearing+t})}rotateUp(t=10){return this._getUpdatedState({pitch:this._viewportProps.pitch+t})}rotateDown(t=10){return this._getUpdatedState({pitch:this._viewportProps.pitch-t})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this._viewportProps},{bearing:r,longitude:i}=n;return Math.abs(r-e.bearing)>180&&(n.bearing=r<0?r+360:r-360),Math.abs(i-e.longitude)>180&&(n.longitude=i<0?i+360:i-360),n}_zoomFromCenter(t){const{width:e,height:n}=this._viewportProps;return this.zoom({pos:[e/2,n/2],scale:t})}_panFromCenter(t){const{width:e,height:n}=this._viewportProps;return this.pan({startPos:[e/2,n/2],pos:[e/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this._viewportProps,...this._state,...t})}_applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:i}=t;t.zoom=(0,r.uZ)(i,n,e);const{maxPitch:o,minPitch:a,pitch:l}=t;t.pitch=(0,r.uZ)(l,a,o);const{normalize:u=!0}=t;return u&&Object.assign(t,(0,s.QA)(t)),t}_unproject(t){const e=this.makeViewport(this._viewportProps);return t&&e.unproject(t)}_calculateNewZoom({scale:t,startZoom:e}){const{maxZoom:n,minZoom:i}=this._viewportProps,o=e+Math.log2(t);return(0,r.uZ)(o,i,n)}_calculateNewPitchAndBearing({deltaScaleX:t,deltaScaleY:e,startBearing:n,startPitch:i}){e=(0,r.uZ)(e,-1,1);const{minPitch:o,maxPitch:s}=this._viewportProps;let a=i;return e>0?a=i+e*(s-i):e<0&&(a=i-e*(o-i)),{pitch:a,bearing:n+180*t}}_getRotationParams(t,e){const n=t[0]-e[0],r=t[1]-e[1],i=t[1],o=e[1],{width:s,height:a}=this._viewportProps,l=n/s;let u=0;return r>0?Math.abs(a-o)>5&&(u=r/(o-a)*1.2):r<0&&o>5&&(u=1-i/o),u=Math.min(1,Math.max(-1,u)),{deltaScaleX:l,deltaScaleY:u}}}class u extends i.Z{constructor(t){t.dragMode=t.dragMode||"pan",super(l,t)}setProps(t){const e=this.controllerStateProps;super.setProps(t),(!e||e.height!==t.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...this.controllerStateProps,...this._state}))}get linearTransitionProps(){return["longitude","latitude","zoom","bearing","pitch"]}}},600:(t,e,n)=>{"use strict";n.d(e,{r:()=>o,Z:()=>a});var r=n(3630);const i=()=>{},o={BREAK:1,SNAP_TO_END:2,IGNORE:3},s={transitionEasing:t=>t,transitionInterruption:o.BREAK,onTransitionStart:i,onTransitionInterrupt:i,onTransitionEnd:i};class a{constructor(t,e={}){this.ControllerState=t,this.props={...s,...e},this.propsInTransition=null,this.transition=new r.Z(e.timeline),this.onViewStateChange=e.onViewStateChange||i,this.onStateChange=e.onStateChange||i,this._onTransitionUpdate=this._onTransitionUpdate.bind(this)}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(t){let e=!1;const n=this.props;if(t={...s,...t},this.props=t,this._shouldIgnoreViewportChange(n,t))return e;if(this._isTransitionEnabled(t)){const{interruption:r,endProps:i}=this.transition.settings,s={...n,...r===o.SNAP_TO_END?i:this.propsInTransition||n};this._triggerTransition(s,t),e=!0}else this.transition.cancel();return e}updateTransition(){this.transition.update()}_isTransitionEnabled(t){const{transitionDuration:e,transitionInterpolator:n}=t;return(e>0||"auto"===e)&&Boolean(n)}_isUpdateDueToCurrentTransition(t){return!!this.transition.inProgress&&this.transition.settings.interpolator.arePropsEqual(t,this.propsInTransition)}_shouldIgnoreViewportChange(t,e){return this.transition.inProgress?this.transition.settings.interruption===o.IGNORE||this._isUpdateDueToCurrentTransition(e):!this._isTransitionEnabled(e)||e.transitionInterpolator.arePropsEqual(t,e)}_triggerTransition(t,e){const n=new this.ControllerState(t),r=new this.ControllerState(e).shortestPathFrom(n),{transitionInterpolator:i}=e,o=i.getDuration?i.getDuration(t,e):e.transitionDuration;if(0===o)return;const s=e.transitionInterpolator.initializeProps(t,r);this.propsInTransition={},this.duration=o,this.transition.start({duration:o,easing:e.transitionEasing,interpolator:e.transitionInterpolator,interruption:e.transitionInterruption,startProps:s.start,endProps:s.end,onStart:e.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(e.onTransitionInterrupt),onEnd:this._onTransitionEnd(e.onTransitionEnd)}),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(t){return e=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),t(e)}}_onTransitionUpdate(t){const{time:e,settings:{interpolator:n,startProps:r,endProps:i,duration:o,easing:s}}=t,a=s(e/o),l=n.interpolateProps(r,i,a);this.propsInTransition=new this.ControllerState({...this.props,...l}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}}},6442:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});class r{constructor(t){this._viewportProps=this._applyConstraints(t)}getViewportProps(){return this._viewportProps}getState(){return this._state}shortestPathFrom(t){return this._viewportProps}_applyConstraints(t){return t}}},3803:(t,e,n)=>{"use strict";n.d(e,{z:()=>o,Z:()=>s});var r=n(744);let i={};function o(t){i=t}function s(t){r.Z.level>0&&i[t]&&i[t].call(...arguments)}},5361:(t,e,n)=>{"use strict";n.d(e,{M:()=>s});const r=[255,255,255],i=1;let o=0;class s{constructor(t={}){const{color:e=r}=t,{intensity:n=i}=t;this.id=t.id||"ambient-".concat(o++),this.color=e,this.intensity=n,this.type="ambient"}}},9152:(t,e,n)=>{"use strict";n.d(e,{O:()=>l});var r=n(3855);const i=[255,255,255],o=1,s=[0,0,-1];let a=0;class l{constructor(t={}){const{color:e=i}=t,{intensity:n=o}=t,{direction:l=s}=t,{_shadow:u=!1}=t;this.id=t.id||"directional-".concat(a++),this.color=e,this.intensity=n,this.type="directional",this.direction=new r.Z(l).normalize().toArray(),this.shadow=u}getProjectedLight(){return this}}},9601:(t,e,n)=>{"use strict";n.d(e,{Z:()=>_});var r=n(1731),i=n(4912),o=n(5361),s=n(9152),a=n(1215),l=n(3467),u=n(3855),c=n(3182),h=n(9830),p=n(3849),f=n(9450);class d extends c.Z{constructor(t,e){super(t,e),this.shadowMap=new i.Z(t,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new h.Z(t,{format:33189,width:1,height:1}),this.fbo=new p.Z(t,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(t){const e=this.fbo;(0,f.s8)(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},(()=>{const n=t.viewports[0],r=(0,f.w)(this.gl),i=n.width*r,o=n.height*r;i===e.width&&o===e.height||e.resize({width:i,height:o}),super.render({...t,target:e,pass:"shadow"})}))}shouldDrawLayer(t){return!1!==t.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}var g=n(3115);const m={color:[255,255,255],intensity:1},A=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],y=[0,0,0,200/255];class _ extends a.Z{constructor(t){super(t),this.ambientLight=null,this.directionalLights=[],this.pointLights=[],this.shadowColor=y,this.shadowPasses=[],this.shadowMaps=[],this.dummyShadowMap=null,this.shadow=!1,this.programManager=null;for(const e in t){const n=t[e];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some((t=>t.shadow))}preRender(t,{layers:e,layerFilter:n,viewports:o,onViewportActive:s,views:a}){if(this.shadow){this.shadowMatrices=this._createLightMatrix(),0===this.shadowPasses.length&&this._createShadowPasses(t),this.programManager||(this.programManager=r.Z.getDefaultProgramManager(t),g.Z&&this.programManager.addDefaultModule(g.Z)),this.dummyShadowMap||(this.dummyShadowMap=new i.Z(t,{width:1,height:1}));for(let t=0;t<this.shadowPasses.length;t++)this.shadowPasses[t].render({layers:e,layerFilter:n,viewports:o,onViewportActive:s,views:a,moduleParameters:{shadowLightId:t,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(t){const e=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return e.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map((e=>e.getProjectedLight({layer:t}))),pointLights:this.pointLights.map((e=>e.getProjectedLight({layer:t})))},e}cleanup(){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(g.Z),this.programManager=null)}_createLightMatrix(){const t=[];for(const e of this.directionalLights){const n=(new l.Z).lookAt({eye:new u.Z(e.direction).negate()});t.push(n)}return t}_createShadowPasses(t){for(let e=0;e<this.directionalLights.length;e++){const n=new d(t);this.shadowPasses[e]=n,this.shadowMaps[e]=n.shadowMap}}_applyDefaultLights(){const{ambientLight:t,pointLights:e,directionalLights:n}=this;t||0!==e.length||0!==n.length||(this.ambientLight=new o.M(m),this.directionalLights.push(new s.O(A[0]),new s.O(A[1])))}}},3764:(t,e,n)=>{"use strict";n.r(e),n.d(e,{AmbientLight:()=>o.M,AttributeManager:()=>N.Z,COORDINATE_SYSTEM:()=>r.Df,CompositeLayer:()=>B.Z,Controller:()=>st.Z,Deck:()=>k.Z,DeckRenderer:()=>z.Z,DirectionalLight:()=>s.O,Effect:()=>E.Z,FirstPersonController:()=>ft,FirstPersonView:()=>gt,FlyToInterpolator:()=>jt,Layer:()=>F.Z,LayerExtension:()=>kt.Z,LayerManager:()=>D.Z,LightingEffect:()=>i.Z,LinearInterpolator:()=>Ft.Z,MapController:()=>It.Z,MapView:()=>rt.Z,OrbitController:()=>yt,OrbitView:()=>xt,OrthographicController:()=>St,OrthographicView:()=>Ct,PointLight:()=>f,PostProcessEffect:()=>O,TRANSITION_EVENTS:()=>Dt.r,Tesselator:()=>Gt.Z,TransitionInterpolator:()=>Nt.Z,UNIT:()=>r.iI,View:()=>nt.Z,Viewport:()=>j.Z,WebMercatorViewport:()=>U.Z,_CameraLight:()=>g,_GlobeController:()=>Rt,_GlobeView:()=>Lt,_GlobeViewport:()=>$,_LayersPass:()=>L.Z,_SunLight:()=>w,_compareProps:()=>Xt.tg,_count:()=>qt.Q,_fillArray:()=>Zt.k,_flatten:()=>Zt.x,_memoize:()=>Wt.Z,_mergeShaders:()=>Ht.l,createIterable:()=>Vt.jB,fp64LowPart:()=>lt.Ks,gouraudLighting:()=>tt.N,log:()=>Ut.Z,phongLighting:()=>tt.s,picking:()=>Q.Z,project:()=>K.Z,project32:()=>J.Z,shadow:()=>et.Z});var r=n(4088),i=n(9601),o=n(5361),s=n(9152),a=n(8547);const l=[255,255,255],u=1,c=[0,0,1],h=[0,0,1];let p=0;class f{constructor(t={}){const{color:e=l}=t,{intensity:n=u}=t,{position:r=h}=t;this.id=t.id||"point-".concat(p++),this.color=e,this.intensity=n,this.type="point",this.position=r,this.attenuation=function(t){return"attenuation"in t?t.attenuation:"intensity"in t?[0,0,t.intensity]:c}(t),this.projectedLight={...this}}getProjectedLight({layer:t}){const{projectedLight:e}=this,n=t.context.viewport,{coordinateSystem:i,coordinateOrigin:o}=t.props,s=(0,a.D)(this.position,{viewport:n,coordinateSystem:i,coordinateOrigin:o,fromCoordinateSystem:n.isGeospatial?r.Df.LNGLAT:r.Df.CARTESIAN,fromCoordinateOrigin:[0,0,0]});return e.color=this.color,e.intensity=this.intensity,e.position=s,e}}var d=n(8771);class g extends f{getProjectedLight({layer:t}){const{projectedLight:e}=this,n=t.context.viewport,{coordinateSystem:r,coordinateOrigin:i,modelMatrix:o}=t.props,{project_uCameraPosition:s}=(0,d.C)({viewport:n,modelMatrix:o,coordinateSystem:r,coordinateOrigin:i});return e.color=this.color,e.intensity=this.intensity,e.position=s,e}}const m=Math.PI/180,A=23.4397*m;function y(t,e,n){const{azimuth:r,altitude:i}=function(t,e,n){const r=m*-n,i=m*e,o=function(t){return function(t){return t/864e5-.5+2440588}(t)-2451545}(t),s=function(t){const e=function(t){const e=t;return e+m*(1.9148*Math.sin(e)+.02*Math.sin(2*e)+3e-4*Math.sin(3*e))+102.9372*m+Math.PI}(m*(357.5291+.98560028*t));return{declination:v(e,0),rightAscension:_(e,0)}}(o),a=function(t,e){return m*(280.147+360.9856235*t)-e}(o,r)-s.rightAscension;return{azimuth:b(a,i,s.declination),altitude:x(a,i,s.declination)}}(t,e,n);return[Math.sin(r)*Math.cos(i),Math.cos(r)*Math.cos(i),-Math.sin(i)]}function _(t,e){const n=t;return Math.atan2(Math.sin(n)*Math.cos(A)-Math.tan(e)*Math.sin(A),Math.cos(n))}function v(t,e){const n=t;return Math.asin(Math.sin(e)*Math.cos(A)+Math.cos(e)*Math.sin(A)*Math.sin(n))}function b(t,e,n){const r=t,i=e,o=n;return Math.atan2(Math.sin(r),Math.cos(r)*Math.sin(i)-Math.tan(o)*Math.cos(i))}function x(t,e,n){const r=t,i=e,o=n;return Math.asin(Math.sin(i)*Math.sin(o)+Math.cos(i)*Math.cos(o)*Math.cos(r))}class w extends s.O{constructor({timestamp:t,...e}){super(e),this.timestamp=t}getProjectedLight({layer:t}){const{viewport:e}=t.context;if(e.resolution>0){const[t,e,n]=y(this.timestamp,0,0);this.direction=[t,-n,e]}else{const{latitude:t,longitude:n}=e;this.direction=y(this.timestamp,t,n)}return this}}var E=n(1215),S=n(6234),T=n(9450),P=n(6047),M=n(830);class C extends M.Z{constructor(t,e={}){super(t,e);const{module:n,fs:r,id:i}=e;this.model=new S.Z(t,{id:i,fs:r,modules:[n]})}render(t){const e=this.gl;(0,T.dR)(e,{viewport:[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}),(0,T.s8)(e,{framebuffer:t.outputBuffer,clearColor:[0,0,0,0]},(()=>this._renderPass(e,t)))}delete(){this.model.delete(),this.model=null}_renderPass(t,{inputBuffer:e,outputBuffer:n}){(0,P.Z)(t,{color:!0}),this.model.draw({moduleSettings:this.props.moduleSettings,uniforms:{texture:e,texSize:[e.width,e.height]},parameters:{depthWrite:!1,depthTest:!1}})}}var I=n(6119);class O extends E.Z{constructor(t,e={}){super(e),this.id="".concat(t.name,"-pass"),(0,I.v)(t),this.module=t}postRender(t,e){this.passes||(this.passes=function(t,e,n,r){if(e.filter||e.sampler){const i=R(e);return[new C(t,{id:n,module:e,fs:i,moduleSettings:r})]}return(e.passes||[]).map(((i,o)=>{const s=R(e,i),a="".concat(n,"-").concat(o);return new C(t,{id:a,module:e,fs:s,moduleSettings:r})}))}(t,this.module,this.id,this.props));const{target:n}=e;let r=e.inputBuffer,i=e.swapBuffer;for(let t=0;t<this.passes.length;t++){n&&t===this.passes.length-1&&(i=n),this.passes[t].render({inputBuffer:r,outputBuffer:i});const e=i;i=r,r=e}return r}cleanup(){if(this.passes){for(const t of this.passes)t.delete();this.passes=null}}}function R(t,e=t){return e.filter?(n="string"==typeof e.filter?e.filter:"".concat(t.name,"_filterColor"),"uniform sampler2D texture;\nuniform vec2 texSize;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main() {\n  vec2 texCoord = coordinate;\n\n  gl_FragColor = texture2D(texture, texCoord);\n  gl_FragColor = ".concat(n,"(gl_FragColor, texSize, texCoord);\n}\n")):e.sampler?(t=>"uniform sampler2D texture;\nuniform vec2 texSize;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main() {\n  vec2 texCoord = coordinate;\n\n  gl_FragColor = ".concat(t,"(texture, texSize, texCoord);\n}\n"))("string"==typeof e.sampler?e.sampler:"".concat(t.name,"_sampleColor")):null;var n}var L=n(3182),k=n(3452),D=n(5841),N=n(3518),F=n(4185),B=n(8918),z=n(9877),j=n(7013),U=n(6935),V=n(3467),G=n(7160),Z=n(8333);const q=Math.PI/180,W=180/Math.PI,H=6370972,X=256;class $ extends j.Z{constructor(t={}){const{latitude:e=0,longitude:n=0,zoom:r=11,nearZMultiplier:i=.1,farZMultiplier:o=2,resolution:s=10}=t;let{width:a,height:l,altitude:u=1.5}=t;a=a||1,l=l||1,u=Math.max(.75,u);const c=(new V.Z).lookAt({eye:[0,-u,0],up:[0,0,1]}),h=Math.pow(2,r);c.rotateX(e*q),c.rotateZ(-n*q),c.scale(h/l);const p=Math.atan(.5/u),f=512*h/l;super({...t,width:a,height:l,viewMatrix:c,longitude:n,latitude:e,zoom:r,fovyRadians:2*p,aspect:a/l,focalDistance:u,near:i,far:Math.min(2,1/f+1)*u*o}),this.resolution=s,this.distanceScales=function(){const t=4018225162502676e-20,e=Math.PI/180*X;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[24886.609375,24886.609375,24886.609375],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,24886.609375]}}()}get projectionMode(){return r.zG.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(t={}){const e={targetZ:t.z||0},n=this.unproject([0,this.height/2],e),r=this.unproject([this.width/2,0],e),i=this.unproject([this.width,this.height/2],e),o=this.unproject([this.width/2,this.height],e);return i[0]<this.longitude&&(i[0]+=360),n[0]>this.longitude&&(n[0]-=360),[Math.min(n[0],i[0],r[0],o[0]),Math.min(n[1],i[1],r[1],o[1]),Math.max(n[0],i[0],r[0],o[0]),Math.max(n[1],i[1],r[1],o[1])]}unproject(t,{topLeft:e=!0,targetZ:n}={}){const[r,i,o]=t,s=e?i:this.height-i,{pixelUnprojectionMatrix:a}=this;let l;if(Number.isFinite(o))l=Y(a,[r,s,o,1]);else{const t=Y(a,[r,s,-1,1]),e=Y(a,[r,s,1,1]),i=((n||0)/H+1)*X,o=G.x9(G.lu([],t,e)),u=G.x9(t),c=G.x9(e),h=(4*u*c-(o-u-c)**2)/16*4/o,p=(Math.sqrt(u-h)-Math.sqrt(Math.max(0,i*i-h)))/Math.sqrt(o);l=G.t7([],t,e,p)}const[u,c,h]=this.unprojectPosition(l);return Number.isFinite(o)?[u,c,h]:Number.isFinite(n)?[u,c,n]:[u,c]}projectPosition(t){const[e,n,r=0]=t,i=e*q,o=n*q,s=Math.cos(o),a=(r/H+1)*X;return[Math.sin(i)*s*a,-Math.cos(i)*s*a,Math.sin(o)*a]}unprojectPosition(t){const[e,n,r]=t,i=G.Zh(t),o=Math.asin(r/i);return[Math.atan2(e,-n)*W,o*W,(i/X-1)*H]}projectFlat(t){return t}unprojectFlat(t){return t}panByPosition(t,e){const n=this.unproject(e);return{longitude:t[0]-n[0]+this.longitude,latitude:t[1]-n[1]+this.latitude}}}function Y(t,e){const n=Z.fF([],e,t);return Z.bA(n,n,1/n[3]),n}var Q=n(3117),K=n(3751),J=n(3844),tt=n(7287),et=n(3115),nt=n(4897),rt=n(4009),it=n(7682),ot=n(7858),st=n(8082),at=n(6442),lt=n(5126),ut=n(3855),ct=n(4034);const ht=[0,0,0];class pt extends at.Z{constructor({width:t,height:e,position:n=ht,bearing:r=0,pitch:i=0,longitude:o,latitude:s,maxPitch:a=90,minPitch:l=-90,startRotatePos:u,startBearing:c,startPitch:h,startZoomPosition:p,startZoom:f}){super({width:t,height:e,position:n,bearing:r,pitch:i,longitude:o,latitude:s,maxPitch:a,minPitch:l}),this._state={startRotatePos:u,startBearing:c,startPitch:h,startZoomPosition:p,startZoom:f}}getDirection(t=!1){return new ot.Z({bearing:this._viewportProps.bearing,pitch:t?90:90+this._viewportProps.pitch}).toVector3().normalize()}panStart(){return this}pan(){return this}panEnd(){return this}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:n=0}){const{startRotatePos:r,startBearing:i,startPitch:o}=this._state,{width:s,height:a}=this._viewportProps;if(!r||!Number.isFinite(i)||!Number.isFinite(o))return this;let l;return l=t?{bearing:i-(t[0]-r[0])/s*180,pitch:o-(t[1]-r[1])/a*90}:{bearing:i-e,pitch:o-n},this._getUpdatedState(l)}rotateEnd(){return this._getUpdatedState({startRotatePos:null,startBearing:null,startPitch:null})}zoomStart(){return this._getUpdatedState({startZoomPosition:this._viewportProps.position,startZoom:this._viewportProps.zoom})}zoom({scale:t}){let{startZoomPosition:e}=this._state;e||(e=this._viewportProps.position);const n=this.getDirection();return this._move(n,20*Math.log2(t),e)}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}moveLeft(t=20){const e=this.getDirection(!0);return this._move(e.rotateZ({radians:Math.PI/2}),t)}moveRight(t=20){const e=this.getDirection(!0);return this._move(e.rotateZ({radians:-Math.PI/2}),t)}moveUp(t=20){const e=this.getDirection(!0);return this._move(e,t)}moveDown(t=20){const e=this.getDirection(!0);return this._move(e.negate(),t)}rotateLeft(t=15){return this._getUpdatedState({bearing:this._viewportProps.bearing-t})}rotateRight(t=15){return this._getUpdatedState({bearing:this._viewportProps.bearing+t})}rotateUp(t=10){return this._getUpdatedState({pitch:this._viewportProps.pitch+t})}rotateDown(t=10){return this._getUpdatedState({pitch:this._viewportProps.pitch-t})}zoomIn(t=2){return this.zoom({scale:t})}zoomOut(t=2){return this.zoom({scale:1/t})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this._viewportProps},{bearing:r,longitude:i}=n;return Math.abs(r-e.bearing)>180&&(n.bearing=r<0?r+360:r-360),Math.abs(i-e.longitude)>180&&(n.longitude=i<0?i+360:i-360),n}_move(t,e,n=this._viewportProps.position){const r=t.scale(e);return this._getUpdatedState({position:new ut.Z(n).add(r)})}_getUpdatedState(t){return new pt({...this._viewportProps,...this._state,...t})}_applyConstraints(t){const{pitch:e,maxPitch:n,minPitch:r,longitude:i,bearing:o}=t;return t.pitch=(0,ct.uZ)(e,r,n),(i<-180||i>180)&&(t.longitude=(0,lt.wQ)(i+180,360)-180),(o<-180||o>180)&&(t.bearing=(0,lt.wQ)(o+180,360)-180),t}}class ft extends st.Z{constructor(t){super(pt,t)}get linearTransitionProps(){return["position","pitch","bearing"]}}class dt extends j.Z{constructor(t){const{modelMatrix:e=null,bearing:n=0,pitch:r=0,up:i=[0,0,1]}=t,o=function({bearing:t,pitch:e}){return new ot.Z({bearing:t,pitch:e}).toVector3().normalize()}({bearing:n,pitch:-90===r?1e-4:90+r}),s=e?e.transformDirection(o):o,a=(0,it.Bf)(t),l=Math.pow(2,a),u=(new V.Z).lookAt({eye:[0,0,0],center:s,up:i}).scale(l);super({...t,zoom:a,viewMatrix:u})}}class gt extends nt.Z{constructor(t){super({...t,type:dt})}get controller(){return this._getControllerProps({type:ft})}}gt.displayName="FirstPersonView";const mt=[0,0,0];class At extends at.Z{constructor({makeViewport:t,width:e,height:n,rotationX:r=0,rotationOrbit:i=0,target:o=mt,zoom:s=0,minRotationX:a=-90,maxRotationX:l=90,minZoom:u=-(1/0),maxZoom:c=Infinity,startPanPosition:h,startRotatePos:p,startRotationX:f,startRotationOrbit:d,startZoomPosition:g,startZoom:m}){super({width:e,height:n,rotationX:r,rotationOrbit:i,target:o,zoom:s,minRotationX:a,maxRotationX:l,minZoom:u,maxZoom:c}),this._state={startPanPosition:h,startRotatePos:p,startRotationX:f,startRotationOrbit:d,startZoomPosition:g,startZoom:m},this.makeViewport=t}panStart({pos:t}){return this._getUpdatedState({startPanPosition:this._unproject(t)})}pan({pos:t,startPosition:e}){const n=this._state.startPanPosition||e;if(!n)return this;const r=this.makeViewport(this._viewportProps).panByPosition(n,t);return this._getUpdatedState(r)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startRotationX:this._viewportProps.rotationX,startRotationOrbit:this._viewportProps.rotationOrbit})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:n=0}){const{startRotatePos:r,startRotationX:i,startRotationOrbit:o}=this._state,{width:s,height:a}=this._viewportProps;if(!r||!Number.isFinite(i)||!Number.isFinite(o))return this;let l;if(t){let e=(t[0]-r[0])/s;const n=(t[1]-r[1])/a;(i<-90||i>90)&&(e*=-1),l={rotationX:i+180*n,rotationOrbit:o+180*e}}else l={rotationX:i+n,rotationOrbit:o+e};return this._getUpdatedState(l)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this._viewportProps},{rotationOrbit:r}=n;return Math.abs(r-e.rotationOrbit)>180&&(n.rotationOrbit=r<0?r+360:r-360),n}zoomStart({pos:t}){return this._getUpdatedState({startZoomPosition:this._unproject(t),startZoom:this._viewportProps.zoom})}zoom({pos:t,startPos:e,scale:n}){const{zoom:r}=this._viewportProps;let{startZoom:i,startZoomPosition:o}=this._state;Number.isFinite(i)||(i=r,o=this._unproject(e)||this._unproject(t));const s=this._calculateNewZoom({scale:n,startZoom:i}),a=this.makeViewport({...this._viewportProps,zoom:s});return this._getUpdatedState({zoom:s,...a.panByPosition(o,t)})}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(t=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:t})})}zoomOut(t=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/t})})}moveLeft(t=50){return this._panFromCenter([-t,0])}moveRight(t=50){return this._panFromCenter([t,0])}moveUp(t=50){return this._panFromCenter([0,-t])}moveDown(t=50){return this._panFromCenter([0,t])}rotateLeft(t=15){return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit-t})}rotateRight(t=15){return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit+t})}rotateUp(t=10){return this._getUpdatedState({rotationX:this._viewportProps.rotationX-t})}rotateDown(t=10){return this._getUpdatedState({rotationX:this._viewportProps.rotationX+t})}_unproject(t){const e=this.makeViewport(this._viewportProps);return t&&e.unproject(t)}_calculateNewZoom({scale:t,startZoom:e}){const{maxZoom:n,minZoom:r}=this._viewportProps;Number.isFinite(e)||(e=this._viewportProps.zoom);const i=e+Math.log2(t);return(0,ct.uZ)(i,r,n)}_panFromCenter(t){const{width:e,height:n,target:r}=this._viewportProps;return this.pan({startPosition:r,pos:[e/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new this.constructor({...this._viewportProps,...this._state,...t})}_applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:r,maxRotationX:i,minRotationX:o,rotationOrbit:s}=t;return t.zoom=(0,ct.uZ)(r,n,e),t.rotationX=(0,ct.uZ)(t.rotationX,o,i),(s<-180||s>180)&&(t.rotationOrbit=(0,lt.wQ)(s+180,360)-180),t}}class yt extends st.Z{constructor(t){super(At,t)}get linearTransitionProps(){return["target","zoom","rotationX","rotationOrbit"]}}const _t=Math.PI/180;function vt({height:t,focalDistance:e,orbitAxis:n,rotationX:r,rotationOrbit:i,zoom:o}){const s="Z"===n?[0,0,1]:[0,1,0],a="Z"===n?[0,-e,0]:[0,0,e],l=(new V.Z).lookAt({eye:a,up:s});l.rotateX(r*_t),"Z"===n?l.rotateZ(i*_t):l.rotateY(i*_t);const u=Math.pow(2,o)/(t||1);return l.scale(u),l}class bt extends j.Z{constructor(t){const{height:e,projectionMatrix:n,fovy:r=50,orbitAxis:i,target:o=[0,0,0],rotationX:s=0,rotationOrbit:a=0,zoom:l=0}=t,u=n?n[5]/2:(0,it.sj)(r);super({...t,longitude:null,viewMatrix:vt({height:e,focalDistance:u,orbitAxis:i,rotationX:s,rotationOrbit:a,zoom:l}),fovy:r,focalDistance:u,position:o,zoom:l}),this.projectedCenter=this.project(this.center)}unproject(t,{topLeft:e=!0}={}){const[n,r,i=this.projectedCenter[2]]=t,o=e?r:this.height-r,[s,a,l]=(0,it.CT)([n,o,i],this.pixelUnprojectionMatrix);return[s,a,l]}panByPosition(t,e){const n=this.project(t),r=[this.width/2+n[0]-e[0],this.height/2+n[1]-e[1],this.projectedCenter[2]];return{target:this.unproject(r)}}}class xt extends nt.Z{constructor(t={}){const{orbitAxis:e="Z"}=t;super({...t,orbitAxis:e,type:bt})}get controller(){return this._getControllerProps({type:yt})}}xt.displayName="OrbitView";var wt=n(1437);class Et extends At{constructor(t){super(t),this.zoomAxis=t.zoomAxis||"all"}_applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:r}=t;return t.zoom=Array.isArray(r)?[(0,ct.uZ)(r[0],n,e),(0,ct.uZ)(r[1],n,e)]:(0,ct.uZ)(r,n,e),t}_calculateNewZoom({scale:t,startZoom:e}){const{maxZoom:n,minZoom:r}=this._viewportProps;e||0===e||(e=this._viewportProps.zoom);let i=Math.log2(t);if(Array.isArray(e)){let[t,o]=e;switch(this.zoomAxis){case"X":t=(0,ct.uZ)(t+i,r,n);break;case"Y":o=(0,ct.uZ)(o+i,r,n);break;default:let e=Math.min(t+i,o+i);e<r&&(i+=r-e),e=Math.max(t+i,o+i),e>n&&(i+=n-e),t+=i,o+=i}return[t,o]}return(0,ct.uZ)(e+i,r,n)}}class St extends st.Z{constructor(t){t.dragMode=t.dragMode||"pan",super(Et,t)}_onPanRotate(t){return!1}get linearTransitionProps(){return["target","zoom"]}}const Tt=(new V.Z).lookAt({eye:[0,0,1]});function Pt({width:t,height:e,near:n,far:r}){return t=t||1,e=e||1,(new V.Z).ortho({left:-t/2,right:t/2,bottom:-e/2,top:e/2,near:n,far:r})}class Mt extends j.Z{constructor(t){const{width:e,height:n,near:r=.1,far:i=1e3,zoom:o=0,target:s=[0,0,0],flipY:a=!0}=t,l=Array.isArray(o)?o[0]:o,u=Array.isArray(o)?o[1]:o,c=Math.min(l,u),h=Math.pow(2,c);if(super({...t,longitude:null,position:s,viewMatrix:Tt.clone().scale([h,h*(a?-1:1),h]),projectionMatrix:Pt({width:e,height:n,near:r,far:i}),zoom:c}),l!==u){const t=Math.pow(2,l),e=Math.pow(2,u);this.distanceScales={unitsPerMeter:[t/h,e/h,1],metersPerUnit:[h/t,h/e,1]}}}projectFlat([t,e]){const{unitsPerMeter:n}=this.distanceScales;return[t*n[0],e*n[1]]}unprojectFlat([t,e]){const{metersPerUnit:n}=this.distanceScales;return[t*n[0],e*n[1]]}panByPosition(t,e){const n=(0,it.CT)(e,this.pixelUnprojectionMatrix),r=this.projectFlat(t),i=wt.IH([],r,wt.tk([],n));return{target:wt.IH([],this.center,i)}}}class Ct extends nt.Z{constructor(t){super({...t,type:Mt})}get controller(){return this._getControllerProps({type:St})}}Ct.displayName="OrthographicView";var It=n(6883);class Ot extends It.U{_applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:r}=t;t.zoom=(0,ct.uZ)(r,n,e);const{longitude:i,latitude:o}=t;return(i<-180||i>180)&&(t.longitude=(0,lt.wQ)(i+180,360)-180),t.latitude=(0,ct.uZ)(o,-89,89),t}}class Rt extends st.Z{constructor(t){t.dragMode=t.dragMode||"pan",super(Ot,t)}setProps(t){super.setProps(t),this.dragRotate=!1,this.touchRotate=!1}get linearTransitionProps(){return["longitude","latitude","zoom"]}}class Lt extends nt.Z{constructor(t){super({...t,type:$})}get controller(){return this._getControllerProps({type:Rt})}}Lt.displayName="GlobeView";var kt=n(3693),Dt=n(600),Nt=n(6507),Ft=n(6497);const Bt=["bearing","pitch"],zt={speed:1.2,curve:1.414};class jt extends Nt.Z{constructor(t={}){super({compare:["longitude","latitude","zoom","bearing","pitch"],extract:["width","height","longitude","latitude","zoom","bearing","pitch"],required:["width","height","latitude","longitude","zoom"]}),this.props={...zt,...t}}interpolateProps(t,e,n){const r=(0,it.if)(t,e,n,this.props);for(const i of Bt)r[i]=(0,ct.t7)(t[i]||0,e[i]||0,n);return r}getDuration(t,e){let{transitionDuration:n}=e;return"auto"===n&&(n=(0,it.up)(t,e,this.props)),n}}var Ut=n(744),Vt=n(8550),Gt=n(8005),Zt=n(1855),qt=n(5015),Wt=n(8177),Ht=n(7870),Xt=n(1761)},3518:(t,e,n)=>{"use strict";n.d(e,{Z:()=>M});var r=n(4211),i=n(6948),o=n(3478);class s{constructor(t,e){this.opts=e,this.source=t}get value(){return this.source.value}getValue(){const t=this.source.getBuffer(),e=this.getAccessor();if(t)return[t,e];const{value:n}=this.source,{size:r}=e;let i=n;if(n&&n.length!==r){i=new Float32Array(r);const t=e.elementOffset||0;for(let e=0;e<r;++e)i[e]=n[t+e]}return i}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}var a=n(6610),l=n(5126),u=n(744);function c(t){return t.stride||t.size*t.bytesPerElement}function h(t,e){e.offset&&u.Z.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=c(t),r=("vertexOffset"in e?e.vertexOffset:t.vertexOffset||0)*n+(e.elementOffset||0)*t.bytesPerElement+(t.offset||0);return{...e,offset:r,stride:n}}var p=n(5304),f=n(8550),d=n(1855);const g=[],m=[[0,1/0]];var A=n(9006);class y extends class{constructor(t,e){this.gl=t,this.id=e.id,this.size=e.size;const n=e.logicalType||e.type,o=5130===n;let{defaultValue:s}=e;s=Number.isFinite(s)?[s]:s||new Array(this.size).fill(0),e.defaultValue=s;let a=n;o?a=5126:!a&&e.isIndexed?a=t&&(0,r.U6)(t,i.h.ELEMENT_INDEX_UINT32)?5125:5123:a||(a=5126),e.logicalType=n,e.type=a;let l=function(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(n||a||5126);this.shaderAttributes={},this.doublePrecision=o,o&&!1===e.fp64&&(l=Float32Array),e.bytesPerElement=l.BYTES_PER_ELEMENT,this.defaultType=l,this.value=null,this.settings=e,this.state={externalBuffer:null,bufferAccessor:e,allocatedValue:null,constant:!1},this._buffer=null,this.setData(e)}get buffer(){if(!this._buffer){const{isIndexed:t,type:e}=this.settings;this._buffer=new o.Z(this.gl,{id:this.id,target:t?34963:34962,accessor:{type:e}})}return this._buffer}get byteOffset(){const t=this.getAccessor();return t.vertexOffset?t.vertexOffset*c(t):0}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),a.Z.release(this.state.allocatedValue)}getShaderAttributes(t,e){if(this.doublePrecision){const n={},r=this.value instanceof Float64Array,i=function(t,e){const n=h(t,e);return{high:n,low:{...n,offset:n.offset+4*t.size}}}(this.getAccessor(),e||{});return n[t]=new s(this,i.high),n["".concat(t,"64Low")]=r?new s(this,i.low):new Float32Array(this.size),n}if(e){const n=h(this.getAccessor(),e);return{[t]:new s(this,n)}}return{[t]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}setData(t){const{state:e}=this;ArrayBuffer.isView(t)?t={value:t}:t instanceof o.Z&&(t={buffer:t});const n={...this.settings,...t};if(e.bufferAccessor=n,t.constant){let n=t.value;if(n=this._normalizeValue(n,[],0),this.settings.normalized&&(n=this._normalizeConstant(n)),e.constant&&this._areValuesEqual(n,this.value))return!1;e.externalBuffer=null,e.constant=!0,this.value=n}else if(t.buffer){const r=t.buffer;e.externalBuffer=r,e.constant=!1,this.value=t.value;const i=t.value instanceof Float64Array;n.type=t.type||r.accessor.type,n.bytesPerElement=r.accessor.BYTES_PER_ELEMENT*(i?2:1),n.stride=c(n)}else if(t.value){this._checkExternalBuffer(t);let r=t.value;e.externalBuffer=null,e.constant=!1,this.value=r,n.bytesPerElement=r.BYTES_PER_ELEMENT,n.stride=c(n);const{buffer:i,byteOffset:o}=this;this.doublePrecision&&r instanceof Float64Array&&(r=(0,l.TK)(r,n));const s=r.byteLength+o+2*n.stride;i.byteLength<s&&i.reallocate(s),i.setAccessor(null),i.subData({data:r,offset:o}),n.type=t.type||i.accessor.type}return!0}updateSubBuffer(t={}){const{value:e}=this,{startOffset:n=0,endOffset:r}=t;this.buffer.subData({data:this.doublePrecision&&e instanceof Float64Array?(0,l.TK)(e,{size:this.size,startIndex:n,endIndex:r}):e.subarray(n,r),offset:n*e.BYTES_PER_ELEMENT+this.byteOffset})}allocate({numInstances:t,copy:e=!1}){const{state:n}=this,r=n.allocatedValue,i=a.Z.allocate(r,t+1,{size:this.size,type:this.defaultType,copy:e});this.value=i;const{buffer:o,byteOffset:s}=this;return o.byteLength<i.byteLength+s&&(o.reallocate(i.byteLength+s),e&&r&&o.subData({data:r instanceof Float64Array?(0,l.TK)(r,this):r,offset:s})),n.allocatedValue=i,n.constant=!1,n.externalBuffer=null,n.bufferAccessor=this.settings,!0}_checkExternalBuffer(t){const{value:e}=t;if(!t.constant&&e){const n=this.defaultType;let r=!1;if(this.doublePrecision&&(r=e.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(e.constructor.name));e instanceof n||!this.settings.normalized||"normalized"in t||u.Z.warn("Attribute ".concat(this.id," is normalized"))()}}_normalizeConstant(t){switch(this.settings.type){case 5120:return new Float32Array(t).map((t=>(t+128)/255*2-1));case 5122:return new Float32Array(t).map((t=>(t+32768)/65535*2-1));case 5121:return new Float32Array(t).map((t=>t/255));case 5123:return new Float32Array(t).map((t=>t/65535));default:return t}}_normalizeValue(t,e,n){const{defaultValue:r,size:i}=this.settings;if(Number.isFinite(t))return e[n]=t,e;if(!t)return e[n]=r[0],e;switch(i){case 4:e[n+3]=Number.isFinite(t[3])?t[3]:r[3];case 3:e[n+2]=Number.isFinite(t[2])?t[2]:r[2];case 2:e[n+1]=Number.isFinite(t[1])?t[1]:r[1];case 1:e[n+0]=Number.isFinite(t[0])?t[0]:r[0];break;default:let o=i;for(;--o>=0;)e[n+o]=Number.isFinite(t[o])?t[o]:r[o]}return e}_areValuesEqual(t,e){if(!t||!e)return!1;const{size:n}=this;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}}{constructor(t,e={}){super(t,e);const{transition:n=!1,noAlloc:r=!1,update:i=null,accessor:o=null,transform:s=null,startIndices:a=null}=e;Object.assign(this.settings,{transition:n,noAlloc:r,update:i||o&&this._autoUpdater,accessor:o,transform:s}),Object.assign(this.state,{lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:m,startIndices:a}),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(t){this.state.startIndices=t}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:t=!1}={}){const e=this.state.needsRedraw;return this.state.needsRedraw=e&&!t,e}getUpdateTriggers(){const{accessor:t}=this.settings;return[this.id].concat("function"!=typeof t&&t||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(t){if(!t||!this.supportsTransition())return null;const{accessor:e}=this.settings,n=this.settings.transition,r=Array.isArray(e)?t[e.find((e=>t[e]))]:t[e];return(0,A.M0)(r,n)}setNeedsUpdate(t=this.id,e){if(this.state.needsUpdate=this.state.needsUpdate||t,this.setNeedsRedraw(t),e){const{startRow:t=0,endRow:n=1/0}=e;this.state.updateRanges=function(t,e){if(t===m)return t;if(e[0]<0&&(e[0]=0),e[0]>=e[1])return t;const n=[],r=t.length;let i=0;for(let o=0;o<r;o++){const r=t[o];r[1]<e[0]?(n.push(r),i=o+1):r[0]>e[1]?n.push(r):e=[Math.min(r[0],e[0]),Math.max(r[1],e[1])]}return n.splice(i,0,e),n}(this.state.updateRanges,[t,n])}else this.state.updateRanges=m}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=g}setNeedsRedraw(t=this.id){this.state.needsRedraw=this.state.needsRedraw||t}update(t){this.setData(t)}allocate(t){const{state:e,settings:n}=this;return!n.noAlloc&&!!n.update&&(super.allocate({numInstances:t,copy:e.updateRanges!==m}),!0)}updateBuffer({numInstances:t,data:e,props:n,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:i},settings:{update:o,noAlloc:s}}=this;let a=!0;if(o){for(const[s,a]of i)o.call(r,this,{data:e,startRow:s,endRow:a,props:n,numInstances:t});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[e,n]of i){const r=Number.isFinite(e)?this.getVertexOffset(e):0,i=Number.isFinite(n)?this.getVertexOffset(n):s||!Number.isFinite(t)?this.value.length:t*this.size;super.updateSubBuffer({startOffset:r,endOffset:i})}this._checkAttributeArray()}else a=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),a}setConstantValue(t){return void 0!==t&&"function"!=typeof t&&(this.setData({constant:!0,value:t})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(t){const{state:e}=this;return t?(this.clearNeedsUpdate(),e.lastExternalBuffer===t||(e.lastExternalBuffer=t,this.setNeedsRedraw(),this.setData(t)),!0):(e.lastExternalBuffer=null,!1)}setBinaryValue(t,e=null){const{state:n,settings:r}=this;if(!t)return n.binaryValue=null,n.binaryAccessor=null,!1;if(r.noAlloc)return!1;if(n.binaryValue===t)return this.clearNeedsUpdate(),!0;if(n.binaryValue=t,this.setNeedsRedraw(),ArrayBuffer.isView(t)&&(t={value:t}),r.transform||e!==this.startIndices){(0,p.Z)(ArrayBuffer.isView(t.value),"invalid ".concat(r.accessor));const i=t.size&&t.size!==this.size;return n.binaryAccessor=(0,f.jr)(t.value,{size:t.size||this.size,stride:t.stride,offset:t.offset,startIndices:e,nested:i}),!1}return this.clearNeedsUpdate(),this.setData(t),!0}getVertexOffset(t){const{startIndices:e}=this;return(e?e[t]:t)*this.size}getShaderAttributes(){const t=this.settings.shaderAttributes||{[this.id]:null},e={};for(const n in t)Object.assign(e,super.getShaderAttributes(n,t[n]));return e}_autoUpdater(t,{data:e,startRow:n,endRow:r,props:i,numInstances:o}){if(t.constant)return;const{settings:s,state:a,value:l,size:u,startIndices:c}=t,{accessor:h,transform:g}=s,m=a.binaryAccessor||("function"==typeof h?h:i[h]);(0,p.Z)("function"==typeof m,'accessor "'.concat(h,'" is not a function'));let A=t.getVertexOffset(n);const{iterable:y,objectInfo:_}=(0,f.jB)(e,n,r);for(const e of y){_.index++;let n=m(e,_);if(g&&(n=g.call(this,n)),c){const e=(_.index<c.length-1?c[_.index+1]:o)-c[_.index];if(n&&Array.isArray(n[0])){let e=A;for(const r of n)t._normalizeValue(r,l,e),e+=u}else n&&n.length>u?l.set(n,A):(t._normalizeValue(n,_.target,0),(0,d.k)({target:l,source:_.target,start:A,count:e}));A+=e*u}else t._normalizeValue(n,l,A),A+=u}}_validateAttributeUpdaters(){const{settings:t}=this;if(!t.noAlloc&&"function"!=typeof t.update)throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:t}=this,e=Math.min(4,this.size);if(t&&t.length>=e){let n=!0;switch(e){case 4:n=n&&Number.isFinite(t[3]);case 3:n=n&&Number.isFinite(t[2]);case 2:n=n&&Number.isFinite(t[1]);case 1:n=n&&Number.isFinite(t[0]);break;default:n=!1}if(!n)throw new Error("Illegal attribute generated for ".concat(this.id))}}}var _=n(3803),v=n(3346),b=n(3630);var x=n(1953),w=n(4912),E=n(3849);const S={interpolation:class{constructor({gl:t,attribute:e,timeline:n}){this.gl=t,this.type="interpolation",this.transition=new b.Z(n),this.attribute=e,this.attributeInTransition=new y(t,e.settings),this.currentStartIndices=e.startIndices,this.currentLength=0,this.transform=function(t,e){const n=(0,A.w)(e.size);return new v.Z(t,{vs:"\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n",defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}(t,e);const r={byteLength:0,usage:35050};this.buffers=[new o.Z(t,r),new o.Z(t,r)]}get inProgress(){return this.transition.inProgress}start(t,e){if(t.duration<=0)return void this.transition.cancel();const{gl:n,buffers:r,attribute:i}=this;(0,A.DY)(r);const o={numInstances:e,attribute:i,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const t of r)(0,A.IV)({buffer:t,...o});this.currentStartIndices=i.startIndices,this.currentLength=(0,A.pi)(i,e),this.attributeInTransition.update({buffer:r[1],value:i.value}),this.transition.start(t),this.transform.update({elementCount:Math.floor(this.currentLength/i.size),sourceBuffers:{aFrom:r[0],aTo:(0,A.AQ)(n,i)},feedbackBuffers:{vCurrent:r[1]}})}update(){const t=this.transition.update();if(t){const{time:t,settings:{duration:e,easing:n}}=this.transition,r=n(t/e);this.transform.run({uniforms:{time:r}})}return t}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete()}},spring:class{constructor({gl:t,attribute:e,timeline:n}){this.gl=t,this.type="spring",this.transition=new b.Z(n),this.attribute=e,this.attributeInTransition=new y(t,{...e.settings,normalized:!1}),this.currentStartIndices=e.startIndices,this.currentLength=0,this.texture=function(t){return new w.Z(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(t),this.framebuffer=function(t,e){return new E.Z(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}(t,this.texture),this.transform=function(t,e,n){const r=(0,A.w)(e.size);return new v.Z(t,{framebuffer:n,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}(t,e,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new o.Z(t,r),new o.Z(t,r),new o.Z(t,r)]}get inProgress(){return this.transition.inProgress}start(t,e){const{gl:n,buffers:r,attribute:i}=this,o={numInstances:e,attribute:i,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const t of r)(0,A.IV)({buffer:t,...o});this.currentStartIndices=i.startIndices,this.currentLength=(0,A.pi)(i,e),this.attributeInTransition.update({buffer:r[1],value:i.value}),this.transition.start(t),this.transform.update({elementCount:Math.floor(this.currentLength/i.size),sourceBuffers:{aTo:(0,A.AQ)(n,i)}})}update(){const{buffers:t,transform:e,framebuffer:n,transition:r}=this;return!!r.update()&&(e.update({sourceBuffers:{aPrev:t[0],aCur:t[1]},feedbackBuffers:{vNext:t[2]}}),e.run({framebuffer:n,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:r.settings.stiffness,damping:r.settings.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),(0,A.DY)(t),this.attributeInTransition.update({buffer:t[1],value:this.attribute.value}),(0,x.z6)(n)[0]>0||r.end(),!0)}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete();this.texture.delete(),this.texture=null,this.framebuffer.delete(),this.framebuffer=null}}};class T{constructor(t,{id:e,timeline:n}){this.id=e,this.gl=t,this.timeline=n,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=v.Z.isSupported(t)}finalize(){for(const t in this.transitions)this._removeTransition(t)}update({attributes:t,transitions:e,numInstances:n}){this.numInstances=n||1;for(const n in t){const r=t[n],i=r.getTransitionSetting(e);i&&this._updateAttribute(n,r,i)}for(const n in this.transitions){const r=t[n];r&&r.getTransitionSetting(e)||this._removeTransition(n)}}hasAttribute(t){const e=this.transitions[t];return e&&e.inProgress}getAttributes(){const t={};for(const e in this.transitions){const n=this.transitions[e];n.inProgress&&(t[e]=n.attributeInTransition)}return t}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const t in this.transitions)this.transitions[t].update()&&(this.needsRedraw=!0);const t=this.needsRedraw;return this.needsRedraw=!1,t}_removeTransition(t){this.transitions[t].cancel(),delete this.transitions[t]}_updateAttribute(t,e,n){const r=this.transitions[t];let i=!r||r.type!==n.type;if(i){if(!this.isSupported)return void u.Z.warn("WebGL2 not supported by this browser. Transition for ".concat(t," is disabled."))();r&&this._removeTransition(t);const o=S[n.type];o?this.transitions[t]=new o({attribute:e,timeline:this.timeline,gl:this.gl}):(u.Z.error("unsupported transition type '".concat(n.type,"'"))(),i=!1)}(i||e.needsRedraw())&&(this.needsRedraw=!0,this.transitions[t].start(n,this.numInstances))}}const P="attributeManager.invalidate";class M{constructor(t,{id:e="attribute-manager",stats:n,timeline:r}={}){this.id=e,this.gl=t,this.attributes={},this.updateTriggers={},this.accessors={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new T(t,{id:"".concat(e,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const t in this.attributes)this.attributes[t].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(t={clearRedrawFlags:!1}){const e=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!t.clearRedrawFlags,e&&this.id}setNeedsRedraw(t=!0){return this.needsRedraw=!0,this}add(t,e){this._add(t,e)}addInstanced(t,e){this._add(t,e,{instanced:1})}remove(t){for(let e=0;e<t.length;e++){const n=t[e];void 0!==this.attributes[n]&&(this.attributes[n].delete(),delete this.attributes[n])}}invalidate(t,e){const n=this._invalidateTrigger(t,e);(0,_.Z)(P,this,t,n)}invalidateAll(t){for(const e in this.attributes)this.attributes[e].setNeedsUpdate(e,t);(0,_.Z)(P,this,"all")}update({data:t,numInstances:e,startIndices:n=null,transitions:r,props:i={},buffers:o={},context:s={}}={}){let a=!1;(0,_.Z)("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const r in this.attributes){const l=this.attributes[r],c=l.settings.accessor;l.startIndices=n,i[r]&&u.Z.removed("props.".concat(r),"data.attributes.".concat(r))(),l.setExternalBuffer(o[r])||l.setBinaryValue(o[c],t.startIndices)||!o[c]&&l.setConstantValue(i[c])||l.needsUpdate()&&(a=!0,this._updateAttribute({attribute:l,numInstances:e,data:t,props:i,context:s})),this.needsRedraw|=l.needsRedraw()}a&&(0,_.Z)("attributeManager.updateEnd",this,e),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:e,transitions:r})}updateTransition(){const{attributeTransitionManager:t}=this,e=t.run();return this.needsRedraw=this.needsRedraw||e,e}getAttributes(){return this.attributes}getChangedAttributes(t={clearChangedFlags:!1}){const{attributes:e,attributeTransitionManager:n}=this,r={...n.getAttributes()};for(const i in e){const o=e[i];o.needsRedraw(t)&&!n.hasAttribute(i)&&(r[i]=o)}return r}getShaderAttributes(t,e={}){t||(t=this.getAttributes());const n={};for(const r in t)e[r]||Object.assign(n,t[r].getShaderAttributes());return n}getAccessors(){return this.updateTriggers}_add(t,e,n={}){e&&u.Z.warn("AttributeManager.add({updaters}) - updater map no longer supported")();for(const e in t){const r=t[e];this.attributes[e]=this._createAttribute(e,r,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(t,e,n){const r={...e,id:t,isIndexed:e.isIndexed||e.elements||!1,constant:e.constant||!1,size:(e.elements?1:e.size)||1,value:e.value||null,divisor:e.instanced||n.instanced?1:e.divisor||0};return new y(this.gl,r)}_mapUpdateTriggersToAttributes(){const t={};for(const e in this.attributes)this.attributes[e].getUpdateTriggers().forEach((n=>{t[n]||(t[n]=[]),t[n].push(e)}));this.updateTriggers=t}_invalidateTrigger(t,e){const{attributes:n,updateTriggers:r}=this,i=r[t];return i&&i.forEach((t=>{const r=n[t];r&&r.setNeedsUpdate(r.id,e)})),i}_updateAttribute(t){const{attribute:e,numInstances:n}=t;(0,_.Z)("attribute.updateStart",e),e.constant?e.setConstantValue(e.value):(e.allocate(n)&&(0,_.Z)("attribute.allocate",e,n),e.updateBuffer(t)&&(this.needsRedraw=!0,(0,_.Z)("attribute.updateEnd",e,n)))}}},9006:(t,e,n)=>{"use strict";function r({source:t,target:e,start:n=0,end:r,size:i,getData:o}){r=r||e.length;const s=t.length,a=r-n;if(s>a)return void e.set(t.subarray(0,a),n);if(e.set(t,n),!o)return;let l=s;for(;l<a;){const r=o(l,t);for(let t=0;t<i;t++)e[n+l]=r[t]||0,l++}}n.d(e,{DY:()=>l,pi:()=>u,w:()=>a,AQ:()=>s,M0:()=>o,IV:()=>c});const i={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function o(t,e){return t?(Number.isFinite(t)&&(t={duration:t}),t.type=t.type||"interpolation",{...i[t.type],...e,...t}):null}function s(t,e){return e.getBuffer()?[e.getBuffer(),{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function a(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function l(t){t.push(t.shift())}function u(t,e){const{doublePrecision:n,settings:r,value:i,size:o}=t,s=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*o)*s}function c({buffer:t,numInstances:e,attribute:n,fromLength:i,fromStartIndices:o,getData:s=(t=>t)}){const a=n.doublePrecision&&n.value instanceof Float64Array?2:1,l=n.size*a,c=n.byteOffset,h=n.startIndices,p=o&&h,f=u(n,e),d=n.state.constant;if(!p&&i>=f)return;const g=d?n.value:n.getBuffer().getData({srcByteOffset:c});if(n.settings.normalized&&!d){const t=s;s=(e,r)=>n._normalizeConstant(t(e,r))}const m=d?(t,e)=>s(g,e):(t,e)=>s(g.subarray(t,t+l),e),A=t.getData({length:i}),y=new Float32Array(f);!function({source:t,target:e,size:n,getData:i,sourceStartIndices:o,targetStartIndices:s}){if(!Array.isArray(s))return r({source:t,target:e,size:n,getData:i}),e;let a=0,l=0;const u=i&&((t,e)=>i(t+l,e)),c=Math.min(o.length,s.length);for(let i=1;i<c;i++){const c=o[i]*n,h=s[i]*n;r({source:t.subarray(a,c),target:e,start:l,end:h,size:n,getData:u}),a=c,l=h}l<e.length&&r({source:[],target:e,start:l,size:n,getData:u})}({source:A,target:y,sourceStartIndices:o,targetStartIndices:h,size:l,getData:m}),t.byteLength<y.byteLength+c&&t.reallocate(y.byteLength+c),t.subData({data:y,offset:c})}},8918:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(4185),i=n(3803),o=n(1855);class s extends r.Z{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every((t=>t.isLoaded))}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo({info:t}){const{object:e}=t;return e&&e.__source&&e.__source.parent&&e.__source.parent.id===this.id?(t.object=e.__source.object,t.index=e.__source.index,t):t}renderLayers(){return null}filterSubLayer(t){return!0}shouldRenderSubLayer(t,e){return e&&e.length}getSubLayerClass(t,e){const{_subLayerProps:n}=this.props;return n&&n[t]&&n[t].type||e}getSubLayerRow(t,e,n){return t.__source={parent:this,object:e,index:n},t}getSubLayerAccessor(t){if("function"==typeof t){const e={data:this.props.data,target:[]};return(n,r)=>n&&n.__source?(e.index=n.__source.index,t(n.__source.object,e)):t(n,r)}return t}getSubLayerProps(t={}){const{opacity:e,pickable:n,visible:r,parameters:i,getPolygonOffset:o,highlightedObjectIndex:s,autoHighlight:a,highlightColor:l,coordinateSystem:u,coordinateOrigin:c,wrapLongitude:h,positionFormat:p,modelMatrix:f,extensions:d,fetch:g,_subLayerProps:m}=this.props,A={opacity:e,pickable:n,visible:r,parameters:i,getPolygonOffset:o,highlightedObjectIndex:s,autoHighlight:a,highlightColor:l,coordinateSystem:u,coordinateOrigin:c,wrapLongitude:h,positionFormat:p,modelMatrix:f,extensions:d,fetch:g},y=m&&m[t.id],_=y&&y.updateTriggers,v=t.id||"sublayer";if(y){const e=this.constructor._propTypes,n=t.type?t.type._propTypes:{};for(const t in y){const r=n[t]||e[t];r&&"accessor"===r.type&&(y[t]=this.getSubLayerAccessor(y[t]))}}Object.assign(A,t,y),A.id="".concat(this.props.id,"-").concat(v),A.updateTriggers={all:this.props.updateTriggers.all,...t.updateTriggers,..._};for(const t of d){const e=t.getSubLayerProps.call(this,t);e&&Object.assign(A,e,{updateTriggers:Object.assign(A.updateTriggers,e.updateTriggers)})}return A}_updateAutoHighlight(t){for(const e of this.getSubLayers())e.updateAutoHighlight(t)}_getAttributeManager(){return null}_renderLayers(){let{subLayers:t}=this.internalState;const e=!t||this.needsUpdate();e&&(t=this.renderLayers(),t=(0,o.x)(t,Boolean),this.internalState.subLayers=t),(0,i.Z)("compositeLayer.renderLayers",this,e,t);for(const e of t)e.parent=this}}s.layerName="CompositeLayer"},4088:(t,e,n)=>{"use strict";n.d(e,{Df:()=>i,zG:()=>o,iI:()=>s,FP:()=>a});var r=n(744);const i={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(i,"IDENTITY",{get:()=>r.Z.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")()||0});const o={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},s={common:0,meters:1,pixels:2},a={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}}},9877:(t,e,n)=>{"use strict";n.d(e,{Z:()=>l});var r=n(3803),i=n(3182);class o extends i.Z{}var s=n(930),a=n(3849);class l{constructor(t){this.gl=t,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new o(t),this.pickLayersPass=new s.Z(t),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(t){"layerFilter"in t&&this.layerFilter!==t.layerFilter&&(this.layerFilter=t.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in t&&this.drawPickingColors!==t.drawPickingColors&&(this.drawPickingColors=t.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(t){const e=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;t.layerFilter=t.layerFilter||this.layerFilter,t.effects=t.effects||[],t.target=t.target||a.Z.getDefaultFramebuffer(this.gl),this._preRender(t.effects,t);const n=this.lastPostProcessEffect?this.renderBuffers[0]:t.target,i=e.render({...t,target:n});this._postRender(t.effects,t),this.renderCount++,(0,r.Z)("deckRenderer.renderLayers",this,i,t)}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}finalize(){const{renderBuffers:t}=this;for(const e of t)e.delete();t.length=0}_preRender(t,e){let n=null;for(const r of t)r.preRender(this.gl,e),r.postRender&&(n=r);n&&this._resizeRenderBuffers(),this.lastPostProcessEffect=n}_resizeRenderBuffers(){const{renderBuffers:t}=this;0===t.length&&t.push(new a.Z(this.gl),new a.Z(this.gl));for(const e of t)e.resize()}_postRender(t,e){const{renderBuffers:n}=this,r={inputBuffer:n[0],swapBuffer:n[1],target:null};for(const i of t)if(i.postRender){if(i===this.lastPostProcessEffect){r.target=e.target,i.postRender(this.gl,r);break}const t=i.postRender(this.gl,r);r.inputBuffer=t,r.swapBuffer=t===n[0]?n[1]:n[0]}}}},3452:(t,e,n)=>{"use strict";n.d(e,{Z:()=>q});var r=n(5841),i=n(6871),o=n(744),s=n(1855);class a{constructor(t={}){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=t.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="Initial render",this._needsUpdate=!0,this._eventManager=t.eventManager,this._eventCallbacks={onViewStateChange:t.onViewStateChange,onInteractionStateChange:t.onInteractionStateChange},Object.seal(this),this.setProps(t)}finalize(){for(const t in this.controllers)this.controllers[t]&&this.controllers[t].finalize();this.controllers={}}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t,this._needsRedraw=this._needsRedraw||t}updateViewStates(){for(const t in this.controllers){const e=this.controllers[t];e&&e.updateTransition()}}getViewports(t){return t?this._viewports.filter((e=>e.containsPixel(t))):this._viewports}getViews(){const t={};return this.views.forEach((e=>{t[e.id]=e})),t}getView(t){return"string"==typeof t?this.views.find((e=>e.id===t)):t}getViewState(t){const e=this.getView(t),n=e&&this.viewState[e.getViewStateId()]||this.viewState;return e?e.filterViewState(n):n}getViewport(t){return this._viewportMap[t]}unproject(t,e){const n=this.getViewports(),r={x:t[0],y:t[1]};for(let i=n.length-1;i>=0;--i){const o=n[i];if(o.containsPixel(r)){const n=t.slice();return n[0]-=o.x,n[1]-=o.y,o.unproject(n,e)}}return null}setProps(t){"views"in t&&this._setViews(t.views),"viewState"in t&&this._setViewState(t.viewState),("width"in t||"height"in t)&&this._setSize(t.width,t.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(t,e){t===this.width&&e===this.height||(this.width=t,this.height=e,this.setNeedsUpdate("Size changed"))}_setViews(t){t=(0,s.x)(t,Boolean),this._diffViews(t,this.views)&&this.setNeedsUpdate("views changed"),this.views=t}_setViewState(t){t?(!(0,i.v)(t,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=t):o.Z.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(t,e){e.viewId=t,this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange(e)}_createController(t,e){return new(0,e.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,e.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:e=>t._getViewport(e,{width:e.width,height:e.height}),...e})}_updateController(t,e,n,r){let i=t.controller;return i?(i={...e,...t.props,...i,id:t.id,x:n.x,y:n.y,width:n.width,height:n.height},r?r.setProps(i):r=this._createController(t,i),r):null}_rebuildViewports(){const{width:t,height:e,views:n}=this,r=this.controllers;this._viewports=[],this.controllers={};let i=!1;for(let o=n.length;o--;){const s=n[o],a=this.getViewState(s),l=s.makeViewport({width:t,height:e,viewState:a});let u=r[s.id];s.controller&&!u&&(i=!0),!i&&s.controller||!u||(u.finalize(),u=null),this.controllers[s.id]=this._updateController(s,a,l,u),this._viewports.unshift(l)}for(const t in r)r[t]&&!this.controllers[t]&&r[t].finalize();this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach((t=>{t.id&&(this._viewportMap[t.id]=this._viewportMap[t.id]||t)}))}_diffViews(t,e){return t.length!==e.length||t.some(((n,r)=>!t[r].equals(e[r])))}}var l=n(4009),u=n(9601);const c=new u.Z;class h{constructor(){this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(t){"effects"in t&&(t.effects.length===this.effects.length&&(0,i.v)(t.effects,this.effects)||(this.setEffects(t.effects),this._needsRedraw="effects changed"))}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(t=[]){this.cleanup(),this.effects=t,this._createInternalEffects()}cleanup(){for(const t of this.effects)t.cleanup();for(const t of this._internalEffects)t.cleanup();this.effects.length=0,this._internalEffects.length=0}_createInternalEffects(){this._internalEffects=this.effects.slice(),this.effects.some((t=>t instanceof u.Z))||this._internalEffects.push(c)}}var p=n(1215),f=n(9877),d=n(3849),g=n(4912),m=n(9450),A=n(1953),y=n(930);const _={pickedColor:null,pickedLayer:null,pickedObjectIndex:-1};function v({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:s}){if(t){const{x:a,y:l,width:u,height:c}=s;let h=i*i,p=-1,f=0;for(let e=0;e<c;e++){const i=e+l-r,o=i*i;if(o>h)f+=4*u;else for(let e=0;e<u;e++){if(t[f+3]-1>=0){const t=e+a-n,r=t*t+o;r<=h&&(h=r,p=f)}f+=4}}if(p>=0){const n=t.slice(p,p+4),r=e(n);if(r){const t=Math.floor(p/4/u),e=p/4-t*u;return{...r,pickedColor:n,pickedX:a+e,pickedY:l+t}}o.Z.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return _}function b({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:o}){let s=e[0];e.length>1&&(s=function(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}((null==t?void 0:t.pickedViewports)||e,{x:r,y:i}));const a=s&&s.unproject([r-s.x,i-s.y],{targetZ:o});return{color:null,layer:null,viewport:s,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:a,devicePixel:t&&[t.pickedX,t.pickedY],pixelRatio:n}}function x(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:o,pickedLayer:s,pickedObjectIndex:a}=e,l=s?[s]:[];if("hover"===r){const t=n.index,e=n.layerId,r=s&&s.props.id;if(r!==e||a!==t){if(r!==e){const t=i.find((t=>t.props.id===e));t&&l.unshift(t)}n.layerId=r,n.index=a,n.info=null}}const u=b(t),c=new Map;return c.set(null,u),l.forEach((t=>{let e={...u};t===s&&(e.color=o,e.index=a,e.picked=!0),e=w({layer:t,info:e,mode:r}),t===s&&"hover"===r&&(n.info=e),c.set(e.layer.id,e),"hover"===r&&e.layer.updateAutoHighlight(e)})),c}function w({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}class E{constructor(t){this.gl=t,this.pickingFBO=null,this.pickLayersPass=new y.Z(t),this.layerFilter=null,this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(t){"layerFilter"in t&&(this.layerFilter=t.layerFilter),"_pickable"in t&&(this._pickable=t._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(t){return this._pickClosestObject(t)}pickObjects(t){return this._pickVisibleObjects(t)}getLastPickedObject({x:t,y:e,layers:n,viewports:r},i=this.lastPickedInfo.info){const o=i&&i.layer&&i.layer.id,s=i&&i.viewport&&i.viewport.id,a=o?n.find((t=>t.id===o)):null,l=s&&r.find((t=>t.id===s))||r[0],u=l&&l.unproject([t-l.x,e-l.y]),c={x:t,y:e,viewport:l,coordinate:u,layer:a};return a?{...i,...c}:Object.assign(c,{color:null,object:null,index:-1})}_resizeBuffer(){const{gl:t}=this;return this.pickingFBO||(this.pickingFBO=new d.Z(t),d.Z.isSupported(t,{colorBufferFloat:!0})&&(this.depthFBO=new d.Z(t),this.depthFBO.attach({36064:new g.Z(t,{format:(0,m.D0)(t)?34836:6408,type:5126})}))),this.pickingFBO.resize({width:t.canvas.width,height:t.canvas.height}),this.depthFBO&&this.depthFBO.resize({width:t.canvas.width,height:t.canvas.height}),this.pickingFBO}_getPickable(t){if(!1===this._pickable)return null;const e=t.filter((t=>t.isPickable()&&!t.isComposite));return e.length?e:null}_pickClosestObject({layers:t,views:e,viewports:n,x:r,y:i,radius:o=0,depth:s=1,mode:a="query",unproject3D:l,onViewportActive:u}){if(!(t=this._getPickable(t)))return{result:[],emptyInfo:b({viewports:n,x:r,y:i})};this._resizeBuffer();const c=(0,m.w)(this.gl),h=(0,m.JY)(this.gl,[r,i],!0),p=[h.x+Math.floor(h.width/2),h.y+Math.floor(h.height/2)],f=Math.round(o*c),{width:d,height:g}=this.pickingFBO,A=this._getPickingRect({deviceX:p[0],deviceY:p[1],deviceRadius:f,deviceWidth:d,deviceHeight:g});let y;const _=[],w={};for(let o=0;o<s;o++){const h=v({...A&&this._drawAndSample({layers:t,views:e,viewports:n,onViewportActive:u,deviceRect:A,pass:"picking:".concat(a),redrawReason:a}),deviceX:p[0],deviceY:p[1],deviceRadius:f,deviceRect:A});let d;if(h.pickedLayer&&l&&this.depthFBO&&(d=this._drawAndSample({layers:[h.pickedLayer],views:e,viewports:n,onViewportActive:u,deviceRect:{x:h.pickedX,y:h.pickedY,width:1,height:1},pass:"picking:".concat(a),redrawReason:"pick-z",pickZ:!0}).pickedColors[0]*n[0].distanceScales.metersPerUnit[2]+n[0].position[2]),h.pickedColor&&o+1<s){const e=h.pickedColor[3]-1;w[e]=!0,t[e].disablePickingIndex(h.pickedObjectIndex)}y=x({pickInfo:h,lastPickedInfo:this.lastPickedInfo,mode:a,layers:t,viewports:n,x:r,y:i,z:d,pixelRatio:c});for(const t of y.values())t.layer&&_.push(t);if(!h.pickedColor)break}for(const e in w)t[e].restorePickingColors();return{result:_,emptyInfo:y&&y.get(null)}}_pickVisibleObjects({layers:t,views:e,viewports:n,x:r,y:i,width:s=1,height:a=1,mode:l="query",maxObjects:u=null,onViewportActive:c}){if(!(t=this._getPickable(t)))return[];this._resizeBuffer();const h=(0,m.w)(this.gl),p=(0,m.JY)(this.gl,[r,i],!0),f=p.x,d=p.y+p.height,g=(0,m.JY)(this.gl,[r+s,i+a],!0),A=g.x+g.width,y=g.y,_={x:f,y,width:A-f,height:d-y},v=function({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t)for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const i=t.slice(r,r+4),s=i.join(",");if(!n.has(s)){const t=e(i);t?n.set(s,{...t,pickedColor:i}):o.Z.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return Array.from(n.values())}(this._drawAndSample({layers:t,views:e,viewports:n,onViewportActive:c,deviceRect:_,pass:"picking:".concat(l),redrawReason:l})),b=new Map,x=Number.isFinite(u);for(let t=0;t<v.length&&!(x&&b.size>=u);t++){const e=v[t];let n={color:e.pickedColor,layer:null,index:e.pickedObjectIndex,picked:!0,x:r,y:i,width:s,height:a,pixelRatio:h};n=w({layer:e.pickedLayer,info:n,mode:l}),b.has(n.object)||b.set(n.object,n)}return Array.from(b.values())}_drawAndSample({layers:t,views:e,viewports:n,onViewportActive:r,deviceRect:i,pass:o,redrawReason:s,pickZ:a}){const l=a?this.depthFBO:this.pickingFBO,{decodePickingColor:u}=this.pickLayersPass.render({layers:t,layerFilter:this.layerFilter,views:e,viewports:n,onViewportActive:r,pickingFBO:l,deviceRect:i,pass:o,redrawReason:s,pickZ:a}),{x:c,y:h,width:p,height:f}=i,d=new(a?Float32Array:Uint8Array)(p*f*4);return(0,A.z6)(l,{sourceX:c,sourceY:h,sourceWidth:p,sourceHeight:f,target:d}),{pickedColors:d,decodePickingColor:u}}_getPickingRect({deviceX:t,deviceY:e,deviceRadius:n,deviceWidth:r,deviceHeight:i}){const o=Math.max(0,t-n),s=Math.max(0,e-n),a=Math.min(r,t+n+1)-o,l=Math.min(i,e+n+1)-s;return a<=0||l<=0?null:{x:o,y:s,width:a,height:l}}}const S={zIndex:1,position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:0,left:0,display:"none"};class T{constructor(t){const e=t.parentElement;e&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,S),e.appendChild(this.el)),this.isVisible=!1}setTooltip(t,e,n){const r=this.el;if("string"==typeof t)r.innerText=t;else{if(!t)return this.isVisible=!1,void(r.style.display="none");"text"in t&&(r.innerText=t.text),"html"in t&&(r.innerHTML=t.html),"className"in t&&(r.className=t.className),Object.assign(r.style,t.style)}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(e,"px, ").concat(n,"px)")}remove(){this.el&&this.el.remove()}}var P=n(6610),M=n(6228),C=n(2378),I=n(9718),O=n(3803);const R={name:"JSON",extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(t){const e=t[0],n=t[t.length-1];return"{"===e&&"}"===n||"["===e&&"]"===n},parseTextSync:JSON.parse},L="8.6.0",k=I.CO.deck&&I.CO.deck.VERSION;if(k&&k!==L)throw new Error("deck.gl - multiple versions detected: ".concat(k," vs ").concat(L));k||(o.Z.log(1,"deck.gl ".concat(L))(),I.CO.deck=Object.assign(I.CO.deck||{},{VERSION:L,version:L,log:o.Z,_registerLoggers:O.z}),(0,M.fh)([R,[C.S,{imagebitmap:{premultiplyAlpha:"none"}}]]));const D=I.CO.deck;var N=n(9902),F=n(8055),B=n(9835),z=n(8295),j=n(2317),U=n(5304),V=n(4088);function G(){}const Z={id:"",width:"100%",height:"100%",pickingRadius:0,layerFilter:null,glOptions:{},gl:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},onWebGLInitialized:G,onResize:G,onViewStateChange:G,onInteractionStateChange:G,onBeforeRender:G,onAfterRender:G,onLoad:G,onError:(t,e)=>o.Z.error(t)(),_onMetrics:null,getCursor:({isDragging:t})=>t?"grabbing":"grab",debug:!1,drawPickingColors:!1};class q{constructor(t){t={...Z,...t},this.props={},this.width=0,this.height=0,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this._needsRedraw=!0,this._pickRequest={},this._lastPointerDownInfo=null,this.viewState=null,this.interactiveState={isHovering:!1,isDragging:!1},this._onEvent=this._onEvent.bind(this),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerMove=this._onPointerMove.bind(this),t.viewState&&t.initialViewState&&o.Z.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===(0,I.qs)()&&o.Z.warn("IE 11 support will be deprecated in v8.0")(),t.gl||"undefined"!=typeof document&&(this.canvas=this._createCanvas(t)),this.animationLoop=this._createAnimationLoop(t),this.stats=new z.Z({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(t),t._typedArrayManagerProps&&P.Z.setProps(t._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager&&(this.layerManager.finalize(),this.layerManager=null,this.viewManager.finalize(),this.viewManager=null,this.effectManager.finalize(),this.effectManager=null,this.deckRenderer.finalize(),this.deckRenderer=null,this.deckPicker.finalize(),this.deckPicker=null,this.eventManager.destroy(),this.eventManager=null,this.tooltip.remove(),this.tooltip=null),this.props.canvas||this.props.gl||!this.canvas||(this.canvas.parentElement.removeChild(this.canvas),this.canvas=null)}setProps(t){this.stats.get("setProps Time").timeStart(),"onLayerHover"in t&&o.Z.removed("onLayerHover","onHover")(),"onLayerClick"in t&&o.Z.removed("onLayerClick","onClick")(),t.initialViewState&&!(0,i.v)(this.props.initialViewState,t.initialViewState)&&(this.viewState=t.initialViewState),Object.assign(this.props,t),this._setCanvasSize(this.props);const e=Object.create(this.props);Object.assign(e,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(e),this.layerManager&&(this.viewManager.setProps(e),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(e),this.effectManager.setProps(e),this.deckRenderer.setProps(e),this.deckPicker.setProps(e)),this.stats.get("setProps Time").timeEnd()}needsRedraw(t={clearRedrawFlags:!1}){if(this.props._animate)return"Deck._animate";let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(t),r=this.layerManager.needsRedraw(t),i=this.effectManager.needsRedraw(t),o=this.deckRenderer.needsRedraw(t);return e=e||n||r||i||o,e}redraw(t){if(!this.layerManager)return;const e=t||this.needsRedraw({clearRedrawFlags:!0});e&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(e):this._drawLayers(e))}getViews(){return this.viewManager.views}getViewports(t){return this.viewManager.getViewports(t)}pickObject(t){const e=this._pick("pickObject","pickObject Time",t).result;return e.length?e[0]:null}pickMultipleObjects(t){return t.depth=t.depth||10,this._pick("pickObject","pickMultipleObjects Time",t).result}pickObjects(t){return this._pick("pickObjects","pickObjects Time",t)}_addResources(t,e=!1){for(const n in t)this.layerManager.resourceManager.add({resourceId:n,data:t[n],forceUpdate:e})}_removeResources(t){for(const e of t)this.layerManager.resourceManager.remove(e)}_pick(t,e,n){const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(e).timeStart();const i=this.deckPicker[t]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,...n});return r.get(e).timeEnd(),i}_createCanvas(t){let e=t.canvas;return"string"==typeof e&&(e=document.getElementById(e),(0,U.Z)(e)),e||(e=document.createElement("canvas"),e.id=t.id||"deckgl-overlay",(t.parent||document.body).appendChild(e)),Object.assign(e.style,t.style),e}_setCanvasSize(t){if(!this.canvas)return;let{width:e,height:n}=t;(e||0===e)&&(e=Number.isFinite(e)?"".concat(e,"px"):e,this.canvas.style.width=e),(n||0===n)&&(n=Number.isFinite(n)?"".concat(n,"px"):n,this.canvas.style.position="absolute",this.canvas.style.height=n)}_updateCanvasSize(){if(this._checkForCanvasSizeChange()){const{width:t,height:e}=this;this.viewManager.setProps({width:t,height:e}),this.props.onResize({width:this.width,height:this.height})}}_checkForCanvasSizeChange(){const{canvas:t}=this;if(!t)return!1;const e=t.clientWidth||t.width,n=t.clientHeight||t.height;return(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,!0)}_createAnimationLoop(t){const{width:e,height:n,gl:r,glOptions:i,debug:o,onError:s,onBeforeRender:a,onAfterRender:l,useDevicePixels:u,autoResizeDrawingBuffer:c}=t;return new N.Z({width:e,height:n,useDevicePixels:u,autoResizeDrawingBuffer:c,autoResizeViewport:!1,gl:r,onCreateContext:t=>(0,m.s9)({...i,...t,canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()}),onInitialize:t=>this._setGLContext(t.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:a,onAfterRender:l,onError:s})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let t=this.props.views||[new l.Z({id:"default-view"})];return t=Array.isArray(t)?t:[t],t.length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}_onContextLost(){const{onError:t}=this.props;this.animationLoop&&t&&t(new Error("WebGL context is lost"))}_onPointerMove(t){const{_pickRequest:e}=this;if("pointerleave"===t.type)e.x=-1,e.y=-1,e.radius=0;else{if(t.leftButton||t.rightButton)return;{const n=t.offsetCenter;if(!n)return;e.x=n.x,e.y=n.y,e.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:e.x,y:e.y}),e.event=t,e.mode="hover"}_pickAndCallback(){const{_pickRequest:t}=this;if(t.event){const{result:e,emptyInfo:n}=this._pick("pickObject","pickObject Time",t);this.interactiveState.isHovering=e.length>0;let r=n,i=!1;for(const n of e)r=n,i=n.layer.onHover(n,t.event);if(!i&&this.props.onHover&&this.props.onHover(r,t.event),this.props.getTooltip){const t=this.props.getTooltip(r);this.tooltip.setTooltip(t,r.x,r.y)}t.event=null}}_updateCursor(){const t=this.props.parent||this.canvas;t&&(t.style.cursor=this.props.getCursor(this.interactiveState))}_setGLContext(t){if(this.layerManager)return;this.canvas||(this.canvas=t.canvas,(0,m.yW)(t,{enable:!0,copyState:!0})),this.tooltip=new T(this.canvas),(0,m.dR)(t,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(t);const e=new F.T;e.play(),this.animationLoop.attachTimeline(e),this.eventManager=new j.Q(this.props.parent||t.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const t in V.FP)this.eventManager.on(t,this._onEvent);this.viewManager=new a({timeline:e,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new r.Z(t,{deck:this,stats:this.stats,viewport:n,timeline:e}),this.effectManager=new h,this.deckRenderer=new f.Z(t),this.deckPicker=new E(t),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(t,e){const{gl:n}=this.layerManager.context;(0,m.dR)(n,this.props.parameters),this.props.onBeforeRender({gl:n}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:t,effects:this.effectManager.getEffects(),...e}),this.props.onAfterRender({gl:n})}_onRenderFrame(t){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),o.Z.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(!1),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(t){const e=this.props.onViewStateChange(t)||t.viewState;this.viewState&&(this.viewState={...this.viewState,[t.viewId]:e},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(t){this.interactiveState.isDragging=t.isDragging,this.props.onInteractionStateChange(t)}_onEvent(t){const e=V.FP[t.type],n=t.offsetCenter;if(!e||!n)return;const r=this.layerManager.getLayers(),i=this.deckPicker.getLastPickedObject({x:n.x,y:n.y,layers:r,viewports:this.getViewports(n)},this._lastPointerDownInfo),{layer:o}=i,s=o&&(o[e.handler]||o.props[e.handler]),a=this.props[e.handler];let l=!1;s&&(l=s.call(o,i,t)),!l&&a&&a(i,t)}_onPointerDown(t){const e=t.offsetCenter;this._lastPointerDownInfo=this.pickObject({x:e.x,y:e.y,radius:this.props.pickingRadius})}_getFrameStats(){const{stats:t}=this;t.get("frameRate").timeEnd(),t.get("frameRate").timeStart();const e=this.animationLoop.stats;t.get("GPU Time").addTime(e.get("GPU Time").lastTiming),t.get("CPU Time").addTime(e.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:t,stats:e}=this;t.fps=e.get("frameRate").getHz(),t.setPropsTime=e.get("setProps Time").time,t.updateAttributesTime=e.get("Update Attributes").time,t.framesRedrawn=e.get("Redraw Count").count,t.pickTime=e.get("pickObject Time").time+e.get("pickMultipleObjects Time").time+e.get("pickObjects Time").time,t.pickCount=e.get("Pick Count").count,t.gpuTime=e.get("GPU Time").time,t.cpuTime=e.get("CPU Time").time,t.gpuTimePerFrame=e.get("GPU Time").getAverageTime(),t.cpuTimePerFrame=e.get("CPU Time").getAverageTime();const n=B.l.get("Memory Usage");t.bufferMemory=n.get("Buffer Memory").count,t.textureMemory=n.get("Texture Memory").count,t.renderbufferMemory=n.get("Renderbuffer Memory").count,t.gpuMemory=n.get("GPU Memory").count}}q.getPropTypes=function(t){return{id:t.string,width:t.oneOfType([t.number,t.string]),height:t.oneOfType([t.number,t.string]),layers:t.oneOfType([t.object,t.array]),layerFilter:t.func,views:t.oneOfType([t.object,t.array]),viewState:t.object,effects:t.arrayOf(t.instanceOf(p.Z)),controller:t.oneOfType([t.func,t.bool,t.object]),gl:t.object,glOptions:t.object,parameters:t.object,pickingRadius:t.number,useDevicePixels:t.oneOfType([t.bool,t.number]),touchAction:t.string,eventRecognizerOptions:t.object,onWebGLInitialized:t.func,onResize:t.func,onViewStateChange:t.func,onInteractionStateChange:t.func,onBeforeRender:t.func,onAfterRender:t.func,onLoad:t.func,onError:t.func,debug:t.bool,drawPickingColors:t.bool,_framebuffer:t.object,_animate:t.bool,_pickable:t.bool,_typedArrayManagerProps:t.object}},q.defaultProps=Z,q.VERSION=D.VERSION},1215:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});class r{constructor(t={}){const{id:e="effect"}=t;this.id=e,this.props={...t}}preRender(){}getModuleParameters(){}cleanup(){}}},3693:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var r=n(6871);class i{constructor(t={}){this.opts=t}equals(t){return this===t||this.constructor===t.constructor&&(0,r.v)(this.opts,t.opts)}getShaders(t){return null}getSubLayerProps(t){const{defaultProps:e={}}=t.constructor,n={updateTriggers:{}};for(const t in e)if(t in this.props){const r=e[t],i=this.props[t];n[t]=i,r&&"accessor"===r.type&&(n.updateTriggers[t]=this.props.updateTriggers[t],"function"==typeof i&&(n[t]=this.getSubLayerAccessor(i,!0)))}return n}initializeState(t,e){}updateState(t,e){}draw(t,e){}finalizeState(t){}}},5841:(t,e,n)=>{"use strict";n.d(e,{Z:()=>y});var r=n(8055),i=n(5409),o=n(744),s=n(3803),a=n(1855),l=n(8295),u=n(3079);class c{constructor(t,e,n){this.id=t,this.context=n,this._loadCount=0,this._subscribers=new Set,this.setData(e)}subscribe(t){this._subscribers.add(t)}unsubscribe(t){this._subscribers.delete(t)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then((()=>this.getData()))}setData(t,e){if(t===this._data&&!e)return;this._data=t;const n=++this._loadCount;let r=t;"string"==typeof t&&(r=(0,u.z)(t)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then((t=>{this._loadCount===n&&(this.isLoaded=!0,this._error=null,this._content=t)})).catch((t=>{this._loadCount===n&&(this.isLoaded=!0,this._error=t||!0)}))):(this.isLoaded=!0,this._error=null,this._content=t);for(const t of this._subscribers)t.onChange(this.getData())}}class h{constructor({gl:t,protocol:e}){this.protocol=e||"resource://",this._context={gl:t,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(t){return!!t.startsWith(this.protocol)||t in this._resources}add({resourceId:t,data:e,forceUpdate:n=!1,persistent:r=!0}){let i=this._resources[t];i?i.setData(e,n):(i=new c(t,e,this._context),this._resources[t]=i),i.persistent=r}remove(t){const e=this._resources[t];e&&(e.delete(),delete this._resources[t])}unsubscribe({consumerId:t}){const e=this._consumers[t];if(e){for(const t in e){const n=e[t];n.resource&&n.resource.unsubscribe(n)}delete this._consumers[t],this.prune()}}subscribe({resourceId:t,onChange:e,consumerId:n,requestId:r="default"}){const{_resources:i,protocol:o}=this;t.startsWith(o)&&(i[t=t.replace(o,"")]||this.add({resourceId:t,data:null,persistent:!1}));const s=i[t];if(this._track(n,r,s,e),s)return s.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout((()=>this._prune()),0))}finalize(){for(const t in this._resources)this._resources[t].delete()}_track(t,e,n,r){const i=this._consumers,o=i[t]=i[t]||{},s=o[e]||{};s.resource&&(s.resource.unsubscribe(s),s.resource=null,this.prune()),n&&(o[e]=s,s.onChange=r,s.resource=n,n.subscribe(s))}_prune(){this._pruneRequest=null;for(const t of Object.keys(this._resources)){const e=this._resources[t];e.persistent||e.inUse()||(e.delete(),delete this._resources[t])}}}var p=n(7013),f=n(1731);const d=[n(3751).Z],g=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function m(t){const e=f.Z.getDefaultProgramManager(t);for(const t of d)e.addDefaultModule(t);for(const t of g)e.addShaderHook(t);return e}const A=Object.seal({layerManager:null,resourceManager:null,deck:null,gl:null,stats:null,shaderCache:null,pickingFBO:null,mousePosition:null,userData:{}});class y{constructor(t,{deck:e,stats:n,viewport:i,timeline:o}={}){this.lastRenderedLayers=[],this.layers=[],this.resourceManager=new h({gl:t,protocol:"deck://"}),this.context={...A,layerManager:this,gl:t,deck:e,programManager:t&&m(t),stats:n||new l.Z({id:"deck.gl"}),viewport:i||new p.Z({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:o||new r.T,resourceManager:this.resourceManager},this._nextLayers=null,this._needsRedraw="Initial render",this._needsUpdate=!1,this._debug=!1,this.activateViewport=this.activateViewport.bind(this),Object.seal(this)}finalize(){this.resourceManager.finalize();for(const t of this.layers)this._finalizeLayer(t)}needsRedraw(t={clearRedrawFlags:!1}){let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const r=n.getNeedsRedraw(t);e=e||r}return e}needsUpdate(){return this._nextLayers&&this._nextLayers!==this.lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(t){this._needsRedraw=this._needsRedraw||t}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t}getLayers({layerIds:t=null}={}){return t?this.layers.filter((e=>t.find((t=>0===e.id.indexOf(t))))):this.layers}setProps(t){"debug"in t&&(this._debug=t.debug),"userData"in t&&(this.context.userData=t.userData),"layers"in t&&(this._nextLayers=t.layers),"onError"in t&&(this.context.onError=t.onError)}setLayers(t,e){(0,s.Z)("layerManager.setLayers",this,e,t),this.lastRenderedLayers=t,t=(0,a.x)(t,Boolean);for(const e of t)e.context=this.context;return this._updateLayers(this.layers,t),this}updateLayers(){const t=this.needsUpdate();t&&(this.setNeedsRedraw("updating layers: ".concat(t)),this.setLayers(this._nextLayers||this.lastRenderedLayers,t)),this._nextLayers=null}activateViewport(t){return(0,s.Z)("layerManager.activateViewport",this,t),t&&(this.context.viewport=t),this}_handleError(t,e,n){n.raiseError(e,"".concat(t," of ").concat(n))}_updateLayers(t,e){const n={};for(const e of t)n[e.id]?o.Z.warn("Multiple old layers with same id ".concat(e.id))():n[e.id]=e;const r=[];this._updateSublayersRecursively(e,n,r),this._finalizeOldLayers(n);let i=!1;for(const t of r)if(t.hasUniformTransition()){i=!0;break}this._needsUpdate=i,this.layers=r}_updateSublayersRecursively(t,e,n){for(const r of t){r.context=this.context;const t=e[r.id];null===t&&o.Z.warn("Multiple new layers with same id ".concat(r.id))(),e[r.id]=null;let i=null;try{this._debug&&t!==r&&r.validateProps(),t?(this._transferLayerState(t,r),this._updateLayer(r)):this._initializeLayer(r),n.push(r),i=r.isComposite&&r.getSubLayers()}catch(t){this._handleError("matching",t,r)}i&&this._updateSublayersRecursively(i,e,n)}}_finalizeOldLayers(t){for(const e in t){const n=t[e];n&&this._finalizeLayer(n)}}_initializeLayer(t){try{t._initialize(),t.lifecycle=i.d.INITIALIZED}catch(e){this._handleError("initialization",e,t)}}_transferLayerState(t,e){e._transferState(t),e.lifecycle=i.d.MATCHED,e!==t&&(t.lifecycle=i.d.AWAITING_GC)}_updateLayer(t){try{t._update()}catch(e){this._handleError("update",e,t)}}_finalizeLayer(t){this._needsRedraw=this._needsRedraw||"finalized ".concat(t),t.lifecycle=i.d.AWAITING_FINALIZATION;try{t._finalize(),t.lifecycle=i.d.FINALIZED}catch(e){this._handleError("finalization",e,t)}}}},4185:(t,e,n)=>{"use strict";n.d(e,{Z:()=>ut});var r=n(4088),i=n(3518),o=n(9006),s=n(4034),a=n(3630);class l extends a.Z{get value(){return this._value}_onUpdate(){const{time:t,settings:{fromValue:e,toValue:n,duration:r,easing:i}}=this,o=i(t/r);this._value=(0,s.t7)(e,n,o)}}const u=1e-5;function c(t,e,n,r,i){const o=e-t;return(n-e)*i+-o*r+o+e}function h(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class p extends a.Z{get value(){return this._currValue}_onUpdate(){const{fromValue:t,toValue:e,damping:n,stiffness:r}=this.settings,{_prevValue:i=t,_currValue:o=t}=this;let s=function(t,e,n,r,i){if(Array.isArray(n)){const o=[];for(let s=0;s<n.length;s++)o[s]=c(t[s],e[s],n[s],r,i);return o}return c(t,e,n,r,i)}(i,o,e,n,r);const a=h(s,e),l=h(s,o);a<u&&l<u&&(s=e,this.end()),this._prevValue=o,this._currValue=s}}var f=n(744);const d={interpolation:l,spring:p};class g{constructor(t){this.transitions=new Map,this.timeline=t}get active(){return this.transitions.size>0}add(t,e,n,r){const{transitions:i}=this;if(i.has(t)){const n=i.get(t),{value:r=n.settings.fromValue}=n;e=r,this.remove(t)}if(!(r=(0,o.M0)(r)))return;const s=d[r.type];if(!s)return void f.Z.error("unsupported transition type '".concat(r.type,"'"))();const a=new s(this.timeline);a.start({...r,fromValue:e,toValue:n}),i.set(t,a)}remove(t){const{transitions:e}=this;e.has(t)&&(e.get(t).cancel(),e.delete(t))}update(){const t={};for(const[e,n]of this.transitions)n.update(),t[e]=n.value,n.inProgress||this.remove(e);return t}clear(){for(const t of this.transitions.keys())this.remove(t)}}var m=n(1761),A=n(5015),y=n(3803),_=n(9450),v=n(5304),b=n(8177),x=n(7870),w=n(8547),E=n(6610),S=n(5409),T=n(8550),P=n(4912);const M={10241:9987,10240:9729,10242:33071,10243:33071},C={},I={boolean:{validate:(t,e)=>!0,equal:(t,e,n)=>Boolean(t)===Boolean(e)},number:{validate:(t,e)=>Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)},color:{validate:(t,e)=>e.optional&&!t||k(t)&&(3===t.length||4===t.length),equal:(t,e,n)=>O(t,e)},accessor:{validate(t,e){const n=D(t);return"function"===n||n===D(e.value)},equal:(t,e,n)=>"function"==typeof e||O(t,e)},array:{validate:(t,e)=>e.optional&&!t||k(t),equal:(t,e,n)=>n.compare?O(t,e):t===e},function:{validate:(t,e)=>e.optional&&!t||"function"==typeof t,equal:(t,e,n)=>!n.compare||t===e},data:{transform:(t,e,n)=>{const{dataTransform:r}=n?n.props:{};return r&&t?r(t):t}},image:{transform:(t,e,n)=>function(t,e){const n=t.context&&t.context.gl;if(!n||!e)return null;if(e instanceof P.Z)return e;e.constructor&&"Object"!==e.constructor.name&&(e={data:e});let r=null;e.compressed&&(r={10241:e.data.length>1?9985:9729});const i=new P.Z(n,{...e,parameters:{...M,...r,...t.props.textureParameters}});return C[i.id]=!0,i}(n,t),release:t=>{var e;(e=t)&&e instanceof P.Z&&C[e.id]&&(e.delete(),delete C[e.id])}}};function O(t,e){if(t===e)return!0;if(!k(t)||!k(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function R(t,e){switch(D(e)){case"object":return L(t,e);case"array":return L(t,{type:"array",value:e,compare:!1});case"boolean":return L(t,{type:"boolean",value:e});case"number":return L(t,{type:"number",value:e});case"function":return L(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function L(t,e){return"type"in e?{name:t,...I[e.type],...e}:"value"in e?{name:t,type:D(e.value),...e}:{name:t,type:"object",value:e}}function k(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function D(t){return k(t)?"array":null===t?"null":typeof t}const{COMPONENT:N,ASYNC_ORIGINAL:F,ASYNC_RESOLVED:B,ASYNC_DEFAULTS:z}=S.A;function j(){const t=this,e=U(t.constructor),n=Object.create(e);n[N]=t,n[F]={},n[B]={};for(let t=0;t<arguments.length;++t){const e=arguments[t];for(const t in e)n[t]=e[t]}return Object.freeze(n),n}function U(t){return Z(t,"_mergedDefaultProps")||(function(t){if(!t.prototype)return;const e=Object.getPrototypeOf(t),n=U(e),r=function(t){const e={},n={},r={};for(const[i,o]of Object.entries(t))if(o&&o.deprecatedFor)r[i]=Array.isArray(o.deprecatedFor)?o.deprecatedFor:[o.deprecatedFor];else{const t=R(i,o);e[i]=t,n[i]=t.value}return{propTypes:e,defaultProps:n,deprecatedProps:r}}(Z(t,"defaultProps")||{}),i=function(t,e,n){const r=Object.create(null);Object.assign(r,e,t);const i=function(t){const e=Z(t,"layerName")||Z(t,"componentName");return e||f.Z.once(0,"".concat(t.name,".componentName not specified"))(),e||t.name}(n);return delete t.id,Object.defineProperties(r,{id:{writable:!0,value:i}}),r}(r.defaultProps,n,t),o={...e._propTypes,...r.propTypes};!function(t,e){const n={},r={};for(const t in e){const i=e[t],{name:o,value:s}=i;i.async&&(n[o]=s,r[o]=V(o))}t[z]=n,t[F]={},Object.defineProperties(t,r)}(i,o);const s={...e._deprecatedProps,...r.deprecatedProps};(function(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(t){const r="".concat(this.id,": ").concat(n);for(const r of e[n])G(this,r)||(this[r]=t);f.Z.deprecated(r,e[n].join("/"))()}})})(i,s),t._mergedDefaultProps=i,t._propTypes=o,t._deprecatedProps=s}(t),t._mergedDefaultProps)}function V(t){return{enumerable:!0,set(e){"string"==typeof e||e instanceof Promise||(0,T.D0)(e)?this[F][t]=e:this[B][t]=e},get(){if(this[B]){if(t in this[B])return this[B][t]||this[z][t];if(t in this[F]){const e=this[N]&&this[N].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[z][t]}}return this[z][t]}}}function G(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Z(t,e){return G(t,e)&&t[e]}const{ASYNC_ORIGINAL:q,ASYNC_RESOLVED:W,ASYNC_DEFAULTS:H}=S.A,X=Object.freeze({});class ${constructor(t=null){this.component=t,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=X,this.oldAsyncProps=null}finalize(){for(const t in this.asyncProps){const e=this.asyncProps[t];e.type&&e.type.release&&e.type.release(e.resolvedValue,e.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}freezeAsyncOldProps(){if(!this.oldAsyncProps){this.oldProps=this.oldProps||this.component.props,this.oldAsyncProps=Object.create(this.oldProps);for(const t in this.asyncProps)Object.defineProperty(this.oldAsyncProps,t,{enumerable:!0,value:this.oldProps[t]})}}hasAsyncProp(t){return t in this.asyncProps}getAsyncProp(t){const e=this.asyncProps[t];return e&&e.resolvedValue}isAsyncPropLoading(t){if(t){const e=this.asyncProps[t];return Boolean(e&&e.pendingLoadCount>0&&e.pendingLoadCount!==e.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(t,e){this._watchPromise(t,Promise.resolve(e))}setAsyncProps(t){const e=t[W]||{},n=t[q]||t,r=t[H]||{};for(const t in e){const n=e[t];this._createAsyncPropData(t,r[t]),this._updateAsyncProp(t,n),e[t]=this.getAsyncProp(t)}for(const t in n){const e=n[t];this._createAsyncPropData(t,r[t]),this._updateAsyncProp(t,e)}}_updateAsyncProp(t,e){if(this._didAsyncInputValueChange(t,e)){if("string"==typeof e){var n;const r=null===(n=this.layer)||void 0===n?void 0:n.props.fetch,i=e;r&&(e=r(i,{propName:t,layer:this.layer}))}e instanceof Promise?this._watchPromise(t,e):(0,T.D0)(e)?this._resolveAsyncIterable(t,e):this._setPropValue(t,e)}}_didAsyncInputValueChange(t,e){const n=this.asyncProps[t];return e!==n.resolvedValue&&e!==n.lastValue&&(n.lastValue=e,!0)}_setPropValue(t,e){this.freezeAsyncOldProps();const n=this.asyncProps[t];e=this._postProcessValue(n,e),n.resolvedValue=e,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount}_setAsyncPropValue(t,e,n){const r=this.asyncProps[t];r&&n>=r.resolvedLoadCount&&void 0!==e&&(this.freezeAsyncOldProps(),r.resolvedValue=e,r.resolvedLoadCount=n,this.onAsyncPropUpdated(t,e))}_watchPromise(t,e){const n=this.asyncProps[t];n.pendingLoadCount++;const r=n.pendingLoadCount;e.then((e=>{var i;e=this._postProcessValue(n,e),this._setAsyncPropValue(t,e,r);const o=null===(i=this.layer)||void 0===i?void 0:i.props.onDataLoad;"data"===t&&o&&o(e,{propName:t,layer:this.layer})})).catch((e=>{var n;null===(n=this.layer)||void 0===n||n.raiseError(e,"loading ".concat(t," of ").concat(this.layer))}))}async _resolveAsyncIterable(t,e){var n;"data"!==t&&this._setPropValue(t,e);const r=this.asyncProps[t];r.pendingLoadCount++;const i=r.pendingLoadCount;let o=[],s=0;for await(const n of e){const{dataTransform:e}=this.component?this.component.props:{};o=e?e(n,o):o.concat(n),Object.defineProperty(o,"__diff",{enumerable:!1,value:[{startRow:s,endRow:o.length}]}),s=o.length,this._setAsyncPropValue(t,o,i)}const a=null===(n=this.layer)||void 0===n?void 0:n.props.onDataLoad;a&&a(o,{propName:t,layer:this.layer})}_postProcessValue(t,e){const n=t.type;return n&&(n.release&&n.release(t.resolvedValue,n,this.component),n.transform)?n.transform(e,n,this.component):e}_createAsyncPropData(t,e){if(!this.asyncProps[t]){const n=this.component&&this.component.constructor._propTypes;this.asyncProps[t]={type:n&&n[t],lastValue:null,resolvedValue:e,pendingLoadCount:0,resolvedLoadCount:0}}}}const{ASYNC_ORIGINAL:Y,ASYNC_RESOLVED:Q,ASYNC_DEFAULTS:K}=S.A;let J=0;class tt{constructor(){this.props=j.apply(this,arguments),this.id=this.props.id,this.count=J++,this.lifecycle=S.d.NO_STATE,this.parent=null,this.context=null,this.state=null,this.internalState=null,Object.seal(this)}get root(){let t=this;for(;t.parent;)t=t.parent;return t}clone(t){const{props:e}=this,n={};for(const t in e[K])t in e[Q]?n[t]=e[Q][t]:t in e[Y]&&(n[t]=e[Y][t]);return new this.constructor({...e,...n,...t})}get stats(){return this.internalState.stats}_initState(){this.internalState=new $({})}}tt.componentName="Component",tt.defaultProps={};class et extends ${constructor({attributeManager:t,layer:e}){super(e),this.attributeManager=t,this.model=null,this.needsRedraw=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(t){this.component=t}}var nt=n(7682),rt=n(3079);const it=2**24-1,ot=Object.freeze([]),st=(0,b.Z)((({oldViewport:t,viewport:e})=>t.equals(e)));let at=new Uint8ClampedArray(0);const lt={data:{type:"data",value:ot,async:!0},dataComparator:null,_dataDiff:{type:"function",value:t=>t&&t.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:o})=>{const{resourceManager:s}=n.context;var a;i=i||n.getLoadOptions(),r=r||n.props.loaders,o&&(i={...i,fetch:{...null===(a=i)||void 0===a?void 0:a.fetch,signal:o}});let l=s.contains(t);return l||i||(s.add({resourceId:t,data:(0,rt.z)(t,r),persistent:!1}),l=!0),l?s.subscribe({resourceId:t,onChange:t=>n.internalState.reloadAsyncProp(e,t),consumerId:n.id,requestId:e}):(0,rt.z)(t,r,i)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:r.Df.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,100*-t],compare:!1},highlightedObjectIndex:-1,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class ut extends tt{toString(){const t=this.constructor.layerName||this.constructor.name;return"".concat(t,"({id: '").concat(this.props.id,"'})")}raiseError(t,e){var n,r,i,o;e&&(t.message="".concat(e,": ").concat(t.message)),(null===(n=(r=this.props).onError)||void 0===n?void 0:n.call(r,t))||null===(i=this.context)||void 0===i||null===(o=i.onError)||void 0===o||o.call(i,t,this)}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(t=!0){this.internalState&&(this.internalState.needsRedraw=t)}setNeedsUpdate(){this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0}getNeedsRedraw(t={clearRedrawFlags:!1}){return this._getNeedsRedraw(t)}needsUpdate(){return this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams())}hasUniformTransition(){return this.internalState.uniformTransitions.active}get isLoaded(){return this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||(this.state.model?[this.state.model]:[]))}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}project(t){const{viewport:e}=this.context,n=(0,w.T)(t,{viewport:e,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[r,i,o]=(0,nt.aW)(n,e.pixelProjectionMatrix);return 2===t.length?[r,i]:[r,i,o]}unproject(t){const{viewport:e}=this.context;return e.unproject(t)}projectPosition(t){return(0,w.D)(t,{viewport:this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem})}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===r.Df.DEFAULT||t===r.Df.LNGLAT||t===r.Df.CARTESIAN}onHover(t,e){return!!this.props.onHover&&this.props.onHover(t,e)}onClick(t,e){return!!this.props.onClick&&this.props.onClick(t,e)}nullPickingColor(){return[0,0,0]}encodePickingColor(t,e=[]){return e[0]=t+1&255,e[1]=t+1>>8&255,e[2]=t+1>>8>>8&255,e}decodePickingColor(t){(0,v.Z)(t instanceof Uint8Array);const[e,n,r]=t;return e+256*n+65536*r-1}initializeState(){throw new Error("Layer ".concat(this," has not defined initializeState"))}getShaders(t){for(const e of this.props.extensions)t=(0,x.l)(t,e.getShaders.call(this,e));return t}shouldUpdateState({oldProps:t,props:e,context:n,changeFlags:r}){return r.propsOrDataChanged}updateState({oldProps:t,props:e,context:n,changeFlags:r}){const i=this.getAttributeManager();if(r.dataChanged&&i){const{dataChanged:t}=r;if(Array.isArray(t))for(const e of t)i.invalidateAll(e);else i.invalidateAll()}const o=t.highlightedObjectIndex>=0||t.pickable,s=e.highlightedObjectIndex>=0||e.pickable;if(o!==s&&i){const{pickingColors:t,instancePickingColors:e}=i.attributes,n=t||e;n&&(s&&n.constant&&(n.constant=!1,i.invalidate(n.id)),n.value||s||(n.constant=!0,n.value=[0,0,0]))}}finalizeState(){for(const t of this.getModels())t.delete();const t=this.getAttributeManager();t&&t.finalize(),this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState.uniformTransitions.clear(),this.internalState.finalize()}draw(t){for(const e of this.getModels())e.draw(t)}getPickingInfo({info:t,mode:e}){const{index:n}=t;return n>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[n]),t}activateViewport(t){const e=this.internalState.viewport;this.internalState.viewport=t,e&&st({oldViewport:e,viewport:t})||(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(t="all",e=""){const n=this.getAttributeManager();n&&("all"===t?n.invalidateAll():n.invalidate(t))}updateAttributes(t){for(const e of this.getModels())this._setModelAttributes(e,t)}_updateAttributes(t){const e=this.getAttributeManager();if(!e)return;const n=this.getNumInstances(t),r=this.getStartIndices(t);e.update({data:t.data,numInstances:n,startIndices:r,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this,ignoreUnknownAttributes:!0});const i=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(i)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const e=t.update(),n=Object.create(this.props);for(const t in e)Object.defineProperty(n,t,{value:e[t]});return n}return this.props}calculateInstancePickingColors(t,{numInstances:e}){if(t.constant)return;const n=Math.floor(at.length/3);if(this.internalState.usesPickingColorCache=!0,n<e){e>it&&f.Z.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),at=E.Z.allocate(at,e,{size:3,copy:!0,maxCount:Math.max(e,it)});const t=Math.floor(at.length/3),r=[];for(let e=n;e<t;e++)this.encodePickingColor(e,r),at[3*e+0]=r[0],at[3*e+1]=r[1],at[3*e+2]=r[2]}t.value=at.subarray(0,3*e)}_setModelAttributes(t,e){const n=this.getAttributeManager(),r=t.userData.excludeAttributes||{},i=n.getShaderAttributes(e,r);t.setAttributes(i)}disablePickingIndex(t){this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n,i=r.getVertexOffset(t),o=r.getVertexOffset(t+1);r.buffer.subData({data:new Uint8Array(o-i),offset:i})}restorePickingColors(){const{pickingColors:t,instancePickingColors:e}=this.getAttributeManager().attributes,n=t||e;this.internalState.usesPickingColorCache&&n.value.buffer!==at.buffer&&(n.value=at.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0})}getNumInstances(t){return void 0!==(t=t||this.props).numInstances?t.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:(0,A.Q)(t.data)}getStartIndices(t){return void 0!==(t=t||this.props).startIndices?t.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}_initialize(){(0,y.Z)("layer.initialize",this),this._initState(),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:!0,propsChanged:!0,viewportChanged:!0,extensionsChanged:!0}),this._updateState()}_update(){const t=this.needsUpdate();(0,y.Z)("layer.update",this,t),t&&this._updateState()}_updateState(){const t=this.props,e=this.context.viewport,n=this._updateUniformTransition();this.internalState.propsInTransition=n,this.context.viewport=this.internalState.viewport||e,this.props=n;try{const n=this._getUpdateParams(),r=this.getModels();if(this.context.gl)this.updateState(n);else try{this.updateState(n)}catch(t){}for(const t of this.props.extensions)t.updateState.call(this,n,t);const i=this.getModels()[0]!==r[0];this._updateModules(n,i),this.isComposite?this._renderLayers(n):(this.setNeedsRedraw(),this._updateAttributes(this.props),this.state.model&&this.state.model.setInstanceCount(this.getNumInstances()))}finally{this.context.viewport=e,this.props=t,this.clearChangeFlags(),this.internalState.needsUpdate=!1,this.internalState.resetOldProps()}}_finalize(){(0,y.Z)("layer.finalize",this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,t)}drawLayer({moduleParameters:t=null,uniforms:e={},parameters:n={}}){this._updateAttributeTransition();const r=this.props;this.props=this.internalState.propsInTransition||r;const{opacity:i}=this.props;e.opacity=Math.pow(i,1/2.2);try{t&&this.setModuleParameters(t);const{getPolygonOffset:i}=this.props,o=i&&i(e)||[0,0];(0,_.dR)(this.context.gl,{polygonOffset:o}),(0,_.s8)(this.context.gl,n,(()=>{const r={moduleParameters:t,uniforms:e,parameters:n,context:this.context};for(const t of this.props.extensions)t.draw.call(this,r,t);this.draw(r)}))}finally{this.props=r}}getChangeFlags(){return this.internalState.changeFlags}setChangeFlags(t){const{changeFlags:e}=this.internalState;for(const n in t)if(t[n]){let r=!1;"dataChanged"===n&&Array.isArray(e[n])&&(e[n]=Array.isArray(t[n])?e[n].concat(t[n]):t[n],r=!0),e[n]||(e[n]=t[n],r=!0),r&&(0,y.Z)("layer.changeFlag",this,n,t)}const n=e.dataChanged||e.updateTriggersChanged||e.propsChanged||e.extensionsChanged;e.propsOrDataChanged=n,e.somethingChanged=n||t.viewportChanged||t.stateChanged}clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}diffProps(t,e){const n=(0,m.Yt)(t,e);if(n.updateTriggersChanged)for(const t in n.updateTriggersChanged)n.updateTriggersChanged[t]&&this.invalidateAttribute(t);if(n.transitionsChanged)for(const r in n.transitionsChanged)this.internalState.uniformTransitions.add(r,e[r],t[r],t.transitions[r]);return this.setChangeFlags(n)}validateProps(){(0,m.eQ)(this.props)}setModuleParameters(t){for(const e of this.getModels())e.updateModuleSettings(t)}updateAutoHighlight(t){this.props.autoHighlight&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const e={pickingSelectedColor:t.picked?t.color:null},{highlightColor:n}=this.props;t.picked&&"function"==typeof n&&(e.pickingHighlightColor=n(t)),this.setModuleParameters(e),this.setNeedsRedraw()}_updateModules({props:t,oldProps:e},n){const{autoHighlight:r,highlightedObjectIndex:i,highlightColor:o}=t;if(n||e.autoHighlight!==r||e.highlightedObjectIndex!==i||e.highlightColor!==o){const t={};r||(t.pickingSelectedColor=null),Array.isArray(o)&&(t.pickingHighlightColor=o),Number.isInteger(i)&&(t.pickingSelectedColor=i>=0?this.encodePickingColor(i):null),this.setModuleParameters(t)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let e=!1;e=e||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags;const n=this.getAttributeManager(),r=n&&n.getNeedsRedraw(t);return e=e||r,e}_getAttributeManager(){return new i.Z(this.context.gl,{id:this.props.id,stats:this.context.stats,timeline:this.context.timeline})}_initState(){(0,v.Z)(!this.internalState&&!this.state),(0,v.Z)(isFinite(this.props.coordinateSystem));const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new et({attributeManager:t,layer:this}),this.clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(f.Z.deprecated("layer.state.attributeManager","layer.getAttributeManager()"),t)}),this.internalState.layer=this,this.internalState.uniformTransitions=new g(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props)}_transferState(t){(0,y.Z)("layer.matched",this,this===t);const{state:e,internalState:n}=t;this!==t&&(this.internalState=n,this.internalState.layer=this,this.state=e,this.internalState.setAsyncProps(this.props),this.diffProps(this.props,this.internalState.getOldProps()))}_onAsyncPropUpdated(){this.diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}ut.layerName="Layer",ut.defaultProps=lt},5409:(t,e,n)=>{"use strict";n.d(e,{d:()=>r,A:()=>i});const r={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},i={COMPONENT:Symbol.for("component"),ASYNC_DEFAULTS:Symbol.for("asyncPropDefaults"),ASYNC_ORIGINAL:Symbol.for("asyncPropOriginal"),ASYNC_RESOLVED:Symbol.for("asyncPropResolved")}},1761:(t,e,n)=>{"use strict";n.d(e,{eQ:()=>o,Yt:()=>s,tg:()=>l});var r=n(5409);const{COMPONENT:i}=r.A;function o(t){const e=p(t);for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function s(t,e){const n=l({newProps:t,oldProps:e,propTypes:p(t),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=function(t,e){if(null===e)return"oldProps is null, initial diff";let n=null;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}(t,e);let i=!1;return r||(i=function(t,e){if(null===e)return"oldProps is null, initial diff";if("all"in t.updateTriggers&&h(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)"all"!==i&&h(t,e,i)&&(n[i]=!0,r=n);return r}(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:c(t,e),transitionsChanged:a(t,e)}}function a(t,e){if(!t.transitions)return null;const n={},r=p(t);for(const i in t.transitions){const o=r[i],s=o&&o.type;("number"===s||"color"===s||"array"===s)&&u(t[i],e[i],o)&&(n[i]=!0)}return n}function l({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}={}){if(e===t)return null;if("object"!=typeof t||null===t)return"".concat(i," changed shallowly");if("object"!=typeof e||null===e)return"".concat(i," changed shallowly");for(const o of Object.keys(t))if(!(o in n)){if(!(o in e))return"".concat(i,".").concat(o," added");const n=u(t[o],e[o],r[o]);if(n)return"".concat(i,".").concat(o," ").concat(n)}for(const o of Object.keys(e))if(!(o in n)){if(!(o in t))return"".concat(i,".").concat(o," dropped");if(!Object.hasOwnProperty.call(t,o)){const n=u(t[o],e[o],r[o]);if(n)return"".concat(i,".").concat(o," ").concat(n)}}return null}function u(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)?"changed deeply":r||(r=t&&e&&t.equals,!r||r.call(t,e))?r||e===t?null:"changed shallowly":"changed deeply"}function c(t,e){if(null===e)return"oldProps is null, initial diff";const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(r.length!==n.length)return!0;for(let t=0;t<r.length;t++)if(!r[t].equals(n[t]))return!0;return!1}function h(t,e,n){let r=t.updateTriggers[n];r=null==r?{}:r;let i=e.updateTriggers[n];return i=null==i?{}:i,l({oldProps:i,newProps:r,triggerName:n})}function p(t){const e=t[i],n=e&&e.constructor;return n?n._propTypes:{}}},3182:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(830),i=n(9450),o=n(6047);class s extends r.Z{render(t){const e=this.gl;return(0,i.dR)(e,{framebuffer:t.target}),this._drawLayers(t)}_drawLayers(t){const{viewports:e,views:n,onViewportActive:r,clearCanvas:o=!0}=t;t.pass=t.pass||"unknown";const s=this.gl;o&&function(t){const e=t.drawingBufferWidth,n=t.drawingBufferHeight;(0,i.dR)(t,{viewport:[0,0,e,n]}),t.clear(16640)}(s);const a=[];for(const i of e){const e=i.viewport||i,o=n&&n[e.id];r(e);const l=this._getDrawLayerParams(e,t);t.view=o;const u=e.subViewports||[e];for(const e of u){t.viewport=e;const n=this._drawLayersInViewport(s,t,l);a.push(n)}}return a}_getDrawLayerParams(t,{layers:e,pass:n,layerFilter:r,effects:i,moduleParameters:o}){const s=[],l=a(),u={viewport:t,isPicking:n.startsWith("picking"),renderPass:n},c={};for(let a=0;a<e.length;a++){const h=e[a],p=this._shouldDrawLayer(h,u,r,c),f={shouldDrawLayer:p,layerRenderIndex:l(h,p)};p&&(f.moduleParameters=this._getModuleParameters(h,i,n,o),f.layerParameters=this.getLayerParameters(h,a,t)),s[a]=f}return s}_drawLayersInViewport(t,{layers:e,pass:n,viewport:r,view:s},a){const l=function(t,{viewport:e}){const n=t.canvas?t.canvas.clientHeight||t.canvas.height:100,r=e,o=(0,i.w)(t);return[r.x*o,(n-r.y-r.height)*o,r.width*o,r.height*o]}(t,{viewport:r});if(s&&s.props.clear){const e=!0===s.props.clear?{color:!0,depth:!0}:s.props.clear;(0,i.s8)(t,{scissorTest:!0,scissor:l},(()=>(0,o.Z)(t,e)))}const u={totalCount:e.length,visibleCount:0,compositeCount:0,pickableCount:0};(0,i.dR)(t,{viewport:l});for(let t=0;t<e.length;t++){const i=e[t],{shouldDrawLayer:o,layerRenderIndex:s,moduleParameters:l,layerParameters:c}=a[t];if(o&&i.props.pickable&&u.pickableCount++,i.isComposite)u.compositeCount++;else if(o){u.visibleCount++,l.viewport=r;try{i.drawLayer({moduleParameters:l,uniforms:{layerIndex:s},parameters:c})}catch(t){i.raiseError(t,"drawing ".concat(i," to ").concat(n))}}}return u}shouldDrawLayer(t){return!0}getModuleParameters(t,e){return null}getLayerParameters(t,e){return t.props.parameters}_shouldDrawLayer(t,e,n,r){if(!this.shouldDrawLayer(t)||!t.props.visible)return!1;e.layer=t;let i=t.parent;for(;i;){if(!i.props.visible||!i.filterSubLayer(e))return!1;e.layer=i,i=i.parent}if(n){const t=e.layer.id;if(t in r||(r[t]=n(e)),!r[t])return!1}return t.activateViewport(e.viewport),!0}_getModuleParameters(t,e,n,r){const o=Object.assign(Object.create(t.props),{autoWrapLongitude:t.wrapLongitude,viewport:t.context.viewport,mousePosition:t.context.mousePosition,pickingActive:0,devicePixelRatio:(0,i.w)(this.gl)});if(e)for(const n of e)Object.assign(o,n.getModuleParameters(t));return Object.assign(o,this.getModuleParameters(t,e),r)}}function a(t=0,e={}){const n={},r=(i,o)=>{const s=i.props._offset,l=i.id,u=i.parent&&i.parent.id;let c;if(u&&!(u in e)&&r(i.parent,!1),u in n){const t=n[u]=n[u]||a(e[u],e);c=t(i,o),n[l]=t}else Number.isFinite(s)?(c=s+(e[u]||0),n[l]=null):c=t;return o&&c>=t&&(t=c+1),e[l]=c,c};return r}},830:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});class r{constructor(t,e={}){const{id:n="pass"}=e;this.id=n,this.gl=t,this.props={...e}}setProps(t){Object.assign(this.props,t)}render(){}cleanup(){}}},930:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(3182),i=n(9450),o=n(744);const s={blendFunc:[1,0,32771,0],blendEquation:32774};class a extends r.Z{render(t){return t.pickingFBO?this._drawPickingBuffer(t):super.render(t)}_drawPickingBuffer({layers:t,layerFilter:e,views:n,viewports:r,onViewportActive:o,pickingFBO:a,deviceRect:{x:u,y:c,width:h,height:p},pass:f="picking",redrawReason:d,pickZ:g}){const m=this.gl;this.pickZ=g;const A=!g&&{byLayer:new Map,byAlpha:[]};this._colors=A;const y=(0,i.s8)(m,{scissorTest:!0,scissor:[u,c,h,p],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...s,blend:!g},(()=>super.render({target:a,layers:t,layerFilter:e,views:n,viewports:r,onViewportActive:o,pass:f,redrawReason:d})));return this._colors=null,{decodePickingColor:A&&l.bind(null,A),stats:y}}shouldDrawLayer(t){return t.props.pickable}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(t,e,n){const r={...t.props.parameters};return this.pickZ?r.blend=!1:(Object.assign(r,s),r.blend=!0,r.blendColor=function(t,e,n){const{byLayer:r,byAlpha:i}=t;let s;if(r.has(e)){const t=r.get(e);t.viewports.push(n),s=t.a}else if(s=r.size+1,s<=255){const t={a:s,layer:e,viewports:[n]};r.set(e,t),i[s]=t}else o.Z.warn("Too many pickable layers, only picking the first 255")(),s=0;return[0,0,0,s/255]}(this._colors,t,n)),r}}function l(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}},3117:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});const r={inject:{"vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  // for picking depth values\n  picking_setPickingAttribute(geometry.position.z);\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}},...n(3330).q}},8547:(t,e,n)=>{"use strict";n.d(e,{T:()=>c,D:()=>h});var r=n(4088),i=n(8771),o=n(6935),s=n(8333),a=n(7160),l=n(7682);function u(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof o.Z){const[n,i,o=0]=t,s=e.getDistanceScales([n,i]);r[2]=o*s.unitsPerMeter[2]}return r}function c(t,{viewport:e,modelMatrix:n,coordinateSystem:i,coordinateOrigin:o,offsetMode:a}){let[c,h,p=0]=t;switch(n&&([c,h,p]=s.fF([],[c,h,p,1],n)),i){case r.Df.LNGLAT:return u([c,h,p],e,a);case r.Df.LNGLAT_OFFSETS:return u([c+o[0],h+o[1],p+(o[2]||0)],e,a);case r.Df.METER_OFFSETS:return u((0,l.eG)(o,[c,h,p]),e,a);case r.Df.CARTESIAN:default:return e.isGeospatial?[c+o[0],h+o[1],p+o[2]]:e.projectPosition([c,h,p])}}function h(t,e){const{viewport:n,coordinateSystem:o,coordinateOrigin:s,modelMatrix:l,fromCoordinateSystem:u,fromCoordinateOrigin:h}=function(t){const e={...t};let{coordinateSystem:n}=t;const{viewport:i,coordinateOrigin:o,fromCoordinateSystem:s,fromCoordinateOrigin:a}=t;return n===r.Df.DEFAULT&&(n=i.isGeospatial?r.Df.LNGLAT:r.Df.CARTESIAN),void 0===s&&(e.fromCoordinateSystem=n),void 0===a&&(e.fromCoordinateOrigin=o),e.coordinateSystem=n,e}(e),{geospatialOrigin:p,shaderCoordinateOrigin:f,offsetMode:d}=(0,i.v)(n,o,s),g=c(t,{viewport:n,modelMatrix:l,coordinateSystem:u,coordinateOrigin:h,offsetMode:d});if(d){const t=n.projectPosition(p||f);a.lu(g,g,t)}return g}},3751:(t,e,n)=>{"use strict";n.d(e,{Z:()=>h});var r=n(5502);var i=n(4088);const o=Object.keys(i.Df).map((t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(i.Df[t],";"))).join(""),s=Object.keys(i.zG).map((t=>"const int PROJECTION_MODE_".concat(t," = ").concat(i.zG[t],";"))).join(""),a=Object.keys(i.iI).map((t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(i.iI[t],";"))).join(""),l="".concat(o,"\n").concat(s,"\n").concat(a,"\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\nuniform bool project_uPseudoMeters;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size() {\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\n    project_uPseudoMeters == false) {\n    \n    if (geometry.position.w == 0.0) {\n      float y = clamp(geometry.worldPosition.y, -89.9, 89.9);\n      return 1.0 / cos(radians(y));\n    }\n  \n    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\n    float y2 = y * y;\n    float y4 = y2 * y2;\n    float y6 = y4 * y2;\n    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n  }\n  return 1.0;\n}\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size();\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy * project_size();\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter * project_size();\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\nvec3 project_normal(vec3 vector) {\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  return normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size(position_world.z),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_size_to_pixel(float size, int unit) {\n  if (unit == UNIT_METERS) return project_size_to_pixel(size);\n  if (unit == UNIT_COMMON) return size * project_uScale;\n  return size;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\n");var u=n(8771);const c={},h={name:"project",dependencies:[r.O,{name:"geometry",vs:"\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n",fs:"\n#define SMOOTH_EDGE_RADIUS 0.5\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n"}],vs:l,getUniforms:function(t=c){return t.viewport?(0,u.C)(t):{}}}},8771:(t,e,n)=>{"use strict";n.d(e,{v:()=>f,C:()=>d});var r=n(5975),i=n(8333),o=n(4088),s=n(8177);const a=[0,0,0,0],l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],c=[0,0,0],h=[0,0,0],p=(0,s.Z)((function({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:s}){const{projectionCenter:u,viewProjectionMatrix:h,originCommon:p,cameraPosCommon:d,shaderCoordinateOrigin:g,geospatialOrigin:m}=function(t,e,n){const{viewMatrixUncentered:o,projectionMatrix:s}=t;let{viewMatrix:u,viewProjectionMatrix:c}=t,h=a,p=a,d=t.cameraPosition;const{geospatialOrigin:g,shaderCoordinateOrigin:m,offsetMode:A}=f(t,e,n);return A&&(p=t.projectPosition(g||m),d=[d[0]-p[0],d[1]-p[1],d[2]-p[2]],p[3]=1,h=i.fF([],p,c),u=o||u,c=r.Jp([],s,u),c=r.Jp([],c,l)),{viewMatrix:u,viewProjectionMatrix:c,projectionCenter:h,originCommon:p,cameraPosCommon:d,shaderCoordinateOrigin:m,geospatialOrigin:g}}(t,n,s),A=t.getDistanceScales(),y=[t.width*e,t.height*e],_=t.projectionMatrix.transform([0,0,-t.focalDistance,1])[3]||1,v={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:g,project_uCommonOrigin:p.slice(0,3),project_uCenter:u,project_uPseudoMeters:Boolean(t._pseudoMeters),project_uViewportSize:y,project_uDevicePixelRatio:e,project_uFocalDistance:_,project_uCommonUnitsPerMeter:A.unitsPerMeter,project_uCommonUnitsPerWorldUnit:A.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:c,project_uScale:t.scale,project_uViewProjectionMatrix:h,project_uCameraPosition:d};if(m){const e=t.getDistanceScales(m);switch(n){case o.Df.METER_OFFSETS:v.project_uCommonUnitsPerWorldUnit=e.unitsPerMeter,v.project_uCommonUnitsPerWorldUnit2=e.unitsPerMeter2;break;case o.Df.LNGLAT:case o.Df.LNGLAT_OFFSETS:t._pseudoMeters||(v.project_uCommonUnitsPerMeter=e.unitsPerMeter),v.project_uCommonUnitsPerWorldUnit=e.unitsPerDegree,v.project_uCommonUnitsPerWorldUnit2=e.unitsPerDegree2;break;case o.Df.CARTESIAN:v.project_uCommonUnitsPerWorldUnit=[1,1,e.unitsPerMeter[2]],v.project_uCommonUnitsPerWorldUnit2=[0,0,e.unitsPerMeter2[2]]}}return v}));function f(t,e,n=h){let r,i=n,s=!0;switch(r=e===o.Df.LNGLAT_OFFSETS||e===o.Df.METER_OFFSETS?n:t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case o.zG.WEB_MERCATOR:e!==o.Df.LNGLAT&&e!==o.Df.CARTESIAN||(r=[0,0,0],s=!1);break;case o.zG.WEB_MERCATOR_AUTO_OFFSET:e===o.Df.LNGLAT?i=r:e===o.Df.CARTESIAN&&(i=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],r=t.unprojectPosition(i),i[0]-=n[0],i[1]-=n[1],i[2]-=n[2]);break;case o.zG.IDENTITY:i=t.position.map(Math.fround);break;case o.zG.GLOBE:s=!1,r=null;break;default:s=!1}return i[2]=i[2]||0,{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:s}}function d({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=o.Df.DEFAULT,coordinateOrigin:i,autoWrapLongitude:s=!1}={}){r===o.Df.DEFAULT&&(r=t.isGeospatial?o.Df.LNGLAT:o.Df.CARTESIAN);const a=p({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return a.project_uWrapLongitude=s,a.project_uModelMatrix=n||u,a}},3844:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});const r={name:"project32",dependencies:[n(3751).Z],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    mat3 rotation = project_get_orientation_matrix(projectedPosition);\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"}},3115:(t,e,n)=>{"use strict";n.d(e,{Z:()=>f});var r=n(4088),i=n(3751),o=n(3467),s=n(3855),a=n(8177),l=n(7682);const u=(0,a.Z)((function({viewport:t,center:e}){return new o.Z(t.viewProjectionMatrix).invert().transform(e)})),c=(0,a.Z)((function({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,a=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map((t=>function(t,e){const[n,r,i]=t,o=(0,l.CT)([n,r,i],e);return Number.isFinite(i)?o:[o[0],o[1],0]}(t,r)));for(const r of e){const e=r.clone().translate(new s.Z(t.center).negate()),i=a.map((t=>e.transform(t))),l=(new o.Z).ortho({left:Math.min(...i.map((t=>t[0]))),right:Math.max(...i.map((t=>t[0]))),bottom:Math.min(...i.map((t=>t[1]))),top:Math.max(...i.map((t=>t[1]))),near:Math.min(...i.map((t=>-t[2]))),far:Math.max(...i.map((t=>-t[2])))});n.push(l.multiplyRight(r))}return n})),h=[0,0,0,1],p=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],f={name:"shadow",dependencies:[i.Z],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:(t={},e={})=>{if(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0){const{shadowEnabled:n=!0}=t;return n&&t.shadowMatrices&&t.shadowMatrices.length>0?function(t={},e={}){const n={shadow_uDrawShadowMap:Boolean(t.drawToShadowMap),shadow_uUseShadowMap:!!t.shadowMaps&&t.shadowMaps.length>0,shadow_uColor:t.shadowColor||h,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},i=u({viewport:t.viewport,center:e.project_uCenter}),o=[],a=c({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let n=0;n<t.shadowMatrices.length;n++){const l=a[n],u=l.clone().translate(new s.Z(t.viewport.center).negate());e.project_uCoordinateSystem===r.Df.LNGLAT&&e.project_uProjectionMode===r.zG.WEB_MERCATOR?(a[n]=u,o[n]=i):(a[n]=l.clone().multiplyRight(p),o[n]=u.transform(i))}for(let e=0;e<a.length;e++)n["shadow_uViewProjectionMatrices[".concat(e,"]")]=a[e],n["shadow_uProjectCenters[".concat(e,"]")]=o[e],t.shadowMaps&&t.shadowMaps.length>0?n["shadow_uShadowMap".concat(e)]=t.shadowMaps[e]:n["shadow_uShadowMap".concat(e)]=t.dummyShadowMap;return n}(t,e):{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1}}return{}}}},6497:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(6507),i=n(4034);const o=["longitude","latitude","zoom","bearing","pitch"],s=["longitude","latitude","zoom"];class a extends r.Z{constructor(t={}){super((Array.isArray(t)?t:t.transitionProps)||{compare:o,extract:o,required:s}),this.opts=t}initializeProps(t,e){const n=super.initializeProps(t,e),{makeViewport:r,around:i}=this.opts;if(r&&i){const o=r(t),s=r(e),a=o.unproject(i);n.start.around=i,Object.assign(n.end,{around:s.project(a),aroundPosition:a,width:e.width,height:e.height})}return n}interpolateProps(t,e,n){const r={};for(const o of this._propsToExtract)r[o]=(0,i.t7)(t[o]||0,e[o]||0,n);if(e.aroundPosition){const o=this.opts.makeViewport({...e,...r});Object.assign(r,o.panByPosition(e.aroundPosition,(0,i.t7)(t.around,e.around,n)))}return r}}},6507:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var r=n(4034),i=n(5304);class o{constructor(t={}){Array.isArray(t)&&(t={compare:t,extract:t,required:t});const{compare:e,extract:n,required:r}=t;this._propsToCompare=e,this._propsToExtract=n,this._requiredProps=r}arePropsEqual(t,e){for(const n of this._propsToCompare||Object.keys(e))if(!(n in t)||!(n in e)||!(0,r.fS)(t[n],e[n]))return!1;return!0}initializeProps(t,e){let n;if(this._propsToExtract){const r={},i={};for(const n of this._propsToExtract)r[n]=t[n],i[n]=e[n];n={start:r,end:i}}else n={start:t,end:e};return this._checkRequiredProps(n.start),this._checkRequiredProps(n.end),n}interpolateProps(t,e,n){return e}getDuration(t,e){return e.transitionDuration}_checkRequiredProps(t){this._requiredProps&&this._requiredProps.forEach((e=>{const n=t[e];(0,i.Z)(Number.isFinite(n)||Array.isArray(n),"".concat(e," is required for transition"))}))}}},3630:(t,e,n)=>{"use strict";function r(){}n.d(e,{Z:()=>o});const i={onStart:r,onUpdate:r,onInterrupt:r,onEnd:r};class o{constructor(t){this._inProgress=!1,this._handle=null,this.timeline=t,this.settings={}}get inProgress(){return this._inProgress}start(t){this.cancel(),this.settings={...i,...t},this._inProgress=!0,this.settings.onStart(this)}end(){this._inProgress&&(this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd(this))}cancel(){this._inProgress&&(this.settings.onInterrupt(this),this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(null===this._handle){const{timeline:t,settings:e}=this;this._handle=t.addChannel({delay:t.getTime(),duration:e.duration})}return this.time=this.timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate(this),this.timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}},5304:(t,e,n)=>{"use strict";function r(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}n.d(e,{Z:()=>r})},5015:(t,e,n)=>{"use strict";function r(t){if(null===(e=t)||"object"!=typeof e)throw new Error("count(): argument not an object");var e;if("function"==typeof t.count)return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(function(t){return null!==t&&"object"==typeof t&&t.constructor===Object}(t))return Object.keys(t).length;throw new Error("count(): argument not a container")}n.d(e,{Q:()=>r})},6871:(t,e,n)=>{"use strict";function r(t,e){if(t===e)return!0;if(!t||!e)return!1;for(const n in t){const i=t[n],o=e[n];if(!(i===o||Array.isArray(i)&&Array.isArray(o)&&r(i,o)))return!1}return!0}n.d(e,{v:()=>r})},1855:(t,e,n)=>{"use strict";function r(t,e=(()=>!0)){return Array.isArray(t)?i(t,e,[]):e(t)?[t]:[]}function i(t,e,n){let r=-1;for(;++r<t.length;){const o=t[r];Array.isArray(o)?i(o,e,n):e(o)&&n.push(o)}return n}function o({target:t,source:e,start:n=0,count:r=1}){const i=e.length,o=r*i;let s=0;for(let r=n;s<i;s++)t[r++]=e[s];for(;s<o;)s<o-s?(t.copyWithin(n+s,n,n+s),s*=2):(t.copyWithin(n+s,n,n+o-s),s=o);return t}n.d(e,{x:()=>r,k:()=>o})},8550:(t,e,n)=>{"use strict";n.d(e,{jB:()=>o,D0:()=>s,jr:()=>a});const r=[],i=[];function o(t,e=0,n=1/0){let o=r;const s={index:-1,data:t,target:[]};return t?"function"==typeof t[Symbol.iterator]?o=t:t.length>0&&(i.length=t.length,o=i):o=r,(e>0||Number.isFinite(n))&&(o=(Array.isArray(o)?o:Array.from(o)).slice(e,n),s.index=e-1),{iterable:o,objectInfo:s}}function s(t){return t&&t[Symbol.asyncIterator]}function a(t,{size:e,stride:n,offset:r,startIndices:i,nested:o}){const s=t.BYTES_PER_ELEMENT,a=n?n/s:e,l=r?r/s:0,u=Math.floor((t.length-l)/a);return(n,{index:r,target:s})=>{if(!i){const n=r*a+l;for(let r=0;r<e;r++)s[r]=t[n+r];return s}const c=i[r],h=i[r+1]||u;let p;if(o){p=new Array(h-c);for(let n=c;n<h;n++){const r=n*a+l;s=new Array(e);for(let n=0;n<e;n++)s[n]=t[r+n];p[n-c]=s}}else if(a===e)p=t.subarray(c*e+l,h*e+l);else{p=new t.constructor((h-c)*e);let n=0;for(let r=c;r<h;r++){const i=r*a+l;for(let r=0;r<e;r++)p[n++]=t[i+r]}}return p}}},744:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});const r=new(n(4708).Z)({id:"deck"})},5126:(t,e,n)=>{"use strict";n.d(e,{bS:()=>o,wQ:()=>s,Xt:()=>a,Du:()=>l,Ks:()=>h,TK:()=>f});var r=n(6610),i=n(3855);function o(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function s(t,e){const n=t%e;return n<0?e+n:n}function a(t){return[t[12],t[13],t[14]]}function l(t){const e={};return e.left=c(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),e.right=c(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),e.bottom=c(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),e.top=c(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),e.near=c(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),e.far=c(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14]),e}const u=new i.Z;function c(t,e,n,r){u.set(t,e,n);const o=u.len();return{distance:r/o,normal:new i.Z(-t/o,-e/o,-n/o)}}function h(t){return t-Math.fround(t)}let p;function f(t,{size:e=1,startIndex:n=0,endIndex:i}){Number.isFinite(i)||(i=t.length);const o=(i-n)/e;p=r.Z.allocate(p,o,{type:Float32Array,size:2*e});let s=n,a=0;for(;s<i;){for(let n=0;n<e;n++){const r=t[s++];p[a+n]=r,p[a+n+e]=h(r)}a+=2*e}return p.subarray(0,o*e*2)}},8177:(t,e,n)=>{"use strict";function r(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function i(t){let e,n={};return i=>{for(const o in i)if(!r(i[o],n[o])){e=t(i),n=i;break}return e}}n.d(e,{Z:()=>i})},7870:(t,e,n)=>{"use strict";function r(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some((t=>"project64"===t.name)))){const t=n.modules.findIndex((t=>"project32"===t.name));t>=0&&n.modules.splice(t,1)}if("inject"in e)if(t.inject){const r={...t.inject};for(const t in e.inject)r[t]=(r[t]||"")+e.inject[t];n.inject=r}else n.inject=e.inject;return n}n.d(e,{l:()=>r})},8005:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(8550),i=n(6610),o=n(5304),s=n(3478);class a{constructor(t={}){const{attributes:e={}}=t;this.typedArrayManager=i.Z,this.indexStarts=null,this.vertexStarts=null,this.vertexCount=0,this.instanceCount=0,this.attributes={},this._attributeDefs=e,this.opts=t,this.updateGeometry(t),Object.seal(this)}updateGeometry(t){Object.assign(this.opts,t);const{data:e,buffers:n={},getGeometry:r,geometryBuffer:i,positionFormat:s,dataChanged:a,normalize:l=!0}=this.opts;if(this.data=e,this.getGeometry=r,this.positionSize=i&&i.size||("XY"===s?2:3),this.buffers=n,this.normalize=l,i&&((0,o.Z)(e.startIndices),this.getGeometry=this.getGeometryFromBuffer(i),l||(n.positions=i)),this.geometryBuffer=n.positions,Array.isArray(a))for(const t of a)this._rebuildGeometry(t);else this._rebuildGeometry()}updatePartialGeometry({startRow:t,endRow:e}){this._rebuildGeometry({startRow:t,endRow:e})}normalizeGeometry(t){return t}updateGeometryAttributes(t,e,n){throw new Error("Not implemented")}getGeometrySize(t){throw new Error("Not implemented")}getGeometryFromBuffer(t){const e=t.value||t;return(0,o.Z)(ArrayBuffer.isView(e)),(0,r.jr)(e,{size:this.positionSize,offset:t.offset,stride:t.stride,startIndices:this.data.startIndices})}_allocate(t,e){const{attributes:n,buffers:r,_attributeDefs:i,typedArrayManager:o}=this;for(const s in i)if(s in r)o.release(n[s]),n[s]=null;else{const r=i[s];r.copy=e,n[s]=o.allocate(n[s],t,r)}}_forEachGeometry(t,e,n){const{data:i,getGeometry:o}=this,{iterable:s,objectInfo:a}=(0,r.jB)(i,e,n);for(const e of s)a.index++,t(o(e,a),a.index)}_rebuildGeometry(t){if(!this.data||!this.getGeometry)return;let{indexStarts:e,vertexStarts:n,instanceCount:r}=this;const{data:i,geometryBuffer:o}=this,{startRow:a=0,endRow:l=1/0}=t||{},u={};if(t||(e=[0],n=[0]),this.normalize||!o)this._forEachGeometry(((t,e)=>{t=this.normalizeGeometry(t),u[e]=t,n[e+1]=n[e]+this.getGeometrySize(t)}),a,l),r=n[n.length-1];else if(o.buffer instanceof s.Z){const t=o.stride||4*this.positionSize;n=i.startIndices,r=n[i.length]||o.buffer.byteLength/t}else{const t=o.value||o,e=o.stride/t.BYTES_PER_ELEMENT||this.positionSize;n=i.startIndices,r=n[i.length]||t.length/e}this._allocate(r,Boolean(t)),this.indexStarts=e,this.vertexStarts=n,this.instanceCount=r;const c={};this._forEachGeometry(((t,i)=>{t=u[i]||t,c.vertexStart=n[i],c.indexStart=e[i];const o=i<n.length-1?n[i+1]:r;c.geometrySize=o-n[i],c.geometryIndex=i,this.updateGeometryAttributes(t,c)}),a,l),this.vertexCount=e[e.length-1]}}},6610:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});const r=new class{constructor(t){this._pool=[],this.props={overAlloc:2,poolSize:100},this.setProps(t)}setProps(t){Object.assign(this.props,t)}allocate(t,e,{size:n=1,type:r,padding:i=0,copy:o=!1,initialize:s=!1,maxCount:a}){const l=r||t&&t.constructor||Float32Array,u=e*n+i;if(ArrayBuffer.isView(t)){if(u<=t.length)return t;if(u*t.BYTES_PER_ELEMENT<=t.buffer.byteLength)return new l(t.buffer,0,u)}let c;a&&(c=a*n+i);const h=this._allocate(l,u,s,c);return t&&o?h.set(t):s||h.fill(0,0,4),this._release(t),h}release(t){this._release(t)}_allocate(t,e,n,r){let i=Math.max(Math.ceil(e*this.props.overAlloc),1);i>r&&(i=r);const o=this._pool,s=t.BYTES_PER_ELEMENT*i,a=o.findIndex((t=>t.byteLength>=s));if(a>=0){const e=new t(o.splice(a,1)[0],0,i);return n&&e.fill(0),e}return new t(i)}_release(t){if(!ArrayBuffer.isView(t))return;const e=this._pool,{buffer:n}=t,{byteLength:r}=n,i=e.findIndex((t=>t.byteLength>=r));i<0?e.push(n):(i>0||e.length<this.props.poolSize)&&e.splice(i,0,n),e.length>this.props.poolSize&&e.shift()}}},7013:(t,e,n)=>{"use strict";n.d(e,{Z:()=>g});var r=n(744),i=n(5126),o=n(4034),s=n(3467),a=n(3855),l=n(5975),u=n(7682),c=n(4088);const h=Math.PI/180,p=(0,i.bS)(),f=[0,0,0],d={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};class g{constructor(t={}){const{id:e=null,x:n=0,y:r=0,width:i=1,height:o=1}=t;this.id=e||this.constructor.displayName||"viewport",this.x=n,this.y=r,this.width=i||1,this.height=o||1,this._frustumPlanes={},this._initViewMatrix(t),this._initProjectionMatrix(t),this._initPixelMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?c.zG.WEB_MERCATOR:c.zG.WEB_MERCATOR_AUTO_OFFSET:c.zG.IDENTITY}equals(t){return t instanceof g&&(this===t||t.width===this.width&&t.height===this.height&&t.scale===this.scale&&(0,o.fS)(t.projectionMatrix,this.projectionMatrix)&&(0,o.fS)(t.viewMatrix,this.viewMatrix))}project(t,{topLeft:e=!0}={}){const n=this.projectPosition(t),r=(0,u.aW)(n,this.pixelProjectionMatrix),[i,o]=r,s=e?o:this.height-o;return 2===t.length?[i,s]:[i,s,r[2]]}unproject(t,{topLeft:e=!0,targetZ:n}={}){const[r,i,o]=t,s=e?i:this.height-i,a=n&&n*this.distanceScales.unitsPerMeter[2],l=(0,u.CT)([r,s,o],this.pixelUnprojectionMatrix,a),[c,h,p]=this.unprojectPosition(l);return Number.isFinite(o)?[c,h,p]:Number.isFinite(n)?[c,h,n]:[c,h]}projectPosition(t){const[e,n]=this.projectFlat(t);return[e,n,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[e,n]=this.unprojectFlat(t);return[e,n,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){return this.isGeospatial?(0,u.w5)(t):t}unprojectFlat(t){return this.isGeospatial?(0,u.es)(t):t}getBounds(t={}){const e={targetZ:t.z||0},n=this.unproject([0,0],e),r=this.unproject([this.width,0],e),i=this.unproject([0,this.height],e),o=this.unproject([this.width,this.height],e);return[Math.min(n[0],r[0],i[0],o[0]),Math.min(n[1],r[1],i[1],o[1]),Math.max(n[0],r[0],i[0],o[0]),Math.max(n[1],r[1],i[1],o[1])]}getDistanceScales(t=null){return t?(0,u.ro)({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel({x:t,y:e,width:n=1,height:r=1}){return t<this.x+this.width&&this.x<t+n&&e<this.y+this.height&&this.y<e+r}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,(0,i.Du)(this.viewProjectionMatrix)),this._frustumPlanes}panByPosition(t,e){return null}getCameraPosition(){return this.cameraPosition}getCameraDirection(){return this.cameraDirection}getCameraUp(){return this.cameraUp}_createProjectionMatrix({orthographic:t,fovyRadians:e,aspect:n,focalDistance:r,near:i,far:o}){return t?(new s.Z).orthographic({fovy:e,aspect:n,focalDistance:r,near:i,far:o}):(new s.Z).perspective({fovy:e,aspect:n,near:i,far:o})}_initViewMatrix(t){const{viewMatrix:e=p,longitude:n=null,latitude:r=null,zoom:i=null,position:o=null,modelMatrix:l=null,focalDistance:c=1,distanceScales:h=null}=t;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this.zoom=i,Number.isFinite(this.zoom)||(this.zoom=this.isGeospatial?(0,u.Bf)({latitude:r})+Math.log2(c):0);const g=Math.pow(2,this.zoom);this.scale=g,this.distanceScales=this.isGeospatial?(0,u.ro)({latitude:r,longitude:n}):h||d,this.focalDistance=c,this.distanceScales.metersPerUnit=new a.Z(this.distanceScales.metersPerUnit),this.distanceScales.unitsPerMeter=new a.Z(this.distanceScales.unitsPerMeter),this.position=f,this.meterOffset=f,o&&(this.position=o,this.modelMatrix=l,this.meterOffset=l?l.transformVector(o):o),this.isGeospatial?(this.longitude=n,this.latitude=r,this.center=this._getCenterInWorld({longitude:n,latitude:r})):this.center=o?this.projectPosition(o):[0,0,0],this.viewMatrixUncentered=e,this.viewMatrix=(new s.Z).multiplyRight(this.viewMatrixUncentered).translate(new a.Z(this.center||f).negate())}_getCenterInWorld({longitude:t,latitude:e}){const{meterOffset:n,distanceScales:r}=this,i=new a.Z(this.projectPosition([t,e,0]));if(n){const t=new a.Z(n).scale(r.unitsPerMeter);i.add(t)}return i}_initProjectionMatrix(t){const{projectionMatrix:e=null,orthographic:n=!1,fovyRadians:r,fovy:i=75,near:o=.1,far:s=1e3,focalDistance:a=1}=t;this.projectionMatrix=e||this._createProjectionMatrix({orthographic:n,fovyRadians:r||i*h,aspect:this.width/this.height,focalDistance:a,near:o,far:s})}_initPixelMatrices(){const t=(0,i.bS)();l.Jp(t,t,this.projectionMatrix),l.Jp(t,t,this.viewMatrix),this.viewProjectionMatrix=t,this.viewMatrixInverse=l.U_([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=(0,i.Xt)(this.viewMatrixInverse);const e=(0,i.bS)(),n=(0,i.bS)();l.bA(e,e,[this.width/2,-this.height/2,1]),l.Iu(e,e,[1,-1,0]),l.Jp(n,e,this.viewProjectionMatrix),this.pixelProjectionMatrix=n,this.viewportMatrix=e,this.pixelUnprojectionMatrix=l.U_((0,i.bS)(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||r.Z.warn("Pixel project matrix not invertible")()}}g.displayName="Viewport"},6935:(t,e,n)=>{"use strict";n.d(e,{Z:()=>u});var r=n(7013),i=n(7682),o=n(1437),s=n(3467);const a=Math.PI/180;function l(t){return 512/4003e4/Math.cos(t*a)}class u extends r.Z{constructor(t={}){const{latitude:e=0,longitude:n=0,zoom:r=11,pitch:o=0,bearing:a=0,nearZMultiplier:l=.1,farZMultiplier:u=1.01,orthographic:c=!1,projectionMatrix:h,repeat:p=!1,worldOffset:f=0,legacyMeterSizes:d=!1}=t;let{width:g,height:m,altitude:A=1.5}=t;const y=Math.pow(2,r);let _;g=g||1,m=m||1;let v=null;h?(A=h[5]/2,_=(0,i.Lu)(A)):(t.fovy?(_=t.fovy,A=(0,i.sj)(_)):_=(0,i.Lu)(A),v=(0,i.wl)({width:g,height:m,pitch:o,fovy:_,nearZMultiplier:l,farZMultiplier:u}));let b=(0,i.lf)({height:m,pitch:o,bearing:a,scale:y,altitude:A});f&&(b=(new s.Z).translate([512*f,0,0]).multiplyLeft(b)),super({...t,width:g,height:m,viewMatrix:b,longitude:n,latitude:e,zoom:r,...v,fovy:_,focalDistance:A}),this.latitude=e,this.longitude=n,this.zoom=r,this.pitch=o,this.bearing=a,this.altitude=A,this.fovy=_,this.orthographic=c,this._subViewports=p?[]:null,this._pseudoMeters=d,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),e=Math.floor((t[0]+180)/360),n=Math.ceil((t[2]-180)/360);for(let t=e;t<=n;t++){const e=t?new u({...this,worldOffset:t}):this;this._subViewports.push(e)}}return this._subViewports}projectPosition(t){if(this._pseudoMeters)return super.projectPosition(t);const[e,n]=this.projectFlat(t);return[e,n,(t[2]||0)*l(t[1])]}unprojectPosition(t){if(this._pseudoMeters)return super.unprojectPosition(t);const[e,n]=this.unprojectFlat(t);return[e,n,(t[2]||0)/l(n)]}addMetersToLngLat(t,e){return(0,i.eG)(t,e)}panByPosition(t,e){const n=(0,i.CT)(e,this.pixelUnprojectionMatrix),r=this.projectFlat(t),s=o.IH([],r,o.tk([],n)),a=o.IH([],this.center,s),[l,u]=this.unprojectFlat(a);return{longitude:l,latitude:u}}getBounds(t={}){const e=(0,i.zX)(this,t.z||0);return[Math.min(e[0][0],e[1][0],e[2][0],e[3][0]),Math.min(e[0][1],e[1][1],e[2][1],e[3][1]),Math.max(e[0][0],e[1][0],e[2][0],e[3][0]),Math.max(e[0][1],e[1][1],e[2][1],e[3][1])]}fitBounds(t,e={}){const{width:n,height:r}=this,{longitude:o,latitude:s,zoom:a}=(0,i.Xg)({width:n,height:r,bounds:t,...e});return new u({width:n,height:r,longitude:o,latitude:s,zoom:a})}}u.displayName="WebMercatorViewport"},4009:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(4897),i=n(6935),o=n(6883);class s extends r.Z{constructor(t){super({...t,type:i.Z})}get controller(){return this._getControllerProps({type:o.Z})}}s.displayName="MapView"},4897:(t,e,n)=>{"use strict";n.d(e,{Z:()=>u});var r=n(7013);const i=/([0-9]+\.?[0-9]*)(%|px)/;function o(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=t.match(i);if(e&&e.length>=3){const t="%"===e[2],n=parseFloat(e[1]);return{position:t?n/100:n,relative:t}}default:throw new Error("Could not parse position string ".concat(t))}}function s(t,e){return t.relative?Math.round(t.position*e):t.position}var a=n(6871),l=n(5304);class u{constructor(t={}){const{id:e=null,x:n=0,y:i=0,width:o="100%",height:s="100%",viewportInstance:a,type:u=r.Z}=t;(0,l.Z)(!a||a instanceof r.Z),this.viewportInstance=a,this.id=e||this.constructor.displayName||"view",this.type=u,this.props={...t,id:this.id},this._parseDimensions({x:n,y:i,width:o,height:s}),this.equals=this.equals.bind(this),Object.seal(this)}equals(t){return this===t||(this.viewportInstance?t.viewportInstance&&this.viewportInstance.equals(t.viewportInstance):(0,a.v)(this.props,t.props))}makeViewport({width:t,height:e,viewState:n}){if(this.viewportInstance)return this.viewportInstance;n=this.filterViewState(n);const r=this.getDimensions({width:t,height:e});return this._getViewport(n,r)}getViewStateId(){switch(typeof this.props.viewState){case"string":return this.props.viewState;case"object":return this.props.viewState&&this.props.viewState.id;default:return this.id}}filterViewState(t){if(this.props.viewState&&"object"==typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const e={...t};for(const t in this.props.viewState)"id"!==t&&(e[t]=this.props.viewState[t]);return e}return t}getDimensions({width:t,height:e}){return{x:s(this._x,t),y:s(this._y,e),width:s(this._width,t),height:s(this._height,e)}}_getControllerProps(t){let e=this.props.controller;return e?!0===e?t:("function"==typeof e&&(e={type:e}),{...t,...e}):null}_getViewport(t,e){const{type:n}=this;return new n({...t,...this.props,...e})}_parseDimensions({x:t,y:e,width:n,height:r}){this._x=o(t),this._y=o(e),this._width=o(n),this._height=o(r)}}},4086:(t,e,n)=>{"use strict";n.r(e),n.d(e,{GreatCircleLayer:()=>i,H3ClusterLayer:()=>qt,H3HexagonLayer:()=>Qt,MVTLayer:()=>Wr,S2Layer:()=>A,TerrainLayer:()=>xr,Tile3DLayer:()=>mr,TileLayer:()=>zt,TripsLayer:()=>Ut});var r=n(4717);class i extends r.Z{}i.layerName="GreatCircleLayer",i.defaultProps={getHeight:{type:"accessor",value:0},greatCircle:!0};var o=n(8918),s=n(3121),a=n(514),l=n.n(a);const u=180/Math.PI;function c(t,e,n){const r=1<<e;return[(t[0]+n[0])/r,(t[1]+n[1])/r]}function h(t){return t>=.5?1/3*(4*t*t-1):1/3*(1-4*(1-t)*(1-t))}function p(t,[e,n]){switch(t){case 0:return[1,e,n];case 1:return[-e,1,n];case 2:return[-e,-n,1];case 3:return[-1,-n,-e];case 4:return[n,-1,-e];case 5:return[n,e,-1];default:throw new Error("Invalid face")}}function f([t,e,n]){const r=Math.atan2(n,Math.sqrt(t*t+e*e));return[Math.atan2(e,t)*u,r*u]}function d(t,e,n,r){if(0===r){1===n&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const r=e[0];e[0]=e[1],e[1]=r}}function g(t){const e=function(t){const e=t.split("/"),n=parseInt(e[0],10),r=e[1],i=r.length,o=[0,0];let s;for(let t=i-1;t>=0;t--){s=i-t;const e=r[t];let n=0,a=0;"1"===e?a=1:"2"===e?(n=1,a=1):"3"===e&&(n=1);const l=Math.pow(2,s-1);d(l,o,n,a),o[0]+=l*n,o[1]+=l*a}if(n%2==1){const t=o[0];o[0]=o[1],o[1]=t}return{face:n,ij:o,level:s}}(function(t){if("string"==typeof t){if(t.indexOf("/")>0)return t;t=function(t){const e=t.padEnd(16,"0");return l().fromString(e,16)}(t)}return function(t){let e=l().fromString(t,!0,10).toString(2);for(;e.length<64;)e="0"+e;const n=e.lastIndexOf("1"),r=e.substring(0,3),i=e.substring(3,n),o=i.length/2,s=l().fromString(r,!0,2).toString(10);let a=l().fromString(i,!0,2).toString(4);for(;a.length<o;)a="0"+a;return"".concat(s,"/").concat(a)}(t.toString())}(t));return function({face:t,ij:e,level:n}){const r=[[0,0],[0,1],[1,1],[1,0],[0,0]],i=Math.max(1,Math.ceil(100*Math.pow(2,-n))),o=new Float64Array(4*i*2+2);let s=0,a=0;for(let u=0;u<4;u++){const d=r[u].slice(0),g=r[u+1],m=(g[0]-d[0])/i,A=(g[1]-d[1])/i;for(let r=0;r<i;r++){d[0]+=m,d[1]+=A;const r=f(p(t,[h((l=c(e,n,d))[0]),h(l[1])]));Math.abs(r[1])>89.999&&(r[0]=a);const i=r[0]-a;r[0]+=i>180?-360:i<-180?360:0,o[s++]=r[0],o[s++]=r[1],a=r[0]}}var l;return o[s++]=o[0],o[s++]=o[1],o}(e)}const m={...s.Z.defaultProps,getS2Token:{type:"accessor",value:t=>t.token}};class A extends o.Z{renderLayers(){const{data:t,getS2Token:e}=this.props,{elevationScale:n,extruded:r,wireframe:i,filled:o,stroked:a,lineWidthUnits:l,lineWidthScale:u,lineWidthMinPixels:c,lineWidthMaxPixels:h,lineJointRounded:p,lineMiterLimit:f,lineDashJustified:d,getElevation:m,getFillColor:A,getLineColor:y,getLineWidth:_,getLineDashArray:v}=this.props,{updateTriggers:b,material:x}=this.props;return new(this.getSubLayerClass("cell",s.Z))({filled:o,wireframe:i,extruded:r,elevationScale:n,stroked:a,lineWidthUnits:l,lineWidthScale:u,lineWidthMinPixels:c,lineWidthMaxPixels:h,lineJointRounded:p,lineMiterLimit:f,lineDashJustified:d,material:x,getElevation:m,getFillColor:A,getLineColor:y,getLineWidth:_,getLineDashArray:v},this.getSubLayerProps({id:"cell",updateTriggers:{getElevation:b.getElevation,getFillColor:b.getFillColor,getLineColor:b.getLineColor,getLineWidth:b.getLineWidth,getLineDashArray:b.getLineDashArray}}),{data:t,_normalize:!1,positionFormat:"XY",getPolygon:(t,n)=>g(e(t,n))})}}A.layerName="S2Layer",A.defaultProps=m;var y=n(1855),_=n(9026),v=n(744);class b{constructor({x:t,y:e,z:n}){this.x=t,this.y=e,this.z=n,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get data(){return this.isLoading?this._loader.then((()=>this.data)):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return Boolean(this._loader)&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const t=this.content?this.content.byteLength:0;return Number.isFinite(t)||v.Z.error("byteLength not defined in tile data")(),t}async _loadData({getData:t,requestScheduler:e,onLoad:n,onError:r}){const{x:i,y:o,z:s,bbox:a}=this,l=this._loaderId;this._abortController=new AbortController;const{signal:u}=this._abortController,c=await e.scheduleRequest(this,(t=>t.isSelected?1:-1));if(!c)return void(this._isCancelled=!0);if(this._isCancelled)return void c.done();let h,p=null;try{p=await t({x:i,y:o,z:s,bbox:a,signal:u})}catch(t){h=t||!0}finally{c.done()}l===this._loaderId&&(this._loader=void 0,this.content=p,!this._isCancelled||p?(this._isLoaded=!0,this._isCancelled=!1,h?r(h,this):n(this)):this._isLoaded=!1)}loadData(t){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(t),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){this.isLoaded||(this._isCancelled=!0,this._abortController.abort())}}const x=Object.freeze({OUTSIDE:-1,INTERSECTING:0,INSIDE:1});var w=n(3855);const E=new w.Z,S=new w.Z;class T{constructor(t=[0,0,0],e=[0,0,0],n=null){n=n||E.copy(t).add(e).scale(.5),this.center=new w.Z(n),this.halfDiagonal=new w.Z(e).subtract(this.center),this.minimum=new w.Z(t),this.maximum=new w.Z(e)}clone(){return new T(this.minimum,this.maximum,this.center)}equals(t){return this===t||Boolean(t)&&this.minimum.equals(t.minimum)&&this.maximum.equals(t.maximum)}transform(t){return this.center.transformAsPoint(t),this.halfDiagonal.transform(t),this.minimum.transform(t),this.maximum.transform(t),this}intersectPlane(t){const{halfDiagonal:e}=this,n=S.from(t.normal),r=e.x*Math.abs(n.x)+e.y*Math.abs(n.y)+e.z*Math.abs(n.z),i=this.center.dot(n)+t.distance;return i-r>0?x.INSIDE:i+r<0?x.OUTSIDE:x.INTERSECTING}distanceTo(t){return Math.sqrt(this.distanceSquaredTo(t))}distanceSquaredTo(t){const e=E.from(t).subtract(this.center),{halfDiagonal:n}=this;let r,i=0;return r=Math.abs(e.x)-n.x,r>0&&(i+=r*r),r=Math.abs(e.y)-n.y,r>0&&(i+=r*r),r=Math.abs(e.z)-n.z,r>0&&(i+=r*r),i}}const P=new w.Z,M=new w.Z;class C{constructor(t=[0,0,0],e=0){this.radius=-0,this.center=new w.Z,this.fromCenterRadius(t,e)}fromCenterRadius(t,e){return this.center.from(t),this.radius=e,this}fromCornerPoints(t,e){return e=P.from(e),this.center=(new w.Z).from(t).add(e).scale(.5),this.radius=this.center.distance(e),this}equals(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.radius===t.radius}clone(){return new C(this.center,this.radius)}union(t){const e=this.center,n=this.radius,r=t.center,i=t.radius,o=P.copy(r).subtract(e),s=o.magnitude();if(n>=s+i)return this.clone();if(i>=s+n)return t.clone();const a=.5*(n+s+i);return M.copy(o).scale((-n+a)/s).add(e),this.center.copy(M),this.radius=a,this}expand(t){const e=(t=P.from(t)).subtract(this.center).magnitude();return e>this.radius&&(this.radius=e),this}transform(t){this.center.transform(t);const e=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[4],s=e[5],a=e[6],l=e[8],u=e[9],c=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(o,s,a),t[2]=Math.hypot(l,u,c),t}(P,t);return this.radius=Math.max(e[0],Math.max(e[1],e[2]))*this.radius,this}distanceSquaredTo(t){const e=this.distanceTo(t);return e*e}distanceTo(t){const e=(t=P.from(t)).subtract(this.center);return Math.max(0,e.len()-this.radius)}intersectPlane(t){const e=this.center,n=this.radius,r=t.normal.dot(e)+t.distance;return r<-n?x.OUTSIDE:r<n?x.INTERSECTING:x.INSIDE}}var I=n(540),O=n(7696);const R=new w.Z,L=new w.Z,k=new w.Z,D=new w.Z,N=new w.Z,F=new w.Z,B=new w.Z;class z{constructor(t=[0,0,0],e=[0,0,0,0,0,0,0,0,0]){this.center=(new w.Z).from(t),this.halfAxes=new I.Z(e)}get halfSize(){const t=this.halfAxes.getColumn(0),e=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2);return[new w.Z(t).len(),new w.Z(e).len(),new w.Z(n).len()]}get quaternion(){const t=this.halfAxes.getColumn(0),e=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2),r=new w.Z(t).normalize(),i=new w.Z(e).normalize(),o=new w.Z(n).normalize();return(new O.Z).fromMatrix3(new I.Z([...r,...i,...o]))}fromCenterHalfSizeQuaternion(t,e,n){const r=new O.Z(n),i=(new I.Z).fromQuaternion(r);return i[0]=i[0]*e[0],i[1]=i[1]*e[0],i[2]=i[2]*e[0],i[3]=i[3]*e[1],i[4]=i[4]*e[1],i[5]=i[5]*e[1],i[6]=i[6]*e[2],i[7]=i[7]*e[2],i[8]=i[8]*e[2],this.center=(new w.Z).from(t),this.halfAxes=i,this}clone(){return new z(this.center,this.halfAxes)}equals(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.halfAxes.equals(t.halfAxes)}getBoundingSphere(t=new C){const e=this.halfAxes,n=e.getColumn(0,k),r=e.getColumn(1,D),i=e.getColumn(2,N),o=R.copy(n).add(r).add(i);return t.center.copy(this.center),t.radius=o.magnitude(),t}intersectPlane(t){const e=this.center,n=t.normal,r=this.halfAxes,i=n.x,o=n.y,s=n.z,a=Math.abs(i*r[0]+o*r[1]+s*r[2])+Math.abs(i*r[3]+o*r[4]+s*r[5])+Math.abs(i*r[6]+o*r[7]+s*r[8]),l=n.dot(e)+t.distance;return l<=-a?x.OUTSIDE:l>=a?x.INSIDE:x.INTERSECTING}distanceTo(t){return Math.sqrt(this.distanceSquaredTo(t))}distanceSquaredTo(t){const e=L.from(t).subtract(this.center),n=this.halfAxes,r=n.getColumn(0,k),i=n.getColumn(1,D),o=n.getColumn(2,N),s=r.magnitude(),a=i.magnitude(),l=o.magnitude();r.normalize(),i.normalize(),o.normalize();let u,c=0;return u=Math.abs(e.dot(r))-s,u>0&&(c+=u*u),u=Math.abs(e.dot(i))-a,u>0&&(c+=u*u),u=Math.abs(e.dot(o))-l,u>0&&(c+=u*u),c}computePlaneDistances(t,e,n=[-0,-0]){let r=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;const o=this.center,s=this.halfAxes,a=s.getColumn(0,k),l=s.getColumn(1,D),u=s.getColumn(2,N),c=F.copy(a).add(l).add(u).add(o),h=B.copy(c).subtract(t);let p=e.dot(h);return r=Math.min(p,r),i=Math.max(p,i),c.copy(o).add(a).add(l).subtract(u),h.copy(c).subtract(t),p=e.dot(h),r=Math.min(p,r),i=Math.max(p,i),c.copy(o).add(a).subtract(l).add(u),h.copy(c).subtract(t),p=e.dot(h),r=Math.min(p,r),i=Math.max(p,i),c.copy(o).add(a).subtract(l).subtract(u),h.copy(c).subtract(t),p=e.dot(h),r=Math.min(p,r),i=Math.max(p,i),o.copy(c).subtract(a).add(l).add(u),h.copy(c).subtract(t),p=e.dot(h),r=Math.min(p,r),i=Math.max(p,i),o.copy(c).subtract(a).add(l).subtract(u),h.copy(c).subtract(t),p=e.dot(h),r=Math.min(p,r),i=Math.max(p,i),o.copy(c).subtract(a).subtract(l).add(u),h.copy(c).subtract(t),p=e.dot(h),r=Math.min(p,r),i=Math.max(p,i),o.copy(c).subtract(a).subtract(l).subtract(u),h.copy(c).subtract(t),p=e.dot(h),r=Math.min(p,r),i=Math.max(p,i),n[0]=r,n[1]=i,n}transform(t){this.center.transformAsPoint(t);const e=this.halfAxes.getColumn(0,k);e.transformAsPoint(t);const n=this.halfAxes.getColumn(1,D);n.transformAsPoint(t);const r=this.halfAxes.getColumn(2,N);return r.transformAsPoint(t),this.halfAxes=new I.Z([...e,...n,...r]),this}getTransform(){throw new Error("not implemented")}}var j=n(394),U=n(4034);const V=new w.Z,G=new w.Z;class Z{constructor(t=[0,0,1],e=0){this.normal=new w.Z,this.distance=-0,this.fromNormalDistance(t,e)}fromNormalDistance(t,e){return(0,j.Z)(Number.isFinite(e)),this.normal.from(t).normalize(),this.distance=e,this}fromPointNormal(t,e){t=V.from(t),this.normal.from(e).normalize();const n=-this.normal.dot(t);return this.distance=n,this}fromCoefficients(t,e,n,r){return this.normal.set(t,e,n),(0,j.Z)((0,U.fS)(this.normal.len(),1)),this.distance=r,this}clone(t){return new Z(this.normal,this.distance)}equals(t){return(0,U.fS)(this.distance,t.distance)&&(0,U.fS)(this.normal,t.normal)}getPointDistance(t){return this.normal.dot(t)+this.distance}transform(t){const e=G.copy(this.normal).transformAsVector(t).normalize(),n=this.normal.scale(-this.distance).transform(t);return this.fromPointNormal(n,e)}projectPointOntoPlane(t,e=[0,0,0]){t=V.from(t);const n=this.getPointDistance(t),r=G.copy(this.normal).scale(n);return t.subtract(r).to(e)}}const q=[new w.Z([1,0,0]),new w.Z([0,1,0]),new w.Z([0,0,1])],W=new w.Z,H=new w.Z;new Z(new w.Z(1,0,0),0);class X{static get MASK_OUTSIDE(){return 4294967295}static get MASK_INSIDE(){return 0}static get MASK_INDETERMINATE(){return 2147483647}constructor(t=[]){this.planes=t,(0,j.Z)(this.planes.every((t=>t instanceof Z)))}fromBoundingSphere(t){this.planes.length=2*q.length;const e=t.center,n=t.radius;let r=0;for(const t of q){let i=this.planes[r],o=this.planes[r+1];i||(i=this.planes[r]=new Z),o||(o=this.planes[r+1]=new Z);const s=W.copy(t).scale(-n).add(e);t.dot(s),i.fromPointNormal(s,t);const a=W.copy(t).scale(n).add(e),l=H.copy(t).negate();l.dot(a),o.fromPointNormal(a,l),r+=2}return this}computeVisibility(t){(0,j.Z)(t);let e=x.INSIDE;for(const n of this.planes)switch(t.intersectPlane(n)){case x.OUTSIDE:return x.OUTSIDE;case x.INTERSECTING:e=x.INTERSECTING}return e}computeVisibilityWithPlaneMask(t,e){if((0,j.Z)(t,"boundingVolume is required."),(0,j.Z)(Number.isFinite(e),"parentPlaneMask is required."),e===X.MASK_OUTSIDE||e===X.MASK_INSIDE)return e;let n=X.MASK_INSIDE;const r=this.planes;for(let i=0;i<this.planes.length;++i){const o=i<31?1<<i:0;if(i<31&&0==(e&o))continue;const s=r[i],a=t.intersectPlane(s);if(a===x.OUTSIDE)return X.MASK_OUTSIDE;a===x.INTERSECTING&&(n|=o)}return n}}new w.Z,new w.Z,new w.Z,new w.Z,new w.Z,new w.Z,new w.Z,new w.Z,new w.Z,new w.Z,new w.Z,new w.Z,new w.Z,new w.Z,new w.Z,new w.Z,new w.Z,Math.PI;var $=n(9057);const Y=new I.Z,Q=new I.Z,K=new I.Z,J=new I.Z,tt=new I.Z;const et=[1,0,0],nt=[2,2,1];function rt(t){let e=0;for(let n=0;n<3;++n){const r=t[Y.getElementIndex(nt[n],et[n])];e+=2*r*r}return Math.sqrt(e)}function it(t,e){const n=$.Z.EPSILON15;let r=0,i=1;for(let e=0;e<3;++e){const n=Math.abs(t[Y.getElementIndex(nt[e],et[e])]);n>r&&(i=e,r=n)}const o=et[i],s=nt[i];let a=1,l=0;if(Math.abs(t[Y.getElementIndex(s,o)])>n){const e=(t[Y.getElementIndex(s,s)]-t[Y.getElementIndex(o,o)])/2/t[Y.getElementIndex(s,o)];let n;n=e<0?-1/(-e+Math.sqrt(1+e*e)):1/(e+Math.sqrt(1+e*e)),a=1/Math.sqrt(1+n*n),l=n*a}return I.Z.IDENTITY.to(e),e[Y.getElementIndex(o,o)]=e[Y.getElementIndex(s,s)]=a,e[Y.getElementIndex(s,o)]=l,e[Y.getElementIndex(o,s)]=-l,e}const ot=new w.Z,st=new w.Z,at=new w.Z,lt=new w.Z,ut=new w.Z,ct=new I.Z,ht={diagonal:new I.Z,unitary:new I.Z};var pt=n(7682);const ft=512,dt=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],gt=dt.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),mt=gt.concat([[.25,.5],[.75,.5]]);class At{constructor(t,e,n){this.x=t,this.y=e,this.z=n}get children(){if(!this._children){const t=2*this.x,e=2*this.y,n=this.z+1;this._children=[new At(t,e,n),new At(t,e+1,n),new At(t+1,e,n),new At(t+1,e+1,n)]}return this._children}update(t){const{viewport:e,cullingVolume:n,elevationBounds:r,minZ:i,maxZ:o,bounds:s,offset:a,project:l}=t,u=this.getBoundingVolume(r,a,l);if(s&&!this.insideBounds(s))return!1;if(n.computeVisibility(u)<0)return!1;if(!this.childVisible){let{z:t}=this;if(t<o&&t>=i){const n=u.distanceTo(e.cameraPosition)*e.scale/e.height;t+=Math.floor(Math.log2(n))}if(t>=o)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const e of this.children)e.update(t);return!0}getSelected(t=[]){if(this.selected&&t.push(this),this._children)for(const e of this._children)e.getSelected(t);return t}insideBounds([t,e,n,r]){const i=Math.pow(2,this.z),o=ft/i;return this.x*o<n&&this.y*o<r&&(this.x+1)*o>t&&(this.y+1)*o>e}getBoundingVolume(t,e,n){if(n){const e=this.z<1?mt:this.z<2?gt:dt,r=[];for(const i of e){const e=Et(this.x+i[0],this.y+i[1],this.z);e[2]=t[0],r.push(n(e)),t[0]!==t[1]&&(e[2]=t[1],r.push(n(e)))}return function(t,e=new z){if(!t||0===t.length)return e.halfAxes=new I.Z([0,0,0,0,0,0,0,0,0]),e.center=new w.Z,e;const n=t.length,r=new w.Z(0,0,0);for(const e of t)r.add(e);const i=1/n;r.multiplyByScalar(i);let o=0,s=0,a=0,l=0,u=0,c=0;for(const e of t){const t=ot.copy(e).subtract(r);o+=t.x*t.x,s+=t.x*t.y,a+=t.x*t.z,l+=t.y*t.y,u+=t.y*t.z,c+=t.z*t.z}o*=i,s*=i,a*=i,l*=i,u*=i,c*=i;const h=ct;h[0]=o,h[1]=s,h[2]=a,h[3]=s,h[4]=l,h[5]=u,h[6]=a,h[7]=u,h[8]=c;const{unitary:p}=function(t,e={}){const n=$.Z.EPSILON20;let r=0,i=0;const o=Q,s=K;o.identity(),s.copy(t);const a=n*function(t){let e=0;for(let n=0;n<9;++n){const r=t[n];e+=r*r}return Math.sqrt(e)}(s);for(;i<10&&rt(s)>a;)it(s,J),tt.copy(J).transpose(),s.multiplyRight(J),s.multiplyLeft(tt),o.multiplyRight(J),++r>2&&(++i,r=0);return e.unitary=o.toTarget(e.unitary),e.diagonal=s.toTarget(e.diagonal),e}(h,ht),f=e.halfAxes.copy(p);let d=f.getColumn(0,at),g=f.getColumn(1,lt),m=f.getColumn(2,ut),A=-Number.MAX_VALUE,y=-Number.MAX_VALUE,_=-Number.MAX_VALUE,v=Number.MAX_VALUE,b=Number.MAX_VALUE,x=Number.MAX_VALUE;for(const e of t)ot.copy(e),A=Math.max(ot.dot(d),A),y=Math.max(ot.dot(g),y),_=Math.max(ot.dot(m),_),v=Math.min(ot.dot(d),v),b=Math.min(ot.dot(g),b),x=Math.min(ot.dot(m),x);d=d.multiplyByScalar(.5*(v+A)),g=g.multiplyByScalar(.5*(b+y)),m=m.multiplyByScalar(.5*(x+_)),e.center.copy(d).add(g).add(m);const E=st.set(A-v,y-b,_-x).multiplyByScalar(.5),S=new I.Z([E[0],0,0,0,E[1],0,0,0,E[2]]);return e.halfAxes.multiplyRight(S),e}(r)}const r=Math.pow(2,this.z),i=ft/r,o=this.x*i+e*ft,s=ft-(this.y+1)*i;return new T([o,s,t[0]],[o+i,s+i,t[1]])}}const yt=512,_t=[-1/0,-1/0,1/0,1/0],vt={type:"url",value:null,validate:(t,e)=>e.optional&&null===t||"string"==typeof t||Array.isArray(t)&&t.every((t=>"string"==typeof t)),equals:(t,e)=>{if(t===e)return!0;if(!Array.isArray(t)||!Array.isArray(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}};function bt(t,e){const n=[e.transformPoint([t[0],t[1]]),e.transformPoint([t[2],t[1]]),e.transformPoint([t[0],t[3]]),e.transformPoint([t[2],t[3]])],r=[Math.min(...n.map((t=>t[0]))),Math.min(...n.map((t=>t[1]))),Math.max(...n.map((t=>t[0]))),Math.max(...n.map((t=>t[1])))];return r}function xt(t,e){if(!t||!t.length)return null;Array.isArray(t)&&(t=t[Math.abs(e.x+e.y)%t.length]);const{x:n,y:r,z:i}=e;return t.replace("{x}",n).replace("{y}",r).replace("{z}",i).replace("{-y}",Math.pow(2,i)-r-1)}function wt(t,e){return Math.pow(2,t)*yt/e}function Et(t,e,n){const r=wt(n,yt),i=t/r*360-180,o=Math.PI-2*Math.PI*e/r;return[i,180/Math.PI*Math.atan(.5*(Math.exp(o)-Math.exp(-o)))]}function St(t,e,n,r){const i=wt(n,r);return[t/i*yt,e/i*yt]}function Tt(t,e,n,r,i=512){if(t.isGeospatial){const[t,i]=Et(e,n,r),[o,s]=Et(e+1,n+1,r);return{west:t,north:i,east:o,south:s}}const[o,s]=St(e,n,r,i),[a,l]=St(e+1,n+1,r,i);return{left:o,top:s,right:a,bottom:l}}function Pt({viewport:t,maxZoom:e,minZoom:n,zRange:r,extent:i,tileSize:o=512,modelMatrix:s,modelMatrixInverse:a,zoomOffset:l=0}){let u=t.isGeospatial?Math.round(t.zoom+Math.log2(yt/o))+l:Math.ceil(t.zoom)+l;if(Number.isFinite(n)&&u<n){if(!i)return[];u=n}Number.isFinite(e)&&u>e&&(u=e);let c=i;return s&&a&&i&&!t.isGeospatial&&(c=bt(i,s)),t.isGeospatial?function(t,e,n,r){const i=t.resolution?t.projectPosition:null,o=Object.values(t.getFrustumPlanes()).map((({normal:t,distance:e})=>new Z(t.clone().negate(),e))),s=new X(o),a=t.distanceScales.unitsPerMeter[2],l=n&&n[0]*a||0,u=n&&n[1]*a||0,c=t.pitch<=60?e:0;if(r){const[t,e,n,i]=r,o=(0,pt.w5)([t,i]),s=(0,pt.w5)([n,e]);r=[o[0],ft-o[1],s[0],ft-s[1]]}const h=new At(0,0,0),p={viewport:t,project:i,cullingVolume:s,elevationBounds:[l,u],minZ:c,maxZ:e,bounds:r,offset:0};if(h.update(p),t.subViewports&&t.subViewports.length>1){for(p.offset=-1;h.update(p)&&!(--p.offset<-3););for(p.offset=1;h.update(p)&&!(++p.offset>3););}return h.getSelected()}(t,u,r,i):function(t,e,n,r,i){const o=function(t,e,n){let r;return r=t.getBounds(),t.isGeospatial?[Math.max(r[0],n[0]),Math.max(r[1],n[1]),Math.min(r[2],n[2]),Math.min(r[3],n[3])]:[Math.max(Math.min(r[0],n[2]),n[0]),Math.max(Math.min(r[1],n[3]),n[1]),Math.min(Math.max(r[2],n[0]),n[2]),Math.min(Math.max(r[3],n[1]),n[3])]}(t,0,r),s=wt(e,n),[a,l,u,c]=function(t,e,n){if(n){const r=bt(t,n).map((t=>t*e/yt));return r}return t.map((t=>t*e/yt))}(o,s,i),h=[];for(let t=Math.floor(a);t<u;t++)for(let n=Math.floor(l);n<c;n++)h.push({x:t,y:n,z:e});return h}(t,u,o,c||_t,a)}var Mt=n(4942),Ct=n(8295);const It={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class Ot{constructor(t={}){(0,Mt.Z)(this,"props",void 0),(0,Mt.Z)(this,"stats",void 0),(0,Mt.Z)(this,"activeRequestCount",0),(0,Mt.Z)(this,"requestQueue",[]),(0,Mt.Z)(this,"requestMap",new Map),(0,Mt.Z)(this,"deferredUpdate",null),this.props={...It,...t},this.stats=new Ct.Z({id:this.props.id}),this.stats.get("Queued Requests"),this.stats.get("Active Requests"),this.stats.get("Cancelled Requests"),this.stats.get("Queued Requests Ever"),this.stats.get("Active Requests Ever")}scheduleRequest(t,e=(()=>0)){if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(t))return this.requestMap.get(t);const n={handle:t,priority:0,getPriority:e},r=new Promise((t=>(n.resolve=t,n)));return this.requestQueue.push(n),this.requestMap.set(t,r),this._issueNewRequests(),r}_issueRequest(t){const{handle:e,resolve:n}=t;let r=!1;const i=()=>{r||(r=!0,this.requestMap.delete(e),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,n?n({done:i}):Promise.resolve({done:i})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout((()=>this._issueNewRequestsAsync()),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const t=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==t){this._updateAllRequests();for(let e=0;e<t;++e){const t=this.requestQueue.shift();t&&this._issueRequest(t)}}}_updateAllRequests(){const t=this.requestQueue;for(let e=0;e<t.length;++e){const n=t[e];this._updateRequest(n)||(t.splice(e,1),this.requestMap.delete(n.handle),e--)}t.sort(((t,e)=>t.priority-e.priority))}_updateRequest(t){return t.priority=t.getPriority(t.handle),!(t.priority<0&&(t.resolve(null),1))}}var Rt=n(3467);const Lt="best-available";class kt{constructor(t){this.opts=t,this.onTileLoad=t=>{this.opts.onTileLoad(t),this.opts.maxCacheByteSize&&(this._cacheByteSize+=t.byteLength,this._resizeCache())},this._requestScheduler=new Ot({maxRequests:t.maxRequests,throttleRequests:t.maxRequests>0}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this.setOptions(t)}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return this._selectedTiles.every((t=>t.isLoaded))}setOptions(t){Object.assign(this.opts,t),Number.isFinite(t.maxZoom)&&(this._maxZoom=Math.floor(t.maxZoom)),Number.isFinite(t.minZoom)&&(this._minZoom=Math.ceil(t.minZoom))}finalize(){for(const t of this._cache.values())t.isLoading&&t.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const t of this._cache.keys()){const e=this._cache.get(t);this._selectedTiles.includes(e)?e.setNeedsReload():this._cache.delete(t)}}update(t,{zRange:e,modelMatrix:n}={}){const r=new Rt.Z(n),i=!r.equals(this._modelMatrix);if(!t.equals(this._viewport)||i){i&&(this._modelMatrixInverse=n&&r.clone().invert(),this._modelMatrix=n&&r),this._viewport=t;const o=this.getTileIndices({viewport:t,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:e,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=o.map((t=>this._getTile(t,!0))),this._dirty&&this._rebuildTree()}const o=this.updateTileStates();return this._dirty&&this._resizeCache(),o&&this._frameNumber++,this._frameNumber}getTileIndices({viewport:t,maxZoom:e,minZoom:n,zRange:r,modelMatrix:i,modelMatrixInverse:o}){const{tileSize:s,extent:a,zoomOffset:l}=this.opts;return Pt({viewport:t,maxZoom:e,minZoom:n,zRange:r,tileSize:s,extent:a,modelMatrix:i,modelMatrixInverse:o,zoomOffset:l})}getTileMetadata({x:t,y:e,z:n}){const{tileSize:r}=this.opts;return{bbox:Tt(this._viewport,t,e,n,r)}}getParentIndex(t){return t.x=Math.floor(t.x/2),t.y=Math.floor(t.y/2),t.z-=1,t}updateTileStates(){this._updateTileStates(this.selectedTiles);const{maxRequests:t}=this.opts,e=[];let n=0,r=!1;for(const t of this._cache.values()){const i=Boolean(1&t.state);t.isVisible!==i&&(r=!0,t.isVisible=i),t.isSelected=5===t.state,t.isLoading&&(n++,t.isSelected||e.push(t))}if(t>0)for(;n>t&&e.length>0;)e.shift().abort(),n--;return r}_rebuildTree(){const{_cache:t}=this;for(const e of t.values())e.parent=null,e.children.length=0;for(const e of t.values()){const t=this._getNearestAncestor(e.x,e.y,e.z);e.parent=t,t&&t.children.push(e)}}_updateTileStates(t){const{_cache:e}=this,n=this.opts.refinementStrategy||Lt;for(const t of e.values())t.state=0;for(const e of t)e.state=5;if("never"!==n){for(const e of t)Nt(e,n);for(const e of t)Dt(e)&&Ft(e)}}_resizeCache(){const{_cache:t,opts:e}=this,n=e.maxCacheSize||(e.maxCacheByteSize?1/0:5*this.selectedTiles.length),r=e.maxCacheByteSize||1/0;if(t.size>n||this._cacheByteSize>r){for(const[i,o]of t)if(o.isVisible||(this._cacheByteSize-=e.maxCacheByteSize?o.byteLength:0,t.delete(i),this.opts.onTileUnload(o)),t.size<=n&&this._cacheByteSize<=r)break;this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort(((t,e)=>t.z-e.z)),this._dirty=!1)}_getTile({x:t,y:e,z:n},r){const i="".concat(t,",").concat(e,",").concat(n);let o=this._cache.get(i),s=!1;return!o&&r?(o=new b({x:t,y:e,z:n}),Object.assign(o,this.getTileMetadata(o)),s=!0,this._cache.set(i,o),this._dirty=!0):o&&o.needsReload&&(s=!0),s&&o.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),o}_getNearestAncestor(t,e,n){const{_minZoom:r=0}=this;let i={x:t,y:e,z:n};for(;i.z>r;){i=this.getParentIndex(i);const t=this._getTile(i);if(t)return t}return null}}function Dt(t){let e=t;for(;e;){if(!1&e.state)return!0;if(e.isLoaded)return!1;e=e.parent}return!0}function Nt(t,e){let n,r=3;for(;n=t.parent;){if(t.isLoaded&&(r=4,e===Lt))return;n.state=Math.max(n.state,r),t=n}}function Ft(t){for(const e of t.children)e.state=Math.max(e.state,3),e.isLoaded||Ft(e)}const Bt={data:[],dataComparator:vt.equals,renderSubLayers:{type:"function",value:t=>new _.Z(t),compare:!1},getTileData:{type:"function",optional:!0,value:null,compare:!1},onViewportLoad:{type:"function",optional:!0,value:null,compare:!1},onTileLoad:{type:"function",value:t=>{},compare:!1},onTileUnload:{type:"function",value:t=>{},compare:!1},onTileError:{type:"function",value:t=>console.error(t),compare:!1},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:Lt,zRange:null,maxRequests:6,zoomOffset:0};class zt extends o.Z{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){var t;null===(t=this.state.tileset)||void 0===t||t.finalize()}get isLoaded(){const{tileset:t}=this.state;return t.selectedTiles.every((t=>t.isLoaded&&t.layers&&t.layers.every((t=>t.isLoaded))))}shouldUpdateState({changeFlags:t}){return t.somethingChanged}updateState({props:t,changeFlags:e}){let{tileset:n}=this.state;const r=e.propsOrDataChanged||e.updateTriggersChanged,i=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getTileData);n?r&&(n.setOptions(this._getTilesetOptions(t)),i?n.reloadAll():this.state.tileset.tiles.forEach((t=>{t.layers=null}))):(n=new kt(this._getTilesetOptions(t)),this.setState({tileset:n})),this._updateTileset()}_getTilesetOptions(t){const{tileSize:e,maxCacheSize:n,maxCacheByteSize:r,refinementStrategy:i,extent:o,maxZoom:s,minZoom:a,maxRequests:l,zoomOffset:u}=t;return{maxCacheSize:n,maxCacheByteSize:r,maxZoom:s,minZoom:a,tileSize:e,refinementStrategy:i,extent:o,maxRequests:l,zoomOffset:u,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const{tileset:t}=this.state,{zRange:e,modelMatrix:n}=this.props,r=t.update(this.context.viewport,{zRange:e,modelMatrix:n}),{isLoaded:i}=t,o=this.state.isLoaded!==i,s=this.state.frameNumber!==r;i&&(o||s)&&this._onViewportLoad(),s&&this.setState({frameNumber:r}),this.state.isLoaded=i}_onViewportLoad(){const{tileset:t}=this.state,{onViewportLoad:e}=this.props;e&&e(t.selectedTiles)}_onTileLoad(t){this.props.onTileLoad(t),t.layers=null,t.isVisible&&this.setNeedsUpdate()}_onTileError(t,e){this.props.onTileError(t),e.layers=null,e.isVisible&&this.setNeedsUpdate()}_onTileUnload(t){this.props.onTileUnload(t)}getTileData(t){const{data:e,getTileData:n,fetch:r}=this.props,{signal:i}=t;return t.url=xt(e,t),n?n(t):t.url?r(t.url,{propName:"data",layer:this,signal:i}):null}renderSubLayers(t){return this.props.renderSubLayers(t)}getHighlightedObjectIndex(){return-1}getPickingInfo({info:t,sourceLayer:e}){return t.tile=e.props.tile,t}_updateAutoHighlight(t){t.sourceLayer&&t.sourceLayer.updateAutoHighlight(t)}renderLayers(){return this.state.tileset.tiles.map((t=>{const e=this.getHighlightedObjectIndex(t);if(t.isLoaded||t.content)if(t.layers)t.layers[0]&&t.layers[0].props.highlightedObjectIndex!==e&&(t.layers=t.layers.map((t=>t.clone({highlightedObjectIndex:e}))));else{const n=this.renderSubLayers({...this.props,id:"".concat(this.id,"-").concat(t.x,"-").concat(t.y,"-").concat(t.z),data:t.content,_offset:0,tile:t});t.layers=(0,y.x)(n,Boolean).map((n=>n.clone({tile:t,highlightedObjectIndex:e})))}return t.layers}))}filterSubLayer({layer:t}){return t.props.tile.isVisible}}zt.layerName="TileLayer",zt.defaultProps=Bt;var jt=n(2112);class Ut extends jt.Z{getShaders(){const t=super.getShaders();return t.inject={"vs:#decl":"uniform float trailLength;\nattribute float instanceTimestamps;\nattribute float instanceNextTimestamps;\nvarying float vTime;\n","vs:#main-end":"vTime = instanceTimestamps + (instanceNextTimestamps - instanceTimestamps) * vPathPosition.y / vPathLength;\n","fs:#decl":"uniform bool fadeTrail;\nuniform float trailLength;\nuniform float currentTime;\nvarying float vTime;\n","fs:#main-start":"if(vTime > currentTime || (fadeTrail && (vTime < currentTime - trailLength))) {\n  discard;\n}\n","fs:DECKGL_FILTER_COLOR":"if(fadeTrail) {\n  color.a *= 1.0 - (currentTime - vTime) / trailLength;\n}\n"},t}initializeState(t){super.initializeState(t),this.getAttributeManager().addInstanced({timestamps:{size:1,accessor:"getTimestamps",shaderAttributes:{instanceTimestamps:{vertexOffset:0},instanceNextTimestamps:{vertexOffset:1}}}})}draw(t){const{fadeTrail:e,trailLength:n,currentTime:r}=this.props;t.uniforms={...t.uniforms,fadeTrail:e,trailLength:n,currentTime:r},super.draw(t)}}Ut.layerName="TripsLayer",Ut.defaultProps={fadeTrail:!0,trailLength:{type:"number",value:120,min:0},currentTime:{type:"number",value:0,min:0},getTimestamps:{type:"accessor",value:null}};var Vt=n(9947),Gt=n(8550);const Zt={...s.Z.defaultProps,getHexagons:{type:"accessor",value:t=>t.hexagons}};class qt extends o.Z{updateState({props:t,oldProps:e,changeFlags:n}){if(n.dataChanged||n.updateTriggers&&n.updateTriggers.getHexagons){const{data:e,getHexagons:n}=t,r=[],{iterable:i,objectInfo:o}=(0,Gt.jB)(e);for(const t of i){o.index++;const e=n(t,o),i=(0,Vt.h3SetToMultiPolygon)(e,!0);for(const e of i)r.push(this.getSubLayerRow({polygon:e},t,o.index))}this.setState({polygons:r})}}renderLayers(){const{elevationScale:t,extruded:e,wireframe:n,filled:r,stroked:i,lineWidthScale:o,lineWidthMinPixels:a,lineWidthMaxPixels:l,lineJointRounded:u,lineMiterLimit:c,lineDashJustified:h,material:p,getFillColor:f,getLineColor:d,getLineWidth:g,getLineDashArray:m,getElevation:A,transitions:y,updateTriggers:_}=this.props;return new(this.getSubLayerClass("cluster-region",s.Z))({filled:r,wireframe:n,extruded:e,elevationScale:t,stroked:i,lineWidthScale:o,lineWidthMinPixels:a,lineWidthMaxPixels:l,lineJointRounded:u,lineMiterLimit:c,lineDashJustified:h,material:p,transitions:y,getFillColor:this.getSubLayerAccessor(f),getLineColor:this.getSubLayerAccessor(d),getLineWidth:this.getSubLayerAccessor(g),getLineDashArray:this.getSubLayerAccessor(m),getElevation:this.getSubLayerAccessor(A)},this.getSubLayerProps({id:"cluster-region",updateTriggers:_}),{data:this.state.polygons,getPolygon:t=>t.polygon})}}qt.defaultProps=Zt,qt.layerName="H3ClusterLayer";var Wt=n(5103);function Ht(t,e){e=void 0===e?t[0][0]:e;for(const n of t){const t=n[0]-e;t>180?n[0]-=360:t<-180&&(n[0]+=360)}}function Xt(t,e,n){const r=t(e,n),[i,o]=(0,Vt.h3ToGeo)(r);return[o,i]}function $t(t,e=1,n){const r=(0,Vt.h3ToGeoBoundary)(t,!0);if(1!==e?function(t,e,n){const[r,i]=(0,Vt.h3ToGeo)(t),o=e.length;Ht(e,i);const s=e[0]===e[o-1]?o-1:o;for(let t=0;t<s;t++)e[t][0]=(0,U.t7)(i,e[t][0],n),e[t][1]=(0,U.t7)(r,e[t][1],n)}(t,r,e):Ht(r),n){const t=new Float64Array(2*r.length);let e=0;for(const n of r)t[e++]=n[0],t[e++]=n[1];return t}return r}const Yt={...s.Z.defaultProps,highPrecision:"auto",coverage:{type:"number",min:0,max:1,value:1},centerHexagon:null,getHexagon:{type:"accessor",value:t=>t.hexagon},extruded:!0};delete Yt.getLineDashArray;class Qt extends o.Z{shouldUpdateState({changeFlags:t}){return this._shouldUseHighPrecision()?t.propsOrDataChanged:t.somethingChanged}updateState({props:t,oldProps:e,changeFlags:n}){if(!0!==t.highPrecision&&(n.dataChanged||n.updateTriggers&&n.updateTriggers.getHexagon)){const e=this._calculateH3DataProps(t);this.setState(e)}this._updateVertices(this.context.viewport)}_calculateH3DataProps(t){let e=-1,n=!1,r=!1;const{iterable:i,objectInfo:o}=(0,Gt.jB)(t.data);for(const s of i){o.index++;const i=t.getHexagon(s,o),a=(0,Vt.h3GetResolution)(i);if(e<0){if(e=a,!t.highPrecision)break}else if(e!==a){r=!0;break}if((0,Vt.h3IsPentagon)(i)){n=!0;break}}return{resolution:e,edgeLengthKM:e>=0?(0,Vt.edgeLength)(e,Vt.UNITS.km):0,hasMultipleRes:r,hasPentagon:n}}_shouldUseHighPrecision(){if("auto"===this.props.highPrecision){const{resolution:t,hasPentagon:e,hasMultipleRes:n}=this.state,{viewport:r}=this.context;return r.resolution||n||e||t>=0&&t<=5}return this.props.highPrecision}_updateVertices(t){if(this._shouldUseHighPrecision())return;const{resolution:e,edgeLengthKM:n,centerHex:r}=this.state;if(e<0)return;const i=this.props.centerHexagon||(0,Vt.geoToH3)(t.latitude,t.longitude,e);if(r===i)return;if(r){const t=(0,Vt.h3Distance)(r,i);if(t>=0&&t*n<10)return}const{unitsPerMeter:o}=t.distanceScales;let s=$t(i);const[a,l]=(0,Vt.h3ToGeo)(i),[u,c]=t.projectFlat([l,a]);s=s.map((e=>{const n=t.projectFlat(e);return[(n[0]-u)/o[0],(n[1]-c)/o[1]]})),this.setState({centerHex:i,vertices:s})}renderLayers(){return this._shouldUseHighPrecision()?this._renderPolygonLayer():this._renderColumnLayer()}_getForwardProps(){const{elevationScale:t,material:e,coverage:n,extruded:r,wireframe:i,stroked:o,filled:s,lineWidthUnits:a,lineWidthScale:l,lineWidthMinPixels:u,lineWidthMaxPixels:c,getFillColor:h,getElevation:p,getLineColor:f,getLineWidth:d,transitions:g,updateTriggers:m}=this.props;return{elevationScale:t,extruded:r,coverage:n,wireframe:i,stroked:o,filled:s,lineWidthUnits:a,lineWidthScale:l,lineWidthMinPixels:u,lineWidthMaxPixels:c,material:e,getElevation:p,getFillColor:h,getLineColor:f,getLineWidth:d,transitions:g,updateTriggers:{getFillColor:m.getFillColor,getElevation:m.getElevation,getLineColor:m.getLineColor,getLineWidth:m.getLineWidth}}}_renderPolygonLayer(){const{data:t,getHexagon:e,updateTriggers:n,coverage:r}=this.props,i=this.getSubLayerClass("hexagon-cell-hifi",s.Z),o=this._getForwardProps();return o.updateTriggers.getPolygon=function(t,e){let n;return n=null==t?e:"object"==typeof t?{...t,coverage:e}:{getHexagon:t,coverage:e},n}(n.getHexagon,r),new i(o,this.getSubLayerProps({id:"hexagon-cell-hifi",updateTriggers:o.updateTriggers}),{data:t,_normalize:!1,_windingOrder:"CCW",positionFormat:"XY",getPolygon:(t,n)=>$t(e(t,n),r,!0)})}_renderColumnLayer(){const{data:t,getHexagon:e,updateTriggers:n}=this.props,r=this.getSubLayerClass("hexagon-cell",Wt.Z),i=this._getForwardProps();return i.updateTriggers.getPosition=n.getHexagon,new r(i,this.getSubLayerProps({id:"hexagon-cell",updateTriggers:i.updateTriggers}),{data:t,diskResolution:6,radius:1,vertices:this.state.vertices,getPosition:Xt.bind(null,e)})}}Qt.defaultProps=Yt,Qt.layerName="H3HexagonLayer";var Kt=n(3982),Jt=n(4088),te=n(7693),ee=n(2377),ne=n(1307),re=n(4080),ie=n(1113),oe=n(3989);class se extends oe.Z{getShaders(){const t=super.getShaders();return t.modules.push(re.b),{...t,vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nuniform bool u_pickFeatureIds;\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec4 uvRegions;\nin vec3 featureIdsPickingColors;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  vec2 uv = fract(texCoords) * (uvRegions.zw - uvRegions.xy) + uvRegions.xy;\n\n  geometry.uv = uv;\n  geometry.uv = texCoords;\n\n  if (u_pickFeatureIds) {\n    geometry.pickingColor = featureIdsPickingColors;\n  } else {\n    geometry.pickingColor = instancePickingColors;\n  }\n\n  #ifdef MODULE_PBR\n    #ifdef HAS_NORMALS\n      pbr_vNormal = project_normal(instanceModelMatrix * normals);\n      geometry.normal = pbr_vNormal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = uv;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  vTexCoord = uv;\n  cameraPosition = project_uCameraPosition;\n  normals_commonspace = project_normal(instanceModelMatrix * normals);\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n  geometry.normal = normals_commonspace;\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale;\n  vec3 projectedPosition = project_position(positions);\n  position_commonspace = vec4(projectedPosition, 1.0);\n  gl_Position = project_common_position_to_clipspace(position_commonspace);\n\n  geometry.position = position_commonspace;\n\n  #ifdef MODULE_PBR\n    pbr_vPosition = geometry.position.xyz;\n  #endif\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  \n#ifdef MODULE_PBR\n\n  fragColor = vColor * pbr_filterColor(vec4(0));\n  geometry.uv = pbr_vUV;\n  fragColor.a *= opacity;\n\n#else\n\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n#endif\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n"}}initializeState(){const{featureIds:t}=this.props;super.initializeState(),t&&this.state.attributeManager.add({featureIdsPickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateFeatureIdsPickingColors}})}updateState({props:t,oldProps:e,changeFlags:n}){super.updateState({props:t,oldProps:e,changeFlags:n}),t.pbrMaterial!==e.pbrMaterial&&this.updatePbrMaterialUniforms(t.pbrMaterial)}draw(t){const{featureIds:e}=this.props;this.state.model&&(this.state.model.setUniforms({u_Camera:this.state.model.getUniforms().project_uCameraPosition,u_pickFeatureIds:Boolean(e)}),super.draw(t))}getModel(t){const{id:e,pbrMaterial:n}=this.props,r=this.parseMaterial(n,t),i=this.getShaders();var o;return(o=t.attributes).COLOR_0||o.colors||(o.colors={constant:!0,value:new Float32Array([1,1,1])}),o.uvRegions||(o.uvRegions={constant:!0,value:new Float32Array([0,0,1,1])}),new ie.Z(this.context.gl,{...this.getShaders(),id:e,geometry:t,defines:{...i.defines,...null==r?void 0:r.defines},parameters:null==r?void 0:r.parameters,isInstanced:!0})}updatePbrMaterialUniforms(t){const{model:e}=this.state;if(e){const{mesh:n}=this.props,r=this.parseMaterial(t,n);e.setUniforms(r.uniforms)}}parseMaterial(t,e){const n=Boolean(t.pbrMetallicRoughness&&t.pbrMetallicRoughness.baseColorTexture);return new ne.Z(this.context.gl,{attributes:{NORMAL:e.attributes.normals,TEXCOORD_0:e.attributes.texCoords},material:{unlit:n,...t},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1})}calculateFeatureIdsPickingColors(t){const{featureIds:e}=this.props,n=new Uint8ClampedArray(e.length*t.size),r=[];for(let t=0;t<e.length;t++)this.encodePickingColor(e[t],r),n[3*t]=r[0],n[3*t+1]=r[1],n[3*t+2]=r[2];t.value=n}}se.layerName="_MeshLayer",se.defaultProps={pbrMaterial:{type:"object",value:null},featureIds:{type:"array",value:null,optional:!0}};var ae,le=n(3079),ue="undefined"!=typeof Float32Array?Float32Array:Array;Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)}),ae=new ue(3),ue!=Float32Array&&(ae[0]=0,ae[1]=0,ae[2]=0);const ce=6378137,he=6378137,pe=6356752.314245179,fe=(Math.max(ce,he,pe),t=>t),de=new w.Z;const ge=new w.Z,me=new w.Z,Ae=new w.Z,ye=new w.Z,_e={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},ve={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},be={east:new w.Z,north:new w.Z,up:new w.Z,west:new w.Z,south:new w.Z,down:new w.Z},xe=new w.Z,we=new w.Z,Ee=new w.Z;function Se(t,e,n,r,i,o){const s=_e[e]&&_e[e][n];let a,l,u;(0,j.Z)(s&&(!r||r===s));const c=ye.copy(i);if((0,U.fS)(c.x,0,1e-14)&&(0,U.fS)(c.y,0,1e-14)){const t=Math.sign(c.z);a=xe.fromArray(ve[e]),"east"!==e&&"west"!==e&&a.scale(t),l=we.fromArray(ve[n]),"east"!==n&&"west"!==n&&l.scale(t),u=Ee.fromArray(ve[r]),"east"!==r&&"west"!==r&&u.scale(t)}else{const{up:i,east:o,north:s}=be;o.set(-c.y,c.x,0).normalize(),t.geodeticSurfaceNormal(c,i),s.copy(i).cross(o);const{down:h,west:p,south:f}=be;h.copy(i).scale(-1),p.copy(o).scale(-1),f.copy(s).scale(-1),a=be[e],l=be[n],u=be[r]}return o[0]=a.x,o[1]=a.y,o[2]=a.z,o[3]=0,o[4]=l.x,o[5]=l.y,o[6]=l.z,o[7]=0,o[8]=u.x,o[9]=u.y,o[10]=u.z,o[11]=0,o[12]=c.x,o[13]=c.y,o[14]=c.z,o[15]=1,o}const Te=new w.Z,Pe=new w.Z,Me=new w.Z,Ce=new w.Z,Ie=new w.Z,Oe=new w.Z;let Re;class Le{static get WGS84(){return Re=Re||new Le(ce,he,pe),Re}constructor(t=0,e=0,n=0){(0,j.Z)(t>=0),(0,j.Z)(e>=0),(0,j.Z)(n>=0),this.radii=new w.Z(t,e,n),this.radiiSquared=new w.Z(t*t,e*e,n*n),this.radiiToTheFourth=new w.Z(t*t*t*t,e*e*e*e,n*n*n*n),this.oneOverRadii=new w.Z(0===t?0:1/t,0===e?0:1/e,0===n?0:1/n),this.oneOverRadiiSquared=new w.Z(0===t?0:1/(t*t),0===e?0:1/(e*e),0===n?0:1/(n*n)),this.minimumRadius=Math.min(t,e,n),this.maximumRadius=Math.max(t,e,n),this.centerToleranceSquared=$.Z.EPSILON1,0!==this.radiiSquared.z&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}equals(t){return this===t||Boolean(t&&this.radii.equals(t.radii))}toString(){return this.radii.toString()}cartographicToCartesian(t,e=[0,0,0]){const n=Pe,r=Me,[,,i]=t;this.geodeticSurfaceNormalCartographic(t,n),r.copy(this.radiiSquared).scale(n);const o=Math.sqrt(n.dot(r));return r.scale(1/o),n.scale(i),r.add(n),r.to(e)}cartesianToCartographic(t,e=[0,0,0]){Oe.from(t);const n=this.scaleToGeodeticSurface(Oe,Ce);if(!n)return;const r=this.geodeticSurfaceNormal(n,Pe),i=Ie;i.copy(Oe).subtract(n);const o=Math.atan2(r.y,r.x),s=Math.asin(r.z),a=Math.sign((u=Oe,(l=i)[0]*u[0]+l[1]*u[1]+l[2]*u[2]))*function(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}(i);var l,u;return function(t,e,n=fe){return(0,U.kJ)(e)?(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]):"longitude"in e?(e.longitude=n(t[0]),e.latitude=n(t[1]),e.height=t[2]):(e.x=n(t[0]),e.y=n(t[1]),e.z=t[2]),e}([o,s,a],e,U.vc._cartographicRadians?fe:U.Ux)}eastNorthUpToFixedFrame(t,e=new Rt.Z){return Se(this,"east","north","up",t,e)}localFrameToFixedFrame(t,e,n,r,i=new Rt.Z){return Se(this,t,e,n,r,i)}geocentricSurfaceNormal(t,e=[0,0,0]){return Te.from(t).normalize().to(e)}geodeticSurfaceNormalCartographic(t,e=[0,0,0]){const n=function(t,e=de){return function(t,e,n=fe){return(0,U.kJ)(t)?(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]):"longitude"in t?(e[0]=n(t.longitude),e[1]=n(t.latitude),e[2]=t.height):(e[0]=n(t.x),e[1]=n(t.y),e[2]=t.z),e}(t,e,U.vc._cartographicRadians?fe:U.Yr)}(t),r=n[0],i=n[1],o=Math.cos(i);return Te.set(o*Math.cos(r),o*Math.sin(r),Math.sin(i)).normalize(),Te.to(e)}geodeticSurfaceNormal(t,e=[0,0,0]){return Te.from(t).scale(this.oneOverRadiiSquared).normalize().to(e)}scaleToGeodeticSurface(t,e){return function(t,e,n=new w.Z){const{oneOverRadii:r,oneOverRadiiSquared:i,centerToleranceSquared:o}=e;ge.from(t);const s=t.x,a=t.y,l=t.z,u=r.x,c=r.y,h=r.z,p=s*s*u*u,f=a*a*c*c,d=l*l*h*h,g=p+f+d,m=Math.sqrt(1/g);if(!Number.isFinite(m))return;const A=me;if(A.copy(t).scale(m),g<o)return A.to(n);const y=i.x,_=i.y,v=i.z,b=Ae;b.set(A.x*y*2,A.y*_*2,A.z*v*2);let x,E,S,T,P=(1-m)*t.len()/(.5*b.len()),M=0;do{P-=M,x=1/(1+P*y),E=1/(1+P*_),S=1/(1+P*v);const t=x*x,e=E*E,n=S*S;T=p*t+f*e+d*n-1,M=T/(-2*(p*(t*x)*y+f*(e*E)*_+d*(n*S)*v))}while(Math.abs(T)>$.Z.EPSILON12);return ge.scale([x,E,S]).to(n)}(t,this,e)}scaleToGeocentricSurface(t,e=[0,0,0]){Ce.from(t);const n=Ce.x,r=Ce.y,i=Ce.z,o=this.oneOverRadiiSquared,s=1/Math.sqrt(n*n*o.x+r*r*o.y+i*i*o.z);return Ce.multiplyScalar(s).to(e)}transformPositionToScaledSpace(t,e=[0,0,0]){return Ce.from(t).scale(this.oneOverRadii).to(e)}transformPositionFromScaledSpace(t,e=[0,0,0]){return Ce.from(t).scale(this.radii).to(e)}getSurfaceNormalIntersectionWithZAxis(t,e=0,n=[0,0,0]){(0,j.Z)((0,U.fS)(this.radii.x,this.radii.y,$.Z.EPSILON15)),(0,j.Z)(this.radii.z>0),Ce.from(t);const r=Ce.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(r)>=this.radii.z-e))return Ce.set(0,0,r).to(n)}}var ke=n(6269);function De(t){const e=t&&t.lastIndexOf("/");return e>=0?t.substr(0,e):""}class Ne{constructor(t,e,n){this.item=t,this.previous=e,this.next=n}}class Fe{constructor(){this.head=null,this.tail=null,this._length=0}get length(){return this._length}add(t){const e=new Ne(t,this.tail,null);return this.tail?(this.tail.next=e,this.tail=e):(this.head=e,this.tail=e),++this._length,e}remove(t){t&&(t.previous&&t.next?(t.previous.next=t.next,t.next.previous=t.previous):t.previous?(t.previous.next=null,this.tail=t.previous):t.next?(t.next.previous=null,this.head=t.next):(this.head=null,this.tail=null),t.next=null,t.previous=null,--this._length)}splice(t,e){t!==e&&(this.remove(e),this._insert(t,e))}_insert(t,e){const n=t.next;t.next=e,this.tail===t?this.tail=e:n.previous=e,e.next=n,e.previous=t,++this._length}}function Be(t){return null!=t}class ze{constructor(){(0,Mt.Z)(this,"_list",void 0),(0,Mt.Z)(this,"_sentinel",void 0),(0,Mt.Z)(this,"_trimTiles",void 0),this._list=new Fe,this._sentinel=this._list.add("sentinel"),this._trimTiles=!1}reset(){this._list.splice(this._list.tail,this._sentinel)}touch(t){const e=t._cacheNode;Be(e)&&this._list.splice(this._sentinel,e)}add(t,e,n){Be(e._cacheNode)||(e._cacheNode=this._list.add(e),n&&n(t,e))}unloadTile(t,e,n){const r=e._cacheNode;Be(r)&&(this._list.remove(r),e._cacheNode=void 0,n&&n(t,e))}unloadTiles(t,e){const n=this._trimTiles;this._trimTiles=!1;const r=this._list,i=1024*t.maximumMemoryUsage*1024,o=this._sentinel;let s=r.head;for(;s!==o&&(t.gpuMemoryUsageInBytes>i||n);){const n=s.item;s=s.next,this.unloadTile(t,n,e)}}trim(){this._trimTiles=!0}}const je=new w.Z,Ue=new w.Z,Ve=new X([new Z,new Z,new Z,new Z,new Z,new Z]);function Ge(t,e){const{cameraDirection:n,cameraUp:r,height:i}=t,{metersPerUnit:o}=t.distanceScales,s=[t.longitude,t.latitude,0],a=Le.WGS84.cartographicToCartesian(s,new w.Z),l=Le.WGS84.eastNorthUpToFixedFrame(a),u=t.unprojectPosition(t.cameraPosition),c=Le.WGS84.cartographicToCartesian(u,new w.Z),h=new w.Z(l.transformAsVector(new w.Z(n).scale(o))).normalize(),p=new w.Z(l.transformAsVector(new w.Z(r).scale(o))).normalize();return function(t,e){const n=t.getFrustumPlanes();let r=0;for(const i in n){const o=n[i],s=o.normal.dot(t.center);Ue.copy(o.normal).scale(o.distance-s).add(t.center);const a=t.unprojectPosition(Ue),l=Le.WGS84.cartographicToCartesian(a,new w.Z);Ve.planes[r++].fromPointNormal(l,je.copy(e).subtract(l))}}(t,a),{camera:{position:c,direction:h,up:p},viewport:t,height:i,cullingVolume:Ve,frameNumber:e,sseDenominator:1.15}}const Ze=6356752.314245179,qe=new w.Z;const We="scenegraph",He="pointcloud",Xe="I3S",$e="TILES3D",Ye="geometricError";function Qe(t){return null!=t}const Ke=new w.Z,Je=new w.Z,tn=new w.Z;function en(t,e,n){if((0,ke.h)(t,"3D Tile: boundingVolume must be defined"),t.box)return function(t,e,n){const r=new w.Z(t[0],t[1],t[2]);e.transform(r,r);let i=[];if(10===t.length){const e=t.slice(3,6),n=new O.Z;n.fromArray(t,6);const r=new w.Z([1,0,0]),o=new w.Z([0,1,0]),s=new w.Z([0,0,1]);r.transformByQuaternion(n),r.scale(e[0]),o.transformByQuaternion(n),o.scale(e[1]),s.transformByQuaternion(n),s.scale(e[2]),i=[...r.toArray(),...o.toArray(),...s.toArray()]}else i=[...t.slice(3,6),...t.slice(6,9),...t.slice(9,12)];const o=e.transformAsVector(i.slice(0,3)),s=e.transformAsVector(i.slice(3,6)),a=e.transformAsVector(i.slice(6,9)),l=new I.Z([o[0],o[1],o[2],s[0],s[1],s[2],a[0],a[1],a[2]]);return Qe(n)?(n.center=r,n.halfAxes=l,n):new z(r,l)}(t.box,e,n);if(t.region){const[e,n,r,i,o,s]=t.region,a=Le.WGS84.cartographicToCartesian([(0,U.RW)(e),(0,U.RW)(i),o],Je),l=Le.WGS84.cartographicToCartesian([(0,U.RW)(r),(0,U.RW)(n),s],tn),u=(new w.Z).addVectors(a,l).multiplyScalar(.5),c=(new w.Z).subVectors(a,l).len()/2;return nn([u[0],u[1],u[2],c],new Rt.Z)}if(t.sphere)return nn(t.sphere,e,n);throw new Error("3D Tile: boundingVolume must contain a sphere, region, or box")}function nn(t,e,n){const r=new w.Z(t[0],t[1],t[2]);e.transform(r,r);const i=e.getScale(Ke),o=Math.max(Math.max(i[0],i[1]),i[2]),s=t[3]*o;return Qe(n)?(n.center=r,n.radius=s,n):new C(r,s)}new w.Z,new w.Z,new Rt.Z,new w.Z,new w.Z,new w.Z;const rn=6378137,on=Math.PI/2;function sn([t,e,n]){const r=(0,U.Yr)(t),i=(0,U.Yr)(e),o=1+n/rn,s=o*Math.cos(i);return[t=s*Math.cos(r),e=s*Math.sin(r),n=o*Math.sin(i)]}function an(t,e){const[n,r,i=0]=t,[o,s,a=0]=e,l=sn([o,s,a]),u=sn([n,r,i]),c=u[0]-l[0],h=u[1]-l[1],p=u[2]-l[2];return c*c+h*h+p*p}function ln(t,e){const n=e.viewport,r=t.header.mbs[1],i=t.header.mbs[0],o=t.header.mbs[2],s=t.header.mbs[3],a=[i,r,o],l=an(n.unprojectPosition(n.cameraPosition),a),u=s/rn,c=l-u*u;if(c<=0)return 170141175e30;const h=function(t){const{projectionMatrix:e}=t.viewport;return e[5]}(e)*u/Math.sqrt(c)*300;return h}class un{constructor(t=0){this._array=new Array(t),this._map=new Map,this._length=t}get length(){return this._length}set length(t){this._length=t,t>this._array.length&&(this._array.length=t)}get values(){return this._array}get(t){return(0,ke.h)(t<this._array.length),this._array[t]}set(t,e){(0,ke.h)(t>=0),t>=this.length&&(this.length=t+1),this._map.has(this._array[t])&&this._map.delete(this._array[t]),this._array[t]=e,this._map.set(e,t)}delete(t){const e=this._map.get(t);e>=0&&(this._array.splice(e,1),this._map.delete(t),this.length--)}peek(){return this._array[this._length-1]}push(t){if(!this._map.has(t)){const e=this.length++;this._array[e]=t,this._map.set(t,e)}}pop(){const t=this._array[--this.length];return this._map.delete(t),t}reserve(t){(0,ke.h)(t>=0),t>this._array.length&&(this._array.length=t)}resize(t){(0,ke.h)(t>=0),this.length=t}trim(t){null==t&&(t=this.length),this._array.length=t}reset(){this._array=[],this._map=new Map,this._length=0}find(t){return this._map.has(t)}}const cn={loadSiblings:!1,skipLevelOfDetail:!1,maximumScreenSpaceError:2,updateTransforms:!0,onTraversalEnd:()=>{},viewportTraversersMap:{},basePath:""};class hn{constructor(t){(0,Mt.Z)(this,"options",void 0),(0,Mt.Z)(this,"root",void 0),(0,Mt.Z)(this,"requestedTiles",void 0),(0,Mt.Z)(this,"selectedTiles",void 0),(0,Mt.Z)(this,"emptyTiles",void 0),(0,Mt.Z)(this,"_traversalStack",void 0),(0,Mt.Z)(this,"_emptyTraversalStack",void 0),(0,Mt.Z)(this,"_frameNumber",void 0),this.options={...cn,...t},this._traversalStack=new un,this._emptyTraversalStack=new un,this._frameNumber=null,this.root=null,this.selectedTiles={},this.requestedTiles={},this.emptyTiles={}}traverse(t,e,n){this.root=t,this.options={...this.options,...n},this.reset(),this.updateTile(t,e),this._frameNumber=e.frameNumber,this.executeTraversal(t,e)}reset(){this.requestedTiles={},this.selectedTiles={},this.emptyTiles={},this._traversalStack.reset(),this._emptyTraversalStack.reset()}executeTraversal(t,e){const n=this._traversalStack;for(t._selectionDepth=1,n.push(t);n.length>0;){const t=n.pop();let r=!1;this.canTraverse(t,e)&&(this.updateChildTiles(t,e),r=this.updateAndPushChildren(t,e,n,t.hasRenderContent?t._selectionDepth+1:t._selectionDepth));const i=t.parent,o=Boolean(!i||i._shouldRefine),s=!r;t.hasRenderContent?1===t.refine?(this.loadTile(t,e),this.selectTile(t,e)):2===t.refine&&(this.loadTile(t,e),s&&this.selectTile(t,e)):(this.emptyTiles[t.id]=t,this.loadTile(t,e),s&&this.selectTile(t,e)),this.touchTile(t,e),t._shouldRefine=r&&o}this.options.onTraversalEnd(e)}updateChildTiles(t,e){const n=t.children;for(const t of n)this.updateTile(t,e);return!0}updateAndPushChildren(t,e,n,r){const{loadSiblings:i,skipLevelOfDetail:o}=this.options,s=t.children;s.sort(this.compareDistanceToCamera.bind(this));const a=2===t.refine&&t.hasRenderContent&&!o;let l=!1,u=!0;for(const t of s)if(t._selectionDepth=r,t.isVisibleAndInRequestVolume?(n.find(t)&&n.delete(t),n.push(t),l=!0):(a||i)&&(this.loadTile(t,e),this.touchTile(t,e)),a){let n;if(n=!!t._inRequestVolume&&(t.hasRenderContent?t.contentAvailable:this.executeEmptyTraversal(t,e)),u=u&&n,!u)return!1}return l||(u=!1),u}updateTile(t,e){this.updateTileVisibility(t,e)}selectTile(t,e){this.shouldSelectTile(t)&&(t._selectedFrame=e.frameNumber,this.selectedTiles[t.id]=t)}loadTile(t,e){this.shouldLoadTile(t)&&(t._requestedFrame=e.frameNumber,t._priority=t._getPriority(),this.requestedTiles[t.id]=t)}touchTile(t,e){t.tileset._cache.touch(t),t._touchedFrame=e.frameNumber}canTraverse(t,e,n=!1,r=!1){return!!t.hasChildren&&(t.hasTilesetContent?!t.contentExpired:!(!r&&!t.isVisibleAndInRequestVolume)&&this.shouldRefine(t,e,n))}shouldLoadTile(t){return t.hasUnloadedContent||t.contentExpired}shouldSelectTile(t){return t.contentAvailable&&!this.options.skipLevelOfDetail}shouldRefine(t,e,n){let r=t._screenSpaceError;return n&&(r=t.getScreenSpaceError(e,!0)),r>this.options.maximumScreenSpaceError}updateTileVisibility(t,e){const n=[];if(this.options.viewportTraversersMap)for(const t in this.options.viewportTraversersMap)this.options.viewportTraversersMap[t]===e.viewport.id&&n.push(t);else n.push(e.viewport.id);t.updateVisibility(e,n)}compareDistanceToCamera(t,e){return t._distanceToCamera-e._distanceToCamera}anyChildrenVisible(t,e){let n=!1;for(const r of t.children)r.updateVisibility(e),n=n||r.isVisibleAndInRequestVolume;return n}executeEmptyTraversal(t,e){let n=!0;const r=this._emptyTraversalStack;for(r.push(t);r.length>0&&n;){const t=r.pop();if(this.updateTile(t,e),t.isVisibleAndInRequestVolume||this.loadTile(t,e),this.touchTile(t,e),!t.hasRenderContent&&this.canTraverse(t,e,!1,!0)){const e=t.children;for(const t of e)r.find(t)&&r.delete(t),r.push(t)}else t.contentAvailable||(n=!1)}return n}}const pn=new w.Z;class fn{constructor(t,e,n,r=""){(0,Mt.Z)(this,"tileset",void 0),(0,Mt.Z)(this,"header",void 0),(0,Mt.Z)(this,"id",void 0),(0,Mt.Z)(this,"url",void 0),(0,Mt.Z)(this,"parent",void 0),(0,Mt.Z)(this,"refine",void 0),(0,Mt.Z)(this,"type",void 0),(0,Mt.Z)(this,"contentUrl",void 0),(0,Mt.Z)(this,"lodMetricType",void 0),(0,Mt.Z)(this,"lodMetricValue",void 0),(0,Mt.Z)(this,"boundingVolume",void 0),(0,Mt.Z)(this,"content",void 0),(0,Mt.Z)(this,"contentState",void 0),(0,Mt.Z)(this,"gpuMemoryUsageInBytes",void 0),(0,Mt.Z)(this,"children",void 0),(0,Mt.Z)(this,"depth",void 0),(0,Mt.Z)(this,"viewportIds",void 0),(0,Mt.Z)(this,"transform",void 0),(0,Mt.Z)(this,"userData",void 0),(0,Mt.Z)(this,"computedTransform",void 0),(0,Mt.Z)(this,"hasEmptyContent",void 0),(0,Mt.Z)(this,"hasTilesetContent",void 0),(0,Mt.Z)(this,"traverser",void 0),(0,Mt.Z)(this,"_cacheNode",void 0),(0,Mt.Z)(this,"_frameNumber",void 0),(0,Mt.Z)(this,"_lodJudge",void 0),(0,Mt.Z)(this,"_expireDate",void 0),(0,Mt.Z)(this,"_expiredContent",void 0),(0,Mt.Z)(this,"_shouldRefine",void 0),(0,Mt.Z)(this,"_distanceToCamera",void 0),(0,Mt.Z)(this,"_centerZDepth",void 0),(0,Mt.Z)(this,"_screenSpaceError",void 0),(0,Mt.Z)(this,"_visibilityPlaneMask",void 0),(0,Mt.Z)(this,"_visible",void 0),(0,Mt.Z)(this,"_inRequestVolume",void 0),(0,Mt.Z)(this,"_stackLength",void 0),(0,Mt.Z)(this,"_selectionDepth",void 0),(0,Mt.Z)(this,"_touchedFrame",void 0),(0,Mt.Z)(this,"_visitedFrame",void 0),(0,Mt.Z)(this,"_selectedFrame",void 0),(0,Mt.Z)(this,"_requestedFrame",void 0),(0,Mt.Z)(this,"_priority",void 0),(0,Mt.Z)(this,"_contentBoundingVolume",void 0),(0,Mt.Z)(this,"_viewerRequestVolume",void 0),(0,Mt.Z)(this,"_initialTransform",void 0),this.header=e,this.tileset=t,this.id=r||e.id,this.url=e.url,this.parent=n,this.refine=this._getRefine(e.refine),this.type=e.type,this.contentUrl=e.contentUrl,this.lodMetricType="geometricError",this.lodMetricValue=0,this.boundingVolume=null,this.content=null,this.contentState=0,this.gpuMemoryUsageInBytes=0,this.children=[],this.hasEmptyContent=!1,this.hasTilesetContent=!1,this.depth=0,this.viewportIds=[],this.userData={},this._priority=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._screenSpaceError=0,this._cacheNode=null,this._frameNumber=null,this._cacheNode=null,this.traverser=new hn({}),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._initialTransform=new Rt.Z,this.transform=new Rt.Z,this._initializeLodMetric(e),this._initializeTransforms(e),this._initializeBoundingVolumes(e),this._initializeContent(e),this._initializeRenderingState(e),this._lodJudge=null,this._expireDate=null,this._expiredContent=null,Object.seal(this)}destroy(){this.header=null}isDestroyed(){return null===this.header}get selected(){return this._selectedFrame===this.tileset._frameNumber}get isVisible(){return this._visible}get isVisibleAndInRequestVolume(){return this._visible&&this._inRequestVolume}get hasRenderContent(){return!this.hasEmptyContent&&!this.hasTilesetContent}get hasChildren(){return this.children.length>0||this.header.children&&this.header.children.length>0}get contentReady(){return 3===this.contentState||this.hasEmptyContent}get contentAvailable(){return Boolean(this.contentReady&&this.hasRenderContent||this._expiredContent&&!this.contentFailed)}get hasUnloadedContent(){return this.hasRenderContent&&this.contentUnloaded}get contentUnloaded(){return 0===this.contentState}get contentExpired(){return 4===this.contentState}get contentFailed(){return 5===this.contentState}getScreenSpaceError(t,e){switch(this.tileset.type){case Xe:return ln(this,t);case $e:return function(t,e,n){const r=t.tileset,i=t.parent&&t.parent.lodMetricValue||t.lodMetricValue,o=n?i:t.lodMetricValue;if(0===o)return 0;const s=Math.max(t._distanceToCamera,1e-7),{height:a,sseDenominator:l}=e,{viewDistanceScale:u}=r.options;let c=o*a*(u||1)/(s*l);return c-=function(t,e){if(t.dynamicScreenSpaceError&&t.dynamicScreenSpaceErrorComputedDensity){const n=t.dynamicScreenSpaceErrorComputedDensity,r=t.dynamicScreenSpaceErrorFactor,i=function(t,e){const n=t*e;return 1-Math.exp(-n*n)}(e,n)*r;return i}return 0}(r,s),c}(this,t,e);default:throw new Error("Unsupported tileset type")}}_getPriority(){const t=this.tileset._traverser,{skipLevelOfDetail:e}=t.options,n=1===this.refine||e;if(n&&!this.isVisible&&void 0!==this._visible)return-1;if(this.tileset._frameNumber-this._touchedFrame>=1)return-1;if(0===this.contentState)return-1;const r=this.parent,i=!r||n&&0!==this._screenSpaceError&&!r.hasTilesetContent?this._screenSpaceError:r._screenSpaceError,o=t.root?t.root._screenSpaceError:0;return Math.max(o-i,0)}async loadContent(){if(this.hasEmptyContent)return!1;if(this.content)return!0;this.contentExpired&&(this._expireDate=null),this.contentState=1;const t=await this.tileset._requestScheduler.scheduleRequest(this.id,this._getPriority.bind(this));if(!t)return this.contentState=0,!1;try{const e=this.tileset.getTileUrl(this.contentUrl),n=this.tileset.loader,r={...this.tileset.loadOptions,[n.id]:{...this.tileset.loadOptions[n.id],isTileset:"json"===this.type,...this._getLoaderSpecificOptions(n.id)}};return this.content=await(0,le.z)(e,n,r),this.tileset.options.contentLoader&&await this.tileset.options.contentLoader(this),this._isTileset()&&this.tileset._initializeTileHeaders(this.content,this),this.contentState=3,this._onContentLoaded(),!0}catch(t){throw this.contentState=5,t}finally{t.done()}}unloadContent(){return this.content&&this.content.destroy&&this.content.destroy(),this.content=null,this.header.content&&this.header.content.destroy&&this.header.content.destroy(),this.header.content=null,this.contentState=0,!0}updateVisibility(t,e){if(this._frameNumber===t.frameNumber)return;const n=this.parent,r=n?n._visibilityPlaneMask:X.MASK_INDETERMINATE;if(this.tileset._traverser.options.updateTransforms){const t=n?n.computedTransform:this.tileset.modelMatrix;this._updateTransform(t)}this._distanceToCamera=this.distanceToTile(t),this._screenSpaceError=this.getScreenSpaceError(t,!1),this._visibilityPlaneMask=this.visibility(t,r),this._visible=this._visibilityPlaneMask!==X.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(t),this._frameNumber=t.frameNumber,this.viewportIds=e}visibility(t,e){const{cullingVolume:n}=t,{boundingVolume:r}=this;return n.computeVisibilityWithPlaneMask(r,e)}contentVisibility(){return!0}distanceToTile(t){const e=this.boundingVolume;return Math.sqrt(Math.max(e.distanceSquaredTo(t.camera.position),0))}cameraSpaceZDepth({camera:t}){const e=this.boundingVolume;return pn.subVectors(e.center,t.position),t.direction.dot(pn)}insideViewerRequestVolume(t){const e=this._viewerRequestVolume;return!e||e.distanceSquaredTo(t.camera.position)<=0}updateExpiration(){if(function(t){return null!=t}(this._expireDate)&&this.contentReady&&!this.hasEmptyContent){const t=Date.now();Date.lessThan(this._expireDate,t)&&(this.contentState=4,this._expiredContent=this.content)}}get extras(){return this.header.extras}_initializeLodMetric(t){"lodMetricType"in t?this.lodMetricType=t.lodMetricType:(this.lodMetricType=this.parent&&this.parent.lodMetricType||this.tileset.lodMetricType,console.warn("3D Tile: Required prop lodMetricType is undefined. Using parent lodMetricType")),"lodMetricValue"in t?this.lodMetricValue=t.lodMetricValue:(this.lodMetricValue=this.parent&&this.parent.lodMetricValue||this.tileset.lodMetricValue,console.warn("3D Tile: Required prop lodMetricValue is undefined. Using parent lodMetricValue"))}_initializeTransforms(t){this.transform=t.transform?new Rt.Z(t.transform):new Rt.Z;const e=this.parent,n=this.tileset,r=e&&e.computedTransform?e.computedTransform.clone():n.modelMatrix.clone();this.computedTransform=new Rt.Z(r).multiplyRight(this.transform);const i=e&&e._initialTransform?e._initialTransform.clone():new Rt.Z;this._initialTransform=new Rt.Z(i).multiplyRight(this.transform)}_initializeBoundingVolumes(t){this._contentBoundingVolume=null,this._viewerRequestVolume=null,this._updateBoundingVolume(t)}_initializeContent(t){this.content={_tileset:this.tileset,_tile:this},this.hasEmptyContent=!0,this.contentState=0,this.hasTilesetContent=!1,t.contentUrl&&(this.content=null,this.hasEmptyContent=!1)}_initializeRenderingState(t){this.depth=t.level||(this.parent?this.parent.depth+1:0),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=X.MASK_INDETERMINATE,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._frameNumber=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._priority=0}_getRefine(t){return t||this.parent&&this.parent.refine||2}_isTileset(){return-1!==this.contentUrl.indexOf(".json")}_onContentLoaded(){switch(this.content&&this.content.type){case"vctr":case"geom":this.tileset._traverser.disableSkipLevelOfDetail=!0}this._isTileset()&&(this.hasTilesetContent=!0)}_updateBoundingVolume(t){this.boundingVolume=en(t.boundingVolume,this.computedTransform,this.boundingVolume);const e=t.content;e&&(e.boundingVolume&&(this._contentBoundingVolume=en(e.boundingVolume,this.computedTransform,this._contentBoundingVolume)),t.viewerRequestVolume&&(this._viewerRequestVolume=en(t.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)))}_updateTransform(t=new Rt.Z){const e=t.clone().multiplyRight(this.transform);!e.equals(this.computedTransform)&&(this.computedTransform=e,this._updateBoundingVolume(this.header))}_getLoaderSpecificOptions(t){return"i3s"===t?{...this.tileset.options.i3s,tile:this.header,tileset:this.tileset.tileset,isTileHeader:!1}:{assetGltfUpAxis:(e=this.tileset.tileset).asset&&e.asset.gltfUpAxis||"Y"};var e}}class dn extends hn{compareDistanceToCamera(t,e){return 0===e._distanceToCamera&&0===t._distanceToCamera?e._centerZDepth-t._centerZDepth:e._distanceToCamera-t._distanceToCamera}updateTileVisibility(t,e){if(super.updateTileVisibility(t,e),!t.isVisibleAndInRequestVolume)return;const n=t.children.length>0;if(t.hasTilesetContent&&n){const n=t.children[0];return this.updateTileVisibility(n,e),void(t._visible=n._visible)}if(this.meetsScreenSpaceErrorEarly(t,e))return void(t._visible=!1);const r=2===t.refine,i=1===t._optimChildrenWithinParent;r&&i&&n&&!this.anyChildrenVisible(t,e)&&(t._visible=!1)}meetsScreenSpaceErrorEarly(t,e){const{parent:n}=t;return!(!n||n.hasTilesetContent||1!==n.refine||this.shouldRefine(t,e,!0))}}class gn{constructor(){(0,Mt.Z)(this,"_statusMap",void 0),this._statusMap={}}add(t,e,n,r){this._statusMap[e]||(this._statusMap[e]={request:t,callback:n,key:e,frameState:r,status:"REQUESTED"},t().then((t=>{this._statusMap[e].status="COMPLETED",this._statusMap[e].callback(t,r)})).catch((t=>{this._statusMap[e].status="ERROR",n(t)})))}update(t,e){this._statusMap[t]&&(this._statusMap[t].frameState=e)}find(t){return this._statusMap[t]}}class mn extends hn{constructor(t){super(t),(0,Mt.Z)(this,"_tileManager",void 0),this._tileManager=new gn}shouldRefine(t,e){return t._lodJudge=function(t,e){const n=e.viewport,r=n.metersPerPixel,i=t.header.mbs[1],o=t.header.mbs[0],s=t.header.mbs[2],a=t.header.mbs[3],{height:l,width:u,latitude:c,longitude:h}=n,p=[h,c],f=[o,i,s],d=[h,i],g=[o,c],m=Math.sqrt(l*l+u*u)*r[0],A=an(p,f),y=.5*l+a/rn,_=.5*u+a/rn;if(A>m+a/rn)return"OUT";if(an(p,d)>y)return"OUT";if(an(p,g)>_)return"OUT";if(0===t.lodMetricValue)return"DIG";let v=ln(t,e);return v*=on,v<.5?"OUT":!t.header.children||v<=t.lodMetricValue?"DRAW":t.header.children?"DIG":"OUT"}(t,e),"DIG"===t._lodJudge}updateChildTiles(t,e){const n=t.header.children||[],r=t.children,i=t.tileset;for(const o of n){const n=`${o.id}-${e.viewport.id}`,s=r&&r.find((t=>t.id===n));if(s)s&&this.updateTile(s,e);else{let r=()=>this._loadTile(o.id,i);this._tileManager.find(n)?this._tileManager.update(n,e):(i.tileset.nodePages&&(r=()=>i.tileset.nodePagesTile.formTileFromNodePages(o.id)),this._tileManager.add(r,n,(e=>this._onTileLoad(e,t,n)),e))}}return!1}async _loadTile(t,e){const{loader:n}=e,r=e.getTileUrl(`${e.url}/nodes/${t}`),i={...e.loadOptions,i3s:{...e.loadOptions.i3s,isTileHeader:!0,loadContent:!1}};return await(0,le.z)(r,n,i)}_onTileLoad(t,e,n){const r=new fn(e.tileset,t,e,n);e.children.push(r);const i=this._tileManager.find(r.id).frameState;this.updateTile(r,i),this._frameNumber===i.frameNumber&&this.executeTraversal(r,i)}}const An={description:"",ellipsoid:Le.WGS84,modelMatrix:new Rt.Z,throttleRequests:!0,maxRequests:64,maximumMemoryUsage:32,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{},onTraversalComplete:t=>t,contentLoader:void 0,viewDistanceScale:1,maximumScreenSpaceError:8,loadTiles:!0,updateTransforms:!0,viewportTraversersMap:null,loadOptions:{fetch:{}},attributions:[],basePath:"",i3s:{}},yn="Tiles In Tileset(s)",_n="Tiles In Memory",vn="Tiles In View",bn="Tiles To Render",xn="Tiles Loaded",wn="Tiles Loading",En="Tiles Unloaded",Sn="Failed Tile Loads",Tn="Points",Pn="Tile Memory Use";class Mn{constructor(t,e){(0,Mt.Z)(this,"options",void 0),(0,Mt.Z)(this,"loadOptions",void 0),(0,Mt.Z)(this,"type",void 0),(0,Mt.Z)(this,"tileset",void 0),(0,Mt.Z)(this,"loader",void 0),(0,Mt.Z)(this,"url",void 0),(0,Mt.Z)(this,"basePath",void 0),(0,Mt.Z)(this,"modelMatrix",void 0),(0,Mt.Z)(this,"ellipsoid",void 0),(0,Mt.Z)(this,"lodMetricType",void 0),(0,Mt.Z)(this,"lodMetricValue",void 0),(0,Mt.Z)(this,"refine",void 0),(0,Mt.Z)(this,"root",void 0),(0,Mt.Z)(this,"roots",void 0),(0,Mt.Z)(this,"asset",void 0),(0,Mt.Z)(this,"description",void 0),(0,Mt.Z)(this,"properties",void 0),(0,Mt.Z)(this,"extras",void 0),(0,Mt.Z)(this,"attributions",void 0),(0,Mt.Z)(this,"credits",void 0),(0,Mt.Z)(this,"stats",void 0),(0,Mt.Z)(this,"traverseCounter",void 0),(0,Mt.Z)(this,"geometricError",void 0),(0,Mt.Z)(this,"selectedTiles",void 0),(0,Mt.Z)(this,"cartographicCenter",void 0),(0,Mt.Z)(this,"cartesianCenter",void 0),(0,Mt.Z)(this,"zoom",void 0),(0,Mt.Z)(this,"boundingVolume",void 0),(0,Mt.Z)(this,"gpuMemoryUsageInBytes",void 0),(0,Mt.Z)(this,"dynamicScreenSpaceErrorComputedDensity",void 0),(0,Mt.Z)(this,"_traverser",void 0),(0,Mt.Z)(this,"_cache",void 0),(0,Mt.Z)(this,"_requestScheduler",void 0),(0,Mt.Z)(this,"_frameNumber",void 0),(0,Mt.Z)(this,"_queryParamsString",void 0),(0,Mt.Z)(this,"_queryParams",void 0),(0,Mt.Z)(this,"_extensionsUsed",void 0),(0,Mt.Z)(this,"_tiles",void 0),(0,Mt.Z)(this,"_pendingCount",void 0),(0,Mt.Z)(this,"lastUpdatedVieports",void 0),(0,Mt.Z)(this,"_requestedTiles",void 0),(0,Mt.Z)(this,"_emptyTiles",void 0),(0,Mt.Z)(this,"frameStateData",void 0),(0,Mt.Z)(this,"maximumMemoryUsage",void 0),(0,ke.h)(t),this.options={...An,...e},this.tileset=t,this.loader=t.loader,this.type=t.type,this.url=t.url,this.basePath=t.basePath||De(this.url),this.modelMatrix=this.options.modelMatrix,this.ellipsoid=this.options.ellipsoid,this.lodMetricType=t.lodMetricType,this.lodMetricValue=t.lodMetricValue,this.refine=t.root.refine,this.loadOptions=this.options.loadOptions||{},this.root=null,this.roots={},this.cartographicCenter=null,this.cartesianCenter=null,this.zoom=1,this.boundingVolume=null,this.traverseCounter=0,this.geometricError=0,this._traverser=this._initializeTraverser(),this._cache=new ze,this._requestScheduler=new Ot({throttleRequests:this.options.throttleRequests,maxRequests:this.options.maxRequests}),this._frameNumber=0,this._pendingCount=0,this._tiles={},this.selectedTiles=[],this._emptyTiles=[],this._requestedTiles=[],this.frameStateData={},this.lastUpdatedVieports=null,this._queryParams={},this._queryParamsString="",this.maximumMemoryUsage=this.options.maximumMemoryUsage||32,this.gpuMemoryUsageInBytes=0,this.stats=new Ct.Z({id:this.url}),this._initializeStats(),this._extensionsUsed=void 0,this.dynamicScreenSpaceErrorComputedDensity=0,this.extras=null,this.asset={},this.credits={},this.description=this.options.description||"",this._initializeTileSet(t)}destroy(){this._destroy()}isLoaded(){return 0===this._pendingCount&&0!==this._frameNumber}get tiles(){return Object.values(this._tiles)}get frameNumber(){return this._frameNumber}get queryParams(){return this._queryParamsString||(this._queryParamsString=function(t){const e=[];for(const n of Object.keys(t))e.push(`${n}=${t[n]}`);switch(e.length){case 0:return"";case 1:return`?${e[0]}`;default:return`?${e.join("&")}`}}(this._queryParams)),this._queryParamsString}setProps(t){this.options={...this.options,...t}}setOptions(t){this.options={...this.options,...t}}getTileUrl(t){return t.startsWith("data:")?t:`${t}${this.queryParams}`}hasExtension(t){return Boolean(this._extensionsUsed&&this._extensionsUsed.indexOf(t)>-1)}update(t){if("loadTiles"in this.options&&!this.options.loadTiles)return;if(this.traverseCounter>0)return;!t&&this.lastUpdatedVieports?t=this.lastUpdatedVieports:this.lastUpdatedVieports=t,t instanceof Array||(t=[t]),this._cache.reset(),this._frameNumber++,this.traverseCounter=t.length;const e=[];for(const n of t){const t=n.id;this._needTraverse(t)?e.push(t):this.traverseCounter--}for(const n of t){const t=n.id;if(this.roots[t]||(this.roots[t]=this._initializeTileHeaders(this.tileset,null)),!e.includes(t))continue;const r=Ge(n,this._frameNumber);this._traverser.traverse(this.roots[t],r,this.options)}}_needTraverse(t){let e=t;return this.options.viewportTraversersMap&&(e=this.options.viewportTraversersMap[t]),e===t}_onTraversalEnd(t){const e=t.viewport.id;this.frameStateData[e]||(this.frameStateData[e]={selectedTiles:[],_requestedTiles:[],_emptyTiles:[]});const n=this.frameStateData[e],r=Object.values(this._traverser.selectedTiles);n.selectedTiles=r,n._requestedTiles=Object.values(this._traverser.requestedTiles),n._emptyTiles=Object.values(this._traverser.emptyTiles),this.traverseCounter--,this.traverseCounter>0||this._updateTiles()}_updateTiles(){this.selectedTiles=[],this._requestedTiles=[],this._emptyTiles=[];for(const t in this.frameStateData){const e=this.frameStateData[t];this.selectedTiles=this.selectedTiles.concat(e.selectedTiles),this._requestedTiles=this._requestedTiles.concat(e._requestedTiles),this._emptyTiles=this._emptyTiles.concat(e._emptyTiles)}this.selectedTiles=this.options.onTraversalComplete(this.selectedTiles);for(const t of this.selectedTiles)this._tiles[t.id]=t;this._loadTiles(),this._unloadTiles(),this._updateStats()}_tilesChanged(t,e){if(t.length!==e.length)return!0;const n=new Set(t.map((t=>t.id))),r=new Set(e.map((t=>t.id)));let i=t.filter((t=>!r.has(t.id))).length>0;return i=i||e.filter((t=>!n.has(t.id))).length>0,i}_loadTiles(){for(const t of this._requestedTiles)t.contentUnloaded&&this._loadTile(t)}_unloadTiles(){this._cache.unloadTiles(this,((t,e)=>t._unloadTile(e)))}_updateStats(){let t=0,e=0;for(const n of this.selectedTiles)n.contentAvailable&&n.content&&(t++,n.content.pointCount&&(e+=n.content.pointCount));this.stats.get(vn).count=this.selectedTiles.length,this.stats.get(bn).count=t,this.stats.get(Tn).count=e}_initializeTileSet(t){this.root=this._initializeTileHeaders(t,null),this.type===$e&&this._initializeCesiumTileset(t),this.type===Xe&&this._initializeI3STileset(),this._calculateViewProps()}_calculateViewProps(){const t=this.root;(0,ke.h)(t);const{center:e}=t.boundingVolume;if(!e)return console.warn("center was not pre-calculated for the root tile"),this.cartographicCenter=new w.Z,void(this.zoom=1);this.cartographicCenter=Le.WGS84.cartesianToCartographic(e,new w.Z),this.cartesianCenter=e,this.zoom=function(t){const{halfAxes:e,radius:n,width:r,height:i}=t;if(e){const t=function(t){t.getColumn(0,qe);const e=t.getColumn(1),n=t.getColumn(2);return qe.add(e).add(n).len()}(e);return Math.log2(Ze/t)}return n?Math.log2(Ze/n):i&&r?(Math.log2(6378137/r)+Math.log2(6378137/i))/2:1}(t.boundingVolume)}_initializeStats(){this.stats.get(yn),this.stats.get(wn),this.stats.get(_n),this.stats.get(vn),this.stats.get(bn),this.stats.get(xn),this.stats.get(En),this.stats.get(Sn),this.stats.get(Tn,"memory"),this.stats.get(Pn,"memory")}_initializeTileHeaders(t,e){const n=new fn(this,t.root,e);if(e&&(e.children.push(n),n.depth=e.depth+1),this.type===$e){const t=[];for(t.push(n);t.length>0;){const e=t.pop();this.stats.get(yn).incrementCount();const n=e.header.children||[];for(const r of n){const n=new fn(this,r,e);e.children.push(n),n.depth=e.depth+1,t.push(n)}}}return n}_initializeTraverser(){let t;switch(this.type){case $e:t=dn;break;case Xe:t=mn;break;default:t=hn}return new t({basePath:this.basePath,onTraversalEnd:this._onTraversalEnd.bind(this)})}_destroyTileHeaders(t){this._destroySubtree(t)}async _loadTile(t){let e;try{this._onStartTileLoading(),e=await t.loadContent()}catch(e){this._onTileLoadError(t,e)}finally{this._onEndTileLoading(),this._onTileLoad(t,e)}}_onTileLoadError(t,e){this.stats.get(Sn).incrementCount();const n=e.message||e.toString(),r=t.url;console.error(`A 3D tile failed to load: ${t.url} ${n}`),this.options.onTileError(t,n,r)}_onTileLoad(t,e){e&&(t&&t.content&&function(t,e){(0,ke.h)(t),(0,ke.h)(e);const{rtcCenter:n,gltfUpAxis:r}=e,{computedTransform:i,boundingVolume:{center:o}}=t;let s=new Rt.Z(i);switch(n&&s.translate(n),r){default:break;case"Y":const t=(new Rt.Z).rotateX(Math.PI/2);s=s.multiplyRight(t);break;case"X":const e=(new Rt.Z).rotateY(-Math.PI/2);s=s.multiplyRight(e)}e.isQuantized&&s.translate(e.quantizedVolumeOffset).scale(e.quantizedVolumeScale);const a=new w.Z(o);e.cartesianModelMatrix=s,e.cartesianOrigin=a;const l=Le.WGS84.cartesianToCartographic(a,new w.Z),u=Le.WGS84.eastNorthUpToFixedFrame(a).invert();e.cartographicModelMatrix=u.multiplyRight(s),e.cartographicOrigin=l,e.modelMatrix=e.cartographicModelMatrix}(t,t.content),this._addTileToCache(t),this.options.onTileLoad(t))}_onStartTileLoading(){this._pendingCount++,this.stats.get(wn).incrementCount()}_onEndTileLoading(){this._pendingCount--,this.stats.get(wn).decrementCount()}_addTileToCache(t){this._cache.add(this,t,(e=>e._updateCacheStats(t)))}_updateCacheStats(t){this.stats.get(xn).incrementCount(),this.stats.get(_n).incrementCount(),this.gpuMemoryUsageInBytes+=t.content.byteLength||0,this.stats.get(Pn).count=this.gpuMemoryUsageInBytes}_unloadTile(t){this.gpuMemoryUsageInBytes-=t.content&&t.content.byteLength||0,this.stats.get(_n).decrementCount(),this.stats.get(En).incrementCount(),this.stats.get(Pn).count=this.gpuMemoryUsageInBytes,this.options.onTileUnload(t),t.unloadContent()}_destroy(){const t=[];for(this.root&&t.push(this.root);t.length>0;){const e=t.pop();for(const n of e.children)t.push(n);this._destroyTile(e)}this.root=null}_destroySubtree(t){const e=t,n=[];for(n.push(e);n.length>0;){t=n.pop();for(const e of t.children)n.push(e);t!==e&&this._destroyTile(t)}e.children=[]}_destroyTile(t){this._cache.unloadTile(this,t),this._unloadTile(t),t.destroy()}_initializeCesiumTileset(t){if(this.asset=t.asset,!this.asset)throw new Error("Tileset must have an asset property.");if("0.0"!==this.asset.version&&"1.0"!==this.asset.version)throw new Error("The tileset must be 3D Tiles version 0.0 or 1.0.");"tilesetVersion"in this.asset&&(this._queryParams.v=this.asset.tilesetVersion),this.credits={attributions:this.options.attributions||[]},this.description=this.options.description||"",this.properties=t.properties,this.geometricError=t.geometricError,this._extensionsUsed=t.extensionsUsed,this.extras=t.extras}_initializeI3STileset(){this.loadOptions.i3s&&"token"in this.loadOptions.i3s&&(this._queryParams.token=this.loadOptions.i3s.token)}}const Cn={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect"};function In(t,e,n){(0,ke.h)(t instanceof ArrayBuffer);const r=new TextDecoder("utf8"),i=new Uint8Array(t,e,n);return r.decode(i)}Object.keys(Cn);var On=n(7718);const Rn={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},Ln={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,...Rn},kn={[Rn.DOUBLE]:Float64Array,[Rn.FLOAT]:Float32Array,[Rn.UNSIGNED_SHORT]:Uint16Array,[Rn.UNSIGNED_INT]:Uint32Array,[Rn.UNSIGNED_BYTE]:Uint8Array,[Rn.BYTE]:Int8Array,[Rn.SHORT]:Int16Array,[Rn.INT]:Int32Array},Dn={DOUBLE:Rn.DOUBLE,FLOAT:Rn.FLOAT,UNSIGNED_SHORT:Rn.UNSIGNED_SHORT,UNSIGNED_INT:Rn.UNSIGNED_INT,UNSIGNED_BYTE:Rn.UNSIGNED_BYTE,BYTE:Rn.BYTE,SHORT:Rn.SHORT,INT:Rn.INT},Nn="Failed to convert GL type";class Fn{static fromTypedArray(t){t=ArrayBuffer.isView(t)?t.constructor:t;for(const e in kn)if(kn[e]===t)return e;throw new Error(Nn)}static fromName(t){const e=Dn[t];if(!e)throw new Error(Nn);return e}static getArrayType(t){switch(t){case Rn.UNSIGNED_SHORT_5_6_5:case Rn.UNSIGNED_SHORT_4_4_4_4:case Rn.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:const e=kn[t];if(!e)throw new Error(Nn);return e}}static getByteSize(t){return Fn.getArrayType(t).BYTES_PER_ELEMENT}static validate(t){return Boolean(Fn.getArrayType(t))}static createTypedArray(t,e,n=0,r){return void 0===r&&(r=(e.byteLength-n)/Fn.getByteSize(t)),new(Fn.getArrayType(t))(e,n,r)}}class Bn{constructor(t,e){this.json=t,this.buffer=e,this.featuresLength=0,this._cachedTypedArrays={}}getExtension(t){return this.json.extensions&&this.json.extensions[t]}hasProperty(t){return Boolean(this.json[t])}getGlobalProperty(t,e=Ln.UNSIGNED_INT,n=1){const r=this.json[t];return r&&Number.isFinite(r.byteOffset)?this._getTypedArrayFromBinary(t,e,n,1,r.byteOffset):r}getPropertyArray(t,e,n){const r=this.json[t];return r&&Number.isFinite(r.byteOffset)?("componentType"in r&&(e=Fn.fromName(r.componentType)),this._getTypedArrayFromBinary(t,e,n,this.featuresLength,r.byteOffset)):this._getTypedArrayFromArray(t,e,r)}getProperty(t,e,n,r,i){const o=this.json[t];if(!o)return o;const s=this.getPropertyArray(t,e,n);if(1===n)return s[r];for(let t=0;t<n;++t)i[t]=s[n*r+t];return i}_getTypedArrayFromBinary(t,e,n,r,i){const o=this._cachedTypedArrays;let s=o[t];return s||(s=Fn.createTypedArray(e,this.buffer.buffer,this.buffer.byteOffset+i,r*n),o[t]=s),s}_getTypedArrayFromArray(t,e,n){const r=this._cachedTypedArrays;let i=r[t];return i||(i=Fn.createTypedArray(e,n),r[t]=i),i}}const zn={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},jn={SCALAR:(t,e)=>t[e],VEC2:(t,e)=>[t[2*e+0],t[2*e+1]],VEC3:(t,e)=>[t[3*e+0],t[3*e+1],t[3*e+2]],VEC4:(t,e)=>[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]],MAT2:(t,e)=>[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]],MAT3:(t,e)=>[t[9*e+0],t[9*e+1],t[9*e+2],t[9*e+3],t[9*e+4],t[9*e+5],t[9*e+6],t[9*e+7],t[9*e+8]],MAT4:(t,e)=>[t[16*e+0],t[16*e+1],t[16*e+2],t[16*e+3],t[16*e+4],t[16*e+5],t[16*e+6],t[16*e+7],t[16*e+8],t[16*e+9],t[16*e+10],t[16*e+11],t[16*e+12],t[16*e+13],t[16*e+14],t[16*e+15]]},Un={SCALAR:(t,e,n)=>{e[n]=t},VEC2:(t,e,n)=>{e[2*n+0]=t[0],e[2*n+1]=t[1]},VEC3:(t,e,n)=>{e[3*n+0]=t[0],e[3*n+1]=t[1],e[3*n+2]=t[2]},VEC4:(t,e,n)=>{e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT2:(t,e,n)=>{e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT3:(t,e,n)=>{e[9*n+0]=t[0],e[9*n+1]=t[1],e[9*n+2]=t[2],e[9*n+3]=t[3],e[9*n+4]=t[4],e[9*n+5]=t[5],e[9*n+6]=t[6],e[9*n+7]=t[7],e[9*n+8]=t[8],e[9*n+9]=t[9]},MAT4:(t,e,n)=>{e[16*n+0]=t[0],e[16*n+1]=t[1],e[16*n+2]=t[2],e[16*n+3]=t[3],e[16*n+4]=t[4],e[16*n+5]=t[5],e[16*n+6]=t[6],e[16*n+7]=t[7],e[16*n+8]=t[8],e[16*n+9]=t[9],e[16*n+10]=t[10],e[16*n+11]=t[11],e[16*n+12]=t[12],e[16*n+13]=t[13],e[16*n+14]=t[14],e[16*n+15]=t[15]}},Vn=t=>void 0!==t;function Gn(t,e,n){if(!t)return;const r=t.parentCounts;return t.parentIds?n(t,e):r>0?function(t,e,n){const r=t.classIds,i=t.parentCounts,o=t.parentIds,s=t.parentIndexes,a=r.length,l=scratchVisited;l.length=Math.max(l.length,a);const u=++marker,c=scratchStack;for(c.length=0,c.push(e);c.length>0;){if(l[e=c.pop()]===u)continue;l[e]=u;const r=n(t,e);if(Vn(r))return r;const a=i[e],h=s[e];for(let t=0;t<a;++t){const n=o[h+t];n!==e&&c.push(n)}}return null}(t,e,n):function(t,e,n){let r=!0;for(;r;){const i=n(t,e);if(Vn(i))return i;const o=t.parentIds[e];r=o!==e,e=o}throw new Error("traverseHierarchySingleParent")}(t,e,n)}function Zn(t,e,n){const r=t.parentCounts,i=t.parentIds,o=t.parentIndexes,s=t.classIds.length;if(!Vn(i))return;assert(e<s,`Parent index ${e} exceeds the total number of instances: ${s}`),assert(-1===n.indexOf(e),"Circular dependency detected in the batch table hierarchy."),n.push(e);const a=Vn(r)?r[e]:1,l=Vn(r)?o[e]:e;for(let r=0;r<a;++r){const o=i[l+r];o!==e&&Zn(t,o,n)}n.pop(e)}function qn(t){return null!=t}const Wn=(t,e)=>t,Hn={HIERARCHY:!0,extensions:!0,extras:!0};class Xn{constructor(t,e,n,r={}){var i;(0,ke.h)(n>=0),this.json=t||{},this.binary=e,this.featureCount=n,this._extensions=(null===(i=this.json)||void 0===i?void 0:i.extensions)||{},this._properties={};for(const t in this.json)Hn[t]||(this._properties[t]=this.json[t]);this._binaryProperties=this._initializeBinaryProperties(),r["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=function(t,e,n){if(!e)return null;let r=t.getExtension("3DTILES_batch_table_hierarchy");const i=e.HIERARCHY;return i&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),e.extensions=e.extensions||{},e.extensions["3DTILES_batch_table_hierarchy"]=i,r=i),r?function(t,e){let n,r,i;const o=t.instancesLength,s=t.classes;let a,l=t.classIds,u=t.parentCounts,c=t.parentIds,h=o;if(Vn(l.byteOffset)&&(l.componentType=defaultValue(l.componentType,GL.UNSIGNED_SHORT),l.type=AttributeType.SCALAR,i=getBinaryAccessor(l),l=i.createArrayBufferView(e.buffer,e.byteOffset+l.byteOffset,o)),Vn(u))for(Vn(u.byteOffset)&&(u.componentType=defaultValue(u.componentType,GL.UNSIGNED_SHORT),u.type=AttributeType.SCALAR,i=getBinaryAccessor(u),u=i.createArrayBufferView(e.buffer,e.byteOffset+u.byteOffset,o)),a=new Uint16Array(o),h=0,n=0;n<o;++n)a[n]=h,h+=u[n];Vn(c)&&Vn(c.byteOffset)&&(c.componentType=defaultValue(c.componentType,GL.UNSIGNED_SHORT),c.type=AttributeType.SCALAR,i=getBinaryAccessor(c),c=i.createArrayBufferView(e.buffer,e.byteOffset+c.byteOffset,h));const p=s.length;for(n=0;n<p;++n){const t=s[n].length,r=s[n].instances,i=getBinaryProperties(t,r,e);s[n].instances=combine(i,r)}const f=new Array(p).fill(0),d=new Uint16Array(o);for(n=0;n<o;++n)r=l[n],d[n]=f[r],++f[r];const g={classes:s,classIds:l,classIndexes:d,parentCounts:u,parentIndexes:a,parentIds:c};return function(t){const e=t.classIds.length;for(let n=0;n<e;++n)Zn(t,n,stack)}(g),g}(r,n):null}(this,this.json,this.binary))}getExtension(t){return this.json&&this.json.extensions&&this.json.extensions[t]}memorySizeInBytes(){return 0}isClass(t,e){return this._checkBatchId(t),(0,ke.h)("string"==typeof e,e),!!this._hierarchy&&qn(Gn(this._hierarchy,t,((t,n)=>{const r=t.classIds[n];return t.classes[r].name===e})))}isExactClass(t,e){return(0,ke.h)("string"==typeof e,e),this.getExactClassName(t)===e}getExactClassName(t){if(this._checkBatchId(t),this._hierarchy){const e=this._hierarchy.classIds[t];return this._hierarchy.classes[e].name}}hasProperty(t,e){return this._checkBatchId(t),(0,ke.h)("string"==typeof e,e),qn(this._properties[e])||this._hasPropertyInHierarchy(t,e)}getPropertyNames(t,e){this._checkBatchId(t),(e=qn(e)?e:[]).length=0;const n=Object.keys(this._properties);return e.push(...n),this._hierarchy&&this._getPropertyNamesInHierarchy(t,e),e}getProperty(t,e){if(this._checkBatchId(t),(0,ke.h)("string"==typeof e,e),this._binaryProperties){const n=this._binaryProperties[e];if(qn(n))return this._getBinaryProperty(n,t)}const n=this._properties[e];if(qn(n))return Wn(n[t]);if(this._hierarchy){const n=this._getHierarchyProperty(t,e);if(qn(n))return n}}setProperty(t,e,n){const r=this.featureCount;if(this._checkBatchId(t),(0,ke.h)("string"==typeof e,e),this._binaryProperties){const r=this._binaryProperties[e];if(r)return void this._setBinaryProperty(r,t,n)}if(this._hierarchy&&this._setHierarchyProperty(this,t,e,n))return;let i=this._properties[e];qn(i)||(this._properties[e]=new Array(r),i=this._properties[e]),i[t]=Wn(n)}_checkBatchId(t){if(!(t>=0&&t<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")}_getBinaryProperty(t,e){return t.unpack(t.typedArray,e)}_setBinaryProperty(t,e,n){t.pack(n,t.typedArray,e)}_initializeBinaryProperties(){let t=null;for(const e in this._properties){const n=this._properties[e],r=this._initializeBinaryProperty(e,n);r&&(t=t||{},t[e]=r)}return t}_initializeBinaryProperty(t,e){if("byteOffset"in e){const n=e;(0,ke.h)(this.binary,`Property ${t} requires a batch table binary.`),(0,ke.h)(n.type,`Property ${t} requires a type.`);const r=function(t,e,n,r){const{componentType:i}=t;(0,ke.h)(t.componentType);const o="string"==typeof i?Fn.fromName(i):i,s=zn[t.type],a=jn[t.type],l=Un[t.type];return n+=t.byteOffset,{values:Fn.createTypedArray(o,e,n,s*r),type:o,size:s,unpacker:a,packer:l}}(n,this.binary.buffer,0|this.binary.byteOffset,this.featureCount);return{typedArray:r.values,componentCount:r.size,unpack:r.unpacker,pack:r.packer}}return null}_hasPropertyInHierarchy(t,e){if(!this._hierarchy)return!1;const n=Gn(this._hierarchy,t,((t,n)=>{const r=t.classIds[n];return qn(t.classes[r].instances[e])}));return qn(n)}_getPropertyNamesInHierarchy(t,e){Gn(this._hierarchy,t,((t,n)=>{const r=t.classIds[n],i=t.classes[r].instances;for(const t in i)i.hasOwnProperty(t)&&-1===e.indexOf(t)&&e.push(t)}))}_getHierarchyProperty(t,e){return Gn(this._hierarchy,t,((t,n)=>{const r=t.classIds[n],i=t.classes[r],o=t.classIndexes[n],s=i.instances[e];return qn(s)?qn(s.typedArray)?this._getBinaryProperty(s,o):Wn(s[o]):null}))}_setHierarchyProperty(t,e,n,r){const i=Gn(this._hierarchy,e,((t,i)=>{const o=t.classIds[i],s=t.classes[o],a=t.classIndexes[i],l=s.instances[n];return!!qn(l)&&((0,ke.h)(i===e,`Inherited property "${n}" is read-only.`),qn(l.typedArray)?this._setBinaryProperty(l,a,r):l[a]=Wn(r),!0)}));return qn(i)}}function $n(t,e,n=0){const r=new DataView(e);if(t.magic=r.getUint32(n,!0),n+=4,t.version=r.getUint32(n,!0),n+=4,t.byteLength=r.getUint32(n,!0),n+=4,1!==t.version)throw new Error(`3D Tile Version ${t.version} not supported`);return n}const Yn="b3dm tile in legacy format.";function Qn(t,e,n){const r=new DataView(e);let i;t.header=t.header||{};let o=r.getUint32(n,!0);n+=4;let s=r.getUint32(n,!0);n+=4;let a=r.getUint32(n,!0);n+=4;let l=r.getUint32(n,!0);return n+=4,a>=570425344?(n-=8,i=o,a=s,l=0,o=0,s=0,console.warn(Yn)):l>=570425344&&(n-=4,i=a,a=o,l=s,o=0,s=0,console.warn(Yn)),t.header.featureTableJsonByteLength=o,t.header.featureTableBinaryByteLength=s,t.header.batchTableJsonByteLength=a,t.header.batchTableBinaryByteLength=l,t.header.batchLength=i,n}function Kn(t,e,n,r){return n=function(t,e,n,r){const{featureTableJsonByteLength:i,featureTableBinaryByteLength:o,batchLength:s}=t.header;if(t.featureTableJson={BATCH_LENGTH:s||0},i>0){const r=In(e,n,i);t.featureTableJson=JSON.parse(r)}return n+=i,t.featureTableBinary=new Uint8Array(e,n,o),n+o}(t,e,n),n=function(t,e,n,r){const{batchTableJsonByteLength:i,batchTableBinaryByteLength:o}=t.header;if(i>0){const r=In(e,n,i);t.batchTableJson=JSON.parse(r),n+=i,o>0&&(t.batchTableBinary=new Uint8Array(e,n,o),t.batchTableBinary=new Uint8Array(t.batchTableBinary),n+=o)}return n}(t,e,n),n}function Jn(t,e=[0,0,0]){const n=t>>11&31,r=t>>5&63,i=31&t;return e[0]=n<<3,e[1]=r<<2,e[2]=i<<3,e}function tr(t,e,n){if(!(e||t&&t.batchIds&&n))return null;const{batchIds:r,isRGB565:i,pointCount:o}=t;if(r&&n){const t=new Uint8ClampedArray(3*o);for(let e=0;e<o;e++){const i=r[e],o=n.getProperty(i,"dimensions").map((t=>255*t));t[3*e]=o[0],t[3*e+1]=o[1],t[3*e+2]=o[2]}return{type:Ln.UNSIGNED_BYTE,value:t,size:3,normalized:!0}}if(i){const t=new Uint8ClampedArray(3*o);for(let n=0;n<o;n++){const r=Jn(e[n]);t[3*n]=r[0],t[3*n+1]=r[1],t[3*n+2]=r[2]}return{type:Ln.UNSIGNED_BYTE,value:t,size:3,normalized:!0}}return e&&e.length===3*o?{type:Ln.UNSIGNED_BYTE,value:e,size:3,normalized:!0}:{type:Ln.UNSIGNED_BYTE,value:e,size:4,normalized:!0}}var er=n(7069);function nr(t,e=255){return(0,U.uZ)(t,0,e)/e*2-1}function rr(t){return t<0?-1:1}function ir(t,e,n){return function(t,e,n,r){if(function(t,e){if(!t)throw new Error("math.gl assertion failed. undefined")}(r),t<0||t>n||e<0||e>n)throw new Error(`x and y must be unsigned normalized integers between 0 and ${n}`);if(r.x=nr(t,n),r.y=nr(e,n),r.z=1-(Math.abs(r.x)+Math.abs(r.y)),r.z<0){const t=r.x;r.x=(1-Math.abs(r.y))*rr(t),r.y=(1-Math.abs(t))*rr(r.y)}return r.normalize()}(t,e,255,n)}new er.Z,new w.Z,new er.Z,new er.Z,new Uint8Array(1);const or=new w.Z;async function sr(t,e,n,r,i){n=Kn(t,e,n=Qn(t,e,n=$n(t,e,n))),function(t){t.attributes={positions:null,colors:null,normals:null,batchIds:null},t.isQuantized=!1,t.isTranslucent=!1,t.isRGB565=!1,t.isOctEncoded16P=!1}(t);const{featureTable:o,batchTable:s}=function(t){const e=new Bn(t.featureTableJson,t.featureTableBinary),n=e.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(n))throw new Error("POINTS_LENGTH must be defined");e.featuresLength=n,t.featuresLength=n,t.pointsLength=n,t.pointCount=n,t.rtcCenter=e.getGlobalProperty("RTC_CENTER",Ln.FLOAT,3);const r=function(t,e){let n=null;if(!t.batchIds&&e.hasProperty("BATCH_ID")&&(t.batchIds=e.getPropertyArray("BATCH_ID",Ln.UNSIGNED_SHORT,1),t.batchIds)){const r=e.getGlobalProperty("BATCH_LENGTH");if(!r)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");const{batchTableJson:i,batchTableBinary:o}=t;n=new Xn(i,o,r)}return n}(t,e);return{featureTable:e,batchTable:r}}(t);return await async function(t,e,n,r,i){let o,s,a;const l=t.batchTableJson&&t.batchTableJson.extensions&&t.batchTableJson.extensions["3DTILES_draco_point_compression"];l&&(a=l.properties);const u=e.getExtension("3DTILES_draco_point_compression");if(u){s=u.properties;const e=u.byteOffset,n=u.byteLength;if(!s||!Number.isFinite(e)||!n)throw new Error("Draco properties, byteOffset, and byteLength must be defined");o=t.featureTableBinary.slice(e,e+n),t.hasPositions=Number.isFinite(s.POSITION),t.hasColors=Number.isFinite(s.RGB)||Number.isFinite(s.RGBA),t.hasNormals=Number.isFinite(s.NORMAL),t.hasBatchIds=Number.isFinite(s.BATCH_ID),t.isTranslucent=Number.isFinite(s.RGBA)}if(!o)return!0;const c={buffer:o,properties:{...s,...a},featureTableProperties:s,batchTableProperties:a,dequantizeInShader:!1};return await async function(t,e,n,r){const{parse:i}=r,o={...n,draco:{...n.draco,extraAttributes:e.batchTableProperties||{}}};delete o["3d-tiles"];const s=await i(e.buffer,On.VJ,o),a=s.attributes.POSITION&&s.attributes.POSITION.value,l=s.attributes.COLOR_0&&s.attributes.COLOR_0.value,u=s.attributes.NORMAL&&s.attributes.NORMAL.value,c=s.attributes.BATCH_ID&&s.attributes.BATCH_ID.value,h=a&&s.attributes.POSITION.value.quantization,p=u&&s.attributes.NORMAL.value.quantization;if(h){const e=s.POSITION.data.quantization,n=e.range;t.quantizedVolumeScale=new w.Z(n,n,n),t.quantizedVolumeOffset=new w.Z(e.minValues),t.quantizedRange=(1<<e.quantizationBits)-1,t.isQuantizedDraco=!0}p&&(t.octEncodedRange=(1<<s.NORMAL.data.quantization.quantizationBits)-1,t.isOctEncodedDraco=!0);const f={};if(e.batchTableProperties)for(const t of Object.keys(e.batchTableProperties))s.attributes[t]&&s.attributes[t].value&&(f[t.toLowerCase()]=s.attributes[t].value);t.attributes={positions:a,colors:tr(t,l),normals:u,batchIds:c,...f}}(t,c,r,i)}(t,o,0,r,i),function(t,e,n){if(!t.attributes.positions)if(e.hasProperty("POSITION"))t.attributes.positions=e.getPropertyArray("POSITION",Ln.FLOAT,3);else if(e.hasProperty("POSITION_QUANTIZED")){const r=e.getPropertyArray("POSITION_QUANTIZED",Ln.UNSIGNED_SHORT,3);if(t.isQuantized=!0,t.quantizedRange=65535,t.quantizedVolumeScale=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",Ln.FLOAT,3),!t.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(t.quantizedVolumeOffset=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",Ln.FLOAT,3),!t.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");t.attributes.positions=function(t,e,n){return t.isQuantized?n["3d-tiles"]&&n["3d-tiles"].decodeQuantizedPositions?(t.isQuantized=!1,function(t,e){const n=new w.Z,r=new Float32Array(3*t.pointCount);for(let i=0;i<t.pointCount;i++)n.set(e[3*i],e[3*i+1],e[3*i+2]).scale(1/t.quantizedRange).multiply(t.quantizedVolumeScale).add(t.quantizedVolumeOffset).toArray(r,3*i);return r}(t,e)):{type:Ln.UNSIGNED_SHORT,value:e,size:3,normalized:!0}:e}(t,r,n)}if(!t.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}(t,o,r),function(t,e,n){if(!t.attributes.colors){let r=null;e.hasProperty("RGBA")?(r=e.getPropertyArray("RGBA",Ln.UNSIGNED_BYTE,4),t.isTranslucent=!0):e.hasProperty("RGB")?r=e.getPropertyArray("RGB",Ln.UNSIGNED_BYTE,3):e.hasProperty("RGB565")&&(r=e.getPropertyArray("RGB565",Ln.UNSIGNED_SHORT,1),t.isRGB565=!0),t.attributes.colors=tr(t,r,n)}e.hasProperty("CONSTANT_RGBA")&&(t.constantRGBA=e.getGlobalProperty("CONSTANT_RGBA",Ln.UNSIGNED_BYTE,4))}(t,o,s),function(t,e){if(!t.attributes.normals){let n=null;e.hasProperty("NORMAL")?n=e.getPropertyArray("NORMAL",Ln.FLOAT,3):e.hasProperty("NORMAL_OCT16P")&&(n=e.getPropertyArray("NORMAL_OCT16P",Ln.UNSIGNED_BYTE,2),t.isOctEncoded16P=!0),t.attributes.normals=function(t,e){if(!e)return null;if(t.isOctEncoded16P){const n=new Float32Array(3*t.pointsLength);for(let r=0;r<t.pointsLength;r++)ir(e[2*r],e[2*r+1],or),or.toArray(n,3*r);return{type:Ln.FLOAT,size:2,value:n}}return{type:Ln.FLOAT,size:2,value:e}}(t,n)}}(t,o),n}var ar=n(8130),lr=n(5680);function ur(t,e,n,r){t.rotateYtoZ=!0;const i=t.byteOffset+t.byteLength-n;if(0===i)throw new Error("glTF byte length must be greater than 0.");return t.gltfUpAxis=r["3d-tiles"]&&r["3d-tiles"].assetGltfUpAxis?r["3d-tiles"].assetGltfUpAxis:"Y",t.gltfArrayBuffer=(0,lr.qv)(e,n,i),t.gltfByteOffset=0,t.gltfByteLength=i,n%4==0||console.warn(`${t.type}: embedded glb is not aligned to a 4-byte boundary.`),t.byteOffset+t.byteLength}async function cr(t,e,n,r){const i=n["3d-tiles"]||{};if(function(t,e,n){switch(e){case 0:const e=new Uint8Array(t.gltfArrayBuffer,t.gltfByteOffset),n=(new TextDecoder).decode(e);t.gltfUrl=n.replace(/[\s\0]+$/,""),delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength;break;case 1:break;default:throw new Error("b3dm: Illegal glTF format field")}}(t,e),i.loadGLTF){const{parse:e,fetch:i}=r;t.gltfUrl&&(t.gltfArrayBuffer=await i(t.gltfUrl,n),t.gltfByteOffset=0),t.gltfArrayBuffer&&(t.gltf=await e(t.gltfArrayBuffer,ar.E,n,r),delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength)}}async function hr(t,e=0,n,r,i={}){switch(i.byteOffset=e,i.type=function(t,e=0){const n=new DataView(t);return`${String.fromCharCode(n.getUint8(e+0))}${String.fromCharCode(n.getUint8(e+1))}${String.fromCharCode(n.getUint8(e+2))}${String.fromCharCode(n.getUint8(e+3))}`}(t,e),i.type){case Cn.COMPOSITE:return await async function(t,e,n,r,i,o){n=$n(t,e,n);const s=new DataView(e);for(t.tilesLength=s.getUint32(n,!0),n+=4,t.tiles=[];t.tiles.length<t.tilesLength&&t.byteLength-n>12;){const s={};t.tiles.push(s),n=await o(e,n,r,i,s)}return n}(i,t,e,n,r,hr);case Cn.BATCHED_3D_MODEL:return await async function(t,e,n,r,i){var o;n=function(t,e,n,r,i){n=ur(t,e,n=Kn(t,e,n=Qn(t,e,n=$n(t,e,n))),r);const o=new Bn(t.featureTableJson,t.featureTableBinary);return t.rtcCenter=o.getGlobalProperty("RTC_CENTER",Ln.FLOAT,3),n}(t,e,n,r),await cr(t,1,r,i);const s=null==t||null===(o=t.gltf)||void 0===o?void 0:o.extensions;return s&&s.CESIUM_RTC&&(t.rtcCenter=s.CESIUM_RTC.center),n}(i,t,e,n,r);case Cn.INSTANCED_3D_MODEL:return await async function(t,e,n,r,i){return n=function(t,e,n,r,i){if(n=$n(t,e,n),1!==t.version)throw new Error(`Instanced 3D Model version ${t.version} is not supported`);n=Qn(t,e,n);const o=new DataView(e);if(t.gltfFormat=o.getUint32(n,!0),n=ur(t,e,n=Kn(t,e,n+=4),r),0===t.featureTableJsonByteLength)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");const s=new Bn(t.featureTableJson,t.featureTableBinary),a=s.getGlobalProperty("INSTANCES_LENGTH");if(s.featuresLength=a,!Number.isFinite(a))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");return t.eastNorthUp=s.getGlobalProperty("EAST_NORTH_UP"),t.rtcCenter=s.getGlobalProperty("RTC_CENTER",Ln.FLOAT,3),new Xn(t.batchTableJson,t.batchTableBinary,a),function(t,e,n,r){const i=[new Array(r),t._batchTable][0],o=new w.Z,s=new w.Z,a=new w.Z,l=new w.Z,u=new I.Z,c=new O.Z,h=new w.Z,p={},f=new Rt.Z,d=[],g=[],m=new w.Z,A=new w.Z;for(let n=0;n<r;n++){let r;if(e.hasProperty("POSITION"))r=e.getProperty("POSITION",Ln.FLOAT,3,n,o);else if(e.hasProperty("POSITION_QUANTIZED")){r=e.getProperty("POSITION_QUANTIZED",Ln.UNSIGNED_SHORT,3,n,o);const t=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",Ln.FLOAT,3,m);if(!t)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");const i=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",Ln.FLOAT,3,A);if(!i)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");const s=65535;for(let e=0;e<3;e++)r[e]=r[e]/s*i[e]+t[e]}if(!r)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");o.copy(r),p.translation=o,t.normalUp=e.getProperty("NORMAL_UP",Ln.FLOAT,3,n,d),t.normalRight=e.getProperty("NORMAL_RIGHT",Ln.FLOAT,3,n,g);const y=!1;if(t.normalUp){if(!t.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");t.hasCustomOrientation=!0}else{if(t.octNormalUp=e.getProperty("NORMAL_UP_OCT32P",Ln.UNSIGNED_SHORT,2,d),t.octNormalRight=e.getProperty("NORMAL_RIGHT_OCT32P",Ln.UNSIGNED_SHORT,2,g),t.octNormalUp){if(!t.octNormalRight)throw new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");throw new Error("i3dm: oct-encoded orientation not implemented")}t.eastNorthUp?(Le.WGS84.eastNorthUpToFixedFrame(o,f),f.getRotationMatrix3(u)):u.identity()}y&&(l.copy(s).cross(a).normalize(),u.setColumn(0,s),u.setColumn(1,a),u.setColumn(2,l)),c.fromMatrix3(u),p.rotation=c,h.set(1,1,1);const _=e.getProperty("SCALE",Ln.FLOAT,1,n);Number.isFinite(_)&&h.multiplyByScalar(_);const v=e.getProperty("SCALE_NON_UNIFORM",Ln.FLOAT,3,n,d);v&&h.scale(v),p.scale=h;let b=e.getProperty("BATCH_ID",Ln.UNSIGNED_SHORT,1,n);void 0===b&&(b=n);const x=(new Rt.Z).fromQuaternion(p.rotation);f.identity(),f.translate(p.translation),f.multiplyRight(x),f.scale(p.scale);const w=f.clone();i[n]={modelMatrix:w,batchId:b}}t.instances=i}(t,s,0,a),n}(t,e,n,r),await cr(t,t.gltfFormat,r,i),n}(i,t,e,n,r);case Cn.POINT_CLOUD:return await sr(i,t,e,n,r);default:throw new Error(`3DTileLoader: unknown type ${i.type}`)}}function pr(t,e){if(t.content){const n=t.content.uri||t.content.url;t.contentUrl=`${e.basePath}/${n}`}return t.id=t.contentUrl,t.lodMetricType=Ye,t.lodMetricValue=t.geometricError,t.transformMatrix=t.transform,t.type=function(t){if(!t.contentUrl)return"empty";const e=t.contentUrl.split(".").pop();switch(e){case"pnts":return He;case"i3dm":case"b3dm":return We;default:return e}}(t),t.refine=function(t){switch(t){case"REPLACE":case"replace":return 2;case"ADD":case"add":return 1;default:return t}}(t.refine),t}const fr={id:"3d-tiles",name:"3D Tiles",module:"3d-tiles",version:"3.0.12",extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:async function(t,e,n){const r=e["3d-tiles"]||{};let i;return i="auto"===r.isTileset?n.url&&-1!==n.url.indexOf(".json"):r.isTileset,t=i?await async function(t,e,n){const r=JSON.parse((new TextDecoder).decode(t));return r.loader=e.loader||fr,r.url=n.url,r.basePath=De(r.url),r.root=function(t){const e=t.basePath,n=pr(t.root,t),r=[];for(r.push(n);r.length>0;){const t=r.pop().children||[];for(const n of t)pr(n,{basePath:e}),r.push(n)}return n}(r),r.type=$e,r.lodMetricType=Ye,r.lodMetricValue=r.root.lodMetricValue,r}(t,e,n):await async function(t,e,n){const r={content:{featureIds:null}};return await hr(t,0,e,n,r.content),r.content}(t,e,n),t},options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",assetGltfUpAxis:null}}},dr=[0],gr={getPointColor:{type:"accessor",value:[0,0,0,255]},pointSize:1,data:null,loader:fr,onTilesetLoad:{type:"function",value:t=>{},compare:!1},onTileLoad:{type:"function",value:t=>{},compare:!1},onTileUnload:{type:"function",value:t=>{},compare:!1},onTileError:{type:"function",value:(t,e,n)=>{},compare:!1},_getMeshColor:{type:"function",value:t=>[255,255,255],compare:!1}};class mr extends o.Z{initializeState(){"onTileLoadFail"in this.props&&v.Z.removed("onTileLoadFail","onTileError")(),this.state={layerMap:{},tileset3d:null,activeViewports:{},lastUpdatedViewports:null}}get isLoaded(){const{tileset3d:t}=this.state;return t&&t.isLoaded()}shouldUpdateState({changeFlags:t}){return t.somethingChanged}updateState({props:t,oldProps:e,changeFlags:n}){if(t.data&&t.data!==e.data&&this._loadTileset(t.data),n.viewportChanged){const{activeViewports:t}=this.state;Object.keys(t).length&&(this._updateTileset(t),this.state.lastUpdatedViewports=t,this.state.activeViewports={})}if(n.propsChanged){const{layerMap:t}=this.state;for(const e in t)t[e].needsUpdate=!0}}activateViewport(t){const{activeViewports:e,lastUpdatedViewports:n}=this.state;this.internalState.viewport=t,e[t.id]=t;const r=null==n?void 0:n[t.id];r&&t.equals(r)||(this.setChangeFlags({viewportChanged:!0}),this.setNeedsUpdate())}getPickingInfo({info:t,sourceLayer:e}){const{layerMap:n}=this.state,r=e&&e.id;if(r){const e=r.substring(this.id.length+1),i=e.substring(e.indexOf("-")+1);t.object=n[i]&&n[i].tile}return t}filterSubLayer({layer:t,viewport:e}){const{tile:n}=t.props,{id:r}=e;return n.selected&&n.viewportIds.includes(r)}_updateAutoHighlight(t){t.sourceLayer&&t.sourceLayer.updateAutoHighlight(t)}async _loadTileset(t){const{loadOptions:e={}}=this.props;let n=this.props.loader||this.props.loaders;Array.isArray(n)&&(n=n[0]);const r={loadOptions:{...e}};if(n.preload){const i=await n.preload(t,e);i.headers&&(r.loadOptions.fetch={...r.loadOptions.fetch,headers:i.headers}),Object.assign(r,i)}const i=await(0,le.z)(t,n,r.loadOptions),o=new Mn(i,{onTileLoad:this._onTileLoad.bind(this),onTileUnload:this._onTileUnload.bind(this),onTileLoadFail:this.props.onTileError,...r});this.setState({tileset3d:o,layerMap:{}}),this._updateTileset(this.state.activeViewports),this.props.onTilesetLoad(o)}_onTileLoad(t){const{lastUpdatedViewports:e}=this.state;this.props.onTileLoad(t),this._updateTileset(e),this.setNeedsUpdate()}_onTileUnload(t){delete this.state.layerMap[t.id],this.props.onTileUnload(t)}_updateTileset(t){const{tileset3d:e}=this.state,{timeline:n}=this.context,r=Object.keys(t).length;if(!n||!r||!e)return;const i=e.update(Object.values(t));this.state.frameNumber!==i&&this.setState({frameNumber:i})}_getSubLayer(t,e){if(!t.content)return null;switch(t.type){case He:return this._makePointCloudLayer(t,e);case We:return this._make3DModelLayer(t,e);case"mesh":return this._makeSimpleMeshLayer(t,e);default:throw new Error("Tile3DLayer: Failed to render layer of type ".concat(t.content.type))}}_makePointCloudLayer(t,e){const{attributes:n,pointCount:r,constantRGBA:i,cartographicOrigin:o,modelMatrix:s}=t.content,{positions:a,normals:l,colors:u}=n;if(!a)return null;const c=e&&e.props.data||{header:{vertexCount:r},attributes:{POSITION:a,NORMAL:l,COLOR_0:u}},{pointSize:h,getPointColor:p}=this.props;return new(this.getSubLayerClass("pointcloud",te.Z))({pointSize:h},this.getSubLayerProps({id:"pointcloud"}),{id:"".concat(this.id,"-pointcloud-").concat(t.id),tile:t,data:c,coordinateSystem:Jt.Df.METER_OFFSETS,coordinateOrigin:o,modelMatrix:s,getColor:i||p,_offset:0})}_make3DModelLayer(t){const{gltf:e,instances:n,cartographicOrigin:r,modelMatrix:i}=t.content;return new(this.getSubLayerClass("scenegraph",ee.Z))({_lighting:"pbr"},this.getSubLayerProps({id:"scenegraph"}),{id:"".concat(this.id,"-scenegraph-").concat(t.id),tile:t,data:n||dr,scenegraph:e,coordinateSystem:Jt.Df.METER_OFFSETS,coordinateOrigin:r,modelMatrix:i,getTransformMatrix:t=>t.modelMatrix,getPosition:[0,0,0],_offset:0})}_makeSimpleMeshLayer(t,e){const n=t.content,{attributes:r,indices:i,modelMatrix:o,cartographicOrigin:s,material:a,featureIds:l}=n,{_getMeshColor:u}=this.props,c=e&&e.props.mesh||new Kt.Z({drawMode:4,attributes:Ar(r),indices:i});return new(this.getSubLayerClass("mesh",se))(this.getSubLayerProps({id:"mesh"}),{id:"".concat(this.id,"-mesh-").concat(t.id),tile:t,mesh:c,data:dr,getColor:u(t),pbrMaterial:a,modelMatrix:o,coordinateOrigin:s,coordinateSystem:Jt.Df.METER_OFFSETS,featureIds:l,_offset:0})}renderLayers(){const{tileset3d:t,layerMap:e}=this.state;return t?t.tiles.map((t=>{const n=e[t.id]=e[t.id]||{tile:t};let{layer:r}=n;return t.selected&&(r?n.needsUpdate&&(r=this._getSubLayer(t,r),n.needsUpdate=!1):r=this._getSubLayer(t)),n.layer=r,r})).filter(Boolean):null}}function Ar(t){const e={};return e.positions={...t.positions,value:new Float32Array(t.positions.value)},t.normals&&(e.normals=t.normals),t.texCoords&&(e.texCoords=t.texCoords),t.colors&&(e.colors=t.colors),t.uvRegions&&(e.uvRegions=t.uvRegions),e}mr.layerName="Tile3DLayer",mr.defaultProps=gr;var yr=n(6935);const _r=[1],vr={...zt.defaultProps,elevationData:vt,texture:{...vt,optional:!0},meshMaxError:{type:"number",value:4},bounds:{type:"array",value:null,optional:!0,compare:!0},color:{type:"color",value:[255,255,255]},elevationDecoder:{type:"object",value:{rScaler:1,gScaler:0,bScaler:0,offset:0}},workerUrl:{type:"string",value:null},wireframe:!1,material:!0,loaders:[{name:"Terrain",id:"terrain",module:"terrain",version:"3.0.12",worker:!0,extensions:["png","pngraw"],mimeTypes:["image/png"],options:{terrain:{tesselator:"auto",bounds:null,meshMaxError:10,elevationDecoder:{rScaler:1,gScaler:0,bScaler:0,offset:0},skirtHeight:null}}}]};function br(t){return Array.isArray(t)?t.join(";"):t}class xr extends o.Z{updateState({props:t,oldProps:e}){const n=t.elevationData!==e.elevationData;if(n){const{elevationData:e}=t,n=e&&(Array.isArray(e)||e.includes("{x}")&&e.includes("{y}"));this.setState({isTiled:n})}const r=n||t.meshMaxError!==e.meshMaxError||t.elevationDecoder!==e.elevationDecoder||t.bounds!==e.bounds;if(!this.state.isTiled&&r){const e=this.loadTerrain(t);this.setState({terrain:e})}t.workerUrl&&v.Z.removed("workerUrl","loadOptions.terrain.workerUrl")()}loadTerrain({elevationData:t,bounds:e,elevationDecoder:n,meshMaxError:r,signal:i}){var o;if(!t)return null;let s=this.getLoadOptions();s={...s,terrain:{skirtHeight:this.state.isTiled?2*r:0,...null===(o=s)||void 0===o?void 0:o.terrain,bounds:e,meshMaxError:r,elevationDecoder:n}};const{fetch:a}=this.props;return a(t,{propName:"elevationData",layer:this,loadOptions:s,signal:i})}getTiledTerrainData(t){const{elevationData:e,fetch:n,texture:r,elevationDecoder:i,meshMaxError:o}=this.props,s=xt(e,t),a=xt(r,t),{bbox:l,signal:u,z:c}=t,h=new yr.Z({longitude:(l.west+l.east)/2,latitude:(l.north+l.south)/2,zoom:c}),p=h.projectFlat([l.west,l.south]),f=h.projectFlat([l.east,l.north]),d=[p[0],p[1],f[0],f[1]],g=this.loadTerrain({elevationData:s,bounds:d,elevationDecoder:i,meshMaxError:o,signal:u}),m=a?n(a,{propName:"texture",layer:this,loaders:[],signal:u}).catch((t=>null)):Promise.resolve(null);return Promise.all([g,m])}renderSubLayers(t){const e=this.getSubLayerClass("mesh",oe.Z),{data:n,color:r}=t;if(!n)return null;const[i,o]=n;return new e(t,{data:_r,mesh:i,texture:o,coordinateSystem:Jt.Df.CARTESIAN,getPosition:t=>[0,0,0],getColor:r})}onViewportLoad(t){if(!t)return;const{zRange:e}=this.state,n=t.map((t=>t.content)).filter(Boolean).map((t=>t[0].header.boundingBox.map((t=>t[2]))));if(0===n.length)return;const r=Math.min(...n.map((t=>t[0]))),i=Math.max(...n.map((t=>t[1])));(!e||r<e[0]||i>e[1])&&this.setState({zRange:[r,i]})}renderLayers(){const{color:t,material:e,elevationData:n,texture:r,wireframe:i,meshMaxError:o,elevationDecoder:s,tileSize:a,maxZoom:l,minZoom:u,extent:c,maxRequests:h,onTileLoad:p,onTileUnload:f,onTileError:d,maxCacheSize:g,maxCacheByteSize:m,refinementStrategy:A}=this.props;return this.state.isTiled?new zt(this.getSubLayerProps({id:"tiles"}),{wireframe:i,color:t,material:e,getTileData:this.getTiledTerrainData.bind(this),renderSubLayers:this.renderSubLayers.bind(this),updateTriggers:{getTileData:{elevationData:br(n),texture:br(r),meshMaxError:o,elevationDecoder:s}},onViewportLoad:this.onViewportLoad.bind(this),zRange:this.state.zRange||null,tileSize:a,maxZoom:l,minZoom:u,extent:c,maxRequests:h,onTileLoad:p,onTileUnload:f,onTileError:d,maxCacheSize:g,maxCacheByteSize:m,refinementStrategy:A}):new(this.getSubLayerClass("mesh",oe.Z))(this.getSubLayerProps({id:"mesh"}),{data:_r,mesh:this.state.terrain,texture:r,_instanced:!1,getPosition:t=>[0,0,0],getColor:t,material:e,wireframe:i})}}xr.layerName="TerrainLayer",xr.defaultProps=vr;n(5215);n(3614);function wr(t,e){const n=null==e?void 0:e.globalFeatureId;return void 0!==n?function(t,e){const n=Sr(t);for(const t of n){let n=0,r=t.featureIds.value[0];for(let i=0;i<t.featureIds.value.length;i++){const o=t.featureIds.value[i];if(o!==r){if(e===t.globalFeatureIds.value[n])return Tr(t,n,i);n=i,r=o}}if(e===t.globalFeatureIds.value[n])return Tr(t,n,t.featureIds.value.length)}throw new Error(`featureId:${e} not found`)}(t,n):function(t,e){return function(t){const e=[];for(const n of t){if(0===n.featureIds.value.length)continue;let t=0,r=n.featureIds.value[0];for(let i=0;i<n.featureIds.value.length;i++){const o=n.featureIds.value[i];o!==r&&(e.push(Tr(n,t,i)),t=i,r=o)}e.push(Tr(n,t,n.featureIds.value.length))}return e}(Sr(t,e))}(t,null==e?void 0:e.type)}function Er(t,e,n){switch(t.type){case"Point":return function(t,e,n){const{positions:r}=t,i=Mr(r,e,n);return i.length>1?{type:"MultiPoint",coordinates:i}:{type:"Point",coordinates:i[0]}}(t,e,n);case"LineString":return function(t,e=-1/0,n=1/0){const{positions:r}=t,i=t.pathIndices.value.filter((t=>t>=e&&t<=n));if(!(i.length>2))return{type:"LineString",coordinates:Mr(r,i[0],i[1])};const o=[];for(let t=0;t<i.length-1;t++){const e=Mr(r,i[t],i[t+1]);o.push(e)}return{type:"MultiLineString",coordinates:o}}(t,e,n);case"Polygon":return Pr(t,e,n);default:const r=t;throw new Error(`Unsupported geometry type: ${null==r?void 0:r.type}`)}}function Sr(t,e){if(!Boolean(t.points||t.lines||t.polygons))return t.type=e||function(t){return t.pathIndices?"LineString":t.polygonIndices?"Polygon":"Point"}(t),[t];const n=[];return t.points&&(t.points.type="Point",n.push(t.points)),t.lines&&(t.lines.type="LineString",n.push(t.lines)),t.polygons&&(t.polygons.type="Polygon",n.push(t.polygons)),n}function Tr(t,e,n){const r=Er(t,e,n),i=function(t,e=0,n){const r=Object.assign({},t.properties[t.featureIds.value[e]]);for(const n in t.numericProps)r[n]=t.numericProps[n].value[e];return r}(t,e),o=function(t,e=0,n){return t.fields&&t.fields[t.featureIds.value[e]]}(t,e);return{type:"Feature",geometry:r,properties:i,...o}}function Pr(t,e=-1/0,n=1/0){const{positions:r}=t,i=t.polygonIndices.value.filter((t=>t>=e&&t<=n)),o=t.primitivePolygonIndices.value.filter((t=>t>=e&&t<=n));if(!(i.length>2)){const t=[];for(let e=0;e<o.length-1;e++){const n=Mr(r,o[e],o[e+1]);t.push(n)}return{type:"Polygon",coordinates:t}}const s=[];for(let e=0;e<i.length-1;e++){const n=Pr(t,i[e],i[e+1]).coordinates;s.push(n)}return{type:"MultiPolygon",coordinates:s}}function Mr(t,e,n){e=e||0,n=n||t.value.length/t.size;const r=[];for(let i=e;i<n;i++){const e=Array();for(let n=i*t.size;n<(i+1)*t.size;n++)e.push(Number(t.value[n]));r.push(e)}return r}var Cr=n(3693);const Ir={clipBounds:[0,0,1,1]},Or="\nuniform vec4 clip_bounds;\n\nbool clip_isInBounds(vec2 position) {\n  return position.x >= clip_bounds[0] && position.y >= clip_bounds[1] && position.x < clip_bounds[2] && position.y < clip_bounds[3];\n}\n",Rr={name:"clip-vs",vs:Or},Lr={"vs:#decl":"\nvarying float clip_isVisible;\n","vs:DECKGL_FILTER_GL_POSITION":"\n  clip_isVisible = float(clip_isInBounds(geometry.worldPosition.xy));\n","fs:#decl":"\nvarying float clip_isVisible;\n","fs:DECKGL_FILTER_COLOR":"\n  if (clip_isVisible < 0.5) discard;\n"},kr={name:"clip-fs",fs:Or},Dr={"vs:#decl":"\nvarying vec2 clip_commonPosition;\n","vs:DECKGL_FILTER_GL_POSITION":"\n  clip_commonPosition = geometry.position.xy;\n","fs:#decl":"\nvarying vec2 clip_commonPosition;\n","fs:DECKGL_FILTER_COLOR":"\n  if (!clip_isInBounds(clip_commonPosition)) discard;\n"};class Nr extends Cr.Z{getShaders(){let t="instancePositions"in this.getAttributeManager().attributes;return"clipByInstance"in this.props&&(t=this.props.clipByInstance),this.state.clipByInstance=t,t?{modules:[Rr],inject:Lr}:{modules:[kr],inject:Dr}}draw({uniforms:t}){const{clipBounds:e=Ir.clipBounds}=this.props;if(this.state.clipByInstance)t.clip_bounds=e;else{const n=this.projectPosition([e[0],e[1],0]),r=this.projectPosition([e[2],e[3],0]);t.clip_bounds=[Math.min(n[0],r[0]),Math.min(n[1],r[1]),Math.max(n[0],r[0]),Math.max(n[1],r[1])]}}}Nr.extensionName="ClipExtension",Nr.defaultProps=Ir;const Fr={Point:Br,MultiPoint:function(t,e,n){return zr(t,e,n)},LineString:jr,MultiLineString:function(t,e,n){return t.map((t=>jr(t,e,n)))},Polygon:Ur,MultiPolygon:function(t,e,n){return t.map((t=>Ur(t,e,n)))}};function Br([t,e],[n,r],i){const o=(0,U.t7)(n[0],r[0],t),s=(0,U.t7)(n[1],r[1],e);return i.unprojectFlat([o,s])}function zr(t,e,n){return t.map((t=>Br(t,e,n)))}function jr(t,e,n){return zr(t,e,n)}function Ur(t,e,n){return t.map((t=>zr(t,e,n)))}const Vr=["points","lines","polygons"];function Gr(t,e,n,r){const i=t.featureIds.value;if(!i.length)return-1;let o=0,s=i[i.length-1]+1;if(r){const e=function(t,e){if(!t.__layers){const e={},{properties:n}=t;for(let t=0;t<n.length;t++){const{layerName:r}=n[t];r&&(e[r]?e[r][1]=t:e[r]=[t,t])}t.__layers=e}return t.__layers[e]}(t,r);if(!e)return-1;o=e[0],s=e[1]+1}let a=-1;if(e in t.numericProps){const r=t.numericProps[e].value.findIndex(((t,e)=>t===n&&i[e]>=o&&i[e]<s));return r>=0?t.globalFeatureIds.value[r]:-1}return a=e?Zr(t.properties,(t=>t[e]===n),o,s):Zr(t.fields,(t=>t.id===n),o,s),a>=0?function(t,e){if(!t.__ids){const e=[],n=t.featureIds.value,r=t.globalFeatureIds.value;for(let t=0;t<n.length;t++)e[n[t]]=r[t];t.__ids=e}return t.__ids[e]}(t,a):-1}function Zr(t,e,n,r){for(let i=n;i<r;i++)if(e(t[i],i))return i;return-1}const qr={uniqueIdProperty:{type:"string",value:""},highlightedFeatureId:null,loaders:[{name:"Mapbox Vector Tile",id:"mvt",module:"mvt",version:"3.0.12",extensions:["mvt","pbf"],mimeTypes:["application/vnd.mapbox-vector-tile","application/x-protobuf"],worker:!0,category:"geometry",options:{mvt:{coordinates:"local",layerProperty:"layerName",layers:null,tileIndex:null}}}],binary:!0};class Wr extends zt{initializeState(){super.initializeState(),this.setState({data:null,tileJSON:null})}get isLoaded(){return this.state.data&&this.state.tileset&&super.isLoaded}updateState({props:t,oldProps:e,context:n,changeFlags:r}){r.dataChanged&&this._updateTileData(),this.state.data&&(super.updateState({props:t,oldProps:e,context:n,changeFlags:r}),this._setWGS84PropertyForTiles())}async _updateTileData(){let{data:t}=this.props,e=null;if("string"!=typeof t||/(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(t))t.tilejson&&(e=t);else{const{onDataLoad:n,fetch:r}=this.props;this.setState({data:null,tileJSON:null});try{e=await r(t,{propName:"data",layer:this,loaders:[]})}catch(e){this.raiseError(e,"loading TileJSON"),t=null}n&&n(e)}e&&(t=e.tiles),this.setState({data:t,tileJSON:e})}_getTilesetOptions(t){const e=super._getTilesetOptions(t),{tileJSON:n}=this.state;return n&&(Number.isFinite(n.minzoom)&&n.minzoom>t.minZoom&&(e.minZoom=n.minzoom),Number.isFinite(n.maxzoom)&&(!Number.isFinite(t.maxZoom)||n.maxzoom<t.maxZoom)&&(e.maxZoom=n.maxzoom)),e}renderLayers(){return this.state.data?super.renderLayers():null}getTileData(t){var e;const n=xt(this.state.data,t);if(!n)return Promise.reject("Invalid URL");let r=this.getLoadOptions();const{binary:i,fetch:o}=this.props,{signal:s,x:a,y:l,z:u}=t;return r={...r,mimeType:"application/x-protobuf",mvt:{...null===(e=r)||void 0===e?void 0:e.mvt,coordinates:this.context.viewport.resolution?"wgs84":"local",tileIndex:{x:a,y:l,z:u}},gis:i?{format:"binary"}:{}},o(n,{propName:"data",layer:this,loadOptions:r,signal:s})}renderSubLayers(t){const{tile:e}=t,n=Math.pow(2,e.z),r=512/n,i=-r,o=512*e.x/n,s=512*(1-e.y/n),a=(new Rt.Z).scale([r,i,1]);t.autoHighlight=!1,this.context.viewport.resolution||(t.modelMatrix=a,t.coordinateOrigin=[o,s,0],t.coordinateSystem=Jt.Df.CARTESIAN,t.extensions=[...t.extensions||[],new Nr]);const l=super.renderSubLayers(t);return!this.props.binary||l instanceof _.Z||v.Z.warn("renderSubLayers() must return GeoJsonLayer when using binary:true")(),l}_updateAutoHighlight(t){const{uniqueIdProperty:e}=this.props,{hoveredFeatureId:n,hoveredFeatureLayerName:r}=this.state,i=t.object;let o,s;i&&(o=Hr(i,e),s=Xr(i)),n===o&&r===s||this.setState({hoveredFeatureId:o,hoveredFeatureLayerName:s})}getPickingInfo(t){const e=super.getPickingInfo(t),n=this.context.viewport.resolution;if(this.props.binary&&-1!==e.index){const{data:n}=t.sourceLayer.props;e.object=wr(n,{globalFeatureId:e.index})}return e.object&&!n&&(e.object=Yr(e.object,e.tile.bbox,this.context.viewport)),e}getHighlightedObjectIndex(t){const{hoveredFeatureId:e,hoveredFeatureLayerName:n}=this.state,{uniqueIdProperty:r,highlightedFeatureId:i,binary:o}=this.props,s=t.content,a=$r(i);if(!$r(e)&&!a)return-1;const l=a?i:e;return Array.isArray(s)?s.findIndex((t=>{const e=Hr(t,r)===l,i=a||Xr(t)===n;return e&&i})):s&&o?function(t,e,n,r){for(const i of Vr){const o=t[i]&&Gr(t[i],e,n,r);if(o>=0)return o}return-1}(s,r,l,a?"":n):-1}_pickObjects(t){const{deck:e,viewport:n}=this.context,r=n.width,i=n.height,o=n.x,s=n.y,a=[this.id];return e.pickObjects({x:o,y:s,width:r,height:i,layerIds:a,maxObjects:t})}getRenderedFeatures(t=null){const e=this._pickObjects(t),n=new Set,r=[];for(const t of e){const e=Hr(t.object,this.props.uniqueIdProperty);void 0===e?r.push(t.object):n.has(e)||(n.add(e),r.push(t.object))}return r}_setWGS84PropertyForTiles(){const t="dataInWGS84",{tileset:e}=this.state;e.selectedTiles.forEach((e=>{e.hasOwnProperty(t)||Object.defineProperty(e,t,{get:()=>{if(!e.content)return null;if(this.props.binary&&Array.isArray(e.content)&&!e.content.length)return[];if(void 0===e._contentWGS84){const t=this.props.binary?wr(e.content):e.content;e._contentWGS84=t.map((t=>Yr(t,e.bbox,this.context.viewport)))}return e._contentWGS84}})}))}}function Hr(t,e){return e?t.properties[e]:"id"in t?t.id:void 0}function Xr(t){var e;return(null===(e=t.properties)||void 0===e?void 0:e.layerName)||null}function $r(t){return null!=t&&""!==t}function Yr(t,e,n){const r={...t,geometry:{type:t.geometry.type}};return Object.defineProperty(r.geometry,"coordinates",{get:()=>{const r=function(t,e,n){const r=[n.projectFlat([e.west,e.north]),n.projectFlat([e.east,e.south])];return{...t,coordinates:Fr[t.type](t.coordinates,r,n)}}(t.geometry,e,n);return r.coordinates}}),r}Wr.layerName="MVTLayer",Wr.defaultProps=qr},4717:(t,e,n)=>{"use strict";n.d(e,{Z:()=>h});var r=n(4185),i=n(3844),o=n(3117),s=n(4088),a=n(1113),l=n(3982);const u=[0,0,0,255],c={getSourcePosition:{type:"accessor",value:t=>t.sourcePosition},getTargetPosition:{type:"accessor",value:t=>t.targetPosition},getSourceColor:{type:"accessor",value:u},getTargetColor:{type:"accessor",value:u},getWidth:{type:"accessor",value:1},getHeight:{type:"accessor",value:1},getTilt:{type:"accessor",value:0},greatCircle:!1,widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class h extends r.Z{getShaders(){return super.getShaders({vs:"#define SHADER_NAME arc-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec4 instanceSourceColors;\nattribute vec4 instanceTargetColors;\nattribute vec3 instanceSourcePositions;\nattribute vec3 instanceSourcePositions64Low;\nattribute vec3 instanceTargetPositions;\nattribute vec3 instanceTargetPositions64Low;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\nattribute float instanceHeights;\nattribute float instanceTilts;\n\nuniform bool greatCircle;\nuniform bool useShortestPath;\nuniform float numSegments;\nuniform float opacity;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform int widthUnits;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvarying float isValid;\n\nfloat paraboloid(float distance, float sourceZ, float targetZ, float ratio) {\n\n  float deltaZ = targetZ - sourceZ;\n  float dh = distance * instanceHeights;\n  if (dh == 0.0) {\n    return sourceZ + deltaZ * ratio;\n  }\n  float unitZ = deltaZ / dh;\n  float p2 = unitZ * unitZ + 1.0;\n  float dir = step(deltaZ, 0.0);\n  float z0 = mix(sourceZ, targetZ, dir);\n  float r = mix(ratio, 1.0 - ratio, dir);\n  return sqrt(r * (p2 - r)) * dh + z0;\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  return dir_screenspace * offset_direction * width / 2.0;\n}\n\nfloat getSegmentRatio(float index) {\n  return smoothstep(0.0, 1.0, index / (numSegments - 1.0));\n}\n\nvec3 interpolateFlat(vec3 source, vec3 target, float segmentRatio) {\n  float distance = length(source.xy - target.xy);\n  float z = paraboloid(distance, source.z, target.z, segmentRatio);\n\n  float tiltAngle = radians(instanceTilts);\n  vec2 tiltDirection = normalize(target.xy - source.xy);\n  vec2 tilt = vec2(-tiltDirection.y, tiltDirection.x) * z * sin(tiltAngle);\n\n  return vec3(\n    mix(source.xy, target.xy, segmentRatio) + tilt,\n    z * cos(tiltAngle)\n  );\n}\nfloat getAngularDist (vec2 source, vec2 target) {\n  vec2 sourceRadians = radians(source);\n  vec2 targetRadians = radians(target);\n  vec2 sin_half_delta = sin((sourceRadians - targetRadians) / 2.0);\n  vec2 shd_sq = sin_half_delta * sin_half_delta;\n\n  float a = shd_sq.y + cos(sourceRadians.y) * cos(targetRadians.y) * shd_sq.x;\n  return 2.0 * asin(sqrt(a));\n}\n\nvec3 interpolateGreatCircle(vec3 source, vec3 target, vec3 source3D, vec3 target3D, float angularDist, float t) {\n  vec2 lngLat;\n  if(abs(angularDist - PI) < 0.001) {\n    lngLat = (1.0 - t) * source.xy + t * target.xy;\n  } else {\n    float a = sin((1.0 - t) * angularDist);\n    float b = sin(t * angularDist);\n    vec3 p = source3D.yxz * a + target3D.yxz * b;\n    lngLat = degrees(vec2(atan(p.y, -p.x), atan(p.z, length(p.xy))));\n  }\n\n  float z = paraboloid(angularDist * EARTH_RADIUS, source.z, target.z, t);\n\n  return vec3(lngLat, z);\n}\n\nvoid main(void) {\n  geometry.worldPosition = instanceSourcePositions;\n  geometry.worldPositionAlt = instanceTargetPositions;\n\n  float segmentIndex = positions.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  float prevSegmentRatio = getSegmentRatio(max(0.0, segmentIndex - 1.0));\n  float nextSegmentRatio = getSegmentRatio(min(numSegments - 1.0, segmentIndex + 1.0));\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  isValid = 1.0;\n\n  uv = vec2(segmentRatio, positions.y);\n  geometry.uv = uv;\n  geometry.pickingColor = instancePickingColors;\n\n  vec4 curr;\n  vec4 next;\n  vec3 source;\n  vec3 target;\n\n  if ((greatCircle || project_uProjectionMode == PROJECTION_MODE_GLOBE) && project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n    source = project_globe_(vec3(instanceSourcePositions.xy, 0.0));\n    target = project_globe_(vec3(instanceTargetPositions.xy, 0.0));\n    float angularDist = getAngularDist(instanceSourcePositions.xy, instanceTargetPositions.xy);\n\n    vec3 prevPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, prevSegmentRatio);\n    vec3 currPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, segmentRatio);\n    vec3 nextPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, nextSegmentRatio);\n\n    if (abs(currPos.x - prevPos.x) > 180.0) {\n      indexDir = -1.0;\n      isValid = 0.0;\n    } else if (abs(currPos.x - nextPos.x) > 180.0) {\n      indexDir = 1.0;\n      isValid = 0.0;\n    }\n    nextPos = indexDir < 0.0 ? prevPos : nextPos;\n    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;\n\n    if (isValid == 0.0) {\n      nextPos.x += nextPos.x > 0.0 ? -360.0 : 360.0;\n      float t = ((currPos.x > 0.0 ? 180.0 : -180.0) - currPos.x) / (nextPos.x - currPos.x);\n      currPos = mix(currPos, nextPos, t);\n      segmentRatio = mix(segmentRatio, nextSegmentRatio, t);\n    }\n\n    vec3 currPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, segmentRatio);\n    vec3 nextPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, nextSegmentRatio);\n  \n    curr = project_position_to_clipspace(currPos, currPos64Low, vec3(0.0), geometry.position);\n    next = project_position_to_clipspace(nextPos, nextPos64Low, vec3(0.0));\n  \n  } else {\n    vec3 source_world = instanceSourcePositions;\n    vec3 target_world = instanceTargetPositions;\n    if (useShortestPath) {\n      source_world.x = mod(source_world.x + 180., 360.0) - 180.;\n      target_world.x = mod(target_world.x + 180., 360.0) - 180.;\n\n      float deltaLng = target_world.x - source_world.x;\n      if (deltaLng > 180.) target_world.x -= 360.;\n      if (deltaLng < -180.) source_world.x -= 360.;\n    }\n    source = project_position(source_world, instanceSourcePositions64Low);\n    target = project_position(target_world, instanceTargetPositions64Low);\n    float antiMeridianX = 0.0;\n\n    if (useShortestPath) {\n      if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n        antiMeridianX = -(project_uCoordinateOrigin.x + 180.) / 360. * TILE_SIZE;\n      }\n      float thresholdRatio = (antiMeridianX - source.x) / (target.x - source.x);\n\n      if (prevSegmentRatio <= thresholdRatio && nextSegmentRatio > thresholdRatio) {\n        isValid = 0.0;\n        indexDir = sign(segmentRatio - thresholdRatio);\n        segmentRatio = thresholdRatio;\n      }\n    }\n\n    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;\n    vec3 currPos = interpolateFlat(source, target, segmentRatio);\n    vec3 nextPos = interpolateFlat(source, target, nextSegmentRatio);\n\n    if (useShortestPath) {\n      if (nextPos.x < antiMeridianX) {\n        currPos.x += TILE_SIZE;\n        nextPos.x += TILE_SIZE;\n      }\n    }\n\n    curr = project_common_position_to_clipspace(vec4(currPos, 1.0));\n    next = project_common_position_to_clipspace(vec4(nextPos, 1.0));\n    geometry.position = vec4(currPos, 1.0);\n  }\n  float widthPixels = clamp(\n    project_size_to_pixel(instanceWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels\n  );\n  vec3 offset = vec3(\n    getExtrusionOffset((next.xy - curr.xy) * indexDir, positions.y, widthPixels),\n    0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n  gl_Position = curr + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vec4 color = mix(instanceSourceColors, instanceTargetColors, segmentRatio);\n  vColor = vec4(color.rgb, color.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME arc-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvarying float isValid;\n\nvoid main(void) {\n  if (isValid == 0.0) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n  geometry.uv = uv;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[i.Z,o.Z]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceSourceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getSourceColor",defaultValue:u},instanceTargetColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getTargetColor",defaultValue:u},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1},instanceHeights:{size:1,transition:!0,accessor:"getHeight",defaultValue:1},instanceTilts:{size:1,transition:!0,accessor:"getTilt",defaultValue:0}})}updateState({props:t,oldProps:e,changeFlags:n}){if(super.updateState({props:t,oldProps:e,changeFlags:n}),n.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{widthUnits:e,widthScale:n,widthMinPixels:r,widthMaxPixels:i,greatCircle:o,wrapLongitude:a}=this.props;this.state.model.setUniforms(t).setUniforms({greatCircle:o,widthUnits:s.iI[e],widthScale:n,widthMinPixels:r,widthMaxPixels:i,useShortestPath:a}).draw()}_getModel(t){let e=[];for(let t=0;t<50;t++)e=e.concat([t,1,0,t,-1,0]);const n=new a.Z(t,{...this.getShaders(),id:this.props.id,geometry:new l.Z({drawMode:5,attributes:{positions:new Float32Array(e)}}),isInstanced:!0});return n.setUniforms({numSegments:50}),n}}h.layerName="ArcLayer",h.defaultProps=c},5103:(t,e,n)=>{"use strict";n.d(e,{Z:()=>m});var r=n(4185),i=n(3844),o=n(7287),s=n(3117),a=n(4088),l=n(1113),u=n(744),c=n(3982),h=n(4538),p=n(5215);class f extends c.Z{constructor(t={}){const{id:e=(0,h.hQ)("column-geometry")}=t,{indices:n,attributes:r}=function(t){const{radius:e,height:n=1,nradial:r=10}=t;let{vertices:i}=t;i&&(u.Z.assert(i.length>=r),i=i.flatMap((t=>[t[0],t[1]])),(0,p.Ny)(i,p.wG.COUNTER_CLOCKWISE));const o=n>0,s=r+1,a=o?3*s+1:r,l=2*Math.PI/r,c=new Uint16Array(o?3*r*2:0),h=new Float32Array(3*a),f=new Float32Array(3*a);let d=0;if(o){for(let t=0;t<s;t++){const o=t*l,s=t%r,a=Math.sin(o),u=Math.cos(o);for(let t=0;t<2;t++)h[d+0]=i?i[2*s]:u*e,h[d+1]=i?i[2*s+1]:a*e,h[d+2]=(.5-t)*n,f[d+0]=i?i[2*s]:u,f[d+1]=i?i[2*s+1]:a,d+=3}h[d+0]=h[d-3],h[d+1]=h[d-2],h[d+2]=h[d-1],d+=3}for(let t=o?0:1;t<s;t++){const o=Math.floor(t/2)*Math.sign(.5-t%2),s=o*l,a=(o+r)%r,u=Math.sin(s),c=Math.cos(s);h[d+0]=i?i[2*a]:c*e,h[d+1]=i?i[2*a+1]:u*e,h[d+2]=n/2,f[d+2]=1,d+=3}if(o){let t=0;for(let e=0;e<r;e++)c[t++]=2*e+0,c[t++]=2*e+2,c[t++]=2*e+0,c[t++]=2*e+1,c[t++]=2*e+1,c[t++]=2*e+3}return{indices:c,attributes:{POSITION:{size:3,value:h},NORMAL:{size:3,value:f}}}}(t);super({...t,id:e,indices:n,attributes:r})}}const d=[0,0,0,255],g={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,getPosition:{type:"accessor",value:t=>t.position},getFillColor:{type:"accessor",value:d},getLineColor:{type:"accessor",value:d},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class m extends r.Z{getShaders(){return super.getShaders({vs:"\n#define SHADER_NAME column-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 normals;\n\nattribute vec3 instancePositions;\nattribute float instanceElevations;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute float instanceStrokeWidths;\n\nattribute vec3 instancePickingColors;\nuniform float opacity;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\nuniform bool extruded;\nuniform bool isStroke;\nuniform float coverage;\nuniform float elevationScale;\nuniform float edgeDistance;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform int radiusUnits;\nuniform int widthUnits;\nvarying vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n\n  vec4 color = isStroke ? instanceLineColors : instanceFillColors;\n  mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n  float elevation = 0.0;\n  float strokeOffsetRatio = 1.0;\n\n  if (extruded) {\n    elevation = instanceElevations * (positions.z + 1.0) / 2.0 * elevationScale;\n  } else if (isStroke) {\n    float widthPixels = clamp(\n      project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\n      widthMinPixels, widthMaxPixels) / 2.0;\n    strokeOffsetRatio -= sign(positions.z) * project_pixel_size(widthPixels) / project_size(edgeDistance * coverage * radius);\n  }\n  float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);\n  float dotRadius = radius * coverage * shouldRender;\n\n  geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));\n  geometry.pickingColor = instancePickingColors;\n  vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);\n  vec3 centroidPosition64Low = instancePositions64Low;\n  vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + offset) * dotRadius;\n  if (radiusUnits == UNIT_METERS) {\n    offset = project_size(offset);\n  }\n  vec3 pos = vec3(offset, 0.);\n  DECKGL_FILTER_SIZE(pos, geometry);\n\n  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  if (extruded && !isStroke) {\n    vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);\n    vColor = vec4(lightColor, color.a * opacity);\n  } else {\n    vColor = vec4(color.rgb, color.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME column-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[i.Z,o.N,s.Z]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getFillColor",defaultValue:d},instanceLineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getLineColor",defaultValue:d},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState({props:t,oldProps:e,changeFlags:n}){super.updateState({props:t,oldProps:e,changeFlags:n});const r=n.extensionsChanged;if(r){var i;const{gl:t}=this.context;null===(i=this.state.model)||void 0===i||i.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}(r||t.diskResolution!==e.diskResolution||t.vertices!==e.vertices||(t.extruded||t.stroked)!==(e.extruded||e.stroked))&&this._updateGeometry(t)}getGeometry(t,e,n){const r=new f({radius:1,height:n?2:0,vertices:e,nradial:t});let i=0;if(e)for(let n=0;n<t;n++){const r=e[n];i+=Math.sqrt(r[0]*r[0]+r[1]*r[1])/t}else i=1;return this.setState({edgeDistance:Math.cos(Math.PI/t)*i}),r}_getModel(t){return new l.Z(t,{...this.getShaders(),id:this.props.id,isInstanced:!0})}_updateGeometry({diskResolution:t,vertices:e,extruded:n,stroked:r}){const i=this.getGeometry(t,e,n||r);this.setState({fillVertexCount:i.attributes.POSITION.value.length/3,wireframeVertexCount:i.indices.value.length}),this.state.model.setProps({geometry:i})}draw({uniforms:t}){const{lineWidthUnits:e,lineWidthScale:n,lineWidthMinPixels:r,lineWidthMaxPixels:i,radiusUnits:o,elevationScale:s,extruded:l,filled:u,stroked:c,wireframe:h,offset:p,coverage:f,radius:d,angle:g}=this.props,{model:m,fillVertexCount:A,wireframeVertexCount:y,edgeDistance:_}=this.state;m.setUniforms(t).setUniforms({radius:d,angle:g/180*Math.PI,offset:p,extruded:l,coverage:f,elevationScale:s,edgeDistance:_,radiusUnits:a.iI[o],widthUnits:a.iI[e],widthScale:n,widthMinPixels:r,widthMaxPixels:i}),l&&h&&(m.setProps({isIndexed:!0}),m.setVertexCount(y).setDrawMode(1).setUniforms({isStroke:!0}).draw()),u&&(m.setProps({isIndexed:!1}),m.setVertexCount(A).setDrawMode(5).setUniforms({isStroke:!1}).draw()),!l&&c&&(m.setProps({isIndexed:!1}),m.setVertexCount(2*A/3).setDrawMode(5).setUniforms({isStroke:!0}).draw())}}m.layerName="ColumnLayer",m.defaultProps=g},9026:(t,e,n)=>{"use strict";n.d(e,{Z:()=>b});var r=n(8918),i=n(744),o=n(8452),s=n(6867),a=n(8569),l=n(5555),u=n(2112),c=n(1435);const h={circle:{type:a.Z,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:s.Z,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:l.Z,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},p={type:u.Z,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",getLineColor:"getColor",getLineWidth:"getWidth"}},f={type:c.Z,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function d({type:t,props:e}){const n={};for(const r in e)n[r]=t.defaultProps[e[r]];return n}function g(t,e){const{transitions:n,updateTriggers:r}=t.props,i={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const o in e){const s=e[o];let a=t.props[o];o.startsWith("get")&&(a=t.getSubLayerAccessor(a),i.updateTriggers[s]=r[o],n&&(i.transitions[s]=n[o])),i[s]=a}return i}function m(t,e,n={}){const r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:o=0,endRow:s=t.length}=n;for(let n=o;n<s;n++){const o=t[n];i.Z.assert(o&&o.geometry,"GeoJSON does not have geometry");const{geometry:s}=o;if("GeometryCollection"===s.type){i.Z.assert(Array.isArray(s.geometries),"GeoJSON does not have geometries array");const{geometries:t}=s;for(let i=0;i<t.length;i++)A(t[i],r,e,o,n)}else A(s,r,e,o,n)}return r}function A(t,e,n,r,o){const{type:s,coordinates:a}=t,{pointFeatures:l,lineFeatures:u,polygonFeatures:c,polygonOutlineFeatures:h}=e;if(function(t,e){let n=y[t];for(i.Z.assert(n,"Unknown GeoJSON type ".concat(t));e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}(s,a))switch(s){case"Point":l.push(n({geometry:t},r,o));break;case"MultiPoint":a.forEach((t=>{l.push(n({geometry:{type:"Point",coordinates:t}},r,o))}));break;case"LineString":u.push(n({geometry:t},r,o));break;case"MultiLineString":a.forEach((t=>{u.push(n({geometry:{type:"LineString",coordinates:t}},r,o))}));break;case"Polygon":c.push(n({geometry:t},r,o)),a.forEach((t=>{h.push(n({geometry:{type:"LineString",coordinates:t}},r,o))}));break;case"MultiPolygon":a.forEach((t=>{c.push(n({geometry:{type:"Polygon",coordinates:t}},r,o)),t.forEach((t=>{h.push(n({geometry:{type:"LineString",coordinates:t}},r,o))}))}))}else i.Z.warn("".concat(s," coordinates are malformed"))()}const y={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function _(t){return t.geometry.coordinates}const v={...d(h.circle),...d(h.icon),...d(h.text),...d(p),...d(f),stroked:!0,filled:!0,extruded:!1,wireframe:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class b extends r.Z{initializeState(){this.state={layerProps:{},features:{}},this.props.getLineDashArray&&i.Z.removed("getLineDashArray","PathStyleExtension")()}updateState({props:t,changeFlags:e}){if(!e.dataChanged)return;const{data:n}=this.props,r=n&&"points"in n&&"polygons"in n&&"lines"in n;this.setState({binary:r}),r?this._updateStateBinary({props:t,changeFlags:e}):this._updateStateJSON({props:t,changeFlags:e})}_updateStateBinary({props:t,changeFlags:e}){const n=function(t,e){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{points:r,lines:i,polygons:o}=t,s=function(t,e){const n={points:null,lines:null,polygons:null};for(const r in n){const i=t[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(3*i.length);const o=[];for(let t=0;t<i.length;t++)e(i[t],o),n[r][3*t+0]=o[0],n[r][3*t+1]=o[1],n[r][3*t+2]=o[2]}return n}(t,e);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:{getPosition:r.positions,instancePickingColors:{size:3,value:s.points}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:{getPath:i.positions,instancePickingColors:{size:3,value:s.lines}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines._pathType="open",n.polygons.data={length:o.polygonIndices.value.length-1,startIndices:o.polygonIndices.value,attributes:{getPolygon:o.positions,pickingColors:{size:3,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygons._normalize=!1,o.triangles&&(n.polygons.data.attributes.indices=o.triangles.value),n.polygonsOutline.data={length:o.primitivePolygonIndices.value.length-1,startIndices:o.primitivePolygonIndices.value,attributes:{getPath:o.positions,instancePickingColors:{size:3,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygonsOutline._pathType="open",n}(t.data,this.encodePickingColor);this.setState({layerProps:n})}_updateStateJSON({props:t,changeFlags:e}){const n=function(t){if(Array.isArray(t))return t;switch(i.Z.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return i.Z.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}(t.data),r=this.getSubLayerRow.bind(this);let s={};const a={};if(Array.isArray(e.dataChanged)){const t=this.state.features;for(const e in t)s[e]=t[e].slice(),a[e]=[];for(const i of e.dataChanged){const e=m(n,r,i);for(const n in t)a[n].push((0,o.b)({data:s[n],getIndex:t=>t.__source.index,dataRange:i,replace:e[n]}))}}else s=m(n,r);const l=function(t,e){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{pointFeatures:r,lineFeatures:i,polygonFeatures:o,polygonOutlineFeatures:s}=t;return n.points.data=r,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=_,n.lines.data=i,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=_,n.polygons.data=o,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=_,n.polygonsOutline.data=s,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=_,n}(s,a);this.setState({features:s,featuresDiff:a,layerProps:l})}_updateAutoHighlight(t){const e="".concat(this.id,"-points-"),n=t.sourceLayer.id.startsWith(e);for(const r of this.getSubLayers())r.id.startsWith(e)===n&&r.updateAutoHighlight(t)}_renderPolygonLayer(){const{extruded:t,wireframe:e}=this.props,{layerProps:n}=this.state,r="polygons-fill",i=this.shouldRenderSubLayer(r,n.polygons.data)&&this.getSubLayerClass(r,f.type);if(i){const o=g(this,f.props),s=t&&e;return s||delete o.getLineColor,o.updateTriggers.lineColors=s,new i(o,this.getSubLayerProps({id:r,updateTriggers:o.updateTriggers}),n.polygons)}return null}_renderLineLayers(){const{extruded:t,stroked:e}=this.props,{layerProps:n}=this.state,r="polygons-stroke",i="linestrings",o=!t&&e&&this.shouldRenderSubLayer(r,n.polygonsOutline.data)&&this.getSubLayerClass(r,p.type),s=this.shouldRenderSubLayer(i,n.lines.data)&&this.getSubLayerClass(i,p.type);if(o||s){const t=g(this,p.props);return[o&&new o(t,this.getSubLayerProps({id:r,updateTriggers:t.updateTriggers}),n.polygonsOutline),s&&new s(t,this.getSubLayerProps({id:i,updateTriggers:t.updateTriggers}),n.lines)]}return null}_renderPointLayers(){const{pointType:t}=this.props,{layerProps:e,binary:n}=this.state;let{highlightedObjectIndex:r}=this.props;!n&&Number.isFinite(r)&&(r=e.points.data.findIndex((t=>t.__source.index===r)));const i=new Set(t.split("+")),o=[];for(const t of i){const n="points-".concat(t),i=h[t],s=i&&this.shouldRenderSubLayer(n,e.points.data)&&this.getSubLayerClass(n,i.type);if(s){const t=g(this,i.props);o.push(new s(t,this.getSubLayerProps({id:n,updateTriggers:t.updateTriggers,highlightedObjectIndex:r}),e.points))}}return o}renderLayers(){const{extruded:t}=this.props,e=this._renderPolygonLayer();return[!t&&e,this._renderLineLayers(),this._renderPointLayers(),t&&e]}getSubLayerAccessor(t){const{binary:e}=this.state;return e&&"function"==typeof t?(e,n)=>{const{data:r,index:i}=n,o=function(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,r=t.featureIds.value[n];return-1!==n?function(t,e,n){const r={properties:{...t.properties[e]}};for(const e in t.numericProps)r.properties[e]=t.numericProps[e].value[n];return r}(t,r,n):null}(r,i);return t(o,n)}:super.getSubLayerAccessor(t)}}b.layerName="GeoJsonLayer",b.defaultProps=v},6867:(t,e,n)=>{"use strict";n.d(e,{Z:()=>E});var r=n(4185),i=n(3844),o=n(3117),s=n(4088),a=n(744),l=n(1113),u=n(3982),c=n(3296),h=n(1953),p=n(4912),f=n(2378),d=n(3079),g=n(8550);const m=()=>{},A={10241:9987,10240:9729,10242:33071,10243:33071};function y(t,e,n,r){return n===e.width&&r===e.height?e:(t.canvas.height=r,t.canvas.width=n,t.clearRect(0,0,t.canvas.width,t.canvas.height),t.drawImage(e,0,0,e.width,e.height,0,0,n,r),t.canvas)}function _(t){return t&&(t.id||t.url)}function v(t,e,n){for(let r=0;r<e.length;r++){const{icon:i,xOffset:o}=e[r];t[_(i)]={...i,x:o,y:n}}}class b{constructor(t,{onUpdate:e=m,onError:n=m}){this.gl=t,this.onUpdate=e,this.onError=n,this._loadOptions=null,this._getIcon=null,this._texture=null,this._externalTexture=null,this._mapping={},this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=4,this._canvasWidth=1024,this._canvasHeight=0,this._canvas=null}finalize(){var t;null===(t=this._texture)||void 0===t||t.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(t){const e=this._autoPacking?_(t):t;return this._mapping[e]||{}}setProps({loadOptions:t,autoPacking:e,iconAtlas:n,iconMapping:r,data:i,getIcon:o}){t&&(this._loadOptions=t),void 0!==e&&(this._autoPacking=e),o&&(this._getIcon=o),r&&(this._mapping=r),n&&this._updateIconAtlas(n),this._autoPacking&&(i||o)&&"undefined"!=typeof document&&(this._canvas=this._canvas||document.createElement("canvas"),this._updateAutoPacking(i))}get isLoaded(){return 0===this._pendingCount}_updateIconAtlas(t){var e;null===(e=this._texture)||void 0===e||e.delete(),this._texture=null,this._externalTexture=t,this.onUpdate()}_updateAutoPacking(t){const e=Object.values(function(t,e,n){if(!t||!e)return null;n=n||{};const r={},{iterable:i,objectInfo:o}=(0,g.jB)(t);for(const t of i){o.index++;const i=e(t,o),s=_(i);if(!i)throw new Error("Icon is missing.");if(!i.url)throw new Error("Icon url is missing.");r[s]||n[s]&&i.url===n[s].url||(r[s]={...i,source:t,sourceIndex:o.index})}return r}(t,this._getIcon,this._mapping)||{});if(e.length>0){const{mapping:t,xOffset:n,yOffset:r,rowHeight:i,canvasHeight:o}=function({icons:t,buffer:e,mapping:n={},xOffset:r=0,yOffset:i=0,rowHeight:o=0,canvasWidth:s}){let a=[];for(let l=0;l<t.length;l++){const u=t[l];if(!n[_(u)]){const{height:t,width:l}=u;r+l+e>s&&(v(n,a,i),r=0,i=o+i+e,o=0,a=[]),a.push({icon:u,xOffset:r}),r=r+l+e,o=Math.max(o,t)}}return a.length>0&&v(n,a,i),{mapping:n,rowHeight:o,xOffset:r,yOffset:i,canvasWidth:s,canvasHeight:(l=o+i+e,Math.pow(2,Math.ceil(Math.log2(l))))};var l}({icons:e,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=i,this._mapping=t,this._xOffset=n,this._yOffset=r,this._canvasHeight=o,this._texture||(this._texture=new p.Z(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:A})),this._texture.height!==this._canvasHeight&&(this._texture=function(t,e,n,r){const i=e.width,o=e.height,s=(0,c.h)(e,{width:n,height:r});return(0,h.Lv)(e,s,{targetY:0,width:i,height:o}),e.delete(),s}(this.gl,this._texture,this._canvasWidth,this._canvasHeight)),this.onUpdate(),this._loadIcons(e)}}_loadIcons(t){const e=this._canvas.getContext("2d");for(const n of t)this._pendingCount++,(0,d.z)(n.url,f.S,this._loadOptions).then((t=>{const r=_(n),{x:i,y:o,width:s,height:a}=this._mapping[r],l=y(e,t,s,a);this._texture.setSubImageData({data:l,x:i,y:o,width:s,height:a}),this._texture.generateMipmap(),this.onUpdate()})).catch((t=>{this.onError({url:n.url,source:n.source,sourceIndex:n.sourceIndex,loadOptions:this._loadOptions,error:t})})).finally((()=>{this._pendingCount--}))}}const x=[0,0,0,255],w={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:x},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,compare:!1,optional:!0}};class E extends r.Z{getShaders(){return super.getShaders({vs:"#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\nuniform int sizeUnits;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n\n  vec2 iconSize = instanceIconFrames.zw;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), \n    sizeMinPixels, sizeMaxPixels\n  );\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); \n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n\n  vColorMode = instanceColorModes;\n}\n",fs:"#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < alphaCutoff) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[i.Z,o.Z]})}initializeState(){this.state={iconManager:new b(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:x},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState({oldProps:t,props:e,changeFlags:n}){super.updateState({props:e,oldProps:t,changeFlags:n});const r=this.getAttributeManager(),{iconAtlas:i,iconMapping:o,data:s,getIcon:a}=e,{iconManager:l}=this.state;l.setProps({loadOptions:e.loadOptions});let u=!1;if(i||this.internalState.isAsyncPropLoading("iconAtlas")?(t.iconAtlas!==e.iconAtlas&&l.setProps({iconAtlas:i,autoPacking:!1}),t.iconMapping!==e.iconMapping&&(l.setProps({iconMapping:o}),u=!0)):l.setProps({autoPacking:!0}),(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getIcon))&&l.setProps({data:s,getIcon:a}),u&&(r.invalidate("instanceOffsets"),r.invalidate("instanceIconFrames"),r.invalidate("instanceColorModes")),n.extensionsChanged){var c;const{gl:t}=this.context;null===(c=this.state.model)||void 0===c||c.delete(),this.state.model=this._getModel(t),r.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(){super.finalizeState(),this.state.iconManager.finalize()}draw({uniforms:t}){const{sizeScale:e,sizeMinPixels:n,sizeMaxPixels:r,sizeUnits:i,billboard:o,alphaCutoff:a}=this.props,{iconManager:l}=this.state,u=l.getTexture();u&&this.state.model.setUniforms(t).setUniforms({iconsTexture:u,iconsTextureDim:[u.width,u.height],sizeUnits:s.iI[i],sizeScale:e,sizeMinPixels:n,sizeMaxPixels:r,billboard:o,alphaCutoff:a}).draw()}_getModel(t){return new l.Z(t,{...this.getShaders(),id:this.props.id,geometry:new u.Z({drawMode:6,attributes:{positions:{size:2,value:new Float32Array([-1,-1,-1,1,1,1,1,-1])}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(t){const{onIconError:e}=this.getCurrentLayer().props;e?e(t):a.Z.error(t.error)()}getInstanceOffset(t){const e=this.state.iconManager.getIconMapping(t);return[e.width/2-e.anchorX||0,e.height/2-e.anchorY||0]}getInstanceColorMode(t){return this.state.iconManager.getIconMapping(t).mask?1:0}getInstanceIconFrame(t){const e=this.state.iconManager.getIconMapping(t);return[e.x||0,e.y||0,e.width||0,e.height||0]}}E.layerName="IconLayer",E.defaultProps=w},9119:(t,e,n)=>{"use strict";n.r(e),n.d(e,{ArcLayer:()=>r.Z,BitmapLayer:()=>A,ColumnLayer:()=>w.Z,GeoJsonLayer:()=>M.Z,GridCellLayer:()=>S,IconLayer:()=>y.Z,LineLayer:()=>v,PathLayer:()=>T.Z,PointCloudLayer:()=>b.Z,PolygonLayer:()=>P.Z,ScatterplotLayer:()=>x.Z,SolidPolygonLayer:()=>I.Z,TextLayer:()=>C.Z,_MultiIconLayer:()=>O.Z,_TextBackgroundLayer:()=>R.Z});var r=n(4717),i=n(4088),o=n(4185),s=n(3844),a=n(3117),l=n(1113),u=n(3982),c=n(7682),h=n(4034);const p=new Uint16Array([0,2,1,0,3,2]),f=new Float32Array([0,1,0,0,1,0,1,1]);function d(t,e,n){return(0,h.t7)((0,h.t7)(t[0],t[1],n),(0,h.t7)(t[3],t[2],n),e)}const g="\n#define SHADER_NAME bitmap-layer-fragment-shader\n\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D bitmapTexture;\n\nvarying vec2 vTexCoord;\nvarying vec2 vTexPos;\n\nuniform float desaturate;\nuniform vec4 transparentColor;\nuniform vec3 tintColor;\nuniform float opacity;\n\nuniform float coordinateConversion;\nuniform vec4 bounds;\n\n/* projection utils */\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / PI / 2.0;\n\n// from degrees to Web Mercator\nvec2 lnglat_to_mercator(vec2 lnglat) {\n  float x = lnglat.x;\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\n// from Web Mercator to degrees\nvec2 mercator_to_lnglat(vec2 xy) {\n  xy /= WORLD_SCALE;\n  return degrees(vec2(\n    xy.x - PI,\n    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5\n  ));\n}\n/* End projection utils */\n\n// apply desaturation\nvec3 color_desaturate(vec3 color) {\n  float luminance = (color.r + color.g + color.b) * 0.333333333;\n  return mix(color, vec3(luminance), desaturate);\n}\n\n// apply tint\nvec3 color_tint(vec3 color) {\n  return color * tintColor;\n}\n\n// blend with background color\nvec4 apply_opacity(vec3 color, float alpha) {\n  return mix(transparentColor, vec4(color, 1.0), alpha);\n}\n\nvec2 getUV(vec2 pos) {\n  return vec2(\n    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),\n    (pos.y - bounds[3]) / (bounds[1] - bounds[3])\n  );\n}\n\n".concat("\nvec3 packUVsIntoRGB(vec2 uv) {\n  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction\n  vec2 uv8bit = floor(uv * 256.);\n\n  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits\n  // Scale and clamp to 0-1 range\n  vec2 uvFraction = fract(uv * 256.);\n  vec2 uvFraction4bit = floor(uvFraction * 16.);\n\n  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates\n  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;\n\n  return vec3(uv8bit, fractions) / 255.;\n}\n","\n\nvoid main(void) {\n  vec2 uv = vTexCoord;\n  if (coordinateConversion < -0.5) {\n    vec2 lnglat = mercator_to_lnglat(vTexPos);\n    uv = getUV(lnglat);\n  } else if (coordinateConversion > 0.5) {\n    vec2 commonPos = lnglat_to_mercator(vTexPos);\n    uv = getUV(commonPos);\n  }\n  vec4 bitmapColor = texture2D(bitmapTexture, uv);\n\n  gl_FragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);\n\n  geometry.uv = uv;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n\n  if (picking_uActive) {\n    // Since instance information is not used, we can use picking color for pixel index\n    gl_FragColor.rgb = packUVsIntoRGB(uv);\n  }\n}\n"),m={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:i.Df.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]}};class A extends o.Z{getShaders(){return super.getShaders({vs:"\n#define SHADER_NAME bitmap-layer-vertex-shader\n\nattribute vec2 texCoords;\nattribute vec3 positions;\nattribute vec3 positions64Low;\n\nvarying vec2 vTexCoord;\nvarying vec2 vTexPos;\n\nuniform float coordinateConversion;\n\nconst vec3 pickingColor = vec3(1.0, 0.0, 0.0);\n\nvoid main(void) {\n  geometry.worldPosition = positions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = pickingColor;\n\n  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTexCoord = texCoords;\n\n  if (coordinateConversion < -0.5) {\n    vTexPos = geometry.position.xy;\n  } else if (coordinateConversion > 0.5) {\n    vTexPos = geometry.worldPosition.xy;\n  }\n\n  vec4 color = vec4(0.0);\n  DECKGL_FILTER_COLOR(color, geometry);\n}\n",fs:g,modules:[s.Z,a.Z]})}initializeState(){const t=this.getAttributeManager();t.remove(["instancePickingColors"]);const e=!0;t.add({indices:{size:1,isIndexed:!0,update:t=>t.value=this.state.mesh.indices,noAlloc:e},positions:{size:3,type:5130,fp64:this.use64bitPositions(),update:t=>t.value=this.state.mesh.positions,noAlloc:e},texCoords:{size:2,update:t=>t.value=this.state.mesh.texCoords,noAlloc:e}})}updateState({props:t,oldProps:e,changeFlags:n}){if(n.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}const i=this.getAttributeManager();if(t.bounds!==e.bounds){const t=this.state.mesh,e=this._createMesh();this.state.model.setVertexCount(e.vertexCount);for(const n in e)t&&t[n]!==e[n]&&i.invalidate(n);this.setState({mesh:e,...this._getCoordinateUniforms()})}else t._imageCoordinateSystem!==e._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo({info:t}){const{image:e}=this.props;if(!t.color||!e)return t.bitmap=null,t;const{width:n,height:r}=e;t.index=0;const i=function(t){const[e,n,r]=t;return[(e+(15&r)/16)/256,(n+(240&r)/256)/256]}(t.color),o=[Math.floor(i[0]*n),Math.floor(i[1]*r)];return t.bitmap={size:{width:n,height:r},uv:i,pixel:o},t}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(t){super._updateAutoHighlight({...t,color:this.encodePickingColor(0)})}_createMesh(){const{bounds:t}=this.props;let e=t;return Number.isFinite(t[0])&&(e=[[t[0],t[1]],[t[0],t[3]],[t[2],t[3]],[t[2],t[1]]]),function(t,e){if(!e)return function(t){const e=new Float64Array(12);for(let n=0;n<t.length;n++)e[3*n+0]=t[n][0],e[3*n+1]=t[n][1],e[3*n+2]=t[n][2]||0;return{vertexCount:6,positions:e,indices:p,texCoords:f}}(t);const n=Math.max(Math.abs(t[0][0]-t[3][0]),Math.abs(t[1][0]-t[2][0])),r=Math.max(Math.abs(t[1][1]-t[0][1]),Math.abs(t[2][1]-t[3][1])),i=Math.ceil(n/e)+1,o=Math.ceil(r/e)+1,s=(i-1)*(o-1)*6,a=new Uint32Array(s),l=new Float32Array(i*o*2),u=new Float64Array(i*o*3);let c=0,h=0;for(let e=0;e<i;e++){const n=e/(i-1);for(let r=0;r<o;r++){const i=r/(o-1),s=d(t,n,i);u[3*c+0]=s[0],u[3*c+1]=s[1],u[3*c+2]=s[2]||0,l[2*c+0]=n,l[2*c+1]=1-i,e>0&&r>0&&(a[h++]=c-o,a[h++]=c-o-1,a[h++]=c-1,a[h++]=c-o,a[h++]=c-1,a[h++]=c),c++}}return{vertexCount:s,positions:u,indices:a,texCoords:l}}(e,this.context.viewport.resolution)}_getModel(t){return t?new l.Z(t,{...this.getShaders(),id:this.props.id,geometry:new u.Z({drawMode:4,vertexCount:6}),isInstanced:!1}):null}draw(t){const{uniforms:e,moduleParameters:n}=t,{model:r,coordinateConversion:i,bounds:o,disablePicking:s}=this.state,{image:a,desaturate:l,transparentColor:u,tintColor:c}=this.props;n.pickingActive&&s||a&&r&&r.setUniforms(e).setUniforms({bitmapTexture:a,desaturate:l,transparentColor:u.map((t=>t/255)),tintColor:c.slice(0,3).map((t=>t/255)),coordinateConversion:i,bounds:o}).draw()}_getCoordinateUniforms(){const{LNGLAT:t,CARTESIAN:e,DEFAULT:n}=i.Df;let{_imageCoordinateSystem:r}=this.props;if(r!==n){const{bounds:n}=this.props;if(!Number.isFinite(n[0]))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const i=this.context.viewport.resolution?t:e;if(r=r===t?t:e,r===t&&i===e)return{coordinateConversion:-1,bounds:n};if(r===e&&i===t){const t=(0,c.w5)([n[0],n[1]]),e=(0,c.w5)([n[2],n[3]]);return{coordinateConversion:1,bounds:[t[0],t[1],e[0],e[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}A.layerName="BitmapLayer",A.defaultProps=m;var y=n(6867);const _={getSourcePosition:{type:"accessor",value:t=>t.sourcePosition},getTargetPosition:{type:"accessor",value:t=>t.targetPosition},getColor:{type:"accessor",value:[0,0,0,255]},getWidth:{type:"accessor",value:1},widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class v extends o.Z{getShaders(){return super.getShaders({vs:"#define SHADER_NAME line-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 instanceSourcePositions;\nattribute vec3 instanceTargetPositions;\nattribute vec3 instanceSourcePositions64Low;\nattribute vec3 instanceTargetPositions64Low;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\n\nuniform float opacity;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float useShortestPath;\nuniform int widthUnits;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  return dir_screenspace * offset_direction * width / 2.0;\n}\n\nvec3 splitLine(vec3 a, vec3 b, float x) {\n  float t = (x - a.x) / (b.x - a.x);\n  return vec3(x, mix(a.yz, b.yz, t));\n}\n\nvoid main(void) {\n  geometry.worldPosition = instanceSourcePositions;\n  geometry.worldPositionAlt = instanceTargetPositions;\n\n  vec3 source_world = instanceSourcePositions;\n  vec3 target_world = instanceTargetPositions;\n  vec3 source_world_64low = instanceSourcePositions64Low;\n  vec3 target_world_64low = instanceTargetPositions64Low;\n\n  if (useShortestPath > 0.5 || useShortestPath < -0.5) {\n    source_world.x = mod(source_world.x + 180., 360.0) - 180.;\n    target_world.x = mod(target_world.x + 180., 360.0) - 180.;\n    float deltaLng = target_world.x - source_world.x;\n\n    if (deltaLng * useShortestPath > 180.) {\n      source_world.x += 360. * useShortestPath;\n      source_world = splitLine(source_world, target_world, 180. * useShortestPath);\n      source_world_64low = vec3(0.0);\n    } else if (deltaLng * useShortestPath < -180.) {\n      target_world.x += 360. * useShortestPath;\n      target_world = splitLine(source_world, target_world, 180. * useShortestPath);\n      target_world_64low = vec3(0.0);\n    } else if (useShortestPath < 0.) {\n      gl_Position = vec4(0.);\n      return;\n    }\n  }\n  vec4 source_commonspace;\n  vec4 target_commonspace;\n  vec4 source = project_position_to_clipspace(source_world, source_world_64low, vec3(0.), source_commonspace);\n  vec4 target = project_position_to_clipspace(target_world, target_world_64low, vec3(0.), target_commonspace);\n  float segmentIndex = positions.x;\n  vec4 p = mix(source, target, segmentIndex);\n  geometry.position = mix(source_commonspace, target_commonspace, segmentIndex);\n  uv = positions.xy;\n  geometry.uv = uv;\n  geometry.pickingColor = instancePickingColors;\n  float widthPixels = clamp(\n    project_size_to_pixel(instanceWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels\n  );\n  vec3 offset = vec3(\n    getExtrusionOffset(target.xy - source.xy, positions.y, widthPixels),\n    0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n  gl_Position = p + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME line-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[s.Z,a.Z]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1}})}updateState({props:t,oldProps:e,changeFlags:n}){if(super.updateState({props:t,oldProps:e,changeFlags:n}),n.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{widthUnits:e,widthScale:n,widthMinPixels:r,widthMaxPixels:o,wrapLongitude:s}=this.props;this.state.model.setUniforms(t).setUniforms({widthUnits:i.iI[e],widthScale:n,widthMinPixels:r,widthMaxPixels:o,useShortestPath:s?1:0}).draw(),s&&this.state.model.setUniforms({useShortestPath:-1}).draw()}_getModel(t){return new l.Z(t,{...this.getShaders(),id:this.props.id,geometry:new u.Z({drawMode:5,attributes:{positions:new Float32Array([0,-1,0,0,1,0,1,-1,0,1,1,0])}}),isInstanced:!0})}}v.layerName="LineLayer",v.defaultProps=_;var b=n(7693),x=n(8569),w=n(5103),E=n(1167);class S extends w.Z{getGeometry(t){return new E.Z}draw({uniforms:t}){const{elevationScale:e,extruded:n,offset:r,coverage:o,cellSize:s,angle:a,radiusUnits:l}=this.props;this.state.model.setUniforms(t).setUniforms({radius:s/2,radiusUnits:i.iI[l],angle:a,offset:r,extruded:n,coverage:o,elevationScale:e,edgeDistance:1,isWireframe:!1}).draw()}}S.layerName="GridCellLayer",S.defaultProps={cellSize:{type:"number",min:0,value:1e3},offset:{type:"array",min:0,value:[1,1]}};var T=n(2112),P=n(3121),M=n(9026),C=n(5555),I=n(1435),O=n(1290),R=n(1130)},2112:(t,e,n)=>{"use strict";n.d(e,{Z:()=>m});var r=n(4185),i=n(3844),o=n(3117),s=n(744),a=n(4088),l=n(1113),u=n(3982),c=n(8005),h=n(5215);class p extends c.Z{constructor(t){super({...t,attributes:{positions:{size:3,padding:18,initialize:!0,type:t.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}getGeometryFromBuffer(t){return this.normalize?super.getGeometryFromBuffer(t):()=>null}normalizeGeometry(t){return this.normalize?function(t,e,n,r){let i=t;if(Array.isArray(t[0])){const n=t.length*e;i=new Array(n);for(let n=0;n<t.length;n++)for(let r=0;r<e;r++)i[n*e+r]=t[n][r]||0}return n?(0,h.dj)(i,{size:e,gridResolution:n}):r?(0,h.ct)(i,{size:e}):i}(t,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):t}get(t){return this.attributes[t]}getGeometrySize(t){if(Array.isArray(t[0])){let e=0;for(const n of t)e+=this.getGeometrySize(n);return e}const e=this.getPathLength(t);return e<2?0:this.isClosed(t)?e<3?0:e+2:e}updateGeometryAttributes(t,e){if(0!==e.geometrySize)if(t&&Array.isArray(t[0]))for(const n of t){const t=this.getGeometrySize(n);e.geometrySize=t,this.updateGeometryAttributes(n,e),e.vertexStart+=t}else this._updateSegmentTypes(t,e),this._updatePositions(t,e)}_updateSegmentTypes(t,e){const{segmentTypes:n}=this.attributes,r=this.isClosed(t),{vertexStart:i,geometrySize:o}=e;n.fill(0,i,i+o),r?(n[i]=4,n[i+o-2]=4):(n[i]+=1,n[i+o-2]+=2),n[i+o-1]=4}_updatePositions(t,e){const{positions:n}=this.attributes;if(!n)return;const{vertexStart:r,geometrySize:i}=e,o=new Array(3);for(let e=r,s=0;s<i;e++,s++)this.getPointOnPath(t,s,o),n[3*e]=o[0],n[3*e+1]=o[1],n[3*e+2]=o[2]}getPathLength(t){return t.length/this.positionSize}getPointOnPath(t,e,n=[]){const{positionSize:r}=this;e*r>=t.length&&(e+=1-t.length/r);const i=e*r;return n[0]=t[i],n[1]=t[i+1],n[2]=3===r&&t[i+2]||0,n}isClosed(t){if(!this.normalize)return this.opts.loop;const{positionSize:e}=this,n=t.length-e;return t[0]===t[n]&&t[1]===t[n+1]&&(2===e||t[2]===t[n+2])}}const f=[0,0,0,255],d={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:f},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},g={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class m extends r.Z{getShaders(){return super.getShaders({vs:"#define SHADER_NAME path-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute float instanceTypes;\nattribute vec3 instanceStartPositions;\nattribute vec3 instanceEndPositions;\nattribute vec3 instanceLeftPositions;\nattribute vec3 instanceRightPositions;\nattribute vec3 instanceLeftPositions64Low;\nattribute vec3 instanceStartPositions64Low;\nattribute vec3 instanceEndPositions64Low;\nattribute vec3 instanceRightPositions64Low;\nattribute float instanceStrokeWidths;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float capType;\nuniform float miterLimit;\nuniform bool billboard;\nuniform int widthUnits;\n\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nconst float EPSILON = 0.001;\nconst vec3 ZERO_OFFSET = vec3(0.0);\n\nfloat flipIfTrue(bool flag) {\n  return -(float(flag) * 2. - 1.);\n}\nvec3 lineJoin(\n  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,\n  vec2 width\n) {\n  bool isEnd = positions.x > 0.0;\n  float sideOfPath = positions.y;\n  float isJoint = float(sideOfPath == 0.0);\n\n  vec3 deltaA3 = (currPoint - prevPoint);\n  vec3 deltaB3 = (nextPoint - currPoint);\n\n  mat3 rotationMatrix;\n  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);\n  if (needsRotation) {\n    deltaA3 = deltaA3 * rotationMatrix;\n    deltaB3 = deltaB3 * rotationMatrix;\n  }\n  vec2 deltaA = deltaA3.xy / width;\n  vec2 deltaB = deltaB3.xy / width;\n\n  float lenA = length(deltaA);\n  float lenB = length(deltaB);\n\n  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\n  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\n\n  vec2 perpA = vec2(-dirA.y, dirA.x);\n  vec2 perpB = vec2(-dirB.y, dirB.x);\n  vec2 tangent = dirA + dirB;\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\n  vec2 dir = isEnd ? dirA : dirB;\n  vec2 perp = isEnd ? perpA : perpB;\n  float L = isEnd ? lenA : lenB;\n  float sinHalfA = abs(dot(miterVec, perp));\n  float cosHalfA = abs(dot(dirA, miterVec));\n  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);\n  float cornerPosition = sideOfPath * turnDirection;\n\n  float miterSize = 1.0 / max(sinHalfA, EPSILON);\n  miterSize = mix(\n    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),\n    miterSize,\n    step(0.0, cornerPosition)\n  );\n\n  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))\n    * (sideOfPath + isJoint * turnDirection);\n  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));\n  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));\n  bool isCap = isStartCap || isEndCap;\n  if (isCap) {\n    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);\n    vJointType = capType;\n  } else {\n    vJointType = jointType;\n  }\n  vPathLength = L;\n  vCornerOffset = offsetVec;\n  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);\n  vMiterLength = isCap ? isJoint : vMiterLength;\n\n  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);\n  vPathPosition = vec2(\n    dot(offsetFromStartOfPath, perp),\n    dot(offsetFromStartOfPath, dir)\n  );\n  geometry.uv = vPathPosition;\n\n  float isValid = step(instanceTypes, 3.5);\n  vec3 offset = vec3(offsetVec * width * isValid, 0.0);\n\n  if (needsRotation) {\n    offset = rotationMatrix * offset;\n  }\n  return currPoint + offset;\n}\nvoid clipLine(inout vec4 position, vec4 refPosition) {\n  if (position.w < EPSILON) {\n    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\n    position = refPosition + (position - refPosition) * r;\n  }\n}\n\nvoid main() {\n  geometry.pickingColor = instancePickingColors;\n\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n\n  float isEnd = positions.x;\n\n  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\n  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);\n\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\n  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);\n\n  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\n  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);\n\n  geometry.worldPosition = currPosition;\n  vec2 widthPixels = vec2(clamp(\n    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels) / 2.0);\n  vec3 width;\n\n  if (billboard) {\n    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);\n    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);\n    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);\n\n    clipLine(prevPositionScreen, currPositionScreen);\n    clipLine(nextPositionScreen, currPositionScreen);\n    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\n\n    width = vec3(widthPixels, 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec3 pos = lineJoin(\n      prevPositionScreen.xyz / prevPositionScreen.w,\n      currPositionScreen.xyz / currPositionScreen.w,\n      nextPositionScreen.xyz / nextPositionScreen.w,\n      project_pixel_size_to_clipspace(width.xy)\n    );\n\n    gl_Position = vec4(pos * currPositionScreen.w, currPositionScreen.w);\n  } else {\n    prevPosition = project_position(prevPosition, prevPosition64Low);\n    currPosition = project_position(currPosition, currPosition64Low);\n    nextPosition = project_position(nextPosition, nextPosition64Low);\n\n    width = vec3(project_pixel_size(widthPixels), 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec4 pos = vec4(\n      lineJoin(prevPosition, currPosition, nextPosition, width.xy),\n      1.0);\n    geometry.position = pos;\n    gl_Position = project_common_position_to_clipspace(pos);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME path-layer-fragment-shader\n\nprecision highp float;\n\nuniform float miterLimit;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nvoid main(void) {\n  geometry.uv = vPathPosition;\n\n  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {\n    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {\n      discard;\n    }\n    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {\n      discard;\n    }\n  }\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[i.Z,o.Z]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:g,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:g,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:g,defaultValue:f},instancePickingColors:{size:3,type:5121,accessor:(t,{index:e,target:n})=>this.encodePickingColor(t&&t.__source?t.__source.index:e,n)}}),this.setState({pathTesselator:new p({fp64:this.use64bitPositions()})}),this.props.getDashArray&&!this.props.extensions.length&&s.Z.removed("getDashArray","PathStyleExtension")()}updateState({oldProps:t,props:e,changeFlags:n}){super.updateState({props:e,oldProps:t,changeFlags:n});const r=this.getAttributeManager();if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPath)){const{pathTesselator:t}=this.state,i=e.data.attributes||{};t.updateGeometry({data:e.data,geometryBuffer:i.getPath,buffers:i,normalize:!e._pathType,loop:"loop"===e._pathType,getGeometry:e.getPath,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:n.dataChanged}),this.setState({numInstances:t.instanceCount,startIndices:t.vertexStarts}),n.dataChanged||r.invalidateAll()}if(n.extensionsChanged){var i;const{gl:t}=this.context;null===(i=this.state.model)||void 0===i||i.delete(),this.state.model=this._getModel(t),r.invalidateAll()}}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n}=e,{data:r}=this.props;return r[0]&&r[0].__source&&(e.object=r.find((t=>t.__source.index===n))),e}disablePickingIndex(t){const{data:e}=this.props;if(e[0]&&e[0].__source)for(let n=0;n<e.length;n++)e[n].__source.index===t&&this._disablePickingIndex(n);else this._disablePickingIndex(t)}draw({uniforms:t}){const{jointRounded:e,capRounded:n,billboard:r,miterLimit:i,widthUnits:o,widthScale:s,widthMinPixels:l,widthMaxPixels:u}=this.props;this.state.model.setUniforms(t).setUniforms({jointType:Number(e),capType:Number(n),billboard:r,widthUnits:a.iI[o],widthScale:s,miterLimit:i,widthMinPixels:l,widthMaxPixels:u}).draw()}_getModel(t){return new l.Z(t,{...this.getShaders(),id:this.props.id,geometry:new u.Z({drawMode:4,attributes:{indices:new Uint16Array([0,1,2,1,4,2,1,3,4,3,5,4]),positions:{value:new Float32Array([0,0,0,-1,0,1,1,-1,1,1,1,0]),size:2}}}),isInstanced:!0})}calculatePositions(t){const{pathTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("positions")}calculateSegmentTypes(t){const{pathTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("segmentTypes")}}m.layerName="PathLayer",m.defaultProps=d},7693:(t,e,n)=>{"use strict";n.d(e,{Z:()=>f});var r=n(4185),i=n(3844),o=n(7287),s=n(3117),a=n(4088),l=n(1113),u=n(3982);const c=[0,0,0,255],h=[0,0,1],p={sizeUnits:"pixels",pointSize:{type:"number",min:0,value:10},getPosition:{type:"accessor",value:t=>t.position},getNormal:{type:"accessor",value:h},getColor:{type:"accessor",value:c},material:!0,radiusPixels:{deprecatedFor:"pointSize"}};class f extends r.Z{getShaders(){return super.getShaders({vs:"#define SHADER_NAME point-cloud-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 instanceNormals;\nattribute vec4 instanceColors;\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusPixels;\nuniform int sizeUnits;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.normal = project_normal(instanceNormals);\n  unitPosition = positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n  vec3 offset = vec3(positions.xy * project_size_to_pixel(radiusPixels, sizeUnits), 0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n\n  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.), geometry.position);\n  gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vec3 lightColor = lighting_getLightColor(instanceColors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);\n  vColor = vec4(lightColor, instanceColors.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME point-cloud-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition);\n\n  if (distToCenter > 1.0) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[i.Z,o.N,s.Z]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceNormals:{size:3,transition:!0,accessor:"getNormal",defaultValue:h},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:c}})}updateState({props:t,oldProps:e,changeFlags:n}){if(super.updateState({props:t,oldProps:e,changeFlags:n}),n.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}n.dataChanged&&function(t){const{header:e,attributes:n}=t;e&&n&&(t.length=e.vertexCount,n.POSITION&&(n.instancePositions=n.POSITION),n.NORMAL&&(n.instanceNormals=n.NORMAL),n.COLOR_0&&(n.instanceColors=n.COLOR_0))}(t.data)}draw({uniforms:t}){const{pointSize:e,sizeUnits:n}=this.props;this.state.model.setUniforms(t).setUniforms({sizeUnits:a.iI[n],radiusPixels:e}).draw()}_getModel(t){const e=[];for(let t=0;t<3;t++){const n=t/3*Math.PI*2;e.push(2*Math.cos(n),2*Math.sin(n),0)}return new l.Z(t,{...this.getShaders(),id:this.props.id,geometry:new u.Z({drawMode:4,attributes:{positions:new Float32Array(e)}}),isInstanced:!0})}}f.layerName="PointCloudLayer",f.defaultProps=p},3121:(t,e,n)=>{"use strict";n.d(e,{Z:()=>p});var r=n(8918),i=n(744),o=n(8550),s=n(1435),a=n(2112),l=n(9890),u=n(8452);const c=[0,0,0,255],h={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:t=>t.polygon},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:c},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};class p extends r.Z{initializeState(){this.state={paths:[]},this.props.getLineDashArray&&i.Z.removed("getLineDashArray","PathStyleExtension")()}updateState({oldProps:t,props:e,changeFlags:n}){const r=n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon);if(r&&Array.isArray(n.dataChanged)){const t=this.state.paths.slice(),e=n.dataChanged.map((e=>(0,u.b)({data:t,getIndex:t=>t.__source.index,dataRange:e,replace:this._getPaths(e)})));this.setState({paths:t,pathsDiff:e})}else r&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(t={}){const{data:e,getPolygon:n,positionFormat:r,_normalize:i}=this.props,s=[],a="XY"===r?2:3,{startRow:u,endRow:c}=t,{iterable:h,objectInfo:p}=(0,o.jB)(e,u,c);for(const t of h){p.index++;let e=n(t,p);i&&(e=l.F(e,a));const{holeIndices:r}=e,o=e.positions||e;if(r)for(let e=0;e<=r.length;e++){const n=o.slice(r[e-1]||0,r[e]||o.length);s.push(this.getSubLayerRow({path:n},t,p.index))}else s.push(this.getSubLayerRow({path:o},t,p.index))}return s}renderLayers(){const{data:t,_dataDiff:e,stroked:n,filled:r,extruded:i,wireframe:o,_normalize:l,_windingOrder:u,elevationScale:h,transitions:p,positionFormat:f}=this.props,{lineWidthUnits:d,lineWidthScale:g,lineWidthMinPixels:m,lineWidthMaxPixels:A,lineJointRounded:y,lineMiterLimit:_,lineDashJustified:v}=this.props,{getFillColor:b,getLineColor:x,getLineWidth:w,getLineDashArray:E,getElevation:S,getPolygon:T,updateTriggers:P,material:M}=this.props,{paths:C,pathsDiff:I}=this.state,O=this.getSubLayerClass("fill",s.Z),R=this.getSubLayerClass("stroke",a.Z),L=this.shouldRenderSubLayer("fill",C)&&new O({_dataDiff:e,extruded:i,elevationScale:h,filled:r,wireframe:o,_normalize:l,_windingOrder:u,getElevation:S,getFillColor:b,getLineColor:i&&o?x:c,material:M,transitions:p},this.getSubLayerProps({id:"fill",updateTriggers:{getPolygon:P.getPolygon,getElevation:P.getElevation,getFillColor:P.getFillColor,lineColors:i&&o,getLineColor:P.getLineColor}}),{data:t,positionFormat:f,getPolygon:T});return[!i&&L,!i&&n&&this.shouldRenderSubLayer("stroke",C)&&new R({_dataDiff:I&&(()=>I),widthUnits:d,widthScale:g,widthMinPixels:m,widthMaxPixels:A,jointRounded:y,miterLimit:_,dashJustified:v,_pathType:"loop",transitions:p&&{getWidth:p.getLineWidth,getColor:p.getLineColor,getPath:p.getPolygon},getColor:this.getSubLayerAccessor(x),getWidth:this.getSubLayerAccessor(w),getDashArray:this.getSubLayerAccessor(E)},this.getSubLayerProps({id:"stroke",updateTriggers:{getWidth:P.getLineWidth,getColor:P.getLineColor,getDashArray:P.getLineDashArray}}),{data:C,positionFormat:f,getPath:t=>t.path}),i&&L]}}p.layerName="PolygonLayer",p.defaultProps=h},8569:(t,e,n)=>{"use strict";n.d(e,{Z:()=>h});var r=n(4185),i=n(3844),o=n(3117),s=n(4088),a=n(1113),l=n(3982);const u=[0,0,0,255],c={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:u},getLineColor:{type:"accessor",value:u},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class h extends r.Z{getShaders(){return super.getShaders({vs:"#define SHADER_NAME scatterplot-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceRadius;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float lineWidthScale;\nuniform float lineWidthMinPixels;\nuniform float lineWidthMaxPixels;\nuniform float stroked;\nuniform bool filled;\nuniform bool billboard;\nuniform int radiusUnits;\nuniform int lineWidthUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  outerRadiusPixels = clamp(\n    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),\n    radiusMinPixels, radiusMaxPixels\n  );\n  float lineWidthPixels = clamp(\n    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),\n    lineWidthMinPixels, lineWidthMaxPixels\n  );\n  outerRadiusPixels += stroked * lineWidthPixels / 2.0;\n  unitPosition = positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n\n  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;\n  \n  if (billboard) {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = positions * outerRadiusPixels;\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset = positions * project_pixel_size(outerRadiusPixels);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\n  }\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME scatterplot-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool filled;\nuniform float stroked;\nuniform bool antialiasing;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition) * outerRadiusPixels;\n  float inCircle = antialiasing ? \n    smoothedge(distToCenter, outerRadiusPixels) : \n    step(distToCenter, outerRadiusPixels);\n\n  if (inCircle == 0.0) {\n    discard;\n  }\n\n  if (stroked > 0.5) {\n    float isLine = antialiasing ? \n      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :\n      step(innerUnitRadius * outerRadiusPixels, distToCenter);\n\n    if (filled) {\n      gl_FragColor = mix(vFillColor, vLineColor, isLine);\n    } else {\n      if (isLine == 0.0) {\n        discard;\n      }\n      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n    }\n  } else if (filled) {\n    gl_FragColor = vFillColor;\n  } else {\n    discard;\n  }\n\n  gl_FragColor.a *= inCircle;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[i.Z,o.Z]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState({props:t,oldProps:e,changeFlags:n}){if(super.updateState({props:t,oldProps:e,changeFlags:n}),n.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{radiusUnits:e,radiusScale:n,radiusMinPixels:r,radiusMaxPixels:i,stroked:o,filled:a,billboard:l,antialiasing:u,lineWidthUnits:c,lineWidthScale:h,lineWidthMinPixels:p,lineWidthMaxPixels:f}=this.props;this.state.model.setUniforms(t).setUniforms({stroked:o?1:0,filled:a,billboard:l,antialiasing:u,radiusUnits:s.iI[e],radiusScale:n,radiusMinPixels:r,radiusMaxPixels:i,lineWidthUnits:s.iI[c],lineWidthScale:h,lineWidthMinPixels:p,lineWidthMaxPixels:f}).draw()}_getModel(t){return new a.Z(t,{...this.getShaders(),id:this.props.id,geometry:new l.Z({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0])}}}),isInstanced:!0})}}h.layerName="ScatterplotLayer",h.defaultProps=c},9890:(t,e,n)=>{"use strict";n.d(e,{F:()=>h,m:()=>p});var r=n(9187),i=n.n(r),o=n(5215);const s=o.wG.CLOCKWISE,a=o.wG.COUNTER_CLOCKWISE,l={isClosed:!0};function u(t,e,n,r,i){let s=e;const a=n.length;for(let e=0;e<a;e++)for(let i=0;i<r;i++)t[s++]=n[e][i]||0;if(!function(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}(n))for(let e=0;e<r;e++)t[s++]=n[0][e]||0;return l.start=e,l.end=s,l.size=r,(0,o.Ny)(t,i,l),s}function c(t,e,n,r,i=0,s,a){const u=(s=s||n.length)-i;if(u<=0)return e;let c=e;for(let e=0;e<u;e++)t[c++]=n[i+e];if(!function(t,e,n,r){for(let i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}(n,r,i,s))for(let e=0;e<r;e++)t[c++]=n[i+e];return l.start=e,l.end=c,l.size=r,(0,o.Ny)(t,a,l),c}function h(t,e){!function(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}(t);const n=[],r=[];if(t.positions){const{positions:i,holeIndices:o}=t;if(o){let t=0;for(let l=0;l<=o.length;l++)t=c(n,t,i,e,o[l-1],o[l],0===l?s:a),r.push(t);return r.pop(),{positions:n,holeIndices:r}}t=i}if(Number.isFinite(t[0]))return c(n,0,t,e,0,n.length,s),n;if(!function(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}(t)){let i=0;for(const[o,l]of t.entries())i=u(n,i,l,e,0===o?s:a),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return u(n,0,t,e,s),n}function p(t,e,n){let r=null;t.holeIndices&&(r=t.holeIndices.map((t=>t/e)));let o=t.positions||t;if(n){const t=o.length;o=o.slice();const r=[];for(let i=0;i<t;i+=e){r[0]=o[i],r[1]=o[i+1];const t=n(r);o[i]=t[0],o[i+1]=t[1]}}return i()(o,r,e)}},1435:(t,e,n)=>{"use strict";n.d(e,{Z:()=>x});var r=n(4185),i=n(3844),o=n(7287),s=n(3117),a=n(4088),l=n(4211),u=n(6948),c=n(1113),h=n(3982),p=n(9890),f=n(8005),d=n(5215);class g extends f.Z{constructor(t){const{fp64:e,IndexType:n=Uint32Array}=t;super({...t,attributes:{positions:{size:3,type:e?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:n,size:1}}})}get(t){const{attributes:e}=this;return"indices"===t?e.indices&&e.indices.subarray(0,this.vertexCount):e[t]}updateGeometry(t){super.updateGeometry(t);const e=this.buffers.indices;e&&(this.vertexCount=(e.value||e).length)}normalizeGeometry(t){if(this.normalize){if(t=p.F(t,this.positionSize),this.opts.resolution)return(0,d.WZ)(t.positions||t,t.holeIndices,{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0});if(this.opts.wrapLongitude)return(0,d.GU)(t.positions||t,t.holeIndices,{size:this.positionSize,maxLatitude:86,edgeTypes:!0})}return t}getGeometrySize(t){if(Array.isArray(t)&&!Number.isFinite(t[0])){let e=0;for(const n of t)e+=this.getGeometrySize(n);return e}return(t.positions||t).length/this.positionSize}getGeometryFromBuffer(t){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(t):()=>null}updateGeometryAttributes(t,e){if(Array.isArray(t)&&!Number.isFinite(t[0]))for(const n of t){const t=this.getGeometrySize(n);e.geometrySize=t,this.updateGeometryAttributes(n,e),e.vertexStart+=t,e.indexStart=this.indexStarts[e.geometryIndex+1]}else this._updateIndices(t,e),this._updatePositions(t,e),this._updateVertexValid(t,e)}_updateIndices(t,{geometryIndex:e,vertexStart:n,indexStart:r}){const{attributes:i,indexStarts:o,typedArrayManager:s}=this;let a=i.indices;if(!a)return;let l=r;const u=p.m(t,this.positionSize,this.opts.preproject);a=s.allocate(a,r+u.length,{copy:!0});for(let t=0;t<u.length;t++)a[l++]=u[t]+n;o[e+1]=r+u.length,i.indices=a}_updatePositions(t,{vertexStart:e,geometrySize:n}){const{attributes:{positions:r},positionSize:i}=this;if(!r)return;const o=t.positions||t;for(let t=e,s=0;s<n;t++,s++){const e=o[s*i],n=o[s*i+1],a=i>2?o[s*i+2]:0;r[3*t]=e,r[3*t+1]=n,r[3*t+2]=a}}_updateVertexValid(t,{vertexStart:e,geometrySize:n}){const{attributes:{vertexValid:r},positionSize:i}=this,o=t&&t.holeIndices;if(t&&t.edgeTypes?r.set(t.edgeTypes,e):r.fill(1,e,e+n),o)for(let t=0;t<o.length;t++)r[e+o[t]/i-1]=0;r[e+n-1]=0}}const m="\nattribute vec2 vertexPositions;\nattribute float vertexValid;\n\nuniform bool extruded;\nuniform bool isWireframe;\nuniform float elevationScale;\nuniform float opacity;\n\nvarying vec4 vColor;\n\nstruct PolygonProps {\n  vec4 fillColors;\n  vec4 lineColors;\n  vec3 positions;\n  vec3 nextPositions;\n  vec3 pickingColors;\n  vec3 positions64Low;\n  vec3 nextPositions64Low;\n  float elevations;\n};\n\nvec3 project_offset_normal(vec3 vector) {\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    return normalize(vector * project_uCommonUnitsPerWorldUnit);\n  }\n  return project_normal(vector);\n}\n\nvoid calculatePosition(PolygonProps props) {\n#ifdef IS_SIDE_VERTEX\n  if(vertexValid < 0.5){\n    gl_Position = vec4(0.);\n    return;\n  }\n#endif\n\n  vec3 pos;\n  vec3 pos64Low;\n  vec3 normal;\n  vec4 colors = isWireframe ? props.lineColors : props.fillColors;\n\n  geometry.worldPosition = props.positions;\n  geometry.worldPositionAlt = props.nextPositions;\n  geometry.pickingColor = props.pickingColors;\n\n#ifdef IS_SIDE_VERTEX\n  pos = mix(props.positions, props.nextPositions, vertexPositions.x);\n  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);\n#else\n  pos = props.positions;\n  pos64Low = props.positions64Low;\n#endif\n\n  if (extruded) {\n    pos.z += props.elevations * vertexPositions.y * elevationScale;\n\n#ifdef IS_SIDE_VERTEX\n    normal = vec3(\n      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),\n      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),\n      0.0);\n    normal = project_offset_normal(normal);\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n    geometry.normal = normal;\n  }\n\n  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  if (extruded) {\n    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);\n    vColor = vec4(lightColor, colors.a * opacity);\n  } else {\n    vColor = vec4(colors.rgb, colors.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",A="#define SHADER_NAME solid-polygon-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 positions64Low;\nattribute float elevations;\nattribute vec4 fillColors;\nattribute vec4 lineColors;\nattribute vec3 pickingColors;\n\n".concat(m,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  props.positions = positions;\n  props.positions64Low = positions64Low;\n  props.elevations = elevations;\n  props.fillColors = fillColors;\n  props.lineColors = lineColors;\n  props.pickingColors = pickingColors;\n\n  calculatePosition(props);\n}\n"),y="#define SHADER_NAME solid-polygon-layer-vertex-shader-side\n#define IS_SIDE_VERTEX\n\n\nattribute vec3 instancePositions;\nattribute vec3 nextPositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 nextPositions64Low;\nattribute float instanceElevations;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\n".concat(m,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  #if RING_WINDING_ORDER_CW == 1\n    props.positions = instancePositions;\n    props.positions64Low = instancePositions64Low;\n    props.nextPositions = nextPositions;\n    props.nextPositions64Low = nextPositions64Low;\n  #else\n    props.positions = nextPositions;\n    props.positions64Low = nextPositions64Low;\n    props.nextPositions = instancePositions;\n    props.nextPositions64Low = instancePositions64Low;\n  #endif\n  props.elevations = instanceElevations;\n  props.fillColors = instanceFillColors;\n  props.lineColors = instanceLineColors;\n  props.pickingColors = instancePickingColors;\n\n  calculatePosition(props);\n}\n"),_=[0,0,0,255],v={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:_},getLineColor:{type:"accessor",value:_},material:!0},b={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class x extends r.Z{getShaders(t){return super.getShaders({vs:"top"===t?A:y,fs:"#define SHADER_NAME solid-polygon-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",defines:{RING_WINDING_ORDER_CW:this.props._normalize||"CCW"!==this.props._windingOrder?1:0},modules:[i.Z,o.N,s.Z]})}get wrapLongitude(){return!1}initializeState(){const{gl:t,viewport:e}=this.context;let{coordinateSystem:n}=this.props;e.isGeospatial&&n===a.Df.DEFAULT&&(n=a.Df.LNGLAT),this.setState({numInstances:0,polygonTesselator:new g({preproject:n===a.Df.LNGLAT&&e.projectFlat,fp64:this.use64bitPositions(),IndexType:!t||(0,l.ag)(t,u.h.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const r=this.getAttributeManager(),i=!0;r.remove(["instancePickingColors"]),r.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:i},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:b,accessor:"getPolygon",update:this.calculatePositions,noAlloc:i,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:i},elevations:{size:1,transition:b,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{alias:"colors",size:this.props.colorFormat.length,type:5121,normalized:!0,transition:b,accessor:"getFillColor",defaultValue:_,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{alias:"colors",size:this.props.colorFormat.length,type:5121,normalized:!0,transition:b,accessor:"getLineColor",defaultValue:_,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(t,{index:e,target:n})=>this.encodePickingColor(t&&t.__source?t.__source.index:e,n),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n}=e,{data:r}=this.props;return r[0]&&r[0].__source&&(e.object=r.find((t=>t.__source.index===n))),e}disablePickingIndex(t){const{data:e}=this.props;if(e[0]&&e[0].__source)for(let n=0;n<e.length;n++)e[n].__source.index===t&&this._disablePickingIndex(n);else this._disablePickingIndex(t)}draw({uniforms:t}){const{extruded:e,filled:n,wireframe:r,elevationScale:i}=this.props,{topModel:o,sideModel:s,polygonTesselator:a}=this.state,l={...t,extruded:Boolean(e),elevationScale:i};s&&(s.setInstanceCount(a.instanceCount-1),s.setUniforms(l),r&&(s.setDrawMode(3),s.setUniforms({isWireframe:!0}).draw()),n&&(s.setDrawMode(6),s.setUniforms({isWireframe:!1}).draw())),o&&(o.setVertexCount(a.vertexCount),o.setUniforms(l).draw())}updateState(t){super.updateState(t),this.updateGeometry(t);const{props:e,oldProps:n,changeFlags:r}=t,i=this.getAttributeManager();var o;(r.extensionsChanged||e.filled!==n.filled||e.extruded!==n.extruded)&&(null===(o=this.state.models)||void 0===o||o.forEach((t=>t.delete())),this.setState(this._getModels(this.context.gl)),i.invalidateAll())}updateGeometry({props:t,oldProps:e,changeFlags:n}){if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon)){const{polygonTesselator:e}=this.state,r=t.data.attributes||{};e.updateGeometry({data:t.data,normalize:t._normalize,geometryBuffer:r.getPolygon,buffers:r,getGeometry:t.getPolygon,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:n.dataChanged}),this.setState({numInstances:e.instanceCount,startIndices:e.vertexStarts}),n.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(t){const{id:e,filled:n,extruded:r}=this.props;let i,o;if(n){const n=this.getShaders("top");n.defines.NON_INSTANCED_MODEL=1,i=new c.Z(t,{...n,id:"".concat(e,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return r&&(o=new c.Z(t,{...this.getShaders("side"),id:"".concat(e,"-side"),geometry:new h.Z({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),o.userData.excludeAttributes={indices:!0}),{models:[o,i].filter(Boolean),topModel:i,sideModel:o}}calculateIndices(t){const{polygonTesselator:e}=this.state;t.startIndices=e.indexStarts,t.value=e.get("indices")}calculatePositions(t){const{polygonTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("positions")}calculateVertexValid(t){t.value=this.state.polygonTesselator.get("vertexValid")}}x.layerName="SolidPolygonLayer",x.defaultProps=v},1290:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(744),i=n(6867);const o=[];class s extends i.Z{getShaders(){return{...super.getShaders(),fs:"#define SHADER_NAME multi-icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float gamma;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform float buffer;\nuniform float outlineBuffer;\nuniform vec4 outlineColor;\n\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  if (!picking_uActive) {\n    float alpha = texture2D(iconsTexture, vTextureCoords).a;\n    vec4 color = vColor;\n    if (sdf) {\n      float distance = alpha;\n      alpha = smoothstep(buffer - gamma, buffer + gamma, distance);\n\n      if (outlineBuffer > 0.0) {\n        float inFill = alpha;\n        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);\n        color = mix(outlineColor, vColor, inFill);\n        alpha = inBorder;\n      }\n    }\n    float a = alpha * color.a;\n    \n    if (a < alphaCutoff) {\n      discard;\n    }\n\n    gl_FragColor = vec4(color.rgb, a * opacity);\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n"}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(t,{index:e,target:n})=>this.encodePickingColor(e,n)}})}updateState(t){super.updateState(t);const{props:e,oldProps:n}=t;let{outlineColor:i}=e;i!==n.outlineColor&&(i=i.map((t=>t/255)),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!e.sdf&&e.outlineWidth&&r.Z.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(t){const{sdf:e,smoothing:n,outlineWidth:r}=this.props,{outlineColor:i}=this.state;t.uniforms={...t.uniforms,buffer:.75,outlineBuffer:r?Math.max(n,.75*(1-r)):-1,gamma:n,sdf:Boolean(e),outlineColor:i},super.draw(t)}getInstanceOffset(t){return t?Array.from(t).map((t=>super.getInstanceOffset(t))):o}getInstanceColorMode(t){return 1}getInstanceIconFrame(t){return t?Array.from(t).map((t=>super.getInstanceIconFrame(t))):o}}s.layerName="MultiIconLayer",s.defaultProps={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}}},1130:(t,e,n)=>{"use strict";n.d(e,{Z:()=>c});var r=n(4185),i=n(3844),o=n(3117),s=n(4088),a=n(1113),l=n(3982);const u={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class c extends r.Z{getShaders(){return super.getShaders({vs:"#define SHADER_NAME text-background-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceRects;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec2 instancePixelOffsets;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform bool billboard;\nuniform float opacity;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform vec4 padding;\nuniform int sizeUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = radians(angle);\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n  vLineWidth = instanceLineWidths;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),\n    sizeMinPixels, sizeMaxPixels\n  );\n\n  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;\n\n  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\n  pixelOffset += instancePixelOffsets;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME text-background-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool stroked;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec2 pixelPosition = uv * dimensions;\n  if (stroked) {\n    float distToEdge = min(\n      min(pixelPosition.x, dimensions.x - pixelPosition.x),\n      min(pixelPosition.y, dimensions.y - pixelPosition.y)\n    );\n    float isBorder = smoothedge(distToEdge, vLineWidth);\n    gl_FragColor = mix(vFillColor, vLineColor, isBorder);\n  } else {\n    gl_FragColor = vFillColor;\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[i.Z,o.Z]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState({props:t,oldProps:e,changeFlags:n}){if(super.updateState({props:t,oldProps:e,changeFlags:n}),n.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{billboard:e,sizeScale:n,sizeUnits:r,sizeMinPixels:i,sizeMaxPixels:o,getLineWidth:a}=this.props;let{padding:l}=this.props;l.length<4&&(l=[l[0],l[1],l[0],l[1]]),this.state.model.setUniforms(t).setUniforms({billboard:e,stroked:Boolean(a),padding:l,sizeUnits:s.iI[r],sizeScale:n,sizeMinPixels:i,sizeMaxPixels:o}).draw()}_getModel(t){return new a.Z(t,{...this.getShaders(),id:this.props.id,geometry:new l.Z({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array([0,0,1,0,1,1,0,1])}}}),isInstanced:!0})}}c.layerName="TextBackgroundLayer",c.defaultProps=u},5555:(t,e,n)=>{"use strict";n.d(e,{Z:()=>I});var r=n(8918),i=n(8550),o=n(1290),s=n(9296),a=n.n(s),l=n(744);const u=[];function c(t,e,n,r){let i=0;for(let o=e;o<n;o++){const e=t[o];let n=null;const s=r&&r[e];s&&(n=s.width),i+=n}return i}function h(t,e,n,r,i,o){let s=e,a=0;for(let l=e;l<n;l++){const e=c(t,l,l+1,i);a+e>r&&(s<l&&o.push(l),s=l,a=0),a+=e}return a}function p(t,e,n,r,i=0,o){void 0===o&&(o=t.length);const s=[];return"break-all"===e?h(t,i,o,n,r,s):function(t,e,n,r,i,o){let s=e,a=e,l=e,u=0;for(let p=e;p<n;p++)if(" "===t[p]?l=p+1:" "!==t[p+1]&&p+1!==n||(l=p+1),l>a){let e=c(t,a,l,i);u+e>r&&(s<a&&(o.push(a),s=a,u=0),e>r&&(e=h(t,a,l,r,i,o),s=o[o.length-1])),a=l,u+=e}}(t,i,o,n,r,s),s}function f(t,e,n,r,i,o){let s=0,a=0;for(let o=e;o<n;o++){const e=t[o],n=r[e];n?(a||(a=n.height),i[o]=s+n.width/2,s+=n.width):(l.Z.warn("Missing character: ".concat(e," (").concat(e.codePointAt(0),")"))(),i[o]=s,s+=32)}o[0]=s,o[1]=a}function d(t,e,n,r,i){const o=(t=Array.from(t)).length,s=new Array(o),a=new Array(o),l=new Array(o),c=("break-word"===n||"break-all"===n)&&isFinite(r)&&r>0,h=[0,0],d=[];let g=0,m=0,A=0;for(let y=0;y<=o;y++){const _=t[y];if("\n"!==_&&y!==o||(A=y),A>m){const o=c?p(t,n,r,i,m,A):u;for(let n=0;n<=o.length;n++){const r=0===n?m:o[n-1],u=n<o.length?o[n]:A;f(t,r,u,i,s,d);for(let t=r;t<u;t++)a[t]=g+d[1]/2,l[t]=d[0];g+=d[1]*e,h[0]=Math.max(h[0],d[0])}m=A}"\n"===_&&(s[m]=0,a[m]=0,l[m]=0,m++)}return h[1]=g,{x:s,y:a,rowWidth:l,size:h}}const g=function(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}(),m="Monaco, monospace",A="normal",y=new class{constructor(t=5){this.limit=t,this.clear()}clear(){this._cache={},this._order=[]}get(t){const e=this._cache[t];return e&&(this._deleteOrder(t),this._appendOrder(t)),e}set(t,e){this._cache[t]?(this.delete(t),this._cache[t]=e,this._appendOrder(t)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[t]=e,this._appendOrder(t))}delete(t){this._cache[t]&&(this._deleteCache(t),this._deleteOrder(t))}_deleteCache(t){delete this._cache[t]}_deleteOrder(t){const e=this._order.findIndex((e=>e===t));e>=0&&this._order.splice(e,1)}_appendOrder(t){this._order.push(t)}}(3),_=["fontFamily","fontWeight","characterSet","fontSize","sdf","buffer","cutoff","radius"];function v(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function b(t,e,n,r){t.font="".concat(r," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="baseline",t.textAlign="left"}class x{constructor(){this.props={fontFamily:m,fontWeight:A,characterSet:g,fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12},this._key=null,this._atlas=null}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){return 1.2}setProps(t={}){_.forEach((e=>{e in t&&(this.props[e]=t[e])}));const e=this._key;this._key=this._getKey();const n=function(t,e){const n=y.get(t);if(!n)return e;const r=[],i=n.mapping;let o=Object.keys(i);o=new Set(o);let s=e;return s instanceof Array&&(s=new Set(s)),s.forEach((t=>{o.has(t)||r.push(t)})),r}(this._key,this.props.characterSet),r=y.get(this._key);if(r&&0===n.length)return void(this._key!==e&&(this._atlas=r));const i=this._generateFontAtlas(this._key,n,r);this._atlas=i,y.set(this._key,i)}_generateFontAtlas(t,e,n){const{fontFamily:r,fontWeight:i,fontSize:o,buffer:s,sdf:l,radius:u,cutoff:c}=this.props;let h=n&&n.data;h||(h=document.createElement("canvas"),h.width=1024);const p=h.getContext("2d");b(p,r,o,i);const{mapping:f,canvasHeight:d,xOffset:g,yOffset:m}=function({characterSet:t,getFontWidth:e,fontHeight:n,buffer:r,maxCanvasWidth:i,mapping:o={},xOffset:s=0,yOffset:a=0}){let l=0,u=s,c=0;for(const s of t)if(!o[s]){const t=e(s,c++);u+t+2*r>i&&(u=0,l++),o[s]={x:u+r,y:a+l*(n+2*r)+r,width:t,height:n},u+=t+2*r}const h=n+2*r;return{mapping:o,xOffset:u,yOffset:a+l*h,canvasHeight:(p=a+(l+1)*h,Math.pow(2,Math.ceil(Math.log2(p))))};var p}({getFontWidth:t=>p.measureText(t).width,fontHeight:1.2*o,buffer:s,characterSet:e,maxCanvasWidth:1024,...n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset}});if(h.height!==d){const t=p.getImageData(0,0,h.width,h.height);h.height=d,p.putImageData(t,0,0)}if(b(p,r,o,i),l){const t=new(a())(o,s,u,c,r,i),n=p.getImageData(0,0,t.size,t.size);for(const r of e)v(t.draw(r),n),p.putImageData(n,f[r].x-s,f[r].y+s)}else for(const t of e)p.fillText(t,f[t].x,f[t].y+.9*o);return{xOffset:g,yOffset:m,mapping:f,data:h,width:h.width,height:h.height}}_getKey(){const{fontFamily:t,fontWeight:e,fontSize:n,buffer:r,sdf:i,radius:o,cutoff:s}=this.props;return i?"".concat(t," ").concat(e," ").concat(n," ").concat(r," ").concat(o," ").concat(s):"".concat(t," ").concat(e," ").concat(n," ").concat(r)}}var w=n(1130);const E={fontSize:64,buffer:4,sdf:!1,radius:12,cutoff:.25,smoothing:.1},S={start:1,middle:0,end:-1},T={top:1,center:0,bottom:-1},P=[0,0,0,255],M=["fontSize","buffer","sdf","radius","cutoff"],C={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:P},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:g},fontFamily:m,fontWeight:A,lineHeight:1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:P},fontSettings:{},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:P},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class I extends r.Z{initializeState(){this.state={styleVersion:0,fontAtlasManager:new x}}updateState({props:t,oldProps:e,changeFlags:n}){const r=n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getText),i=this.state.characterSet;r&&this._updateText();const o=i!==this.state.characterSet||this._fontChanged(e,t);o&&this._updateFontAtlas(e,t),(o||t.lineHeight!==e.lineHeight||t.wordBreak!==e.wordBreak||t.maxWidth!==e.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:t}){return t.object=t.index>=0?this.props.data[t.index]:null,t}_updateFontAtlas(t,e){const{fontSettings:n,fontFamily:r,fontWeight:i}=e,{fontAtlasManager:o,characterSet:s}=this.state;o.setProps({...E,...n,characterSet:s,fontFamily:r,fontWeight:i})}_fontChanged(t,e){if(t.fontFamily!==e.fontFamily||t.fontWeight!==e.fontWeight)return!0;if(t.fontSettings===e.fontSettings)return!1;const n=t.fontSettings||{},r=e.fontSettings||{};return M.some((t=>n[t]!==r[t]))}_updateText(){const{data:t,characterSet:e}=this.props,n=t.attributes&&t.attributes.getText;let r,{getText:o}=this.props,{startIndices:s}=t;const a="auto"===e&&new Set;if(n&&s){const{texts:e,characterCount:i}=function({value:t,length:e,stride:n,offset:r,startIndices:i,characterSet:o}){const s=t.BYTES_PER_ELEMENT,a=n?n/s:1,l=r?r/s:0,u=i[e]||Math.ceil((t.length-l)/a),c=o&&new Set,h=new Array(e);let p=t;if(a>1||l>0){p=new t.constructor(u);for(let e=0;e<u;e++)p[e]=t[e*a+l]}for(let t=0;t<e;t++){const e=i[t],n=i[t+1]||u,r=p.subarray(e,n);h[t]=String.fromCodePoint.apply(null,r),c&&r.forEach(c.add,c)}if(c)for(const t of c)o.add(String.fromCodePoint(t));return{texts:h,characterCount:u}}({...ArrayBuffer.isView(n)?{value:n}:n,length:t.length,startIndices:s,characterSet:a});r=i,o=(t,{index:n})=>e[n]}else{const{iterable:e,objectInfo:n}=(0,i.jB)(t);s=[0],r=0;for(const t of e){n.index++;const e=Array.from(o(t,n)||"");a&&e.forEach(a.add,a),r+=e.length,s.push(r)}}this.setState({getText:o,startIndices:s,numInstances:r,characterSet:a||e})}getBoundingRect(t,e){const n=this.state.fontAtlasManager.mapping,{getText:r}=this.state,{wordBreak:i,maxWidth:o,lineHeight:s,getTextAnchor:a,getAlignmentBaseline:l}=this.props,u=r(t,e)||"",{size:[c,h]}=d(u,s,i,o,n);return[(S["function"==typeof a?a(t,e):a]-1)*c/2,(T["function"==typeof l?l(t,e):l]-1)*h/2,c,h]}getIconOffsets(t,e){const n=this.state.fontAtlasManager.mapping,{getText:r}=this.state,{wordBreak:i,maxWidth:o,lineHeight:s,getTextAnchor:a,getAlignmentBaseline:l}=this.props,u=r(t,e)||"",{x:c,y:h,rowWidth:p,size:[f,g]}=d(u,s,i,o,n),m=S["function"==typeof a?a(t,e):a],A=T["function"==typeof l?l(t,e):l],y=c.length,_=new Array(2*y);let v=0;for(let t=0;t<y;t++){const e=(1-m)*(f-p[t])/2;_[v++]=(m-1)*f/2+e+c[t],_[v++]=(A-1)*g/2+h[t]}return _}renderLayers(){const{startIndices:t,numInstances:e,getText:n,fontAtlasManager:{scale:r,texture:i,mapping:s},styleVersion:a}=this.state,{data:l,_dataDiff:u,getPosition:c,getColor:h,getSize:p,getAngle:f,getPixelOffset:d,getBackgroundColor:g,getBorderColor:m,getBorderWidth:A,backgroundPadding:y,background:_,billboard:v,fontSettings:b,outlineWidth:x,outlineColor:S,sizeScale:T,sizeUnits:P,sizeMinPixels:M,sizeMaxPixels:C,transitions:I,updateTriggers:O}=this.props,R=this.getSubLayerClass("characters",o.Z),L=this.getSubLayerClass("background",w.Z);return[_&&new L({getFillColor:g,getLineColor:m,getLineWidth:A,padding:y,getPosition:c,getSize:p,getAngle:f,getPixelOffset:d,billboard:v,sizeScale:T/this.state.fontAtlasManager.props.fontSize,sizeUnits:P,sizeMinPixels:M,sizeMaxPixels:C,transitions:I&&{getPosition:I.getPosition,getAngle:I.getAngle,getSize:I.getSize,getFillColor:I.getBackgroundColor,getLineColor:I.getBorderColor,getLineWidth:I.getBorderWidth,getPixelOffset:I.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:O.getPosition,getAngle:O.getAngle,getSize:O.getSize,getFillColor:O.getBackgroundColor,getLineColor:O.getBorderColor,getLineWidth:O.getBorderWidth,getPixelOffset:O.getPixelOffset,getBoundingRect:{getText:O.getText,getTextAnchor:O.getTextAnchor,getAlignmentBaseline:O.getAlignmentBaseline,styleVersion:a}}}),{data:l.attributes?{length:l.length,attributes:l.attributes.background||{}}:l,_dataDiff:u,autoHighlight:!1,getBoundingRect:this.getBoundingRect.bind(this)}),new R({sdf:b.sdf,smoothing:Number.isFinite(b.smoothing)?b.smoothing:E.smoothing,outlineWidth:x,outlineColor:S,iconAtlas:i,iconMapping:s,getPosition:c,getColor:h,getSize:p,getAngle:f,getPixelOffset:d,billboard:v,sizeScale:T*r,sizeUnits:P,sizeMinPixels:M*r,sizeMaxPixels:C*r,transitions:I&&{getPosition:I.getPosition,getAngle:I.getAngle,getColor:I.getColor,getSize:I.getSize,getPixelOffset:I.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{getIcon:O.getText,getPosition:O.getPosition,getAngle:O.getAngle,getColor:O.getColor,getSize:O.getSize,getPixelOffset:O.getPixelOffset,getIconOffsets:{getText:O.getText,getTextAnchor:O.getTextAnchor,getAlignmentBaseline:O.getAlignmentBaseline,styleVersion:a}}}),{data:l,_dataDiff:u,startIndices:t,numInstances:e,getIconOffsets:this.getIconOffsets.bind(this),getIcon:n})]}}I.layerName="TextLayer",I.defaultProps=C},8452:(t,e,n)=>{"use strict";function r({data:t,getIndex:e,dataRange:n,replace:r}){const{startRow:i=0,endRow:o=1/0}=n,s=t.length;let a=s,l=s;for(let n=0;n<s;n++){const r=e(t[n]);if(a>n&&r>=i&&(a=n),r>=o){l=n;break}}let u=a;const c=l-a!==r.length,h=c&&t.slice(l);for(let e=0;e<r.length;e++)t[u++]=r[e];if(c){for(let e=0;e<h.length;e++)t[u++]=h[e];t.length=u}return{startRow:a,endRow:a+r.length}}n.d(e,{b:()=>r})},1956:(t,e,n)=>{"use strict";n.r(e),n.d(e,{SimpleMeshLayer:()=>r.Z,ScenegraphLayer:()=>i.Z});var r=n(3989),i=n(2377)},2377:(t,e,n)=>{"use strict";n.d(e,{Z:()=>N});var r=n(4185),i=n(3844),o=n(3117),s=n(744),a=n(9450),l=n(4080),u=n(3855),c=n(3467),h=n(4538),p=n(2525);class f{constructor(t={}){const{id:e}=t;this.id=e||(0,h.hQ)(this.constructor.name),this.display=!0,this.position=new u.Z,this.rotation=new u.Z,this.scale=new u.Z(1,1,1),this.matrix=new c.Z,this.userData={},this.props={},this._setScenegraphNodeProps(t)}delete(){}setProps(t){return this._setScenegraphNodeProps(t),this}toString(){return`{type: ScenegraphNode, id: ${this.id})}`}setPosition(t){return(0,p.h)(3===t.length,"setPosition requires vector argument"),this.position=t,this}setRotation(t){return(0,p.h)(3===t.length,"setRotation requires vector argument"),this.rotation=t,this}setScale(t){return(0,p.h)(3===t.length,"setScale requires vector argument"),this.scale=t,this}setMatrix(t,e=!0){e?this.matrix.copy(t):this.matrix=t}setMatrixComponents({position:t,rotation:e,scale:n,update:r=!0}){return t&&this.setPosition(t),e&&this.setRotation(e),n&&this.setScale(n),r&&this.updateMatrix(),this}updateMatrix(){const t=this.position,e=this.rotation,n=this.scale;return this.matrix.identity(),this.matrix.translate(t),this.matrix.rotateXYZ(e),this.matrix.scale(n),this}update(t={}){const{position:e,rotation:n,scale:r}=t;return e&&this.setPosition(e),n&&this.setRotation(n),r&&this.setScale(r),this.updateMatrix(),this}getCoordinateUniforms(t,e){(0,p.h)(t),e=e||this.matrix;const n=new c.Z(t).multiplyRight(e),r=n.invert(),i=r.transpose();return{viewMatrix:t,modelMatrix:e,objectMatrix:e,worldMatrix:n,worldInverseMatrix:r,worldInverseTransposeMatrix:i}}_setScenegraphNodeProps(t){"display"in t&&(this.display=t.display),"position"in t&&this.setPosition(t.position),"rotation"in t&&this.setRotation(t.rotation),"scale"in t&&this.setScale(t.scale),"matrix"in t&&this.setMatrix(t.matrix),Object.assign(this.props,t)}}var d=n(3478),g=n(4072);class m extends f{constructor(t={}){t=Array.isArray(t)?{children:t}:t;const{children:e=[]}=t;a.cM.assert(e.every((t=>t instanceof f)),"every child must an instance of ScenegraphNode"),super(t),this.children=e}add(...t){for(const e of t)Array.isArray(e)?this.add(...e):this.children.push(e);return this}remove(t){const e=this.children,n=e.indexOf(t);return n>-1&&e.splice(n,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach((t=>t.delete())),this.removeAll(),super.delete()}traverse(t,{worldMatrix:e=new c.Z}={}){const n=new c.Z(e).multiplyRight(this.matrix);for(const e of this.children)e instanceof m?e.traverse(t,{worldMatrix:n}):t(e,{worldMatrix:n})}}var A=n(7696);const y={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},_={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function v(t){if(!t._animation){const e=_[t.componentType],n=y[t.type],r=n*t.count,{buffer:i,byteOffset:o}=t.bufferView.data,s=new e(i,o+(t.byteOffset||0),r);if(1===n)t._animation=Array.from(s);else{const e=[];for(let t=0;t<s.length;t+=n)e.push(Array.from(s.slice(t,t+n)));t._animation=e}}return t._animation}const b=new c.Z,x=new A.Z;class w{constructor(t){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,t)}animate(t){if(!this.playing)return;const e=(t/1e3-this.startTime)*this.speed;this.channels.forEach((({sampler:t,target:n,path:r})=>{(function(t,{input:e,interpolation:n,output:r},i,o){const s=t%e[e.length-1],l=e.findIndex((t=>t>=s)),u=Math.max(0,l-1);if(!Array.isArray(i[o]))switch(o){case"translation":i[o]=[0,0,0];break;case"rotation":i[o]=[0,0,0,1];break;case"scale":i[o]=[1,1,1];break;default:a.cM.warn(`Bad animation path ${o}`)()}(0,p.h)(i[o].length===r[u].length);const c=e[u],h=e[l];switch(n){case"STEP":!function(t,e,n){for(let r=0;r<n.length;r++)t[e][r]=n[r]}(i,o,r[u]);break;case"LINEAR":if(h>c){const t=(s-c)/(h-c);!function(t,e,n,r,i){if("rotation"===e){x.slerp({start:n,target:r,ratio:i});for(let n=0;n<x.length;n++)t[e][n]=x[n]}else for(let o=0;o<n.length;o++)t[e][o]=i*r[o]+(1-i)*n[o]}(i,o,r[u],r[l],t)}break;case"CUBICSPLINE":if(h>c){const t=(s-c)/(h-c),e=h-c;!function(t,e,{p0:n,outTangent0:r,inTangent1:i,p1:o,tDiff:s,ratio:a}){for(let l=0;l<t[e].length;l++){const u=r[l]*s,c=i[l]*s;t[e][l]=(2*Math.pow(a,3)-3*Math.pow(a,2)+1)*n[l]+(Math.pow(a,3)-2*Math.pow(a,2)+a)*u+(-2*Math.pow(a,3)+3*Math.pow(a,2))*o[l]+(Math.pow(a,3)-Math.pow(a,2))*c}}(i,o,{p0:r[3*u+1],outTangent0:r[3*u+2],inTangent1:r[3*l+0],p1:r[3*l+1],tDiff:e,ratio:t})}break;default:a.cM.warn(`Interpolation ${n} not supported`)()}})(e,t,n,r),function(t,e){if(e.matrix.identity(),t.translation&&e.matrix.translate(t.translation),t.rotation){const n=b.fromQuaternion(t.rotation);e.matrix.multiplyRight(n)}t.scale&&e.matrix.scale(t.scale)}(n,n._node)}))}}class E{constructor(t){this.animations=t.animations.map(((e,n)=>{const r=e.name||`Animation-${n}`,i=e.samplers.map((({input:e,interpolation:n="LINEAR",output:r})=>({input:v(t.accessors[e]),interpolation:n,output:v(t.accessors[r])}))),o=e.channels.map((({sampler:e,target:n})=>({sampler:i[e],target:t.nodes[n.node],path:n.path})));return new w({name:r,channels:o})}))}animate(t){this.setTime(t)}setTime(t){this.animations.forEach((e=>e.animate(t)))}getAnimations(){return this.animations}}var S=n(1113);class T extends f{constructor(t,e={}){super(e),this.onBeforeRender=null,this.AfterRender=null,t instanceof S.Z?(this.model=t,this._setModelNodeProps(e)):this.model=new S.Z(t,e),this.managedResources=e.managedResources||[]}setProps(t){return super.setProps(t),this._setModelNodeProps(t),this}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach((t=>t.delete())),this.managedResources=[]}draw(...t){return this.model.draw(...t)}setUniforms(...t){return this.model.setUniforms(...t),this}setAttributes(...t){return this.model.setAttributes(...t),this}updateModuleSettings(...t){return this.model.updateModuleSettings(...t),this}_setModelNodeProps(t){this.model.setProps(t)}}var P=n(1307);function M(t,e){return(0,a.D0)(t)?`#version 300 es\n${e}`:e}const C={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},I={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class O{constructor(t,e={}){this.gl=t,this.options=Object.assign({},I,e)}instantiate(t){return this.gltf=t,(t.scenes||[]).map((t=>this.createScene(t)))}createAnimator(){return Array.isArray(this.gltf.animations)?new E(this.gltf):null}createScene(t){const e=(t.nodes||[]).map((t=>this.createNode(t)));return new m({id:t.name||t.id,children:e})}createNode(t){if(!t._node){const e=(t.children||[]).map((t=>this.createNode(t)));t.mesh&&e.push(this.createMesh(t.mesh));const n=new m({id:t.name||t.id,children:e});if(t.matrix)n.setMatrix(t.matrix);else{if(n.matrix.identity(),t.translation&&n.matrix.translate(t.translation),t.rotation){const e=(new c.Z).fromQuaternion(t.rotation);n.matrix.multiplyRight(e)}t.scale&&n.matrix.scale(t.scale)}t._node=n}return t._node}createMesh(t){if(!t._mesh){const e=(t.primitives||[]).map(((e,n)=>this.createPrimitive(e,n,t))),n=new m({id:t.name||t.id,children:e});t._mesh=n}return t._mesh}getVertexCount(t){a.cM.warn("getVertexCount() not found")()}createPrimitive(t,e,n){return function(t,e){const{id:n,drawMode:r,vertexCount:i,attributes:o,modelOptions:s}=e,u=new P.Z(t,e);a.cM.info(4,"createGLTFModel defines: ",u.defines)();const c=[];c.push(...u.generatedTextures),c.push(...Object.values(o).map((t=>t.buffer)));const h=new T(t,Object.assign({id:n,drawMode:r,vertexCount:i,modules:[l.b],defines:u.defines,parameters:u.parameters,vs:M(t,"\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n"),fs:M(t,"\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n"),managedResources:c},s));return h.setProps({attributes:o}),h.setUniforms(u.uniforms),h}(this.gl,Object.assign({id:t.name||`${n.name||n.id}-primitive-${e}`,drawMode:t.mode||4,vertexCount:t.indices?t.indices.count:this.getVertexCount(t.attributes),attributes:this.createAttributes(t.attributes,t.indices),material:t.material},this.options))}createAttributes(t,e){const n={};return Object.keys(t).forEach((e=>{n[e]=this.createAccessor(t[e],this.createBuffer(t[e],this.gl.ARRAY_BUFFER))})),e&&(n.indices=this.createAccessor(e,this.createBuffer(e,this.gl.ELEMENT_ARRAY_BUFFER))),a.cM.info(4,"glTF Attributes",{attributes:t,indices:e,generated:n})(),n}createBuffer(t,e){t.bufferView||(t.bufferView={});const{bufferView:n}=t;return n.lumaBuffers||(n.lumaBuffers={}),n.lumaBuffers[e]||(n.lumaBuffers[e]=new d.Z(this.gl,{id:`from-${n.id}`,data:n.data||t.value,target:e})),n.lumaBuffers[e]}createAccessor(t,e){return new g.Z({buffer:e,offset:t.byteOffset||0,stride:t.bufferView.byteStride||0,type:t.componentType,size:C[t.type]})}createSampler(t){return t}needsPOT(){return!1}}var R=n(8130);var L=n(7805);const k=[255,255,255,255],D={scenegraph:{type:"object",value:null,async:!0},getScene:t=>t&&t.scenes?"object"==typeof t.scene?t.scene:t.scenes[t.scene||0]:t,getAnimator:t=>t&&t.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:k},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[R.E]};class N extends r.Z{getShaders(){const t=[i.Z,o.Z];return"pbr"===this.props._lighting&&t.push(l.b),{vs:"#version 300 es\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform mat4 sceneModelMatrix;\nuniform bool composeModelMatrix;\nin vec4 POSITION;\n\n#ifdef HAS_UV\n  in vec2 TEXCOORD_0;\n#endif\n\n#ifdef MODULE_PBR\n  #ifdef HAS_NORMALS\n    in vec4 NORMAL;\n  #endif\n#endif\nout vec4 vColor;\n#ifndef MODULE_PBR\n  #ifdef HAS_UV\n    out vec2 vTEXCOORD_0;\n  #endif\n#endif\nvoid main(void) {\n  #if defined(HAS_UV) && !defined(MODULE_PBR)\n    vTEXCOORD_0 = TEXCOORD_0;\n    geometry.uv = vTEXCOORD_0;\n  #endif\n\n  geometry.worldPosition = instancePositions;\n  geometry.pickingColor = instancePickingColors;\n\n  #ifdef MODULE_PBR\n    #ifdef HAS_NORMALS\n      pbr_vNormal = project_normal(instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz);\n      geometry.normal = pbr_vNormal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = TEXCOORD_0;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  float originalSize = project_size_to_pixel(sizeScale);\n  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);\n\n  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;\n  if(composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  #ifdef MODULE_PBR\n    pbr_vPosition = geometry.position.xyz;\n  #endif\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\nuniform float opacity;\nin vec4 vColor;\n\nout vec4 fragmentColor;\n#ifndef MODULE_PBR\n  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n    in vec2 vTEXCOORD_0;\n    uniform sampler2D u_BaseColorSampler;\n  #endif\n#endif\n\nvoid main(void) {\n  #ifdef MODULE_PBR\n    fragmentColor = vColor * pbr_filterColor(vec4(0));\n    geometry.uv = pbr_vUV;\n  #else\n    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);\n      geometry.uv = vTEXCOORD_0;\n    #else\n      fragmentColor = vColor;\n    #endif\n  #endif\n\n  fragmentColor.a *= opacity;\n  DECKGL_FILTER_COLOR(fragmentColor, geometry);\n}\n",modules:t}}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:k,transition:!0},instanceModelMatrix:L.P})}updateState(t){super.updateState(t);const{props:e,oldProps:n}=t;e.scenegraph!==n.scenegraph?this._updateScenegraph(e):e._animations!==n._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,e._animations)}finalizeState(){super.finalizeState(),this._deleteScenegraph()}_updateScenegraph(t){const{gl:e}=this.context;let n=null;if(t.scenegraph instanceof f)n={scenes:[t.scenegraph]};else if(t.scenegraph&&!t.scenegraph.gltf){const r=t.scenegraph,i=function(t,e,n){const r=new O(t,n);return{scenes:r.instantiate(e),animator:r.createAnimator()}}(e,r,this._getModelOptions());n={gltf:r,...i},async function(t){const e=[];return t.scenes.forEach((t=>{t.traverse((t=>{Object.values(t.model.getUniforms()).forEach((t=>{!1===t.loaded&&e.push(t)}))}))})),await async function(t){for(;e.some((t=>!t.loaded));)await new Promise((t=>requestAnimationFrame(t)))}()}(i).then((()=>this.setNeedsRedraw()))}else t.scenegraph&&(s.Z.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),n=t.scenegraph);const r={layer:this,gl:e},i=t.getScene(n,r),o=t.getAnimator(n,r);i instanceof f?(this._deleteScenegraph(),this._applyAllAttributes(i),this._applyAnimationsProp(i,o,t._animations),this.setState({scenegraph:i,animator:o})):null!==i&&s.Z.warn("invalid scenegraph:",i)()}_applyAllAttributes(t){if(this.state.attributesAvailable){const e=this.getAttributeManager().getAttributes();t.traverse((t=>{this._setModelAttributes(t.model,e)}))}}_applyAnimationsProp(t,e,n){if(!t||!e||!n)return;const r=e.getAnimations();Object.keys(n).sort().forEach((t=>{const e=n[t];if("*"===t)r.forEach((t=>{Object.assign(t,e)}));else if(Number.isFinite(Number(t))){const n=Number(t);n>=0&&n<r.length?Object.assign(r[n],e):s.Z.warn("animation ".concat(t," not found"))()}else{const n=r.find((({name:e})=>e===t));n?Object.assign(n,e):s.Z.warn("animation ".concat(t," not found"))()}}))}_deleteScenegraph(){const{scenegraph:t}=this.state;t instanceof f&&t.delete()}_getModelOptions(){const{_imageBasedLightingEnvironment:t}=this.props;let e=null;return t&&(e="function"==typeof t?t({gl:this.context.gl,layer:this}):t),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:e,modelOptions:{isInstanced:!0,transpileToGLSL100:!(0,a.D0)(this.context.gl),...this.getShaders()},useTangents:!1}}updateAttributes(t){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse((e=>{this._setModelAttributes(e.model,t)}))}draw({moduleParameters:t=null,parameters:e={},context:n}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(n.timeline.getTime()),this.setNeedsRedraw());const{viewport:r}=this.context,{sizeScale:i,sizeMinPixels:o,sizeMaxPixels:s,opacity:a,coordinateSystem:l}=this.props,u=this.getNumInstances();this.state.scenegraph.traverse(((n,{worldMatrix:c})=>{n.model.setInstanceCount(u),n.updateModuleSettings(t),n.draw({parameters:e,uniforms:{sizeScale:i,opacity:a,sizeMinPixels:o,sizeMaxPixels:s,composeModelMatrix:(0,L.X)(r,l),sceneModelMatrix:c,u_Camera:n.model.getUniforms().project_uCameraPosition}})}))}}N.layerName="ScenegraphLayer",N.defaultProps=D},3989:(t,e,n)=>{"use strict";n.d(e,{Z:()=>A});var r=n(744),i=n(4185),o=n(3844),s=n(7287),a=n(3117),l=n(3982),u=n(9450),c=n(4912),h=n(1113),p=n(4211),f=n(6948),d=n(7805);function g(t,e){(t.COLOR_0||t.colors)&&e||(t.colors={constant:!0,value:new Float32Array([1,1,1])}),r.Z.assert(t.positions||t.POSITION,'no "postions" or "POSITION" attribute in mesh')}function m(t,e){if(t.attributes)return g(t.attributes,e),t instanceof l.Z?t:new l.Z(t);if(t.positions||t.POSITION)return g(t,e),new l.Z({attributes:t});throw Error("Invalid mesh")}class A extends i.Z{getShaders(){const t=!(0,u.D0)(this.context.gl),e={};return(0,p.U6)(this.context.gl,f.h.GLSL_DERIVATIVES)&&(e.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  vTexCoord = texCoords;\n  cameraPosition = project_uCameraPosition;\n  normals_commonspace = project_normal(instanceModelMatrix * normals);\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n  geometry.normal = normals_commonspace;\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;\n\n  if (composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\n  }\n\n  geometry.position = position_commonspace;\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[o.Z,s.s,a.Z],transpileToGLSL100:t,defines:e})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:d.P}),this.setState({emptyTexture:new c.Z(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState({props:t,oldProps:e,changeFlags:n}){if(super.updateState({props:t,oldProps:e,changeFlags:n}),t.mesh!==e.mesh||n.extensionsChanged){var r;if(null===(r=this.state.model)||void 0===r||r.delete(),t.mesh){this.state.model=this.getModel(t.mesh);const e=t.mesh.attributes||t.mesh;this.setState({hasNormals:Boolean(e.NORMAL||e.normals)})}this.getAttributeManager().invalidateAll()}t.texture!==e.texture&&this.setTexture(t.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(){super.finalizeState(),this.state.emptyTexture.delete()}draw({uniforms:t}){if(!this.state.model)return;const{viewport:e}=this.context,{sizeScale:n,coordinateSystem:r,_instanced:i}=this.props;this.state.model.setUniforms(t).setUniforms({sizeScale:n,composeModelMatrix:!i||(0,d.X)(e,r),flatShading:!this.state.hasNormals}).draw()}getModel(t){const e=new h.Z(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:m(t,this.props._useMeshColors),isInstanced:!0}),{texture:n}=this.props,{emptyTexture:r}=this.state;return e.setUniforms({sampler:n||r,hasTexture:Boolean(n)}),e}setTexture(t){const{emptyTexture:e,model:n}=this.state;null==n||n.setUniforms({sampler:t||e,hasTexture:Boolean(t)})}}A.layerName="SimpleMeshLayer",A.defaultProps={mesh:{value:null,type:"object",async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}}},7805:(t,e,n)=>{"use strict";n.d(e,{P:()=>c,X:()=>h});var r=n(8550),i=n(4088);const o=Math.PI/180,s=new Float32Array(16),a=new Float32Array(12);function l(t,e,n){const r=e[0]*o,i=e[1]*o,s=e[2]*o,a=Math.sin(s),l=Math.sin(r),u=Math.sin(i),c=Math.cos(s),h=Math.cos(r),p=Math.cos(i),f=n[0],d=n[1],g=n[2];t[0]=f*p*h,t[1]=f*u*h,t[2]=f*-l,t[3]=d*(-u*c+p*l*a),t[4]=d*(p*c+u*l*a),t[5]=d*h*a,t[6]=g*(u*a+p*l*c),t[7]=g*(-p*a+u*l*c),t[8]=g*h*c}function u(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}const c={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(t,{startRow:e,endRow:n}){const{data:i,getOrientation:o,getScale:c,getTranslation:h,getTransformMatrix:p}=this.props,f=Array.isArray(p),d=f&&16===p.length,g=Array.isArray(c),m=Array.isArray(o),A=Array.isArray(h),y=d||!f&&Boolean(p(i[0]));t.constant=y?d:m&&g&&A;const _=t.value;if(t.constant){let e;y?(s.set(p),e=u(s)):(e=a,l(e,o,c),e.set(h,9)),t.value=new Float32Array(e)}else{let f=e*t.size;const{iterable:v,objectInfo:b}=(0,r.jB)(i,e,n);for(const t of v){let e;b.index++,y?(s.set(d?p:p(t,b)),e=u(s)):(e=a,l(e,m?o:o(t,b),g?c:c(t,b)),e.set(A?h:h(t,b),9)),_[f++]=e[0],_[f++]=e[1],_[f++]=e[2],_[f++]=e[3],_[f++]=e[4],_[f++]=e[5],_[f++]=e[6],_[f++]=e[7],_[f++]=e[8],_[f++]=e[9],_[f++]=e[10],_[f++]=e[11]}}}};function h(t,e){return e===i.Df.CARTESIAN||e===i.Df.METER_OFFSETS||e===i.Df.DEFAULT&&!t.isGeospatial}},6255:(t,e,n)=>{"use strict";n.d(e,{Kn:()=>i,Ss:()=>o,TW:()=>s,D0:()=>a,Ew:()=>l,Lj:()=>u,zH:()=>c,Os:()=>h});const r=t=>"function"==typeof t,i=t=>null!==t&&"object"==typeof t,o=t=>i(t)&&t.constructor==={}.constructor,s=t=>t&&"function"==typeof t[Symbol.iterator],a=t=>t&&"function"==typeof t[Symbol.asyncIterator],l=t=>"undefined"!=typeof Response&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,u=t=>"undefined"!=typeof Blob&&t instanceof Blob,c=t=>t&&"object"==typeof t&&t.isBuffer,h=t=>(t=>"undefined"!=typeof ReadableStream&&t instanceof ReadableStream||i(t)&&r(t.tee)&&r(t.cancel)&&r(t.getReader))(t)||(t=>i(t)&&r(t.read)&&r(t.pipe)&&(t=>"boolean"==typeof t)(t.readable))(t)},3079:(t,e,n)=>{"use strict";n.d(e,{z:()=>z});var r=n(6255),i=n(2033),o=n(7504),s=n(6040),a=n(4942),l=n(6013);const u=new Map;function c(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function h(t,e=!0,n){const r=n||new Set;if(t)if(p(t))r.add(t);else if(p(t.buffer))r.add(t.buffer);else if(ArrayBuffer.isView(t));else if(e&&"object"==typeof t)for(const n in t)h(t[n],e,r);return void 0===n?Array.from(r):[]}function p(t){return!!t&&(t instanceof ArrayBuffer||"undefined"!=typeof MessagePort&&t instanceof MessagePort||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas)}const f=()=>{};class d{static isSupported(){return"undefined"!=typeof Worker}constructor(t){(0,a.Z)(this,"name",void 0),(0,a.Z)(this,"source",void 0),(0,a.Z)(this,"url",void 0),(0,a.Z)(this,"terminated",!1),(0,a.Z)(this,"worker",void 0),(0,a.Z)(this,"onMessage",void 0),(0,a.Z)(this,"onError",void 0),(0,a.Z)(this,"_loadableURL","");const{name:e,source:n,url:r}=t;(0,s.h)(n||r),this.name=e,this.source=n,this.url=r,this.onMessage=f,this.onError=t=>console.log(t),this.worker=this._createBrowserWorker()}destroy(){this.onMessage=f,this.onError=f,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(t,e){e=e||h(t),this.worker.postMessage(t,e)}_getErrorFromErrorEvent(t){let e="Failed to load ";return e+=`worker ${this.name}. `,t.message&&(e+=`${t.message} in `),t.lineno&&(e+=`:${t.lineno}:${t.colno}`),new Error(e)}_createBrowserWorker(){this._loadableURL=function(t){(0,s.h)(t.source&&!t.url||!t.source&&t.url);let e=u.get(t.source||t.url);return e||(t.url&&(e=(n=t.url).startsWith("http")?c(`try {\n  importScripts('${n}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`):n,u.set(t.url,e)),t.source&&(e=c(t.source),u.set(t.source,e))),(0,s.h)(e),e;var n}({source:this.source,url:this.url});const t=new Worker(this._loadableURL,{name:this.name});return t.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},t.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},t.onmessageerror=t=>console.error(t),t}}class g{constructor(t,e){(0,a.Z)(this,"name",void 0),(0,a.Z)(this,"workerThread",void 0),(0,a.Z)(this,"isRunning",void 0),(0,a.Z)(this,"result",void 0),(0,a.Z)(this,"_resolve",void 0),(0,a.Z)(this,"_reject",void 0),this.name=t,this.workerThread=e,this.isRunning=!0,this._resolve=()=>{},this._reject=()=>{},this.result=new Promise(((t,e)=>{this._resolve=t,this._reject=e}))}postMessage(t,e){this.workerThread.postMessage({source:"loaders.gl",type:t,payload:e})}done(t){(0,s.h)(this.isRunning),this.isRunning=!1,this._resolve(t)}error(t){(0,s.h)(this.isRunning),this.isRunning=!1,this._reject(t)}}class m{constructor(t){(0,a.Z)(this,"name","unnamed"),(0,a.Z)(this,"source",void 0),(0,a.Z)(this,"url",void 0),(0,a.Z)(this,"maxConcurrency",1),(0,a.Z)(this,"maxMobileConcurrency",1),(0,a.Z)(this,"onDebug",(()=>{})),(0,a.Z)(this,"reuseWorkers",!0),(0,a.Z)(this,"props",{}),(0,a.Z)(this,"jobQueue",[]),(0,a.Z)(this,"idleQueue",[]),(0,a.Z)(this,"count",0),(0,a.Z)(this,"isDestroyed",!1),this.source=t.source,this.url=t.url,this.setProps(t)}destroy(){this.idleQueue.forEach((t=>t.destroy())),this.isDestroyed=!0}setProps(t){this.props={...this.props,...t},void 0!==t.name&&(this.name=t.name),void 0!==t.maxConcurrency&&(this.maxConcurrency=t.maxConcurrency),void 0!==t.maxMobileConcurrency&&(this.maxMobileConcurrency=t.maxMobileConcurrency),void 0!==t.reuseWorkers&&(this.reuseWorkers=t.reuseWorkers),void 0!==t.onDebug&&(this.onDebug=t.onDebug)}async startJob(t,e=((t,e,n)=>t.done(n)),n=((t,e)=>t.error(e))){const r=new Promise((r=>(this.jobQueue.push({name:t,onMessage:e,onError:n,onStart:r}),this)));return this._startQueuedJob(),await r}async _startQueuedJob(){if(!this.jobQueue.length)return;const t=this._getAvailableWorker();if(!t)return;const e=this.jobQueue.shift();if(e){this.onDebug({message:"Starting job",name:e.name,workerThread:t,backlog:this.jobQueue.length});const n=new g(e.name,t);t.onMessage=t=>e.onMessage(n,t.type,t.payload),t.onError=t=>e.onError(n,t),e.onStart(n);try{await n.result}finally{this.returnWorkerToQueue(t)}}}returnWorkerToQueue(t){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const t=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new d({name:t,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return l.tq?this.maxMobileConcurrency:this.maxConcurrency}}const A={maxConcurrency:3,maxMobileConcurrency:1,onDebug:()=>{},reuseWorkers:!0};class y{static isSupported(){return d.isSupported()}static getWorkerFarm(t={}){return y._workerFarm=y._workerFarm||new y({}),y._workerFarm.setProps(t),y._workerFarm}constructor(t){(0,a.Z)(this,"props",void 0),(0,a.Z)(this,"workerPools",new Map),this.props={...A},this.setProps(t),this.workerPools=new Map}destroy(){for(const t of this.workerPools.values())t.destroy()}setProps(t){this.props={...this.props,...t};for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(t){const{name:e,source:n,url:r}=t;let i=this.workerPools.get(e);return i||(i=new m({name:e,source:n,url:r}),i.setProps(this._getWorkerPoolProps()),this.workerPools.set(e,i)),i}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}async function _(t,e,n,r,i){const o=t.id,a=function(t,e={}){const n=e[t.id]||{},r=`${t.id}-worker.js`;let i=n.workerUrl;if("test"===e._workerType&&(i=`modules/${t.module}/dist/${r}`),!i){let e=t.version;"latest"===e&&(e="latest");const n=e?`@${e}`:"";i=`https://unpkg.com/@loaders.gl/${t.module}${n}/dist/${r}`}return(0,s.h)(i),i}(t,n),l=y.getWorkerFarm(n).getWorkerPool({name:o,url:a});n=JSON.parse(JSON.stringify(n));const u=await l.startJob("process-on-worker",v.bind(null,i));u.postMessage("process",{input:e,options:n});const c=await u.result;return await c.result}async function v(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(r.error);break;case"process":const{id:i,input:o,options:s}=r;try{const n=await t(o,s);e.postMessage("done",{id:i,result:n})}catch(t){const n=t instanceof Error?t.message:"unknown error";e.postMessage("error",{id:i,error:n})}break;default:console.warn(`parse-with-worker unknown message ${n}`)}}(0,a.Z)(y,"_workerFarm",void 0);var b=n(5680);const x=262144;var w=n(4959);function E(t,e){return w.jU?async function*(t,e){const n=t.getReader();let r;try{for(;;){const t=r||n.read();null!=e&&e._streamReadAhead&&(r=n.read());const{done:i,value:o}=await t;if(i)return;yield(0,b.rJ)(o)}}catch(t){n.releaseLock()}}(t,e):async function*(t,e){for await(const e of t)yield(0,b.rJ)(e)}(t)}var S=n(7927);const T="Cannot convert supplied data type";async function P(t,e,n){const i=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if("string"==typeof t||i)return function(t,e,n){if(e.text&&"string"==typeof t)return t;if((0,r.zH)(t)&&(t=t.buffer),t instanceof ArrayBuffer){const n=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let n=t.buffer;const r=t.byteLength||t.length;return 0===t.byteOffset&&r===n.byteLength||(n=n.slice(t.byteOffset,t.byteOffset+r)),n}throw new Error(T)}(t,e);if((0,r.Lj)(t)&&(t=await(0,S.L1)(t)),(0,r.Ew)(t)){const n=t;return await(0,S.mm)(n),e.binary?await n.arrayBuffer():await n.text()}if((0,r.Os)(t)&&(t=function(t,e){if("string"==typeof t)return function*(t,e){const n=(null==e?void 0:e.chunkSize)||262144;let r=0;const i=new TextEncoder;for(;r<t.length;){const e=Math.min(t.length-r,n),o=t.slice(r,r+e);r+=e,yield i.encode(o)}}(t,e);if(t instanceof ArrayBuffer)return function*(t,e={}){const{chunkSize:n=x}=e;let r=0;for(;r<t.byteLength;){const e=Math.min(t.byteLength-r,n),i=new ArrayBuffer(e),o=new Uint8Array(t,r,e);new Uint8Array(i).set(o),r+=e,yield i}}(t,e);if((0,r.Lj)(t))return async function*(t,e){const n=(null==e?void 0:e.chunkSize)||1048576;let r=0;for(;r<t.size;){const e=r+n,i=await t.slice(r,e).arrayBuffer();r=e,yield i}}(t,e);if((0,r.Os)(t))return E(t,e);if((0,r.Ew)(t))return E(t.body,e);throw new Error("makeIterator")}(t,n)),(0,r.TW)(t)||(0,r.D0)(t))return async function(t){const e=[];for await(const n of t)e.push(n);return(0,b.JY)(...e)}(t);throw new Error(T)}var M=n(9752),C=n(6228);const I=/\.([^.]+)$/;function O(t,e=[],n,r){if(!R(t))return null;if(e&&!Array.isArray(e))return(0,i.T)(e);let o=[];e&&(o=o.concat(e)),null!=n&&n.ignoreRegisteredLoaders||o.push(...(0,C.kO)()),function(t){for(const e of t)(0,i.T)(e)}(o);const s=function(t,e,n,r){const{url:i,type:o}=(0,M.l)(t),s=i||(null==r?void 0:r.url);let a=null;return null!=n&&n.mimeType&&(a=k(e,null==n?void 0:n.mimeType)),a=a||function(t,e){const n=e&&I.exec(e),r=n&&n[1];return r?function(t,e){e=e.toLowerCase();for(const n of t)for(const t of n.extensions)if(t.toLowerCase()===e)return n;return null}(t,r):null}(e,s),a=a||k(e,o),a=a||function(t,e){if(!e)return null;for(const n of t)if("string"==typeof e){if(D(e,n))return n}else if(ArrayBuffer.isView(e)){if(N(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&N(e,0,n))return n;return null}(e,t),a=a||k(e,null==n?void 0:n.fallbackMimeType),a}(t,o,n,r);if(!(s||null!=n&&n.nothrow))throw new Error(L(t));return s}function R(t){return!(t instanceof Response&&204===t.status)}function L(t){const{url:e,type:n}=(0,M.l)(t);let r="No valid loader found";return t&&(r+=` data: "${function(t,e=5){return"string"==typeof t?t.slice(0,e):ArrayBuffer.isView(t)?F(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?F(t,0,e):""}(t)}", contentType: "${n}"`),e&&(r+=` url: ${e}`),r}function k(t,e){for(const n of t){if(n.mimeTypes&&n.mimeTypes.includes(e))return n;if(e===`application/x.${n.id}`)return n}return null}function D(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some((e=>t.startsWith(e)))}function N(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some((r=>function(t,e,n,r){if(r instanceof ArrayBuffer)return(0,b.Xq)(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":return r===F(t,e,r.length);default:return!1}}(t,e,n,r)))}function F(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let t=0;t<n;t++)i+=String.fromCharCode(r.getUint8(e+t));return i}async function B(t,e,n,a){(0,s.h)(!a||"object"==typeof a),!e||Array.isArray(e)||(0,i.C)(e)||(a=void 0,n=e,e=void 0),t=await t,n=n||{};const{url:l}=(0,M.l)(t),u=function(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const t=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...t]:t}return n&&n.length?n:null}(e,a),c=await async function(t,e=[],n,i){if(!R(t))return null;let o=O(t,e,{...n,nothrow:!0},i);if(o)return o;if((0,r.Lj)(t)&&(o=O(t=await t.slice(0,10).arrayBuffer(),e,n,i)),!(o||null!=n&&n.nothrow))throw new Error(L(t));return o}(t,u,n);return c?(a=function(t,e,n=null){if(n)return n;const r={fetch:(0,o.bV)(e,t),...t};return Array.isArray(r.loaders)||(r.loaders=null),r}({url:l,parse:B,loaders:u},n=(0,o.GR)(n,c,u,l),a),await async function(t,e,n,r){if(function(t,e="3.0.12"){(0,s.h)(t,"no worker provided");t.version}(t),e=await P(e,t,n),t.parseTextSync&&"string"==typeof e)return n.dataType="text",t.parseTextSync(e,n,r,t);if(function(t,e){return!!y.isSupported()&&t.worker&&(null==e?void 0:e.worker)}(t,n))return await _(t,e,n,0,B);if(t.parseText&&"string"==typeof e)return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw(0,s.h)(!t.parseSync),new Error(`${t.id} loader - no parser found and worker is disabled`)}(c,t,n,a)):null}async function z(t,e,n,s){Array.isArray(e)||(0,i.C)(e)||(n=e,e=void 0);const a=(0,o.bV)(n);let l=t;return"string"==typeof t&&(l=await a(t)),(0,r.Lj)(t)&&(l=await a(t)),await B(l,e,n)}},6228:(t,e,n)=>{"use strict";n.d(e,{fh:()=>s,kO:()=>a});var r=n(2033),i=n(7504);const o=()=>{const t=(0,i.rx)();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function s(t){const e=o();t=Array.isArray(t)?t:[t];for(const n of t){const t=(0,r.T)(n);e.find((e=>t===e))||e.unshift(t)}}function a(){return o()}},2033:(t,e,n)=>{"use strict";n.d(e,{C:()=>i,T:()=>o});var r=n(6269);function i(t){var e;return!!t&&(Array.isArray(t)&&(t=t[0]),Array.isArray(null===(e=t)||void 0===e?void 0:e.extensions))}function o(t){var e,n;let o;return(0,r.h)(t,"null loader"),(0,r.h)(i(t),"invalid loader"),Array.isArray(t)&&(o=t[1],t=t[0],t={...t,options:{...t.options,...o}}),(null!==(e=t)&&void 0!==e&&e.parseTextSync||null!==(n=t)&&void 0!==n&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}},7504:(t,e,n)=>{"use strict";n.d(e,{bV:()=>m,rx:()=>f,GR:()=>g});var r=n(4959),i=n(6255);const o={};var s=n(7927);async function a(t,e){if("string"==typeof t){t=function(t){for(const e in o)if(t.startsWith(e)){const n=o[e];t=t.replace(e,n)}return t.startsWith("http://")||t.startsWith("https://")||(t=`${t}`),t}(t);let n=e;return null!=e&&e.fetch&&"function"!=typeof(null==e?void 0:e.fetch)&&(n=e.fetch),await fetch(t,n)}return await(0,s.L1)(t)}var l=n(4942);const u=new(n(4708).Z)({id:"loaders.gl"});class c{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}const h={fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){(0,l.Z)(this,"console",void 0),this.console=console}log(...t){return this.console.log.bind(this.console,...t)}info(...t){return this.console.info.bind(this.console,...t)}warn(...t){return this.console.warn.bind(this.console,...t)}error(...t){return this.console.error.bind(this.console,...t)}},CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},p={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function f(){r.CO.loaders=r.CO.loaders||{};const{loaders:t}=r.CO;return t._state=t._state||{},t._state}const d=()=>{const t=f();return t.globalOptions=t.globalOptions||{...h},t.globalOptions};function g(t,e,n,r){return n=n||[],function(t,e){A(t,null,h,p,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},o=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};A(r,n.id,i,o,e)}}(t,n=Array.isArray(n)?n:[n]),function(t,e,n){const r={...t.options||{}};return function(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}(r,n),null===r.log&&(r.log=new c),_(r,d()),_(r,e),r}(e,t,r)}function m(t,e){const n=d(),r=t||n;return"function"==typeof r.fetch?r.fetch:(0,i.Kn)(r.fetch)?t=>a(t,r):null!=e&&e.fetch?null==e?void 0:e.fetch:a}function A(t,e,n,r,o){const s=e||"Top level",a=e?`${e}.`:"";for(const l in t){const c=!e&&(0,i.Kn)(t[l]),h="baseUri"===l&&!e,p="workerUrl"===l&&e;if(!(l in n)&&!h&&!p)if(l in r)u.warn(`${s} loader option '${a}${l}' no longer supported, use '${r[l]}'`)();else if(!c){const t=y(l,o);u.warn(`${s} loader option '${a}${l}' not recognized. ${t}`)()}}}function y(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const e in i.options){if(t===e)return`Did you mean '${i.id}.${e}'?`;const o=e.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(r=r||`Did you mean '${i.id}.${e}'?`)}return r}function _(t,e){for(const n in e)if(n in e){const r=e[n];(0,i.Ss)(r)&&(0,i.Ss)(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}},9752:(t,e,n)=>{"use strict";n.d(e,{C:()=>c,l:()=>u});var r=n(6255);const i=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,o=/^([-\w.]+\/[-\w.+]+)/;function s(t){const e=o.exec(t);return e?e[1]:t}function a(t){const e=i.exec(t);return e?e[1]:""}const l=/\?.*/;function u(t){if((0,r.Ew)(t)){const e=h(t.url||"");return{url:e,type:s(t.headers.get("content-type")||"")||a(e)}}return(0,r.Lj)(t)?{url:h(t.name||""),type:t.type||""}:"string"==typeof t?{url:h(t),type:a(t)}:{url:"",type:""}}function c(t){return(0,r.Ew)(t)?t.headers["content-length"]||-1:(0,r.Lj)(t)?t.size:"string"==typeof t?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}function h(t){return t.replace(l,"")}},7927:(t,e,n)=>{"use strict";n.d(e,{L1:()=>o,mm:()=>s});var r=n(6255),i=n(9752);async function o(t){if((0,r.Ew)(t))return t;const e={},n=(0,i.C)(t);n>=0&&(e["content-length"]=String(n));const{url:o,type:s}=(0,i.l)(t);s&&(e["content-type"]=s);const a=await async function(t){if("string"==typeof t)return`data:,${t.slice(0,5)}`;if(t instanceof Blob){const e=t.slice(0,5);return await new Promise((t=>{const n=new FileReader;n.onload=e=>{var n;return t(null==e||null===(n=e.target)||void 0===n?void 0:n.result)},n.readAsDataURL(e)}))}return t instanceof ArrayBuffer?`data:base64,${function(t){let e="";const n=new Uint8Array(t);for(let t=0;t<n.byteLength;t++)e+=String.fromCharCode(n[t]);return btoa(e)}(t.slice(0,5))}`:null}(t);a&&(e["x-first-bytes"]=a),"string"==typeof t&&(t=(new TextEncoder).encode(t));const l=new Response(t,{headers:e});return Object.defineProperty(l,"url",{value:o}),l}async function s(t){if(!t.ok){const e=await async function(t){let e=`Failed to fetch resource ${t.url} (${t.status}): `;try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=` ${await t.text()}`),e+=r,e=e.length>60?`${e.slice(60)}...`:e}catch(t){}return e}(t);throw new Error(e)}}},7718:(t,e,n)=>{"use strict";n.d(e,{VJ:()=>j});const r={name:"Draco",id:"draco",module:"draco",version:"3.0.12",worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:"object"==typeof WebAssembly?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}};var i=n(4942);class o{constructor(t,e){(0,i.Z)(this,"fields",void 0),(0,i.Z)(this,"metadata",void 0),function(t,e){if(!t)throw new Error("loader assertion failed.")}(Array.isArray(t)),function(t){const e={};for(const n of t)e[n.name]&&console.warn("Schema: duplicated field name",n.name,n),e[n.name]=!0}(t),this.fields=t,this.metadata=e||new Map}compareTo(t){if(this.metadata!==t.metadata)return!1;if(this.fields.length!==t.fields.length)return!1;for(let e=0;e<this.fields.length;++e)if(!this.fields[e].compareTo(t.fields[e]))return!1;return!0}select(...t){const e=Object.create(null);for(const n of t)e[n]=!0;const n=this.fields.filter((t=>e[t.name]));return new o(n,this.metadata)}selectAt(...t){const e=t.map((t=>this.fields[t])).filter(Boolean);return new o(e,this.metadata)}assign(t){let e,n=this.metadata;if(t instanceof o){const r=t;e=r.fields,n=s(s(new Map,this.metadata),r.metadata)}else e=t;const r=Object.create(null);for(const t of this.fields)r[t.name]=t;for(const t of e)r[t.name]=t;const i=Object.values(r);return new o(i,n)}}function s(t,e){return new Map([...t||new Map,...e||new Map])}let a,l,u,c,h,p,f,d;var g;(g=a||(a={}))[g.NONE=0]="NONE",g[g.Null=1]="Null",g[g.Int=2]="Int",g[g.Float=3]="Float",g[g.Binary=4]="Binary",g[g.Utf8=5]="Utf8",g[g.Bool=6]="Bool",g[g.Decimal=7]="Decimal",g[g.Date=8]="Date",g[g.Time=9]="Time",g[g.Timestamp=10]="Timestamp",g[g.Interval=11]="Interval",g[g.List=12]="List",g[g.Struct=13]="Struct",g[g.Union=14]="Union",g[g.FixedSizeBinary=15]="FixedSizeBinary",g[g.FixedSizeList=16]="FixedSizeList",g[g.Map=17]="Map",g[g.Dictionary=-1]="Dictionary",g[g.Int8=-2]="Int8",g[g.Int16=-3]="Int16",g[g.Int32=-4]="Int32",g[g.Int64=-5]="Int64",g[g.Uint8=-6]="Uint8",g[g.Uint16=-7]="Uint16",g[g.Uint32=-8]="Uint32",g[g.Uint64=-9]="Uint64",g[g.Float16=-10]="Float16",g[g.Float32=-11]="Float32",g[g.Float64=-12]="Float64",g[g.DateDay=-13]="DateDay",g[g.DateMillisecond=-14]="DateMillisecond",g[g.TimestampSecond=-15]="TimestampSecond",g[g.TimestampMillisecond=-16]="TimestampMillisecond",g[g.TimestampMicrosecond=-17]="TimestampMicrosecond",g[g.TimestampNanosecond=-18]="TimestampNanosecond",g[g.TimeSecond=-19]="TimeSecond",g[g.TimeMillisecond=-20]="TimeMillisecond",g[g.TimeMicrosecond=-21]="TimeMicrosecond",g[g.TimeNanosecond=-22]="TimeNanosecond",g[g.DenseUnion=-23]="DenseUnion",g[g.SparseUnion=-24]="SparseUnion",g[g.IntervalDayTime=-25]="IntervalDayTime",g[g.IntervalYearMonth=-26]="IntervalYearMonth";class m{static isNull(t){return t&&t.typeId===a.Null}static isInt(t){return t&&t.typeId===a.Int}static isFloat(t){return t&&t.typeId===a.Float}static isBinary(t){return t&&t.typeId===a.Binary}static isUtf8(t){return t&&t.typeId===a.Utf8}static isBool(t){return t&&t.typeId===a.Bool}static isDecimal(t){return t&&t.typeId===a.Decimal}static isDate(t){return t&&t.typeId===a.Date}static isTime(t){return t&&t.typeId===a.Time}static isTimestamp(t){return t&&t.typeId===a.Timestamp}static isInterval(t){return t&&t.typeId===a.Interval}static isList(t){return t&&t.typeId===a.List}static isStruct(t){return t&&t.typeId===a.Struct}static isUnion(t){return t&&t.typeId===a.Union}static isFixedSizeBinary(t){return t&&t.typeId===a.FixedSizeBinary}static isFixedSizeList(t){return t&&t.typeId===a.FixedSizeList}static isMap(t){return t&&t.typeId===a.Map}static isDictionary(t){return t&&t.typeId===a.Dictionary}get typeId(){return a.NONE}compareTo(t){return this===t}}Symbol.toStringTag,Symbol.toStringTag,l=Symbol.toStringTag;class A extends m{constructor(t,e){super(),(0,i.Z)(this,"isSigned",void 0),(0,i.Z)(this,"bitWidth",void 0),this.isSigned=t,this.bitWidth=e}get typeId(){return a.Int}get[l](){return"Int"}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}class y extends A{constructor(){super(!0,8)}}class _ extends A{constructor(){super(!0,16)}}class v extends A{constructor(){super(!0,32)}}class b extends A{constructor(){super(!1,8)}}class x extends A{constructor(){super(!1,16)}}class w extends A{constructor(){super(!1,32)}}u=Symbol.toStringTag;class E extends m{constructor(t){super(),(0,i.Z)(this,"precision",void 0),this.precision=t}get typeId(){return a.Float}get[u](){return"Float"}toString(){return`Float${this.precision}`}}class S extends E{constructor(){super(32)}}class T extends E{constructor(){super(64)}}Symbol.toStringTag,Symbol.toStringTag,c=Symbol.toStringTag,h=Symbol.toStringTag,p=Symbol.toStringTag,f=Symbol.toStringTag,d=Symbol.toStringTag;class P extends m{constructor(t,e){super(),(0,i.Z)(this,"listSize",void 0),(0,i.Z)(this,"children",void 0),this.listSize=t,this.children=[e]}get typeId(){return a.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[d](){return"FixedSizeList"}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}class M{constructor(t,e,n=!1,r=new Map){(0,i.Z)(this,"name",void 0),(0,i.Z)(this,"type",void 0),(0,i.Z)(this,"nullable",void 0),(0,i.Z)(this,"metadata",void 0),this.name=t,this.type=e,this.nullable=n,this.metadata=r}get typeId(){return this.type&&this.type.typeId}clone(){return new M(this.name,this.type,this.nullable,this.metadata)}compareTo(t){return this.name===t.name&&this.type===t.type&&this.nullable===t.nullable&&this.metadata===t.metadata}toString(){return`${this.type}${this.nullable?", nullable":""}${this.metadata?`, metadata: ${this.metadata}`:""}`}}function C(t,e,n){const r=n?I(n.metadata):void 0,i=function(t){switch(t.constructor){case Int8Array:return new y;case Uint8Array:return new b;case Int16Array:return new _;case Uint16Array:return new x;case Int32Array:return new v;case Uint32Array:return new w;case Float32Array:return new S;case Float64Array:return new T;default:throw new Error("array type not supported")}}(e.value);return new M(t,new P(e.size,new M("value",i)),!1,r)}function I(t){const e=new Map;for(const n in t)e.set(`${n}.string`,JSON.stringify(t[n]));return e}const O={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},R={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array};class L{constructor(t){(0,i.Z)(this,"draco",void 0),(0,i.Z)(this,"decoder",void 0),(0,i.Z)(this,"metadataQuerier",void 0),this.draco=t,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(t,e={}){const n=new this.draco.DecoderBuffer;n.Init(new Int8Array(t),t.byteLength),this._disableAttributeTransforms(e);const r=this.decoder.GetEncodedGeometryType(n),i=r===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let t;switch(r){case this.draco.TRIANGULAR_MESH:t=this.decoder.DecodeBufferToMesh(n,i);break;case this.draco.POINT_CLOUD:t=this.decoder.DecodeBufferToPointCloud(n,i);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!t.ok()||!i.ptr){const e=`DRACO decompression failed: ${t.error_msg()}`;throw new Error(e)}const s=this._getDracoLoaderData(i,r,e),a=this._getMeshData(i,s,e),l=function(t){let e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,s=-1/0;const a=t.POSITION?t.POSITION.value:[],l=a&&a.length;for(let t=0;t<l;t+=3){const l=a[t],u=a[t+1],c=a[t+2];e=l<e?l:e,n=u<n?u:n,r=c<r?c:r,i=l>i?l:i,o=u>o?u:o,s=c>s?c:s}return[[e,n,r],[i,o,s]]}(a.attributes),u=function(t,e,n){const r=I(e.metadata),i=[],s=function(t){const e={};for(const n in t){const r=t[n];e[r.name||"undefined"]=r}return e}(e.attributes);for(const e in t){const n=C(e,t[e],s[e]);i.push(n)}if(n){const t=C("indices",n);i.push(t)}return new o(i,r)}(a.attributes,s,a.indices);return{loader:"draco",loaderData:s,header:{vertexCount:i.num_points(),boundingBox:l},...a,schema:u}}finally{this.draco.destroy(n),i&&this.draco.destroy(i)}}_getDracoLoaderData(t,e,n){const r=this._getTopLevelMetadata(t),i=this._getDracoAttributes(t,n);return{geometry_type:e,num_attributes:t.num_attributes(),num_points:t.num_points(),num_faces:t instanceof this.draco.Mesh?t.num_faces():0,metadata:r,attributes:i}}_getDracoAttributes(t,e){const n={};for(let r=0;r<t.num_attributes();r++){const i=this.decoder.GetAttribute(t,r),o=this._getAttributeMetadata(t,r);n[i.unique_id()]={unique_id:i.unique_id(),attribute_type:i.attribute_type(),data_type:i.data_type(),num_components:i.num_components(),byte_offset:i.byte_offset(),byte_stride:i.byte_stride(),normalized:i.normalized(),attribute_index:r,metadata:o};const s=this._getQuantizationTransform(i,e);s&&(n[i.unique_id()].quantization_transform=s);const a=this._getOctahedronTransform(i,e);a&&(n[i.unique_id()].octahedron_transform=a)}return n}_getMeshData(t,e,n){const r=this._getMeshAttributes(e,t,n);if(!r.POSITION)throw new Error("DRACO: No position attribute found.");return t instanceof this.draco.Mesh?"triangle-strip"===n.topology?{topology:"triangle-strip",mode:4,attributes:r,indices:{value:this._getTriangleStripIndices(t),size:1}}:{topology:"triangle-list",mode:5,attributes:r,indices:{value:this._getTriangleListIndices(t),size:1}}:{topology:"point-list",mode:0,attributes:r}}_getMeshAttributes(t,e,n){const r={};for(const i of Object.values(t.attributes)){const t=this._deduceAttributeName(i,n);i.name=t;const{value:o,size:s}=this._getAttributeValues(e,i);r[t]={value:o,size:s,byteOffset:i.byte_offset,byteStride:i.byte_stride,normalized:i.normalized}}return r}_getTriangleListIndices(t){const e=3*t.num_faces(),n=4*e,r=this.draco._malloc(n);try{return this.decoder.GetTrianglesUInt32Array(t,n,r),new Uint32Array(this.draco.HEAPF32.buffer,r,e).slice()}finally{this.draco._free(r)}}_getTriangleStripIndices(t){const e=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(t,e),function(t){const e=t.size(),n=new Int32Array(e);for(let r=0;r<e;r++)n[r]=t.GetValue(r);return n}(e)}finally{this.draco.destroy(e)}}_getAttributeValues(t,e){const n=R[e.data_type],r=e.num_components,i=t.num_points()*r,o=i*n.BYTES_PER_ELEMENT,s=function(t,e){switch(e){case Float32Array:return t.DT_FLOAT32;case Int8Array:return t.DT_INT8;case Int16Array:return t.DT_INT16;case Int32Array:return t.DT_INT32;case Uint8Array:return t.DT_UINT8;case Uint16Array:return t.DT_UINT16;case Uint32Array:return t.DT_UINT32;default:return t.DT_INVALID}}(this.draco,n);let a;const l=this.draco._malloc(o);try{const r=this.decoder.GetAttribute(t,e.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(t,r,s,o,l),a=new n(this.draco.HEAPF32.buffer,l,i).slice()}finally{this.draco._free(l)}return{value:a,size:r}}_deduceAttributeName(t,e){const n=t.unique_id;for(const[t,r]of Object.entries(e.extraAttributes||{}))if(r===n)return t;const r=t.attribute_type;for(const t in O)if(this.draco[t]===r)return O[t];const i=e.attributeNameEntry||"name";return t.metadata[i]?t.metadata[i].string:`CUSTOM_ATTRIBUTE_${n}`}_getTopLevelMetadata(t){const e=this.decoder.GetMetadata(t);return this._getDracoMetadata(e)}_getAttributeMetadata(t,e){const n=this.decoder.GetAttributeMetadata(t,e);return this._getDracoMetadata(n)}_getDracoMetadata(t){if(!t||!t.ptr)return{};const e={},n=this.metadataQuerier.NumEntries(t);for(let r=0;r<n;r++){const n=this.metadataQuerier.GetEntryName(t,r);e[n]=this._getDracoMetadataField(t,n)}return e}_getDracoMetadataField(t,e){const n=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(t,e,n);const r=function(t){const e=t.size(),n=new Int32Array(e);for(let r=0;r<e;r++)n[r]=t.GetValue(r);return n}(n);return{int:this.metadataQuerier.GetIntEntry(t,e),string:this.metadataQuerier.GetStringEntry(t,e),double:this.metadataQuerier.GetDoubleEntry(t,e),intArray:r}}finally{this.draco.destroy(n)}}_disableAttributeTransforms(t){const{quantizedAttributes:e=[],octahedronAttributes:n=[]}=t,r=[...e,...n];for(const t of r)this.decoder.SkipAttributeTransform(this.draco[t])}_getQuantizationTransform(t,e){const{quantizedAttributes:n=[]}=e,r=t.attribute_type();if(n.map((t=>this.decoder[t])).includes(r)){const e=new this.draco.AttributeQuantizationTransform;try{if(e.InitFromAttribute(t))return{quantization_bits:e.quantization_bits(),range:e.range(),min_values:new Float32Array([1,2,3]).map((t=>e.min_value(t)))}}finally{this.draco.destroy(e)}}return null}_getOctahedronTransform(t,e){const{octahedronAttributes:n=[]}=e,r=t.attribute_type();if(n.map((t=>this.decoder[t])).includes(r)){const e=new this.draco.AttributeQuantizationTransform;try{if(e.InitFromAttribute(t))return{quantization_bits:e.quantization_bits()}}finally{this.draco.destroy(e)}}return null}}var k=n(6013),D=n(9125),N=n(6040);const F={};async function B(t,e=null,n={}){return e&&(t=function(t,e,n){if(t.startsWith("http"))return t;const r=n.modules||{};return r[t]?r[t]:k.jU?n.CDN?((0,N.h)(n.CDN.startsWith("http")),`${n.CDN}/${e}@3.0.12/dist/libs/${t}`):k.hJ?`../src/libs/${t}`:`modules/${e}/src/libs/${t}`:`modules/${e}/dist/libs/${t}`}(t,e,n)),F[t]=F[t]||async function(t){if(t.endsWith("wasm")){const e=await fetch(t);return await e.arrayBuffer()}if(!k.jU)return D.requireFromFile&&await D.requireFromFile(t);if(k.hJ)return importScripts(t);const e=await fetch(t);return function(t,e){if(!k.jU)return D.requireFromString&&D.requireFromString(t,e);if(k.hJ)return eval.call(k.CO,t),null;const n=document.createElement("script");n.id=e;try{n.appendChild(document.createTextNode(t))}catch(e){n.text=t}return document.body.appendChild(n),null}(await e.text(),t)}(t),await F[t]}let z;const j={...r,parse:async function(t,e){const{draco:n}=await async function(t){const e=t.modules||{};return z=e.draco3d?z||e.draco3d.createDecoderModule({}).then((t=>({draco:t}))):z||async function(t){let e,n;return"js"===(t.draco&&t.draco.decoderType)?e=await B("https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_decoder.js","draco",t):[e,n]=await Promise.all([await B("https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_wasm_wrapper.js","draco",t),await B("https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_decoder.wasm","draco",t)]),e=e||globalThis.DracoDecoderModule,await function(t,e){const n={};return e&&(n.wasmBinary=e),new Promise((e=>{t({...n,onModuleLoaded:t=>e({draco:t})})}))}(e,n)}(t),await z}(e),r=new L(n);try{return r.parseSync(t,null==e?void 0:e.draco)}finally{r.destroy()}}}},8130:(t,e,n)=>{"use strict";n.d(e,{E:()=>lt});var r={};n.r(r),n.d(r,{decode:()=>D,encode:()=>N});var i={};n.r(i),n.d(i,{decode:()=>z,encode:()=>j});var o={};n.r(o),n.d(o,{decode:()=>U,encode:()=>V});var s={};n.r(s),n.d(s,{decode:()=>G,encode:()=>Z});var a=n(2378);function l(t,e,n){if(t.byteLength<=e+n)return"";const r=new DataView(t);let i="";for(let t=0;t<n;t++)i+=String.fromCharCode(r.getUint8(e+t));return i}var u=n(5680);function c(t,e){if(!t)throw new Error(e||"assert failed: gltf")}function h(t,e){if(t.startsWith("data:")||t.startsWith("http:")||t.startsWith("https:"))return t;const n=e.baseUri||e.uri;if(!n)throw new Error(`'baseUri' must be provided to resolve relative url ${t}`);return n.substr(0,n.lastIndexOf("/")+1)+t}var p=n(7718),f=n(4942),d=n(9105),g=n(6269);function m(t,e){return(0,g.h)(t>=0),(0,g.h)(e>0),t+(e-1)&~(e-1)}function A(t,e,n){let r;if(t instanceof ArrayBuffer)r=new Uint8Array(t);else{const e=t.byteOffset,n=t.byteLength;r=new Uint8Array(t.buffer||t.arrayBuffer,e,n)}return e.set(r,n),n+m(r.byteLength,4)}const y=["SCALAR","VEC2","VEC3","VEC4"],_=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],v=new Map(_),b={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},x={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},w={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function E(t){return y[t-1]||y[0]}function S(t){const e=v.get(t.constructor);if(!e)throw new Error("Illegal typed array");return e}function T(t,e){const n=w[t.componentType],r=b[t.type],i=x[t.componentType],o=t.count*r,s=t.count*r*i;return c(s>=0&&s<=e.byteLength),{ArrayType:n,length:o,byteLength:s}}const P={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]};class M{constructor(t){(0,f.Z)(this,"gltf",void 0),(0,f.Z)(this,"sourceBuffers",void 0),(0,f.Z)(this,"byteLength",void 0),this.gltf=t||{json:{...P},buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(t){return this.json[t]}getExtraData(t){return(this.json.extras||{})[t]}getExtension(t){const e=this.getUsedExtensions().find((e=>e===t)),n=this.json.extensions||{};return e?n[t]||!0:null}getRequiredExtension(t){return this.getRequiredExtensions().find((e=>e===t))?this.getExtension(t):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getObjectExtension(t,e){return(t.extensions||{})[e]}getScene(t){return this.getObject("scenes",t)}getNode(t){return this.getObject("nodes",t)}getSkin(t){return this.getObject("skins",t)}getMesh(t){return this.getObject("meshes",t)}getMaterial(t){return this.getObject("materials",t)}getAccessor(t){return this.getObject("accessors",t)}getTexture(t){return this.getObject("textures",t)}getSampler(t){return this.getObject("samplers",t)}getImage(t){return this.getObject("images",t)}getBufferView(t){return this.getObject("bufferViews",t)}getBuffer(t){return this.getObject("buffers",t)}getObject(t,e){if("object"==typeof e)return e;const n=this.json[t]&&this.json[t][e];if(!n)throw new Error(`glTF file error: Could not find ${t}[${e}]`);return n}getTypedArrayForBufferView(t){const e=(t=this.getBufferView(t)).buffer,n=this.gltf.buffers[e];c(n);const r=(t.byteOffset||0)+n.byteOffset;return new Uint8Array(n.arrayBuffer,r,t.byteLength)}getTypedArrayForAccessor(t){t=this.getAccessor(t);const e=this.getBufferView(t.bufferView),n=this.getBuffer(e.buffer).data,{ArrayType:r,length:i}=T(t,e);return new r(n,e.byteOffset+t.byteOffset,i)}getTypedArrayForImageData(t){t=this.getAccessor(t);const e=this.getBufferView(t.bufferView),n=this.getBuffer(e.buffer).data,r=e.byteOffset||0;return new Uint8Array(n,r,e.byteLength)}addApplicationData(t,e){return this.json[t]=e,this}addExtraData(t,e){return this.json.extras=this.json.extras||{},this.json.extras[t]=e,this}addObjectExtension(t,e,n){return t.extensions=t.extensions||{},t.extensions[e]=n,this.registerUsedExtension(e),this}setObjectExtension(t,e,n){(t.extensions||{})[e]=n}removeObjectExtension(t,e){const n=t.extensions||{},r=n[e];return delete n[e],r}addExtension(t,e={}){return c(e),this.json.extensions=this.json.extensions||{},this.json.extensions[t]=e,this.registerUsedExtension(t),e}addRequiredExtension(t,e={}){return c(e),this.addExtension(t,e),this.registerRequiredExtension(t),e}registerUsedExtension(t){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find((e=>e===t))||this.json.extensionsUsed.push(t)}registerRequiredExtension(t){this.registerUsedExtension(t),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find((e=>e===t))||this.json.extensionsRequired.push(t)}removeExtension(t){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,t),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,t),this.json.extensions&&delete this.json.extensions[t]}setDefaultScene(t){this.json.scene=t}addScene(t){const{nodeIndices:e}=t;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:e}),this.json.scenes.length-1}addNode(t){const{meshIndex:e,matrix:n}=t;this.json.nodes=this.json.nodes||[];const r={mesh:e};return n&&(r.matrix=n),this.json.nodes.push(r),this.json.nodes.length-1}addMesh(t){const{attributes:e,indices:n,material:r,mode:i=4}=t,o={primitives:[{attributes:this._addAttributes(e),mode:i}]};if(n){const t=this._addIndices(n);o.primitives[0].indices=t}return Number.isFinite(r)&&(o.primitives[0].material=r),this.json.meshes=this.json.meshes||[],this.json.meshes.push(o),this.json.meshes.length-1}addPointCloud(t){const e={primitives:[{attributes:this._addAttributes(t),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(e),this.json.meshes.length-1}addImage(t,e){const n=(0,d.I)(t),r=e||(null==n?void 0:n.mimeType),i={bufferView:this.addBufferView(t),mimeType:r};return this.json.images=this.json.images||[],this.json.images.push(i),this.json.images.length-1}addBufferView(t){const e=t.byteLength;c(Number.isFinite(e)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(t);const n={buffer:0,byteOffset:this.byteLength,byteLength:e};return this.byteLength+=m(e,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(n),this.json.bufferViews.length-1}addAccessor(t,e){const n={bufferView:t,type:E(e.size),componentType:e.componentType,count:e.count,max:e.max,min:e.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(n),this.json.accessors.length-1}addBinaryBuffer(t,e={size:3}){const n=this.addBufferView(t);let r={min:e.min,max:e.max};r.min&&r.max||(r=this._getAccessorMinMax(t,e.size));const i={size:e.size,componentType:S(t),count:Math.round(t.length/e.size),min:r.min,max:r.max};return this.addAccessor(n,Object.assign(i,e))}addTexture(t){const{imageIndex:e}=t,n={source:e};return this.json.textures=this.json.textures||[],this.json.textures.push(n),this.json.textures.length-1}addMaterial(t){return this.json.materials=this.json.materials||[],this.json.materials.push(t),this.json.materials.length-1}createBinaryChunk(){var t,e;this.gltf.buffers=[];const n=this.byteLength,r=new ArrayBuffer(n),i=new Uint8Array(r);let o=0;for(const t of this.sourceBuffers||[])o=A(t,i,o);null!==(t=this.json)&&void 0!==t&&null!==(e=t.buffers)&&void 0!==e&&e[0]?this.json.buffers[0].byteLength=n:this.json.buffers=[{byteLength:n}],this.gltf.binary=r,this.sourceBuffers=[r]}_removeStringFromArray(t,e){let n=!0;for(;n;){const r=t.indexOf(e);r>-1?t.splice(r,1):n=!1}}_addAttributes(t={}){const e={};for(const n in t){const r=t[n],i=this._getGltfAttributeName(n),o=this.addBinaryBuffer(r.value,r);e[i]=o}return e}_addIndices(t){return this.addBinaryBuffer(t,{size:1})}_getGltfAttributeName(t){switch(t.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return t}}_getAccessorMinMax(t,e){const n={min:null,max:null};if(t.length<e)return n;n.min=[],n.max=[];const r=t.subarray(0,e);for(const t of r)n.min.push(t),n.max.push(t);for(let r=e;r<t.length;r+=e)for(let i=0;i<e;i++)n.min[0+i]=Math.min(n.min[0+i],t[r+i]),n.max[0+i]=Math.max(n.max[0+i],t[r+i]);return n}}const C="KHR_binary_glTF",I="KHR_draco_mesh_compression",O="KHR_lights_punctual",R="KHR_materials_unlit",L="KHR_techniques_webgl";function k(t){const{buffer:e,size:n,count:r}=function(t){let e=t,n=1,r=0;return t&&t.value&&(e=t.value,n=t.size||1),e&&(ArrayBuffer.isView(e)||(e=function(t,e,n=!1){return t?Array.isArray(t)?new e(t):!n||t instanceof e?t:new e(t):null}(e,Float32Array)),r=e.length/n),{buffer:e,size:n,count:r}}(t);return{value:e,size:n,byteOffset:0,count:r,type:E(n),componentType:S(e)}}async function D(t,e,n){var r;if(null==e||null===(r=e.gltf)||void 0===r||!r.decompressMeshes)return;const i=new M(t),o=[];for(const t of function*(t){for(const e of t.json.meshes||[])for(const t of e.primitives)yield t}(i))i.getObjectExtension(t,I)&&o.push(F(i,t,e,n));await Promise.all(o),i.removeExtension(I)}function N(t,e={}){const n=new M(t);for(const t of n.json.meshes||[])B(t),n.addRequiredExtension(I)}async function F(t,e,n,r){const i=t.getObjectExtension(e,I);if(!i)return;const o=t.getTypedArrayForBufferView(i.bufferView),s=(0,u.qv)(o.buffer,o.byteOffset),{parse:a}=r,l={...n};delete l["3d-tiles"];const c=await a(s,p.VJ,l,r),h=function(t){const e={};for(const n in t){const r=t[n];if("indices"!==n){const t=k(r);e[n]=t}}return e}(c.attributes);for(const[n,r]of Object.entries(h))if(n in e.attributes){const i=e.attributes[n],o=t.getAccessor(i);null!=o&&o.min&&null!=o&&o.max&&(r.min=o.min,r.max=o.max)}e.attributes=h,c.indices&&(e.indices=k(c.indices)),function(t){if(!t.attributes&&Object.keys(t.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}(e)}function B(t,e,n=4,r,i){var o;if(!r.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const s=r.DracoWriter.encodeSync({attributes:t}),a=null==i||null===(o=i.parseSync)||void 0===o?void 0:o.call(i,{attributes:t}),l=r._addFauxAttributes(a.attributes),u=r.addBufferView(s);return{primitives:[{attributes:l,mode:n,extensions:{[I]:{bufferView:u,attributes:l}}}]}}async function z(t){const e=new M(t),{json:n}=e;e.removeExtension(R);for(const t of n.materials||[])t.extensions&&t.extensions.KHR_materials_unlit&&(t.unlit=!0),e.removeObjectExtension(t,R)}function j(t){const e=new M(t),{json:n}=e;if(e.materials)for(const t of n.materials||[])t.unlit&&(delete t.unlit,e.addObjectExtension(t,R,{}),e.addExtension(R))}async function U(t){const e=new M(t),{json:n}=e,r=e.getExtension(O);r&&(e.json.lights=r.lights,e.removeExtension(O));for(const t of n.nodes||[]){const n=e.getObjectExtension(t,O);n&&(t.light=n.light),e.removeObjectExtension(t,O)}}async function V(t){const e=new M(t),{json:n}=e;if(n.lights){const t=e.addExtension(O);c(!t.lights),t.lights=n.lights,delete n.lights}if(e.json.lights){for(const t of e.json.lights){const n=t.node;e.addObjectExtension(n,O,t)}delete e.json.lights}}async function G(t){const e=new M(t),{json:n}=e,r=e.getExtension(L);if(r){const t=function(t,e){const{programs:n=[],shaders:r=[],techniques:i=[]}=t,o=new TextDecoder;return r.forEach((t=>{if(!Number.isFinite(t.bufferView))throw new Error("KHR_techniques_webgl: no shader code");t.code=o.decode(e.getTypedArrayForBufferView(t.bufferView))})),n.forEach((t=>{t.fragmentShader=r[t.fragmentShader],t.vertexShader=r[t.vertexShader]})),i.forEach((t=>{t.program=n[t.program]})),i}(r,e);for(const r of n.materials||[]){const n=e.getObjectExtension(r,L);n&&(r.technique=Object.assign({},n,t[n.technique]),r.technique.values=q(r.technique,e)),e.removeObjectExtension(r,L)}e.removeExtension(L)}}async function Z(t,e){}function q(t,e){const n=Object.assign({},t.values);return Object.keys(t.uniforms||{}).forEach((e=>{t.uniforms[e].value&&!(e in n)&&(n[e]=t.uniforms[e].value)})),Object.keys(n).forEach((t=>{"object"==typeof n[t]&&void 0!==n[t].index&&(n[t].texture=e.getTexture(n[t].index))})),n}const W={KHR_draco_mesh_compression:r,KHR_materials_unlit:i,KHR_lights_punctual:o,KHR_techniques_webgl:s},H={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},X={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class ${constructor(t){this.idToIndexMap={animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}}normalize(t,e){this.json=t.json;const n=t.json;switch(n.asset&&n.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void console.warn(`glTF: Unknown version ${n.asset.version}`)}if(!e.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(n),this._convertTopLevelObjectsToArrays(n),function(t){const e=new M(t),{json:n}=e;for(const t of n.images||[]){const n=e.removeObjectExtension(t,C);n&&Object.assign(t,n)}n.buffers&&n.buffers[0]&&delete n.buffers[0].uri,e.removeExtension(C)}(t),this._convertObjectIdsToArrayIndices(n),this._updateObjects(n),this._updateMaterial(n)}_addAsset(t){t.asset=t.asset||{},t.asset.version="2.0",t.asset.generator=t.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(t){for(const e in H)this._convertTopLevelObjectToArray(t,e)}_convertTopLevelObjectToArray(t,e){const n=t[e];if(n&&!Array.isArray(n)){t[e]=[];for(const r in n){const i=n[r];i.id=i.id||r;const o=t[e].length;t[e].push(i),this.idToIndexMap[e][r]=o}}}_convertObjectIdsToArrayIndices(t){for(const e in H)this._convertIdsToIndices(t,e);"scene"in t&&(t.scene=this._convertIdToIndex(t.scene,"scene"));for(const e of t.textures)this._convertTextureIds(e);for(const e of t.meshes)this._convertMeshIds(e);for(const e of t.nodes)this._convertNodeIds(e);for(const e of t.scenes)this._convertSceneIds(e)}_convertTextureIds(t){t.source&&(t.source=this._convertIdToIndex(t.source,"image"))}_convertMeshIds(t){for(const e of t.primitives){const{attributes:t,indices:n,material:r}=e;for(const e in t)t[e]=this._convertIdToIndex(t[e],"accessor");n&&(e.indices=this._convertIdToIndex(n,"accessor")),r&&(e.material=this._convertIdToIndex(r,"material"))}}_convertNodeIds(t){t.children&&(t.children=t.children.map((t=>this._convertIdToIndex(t,"node")))),t.meshes&&(t.meshes=t.meshes.map((t=>this._convertIdToIndex(t,"mesh"))))}_convertSceneIds(t){t.nodes&&(t.nodes=t.nodes.map((t=>this._convertIdToIndex(t,"node"))))}_convertIdsToIndices(t,e){t[e]||(console.warn(`gltf v1: json doesn't contain attribute ${e}`),t[e]=[]);for(const n of t[e])for(const t in n){const e=n[t],r=this._convertIdToIndex(e,t);n[t]=r}}_convertIdToIndex(t,e){const n=X[e];if(n in this.idToIndexMap){const r=this.idToIndexMap[n][t];if(!Number.isFinite(r))throw new Error(`gltf v1: failed to resolve ${e} with id ${t}`);return r}return t}_updateObjects(t){for(const t of this.json.buffers)delete t.type}_updateMaterial(t){for(const e of t.materials){e.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const n=e.values&&e.values.tex,r=t.textures.findIndex((t=>t.id===n));-1!==r&&(e.pbrMetallicRoughness.baseColorTexture={index:r})}}}const Y={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Q={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},K={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},J={magFilter:K.TEXTURE_MAG_FILTER,minFilter:K.TEXTURE_MIN_FILTER,wrapS:K.TEXTURE_WRAP_S,wrapT:K.TEXTURE_WRAP_T},tt={[K.TEXTURE_MAG_FILTER]:K.LINEAR,[K.TEXTURE_MIN_FILTER]:K.NEAREST_MIPMAP_LINEAR,[K.TEXTURE_WRAP_S]:K.REPEAT,[K.TEXTURE_WRAP_]:K.REPEAT};class et{postProcess(t,e={}){const{json:n,buffers:r=[],images:i=[],baseUri:o=""}=t;return c(n),this.baseUri=o,this.json=n,this.buffers=r,this.images=i,this._resolveTree(this.json,e),this.json}_resolveTree(t,e={}){t.bufferViews&&(t.bufferViews=t.bufferViews.map(((t,e)=>this._resolveBufferView(t,e)))),t.images&&(t.images=t.images.map(((t,e)=>this._resolveImage(t,e)))),t.samplers&&(t.samplers=t.samplers.map(((t,e)=>this._resolveSampler(t,e)))),t.textures&&(t.textures=t.textures.map(((t,e)=>this._resolveTexture(t,e)))),t.accessors&&(t.accessors=t.accessors.map(((t,e)=>this._resolveAccessor(t,e)))),t.materials&&(t.materials=t.materials.map(((t,e)=>this._resolveMaterial(t,e)))),t.meshes&&(t.meshes=t.meshes.map(((t,e)=>this._resolveMesh(t,e)))),t.nodes&&(t.nodes=t.nodes.map(((t,e)=>this._resolveNode(t,e)))),t.skins&&(t.skins=t.skins.map(((t,e)=>this._resolveSkin(t,e)))),t.scenes&&(t.scenes=t.scenes.map(((t,e)=>this._resolveScene(t,e)))),void 0!==t.scene&&(t.scene=t.scenes[this.json.scene])}getScene(t){return this._get("scenes",t)}getNode(t){return this._get("nodes",t)}getSkin(t){return this._get("skins",t)}getMesh(t){return this._get("meshes",t)}getMaterial(t){return this._get("materials",t)}getAccessor(t){return this._get("accessors",t)}getCamera(t){return null}getTexture(t){return this._get("textures",t)}getSampler(t){return this._get("samplers",t)}getImage(t){return this._get("images",t)}getBufferView(t){return this._get("bufferViews",t)}getBuffer(t){return this._get("buffers",t)}_get(t,e){if("object"==typeof e)return e;const n=this.json[t]&&this.json[t][e];return n||console.warn(`glTF file error: Could not find ${t}[${e}]`),n}_resolveScene(t,e){return t.id=t.id||`scene-${e}`,t.nodes=(t.nodes||[]).map((t=>this.getNode(t))),t}_resolveNode(t,e){return t.id=t.id||`node-${e}`,t.children&&(t.children=t.children.map((t=>this.getNode(t)))),void 0!==t.mesh?t.mesh=this.getMesh(t.mesh):void 0!==t.meshes&&t.meshes.length&&(t.mesh=t.meshes.reduce(((t,e)=>{const n=this.getMesh(e);return t.id=n.id,t.primitives=t.primitives.concat(n.primitives),t}),{primitives:[]})),void 0!==t.camera&&(t.camera=this.getCamera(t.camera)),void 0!==t.skin&&(t.skin=this.getSkin(t.skin)),t}_resolveSkin(t,e){return t.id=t.id||`skin-${e}`,t.inverseBindMatrices=this.getAccessor(t.inverseBindMatrices),t}_resolveMesh(t,e){return t.id=t.id||`mesh-${e}`,t.primitives&&(t.primitives=t.primitives.map((t=>{const e=(t={...t}).attributes;t.attributes={};for(const n in e)t.attributes[n]=this.getAccessor(e[n]);return void 0!==t.indices&&(t.indices=this.getAccessor(t.indices)),void 0!==t.material&&(t.material=this.getMaterial(t.material)),t}))),t}_resolveMaterial(t,e){if(t.id=t.id||`material-${e}`,t.normalTexture&&(t.normalTexture={...t.normalTexture},t.normalTexture.texture=this.getTexture(t.normalTexture.index)),t.occlusionTexture&&(t.occlustionTexture={...t.occlustionTexture},t.occlusionTexture.texture=this.getTexture(t.occlusionTexture.index)),t.emissiveTexture&&(t.emmisiveTexture={...t.emmisiveTexture},t.emissiveTexture.texture=this.getTexture(t.emissiveTexture.index)),t.emissiveFactor||(t.emissiveFactor=t.emmisiveTexture?[1,1,1]:[0,0,0]),t.pbrMetallicRoughness){t.pbrMetallicRoughness={...t.pbrMetallicRoughness};const e=t.pbrMetallicRoughness;e.baseColorTexture&&(e.baseColorTexture={...e.baseColorTexture},e.baseColorTexture.texture=this.getTexture(e.baseColorTexture.index)),e.metallicRoughnessTexture&&(e.metallicRoughnessTexture={...e.metallicRoughnessTexture},e.metallicRoughnessTexture.texture=this.getTexture(e.metallicRoughnessTexture.index))}return t}_resolveAccessor(t,e){var n,r;if(t.id=t.id||`accessor-${e}`,void 0!==t.bufferView&&(t.bufferView=this.getBufferView(t.bufferView)),t.bytesPerComponent=(n=t.componentType,Q[n]),t.components=(r=t.type,Y[r]),t.bytesPerElement=t.bytesPerComponent*t.components,t.bufferView){const e=t.bufferView.buffer,{ArrayType:n,byteLength:r}=T(t,t.bufferView),i=(t.bufferView.byteOffset||0)+(t.byteOffset||0)+e.byteOffset,o=e.arrayBuffer.slice(i,i+r);t.value=new n(o)}return t}_resolveTexture(t,e){return t.id=t.id||`texture-${e}`,t.sampler="sampler"in t?this.getSampler(t.sampler):tt,t.source=this.getImage(t.source),t}_resolveSampler(t,e){t.id=t.id||`sampler-${e}`,t.parameters={};for(const e in t){const n=this._enumSamplerParameter(e);void 0!==n&&(t.parameters[n]=t[e])}return t}_enumSamplerParameter(t){return J[t]}_resolveImage(t,e){t.id=t.id||`image-${e}`,void 0!==t.bufferView&&(t.bufferView=this.getBufferView(t.bufferView));const n=this.images[e];return n&&(t.image=n),t}_resolveBufferView(t,e){t.id=t.id||`bufferView-${e}`;const n=t.buffer;t.buffer=this.buffers[n];const r=this.buffers[n].arrayBuffer;let i=this.buffers[n].byteOffset||0;return"byteOffset"in t&&(i+=t.byteOffset),t.data=new Uint8Array(r,i,t.byteLength),t}_resolveCamera(t,e){return t.id=t.id||`camera-${e}`,t.perspective,t.orthographic,t}}const nt=1735152710,rt=!0;function it(t,e,n,r){const i=new Uint8Array(e.buffer,n,r),o=new TextDecoder("utf8").decode(i);return t.json=JSON.parse(o),m(r,4)}function ot(t,e,n,r){return t.header.hasBinChunk=!0,t.binChunks.push({byteOffset:n,byteLength:r,arrayBuffer:e.buffer}),m(r,4)}async function st(t,e,n=0,r,i){var o,s,a,u;!function(t,e,n,r){if(r.uri&&(t.baseUri=r.uri),e instanceof ArrayBuffer&&!function(t,e=0,n={}){const r=new DataView(t),{magic:i=nt}=n,o=r.getUint32(e,!1);return o===i||o===nt}(e,n,r)&&(e=(new TextDecoder).decode(e)),"string"==typeof e)t.json=function(t){try{return JSON.parse(t)}catch(e){throw new Error(`Failed to parse JSON from data starting with "${function(t,e=5){return"string"==typeof t?t.slice(0,e):ArrayBuffer.isView(t)?l(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?l(t,0,e):""}(t)}"`)}}(e);else if(e instanceof ArrayBuffer){const i={};n=function(t,e,n=0,r={}){const i=new DataView(e),o=function(t,e=0){return`${String.fromCharCode(t.getUint8(e+0))}${String.fromCharCode(t.getUint8(e+1))}${String.fromCharCode(t.getUint8(e+2))}${String.fromCharCode(t.getUint8(e+3))}`}(i,n+0),s=i.getUint32(n+4,rt),a=i.getUint32(n+8,rt);switch(Object.assign(t,{header:{byteOffset:n,byteLength:a,hasBinChunk:!1},type:o,version:s,json:{},binChunks:[]}),n+=12,t.version){case 1:return function(t,e,n){(0,g.h)(t.header.byteLength>20);const r=e.getUint32(n+0,rt),i=e.getUint32(n+4,rt);return n+=8,(0,g.h)(0===i),it(t,e,n,r),(n+=r)+ot(t,e,n,t.header.byteLength)}(t,i,n);case 2:return function(t,e,n,r){return(0,g.h)(t.header.byteLength>20),function(t,e,n,r){for(;n+8<=t.header.byteLength;){const i=e.getUint32(n+0,rt),o=e.getUint32(n+4,rt);switch(n+=8,o){case 1313821514:it(t,e,n,i);break;case 5130562:ot(t,e,n,i);break;case 0:r.strict||it(t,e,n,i);break;case 1:r.strict||ot(t,e,n,i)}n+=m(i,4)}}(t,e,n,{}),n+t.header.byteLength}(t,i,n);default:throw new Error(`Invalid GLB version ${t.version}. Only supports v1 and v2.`)}}(i,e,n,r.glb),c("glTF"===i.type,`Invalid GLB magic string ${i.type}`),t._glb=i,t.json=i.json}else c(!1,"GLTF: must be ArrayBuffer or string");const i=t.json.buffers||[];if(t.buffers=new Array(i.length).fill(null),t._glb&&t._glb.header.hasBinChunk){const{binChunks:e}=t._glb;t.buffers[0]={arrayBuffer:e[0].arrayBuffer,byteOffset:e[0].byteOffset,byteLength:e[0].byteLength}}const o=t.json.images||[];t.images=new Array(o.length).fill({})}(t,e,n,r),function(t,e={}){(new $).normalize(t,e)}(t,{normalize:null==r||null===(o=r.gltf)||void 0===o?void 0:o.normalize});const p=[];if(null!=r&&null!==(s=r.gltf)&&void 0!==s&&s.loadBuffers&&t.json.buffers&&await async function(t,e,n){for(let o=0;o<t.json.buffers.length;++o){const s=t.json.buffers[o];if(s.uri){var r,i;const{fetch:a}=n;c(a);const l=h(s.uri,e),u=await(null==n||null===(r=n.fetch)||void 0===r?void 0:r.call(n,l)),p=await(null==u||null===(i=u.arrayBuffer)||void 0===i?void 0:i.call(u));t.buffers[o]={arrayBuffer:p,byteOffset:0,byteLength:p.byteLength},delete s.uri}}}(t,r,i),null!=r&&null!==(a=r.gltf)&&void 0!==a&&a.loadImages){const e=async function(t,e,n){const r=t.json.images||[],i=[];for(let o=0;o<r.length;++o)i.push(at(t,r[o],o,e,n));return await Promise.all(i)}(t,r,i);p.push(e)}const f=async function(t,e={},n){for(const i in W){var r;const o=(null==e||null===(r=e.gltf)||void 0===r?void 0:r.excludeExtensions)||{};if(!(i in o)||o[i]){const r=W[i];await r.decode(t,e,n)}}}(t,r,i);return p.push(f),await Promise.all(p),null!=r&&null!==(u=r.gltf)&&void 0!==u&&u.postProcess?function(t,e){return(new et).postProcess(t,e)}(t,r):t}async function at(t,e,n,r,i){const{fetch:o,parse:s}=i;let l;if(e.uri){const t=h(e.uri,r),n=await o(t);l=await n.arrayBuffer()}if(Number.isFinite(e.bufferView)){const n=function(t,e,n){const r=t.bufferViews[n];c(r);const i=e[r.buffer];c(i);const o=(r.byteOffset||0)+i.byteOffset;return new Uint8Array(i.arrayBuffer,o,r.byteLength)}(t.json,t.buffers,e.bufferView);l=(0,u.qv)(n.buffer,n.byteOffset,n.byteLength)}c(l,"glTF image has no data");const p=await s(l,a.S,{},i);t.images[n]=p}const lt={name:"glTF",id:"gltf",module:"gltf",version:"3.0.12",extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:async function(t,e={},n){(e={...lt.options,...e}).gltf={...lt.options.gltf,...e.gltf};const{byteOffset:r=0}=e;return await st({},t,r,e,n)},options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}}},2378:(t,e,n)=>{"use strict";function r(t,e){if(!t)throw new Error(e)}n.d(e,{S:()=>x});const i={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==n.g&&n.g,document:"undefined"!=typeof document&&document},o=i.global||i.self||i.window,s="object"!=typeof process||"[object process]"!==String(process)||process.browser,a="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),{_parseImageNode:l}=(a&&parseFloat(a[1]),o),u="undefined"!=typeof Image,c="undefined"!=typeof ImageBitmap,h=Boolean(l),p=!!s||h;function f(t){const e=function(t){return"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&t instanceof Image?"image":t&&"object"==typeof t&&t.data&&t.width&&t.height?"data":null}(t);if(!e)throw new Error("Not an image");return e}const d=/^data:image\/svg\+xml/,g=/\.svg((\?|#).*)?$/;function m(t){return t&&(d.test(t)||g.test(t))}function A(t,e){if(m(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function y(t,e,n){const r=function(t,e){if(m(e)){let e=(new TextDecoder).decode(t);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(e=unescape(encodeURIComponent(e)))}catch(t){throw new Error(t.message)}return`data:image/svg+xml;base64,${btoa(e)}`}return A(t,e)}(t,n),i=self.URL||self.webkitURL,o="string"!=typeof r&&i.createObjectURL(r);try{return await async function(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise(((e,r)=>{try{n.onload=()=>e(n),n.onerror=e=>r(new Error(`Could not load image ${t}: ${e}`))}catch(t){r(t)}}))}(o||r,e)}finally{o&&i.revokeObjectURL(o)}}const _={};let v=!0;var b=n(9105);const x={id:"image",module:"images",name:"Images",version:"3.0.12",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:async function(t,e,n){const i=((e=e||{}).image||{}).type||"auto",{url:s}=n||{};let a;switch(function(t){switch(t){case"auto":case"data":return function(){if(c)return"imagebitmap";if(u)return"image";if(p)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(t){switch(t){case"auto":return c||u||p;case"imagebitmap":return c;case"image":return u;case"data":return p;default:throw new Error(`@loaders.gl/images: image ${t} not supported in this environment`)}}(t),t}}(i)){case"imagebitmap":a=await async function(t,e,n){let r;r=m(n)?await y(t,e,n):A(t,n);const i=e&&e.imagebitmap;return await async function(t,e=null){if(!function(t){for(const e in t||_)return!1;return!0}(e)&&v||(e=null),e)try{return await createImageBitmap(t,e)}catch(t){console.warn(t),v=!1}return await createImageBitmap(t)}(r,i)}(t,e,s);break;case"image":a=await y(t,e,s);break;case"data":a=await function(t,e){const{mimeType:n}=(0,b.I)(t)||{},{_parseImageNode:i}=o;return r(i),i(t,n,e)}(t,e);break;default:r(!1)}return"data"===i&&(a=function(t){switch(f(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}(a)),a},tests:[t=>Boolean((0,b.I)(new DataView(t)))],options:{image:{type:"auto",decode:!0}}}},9105:(t,e,n)=>{"use strict";n.d(e,{I:()=>o});const r=!1,i=!0;function o(t){const e=s(t);return function(t){const e=s(t);return e.byteLength>=24&&2303741511===e.getUint32(0,r)?{mimeType:"image/png",width:e.getUint32(16,r),height:e.getUint32(20,r)}:null}(e)||function(t){const e=s(t);if(!(e.byteLength>=3&&65496===e.getUint16(0,r)&&255===e.getUint8(2)))return null;const{tableMarkers:n,sofMarkers:i}=function(){const t=new Set([65499,65476,65484,65501,65534]);for(let e=65504;e<65520;++e)t.add(e);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}();let o=2;for(;o+9<e.byteLength;){const t=e.getUint16(o,r);if(i.has(t))return{mimeType:"image/jpeg",height:e.getUint16(o+5,r),width:e.getUint16(o+7,r)};if(!n.has(t))return null;o+=2,o+=e.getUint16(o,r)}return null}(e)||function(t){const e=s(t);return e.byteLength>=10&&1195984440===e.getUint32(0,r)?{mimeType:"image/gif",width:e.getUint16(6,i),height:e.getUint16(8,i)}:null}(e)||function(t){const e=s(t);return e.byteLength>=14&&16973===e.getUint16(0,r)&&e.getUint32(2,i)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,i),height:e.getUint32(22,i)}:null}(e)}function s(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}},5680:(t,e,n)=>{"use strict";n.d(e,{Xq:()=>o,JY:()=>s,qv:()=>a,rJ:()=>i});var r=n(9521);function i(t){var e;if((e=t)&&"object"==typeof e&&e.isBuffer&&(t=function(t){return r.toArrayBuffer?r.toArrayBuffer(t):t}(t)),t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return 0===t.byteOffset&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if("string"==typeof t){const e=t;return(new TextEncoder).encode(e).buffer}if(t&&"object"==typeof t&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function o(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let t=0;t<r.length;++t)if(r[t]!==i[t])return!1;return!0}function s(...t){const e=t.map((t=>t instanceof ArrayBuffer?new Uint8Array(t):t)),n=e.reduce(((t,e)=>t+e.byteLength),0),r=new Uint8Array(n);let i=0;for(const t of e)r.set(t,i),i+=t.byteLength;return r.buffer}function a(t,e,n){const r=void 0!==n?new Uint8Array(t).subarray(e,e+n):new Uint8Array(t).subarray(e);return new Uint8Array(r).buffer}},6269:(t,e,n)=>{"use strict";function r(t,e){if(!t)throw new Error(e||"loader assertion failed.")}n.d(e,{h:()=>r})},4959:(t,e,n)=>{"use strict";n.d(e,{CO:()=>i,jU:()=>o});const r={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==n.g&&n.g,document:"undefined"!=typeof document&&document},i=r.global||r.self||r.window||{},o="object"!=typeof process||"[object process]"!==String(process)||process.browser,s="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);s&&parseFloat(s[1])},6040:(t,e,n)=>{"use strict";function r(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}n.d(e,{h:()=>r})},6013:(t,e,n)=>{"use strict";n.d(e,{CO:()=>i,jU:()=>o,hJ:()=>s,tq:()=>a});const r={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==n.g&&n.g,document:"undefined"!=typeof document&&document},i=r.global||r.self||r.window||{},o="object"!=typeof process||"[object process]"!==String(process)||process.browser,s="function"==typeof importScripts,a="undefined"!=typeof window&&void 0!==window.orientation,l="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);l&&parseFloat(l[1])},9757:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});const r={DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,FUNC_ADD:32774,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,BLEND_COLOR:32773,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,VENDOR:7936,RENDERER:7937,VERSION:7938,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,BROWSER_DEFAULT_WEBGL:37444,STATIC_DRAW:35044,STREAM_DRAW:35040,DYNAMIC_DRAW:35048,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,CULL_FACE:2884,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,BLEND:3042,DEPTH_TEST:2929,DITHER:3024,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,SCISSOR_TEST:3089,STENCIL_TEST:2960,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CONTEXT_LOST_WEBGL:37442,CW:2304,CCW:2305,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,COMPILE_STATUS:35713,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_ATTRIBUTES:35721,ACTIVE_UNIFORMS:35718,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,ALWAYS:519,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,GEQUAL:518,NOTEQUAL:517,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,TEXTURE_WIDTH:4096,TEXTURE_HEIGHT:4097,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,MAX_3D_TEXTURE_SIZE:32883,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,MAX_TEXTURE_LOD_BIAS:34045,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,RASTERIZER_DISCARD:35977,VERTEX_ARRAY_BINDING:34229,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,MAX_ELEMENT_INDEX:36203,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,RGB9_E5:35901,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,RGB10_A2UI:36975,TEXTURE_IMMUTABLE_FORMAT:37167,TEXTURE_IMMUTABLE_LEVELS:33503,UNSIGNED_INT_2_10_10_10_REV:33640,UNSIGNED_INT_10F_11F_11F_REV:35899,UNSIGNED_INT_5_9_9_9_REV:35902,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,UNSIGNED_INT_24_8:34042,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,INT_2_10_10_10_REV:36255,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,MAX_SAMPLES:36183,SAMPLER_BINDING:35097,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,UNSIGNED_NORMALIZED:35863,SIGNED_NORMALIZED:36764,VERTEX_ATTRIB_ARRAY_INTEGER:35069,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,DEPTH24_STENCIL8:35056,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,COLOR:6144,DEPTH:6145,STENCIL:6146,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,INVALID_INDEX:4294967295,TIMEOUT_IGNORED:-1,MAX_CLIENT_WAIT_TIMEOUT_WEBGL:37447,VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,UNMASKED_VENDOR_WEBGL:37445,UNMASKED_RENDERER_WEBGL:37446,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047,TEXTURE_MAX_ANISOTROPY_EXT:34046,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35986,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,UNSIGNED_INT_24_8_WEBGL:34042,HALF_FLOAT_OES:36193,RGBA32F_EXT:34836,RGB32F_EXT:34837,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,UNSIGNED_NORMALIZED_EXT:35863,MIN_EXT:32775,MAX_EXT:32776,SRGB_EXT:35904,SRGB_ALPHA_EXT:35906,SRGB8_ALPHA8_EXT:35907,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT:33296,FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723,COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067,COLOR_ATTACHMENT4_WEBGL:36068,COLOR_ATTACHMENT5_WEBGL:36069,COLOR_ATTACHMENT6_WEBGL:36070,COLOR_ATTACHMENT7_WEBGL:36071,COLOR_ATTACHMENT8_WEBGL:36072,COLOR_ATTACHMENT9_WEBGL:36073,COLOR_ATTACHMENT10_WEBGL:36074,COLOR_ATTACHMENT11_WEBGL:36075,COLOR_ATTACHMENT12_WEBGL:36076,COLOR_ATTACHMENT13_WEBGL:36077,COLOR_ATTACHMENT14_WEBGL:36078,COLOR_ATTACHMENT15_WEBGL:36079,DRAW_BUFFER0_WEBGL:34853,DRAW_BUFFER1_WEBGL:34854,DRAW_BUFFER2_WEBGL:34855,DRAW_BUFFER3_WEBGL:34856,DRAW_BUFFER4_WEBGL:34857,DRAW_BUFFER5_WEBGL:34858,DRAW_BUFFER6_WEBGL:34859,DRAW_BUFFER7_WEBGL:34860,DRAW_BUFFER8_WEBGL:34861,DRAW_BUFFER9_WEBGL:34862,DRAW_BUFFER10_WEBGL:34863,DRAW_BUFFER11_WEBGL:34864,DRAW_BUFFER12_WEBGL:34865,DRAW_BUFFER13_WEBGL:34866,DRAW_BUFFER14_WEBGL:34867,DRAW_BUFFER15_WEBGL:34868,MAX_COLOR_ATTACHMENTS_WEBGL:36063,MAX_DRAW_BUFFERS_WEBGL:34852,VERTEX_ARRAY_BINDING_OES:34229,QUERY_COUNTER_BITS_EXT:34916,CURRENT_QUERY_EXT:34917,QUERY_RESULT_EXT:34918,QUERY_RESULT_AVAILABLE_EXT:34919,TIME_ELAPSED_EXT:35007,TIMESTAMP_EXT:36392,GPU_DISJOINT_EXT:36795}},2150:(t,e,n)=>{"use strict";n.r(e),n.d(e,{AnimationLoop:()=>I.Z,Buffer:()=>a.Z,ClipSpace:()=>D.Z,ConeGeometry:()=>x,CubeGeometry:()=>N.Z,CylinderGeometry:()=>w,FEATURES:()=>o.h,Framebuffer:()=>u.Z,Geometry:()=>y.Z,IcoSphereGeometry:()=>P,Model:()=>O.Z,PlaneGeometry:()=>M,Program:()=>l.Z,ProgramManager:()=>L.Z,Renderbuffer:()=>c.Z,SphereGeometry:()=>C,Texture2D:()=>h.Z,Texture3D:()=>m.Z,TextureCube:()=>p.Z,Timeline:()=>k.T,Transform:()=>R.Z,TransformFeedback:()=>A.Z,TruncatedConeGeometry:()=>b,assert:()=>tt.h,clear:()=>f.Z,cloneTextureFrom:()=>g.h,copyToTexture:()=>d.Lv,createGLContext:()=>r.s9,cssToDevicePixels:()=>r.JY,cssToDeviceRatio:()=>r.w,dirlight:()=>X,fp32:()=>Y.O,fp64:()=>U,getParameters:()=>r.ZS,gouraudLighting:()=>K.N,hasFeature:()=>s.U6,hasFeatures:()=>s.ag,instrumentGLContext:()=>r.yW,isWebGL:()=>r.UF,isWebGL2:()=>r.D0,log:()=>r.cM,lumaStats:()=>i.l,normalizeShaderModule:()=>$.v,pbr:()=>J.b,phongLighting:()=>K.s,picking:()=>Q.q,project:()=>W,readPixelsToArray:()=>d.z6,readPixelsToBuffer:()=>d.Jb,resetParameters:()=>r.kL,setParameters:()=>r.dR,uid:()=>_.hQ,withParameters:()=>r.s8});var r=n(9450),i=n(9835),o=n(6948),s=n(4211),a=n(3478),l=n(7944),u=n(3849),c=n(9830),h=n(4912),p=n(7952),f=n(6047),d=n(1953),g=n(3296),m=n(1319),A=n(1053),y=n(3982),_=n(4538);const v={x:[2,0,1],y:[0,1,2],z:[1,2,0]};class b extends y.Z{constructor(t={}){const{id:e=(0,_.hQ)("truncated-code-geometry")}=t,{indices:n,attributes:r}=function(t){const{bottomRadius:e=0,topRadius:n=0,height:r=1,nradial:i=10,nvertical:o=10,verticalAxis:s="y",topCap:a=!1,bottomCap:l=!1}=t,u=(a?2:0)+(l?2:0),c=(i+1)*(o+1+u),h=Math.atan2(e-n,r),p=Math.sin,f=Math.cos,d=Math.PI,g=f(h),m=p(h),A=a?-2:0,y=o+(l?2:0),_=i+1,b=new Uint16Array(i*(o+u)*6),x=v[s],w=new Float32Array(3*c),E=new Float32Array(3*c),S=new Float32Array(2*c);let T=0,P=0;for(let t=A;t<=y;t++){let s,a=t/o,l=r*a;t<0?(l=0,a=1,s=e):t>o?(l=r,a=1,s=n):s=e+t/o*(n-e),-2!==t&&t!==o+2||(s=0,a=0),l-=r/2;for(let e=0;e<_;e++){const n=p(e*d*2/i),r=f(e*d*2/i);w[T+x[0]]=n*s,w[T+x[1]]=l,w[T+x[2]]=r*s,E[T+x[0]]=t<0||t>o?0:n*g,E[T+x[1]]=t<0?-1:t>o?1:m,E[T+x[2]]=t<0||t>o?0:r*g,S[P+0]=e/i,S[P+1]=a,P+=2,T+=3}}for(let t=0;t<o+u;t++)for(let e=0;e<i;e++){const n=6*(t*i+e);b[n+0]=_*(t+0)+0+e,b[n+1]=_*(t+0)+1+e,b[n+2]=_*(t+1)+1+e,b[n+3]=_*(t+0)+0+e,b[n+4]=_*(t+1)+1+e,b[n+5]=_*(t+1)+0+e}return{indices:b,attributes:{POSITION:{size:3,value:w},NORMAL:{size:3,value:E},TEXCOORD_0:{size:2,value:S}}}}(t);super({...t,id:e,indices:n,attributes:{...r,...t.attributes}})}}class x extends b{constructor(t={}){const{id:e=(0,_.hQ)("cone-geometry"),radius:n=1,cap:r=!0}=t;super({...t,id:e,topRadius:0,topCap:Boolean(r),bottomCap:Boolean(r),bottomRadius:n})}}class w extends b{constructor(t={}){const{id:e=(0,_.hQ)("cylinder-geometry"),radius:n=1}=t;super({...t,id:e,bottomRadius:n,topRadius:n})}}var E=n(3855);const S=[-1,0,0,0,1,0,0,0,-1,0,0,1,0,-1,0,1,0,0],T=[3,4,5,3,5,1,3,1,0,3,0,4,4,0,2,4,2,5,2,0,1,5,2,1];class P extends y.Z{constructor(t={}){const{id:e=(0,_.hQ)("ico-sphere-geometry")}=t,{indices:n,attributes:r}=function(t){const{iterations:e=0}=t,n=Math.PI,r=2*n,i=[...S];let o=[...T];i.push(),o.push();const s=(()=>{const t={};return(e,n)=>{const r=`${(e*=3)<(n*=3)?e:n}|${e>n?e:n}`;if(r in t)return t[r];const o=i[e],s=i[e+1],a=i[e+2];let l=(o+i[n])/2,u=(s+i[n+1])/2,c=(a+i[n+2])/2;const h=Math.sqrt(l*l+u*u+c*c);return l/=h,u/=h,c/=h,i.push(l,u,c),t[r]=i.length/3-1}})();for(let t=0;t<e;t++){const t=[];for(let e=0;e<o.length;e+=3){const n=s(o[e+0],o[e+1]),r=s(o[e+1],o[e+2]),i=s(o[e+2],o[e+0]);t.push(i,o[e+0],n,n,o[e+1],r,r,o[e+2],i,n,r,i)}o=t}const a=new Array(i.length),l=new Array(i.length/3*2);for(let t=o.length-3;t>=0;t-=3){const e=o[t+0],s=o[t+1],u=o[t+2],c=3*e,h=3*s,p=3*u,f=2*e,d=2*s,g=2*u,m=i[c+0],A=i[c+1],y=i[c+2],_=Math.acos(y/Math.sqrt(m*m+A*A+y*y))/n,v=1-(Math.atan2(A,m)+n)/r,b=i[h+0],x=i[h+1],w=i[h+2],S=Math.acos(w/Math.sqrt(b*b+x*x+w*w))/n,T=1-(Math.atan2(x,b)+n)/r,P=i[p+0],M=i[p+1],C=i[p+2],I=Math.acos(C/Math.sqrt(P*P+M*M+C*C))/n,O=1-(Math.atan2(M,P)+n)/r,R=[P-b,M-x,C-w],L=[m-b,A-x,y-w],k=new E.Z(R).cross(L).normalize();let D;(0===v||0===T||0===O)&&(0===v||v>.5)&&(0===T||T>.5)&&(0===O||O>.5)&&(i.push(i[c+0],i[c+1],i[c+2]),D=i.length/3-1,o.push(D),l[2*D+0]=1,l[2*D+1]=_,a[3*D+0]=k.x,a[3*D+1]=k.y,a[3*D+2]=k.z,i.push(i[h+0],i[h+1],i[h+2]),D=i.length/3-1,o.push(D),l[2*D+0]=1,l[2*D+1]=S,a[3*D+0]=k.x,a[3*D+1]=k.y,a[3*D+2]=k.z,i.push(i[p+0],i[p+1],i[p+2]),D=i.length/3-1,o.push(D),l[2*D+0]=1,l[2*D+1]=I,a[3*D+0]=k.x,a[3*D+1]=k.y,a[3*D+2]=k.z),a[c+0]=a[h+0]=a[p+0]=k.x,a[c+1]=a[h+1]=a[p+1]=k.y,a[c+2]=a[h+2]=a[p+2]=k.z,l[f+0]=v,l[f+1]=_,l[d+0]=T,l[d+1]=S,l[g+0]=O,l[g+1]=I}return{indices:{size:1,value:new Uint16Array(o)},attributes:{POSITION:{size:3,value:new Float32Array(i)},NORMAL:{size:3,value:new Float32Array(a)},TEXCOORD_0:{size:2,value:new Float32Array(l)}}}}(t);super({...t,id:e,indices:n,attributes:{...r,...t.attributes}})}}class M extends y.Z{constructor(t={}){const{id:e=(0,_.hQ)("plane-geometry")}=t,{indices:n,attributes:r}=function(t){const{type:e="x,y",offset:n=0,flipCull:r=!1,unpack:i=!1}=t,o=e.split(",");let s=t[`${o[0]}len`]||1;const a=t[`${o[1]}len`]||1,l=t[`n${o[0]}`]||1,u=t[`n${o[1]}`]||1,c=(l+1)*(u+1),h=new Float32Array(3*c),p=new Float32Array(3*c),f=new Float32Array(2*c);r&&(s=-s);let d=0,g=0;for(let t=0;t<=u;t++)for(let i=0;i<=l;i++){const o=i/l,c=t/u;switch(f[d+0]=r?1-o:o,f[d+1]=c,e){case"x,y":h[g+0]=s*o-.5*s,h[g+1]=a*c-.5*a,h[g+2]=n,p[g+0]=0,p[g+1]=0,p[g+2]=r?1:-1;break;case"x,z":h[g+0]=s*o-.5*s,h[g+1]=n,h[g+2]=a*c-.5*a,p[g+0]=0,p[g+1]=r?1:-1,p[g+2]=0;break;case"y,z":h[g+0]=n,h[g+1]=s*o-.5*s,h[g+2]=a*c-.5*a,p[g+0]=r?1:-1,p[g+1]=0,p[g+2]=0;break;default:throw new Error("PlaneGeometry: unknown type")}d+=2,g+=3}const m=l+1,A=new Uint16Array(l*u*6);for(let t=0;t<u;t++)for(let e=0;e<l;e++){const n=6*(t*l+e);A[n+0]=(t+0)*m+e,A[n+1]=(t+1)*m+e,A[n+2]=(t+0)*m+e+1,A[n+3]=(t+1)*m+e,A[n+4]=(t+1)*m+e+1,A[n+5]=(t+0)*m+e+1}const y={indices:{size:1,value:A},attributes:{POSITION:{size:3,value:h},NORMAL:{size:3,value:p},TEXCOORD_0:{size:2,value:f}}};return i?function(t){const{indices:e,attributes:n}=t;if(!e)return t;const r=e.value.length,i={};for(const t in n){const o=n[t],{constant:s,value:a,size:l}=o;if(s||!l)continue;const u=new a.constructor(r*l);for(let t=0;t<r;++t){const n=e.value[t];for(let e=0;e<l;e++)u[t*l+e]=a[n*l+e]}i[t]={size:l,value:u}}return{attributes:Object.assign({},n,i)}}(y):y}(t);super({...t,id:e,indices:n,attributes:{...r,...t.attributes}})}}class C extends y.Z{constructor(t={}){const{id:e=(0,_.hQ)("sphere-geometry")}=t,{indices:n,attributes:r}=function(t){const{nlat:e=10,nlong:n=10}=t;let{radius:r=1}=t;const i=Math.PI-0,o=2*Math.PI-0,s=(e+1)*(n+1);if("number"==typeof r){const t=r;r=(e,n,r,i,o)=>t}const a=new Float32Array(3*s),l=new Float32Array(3*s),u=new Float32Array(2*s),c=new(s>65535?Uint32Array:Uint16Array)(e*n*6);for(let t=0;t<=e;t++)for(let s=0;s<=n;s++){const c=s/n,h=t/e,p=s+t*(n+1),f=2*p,d=3*p,g=o*c,m=i*h,A=Math.sin(g),y=Math.cos(g),_=Math.sin(m),v=y*_,b=Math.cos(m),x=A*_,w=r(v,b,x,c,h);a[d+0]=w*v,a[d+1]=w*b,a[d+2]=w*x,l[d+0]=v,l[d+1]=b,l[d+2]=x,u[f+0]=c,u[f+1]=1-h}const h=n+1;for(let t=0;t<n;t++)for(let n=0;n<e;n++){const r=6*(t*e+n);c[r+0]=n*h+t,c[r+1]=n*h+t+1,c[r+2]=(n+1)*h+t,c[r+3]=(n+1)*h+t,c[r+4]=n*h+t+1,c[r+5]=(n+1)*h+t+1}return{indices:{size:1,value:c},attributes:{POSITION:{size:3,value:a},NORMAL:{size:3,value:l},TEXCOORD_0:{size:2,value:u}}}}(t);super({...t,id:e,indices:n,attributes:{...r,...t.attributes}})}}var I=n(9902),O=n(1113),R=n(3346),L=n(1731),k=n(8055),D=n(6234),N=n(1167);function F(t,e=[],n=0){const r=Math.fround(t),i=t-r;return e[n]=r,e[n+1]=i,e}function B(t){return t-Math.fround(t)}function z(t){const e=new Float32Array(32);for(let n=0;n<4;++n)for(let r=0;r<4;++r){const i=4*n+r;F(t[4*r+n],e,2*i)}return e}const j={ONE:1},U={name:"fp64",vs:"const vec2 E_FP64 = vec2(2.7182817459106445e+00, 8.254840366817007e-08);\nconst vec2 LOG2_FP64 = vec2(0.6931471824645996e+00, -1.9046542121259336e-09);\nconst vec2 PI_FP64 = vec2(3.1415927410125732, -8.742278012618954e-8);\nconst vec2 TWO_PI_FP64 = vec2(6.2831854820251465, -1.7484556025237907e-7);\nconst vec2 PI_2_FP64 = vec2(1.5707963705062866, -4.371139006309477e-8);\nconst vec2 PI_4_FP64 = vec2(0.7853981852531433, -2.1855695031547384e-8);\nconst vec2 PI_16_FP64 = vec2(0.19634954631328583, -5.463923757886846e-9);\nconst vec2 PI_16_2_FP64 = vec2(0.39269909262657166, -1.0927847515773692e-8);\nconst vec2 PI_16_3_FP64 = vec2(0.5890486240386963, -1.4906100798128818e-9);\nconst vec2 PI_180_FP64 = vec2(0.01745329238474369, 1.3519960498364902e-10);\n\nconst vec2 SIN_TABLE_0_FP64 = vec2(0.19509032368659973, -1.6704714833615242e-9);\nconst vec2 SIN_TABLE_1_FP64 = vec2(0.3826834261417389, 6.22335089017767e-9);\nconst vec2 SIN_TABLE_2_FP64 = vec2(0.5555702447891235, -1.1769521357507529e-8);\nconst vec2 SIN_TABLE_3_FP64 = vec2(0.7071067690849304, 1.2101617041793133e-8);\n\nconst vec2 COS_TABLE_0_FP64 = vec2(0.9807852506637573, 2.9739473106360492e-8);\nconst vec2 COS_TABLE_1_FP64 = vec2(0.9238795042037964, 2.8307490351764386e-8);\nconst vec2 COS_TABLE_2_FP64 = vec2(0.8314695954322815, 1.6870263741530778e-8);\nconst vec2 COS_TABLE_3_FP64 = vec2(0.7071067690849304, 1.2101617152815436e-8);\n\nconst vec2 INVERSE_FACTORIAL_3_FP64 = vec2(1.666666716337204e-01, -4.967053879312289e-09);\nconst vec2 INVERSE_FACTORIAL_4_FP64 = vec2(4.16666679084301e-02, -1.2417634698280722e-09);\nconst vec2 INVERSE_FACTORIAL_5_FP64 = vec2(8.333333767950535e-03, -4.34617203337595e-10);\nconst vec2 INVERSE_FACTORIAL_6_FP64 = vec2(1.3888889225199819e-03, -3.3631094437103215e-11);\nconst vec2 INVERSE_FACTORIAL_7_FP64 = vec2(1.9841270113829523e-04,  -2.725596874933456e-12);\nconst vec2 INVERSE_FACTORIAL_8_FP64 = vec2(2.4801587642286904e-05, -3.406996025904184e-13);\nconst vec2 INVERSE_FACTORIAL_9_FP64 = vec2(2.75573188446287533e-06, 3.7935713937038186e-14);\nconst vec2 INVERSE_FACTORIAL_10_FP64 = vec2(2.755731998149713e-07, -7.575112367869873e-15);\n\nfloat nint(float d) {\n    if (d == floor(d)) return d;\n    return floor(d + 0.5);\n}\n\nvec2 nint_fp64(vec2 a) {\n    float hi = nint(a.x);\n    float lo;\n    vec2 tmp;\n    if (hi == a.x) {\n        lo = nint(a.y);\n        tmp = quickTwoSum(hi, lo);\n    } else {\n        lo = 0.0;\n        if (abs(hi - a.x) == 0.5 && a.y < 0.0) {\n            hi -= 1.0;\n        }\n        tmp = vec2(hi, lo);\n    }\n    return tmp;\n}\n\nvec2 exp_fp64(vec2 a) {\n\n  const int k_power = 4;\n  const float k = 16.0;\n\n  const float inv_k = 1.0 / k;\n\n  if (a.x <= -88.0) return vec2(0.0, 0.0);\n  if (a.x >= 88.0) return vec2(1.0 / 0.0, 1.0 / 0.0);\n  if (a.x == 0.0 && a.y == 0.0) return vec2(1.0, 0.0);\n  if (a.x == 1.0 && a.y == 0.0) return E_FP64;\n\n  float m = floor(a.x / LOG2_FP64.x + 0.5);\n  vec2 r = sub_fp64(a, mul_fp64(LOG2_FP64, vec2(m, 0.0))) * inv_k;\n  vec2 s, t, p;\n\n  p = mul_fp64(r, r);\n  s = sum_fp64(r, p * 0.5);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_3_FP64);\n\n  s = sum_fp64(s, t);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_4_FP64);\n\n  s = sum_fp64(s, t);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_5_FP64);\n\n\n\n\n\n\n  s = sum_fp64(s, t);\n  for (int i = 0; i < k_power; i++) {\n    s = sum_fp64(s * 2.0, mul_fp64(s, s));\n  }\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n  s = sum_fp64(s, vec2(ONE, 0.0));\n#else\n  s = sum_fp64(s, vec2(1.0, 0.0));\n#endif\n\n  return s * pow(2.0, m);\n}\n\nvec2 log_fp64(vec2 a)\n{\n  if (a.x == 1.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x <= 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n  vec2 x = vec2(log(a.x), 0.0);\n  vec2 s;\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n  s = vec2(ONE, 0.0);\n#else\n  s = vec2(1.0, 0.0);\n#endif\n\n  x = sub_fp64(sum_fp64(x, mul_fp64(a, exp_fp64(-x))), s);\n  return x;\n}\n\nvec2 sin_taylor_fp64(vec2 a) {\n  vec2 r, s, t, x;\n\n  if (a.x == 0.0 && a.y == 0.0) {\n    return vec2(0.0, 0.0);\n  }\n\n  x = -mul_fp64(a, a);\n  s = a;\n  r = a;\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_3_FP64);\n  s = sum_fp64(s, t);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_5_FP64);\n  s = sum_fp64(s, t);\n\n\n\n\n\n\n  return s;\n}\n\nvec2 cos_taylor_fp64(vec2 a) {\n  vec2 r, s, t, x;\n\n  if (a.x == 0.0 && a.y == 0.0) {\n    return vec2(1.0, 0.0);\n  }\n\n  x = -mul_fp64(a, a);\n  r = x;\n  s = sum_fp64(vec2(1.0, 0.0), r * 0.5);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_4_FP64);\n  s = sum_fp64(s, t);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_6_FP64);\n  s = sum_fp64(s, t);\n\n\n\n\n\n\n  return s;\n}\n\nvoid sincos_taylor_fp64(vec2 a, out vec2 sin_t, out vec2 cos_t) {\n  if (a.x == 0.0 && a.y == 0.0) {\n    sin_t = vec2(0.0, 0.0);\n    cos_t = vec2(1.0, 0.0);\n  }\n\n  sin_t = sin_taylor_fp64(a);\n  cos_t = sqrt_fp64(sub_fp64(vec2(1.0, 0.0), mul_fp64(sin_t, sin_t)));\n}\n\nvec2 sin_fp64(vec2 a) {\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(0.0, 0.0);\n    }\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n\n    if (k == 0) {\n        if (j == 0) {\n            return sin_taylor_fp64(t);\n        } else if (j == 1) {\n            return cos_taylor_fp64(t);\n        } else if (j == -1) {\n            return -cos_taylor_fp64(t);\n        } else {\n            return -sin_taylor_fp64(t);\n        }\n    }\n\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n    if (abs(float(abs_k) - 1.0) < 0.5) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs(float(abs_k) - 2.0) < 0.5) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs(float(abs_k) - 3.0) < 0.5) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs(float(abs_k) - 4.0) < 0.5) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#else\n    if (abs_k == 1) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs_k == 2) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs_k == 3) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs_k == 4) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#endif\n\n    vec2 sin_t, cos_t;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n\n\n    vec2 result = vec2(0.0, 0.0);\n    if (j == 0) {\n        if (k > 0) {\n            result = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        }\n    } else if (j == 1) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            result = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    } else if (j == -1) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        } else {\n            result = -sum_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        }\n    } else {\n        if (k > 0) {\n            result = -sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(v, cos_t), mul_fp64(u, sin_t));\n        }\n    }\n\n    return result;\n}\n\nvec2 cos_fp64(vec2 a) {\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(1.0, 0.0);\n    }\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n\n    if (k == 0) {\n        if (j == 0) {\n            return cos_taylor_fp64(t);\n        } else if (j == 1) {\n            return -sin_taylor_fp64(t);\n        } else if (j == -1) {\n            return sin_taylor_fp64(t);\n        } else {\n            return -cos_taylor_fp64(t);\n        }\n    }\n\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n    if (abs(float(abs_k) - 1.0) < 0.5) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs(float(abs_k) - 2.0) < 0.5) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs(float(abs_k) - 3.0) < 0.5) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs(float(abs_k) - 4.0) < 0.5) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#else\n    if (abs_k == 1) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs_k == 2) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs_k == 3) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs_k == 4) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#endif\n\n    vec2 sin_t, cos_t;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n    vec2 result = vec2(0.0, 0.0);\n    if (j == 0) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            result = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    } else if (j == 1) {\n        if (k > 0) {\n            result = -sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(v, cos_t), mul_fp64(u, sin_t));\n        }\n    } else if (j == -1) {\n        if (k > 0) {\n            result = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        }\n    } else {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        } else {\n            result = -sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    }\n\n    return result;\n}\n\nvec2 tan_fp64(vec2 a) {\n    vec2 sin_a;\n    vec2 cos_a;\n\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(0.0, 0.0);\n    }\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n    vec2 sin_t, cos_t;\n    vec2 s, c;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0_FP64;\n            v = SIN_TABLE_0_FP64;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1_FP64;\n            v = SIN_TABLE_1_FP64;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2_FP64;\n            v = SIN_TABLE_2_FP64;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3_FP64;\n            v = SIN_TABLE_3_FP64;\n        }\n#else\n        if (abs_k == 1) {\n            u = COS_TABLE_0_FP64;\n            v = SIN_TABLE_0_FP64;\n        } else if (abs_k == 2) {\n            u = COS_TABLE_1_FP64;\n            v = SIN_TABLE_1_FP64;\n        } else if (abs_k == 3) {\n            u = COS_TABLE_2_FP64;\n            v = SIN_TABLE_2_FP64;\n        } else if (abs_k == 4) {\n            u = COS_TABLE_3_FP64;\n            v = SIN_TABLE_3_FP64;\n        }\n#endif\n        if (k > 0) {\n            s = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n            c = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            s = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n            c = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return div_fp64(sin_a, cos_a);\n}\n\nvec2 radians_fp64(vec2 degree) {\n  return mul_fp64(degree, PI_180_FP64);\n}\n\nvec2 mix_fp64(vec2 a, vec2 b, float x) {\n  vec2 range = sub_fp64(b, a);\n  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));\n}\n\nvoid vec2_sum_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = sum_fp64(a[0], b[0]);\n    out_val[1] = sum_fp64(a[1], b[1]);\n}\n\nvoid vec2_sub_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = sub_fp64(a[0], b[0]);\n    out_val[1] = sub_fp64(a[1], b[1]);\n}\n\nvoid vec2_mul_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = mul_fp64(a[0], b[0]);\n    out_val[1] = mul_fp64(a[1], b[1]);\n}\n\nvoid vec2_div_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = div_fp64(a[0], b[0]);\n    out_val[1] = div_fp64(a[1], b[1]);\n}\n\nvoid vec2_mix_fp64(vec2 x[2], vec2 y[2], float a, out vec2 out_val[2]) {\n  vec2 range[2];\n  vec2_sub_fp64(y, x, range);\n  vec2 portion[2];\n  portion[0] = range[0] * a;\n  portion[1] = range[1] * a;\n  vec2_sum_fp64(x, portion, out_val);\n}\n\nvec2 vec2_length_fp64(vec2 x[2]) {\n  return sqrt_fp64(sum_fp64(mul_fp64(x[0], x[0]), mul_fp64(x[1], x[1])));\n}\n\nvoid vec2_normalize_fp64(vec2 x[2], out vec2 out_val[2]) {\n  vec2 length = vec2_length_fp64(x);\n  vec2 length_vec2[2];\n  length_vec2[0] = length;\n  length_vec2[1] = length;\n\n  vec2_div_fp64(x, length_vec2, out_val);\n}\n\nvec2 vec2_distance_fp64(vec2 x[2], vec2 y[2]) {\n  vec2 diff[2];\n  vec2_sub_fp64(x, y, diff);\n  return vec2_length_fp64(diff);\n}\n\nvec2 vec2_dot_fp64(vec2 a[2], vec2 b[2]) {\n  vec2 v[2];\n\n  v[0] = mul_fp64(a[0], b[0]);\n  v[1] = mul_fp64(a[1], b[1]);\n\n  return sum_fp64(v[0], v[1]);\n}\nvoid vec3_sub_fp64(vec2 a[3], vec2 b[3], out vec2 out_val[3]) {\n  for (int i = 0; i < 3; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvoid vec3_sum_fp64(vec2 a[3], vec2 b[3], out vec2 out_val[3]) {\n  for (int i = 0; i < 3; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvec2 vec3_length_fp64(vec2 x[3]) {\n  return sqrt_fp64(sum_fp64(sum_fp64(mul_fp64(x[0], x[0]), mul_fp64(x[1], x[1])),\n    mul_fp64(x[2], x[2])));\n}\n\nvec2 vec3_distance_fp64(vec2 x[3], vec2 y[3]) {\n  vec2 diff[3];\n  vec3_sub_fp64(x, y, diff);\n  return vec3_length_fp64(diff);\n}\nvoid vec4_fp64(vec4 a, out vec2 out_val[4]) {\n  out_val[0].x = a[0];\n  out_val[0].y = 0.0;\n\n  out_val[1].x = a[1];\n  out_val[1].y = 0.0;\n\n  out_val[2].x = a[2];\n  out_val[2].y = 0.0;\n\n  out_val[3].x = a[3];\n  out_val[3].y = 0.0;\n}\n\nvoid vec4_scalar_mul_fp64(vec2 a[4], vec2 b, out vec2 out_val[4]) {\n  out_val[0] = mul_fp64(a[0], b);\n  out_val[1] = mul_fp64(a[1], b);\n  out_val[2] = mul_fp64(a[2], b);\n  out_val[3] = mul_fp64(a[3], b);\n}\n\nvoid vec4_sum_fp64(vec2 a[4], vec2 b[4], out vec2 out_val[4]) {\n  for (int i = 0; i < 4; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvoid vec4_dot_fp64(vec2 a[4], vec2 b[4], out vec2 out_val) {\n  vec2 v[4];\n\n  v[0] = mul_fp64(a[0], b[0]);\n  v[1] = mul_fp64(a[1], b[1]);\n  v[2] = mul_fp64(a[2], b[2]);\n  v[3] = mul_fp64(a[3], b[3]);\n\n  out_val = sum_fp64(sum_fp64(v[0], v[1]), sum_fp64(v[2], v[3]));\n}\n\nvoid mat4_vec4_mul_fp64(vec2 b[16], vec2 a[4], out vec2 out_val[4]) {\n  vec2 tmp[4];\n\n  for (int i = 0; i < 4; i++)\n  {\n    for (int j = 0; j < 4; j++)\n    {\n      tmp[j] = b[j + i * 4];\n    }\n    vec4_dot_fp64(a, tmp, out_val[i]);\n  }\n}\n",fs:null,dependencies:[{name:"fp64-arithmetic",vs:"uniform float ONE;\nvec2 split(float a) {\n  const float SPLIT = 4097.0;\n  float t = a * SPLIT;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float a_hi = t * ONE - (t - a);\n  float a_lo = a * ONE - a_hi;\n#else\n  float a_hi = t - (t - a);\n  float a_lo = a - a_hi;\n#endif\n  return vec2(a_hi, a_lo);\n}\nvec2 split2(vec2 a) {\n  vec2 b = split(a.x);\n  b.y += a.y;\n  return b;\n}\nvec2 quickTwoSum(float a, float b) {\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float sum = (a + b) * ONE;\n  float err = b - (sum - a) * ONE;\n#else\n  float sum = a + b;\n  float err = b - (sum - a);\n#endif\n  return vec2(sum, err);\n}\nvec2 twoSum(float a, float b) {\n  float s = (a + b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * ONE - a) * ONE;\n  float err = (a - (s - v) * ONE) * ONE * ONE * ONE + (b - v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) + (b - v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSub(float a, float b) {\n  float s = (a - b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * ONE - a) * ONE;\n  float err = (a - (s - v) * ONE) * ONE * ONE * ONE - (b + v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) - (b + v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSqr(float a) {\n  float prod = a * a;\n  vec2 a_fp64 = split(a);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float err = ((a_fp64.x * a_fp64.x - prod) * ONE + 2.0 * a_fp64.x *\n    a_fp64.y * ONE * ONE) + a_fp64.y * a_fp64.y * ONE * ONE * ONE;\n#else\n  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;\n#endif\n  return vec2(prod, err);\n}\n\nvec2 twoProd(float a, float b) {\n  float prod = a * b;\n  vec2 a_fp64 = split(a);\n  vec2 b_fp64 = split(b);\n  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +\n    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;\n  return vec2(prod, err);\n}\n\nvec2 sum_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSum(a.x, b.x);\n  t = twoSum(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 sub_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSub(a.x, b.x);\n  t = twoSub(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 mul_fp64(vec2 a, vec2 b) {\n  vec2 prod = twoProd(a.x, b.x);\n  prod.y += a.x * b.y;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  prod.y += a.y * b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  return prod;\n}\n\nvec2 div_fp64(vec2 a, vec2 b) {\n  float xn = 1.0 / b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  vec2 yn = mul_fp64(a, vec2(xn, 0));\n#else\n  vec2 yn = a * xn;\n#endif\n  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;\n  vec2 prod = twoProd(xn, diff);\n  return sum_fp64(yn, prod);\n}\n\nvec2 sqrt_fp64(vec2 a) {\n  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n\n  float x = 1.0 / sqrt(a.x);\n  float yn = a.x * x;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  vec2 yn_sqr = twoSqr(yn) * ONE;\n#else\n  vec2 yn_sqr = twoSqr(yn);\n#endif\n  float diff = sub_fp64(a, yn_sqr).x;\n  vec2 prod = twoProd(x * 0.5, diff);\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  return sum_fp64(split(yn), prod);\n#else\n  return sum_fp64(vec2(yn, 0.0), prod);\n#endif\n}\n",fs:null,getUniforms:function(){return j},fp64ify:F,fp64LowPart:B,fp64ifyMatrix4:z}],fp64ify:F,fp64LowPart:B,fp64ifyMatrix4:z};var V=n(3467);const G=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Z={modelMatrix:G,viewMatrix:G,projectionMatrix:G,cameraPositionWorld:[0,0,0]},q="varying vec4 project_vPositionWorld;\nvarying vec3 project_vNormalWorld;\n\nvec4 project_getPosition_World() {\n  return project_vPositionWorld;\n}\n\nvec3 project_getNormal_World() {\n  return project_vNormalWorld;\n}\n",W={name:"project",getUniforms:function(t=Z,e={}){const n={};return void 0!==t.modelMatrix&&(n.modelMatrix=t.modelMatrix),void 0!==t.viewMatrix&&(n.viewMatrix=t.viewMatrix),void 0!==t.projectionMatrix&&(n.projectionMatrix=t.projectionMatrix),void 0!==t.cameraPositionWorld&&(n.cameraPositionWorld=t.cameraPositionWorld),void 0===t.projectionMatrix&&void 0===t.viewMatrix||(n.viewProjectionMatrix=new V.Z(t.projectionMatrix).multiplyRight(t.viewMatrix)),n},vs:`${q}\nuniform mat4 modelMatrix;\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewProjectionMatrix;\nuniform vec3 cameraPositionWorld;\n\nstruct World {\n  vec3 position;\n  vec3 normal;\n};\n\nWorld world;\n\nvoid project_setPosition(vec4 position) {\n  project_vPositionWorld = position;\n}\n\nvoid project_setNormal(vec3 normal) {\n  project_vNormalWorld = normal;\n}\n\nvoid project_setPositionAndNormal_World(vec3 position, vec3 normal) {\n  world.position = position;\n  world.normal = normal;\n}\n\nvoid project_setPositionAndNormal_Model(vec3 position, vec3 normal) {\n  world.position = (modelMatrix * vec4(position, 1.)).xyz;\n  world.normal = mat3(modelMatrix) * normal;\n}\n\nvec4 project_model_to_clipspace(vec4 position) {\n  return viewProjectionMatrix * modelMatrix * position;\n}\n\nvec4 project_model_to_clipspace(vec3 position) {\n  return viewProjectionMatrix * modelMatrix * vec4(position, 1.);\n}\n\nvec4 project_world_to_clipspace(vec3 position) {\n  return viewProjectionMatrix * vec4(position, 1.);\n}\n\nvec4 project_view_to_clipspace(vec3 position) {\n  return projectionMatrix * vec4(position, 1.);\n}\n\nvec4 project_to_clipspace(vec3 position) {\n  return viewProjectionMatrix * vec4(position, 1.);\n}\n`,fs:`\n${q}`},H={lightDirection:new Float32Array([1,1,2])},X={name:"dirlight",vs:null,fs:"uniform vec3 dirlight_uLightDirection;\nvec4 dirlight_filterColor(vec4 color) {\n  vec3 normal = project_getNormal_World();\n  float d = abs(dot(normalize(normal), normalize(dirlight_uLightDirection)));\n  return vec4(color.rgb * d, color.a);\n}\n",getUniforms:function(t=H){const e={};return t.lightDirection&&(e.dirlight_uLightDirection=t.lightDirection),e},dependencies:[W]};var $=n(6119),Y=n(5502),Q=n(3330),K=n(7287),J=n(4080),tt=n(2525)},8055:(t,e,n)=>{"use strict";n.d(e,{T:()=>o});let r=1,i=1;class o{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(t){const{delay:e=0,duration:n=Number.POSITIVE_INFINITY,rate:i=1,repeat:o=1}=t,s=r++,a={time:0,delay:e,duration:n,rate:i,repeat:o};return this._setChannelTime(a,this.time),this.channels.set(s,a),s}removeChannel(t){this.channels.delete(t);for(const[e,n]of this.animations)n.channel===t&&this.detachAnimation(e)}isFinished(t){const e=this.channels.get(t);return void 0!==e&&this.time>=e.delay+e.duration*e.repeat}getTime(t){if(void 0===t)return this.time;const e=this.channels.get(t);return void 0===e?-1:e.time}setTime(t){this.time=Math.max(0,t);const e=this.channels.values();for(const t of e)this._setChannelTime(t,this.time);const n=this.animations.values();for(const t of n){const{animation:e,channel:n}=t;e.setTime(this.getTime(n))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(t,e){const n=i++;return this.animations.set(n,{animation:t,channel:e}),t.setTime(this.getTime(e)),n}detachAnimation(t){this.animations.delete(t)}update(t){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=t),this.setTime(this.time+(t-this.lastEngineTime)),this.lastEngineTime=t)}_setChannelTime(t,e){const n=e-t.delay;n>=t.duration*t.repeat?t.time=t.duration*t.rate:(t.time=Math.max(0,n)%t.duration,t.time*=t.rate)}}},1167:(t,e,n)=>{"use strict";n.d(e,{Z:()=>c});var r=n(3982),i=n(4538);const o=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),s=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),a=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),l=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),u={POSITION:{size:3,value:new Float32Array(s)},NORMAL:{size:3,value:new Float32Array(a)},TEXCOORD_0:{size:2,value:new Float32Array(l)}};class c extends r.Z{constructor(t={}){const{id:e=(0,i.hQ)("cube-geometry")}=t;super({...t,id:e,indices:{size:1,value:new Uint16Array(o)},attributes:{...u,...t.attributes}})}}},3982:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(4538),i=n(2525);const o={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class s{static get DRAW_MODE(){return o}constructor(t={}){const{id:e=(0,r.hQ)("geometry"),drawMode:n=o.TRIANGLES,attributes:i={},indices:s=null,vertexCount:a=null}=t;this.id=e,this.drawMode=0|n,this.attributes={},this.userData={},this._setAttributes(i,s),this.vertexCount=a||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(t){return`Geometry ${this.id} attribute ${t}`}_setAttributes(t,e){e&&(this.indices=ArrayBuffer.isView(e)?{value:e,size:1}:e);for(const e in t){let n=t[e];n=ArrayBuffer.isView(n)?{value:n}:n,(0,i.h)(ArrayBuffer.isView(n.value),`${this._print(e)}: must be typed array or object with value as typed array`),"POSITION"!==e&&"positions"!==e||n.size||(n.size=3),"indices"===e?((0,i.h)(!this.indices),this.indices=n):this.attributes[e]=n}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(t,e){if(e)return e.value.length;let n=1/0;for(const e in t){const r=t[e],{value:i,size:o,constant:s}=r;!s&&i&&o>=1&&(n=Math.min(n,i.length/o))}return(0,i.h)(Number.isFinite(n)),n}}},9902:(t,e,n)=>{"use strict";n.d(e,{Z:()=>f});var r=n(9450),i=n(7577),o=n(4211),s=n(6948),a=n(2525);class l extends i.Z{static isSupported(t,e=[]){const n=(0,r.D0)(t),i=(0,o.ag)(t,s.h.TIMER_QUERY);let l=n||i;for(const t of e)switch(t){case"queries":l=l&&n;break;case"timers":l=l&&i;break;default:(0,a.h)(!1)}return l}constructor(t,e={}){super(t,e),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery({conservative:t=!1}={}){return this.begin(t?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(t){return this._queryPending||(this.target=t,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const t=this.gl2.getQueryParameter(this.handle,34919);return t&&(this._queryPending=!1),t}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(t=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let e=0;return this._pollingPromise=new Promise(((n,r)=>{const i=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):e++>t?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(i)};requestAnimationFrame(i)})),this._pollingPromise}_createHandle(){return l.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}var u=n(9835),c=n(3849);const h=(0,n(9718).jU)()&&"undefined"!=typeof document;let p=0;class f{constructor(t={}){const{onCreateContext:e=(t=>(0,r.s9)(t)),onAddHTML:n=null,onInitialize:i=(()=>{}),onRender:o=(()=>{}),onFinalize:s=(()=>{}),onError:a,gl:l=null,glOptions:c={},debug:h=!1,createFramebuffer:f=!1,autoResizeViewport:d=!0,autoResizeDrawingBuffer:g=!0,stats:m=u.l.get("animation-loop-"+p++)}=t;let{useDevicePixels:A=!0}=t;"useDevicePixelRatio"in t&&(r.cM.deprecated("useDevicePixelRatio","useDevicePixels")(),A=t.useDevicePixelRatio),this.props={onCreateContext:e,onAddHTML:n,onInitialize:i,onRender:o,onFinalize:s,onError:a,gl:l,glOptions:c,debug:h,createFramebuffer:f},this.gl=l,this.needsRedraw=null,this.timeline=null,this.stats=m,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:d,autoResizeDrawingBuffer:g,useDevicePixels:A}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(t){return(0,a.h)("string"==typeof t),this.needsRedraw=this.needsRedraw||t,this}setProps(t){return"autoResizeViewport"in t&&(this.autoResizeViewport=t.autoResizeViewport),"autoResizeDrawingBuffer"in t&&(this.autoResizeDrawingBuffer=t.autoResizeDrawingBuffer),"useDevicePixels"in t&&(this.useDevicePixels=t.useDevicePixels),this}start(t={}){if(this._running)return this;this._running=!0;const e=this._getPageLoadPromise().then((()=>!this._running||this._initialized?null:(this._createWebGLContext(t),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=l.isSupported(this.gl,["timers"])?new l(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps)))).then((t=>{this._running&&(this._addCallbackData(t||{}),!1!==t&&this._startLoop())}));return this.props.onError&&e.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(t){return this.timeline=t,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise((t=>{this._resolveNextFrame=t}))),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(...t){return this.props.onCreateContext(...t)}onInitialize(...t){return this.props.onInitialize(...t)}onRender(...t){return this.props.onRender(...t)}onFinalize(...t){return this.props.onFinalize(...t)}getHTMLControlValue(t,e=1){const n=document.getElementById(t);return n?Number(n.value):e}setViewParameters(){return r.cM.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const t=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(t))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(t)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=h?new Promise(((t,e)=>{h&&"complete"===document.readyState?t(document):window.addEventListener("load",(()=>{t(document)}))})):Promise.resolve({})),this._pageLoadPromise}_setDisplay(t){this.display&&(this.display.delete(),this.display.animationLoop=null),t&&(t.animationLoop=this),this.display=t}_cancelAnimationFrame(t){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(t):(e=t,"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):clearTimeout(e));var e}_requestAnimationFrame(t){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(t):(e=t,"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,1e3/60));var e}_renderFrame(...t){this.display?this.display._renderFrame(...t):this.onRender(...t)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:t,height:e,aspect:n}=this._getSizeAndAspect();t===this.animationProps.width&&e===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=t,this.animationProps.height=e,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(t){"object"==typeof t&&null!==t&&(this.animationProps=Object.assign({},this.animationProps,t))}_createWebGLContext(t){if(this.offScreen=t.canvas&&"undefined"!=typeof OffscreenCanvas&&t.canvas instanceof OffscreenCanvas,t=Object.assign({},t,this.props.glOptions),this.gl=this.props.gl?(0,r.yW)(this.props.gl,t):this.onCreateContext(t),!(0,r.UF)(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");(0,r.kL)(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const t=document.createElement("div");document.body.appendChild(t),t.style.position="relative";const e=document.createElement("div");e.style.position="absolute",e.style.left="10px",e.style.bottom="10px",e.style.width="300px",e.style.background="white",t.appendChild(this.gl.canvas),t.appendChild(e);const n=this.props.onAddHTML(e);n&&(e.innerHTML=n)}}_getSizeAndAspect(){const t=this.gl.drawingBufferWidth,e=this.gl.drawingBufferHeight;let n=1;const{canvas:r}=this.gl;return r&&r.clientHeight?n=r.clientWidth/r.clientHeight:t>0&&e>0&&(n=t/e),{width:t,height:e,aspect:n}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&(0,r.aQ)(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new c.Z(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:t}=this.gl;t&&(t.addEventListener("mousemove",this._onMousemove),t.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(t){this.animationProps._mousePosition=[t.offsetX,t.offsetY]}_onMouseleave(t){this.animationProps._mousePosition=null}}},1113:(t,e,n)=>{"use strict";n.d(e,{Z:()=>D});var r=n(9450),i=n(1731),o=n(4072),s=n(3478),a=n(7577);let l=null;var u=n(2525),c=n(6073),h=n(5989),p=n(1202);class f extends a.Z{static isSupported(t,e={}){return!e.constantAttributeZero||(0,r.D0)(t)||"Chrome"===function(t){if(!(0,h.Z)())return"Node";if((0,p.Z)(t))return"Electron";const e=("undefined"!=typeof navigator?navigator:{}).userAgent||"";if(e.indexOf("Edge")>-1)return"Edge";const n=-1!==e.indexOf("MSIE "),r=-1!==e.indexOf("Trident/");return n||r?"IE":c.u9.chrome?"Chrome":c.u9.safari?"Safari":c.u9.mozInnerScreenX?"Firefox":"Unknown"}()}static getDefaultArray(t){return t.luma=t.luma||{},t.luma.defaultVertexArray||(t.luma.defaultVertexArray=new f(t,{handle:null,isDefaultArray:!0})),t.luma.defaultVertexArray}static getMaxAttributes(t){return f.MAX_ATTRIBUTES=f.MAX_ATTRIBUTES||t.getParameter(34921),f.MAX_ATTRIBUTES}static setConstant(t,e,n){switch(n.constructor){case Float32Array:f._setConstantFloatArray(t,e,n);break;case Int32Array:f._setConstantIntArray(t,e,n);break;case Uint32Array:f._setConstantUintArray(t,e,n);break;default:(0,u.h)(!1)}}constructor(t,e={}){const n=e.id||e.program&&e.program.id;super(t,Object.assign({},e,{id:n})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=e.isDefaultArray||!1,this.gl2=t,this.initialize(e),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return f.getMaxAttributes(this.gl)}initialize(t={}){return this.setProps(t)}setProps(t){return this}setElementBuffer(t=null,e={}){return(0,u.h)(!t||34963===t.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind((()=>{this.gl.bindBuffer(34963,t?t.handle:null)})),this}setBuffer(t,e,n){if(34963===e.target)return this.setElementBuffer(e,n);const{size:i,type:o,stride:s,offset:a,normalized:l,integer:c,divisor:h}=n,{gl:p,gl2:f}=this;return t=Number(t),this.bind((()=>{p.bindBuffer(34962,e.handle),c?((0,u.h)((0,r.D0)(p)),f.vertexAttribIPointer(t,i,o,s,a)):p.vertexAttribPointer(t,i,o,l,s,a),p.enableVertexAttribArray(t),f.vertexAttribDivisor(t,h||0)})),this}enable(t,e=!0){return!e&&0===t&&!f.isSupported(this.gl,{constantAttributeZero:!0})||(t=Number(t),this.bind((()=>e?this.gl.enableVertexAttribArray(t):this.gl.disableVertexAttribArray(t)))),this}getConstantBuffer(t,e){const n=this._normalizeConstantArrayValue(e),r=n.byteLength*t,i=n.length*t;let o=!this.buffer;if(this.buffer=this.buffer||new s.Z(this.gl,r),o=o||this.buffer.reallocate(r),o=o||!this._compareConstantArrayValues(n,this.bufferValue),o){const t=function(t,e){var n;return new t((n=t.BYTES_PER_ELEMENT*e,(!l||l.byteLength<n)&&(l=new ArrayBuffer(n)),l),0,e)}(e.constructor,i);!function({target:t,source:e,start:n=0,count:r=1}){const i=e.length,o=r*i;let s=0;for(let r=n;s<i;s++)t[r++]=e[s];for(;s<o;)s<o-s?(t.copyWithin(n+s,n,n+s),s*=2):(t.copyWithin(n+s,n,n+o-s),s=o)}({target:t,source:n,start:0,count:i}),this.buffer.subData(t),this.bufferValue=e}return this.buffer}_normalizeConstantArrayValue(t){return Array.isArray(t)?new Float32Array(t):t}_compareConstantArrayValues(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}static _setConstantFloatArray(t,e,n){switch(n.length){case 1:t.vertexAttrib1fv(e,n);break;case 2:t.vertexAttrib2fv(e,n);break;case 3:t.vertexAttrib3fv(e,n);break;case 4:t.vertexAttrib4fv(e,n);break;default:(0,u.h)(!1)}}static _setConstantIntArray(t,e,n){switch((0,u.h)((0,r.D0)(t)),n.length){case 1:t.vertexAttribI1iv(e,n);break;case 2:t.vertexAttribI2iv(e,n);break;case 3:t.vertexAttribI3iv(e,n);break;case 4:t.vertexAttribI4iv(e,n);break;default:(0,u.h)(!1)}}static _setConstantUintArray(t,e,n){switch((0,u.h)((0,r.D0)(t)),n.length){case 1:t.vertexAttribI1uiv(e,n);break;case 2:t.vertexAttribI2uiv(e,n);break;case 3:t.vertexAttribI3uiv(e,n);break;case 4:t.vertexAttribI4uiv(e,n);break;default:(0,u.h)(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(t){return this.gl2.deleteVertexArray(t),[this.elements]}_bindHandle(t){this.gl2.bindVertexArray(t)}_getParameter(t,{location:e}){return(0,u.h)(Number.isFinite(e)),this.bind((()=>34373===t?this.gl.getVertexAttribOffset(e,t):this.gl.getVertexAttrib(e,t)))}}var d=n(7469);const g=/^(.+)__LOCATION_([0-9]+)$/,m=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class A{constructor(t,e={}){const n=e.id||e.program&&e.program.id;this.id=n,this.gl=t,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new f(t),(0,d.F)(this,"VertexArray","v6.0",m),this.initialize(e),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(t={}){return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(t)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:t}=this.vertexArrayObject;return this.values=new Array(t).fill(null),this.accessors=new Array(t).fill(null),this.unused={},this.drawParams=null,this}setProps(t){return"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"attributes"in t&&this.setAttributes(t.attributes),"elements"in t&&this.setElementBuffer(t.elements),"bindOnUse"in t&&(t=t.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(t){return Object.assign(this.attributes,t),this.vertexArrayObject.bind((()=>{for(const e in t){const n=t[e];this._setAttribute(e,n)}this.gl.bindBuffer(34962,null)})),this}setElementBuffer(t=null,e={}){return this.elements=t,this.elementsAccessor=e,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(t,e),this}setBuffer(t,e,n={}){if(34963===e.target)return this.setElementBuffer(e,n);const{location:r,accessor:i}=this._resolveLocationAndAccessor(t,e,e.accessor,n);return r>=0&&(this.values[r]=e,this.accessors[r]=i,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,e,i)),this}setConstant(t,e,n={}){const{location:r,accessor:i}=this._resolveLocationAndAccessor(t,e,Object.assign({size:e.length},n));return r>=0&&(e=this.vertexArrayObject._normalizeConstantArrayValue(e),this.values[r]=e,this.accessors[r]=i,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind((()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new s.Z(this.gl,{accessor:{size:4}});for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this.values[t]instanceof s.Z&&(this.gl.disableVertexAttribArray(t),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(t,1,5126,!1,0,0))})),this}bindBuffers(){return this.vertexArrayObject.bind((()=>{this.elements&&this.setElementBuffer(this.elements);for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++){const e=this.values[t];e instanceof s.Z&&this.setBuffer(t,e)}})),this}bindForDraw(t,e,n){let r;return this.vertexArrayObject.bind((()=>{this._setConstantAttributes(t,e),r=n()})),r}_resolveLocationAndAccessor(t,e,n,i){const s={location:-1,accessor:null},{location:a,name:l}=this._getAttributeIndex(t);if(!Number.isFinite(a)||a<0)return this.unused[t]=e,r.cM.once(3,(()=>`unused value ${t} in ${this.id}`))(),s;const c=this._getAttributeInfo(l||a);if(!c)return s;const h=this.accessors[a]||{},p=o.Z.resolve(c.accessor,h,n,i),{size:f,type:d}=p;return(0,u.h)(Number.isFinite(f)&&Number.isFinite(d)),{location:a,accessor:p}}_getAttributeInfo(t){return this.configuration&&this.configuration.getAttributeInfo(t)}_getAttributeIndex(t){const e=Number(t);if(Number.isFinite(e))return{location:e};const n=g.exec(t),r=n?n[1]:t,i=n?Number(n[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+i,name:r}:{location:-1}}_setAttribute(t,e){if(e instanceof s.Z)this.setBuffer(t,e);else if(Array.isArray(e)&&e.length&&e[0]instanceof s.Z){const n=e[0],r=e[1];this.setBuffer(t,n,r)}else if(ArrayBuffer.isView(e)||Array.isArray(e)){const n=e;this.setConstant(t,n)}else{if(!(e.buffer instanceof s.Z))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");{const n=e;this.setBuffer(t,n.buffer,n)}}}_setConstantAttributes(t,e){const n=Math.max(0|t,0|e);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,n);for(let t=1;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)r=this.values[t],ArrayBuffer.isView(r)&&this._setConstantAttribute(t,r)}_setConstantAttributeZero(t,e){if(f.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,t);const n=this.vertexArrayObject.getConstantBuffer(e,t);this.vertexArrayObject.setBuffer(0,n,this.accessors[0])}_setConstantAttribute(t,e){f.setConstant(this.gl,t,e)}_updateDrawParams(){const t={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this._updateDrawParamsForLocation(t,e);return this.elements&&(t.elementCount=this.elements.getElementCount(this.elements.accessor),t.isIndexed=!0,t.indexType=this.elementsAccessor.type||this.elements.accessor.type,t.indexOffset=this.elementsAccessor.offset||0),t.indexCount===1/0&&(t.indexCount=0),t.vertexCount===1/0&&(t.vertexCount=0),t.instanceCount===1/0&&(t.instanceCount=0),t}_updateDrawParamsForLocation(t,e){const n=this.values[e],r=this.accessors[e];if(!n)return;const{divisor:i}=r,o=i>0;if(t.isInstanced=t.isInstanced||o,n instanceof s.Z){const e=n;if(o){const n=e.getVertexCount(r);t.instanceCount=Math.min(t.instanceCount,n)}else{const n=e.getVertexCount(r);t.vertexCount=Math.min(t.vertexCount,n)}}}setElements(t=null,e={}){return r.cM.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(t,e)}}var y=n(4538),_=n(6047),v=n(7944),b=n(1053),x=n(9579),w=n(8522);function E(t,e={}){const{isInteger:n=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return function(t,e){const{maxElts:n=16,size:r=1}=e;let i="[";for(let o=0;o<t.length&&o<n;++o)o>0&&(i+=","+(o%r==0?" ":"")),i+=E(t[o],e);return`${i}${t.length>n?"...":"]"}`}(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<1e-16)return n?"0":"0.";if(n)return t.toFixed(0);if(Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const r=t.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function S(t,e,n,r){const{gl:i}=t;if(!e)return{[r]:"null","Format ":"N/A"};let o,a,l,u="NOT PROVIDED",c=1,h=0,p=0;if(n&&(u=n.type,c=n.size,u=String(u).replace("Array",""),o=-1!==u.indexOf("nt")),e instanceof s.Z){const t=e,{data:s,changed:f}=t.getDebugData();let d;return a=f?"*":"",l=s,p=t.byteLength,h=p/s.BYTES_PER_ELEMENT/c,n?d=`${n.divisor>0?"I ":"P "} ${h} (x${c}=${p} bytes ${(0,x.km)(i,u)})`:(o=!0,d=`${p} bytes`),{[r]:`${a}${E(l,{size:c,isInteger:o})}`,"Format ":d}}return l=e,c=e.length,u=String(e.constructor.name).replace("Array",""),o=-1!==u.indexOf("nt"),{[r]:`${E(l,{size:c,isInteger:o})} (constant)`,"Format ":`${c}x${u} (constant)`}}function T(t,e){const{type:n,size:r}=e,i=(0,w.jG)(n,r);return i?`${t} (${i.name})`:t}function P({header:t="Uniforms",program:e,uniforms:n,undefinedOnly:r=!1}){(0,u.h)(e);const i=".*Matrix",o=e._uniformSetters,s={},a=Object.keys(o).sort();let l=0;for(const e of a)e.match(".*_.*")||e.match(i)||M({table:s,header:t,uniforms:n,uniformName:e,undefinedOnly:r})&&l++;for(const e of a)e.match(i)&&M({table:s,header:t,uniforms:n,uniformName:e,undefinedOnly:r})&&l++;for(const e of a)s[e]||M({table:s,header:t,uniforms:n,uniformName:e,undefinedOnly:r})&&l++;let c=0;const h={};if(!r)for(const e in n){const r=n[e];s[e]||(c++,h[e]={Type:`NOT USED: ${r}`,[t]:E(r)})}return{table:s,count:l,unusedTable:h,unusedCount:c}}function M({table:t,header:e,uniforms:n,uniformName:r,undefinedOnly:i}){const o=n[r],s=function(t){return null!=t}(o);return!(i&&s||(t[r]={[e]:s?E(o):"N/A","Uniform Type":s?o:"NOT PROVIDED"},0))}function C(t){const{type:e,size:n}=t.accessor,r=(0,w.jG)(e,n);return r?`${r.name} ${t.name}`:t.name}const I={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function O(t,e){const{attributeMap:n=I}=e||{};return n&&n[t]||t}function R(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors"}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2}(0,u.h)(Number.isFinite(e.size),`attribute ${t} needs size`)}const L=()=>{},k={};class D{constructor(t,e={}){const{id:n=(0,y.hQ)("model")}=e;(0,u.h)((0,r.UF)(t)),this.id=n,this.gl=t,this.id=e.id||(0,y.hQ)("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(e)}initialize(t){this.props={},this.programManager=t.programManager||i.Z.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:e=null,vs:n,fs:r,modules:o,defines:s,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:h}=t;this.programProps={program:e,vs:n,fs:r,modules:o,defines:s,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:h},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(t.moduleSettings))),this.drawMode=void 0!==t.drawMode?t.drawMode:4,this.vertexCount=t.vertexCount||0,this.geometryBuffers={},this.isInstanced=t.isInstanced||t.instanced||t.instanceCount>0,this._setModelProps(t),this.geometry={},(0,u.h)(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}setProps(t){this._setModelProps(t)}delete(){for(const t in this._attributes)this._attributes[t]!==this.attributes[t]&&this._attributes[t].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(t){const{program:e,vs:n,fs:r,modules:i,defines:o,inject:s,varyings:a,bufferMode:l,transpileToGLSL100:u}=t;this.programProps={program:e,vs:n,fs:r,modules:i,defines:o,inject:s,varyings:a,bufferMode:l,transpileToGLSL100:u},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(t){return this.drawMode=t,this}setVertexCount(t){return(0,u.h)(Number.isFinite(t)),this.vertexCount=t,this}setInstanceCount(t){return(0,u.h)(Number.isFinite(t)),this.instanceCount=t,this}setGeometry(t){return this.drawMode=t.drawMode,this.vertexCount=t.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function(t,e,n){const r={};let i=e.indices;for(const n in e.attributes){const o=e.attributes[n],a=O(n,undefined);if("indices"===n)i=o;else if(o.constant)r[a]=o.value;else{const e=o.value,i={...o};delete i.value,r[a]=[new s.Z(t,e),i],R(n,i)}}if(i){const e=i.value||i;(0,u.h)(e instanceof Uint16Array||e instanceof Uint32Array,'attribute array for "indices" must be of integer type');const n={size:1,isIndexed:void 0===i.isIndexed||i.isIndexed};r.indices=[new s.Z(t,{data:e,target:34963}),n]}return r}(this.gl,t),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(t={}){if((0,y.nK)(t))return this;const e={};for(const n in t){const r=t[n];e[n]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(e),this}setUniforms(t={}){return Object.assign(this.uniforms,t),this}getModuleUniforms(t){this._checkProgram();const e=this.programManager.getUniforms(this.program);return e?e(t):{}}updateModuleSettings(t){const e=this.getModuleUniforms(t||{});return this.setUniforms(e)}clear(t){return(0,_.Z)(this.program.gl,t),this}draw(t={}){this._checkProgram();const{moduleSettings:e=null,framebuffer:n,uniforms:i={},attributes:o={},transformFeedback:s=this.transformFeedback,parameters:a={},vertexArray:l=this.vertexArray}=t;let u;this.setAttributes(o),this.updateModuleSettings(e),this.setUniforms(i),r.cM.priority>=2&&(u=this._logDrawCallStart(2));const c=this.vertexArray.getDrawParams(),{isIndexed:h=c.isIndexed,indexType:p=c.indexType,indexOffset:f=c.indexOffset,vertexArrayInstanced:d=c.isInstanced}=this.props;d&&!this.isInstanced&&r.cM.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:g,instanceCount:m}=this,{onBeforeRender:A=L,onAfterRender:y=L}=this.props;A(),this.program.setUniforms(this.uniforms);const _=this.program.draw(Object.assign(k,t,{logPriority:u,uniforms:null,framebuffer:n,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:l,transformFeedback:s,isIndexed:h,indexType:p,isInstanced:g,instanceCount:m,offset:h?f:0}));return y(),r.cM.priority>=2&&this._logDrawCallEnd(u,l,n),_}transform(t={}){const{discard:e=!0,feedbackBuffers:n,unbindModels:r=[]}=t;let{parameters:i}=t;n&&this._setFeedbackBuffers(n),e&&(i=Object.assign({},i,{35977:e})),r.forEach((t=>t.vertexArray.unbindBuffers()));try{this.draw(Object.assign({},t,{parameters:i}))}finally{r.forEach((t=>t.vertexArray.bindBuffers()))}return this}render(t={}){return r.cM.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(t).draw()}_setModelProps(t){Object.assign(this.props,t),"uniforms"in t&&this.setUniforms(t.uniforms),"pickable"in t&&(this.pickable=t.pickable),"instanceCount"in t&&(this.instanceCount=t.instanceCount),"geometry"in t&&this.setGeometry(t.geometry),"attributes"in t&&this.setAttributes(t.attributes),"_feedbackBuffers"in t&&this._setFeedbackBuffers(t._feedbackBuffers)}_checkProgram(){if(!this._programDirty&&this.programManager.stateHash===this._programManagerState)return;let{program:t}=this.programProps;if(t)this._managedProgram=!1;else{const{vs:e,fs:n,modules:r,inject:i,defines:o,varyings:s,bufferMode:a,transpileToGLSL100:l}=this.programProps;t=this.programManager.get({vs:e,fs:n,modules:r,inject:i,defines:o,varyings:s,bufferMode:a,transpileToGLSL100:l}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}(0,u.h)(t instanceof v.Z,"Model needs a program"),this._programDirty=!1,t!==this.program&&(this.program=t,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new A(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const t in this.geometryBuffers){const e=this.geometryBuffers[t][0]||this.geometryBuffers[t];e instanceof s.Z&&e.delete()}}_setAnimationProps(t){this.animated&&(0,u.h)(t,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(t={}){if((0,y.nK)(t))return this;const{gl:e}=this.program;return this.transformFeedback=this.transformFeedback||new b.Z(e,{program:this.program}),this.transformFeedback.setBuffers(t),this}_logDrawCallStart(t){const e=t>3?0:1e4;if(!(Date.now()-this.lastLogTime<e))return this.lastLogTime=Date.now(),r.cM.group(2,`>>> DRAWING MODEL ${this.id}`,{collapsed:r.cM.level<=2})(),t}_logDrawCallEnd(t,e,n,i){if(void 0===t)return;const o=function({vertexArray:t,header:e="Attributes"}){if(!t.configuration)return{};const n={};t.elements&&(n.ELEMENT_ARRAY_BUFFER=S(t,t.elements,null,e));const r=t.values;for(const i in r){const o=t._getAttributeInfo(i);if(o){let s=`${i}: ${o.name}`;const a=t.accessors[o.location];a&&(s=`${i}: ${T(o.name,a)}`),n[s]=S(t,r[i],a,e)}}return n}({vertexArray:e,header:`${this.id} attributes`,attributes:this._attributes}),{table:s,unusedTable:a,unusedCount:l}=P({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,n)}),{table:u,count:c}=P({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,n),undefinedOnly:!0});c>0&&r.cM.log("MISSING UNIFORMS",Object.keys(u))(),l>0&&r.cM.log("UNUSED UNIFORMS",Object.keys(a))();const h=function(t){const e={},n=`Accessors for ${t.id}`;for(const r of t.attributeInfos)r&&(e[`in ${C(r)}`]={[n]:JSON.stringify(r.accessor)});for(const r of t.varyingInfos)r&&(e[`out ${C(r)}`]={[n]:JSON.stringify(r.accessor)});return e}(this.vertexArray.configuration);r.cM.table(t,o)(),r.cM.table(t,s)(),r.cM.table(t+1,h)(),i&&i.log({logLevel:2,message:`Rendered to ${i.id}`}),r.cM.groupEnd(2,`>>> DRAWING MODEL ${this.id}`)()}}},1731:(t,e,n)=>{"use strict";n.d(e,{Z:()=>I});var r=n(5682),i=n(6119),o=n(9047);function s(t){return function(t){const e={},n={};return a({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort(((t,e)=>n[e]-n[t])).map((t=>e[t]))}(l(t))}function a({modules:t,level:e,moduleMap:n,moduleDepth:r}){if(e>=5)throw new Error("Possible loop in shader dependency graph");for(const i of t)n[i.name]=i,(void 0===r[i.name]||r[i.name]<e)&&(r[i.name]=e);for(const i of t)i.dependencies&&a({modules:i.dependencies,level:e+1,moduleMap:n,moduleDepth:r})}function l(t,e){return t.map((t=>(t instanceof i.Z||((0,o.Z)("string"!=typeof t,`Shader module use by name is deprecated. Import shader module '${t}' and use it directly.`),(0,o.Z)(t.name,"shader module has no name"),(t=new i.Z(t)).dependencies=l(t.dependencies)),t)))}const u={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},c={};Object.keys(u).forEach((t=>{c[t]=t}));const h={};function p(t,e,n={}){const r=u[e];if((0,o.Z)(r,e),!function(t={}){const e="undefined"!=typeof window&&window.navigator||{},n=t.userAgent||e.userAgent||"",r=-1!==n.indexOf("MSIE "),i=-1!==n.indexOf("Trident/");return r||i}(n))return!0;if(e in h)return h[e];const i=`#extension GL_${r[0]} : ${n.behavior||"enable"}\nvoid main(void) {}`,s=t.createShader(35633);t.shaderSource(s,i),t.compileShader(s);const a=t.getShaderParameter(s,35713);return t.deleteShader(s),h[e]=a,a}function f(t,e){return(e=Array.isArray(e)?e:[e]).every((e=>function(t,e){const n=u[e];(0,o.Z)(n,e);const r=function(t){return"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&2===t._version)}(t)&&n[1]||n[0],i="string"==typeof r?Boolean(t.getExtension(r)):r;return(0,o.Z)(!1===i||!0===i),i}(t,e)))}var d=n(6713);function g(t){return new RegExp(`\\b${t}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}const m=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],A=[...m,[g("attribute"),"in $1"],[g("varying"),"out $1"]],y=[...m,[g("varying"),"in $1"]],_=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],v=[..._,[g("in"),"attribute $1"],[g("out"),"varying $1"]],b=[..._,[g("in"),"varying $1"]],x=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,w=/void\s+main\s*\([^)]*\)\s*\{\n?/;function E(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}const S=`\n\n${d.O_}\n\n`,T={[r.H]:"vertex",[r.Y]:"fragment"};function P(t,{id:e,source:n,type:i,modules:s,defines:a={},hookFunctions:l=[],inject:u={},transpileToGLSL100:h=!1,prologue:g=!0,log:m}){(0,o.Z)("string"==typeof n,"shader source must be a string");const _=i===r.H,P=n.split("\n");let M=100,C="",I=n;0===P[0].indexOf("#version ")?(M=300,C=P[0],I=P.slice(1).join("\n")):C=`#version ${M}`;const O={};s.forEach((t=>{Object.assign(O,t.getDefines())})),Object.assign(O,a);let R=g?`${C}\n${function({id:t,source:e,type:n}){return t&&"string"==typeof t&&-1===e.indexOf("SHADER_NAME")?`\n#define SHADER_NAME ${t}_${T[n]}\n\n`:""}({id:e,source:n,type:i})}\n${function({type:t}){return`\n#define SHADER_TYPE_${T[t].toUpperCase()}\n`}({type:i})}\n${function(t){const e=function(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||7936),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||7937),i=function(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}(n,r);return{gpuVendor:i,vendor:n,renderer:r,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}(t);switch(e.gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}(t)}\n${function(t,e,n){let r="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return f(t,c.GLSL_FRAG_DEPTH)&&(r+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),f(t,c.GLSL_DERIVATIVES)&&p(t,c.GLSL_DERIVATIVES)&&(r+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),f(t,c.GLSL_FRAG_DATA)&&p(t,c.GLSL_FRAG_DATA,{behavior:"require"})&&(r+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),f(t,c.GLSL_TEXTURE_LOD)&&(r+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),r}(t)}\n${function(t={}){let e=0,n="";for(const r in t){0===e&&(n+="\n// APPLICATION DEFINES\n"),e++;const i=t[r];(i||Number.isFinite(i))&&(n+=`#define ${r.toUpperCase()} ${t[r]}\n`)}return 0===e&&(n+="\n"),n}(O)}\n${_?"":"precision highp float;\n\n"}\n`:`${C}\n`;const L=function(t){const e={vs:{},fs:{}};return t.forEach((t=>{let n;"string"!=typeof t?(n=t,t=n.hook):n={},t=t.trim();const[r,i]=t.split(":"),o=t.replace(/\(.+/,"");e[r][o]=Object.assign(n,{signature:i})})),e}(l),k={},D={},N={};for(const t in u){const e="string"==typeof u[t]?{injection:u[t],order:0}:u[t],n=t.match(/^(v|f)s:(#)?([\w-]+)$/);if(n){const r=n[2],i=n[3];r?"decl"===i?D[t]=[e]:N[t]=[e]:k[t]=[e]}else N[t]=[e]}for(const t of s){m&&t.checkDeprecations(I,m),R+=t.getModuleSource(i,M);const e=t.injections[i];for(const t in e){const n=t.match(/^(v|f)s:#([\w-]+)$/);if(n){const r="decl"===n[2]?D:N;r[t]=r[t]||[],r[t].push(e[t])}else k[t]=k[t]||[],k[t].push(e[t])}}return R+=S,R=(0,d.ZP)(R,i,D),R+=function(t,e){let n="";for(const r in t){const i=t[r];if(n+=`void ${i.signature} {\n`,i.header&&(n+=`  ${i.header}`),e[r]){const t=e[r];t.sort(((t,e)=>t.order-e.order));for(const e of t)n+=`  ${e.injection}\n`}i.footer&&(n+=`  ${i.footer}`),n+="}\n"}return n}(L[i],k),R+=I,R=(0,d.ZP)(R,i,N),R=function(t,e,n){switch(e){case 300:return n?E(t,A):function(t){const e=(t=E(t,y)).match(x);if(e){const n=e[1];t=t.replace(new RegExp("\\bgl_FragColor\\b","g"),n)}else{const e="fragmentColor";t=t.replace(w,(t=>`out vec4 ${e};\n${t}`)).replace(new RegExp("\\bgl_FragColor\\b","g"),e)}return t}(t);case 100:return n?E(t,v):function(t){const e=(t=E(t,b)).match(x);if(e){const n=e[1];t=t.replace(x,"").replace(new RegExp(`\\b${n}\\b`,"g"),"gl_FragColor")}return t}(t);default:throw new Error(`unknown GLSL version ${e}`)}}(R,h?100:M,_),R}function M(t){return function(e){const n={};for(const r of t){const t=r.getUniforms(e,n);Object.assign(n,t)}return n}}var C=n(7944);class I{static getDefaultProgramManager(t){return t.luma=t.luma||{},t.luma.defaultProgramManager=t.luma.defaultProgramManager||new I(t),t.luma.defaultProgramManager}constructor(t){this.gl=t,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(t){this._defaultModules.find((e=>e.name===t.name))||this._defaultModules.push(t),this.stateHash++}removeDefaultModule(t){const e="string"==typeof t?t:t.name;this._defaultModules=this._defaultModules.filter((t=>t.name!==e)),this.stateHash++}addShaderHook(t,e){e&&(t=Object.assign(e,{hook:t})),this._hookFunctions.push(t),this.stateHash++}get(t={}){const{vs:e="",fs:n="",defines:i={},inject:o={},varyings:a=[],bufferMode:l=35981,transpileToGLSL100:u=!1}=t,c=this._getModuleList(t.modules),h=this._getHash(e),p=this._getHash(n),f=c.map((t=>this._getHash(t.name))).sort(),d=a.map((t=>this._getHash(t))),g=Object.keys(i).sort(),m=Object.keys(o).sort(),A=[],y=[];for(const t of g)A.push(this._getHash(t)),A.push(this._getHash(i[t]));for(const t of m)y.push(this._getHash(t)),y.push(this._getHash(o[t]));const _=`${h}/${p}D${A.join("/")}M${f.join("/")}I${y.join("/")}V${d.join("/")}H${this.stateHash}B${l}${u?"T":""}`;if(!this._programCache[_]){const t=function(t,e){const{vs:n,fs:i}=e,o=s(e.modules||[]);return{gl:t,vs:P(t,Object.assign({},e,{source:n,type:r.H,modules:o})),fs:P(t,Object.assign({},e,{source:i,type:r.Y,modules:o})),getUniforms:M(o)}}(this.gl,{vs:e,fs:n,modules:c,inject:o,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:u});this._programCache[_]=new C.Z(this.gl,{hash:_,vs:t.vs,fs:t.fs,varyings:a,bufferMode:l}),this._getUniforms[_]=t.getUniforms||(t=>{}),this._useCounts[_]=0}return this._useCounts[_]++,this._programCache[_]}getUniforms(t){return this._getUniforms[t.hash]||null}release(t){const e=t.hash;this._useCounts[e]--,0===this._useCounts[e]&&(this._programCache[e].delete(),delete this._programCache[e],delete this._getUniforms[e],delete this._useCounts[e])}_getHash(t){return void 0===this._hashes[t]&&(this._hashes[t]=this._hashCounter++),this._hashes[t]}_getModuleList(t=[]){const e=new Array(this._defaultModules.length+t.length),n={};let r=0;for(let t=0,i=this._defaultModules.length;t<i;++t){const i=this._defaultModules[t],o=i.name;e[r++]=i,n[o]=!0}for(let i=0,o=t.length;i<o;++i){const o=t[i],s=o.name;n[s]||(e[r++]=o,n[s]=!0)}return e.length=r,e}}},3346:(t,e,n)=>{"use strict";n.d(e,{Z:()=>E});var r=n(9047);const i="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",o=`#version 300 es\n${i}`;function s(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,i,o]=n;return e.includes(r)&&i&&o?{qualifier:r,type:i,name:o.split(";")[0]}:null}function a(t={}){const{version:e=100,input:n,inputType:s,output:a}=t;if(!n)return 300===e?o:e>300?`#version ${e}\n${i}`:"void main() {gl_FragColor = vec4(0);}";const l=function(t,e){switch(e){case"float":return`vec4(${t}, 0.0, 0.0, 1.0)`;case"vec2":return`vec4(${t}, 0.0, 1.0)`;case"vec3":return`vec4(${t}, 1.0)`;case"vec4":return t;default:return(0,r.Z)(!1),null}}(n,s);return e>=300?`#version ${e} ${300===e?"es":""}\nin ${s} ${n};\nout vec4 ${a};\nvoid main() {\n  ${a} = ${l};\n}`:`varying ${s} ${n};\nvoid main() {\n  gl_FragColor = ${l};\n}`}var l=n(9450),u=n(3478),c=n(1053),h=n(2525);class p{constructor(t,e={}){this.gl=t,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}setupResources(t){for(const e of this.bindings)this._setupTransformFeedback(e,t)}updateModelProps(t={}){const{varyings:e}=this;return e.length>0&&(t=Object.assign({},t,{varyings:e})),t}getDrawOptions(t={}){const e=this.bindings[this.currentIndex],{sourceBuffers:n,transformFeedback:r}=e;return{attributes:Object.assign({},n,t.attributes),transformFeedback:r}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(t={}){this._setupBuffers(t)}getBuffer(t){const{feedbackBuffers:e}=this.bindings[this.currentIndex],n=t?e[t]:null;return n?n instanceof u.Z?n:n.buffer:null}getData(t={}){const{varyingName:e}=t,n=this.getBuffer(e);return n?n.getData():null}delete(){for(const t in this.resources)this.resources[t].delete()}_initialize(t={}){this._setupBuffers(t),this.varyings=t.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&(0,h.h)((0,l.D0)(this.gl))}_getFeedbackBuffers(t){const{sourceBuffers:e={}}=t,n={};if(this.bindings[this.currentIndex]&&Object.assign(n,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const t in this.feedbackMap){const r=this.feedbackMap[t];t in e&&(n[r]=t)}Object.assign(n,t.feedbackBuffers);for(const t in n){const r=n[t];if("string"==typeof r){const i=e[r],{byteLength:o,usage:s,accessor:a}=i;n[t]=this._createNewBuffer(t,{byteLength:o,usage:s,accessor:a})}}return n}_setupBuffers(t={}){const{sourceBuffers:e=null}=t;Object.assign(this.feedbackMap,t.feedbackMap);const n=this._getFeedbackBuffers(t);this._updateBindings({sourceBuffers:e,feedbackBuffers:n})}_setupTransformFeedback(t,{model:e}){const{program:n}=e;t.transformFeedback=new c.Z(this.gl,{program:n,buffers:t.feedbackBuffers})}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this.feedbackMap){const{sourceBuffers:t,feedbackBuffers:e}=this._swapBuffers(this.bindings[this.currentIndex]),n=this._getNextIndex();this.bindings[n]=this._updateBinding(this.bindings[n],{sourceBuffers:t,feedbackBuffers:e})}}_updateBinding(t,e){return t?(Object.assign(t.sourceBuffers,e.sourceBuffers),Object.assign(t.feedbackBuffers,e.feedbackBuffers),t.transformFeedback&&t.transformFeedback.setBuffers(t.feedbackBuffers),t):{sourceBuffers:Object.assign({},e.sourceBuffers),feedbackBuffers:Object.assign({},e.feedbackBuffers)}}_swapBuffers(t){if(!this.feedbackMap)return null;const e=Object.assign({},t.sourceBuffers),n=Object.assign({},t.feedbackBuffers);for(const r in this.feedbackMap){const i=this.feedbackMap[r];e[r]=t.feedbackBuffers[i],n[i]=t.sourceBuffers[r],(0,h.h)(n[i]instanceof u.Z)}return{sourceBuffers:e,feedbackBuffers:n}}_createNewBuffer(t,e){const n=new u.Z(this.gl,e);return this.resources[t]&&this.resources[t].delete(),this.resources[t]=n,n}_getNextIndex(){return(this.currentIndex+1)%2}}var f=n(1953),d=n(4912),g=n(3849),m=n(3296);function A(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&"#version"===n[0]){const t=parseInt(n[1],10);Number.isFinite(t)&&(e=t)}return e}var y=n(6713);const _={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null};const v={10241:9728,10240:9728,10242:33071,10243:33071};class b{constructor(t,e={}){this.gl=t,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}updateModelProps(t={}){const e=this._processVertexShader(t);return Object.assign({},t,e)}getDrawOptions(t={}){const{sourceBuffers:e,sourceTextures:n,framebuffer:r,targetTexture:i}=this.bindings[this.currentIndex],o=Object.assign({},e,t.attributes),s=Object.assign({},t.uniforms),a=Object.assign({},t.parameters);let l=t.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const t in this.samplerTextureMap){const e=this.samplerTextureMap[t];s[t]=n[e]}this._setSourceTextureParameters();const t=function({sourceTextureMap:t,targetTextureVarying:e,targetTexture:n}){const r={};let i,o;e&&(({width:i,height:o}=n),r[`transform_uSize_${e}`]=[i,o]);for(const e in t)({width:i,height:o}=t[e]),r[`transform_uSize_${e}`]=[i,o];return r}({sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:i});Object.assign(s,t)}return this.hasTargetTexture&&(l=!1,a.viewport=[0,0,r.width,r.height]),{attributes:o,framebuffer:r,uniforms:s,discard:l,parameters:a}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(t={}){this._setupTextures(t)}getTargetTexture(){const{targetTexture:t}=this.bindings[this.currentIndex];return t}getData({packed:t=!1}={}){const{framebuffer:e}=this.bindings[this.currentIndex],n=(0,f.z6)(e);if(!t)return n;const i=n.constructor,o=function(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return(0,r.Z)(!1),null}}(this.targetTextureType),s=new i(n.length*o/4);let a=0;for(let t=0;t<n.length;t+=4)for(let e=0;e<o;e++)s[a++]=n[t+e];return s}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(t={}){const{_targetTextureVarying:e,_swapTexture:n}=t;this._swapTexture=n,this.targetTextureVarying=e,this.hasTargetTexture=e,this._setupTextures(t)}_createTargetTexture(t){const{sourceTextures:e,textureOrReference:n}=t;if(n instanceof d.Z)return n;const r=e[n];return r?(this._targetRefTexName=n,this._createNewTexture(r)):null}_setupTextures(t={}){const{sourceBuffers:e,_sourceTextures:n={},_targetTexture:r}=t,i=this._createTargetTexture({sourceTextures:n,textureOrReference:r});this.hasSourceTextures=this.hasSourceTextures||n&&Object.keys(n).length>0,this._updateBindings({sourceBuffers:e,sourceTextures:n,targetTexture:i}),"elementCount"in t&&this._updateElementIDBuffer(t.elementCount)}_updateElementIDBuffer(t){if("number"!=typeof t||this.elementCount>=t)return;const e=new Float32Array(t);e.forEach(((t,e,n)=>{n[e]=e})),this.elementIDBuffer?this.elementIDBuffer.setData({data:e}):this.elementIDBuffer=new u.Z(this.gl,{data:e,accessor:{size:1}}),this.elementCount=t}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this._swapTexture){const{sourceTextures:t,targetTexture:e}=this._swapTextures(this.bindings[this.currentIndex]),n=this._getNextIndex();this.bindings[n]=this._updateBinding(this.bindings[n],{sourceTextures:t,targetTexture:e})}}_updateBinding(t,e){const{sourceBuffers:n,sourceTextures:r,targetTexture:i}=e;if(t||(t={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(t.sourceTextures,r),Object.assign(t.sourceBuffers,n),i){t.targetTexture=i;const{width:e,height:n}=i,{framebuffer:r}=t;r?(r.update({attachments:{36064:i},resizeAttachments:!1}),r.resize({width:e,height:n})):t.framebuffer=new g.Z(this.gl,{id:"transform-framebuffer",width:e,height:n,attachments:{36064:i}})}return t}_setSourceTextureParameters(){const t=this.currentIndex,{sourceTextures:e}=this.bindings[t];for(const t in e)e[t].setParameters(v)}_swapTextures(t){if(!this._swapTexture)return null;const e=Object.assign({},t.sourceTextures);return e[this._swapTexture]=t.targetTexture,{sourceTextures:e,targetTexture:t.sourceTextures[this._swapTexture]}}_createNewTexture(t){const e=(0,m.h)(t,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=e,e}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(t={}){const{sourceTextures:e,targetTexture:n}=this.bindings[this.currentIndex],{vs:i,uniforms:o,targetTextureType:l,inject:u,samplerTextureMap:c}=function({vs:t,sourceTextureMap:e,targetTextureVarying:n,targetTexture:i}){let o=Object.keys(e).length,a=null;const l={};let u=t,c={};if(o>0||n){const t=u.split("\n"),p=t.slice();if(t.forEach(((t,i,u)=>{if(o>0){const n=function(t,e){const n={},i=function(t){return s(t,["attribute","in"])}(t);if(!i)return null;const{type:o,name:a}=i;if(a&&e[a]){const e=`// ${t} => Replaced by Transform with a sampler`,{samplerName:i,sizeName:s,uniformDeclerations:l}=function(t){const e=`transform_uSampler_${t}`,n=`transform_uSize_${t}`;return{samplerName:e,sizeName:n,uniformDeclerations:`  uniform sampler2D ${e};\n  uniform vec2 ${n};`}}(a),u=function(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return(0,r.Z)(!1),null}}(o),c=`  ${o} ${a} = transform_getInput(${i}, ${s}).${u};\n`;return n[i]=a,{updatedLine:e,inject:{"vs:#decl":l,"vs:#main-start":c},samplerTextureMap:n}}return null}(t,e);if(n){const{updatedLine:t,inject:e}=n;p[i]=t,c=(0,y.Lm)([c,e]),Object.assign(l,n.samplerTextureMap),o--}}n&&!a&&(a=function(t,e){const n=s(t,["varying","out"]);return n&&n.name===e?n.type:null}(t,n))})),n){(0,h.h)(i);const t=`transform_uSize_${n}`,e={"vs:#decl":`uniform vec2 ${t};\n`,"vs:#main-start":`     vec2 transform_position = transform_getPos(${t});\n     gl_Position = vec4(transform_position, 0, 1.);\n`};c=(0,y.Lm)([c,e])}u=p.join("\n")}return{vs:u,targetTextureType:a,inject:c,samplerTextureMap:l}}({vs:t.vs,sourceTextureMap:e,targetTextureVarying:this.targetTextureVarying,targetTexture:n}),p=(0,y.Lm)([t.inject||{},u]);return this.targetTextureType=l,this.samplerTextureMap=c,{vs:i,fs:t._fs||a({version:A(i),input:this.targetTextureVarying,inputType:l,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[_].concat(t.modules||[]):t.modules,uniforms:o,inject:p}}}var x=n(4538),w=n(1113);class E{static isSupported(t){return(0,l.D0)(t)}constructor(t,e={}){this.gl=t,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(e),Object.seal(this)}delete(){const{model:t,bufferTransform:e,textureTransform:n}=this;t&&t.delete(),e&&e.delete(),n&&n.delete()}run(t={}){const{clearRenderTarget:e=!0}=t,n=this._updateDrawOptions(t);e&&n.framebuffer&&n.framebuffer.clear({color:!0}),this.model.transform(n)}swap(){let t=!1;const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e)t=t||n.swap();(0,h.h)(t,"Nothing to swap")}getBuffer(t=null){return this.bufferTransform&&this.bufferTransform.getBuffer(t)}getData(t={}){const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e){const e=n.getData(t);if(e)return e}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(t={}){"elementCount"in t&&this.model.setVertexCount(t.elementCount);const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e)n.update(t)}_initialize(t={}){const{gl:e}=this;this._buildResourceTransforms(e,t),t=this._updateModelProps(t),this.model=new w.Z(e,Object.assign({},t,{fs:t.fs||a({version:A(t.vs)}),id:t.id||"transform-model",drawMode:t.drawMode||0,vertexCount:t.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(t){let e=Object.assign({},t);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const t of n)e=t.updateModelProps(e);return e}_buildResourceTransforms(t,e){(function(t){return!((0,x.nK)(t.feedbackBuffers)&&(0,x.nK)(t.feedbackMap)&&!(t.varyings&&t.varyings.length>0))})(e)&&(this.bufferTransform=new p(t,e)),function(t){return!((0,x.nK)(t._sourceTextures)&&!t._targetTexture&&!t._targetTextureVarying)}(e)&&(this.textureTransform=new b(t,e)),(0,h.h)(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(t){let e=Object.assign({},t);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const t of n)e=Object.assign(e,t.getDrawOptions(e));return e}}},6234:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(1113),i=n(3982);const o=[-1,-1,1,-1,-1,1,1,1];class s extends r.Z{constructor(t,e){const n=o.map((t=>-1===t?0:t));super(t,Object.assign({},e,{vs:"attribute vec2 aClipSpacePosition;\nattribute vec2 aTexCoord;\nattribute vec2 aCoordinate;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main(void) {\n  gl_Position = vec4(aClipSpacePosition, 0., 1.);\n  position = aClipSpacePosition;\n  coordinate = aCoordinate;\n  uv = aTexCoord;\n}\n",geometry:new i.Z({drawMode:5,vertexCount:4,attributes:{aClipSpacePosition:{size:2,value:new Float32Array(o)},aTexCoord:{size:2,value:new Float32Array(n)},aCoordinate:{size:2,value:new Float32Array(n)}}})})),this.setVertexCount(4)}}},1307:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(4211),i=n(6948),o=n(4912),s=n(9450);class a{constructor(t,{attributes:e,material:n,pbrDebug:o,imageBasedLightingEnvironment:s,lights:a,useTangents:l}){this.gl=t,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},(0,r.U6)(t,i.h.GLSL_TEXTURE_LOD)&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],s&&(this.uniforms.u_DiffuseEnvSampler=s.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=s.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=s.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),o&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(e.NORMAL,"HAS_NORMALS"),this.defineIfPresent(e.TANGENT&&l,"HAS_TANGENTS"),this.defineIfPresent(e.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(s,"USE_IBL"),this.defineIfPresent(a,"USE_LIGHTS"),this.defineIfPresent(o,"PBR_DEBUG"),n&&this.parseMaterial(n)}defineIfPresent(t,e){t&&(this.defines[e]=1)}parseTexture(t,e,n=null){const r=t.texture&&t.texture.sampler&&t.texture.sampler.parameters||{},i=t.texture.source.image;let s,a={};i.compressed?(s=i,a={[this.gl.TEXTURE_MIN_FILTER]:i.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):s={data:i};const l=new o.Z(this.gl,{id:t.name||t.id,parameters:{...r,...a},pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1},...s});this.uniforms[e]=l,this.defineIfPresent(n,n),this.generatedTextures.push(l)}parsePbrMetallicRoughness(t){t.baseColorTexture&&this.parseTexture(t.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=t.baseColorFactor||[1,1,1,1],t.metallicRoughnessTexture&&this.parseTexture(t.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:e=1,roughnessFactor:n=1}=t;this.uniforms.u_MetallicRoughnessValues=[e,n]}parseMaterial(t){if(this.uniforms.pbr_uUnlit=Boolean(t.unlit),t.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(t.pbrMetallicRoughness),t.normalTexture){this.parseTexture(t.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:e=1}=t.normalTexture;this.uniforms.u_NormalScale=e}if(t.occlusionTexture){this.parseTexture(t.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:e=1}=t.occlusionTexture;this.uniforms.u_OcclusionStrength=e}if(t.emissiveTexture&&(this.parseTexture(t.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=t.emissiveFactor||[0,0,0]),"MASK"===t.alphaMode){const{alphaCutoff:e=.5}=t;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=e}else"BLEND"===t.alphaMode&&(s.cM.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}}},9450:(t,e,n)=>{"use strict";n.d(e,{KQ:()=>u,JD:()=>l,s9:()=>K,JY:()=>W,w:()=>q,ZS:()=>V,vd:()=>a,yW:()=>J,UF:()=>o,D0:()=>s,cM:()=>r,kL:()=>G,aQ:()=>tt,dR:()=>U,s8:()=>Z});const r=new(n(4708).Z)({id:"luma.gl"});function i(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function o(t){return"undefined"!=typeof WebGLRenderingContext&&t instanceof WebGLRenderingContext||"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&Number.isFinite(t._version))}function s(t){return"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&2===t._version)}function a(t){return s(t)?t:null}function l(t){return i(o(t),"Invalid WebGLRenderingContext"),t}function u(t){return i(s(t),"Requires WebGL2"),t}var c=n(9718);const h={};const p=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let e=0;e<this.attribs.length;e++){const r=new t.VertexAttrib(n);this.attribs[e]=r}this.maxAttrib=0};(p.VertexAttrib=function(t){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const f=function(t){const e=this;this.gl=t,function(t){const e=t.getError;t.getError=function(){let n;do{n=e.apply(t),0!==n&&(h[n]=!0)}while(0!==n);for(n in h)if(h[n])return delete h[n],parseInt(n,10);return 0}}(t);const n=this.original={getParameter:t.getParameter,enableVertexAttribArray:t.enableVertexAttribArray,disableVertexAttribArray:t.disableVertexAttribArray,bindBuffer:t.bindBuffer,getVertexAttrib:t.getVertexAttrib,vertexAttribPointer:t.vertexAttribPointer};t.getParameter=function(t){return t===e.VERTEX_ARRAY_BINDING_OES?e.currentVertexArrayObject===e.defaultVertexArrayObject?null:e.currentVertexArrayObject:n.getParameter.apply(this,arguments)},t.enableVertexAttribArray=function(t){const r=e.currentVertexArrayObject;r.maxAttrib=Math.max(r.maxAttrib,t);const i=r.attribs[t];return i.enabled=!0,n.enableVertexAttribArray.apply(this,arguments)},t.disableVertexAttribArray=function(t){const r=e.currentVertexArrayObject;r.maxAttrib=Math.max(r.maxAttrib,t);const i=r.attribs[t];return i.enabled=!1,n.disableVertexAttribArray.apply(this,arguments)},t.bindBuffer=function(t,r){switch(t){case 34962:e.currentArrayBuffer=r;break;case 34963:e.currentVertexArrayObject.elementArrayBuffer=r}return n.bindBuffer.apply(this,arguments)},t.getVertexAttrib=function(t,r){const i=e.currentVertexArrayObject,o=i.attribs[t];switch(r){case 34975:return o.buffer;case 34338:return o.enabled;case 34339:return o.size;case 34340:return o.stride;case 34341:return o.type;case 34922:return o.normalized;default:return n.getVertexAttrib.apply(this,arguments)}},t.vertexAttribPointer=function(t,r,i,o,s,a){const l=e.currentVertexArrayObject;l.maxAttrib=Math.max(l.maxAttrib,t);const u=l.attribs[t];return u.buffer=e.currentArrayBuffer,u.size=r,u.type=i,u.normalized=o,u.stride=s,u.offset=a,u.recache(),n.vertexAttribPointer.apply(this,arguments)},t.instrumentExtension&&t.instrumentExtension(this,"OES_vertex_array_object"),t.canvas&&t.canvas.addEventListener("webglcontextrestored",(()=>{c.CO.console&&c.CO.console.log&&c.CO.console.log("OESVertexArrayObject emulation library context restored"),e.reset_()}),!0),this.reset_()};f.prototype.VERTEX_ARRAY_BINDING_OES=34229,f.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let t=0;t<this.vertexArrayObjects.length;++t)this.vertexArrayObjects.isAlive=!1;const t=this.gl;this.maxVertexAttribs=t.getParameter(34921),this.defaultVertexArrayObject=new p(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},f.prototype.createVertexArrayOES=function(){const t=new p(this);return this.vertexArrayObjects.push(t),t},f.prototype.deleteVertexArrayOES=function(t){t.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(t),1),this.currentVertexArrayObject===t&&this.bindVertexArrayOES(null)},f.prototype.isVertexArrayOES=function(t){return!!(t&&t instanceof p&&t.hasBeenBound&&t.ext===this)},f.prototype.bindVertexArrayOES=function(t){const e=this.gl;if(t&&!t.isAlive)return n="bindVertexArrayOES: attempt to bind deleted arrayObject",h[1282]=!0,void(void 0!==n&&(r=n,c.CO.console&&c.CO.console.error&&c.CO.console.error(r)));var n,r;const i=this.original,o=this.currentVertexArrayObject;this.currentVertexArrayObject=t||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(o===s)return;o&&s.elementArrayBuffer===o.elementArrayBuffer||i.bindBuffer.call(e,34963,s.elementArrayBuffer);let a=this.currentArrayBuffer;const l=Math.max(o?o.maxAttrib:0,s.maxAttrib);for(let t=0;t<=l;t++){const n=s.attribs[t],r=o?o.attribs[t]:null;if(o&&n.enabled===r.enabled||(n.enabled?i.enableVertexAttribArray.call(e,t):i.disableVertexAttribArray.call(e,t)),n.enabled){let s=!1;o&&n.buffer===r.buffer||(a!==n.buffer&&(i.bindBuffer.call(e,34962,n.buffer),a=n.buffer),s=!0),(s||n.cached!==r.cached)&&i.vertexAttribPointer.call(e,t,n.size,n.type,n.normalized,n.stride,n.offset)}}this.currentArrayBuffer!==a&&i.bindBuffer.call(e,34962,this.currentArrayBuffer)};const d="OES_element_index",g="WEBGL_draw_buffers",m="WEBGL_debug_renderer_info",A=t=>s(t)?void 0:0,y={3074:t=>s(t)?void 0:36064,35723:t=>s(t)?void 0:4352,35977:A,32937:A,36795:(t,e)=>{const n=s(t)?t.getExtension("EXT_disjoint_timer_query_webgl2"):t.getExtension("EXT_disjoint_timer_query");return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},37445:(t,e)=>{const n=t.getExtension(m);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},37446:(t,e)=>{const n=t.getExtension(m);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},34047:(t,e)=>{const n=t.luma.extensions.EXT_texture_filter_anisotropic;return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:A,35071:A,37447:A,36063:(t,e)=>{if(!s(t)){const n=t.getExtension(g);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:A,35374:A,35377:A,34852:t=>{if(!s(t)){const e=t.getExtension(g);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(d)?2147483647:65535,33001:t=>t.getExtension(d)?16777216:65535,33e3:t=>16777216,37157:A,35373:A,35657:A,36183:A,37137:A,34045:A,35978:A,35979:A,35968:A,35376:A,35375:A,35659:A,37154:A,35371:A,35658:A,35076:A,35077:A,35380:A},_="ANGLE_instanced_arrays",v={OES_vertex_array_object:{meta:{suffix:"OES"},createVertexArray:()=>{i(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[_]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){i(0===e,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},WEBGL_draw_buffers:{meta:{suffix:"WEBGL"},drawBuffers:()=>{i(!1)}},EXT_disjoint_timer_query:{meta:{suffix:"EXT"},createQuery:()=>{i(!1)},deleteQuery:()=>{i(!1)},beginQuery:()=>{i(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},b={readBuffer:(t,e,n)=>{s(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:i,ext:o}=function(t,e){return{webgl2:s(t),ext:t.getExtension("ANGLE_instanced_arrays")}}(t);let a;switch(r){case 35069:a=!!i&&void 0;break;case 35070:a=i||o?void 0:0}return void 0!==a?a:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!s(t))switch(r){case 35967:return 35981;case 35971:case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,i)=>s(t)||32937!==i?t.getInternalformatParameter(n,r,i):new Int32Array([0]),getTexParameter(t,e,n,r){if(34046===r){const{extensions:e}=t.luma,n=e.EXT_texture_filter_anisotropic;r=n&&n.TEXTURE_MAX_ANISOTROPY_EXT||34046}return e(n,r)},getParameter:function(t,e,n){const r=y[n],i="function"==typeof r?r(t,e,n):r;return void 0!==i?i:e(n)},hint:(t,e,n,r)=>e(n,r)};function x(t,{extension:e,target:n,target2:r}){const o=v[e];i(o);const{meta:s={}}=o,{suffix:a=""}=s,l=t.getExtension(e);for(const e of Object.keys(o)){const i=`${e}${a}`;let s=null;"meta"===e||"function"==typeof t[e]||(l&&"function"==typeof l[i]?s=(...t)=>l[i](...t):"function"==typeof o[e]&&(s=o[e].bind(n))),s&&(n[e]=s,r[e]=s)}}(void 0!==n.g?n.g:window).polyfillContext=function(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(function(t){if("function"==typeof t.createVertexArray)return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const t=e.call(this)||[];return t.indexOf("OES_vertex_array_object")<0&&t.push("OES_vertex_array_object"),t};const n=t.getExtension;t.getExtension=function(e){return n.call(this,e)||("OES_vertex_array_object"!==e?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new f(this)),this.__OESVertexArrayObject))}}(t),function(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}(t),function(t,e){for(const n of Object.getOwnPropertyNames(e))"overrides"!==n&&x(t,{extension:n,target:t.luma,target2:t})}(t,v),function(t,{target:e,target2:n}){Object.keys(b).forEach((r=>{if("function"==typeof b[r]){const i=t[r]?t[r].bind(t):()=>{},o=b[r].bind(null,t,i);e[r]=o,n[r]=o}}))}(t,{target:e,target2:t}),e.polyfilled=!0),t};const w={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},E=(t,e,n)=>e?t.enable(n):t.disable(n),S=(t,e,n)=>t.hint(n,e),T=(t,e,n)=>t.pixelStorei(n,e);function P(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const M={3042:E,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:E,2885:(t,e)=>t.cullFace(e),2929:E,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:E,35723:S,36006:(t,e)=>{const n=s(t)?36009:36160;return t.bindFramebuffer(n,e)},2886:(t,e)=>t.frontFace(e),33170:S,2849:(t,e)=>t.lineWidth(e),32823:E,32824:"polygonOffset",10752:"polygonOffset",35977:E,32938:"sampleCoverage",32939:"sampleCoverage",3089:E,3088:(t,e)=>t.scissor(...e),2960:E,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:T,3317:T,37440:T,37441:T,37443:T,3330:T,3332:T,3331:T,36010:(t,e)=>t.bindFramebuffer(36008,e),3314:T,32878:T,3316:T,3315:T,32877:T,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=P(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=P(e)&&2===e.length?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=P(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=P(e)&&3===e.length?[...e,...e]:e;const[n,r,i,o,s,a]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,o,s,a)},stencilOp:(t,e)=>{e=P(e)&&3===e.length?[...e,...e]:e;const[n,r,i,o,s,a]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,o,s,a)},viewport:(t,e)=>t.viewport(...e)};function C(t,e,n){return void 0!==e[t]?e[t]:n[t]}const I={blendEquation:(t,e,n)=>t.blendEquationSeparate(C(32777,e,n),C(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(C(32969,e,n),C(32968,e,n),C(32971,e,n),C(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(C(32824,e,n),C(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(C(32938,e,n),C(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,C(2962,e,n),C(2967,e,n),C(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,C(34816,e,n),C(36003,e,n),C(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,C(2964,e,n),C(2965,e,n),C(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,C(34817,e,n),C(34818,e,n),C(34819,e,n))},O={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,r,i)=>t({32773:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,r,i)=>t({32969:e,32968:n,32971:r,32970:i}),clearColor:(t,e,n,r,i)=>t({3106:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,r,i)=>t({3107:[e,n,r,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,r,i)=>t({3088:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[1028===e?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({2962:e,2967:n,2963:r,34816:e,36003:n,36004:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[1028===e?2962:34816]:n,[1028===e?2967:36003]:r,[1028===e?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({2964:e,2965:n,2966:r,34817:e,34818:n,34819:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[1028===e?2964:34817]:n,[1028===e?2965:34818]:r,[1028===e?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({2978:[e,n,r,i]})},R=(t,e)=>t.isEnabled(e),L={3042:R,2884:R,2929:R,3024:R,32823:R,32926:R,32928:R,3089:R,2960:R,35977:R};function k(t){for(const e in t)return!1;return!0}function D(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}return!1}function N(t,e){const n=t[e].bind(t);t[e]=function(...e){const r=e[0];return r in t.state.cache&&t.state.enable?t.state.cache[r]:n(...e)},Object.defineProperty(t[e],"name",{value:`${e}-from-cache`,configurable:!1})}function F(t,e,n){const r=t[e].bind(t);t[e]=function(...e){const{valueChanged:i,oldValue:o}=n(t.state._updateCache,...e);return i&&r(...e),o},Object.defineProperty(t[e],"name",{value:`${e}-to-cache`,configurable:!1})}class B{constructor(t,{copyState:e=!1,log:n=(()=>{})}={}){this.gl=t,this.program=null,this.stateStack=[],this.enable=!0,this.cache=e?V(t):Object.assign({},w),this.log=n,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(t={}){this.stateStack.push({})}pop(){i(this.stateStack.length>0);const t=this.stateStack[this.stateStack.length-1];U(this.gl,t),this.stateStack.pop()}_updateCache(t){let e,n=!1;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const o in t){i(void 0!==o);const s=t[o],a=this.cache[o];D(s,a)||(n=!0,e=a,r&&!(o in r)&&(r[o]=a),this.cache[o]=s)}return{valueChanged:n,oldValue:e}}}function z(t,e={}){const{enable:r=!0,copyState:o}=e;if(i(void 0!==o),!t.state){const e=void 0!==n.g?n.g:window,{polyfillContext:r}=e;r&&r(t),t.state=new B(t,{copyState:o}),function(t){const e=t.useProgram.bind(t);t.useProgram=function(n){t.state.program!==n&&(e(n),t.state.program=n)}}(t);for(const e in O)F(t,e,O[e]);N(t,"getParameter"),N(t,"isEnabled")}return t.state.enable=r,t}function j(t){i(t.state),t.state.pop()}function U(t,e){if(i(o(t),"setParameters requires a WebGL context"),k(e))return;const n={};for(const r in e){const i=Number(r),o=M[r];o&&("string"==typeof o?n[o]=!0:o(t,e[r],i))}const r=t.state&&t.state.cache;if(r)for(const i in n)(0,I[i])(t,e,r)}function V(t,e){if("number"==typeof(e=e||w)){const n=e,r=L[n];return r?r(t,n):t.getParameter(n)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const e of n){const n=L[e];r[e]=n?n(t,Number(e)):t.getParameter(Number(e))}return r}function G(t){U(t,w)}function Z(t,e,n){if(k(e))return n(t);const{nocatch:r=!0}=e;let i;if(function(t){t.state||z(t,{copyState:!1}),t.state.push()}(t),U(t,e),r)i=n(t),j(t);else try{i=n(t)}finally{j(t)}return i}function q(t){const{luma:e}=t;if(t.canvas&&e){const{clientWidth:n}=e.canvasSizeInfo;return n?t.drawingBufferWidth/n:1}return 1}function W(t,e,n=!0){return function(t,e,n,r,i){const o=H(t[0],e,n);let s=X(t[1],e,r,i),a=H(t[0]+1,e,n);const l=a===n-1?a:a-1;let u;return a=X(t[1]+1,e,r,i),i?(a=0===a?a:a+1,u=s,s=a):u=a===r-1?a:a-1,{x:o,y:s,width:Math.max(l-o+1,1),height:Math.max(u-s+1,1)}}(e,q(t),t.drawingBufferWidth,t.drawingBufferHeight,n)}function H(t,e,n){return Math.min(Math.round(t*e),n-1)}function X(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const $=(0,c.jU)(),Y=$&&"undefined"!=typeof document,Q={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function K(t={}){i($,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),t=Object.assign({},Q,t);const{width:e,height:n}=t;function o(e){if(t.throwOnError)throw new Error(e);return console.error(e),null}let a;t.onError=o;const{canvas:l}=t,u=function({canvas:t,width:e=800,height:n=600,onError:r}){let i;return"string"==typeof t?(Y&&"complete"===document.readyState||r(`createGLContext called on canvas '${t}' before page was loaded`),i=document.getElementById(t)):t?i=t:(i=document.createElement("canvas"),i.id="lumagl-canvas",i.style.width=Number.isFinite(e)?`${e}px`:"100%",i.style.height=Number.isFinite(n)?`${n}px`:"100%",document.body.insertBefore(i,document.body.firstChild)),i}({canvas:l,width:e,height:n,onError:o});return a=function(t,e){const{onError:n}=e;let r=null;const i=t=>r=t.statusMessage||r;t.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:o=!0,webgl2:s=!0}=e;let a=null;return s&&(a=a||t.getContext("webgl2",e),a=a||t.getContext("experimental-webgl2",e)),o&&(a=a||t.getContext("webgl",e),a=a||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",i,!1),a?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):n(`Failed to create ${s&&!o?"WebGL2":"WebGL"} context: ${r||"Unknown error"}`)}(u,t),a?(a=J(a,t),function(t){const e=s(t)?"WebGL2":"WebGL1",n=function(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info");return{vendor:r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936)||e,renderer:r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937)||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}(t),i=n?`(${n.vendor},${n.renderer})`:"",o=t.debug?" debug":"";r.info(1,`${e}${o} context ${i}`)()}(a),a):null}function J(t,e={}){if(!t||t._instrumented)return t;t._version=t._version||function(t){return"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext?2:1}(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},Q,e);const{manageState:n,debug:i}=e;return n&&z(t,{copyState:!1,log:(...t)=>r.log(1,...t)()}),$&&i&&(c.CO.makeDebugContext?(t=c.CO.makeDebugContext(t,e),r.level=Math.max(r.level,1)):r.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function tt(t,e={}){if(t.canvas)return void function(t,e,n){let i="width"in n?n.width:t.canvas.clientWidth,o="height"in n?n.height:t.canvas.clientHeight;i&&o||(r.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,i=t.canvas.width||1,o=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const s=t.luma.canvasSizeInfo;if(s.clientWidth!==i||s.clientHeight!==o||s.devicePixelRatio!==e){let n=e;const s=Math.floor(i*n),a=Math.floor(o*n);t.canvas.width=s,t.canvas.height=a,t.drawingBufferWidth===s&&t.drawingBufferHeight===a||(r.warn("Device pixel ratio clamped")(),n=Math.min(t.drawingBufferWidth/i,t.drawingBufferHeight/o),t.canvas.width=Math.floor(i*n),t.canvas.height=Math.floor(o*n)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:i,clientHeight:o,devicePixelRatio:e})}}(t,function(t){const e="undefined"==typeof window?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}(e.useDevicePixels),e);const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}},5682:(t,e,n)=>{"use strict";n.d(e,{H:()=>r,Y:()=>i});const r="vs",i="fs"},6713:(t,e,n)=>{"use strict";n.d(e,{O_:()=>s,Lm:()=>h,ZP:()=>c});var r=n(5682),i=n(9047);const o={[r.H]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",[r.Y]:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},s="__LUMA_INJECT_DECLARATIONS__",a=/void\s+main\s*\([^)]*\)\s*\{\n?/,l=/}\n?[^{}]*$/,u=[];function c(t,e,n,i=!1){const c=e===r.H;for(const e in n){const r=n[e];r.sort(((t,e)=>t.order-e.order)),u.length=r.length;for(let t=0,e=r.length;t<e;++t)u[t]=r[t].injection;const i=`${u.join("\n")}\n`;switch(e){case"vs:#decl":c&&(t=t.replace(s,i));break;case"vs:#main-start":c&&(t=t.replace(a,(t=>t+i)));break;case"vs:#main-end":c&&(t=t.replace(l,(t=>i+t)));break;case"fs:#decl":c||(t=t.replace(s,i));break;case"fs:#main-start":c||(t=t.replace(a,(t=>t+i)));break;case"fs:#main-end":c||(t=t.replace(l,(t=>i+t)));break;default:t=t.replace(e,(t=>t+i))}}return t=t.replace(s,""),i&&(t=t.replace(/\}\s*$/,(t=>t+o[e]))),t}function h(t){const e={};return(0,i.Z)(Array.isArray(t)&&t.length>1),t.forEach((t=>{for(const n in t)e[n]=e[n]?`${e[n]}\n${t[n]}`:t[n]})),e}},6119:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a,v:()=>l});var r=n(9047);const i={number:{validate:(t,e)=>Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)},array:{validate:(t,e)=>Array.isArray(t)||ArrayBuffer.isView(t)}};function o(t){let e=s(t);return"object"===e?t?"type"in t?Object.assign({},t,i[t.type]):"value"in t?(e=s(t.value),Object.assign({type:e},t,i[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},i[e])}function s(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}class a{constructor({name:t,vs:e,fs:n,dependencies:i=[],uniforms:s,getUniforms:a,deprecations:l=[],defines:u={},inject:c={},vertexShader:h,fragmentShader:p}){(0,r.Z)("string"==typeof t),this.name=t,this.vs=e||h,this.fs=n||p,this.getModuleUniforms=a,this.dependencies=i,this.deprecations=this._parseDeprecationDefinitions(l),this.defines=u,this.injections=function(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const i=n.slice(0,2);"string"==typeof r&&(r={order:0,injection:r}),e[i][n]=r}return e}(c),s&&(this.uniforms=function(t){const e={};for(const n in t){const r=o(t[n]);e[n]=r}return e}(s))}getModuleSource(t){let e;switch(t){case"vs":e=this.vs||"";break;case"fs":e=this.fs||"";break;default:(0,r.Z)(!1)}return`#define MODULE_${this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_")}\n${e}// END MODULE_${this.name}\n\n`}getUniforms(t,e){return this.getModuleUniforms?this.getModuleUniforms(t,e):this.uniforms?this._defaultGetUniforms(t):{}}getDefines(){return this.defines}checkDeprecations(t,e){this.deprecations.forEach((n=>{n.regex.test(t)&&(n.deprecated?e.deprecated(n.old,n.new)():e.removed(n.old,n.new)())}))}_parseDeprecationDefinitions(t){return t.forEach((t=>{"function"===t.type?t.regex=new RegExp(`\\b${t.old}\\(`):t.regex=new RegExp(`${t.type} ${t.old};`)})),t}_defaultGetUniforms(t={}){const e={},n=this.uniforms;for(const i in n){const o=n[i];i in t&&!o.private?(o.validate&&(0,r.Z)(o.validate(t[i],o),`${this.name}: invalid ${i}`),e[i]=t[i]):e[i]=o.value}return e}}function l(t){if(!t.normalized&&(t.normalized=!0,t.uniforms&&!t.getUniforms)){const e=new a(t);t.getUniforms=e.getUniforms.bind(e)}return t}},5502:(t,e,n)=>{"use strict";n.d(e,{O:()=>r});const r={name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null}},7024:(t,e,n)=>{"use strict";n.d(e,{H:()=>s});const r="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n",i={lightSources:{}};function o({color:t=[0,0,0],intensity:e=1}={}){return t.map((t=>t*e/255))}const s={name:"lights",vs:r,fs:r,getUniforms:function t(e=i){if("lightSources"in e){const{ambientLight:t,pointLights:n,directionalLights:r}=e.lightSources||{};return t||n&&n.length>0||r&&r.length>0?Object.assign({},function({ambientLight:t,pointLights:e=[],directionalLights:n=[]}){const r={};return r["lighting_uAmbientLight.color"]=t?o(t):[0,0,0],e.forEach(((t,e)=>{r[`lighting_uPointLight[${e}].color`]=o(t),r[`lighting_uPointLight[${e}].position`]=t.position,r[`lighting_uPointLight[${e}].attenuation`]=t.attenuation||[1,0,0]})),r.lighting_uPointLightCount=e.length,n.forEach(((t,e)=>{r[`lighting_uDirectionalLight[${e}].color`]=o(t),r[`lighting_uDirectionalLight[${e}].direction`]=t.direction})),r.lighting_uDirectionalLightCount=n.length,r}({ambientLight:t,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in e){const n={pointLights:[],directionalLights:[]};for(const t of e.lights||[])switch(t.type){case"ambient":n.ambientLight=t;break;case"directional":n.directionalLights.push(t);break;case"point":n.pointLights.push(t)}return t({lightSources:n})}return{}},defines:{MAX_LIGHTS:3}}},4080:(t,e,n)=>{"use strict";n.d(e,{b:()=>r});const r={name:"pbr",vs:"uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\nvarying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",fs:"#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)\n# error PBR fragment shader: Texture LOD is not available\n#endif\n\n#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)\n# error PBR fragment shader: Derivatives are not available\n#endif\n\n\n#if (__VERSION__ < 300)\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)\n#else\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)\n#endif\n\nprecision highp float;\n\nuniform bool pbr_uUnlit;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\n#ifdef ALPHA_CUTOFF\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n\nstruct PBRInfo\n{\n  float NdotL;\n  float NdotV;\n  float NdotH;\n  float LdotH;\n  float VdotH;\n  float perceptualRoughness;\n  float metalness;\n  vec3 reflectance0;\n  vec3 reflectance90;\n  float alphaRoughness;\n  vec3 diffuseColor;\n  vec3 specularColor;\n  vec3 n;\n  vec3 v;\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif\n  return vec4(linOut,srgbIn.w);;\n#else\n  return srgbIn;\n#endif\n}\n\nvec3 getNormal()\n{\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0;\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n\n\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n\n\n\n\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {\n  pbrInputs.NdotL = 1.0;\n  pbrInputs.NdotH = 0.0;\n  pbrInputs.LdotH = 0.0;\n  pbrInputs.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {\n  vec3 n = pbrInputs.n;\n  vec3 v = pbrInputs.v;\n  vec3 l = normalize(lightDirection);\n  vec3 h = normalize(l+v);\n\n  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInputs, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);\n  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < u_AlphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 color = vec3(0, 0, 0);\n\n  if(pbr_uUnlit){\n    color.rgb = baseColor.rgb;\n  }\n  else{\n\n\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\n    float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n\n    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n#endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n\n\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();\n    vec3 v = normalize(u_Camera - pbr_vPosition);\n\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    vec3 reflection = -normalize(reflect(v, n));\n\n    PBRInfo pbrInputs = PBRInfo(\n      0.0,\n      NdotV,\n      0.0,\n      0.0,\n      0.0,\n      perceptualRoughness,\n      metallic,\n      specularEnvironmentR0,\n      specularEnvironmentR90,\n      alphaRoughness,\n      diffuseColor,\n      specularColor,\n      n,\n      v\n    );\n\n#ifdef USE_LIGHTS\n    PBRInfo_setAmbientLight(pbrInputs);\n    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {\n      if (i < lighting_uDirectionalLightCount) {\n        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);\n        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);\n      }\n    }\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {\n      if (i < lighting_uPointLightCount) {\n        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);\n        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));\n        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);\n      }\n    }\n#endif\n#ifdef USE_IBL\n    color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n#ifdef HAS_OCCLUSIONMAP\n    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n#ifdef PBR_DEBUG\n\n\n\n\n\n    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  }\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n",defines:{LIGHTING_FRAGMENT:1},dependencies:[n(7024).H]}},7287:(t,e,n)=>{"use strict";n.d(e,{N:()=>a,s:()=>l});var r=n(7024);const i="\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n",o={};function s(t=o){if(!("material"in t))return{};const{material:e}=t;return e?function(t){const{ambient:e=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map((t=>t/255))}}(e):{lighting_uEnabled:!1}}const a={name:"gouraud-lighting",dependencies:[r.H],vs:i,defines:{LIGHTING_VERTEX:1},getUniforms:s},l={name:"phong-lighting",dependencies:[r.H],fs:i,defines:{LIGHTING_FRAGMENT:1},getUniforms:s}},3330:(t,e,n)=>{"use strict";n.d(e,{q:()=>i});const r={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1},i={name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(t=r){const e={};if(void 0!==t.pickingSelectedColor)if(t.pickingSelectedColor){const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}else e.picking_uSelectedColorValid=0;if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,(t=>t/255));Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return void 0!==t.pickingActive&&(e.picking_uActive=Boolean(t.pickingActive),e.picking_uAttribute=Boolean(t.pickingAttribute)),e}}},9047:(t,e,n)=>{"use strict";function r(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}n.d(e,{Z:()=>r})},4072:(t,e,n)=>{"use strict";n.d(e,{Z:()=>l});var r=n(9335),i=n(2525),o=n(2610);const s={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},a={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class l{static getBytesPerElement(t){return(0,r.vN)(t.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(t){return(0,i.h)(t.size),(0,r.vN)(t.type||5126).BYTES_PER_ELEMENT*t.size}static resolve(...t){return new l(...[s,...t])}constructor(...t){t.forEach((t=>this._assign(t))),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return l.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return l.getBytesPerVertex(this)}_assign(t={}){return void 0!==(t=(0,o.k)("Accessor",t,a)).type&&(this.type=t.type,5124!==t.type&&5125!==t.type||(this.integer=!0)),void 0!==t.size&&(this.size=t.size),void 0!==t.offset&&(this.offset=t.offset),void 0!==t.stride&&(this.stride=t.stride),void 0!==t.normalized&&(this.normalized=t.normalized),void 0!==t.integer&&(this.integer=t.integer),void 0!==t.divisor&&(this.divisor=t.divisor),void 0!==t.buffer&&(this.buffer=t.buffer),void 0!==t.index&&("boolean"==typeof t.index?this.index=t.index?1:0:this.index=t.index),void 0!==t.instanced&&(this.divisor=t.instanced?1:0),void 0!==t.isInstanced&&(this.divisor=t.isInstanced?1:0),this}}},3478:(t,e,n)=>{"use strict";n.d(e,{Z:()=>p});var r=n(7577),i=n(4072),o=n(9335),s=n(9450),a=n(2525),l=n(2610);const u={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},c={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:u},h={removedProps:u};class p extends r.Z{constructor(t,e={}){super(t,e),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=e.target||(this.gl.webgl2?36662:34962),this.initialize(e),Object.seal(this)}getElementCount(t=this.accessor){return Math.round(this.byteLength/i.Z.getBytesPerElement(t))}getVertexCount(t=this.accessor){return Math.round(this.byteLength/i.Z.getBytesPerVertex(t))}initialize(t={}){return ArrayBuffer.isView(t)&&(t={data:t}),Number.isFinite(t)&&(t={byteLength:t}),t=(0,l.k)("Buffer",t,c),this.usage=t.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},t,t.accessor)),t.data?this._setData(t.data,t.offset,t.byteLength):this._setByteLength(t.byteLength||0),this}setProps(t){return"accessor"in(t=(0,l.k)("Buffer",t,h))&&this.setAccessor(t.accessor),this}setAccessor(t){return delete(t=Object.assign({},t)).buffer,this.accessor=new i.Z(t),this}reallocate(t){return t>this.byteLength?(this._setByteLength(t),!0):(this.bytesUsed=t,!1)}setData(t){return this.initialize(t)}subData(t){ArrayBuffer.isView(t)&&(t={data:t});const{data:e,offset:n=0,srcOffset:r=0}=t,i=t.byteLength||t.length;(0,a.h)(e);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),0!==r||void 0!==i?((0,s.KQ)(this.gl),this.gl.bufferSubData(this.target,n,e,r,i)):this.gl.bufferSubData(o,n,e),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(e),this}copyData({sourceBuffer:t,readOffset:e=0,writeOffset:n=0,size:r}){const{gl:i}=this;return(0,s.KQ)(i),i.bindBuffer(36662,t.handle),i.bindBuffer(36663,this.handle),i.copyBufferSubData(36662,36663,e,n,r),i.bindBuffer(36662,null),i.bindBuffer(36663,null),this.debugData=null,this}getData({dstData:t=null,srcByteOffset:e=0,dstOffset:n=0,length:r=0}={}){(0,s.KQ)(this.gl);const i=(0,o.vN)(this.accessor.type||5126,{clamped:!1}),l=this._getAvailableElementCount(e),u=n;let c,h;t?(h=t.length,c=h-u):(c=Math.min(l,r||l),h=u+c);const p=Math.min(l,c);return r=r||p,(0,a.h)(r<=p),t=t||new i(h),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,t,n,r),this.gl.bindBuffer(36662,null),t}bind({target:t=this.target,index:e=this.accessor&&this.accessor.index,offset:n=0,size:r}={}){return 35345===t||35982===t?void 0!==r?this.gl.bindBufferRange(t,e,this.handle,n,r):((0,a.h)(0===n),this.gl.bindBufferBase(t,e,this.handle)):this.gl.bindBuffer(t,this.handle),this}unbind({target:t=this.target,index:e=this.accessor&&this.accessor.index}={}){return 35345===t||35982===t?this.gl.bindBufferBase(t,e,null):this.gl.bindBuffer(t,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(t,e=0,n=t.byteLength+e){(0,a.h)(ArrayBuffer.isView(t)),this._trackDeallocatedMemory();const r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,this.usage),this.gl.bufferSubData(r,e,t),this.gl.bindBuffer(r,null),this.debugData=t.slice(0,10),this.bytesUsed=n,this._trackAllocatedMemory(n);const s=(0,o.O)(t);return(0,a.h)(s),this.setAccessor(new i.Z(this.accessor,{type:s})),this}_setByteLength(t,e=this.usage){(0,a.h)(t>=0),this._trackDeallocatedMemory();let n=t;0===t&&(n=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,e),this.gl.bindBuffer(r,null),this.usage=e,this.debugData=null,this.bytesUsed=t,this._trackAllocatedMemory(t),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(t){const e=t/(0,o.vN)(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-e}_inferType(t){this.accessor.type||this.setAccessor(new i.Z(this.accessor,{type:(0,o.O)(t)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(t){this.gl.bindBuffer(this.target,this.handle);const e=this.gl.getBufferParameter(this.target,t);return this.gl.bindBuffer(this.target,null),e}get type(){return s.cM.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return s.cM.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(t){return s.cM.deprecated("setByteLength","reallocate")(),this.reallocate(t)}updateAccessor(t){return s.cM.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new i.Z(this.accessor,t),this}}},6047:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s,$:()=>a});var r=n(9450),i=n(2525);const o="clear: bad arguments";function s(t,{framebuffer:e=null,color:n=null,depth:s=null,stencil:a=null}={}){const l={};e&&(l.framebuffer=e);let u=0;n&&(u|=16384,!0!==n&&(l.clearColor=n)),s&&(u|=256,!0!==s&&(l.clearDepth=s)),a&&(u|=1024,!0!==s&&(l.clearStencil=s)),(0,i.h)(0!==u,o),(0,r.s8)(t,l,(()=>{t.clear(u)}))}function a(t,{framebuffer:e=null,buffer:n=6144,drawBuffer:s=0,value:a=[0,0,0,0]}={}){(0,r.KQ)(t),(0,r.s8)(t,{framebuffer:e},(()=>{switch(n){case 6144:switch(a.constructor){case Int32Array:t.clearBufferiv(n,s,a);break;case Uint32Array:t.clearBufferuiv(n,s,a);break;case Float32Array:default:t.clearBufferfv(n,s,a)}break;case 6145:t.clearBufferfv(6145,0,[a]);break;case 6146:t.clearBufferiv(6146,0,[a]);break;case 34041:const[e,r]=a;t.clearBufferfi(34041,0,e,r);break;default:(0,i.h)(!1,o)}}))}},1953:(t,e,n)=>{"use strict";n.d(e,{Km:()=>f,Lv:()=>d,z6:()=>h,Jb:()=>p});var r=n(3478),i=n(3849),o=n(5008),s=n(9450),a=n(9335),l=n(2525);function u(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return(0,l.h)(!1),0}}var c=n(3296);function h(t,e={}){const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:o=36064,target:s=null,sourceWidth:c,sourceHeight:h,sourceType:p}=e;const{framebuffer:f,deleteFramebuffer:d}=g(t);(0,l.h)(f);const{gl:m,handle:A,attachments:y}=f;c=c||f.width,h=h||f.height,36064===o&&null===A&&(o=1028),(0,l.h)(y[o]),p=p||y[o].type,s=function(t,e,n,r,i){if(t)return t;e=e||5121;return new((0,a.vN)(e,{clamped:!1}))(r*i*u(n))}(s,p,i,c,h),p=p||(0,a.O)(s);const _=m.bindFramebuffer(36160,A);return m.readPixels(n,r,c,h,i,p,s),m.bindFramebuffer(36160,_||null),d&&f.delete(),s}function p(t,{sourceX:e=0,sourceY:n=0,sourceFormat:i=6408,target:o=null,targetByteOffset:a=0,sourceWidth:c,sourceHeight:h,sourceType:p}){const{framebuffer:f,deleteFramebuffer:d}=g(t);(0,l.h)(f),c=c||f.width,h=h||f.height;const m=(0,s.KQ)(f.gl);if(p=p||(o?o.type:5121),!o){const t=u(i),e=function(t){switch(t){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return(0,l.h)(!1),0}}(p),n=a+c*h*t*e;o=new r.Z(m,{byteLength:n,accessor:{type:p,size:t}})}return o.bind({target:35051}),(0,s.s8)(m,{framebuffer:f},(()=>{m.readPixels(e,n,c,h,i,p,a)})),o.unbind({target:35051}),d&&f.delete(),o}function f(t,{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}={}){let r=h(t,{sourceAttachment:e}),{width:i,height:o}=t;for(;o>n;)({data:r,width:i,height:o}=(0,a.KS)({data:r,width:i,height:o}));(0,a.c$)({data:r,width:i,height:o});const s=document.createElement("canvas");s.width=i,s.height=o;const l=s.getContext("2d"),u=l.createImageData(i,o);return u.data.set(r),l.putImageData(u,0,0),s.toDataURL()}function d(t,e,n={}){const{sourceX:r=0,sourceY:i=0,targetMipmaplevel:a=0,targetInternalFormat:u=6408}=n;let{targetX:c,targetY:h,targetZ:p,width:f,height:d}=n;const{framebuffer:m,deleteFramebuffer:A}=g(t);(0,l.h)(m);const{gl:y,handle:_}=m,v=void 0!==c||void 0!==h||void 0!==p;c=c||0,h=h||0,p=p||0;const b=y.bindFramebuffer(36160,_);(0,l.h)(e);let x=null;if(e instanceof o.Z&&(x=e,f=Number.isFinite(f)?f:x.width,d=Number.isFinite(d)?d:x.height,x.bind(0),e=x.target),v)switch(e){case 3553:case 34067:y.copyTexSubImage2D(e,a,c,h,r,i,f,d);break;case 35866:case 32879:(0,s.KQ)(y).copyTexSubImage3D(e,a,c,h,p,r,i,f,d)}else y.copyTexImage2D(e,a,u,r,i,f,d,0);return x&&x.unbind(),y.bindFramebuffer(36160,b||null),A&&m.delete(),x}function g(t){return t instanceof i.Z?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:(0,c.Y)(t),deleteFramebuffer:!0}}},3849:(t,e,n)=>{"use strict";n.d(e,{Z:()=>f});var r=n(9450),i=n(7577),o=n(4912),s=n(9830),a=n(6047),l=n(1953),u=n(4211),c=n(9579),h=n(2525);const p="Multiple render targets not supported";class f extends i.Z{static isSupported(t,e={}){const{colorBufferFloat:n,colorBufferHalfFloat:r}=e;let i=!0;return n&&(i=Boolean(t.getExtension("EXT_color_buffer_float")||t.getExtension("WEBGL_color_buffer_float")||t.getExtension("OES_texture_float"))),r&&(i=i&&Boolean(t.getExtension("EXT_color_buffer_float")||t.getExtension("EXT_color_buffer_half_float"))),i}static getDefaultFramebuffer(t){return t.luma=t.luma||{},t.luma.defaultFramebuffer=t.luma.defaultFramebuffer||new f(t,{id:"default-framebuffer",handle:null,attachments:{}}),t.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const t=(0,r.KQ)(this.gl);return t.getParameter(t.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const t=(0,r.KQ)(this.gl);return t.getParameter(t.MAX_DRAW_BUFFERS)}constructor(t,e={}){super(t,e),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(e),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize({width:t=1,height:e=1,attachments:n=null,color:r=!0,depth:i=!0,stencil:o=!1,check:s=!0,readBuffer:a,drawBuffers:l}){if((0,h.h)(t>=0&&e>=0,"Width and height need to be integers"),this.width=t,this.height=e,n)for(const r in n){const i=n[r];(Array.isArray(i)?i[0]:i).resize({width:t,height:e})}else n=this._createDefaultAttachments(r,i,o,t,e);this.update({clearAttachments:!0,attachments:n,readBuffer:a,drawBuffers:l}),n&&s&&this.checkStatus()}delete(){for(const t of this.ownResources)t.delete();return super.delete(),this}update({attachments:t={},readBuffer:e,drawBuffers:n,clearAttachments:r=!1,resizeAttachments:i=!0}){this.attach(t,{clearAttachments:r,resizeAttachments:i});const{gl:o}=this,s=o.bindFramebuffer(36160,this.handle);return e&&this._setReadBuffer(e),n&&this._setDrawBuffers(n),o.bindFramebuffer(36160,s||null),this}resize(t={}){let{width:e,height:n}=t;if(null===this.handle)return(0,h.h)(void 0===e&&void 0===n),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===e&&(e=this.gl.drawingBufferWidth),void 0===n&&(n=this.gl.drawingBufferHeight),e!==this.width&&n!==this.height&&r.cM.log(2,`Resizing framebuffer ${this.id} to ${e}x${n}`)();for(const t in this.attachments)this.attachments[t].resize({width:e,height:n});return this.width=e,this.height=n,this}attach(t,{clearAttachments:e=!1,resizeAttachments:n=!0}={}){const r={};e&&Object.keys(this.attachments).forEach((t=>{r[t]=null})),Object.assign(r,t);const i=this.gl.bindFramebuffer(36160,this.handle);for(const t in r){(0,h.h)(void 0!==t,"Misspelled framebuffer binding point?");const e=Number(t),i=r[e];let o=i;if(o)if(o instanceof s.Z)this._attachRenderbuffer({attachment:e,renderbuffer:o});else if(Array.isArray(i)){const[t,n=0,r=0]=i;o=t,this._attachTexture({attachment:e,texture:t,layer:n,level:r})}else this._attachTexture({attachment:e,texture:o,layer:0,level:0});else this._unattach(e);n&&o&&o.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,i||null),Object.assign(this.attachments,t),Object.keys(this.attachments).filter((t=>!this.attachments[t])).forEach((t=>{delete this.attachments[t]}))}checkStatus(){const{gl:t}=this,e=this.getStatus();if(36053!==e)throw new Error(function(t){return(f.STATUS||{})[t]||`Framebuffer error ${t}`}(e));return this}getStatus(){const{gl:t}=this,e=t.bindFramebuffer(36160,this.handle),n=t.checkFramebufferStatus(36160);return t.bindFramebuffer(36160,e||null),n}clear(t={}){const{color:e,depth:n,stencil:r,drawBuffers:i=[]}=t,o=this.gl.bindFramebuffer(36160,this.handle);return(e||n||r)&&(0,a.Z)(this.gl,{color:e,depth:n,stencil:r}),i.forEach(((t,e)=>{(0,a.$)(this.gl,{drawBuffer:e,value:t})})),this.gl.bindFramebuffer(36160,o||null),this}readPixels(t={}){return r.cM.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(t={}){return r.cM.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(t={}){return r.cM.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(t={}){return r.cM.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(t={}){return r.cM.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(t={}){return r.cM.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate({attachments:t=[],x:e=0,y:n=0,width:i,height:o}){const s=(0,r.KQ)(this.gl),a=s.bindFramebuffer(36008,this.handle);return 0===e&&0===n&&void 0===i&&void 0===o?s.invalidateFramebuffer(36008,t):s.invalidateFramebuffer(36008,t,e,n,i,o),s.bindFramebuffer(36008,a),this}getAttachmentParameter(t,e,n){let r=this._getAttachmentParameterFallback(e);return null===r&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,t,e),this.gl.bindFramebuffer(36160,null)),n&&r>1e3&&(r=(0,c.km)(this.gl,r)),r}getAttachmentParameters(t=36064,e,n=this.constructor.ATTACHMENT_PARAMETERS||[]){const r={};for(const i of n)r[e?(0,c.km)(this.gl,i):i]=this.getAttachmentParameter(t,i,e);return r}getParameters(t=!0){const e=Object.keys(this.attachments),n={};for(const r of e){const e=Number(r);n[t?(0,c.km)(this.gl,e):e]=this.getAttachmentParameters(e,t)}return n}show(){return"undefined"!=typeof window&&window.open((0,l.Km)(this),"luma-debug-texture"),this}log(t=0,e=""){if(t>r.cM.level||"undefined"==typeof window)return this;e=e||`Framebuffer ${this.id}`;const n=(0,l.Km)(this,{targetMaxHeight:100});return r.cM.image({logLevel:t,message:e,image:n},e)(),this}bind({target:t=36160}={}){return this.gl.bindFramebuffer(t,this.handle),this}unbind({target:t=36160}={}){return this.gl.bindFramebuffer(t,null),this}_createDefaultAttachments(t,e,n,r,i){let a=null;return t&&(a=a||{},a[36064]=new o.Z(this.gl,{id:`${this.id}-color0`,pixels:null,format:6408,type:5121,width:r,height:i,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(a[36064])),e&&n?(a=a||{},a[33306]=new s.Z(this.gl,{id:`${this.id}-depth-stencil`,format:35056,width:r,height:111}),this.ownResources.push(a[33306])):e?(a=a||{},a[36096]=new s.Z(this.gl,{id:`${this.id}-depth`,format:33189,width:r,height:i}),this.ownResources.push(a[36096])):n&&(0,h.h)(!1),a}_unattach(t){const e=this.attachments[t];e&&(e instanceof s.Z?this.gl.framebufferRenderbuffer(36160,t,36161,null):this.gl.framebufferTexture2D(36160,t,3553,null,0),delete this.attachments[t])}_attachRenderbuffer({attachment:t=36064,renderbuffer:e}){const{gl:n}=this;n.framebufferRenderbuffer(36160,t,36161,e.handle),this.attachments[t]=e}_attachTexture({attachment:t=36064,texture:e,layer:n,level:i}){const{gl:o}=this;switch(o.bindTexture(e.target,e.handle),e.target){case 35866:case 32879:(0,r.KQ)(o).framebufferTextureLayer(36160,t,e.target,i,n);break;case 34067:const s=function(t){return t<34069?t+34069:t}(n);o.framebufferTexture2D(36160,t,s,e.handle,i);break;case 3553:o.framebufferTexture2D(36160,t,3553,e.handle,i);break;default:(0,h.h)(!1,"Illegal texture type")}o.bindTexture(e.target,null),this.attachments[t]=e}_setReadBuffer(t){const e=(0,r.vd)(this.gl);e?e.readBuffer(t):(0,h.h)(36064===t||1029===t,p),this.readBuffer=t}_setDrawBuffers(t){const{gl:e}=this,n=(0,r.KQ)(e);if(n)n.drawBuffers(t);else{const n=e.getExtension("WEBGL_draw_buffers");n?n.drawBuffersWEBGL(t):(0,h.h)(1===t.length&&(36064===t[0]||1029===t[0]),p)}this.drawBuffers=t}_getAttachmentParameterFallback(t){const e=(0,u.N$)(this.gl);switch(t){case 36052:return e.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return e.WEBGL2?null:8;case 33297:return e.WEBGL2?null:5125;case 33296:return e.WEBGL2||e.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(t){return this.gl.bindFramebuffer(36160,t)}}f.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303]},7944:(t,e,n)=>{"use strict";n.d(e,{Z:()=>z});var r=n(7577),i=n(5008),o=n(3849),s=n(9450),a=n(9830),l=n(2525);const u={5126:w.bind(null,"uniform1fv",g,1,E),35664:w.bind(null,"uniform2fv",g,2,E),35665:w.bind(null,"uniform3fv",g,3,E),35666:w.bind(null,"uniform4fv",g,4,E),5124:w.bind(null,"uniform1iv",m,1,E),35667:w.bind(null,"uniform2iv",m,2,E),35668:w.bind(null,"uniform3iv",m,3,E),35669:w.bind(null,"uniform4iv",m,4,E),35670:w.bind(null,"uniform1iv",m,1,E),35671:w.bind(null,"uniform2iv",m,2,E),35672:w.bind(null,"uniform3iv",m,3,E),35673:w.bind(null,"uniform4iv",m,4,E),35674:w.bind(null,"uniformMatrix2fv",g,4,S),35675:w.bind(null,"uniformMatrix3fv",g,9,S),35676:w.bind(null,"uniformMatrix4fv",g,16,S),35678:x,35680:x,5125:w.bind(null,"uniform1uiv",A,1,E),36294:w.bind(null,"uniform2uiv",A,2,E),36295:w.bind(null,"uniform3uiv",A,3,E),36296:w.bind(null,"uniform4uiv",A,4,E),35685:w.bind(null,"uniformMatrix2x3fv",g,6,S),35686:w.bind(null,"uniformMatrix2x4fv",g,8,S),35687:w.bind(null,"uniformMatrix3x2fv",g,6,S),35688:w.bind(null,"uniformMatrix3x4fv",g,12,S),35689:w.bind(null,"uniformMatrix4x2fv",g,8,S),35690:w.bind(null,"uniformMatrix4x3fv",g,12,S),35678:x,35680:x,35679:x,35682:x,36289:x,36292:x,36293:x,36298:x,36299:x,36300:x,36303:x,36306:x,36307:x,36308:x,36311:x},c={},h={},p={},f=[0];function d(t,e,n,r){1===e&&"boolean"==typeof t&&(t=t?1:0),Number.isFinite(t)&&(f[0]=t,t=f);const i=t.length;if(i%e&&s.cM.warn(`Uniform size should be multiples of ${e}`,t)(),t instanceof n)return t;let o=r[i];o||(o=new n(i),r[i]=o);for(let e=0;e<i;e++)o[e]=t[e];return o}function g(t,e){return d(t,e,Float32Array,c)}function m(t,e){return d(t,e,Int32Array,h)}function A(t,e){return d(t,e,Uint32Array,p)}function y(t,e,n){const r=u[n.type];if(!r)throw new Error(`Unknown GLSL uniform type ${n.type}`);return r().bind(null,t,e)}function _(t){if("]"!==t[t.length-1])return{name:t,length:1,isArray:!1};const e=t.match(/([^[]*)(\[[0-9]+\])?/);if(!e||e.length<2)throw new Error(`Failed to parse GLSL uniform name ${t}`);return{name:e[1],length:e[2]||1,isArray:Boolean(e[2])}}function v(t){return Array.isArray(t)||ArrayBuffer.isView(t)?function(t){if(0===t.length)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}(t):!!isFinite(t)||!0===t||!1===t||t instanceof i.Z||t instanceof a.Z||t instanceof o.Z&&Boolean(t.texture)}function b(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let t=0,e=n.length;t<e;++t)r[t]=n[t]}else t[e]=n.slice();else t[e]=n}function x(){let t=null;return(e,n,r)=>{const i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function w(t,e,n,r){let i=null,o=null;return(s,a,u)=>{const c=e(u,n),h=c.length;let p=!1;if(null===i)i=new Float32Array(h),o=h,p=!0;else{(0,l.h)(o===h,"Uniform length cannot change.");for(let t=0;t<h;++t)if(c[t]!==i[t]){p=!0;break}}return p&&(r(s,t,a,c),i.set(c)),p}}function E(t,e,n,r){t[e](n,r)}function S(t,e,n,r){t[e](n,!1,r)}function T(t,e="unnamed"){const n=t.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return n?n[1]:e}function P(t,e){let n="";for(let r=0;r<e.length;r++){const i=e[r];if((t[r+3]||t[r+2]||t[r+1])&&(n+=`${i}\n`,t[r+1])){const e=t[r+1],i=e.split(":",3),o=i[0],s=parseInt(i[1],10)||0;n+=M(`^^^ ${o}: ${e.substring(i.join(":").length+1).trim()}\n\n`,s)}}return n}function M(t,e){let n="";for(let t=0;t<e;++t)n+=" ";return`${n}${t}`}var C=n(4538);class I extends r.Z{static getTypeName(t){switch(t){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return(0,l.h)(!1),"unknown"}}constructor(t,e){(0,s.JD)(t),(0,l.h)("string"==typeof e.source,"Shader: GLSL source code must be a JavaScript string"),super(t,{id:T(e.source,null)||e.id||(0,C.hQ)(`unnamed ${I.getTypeName(e.shaderType)}`)}),this.shaderType=e.shaderType,this.source=e.source,this.initialize(e)}initialize({source:t}){const e=T(t,null);e&&(this.id=(0,C.hQ)(e)),this._compile(t)}getParameter(t){return this.gl.getShaderParameter(this.handle,t)}toString(){return`${I.getTypeName(this.shaderType)}:${this.id}`}getName(){return T(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const t=this.gl.getExtension("WEBGL_debug_shaders");return t?t.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(t=this.source){if(t.startsWith("#version ")||(t=`#version 100\n${t}`),this.source=t,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const t=this.gl.getShaderInfoLog(this.handle),{shaderName:e,errors:n,warnings:r}=function(t,e,n,r){const i=t.split(/\r?\n/),o={},s={},a=r||T(e)||"(unnamed)",l=`${function(t){switch(t){case 35632:return"fragment";case 35633:return"vertex";default:return"unknown type"}}(n)} shader ${a}`;for(let e=0;e<i.length;e++){const n=i[e];if(n.length<=1)continue;const r=n.split(":"),a=r[0],u=parseInt(r[2],10);if(isNaN(u))throw new Error(`GLSL compilation error in ${l}: ${t}`);"WARNING"!==a?o[u]=n:s[u]=n}const u=function(t,e=1,n=": "){const r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map(((t,r)=>{const o=String(r+e),s=o.length;return M(o,i-s)+n+t}))}(e);return{shaderName:l,errors:P(o,u),warnings:P(s,u)}}(t,this.source,this.shaderType,this.id);throw s.cM.error(`GLSL compilation errors in ${e}\n${n}`)(),s.cM.warn(`GLSL compilation warnings in ${e}\n${r}`)(),new Error(`GLSL compilation errors in ${e}`)}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class O extends I{constructor(t,e){"string"==typeof e&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class R extends I{constructor(t,e){"string"==typeof e&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}var L=n(4072),k=n(8522);class D{constructor(t){this.id=t.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(t),this._readVaryingsFromProgram(t)}getAttributeInfo(t){const e=Number(t);return Number.isFinite(e)?this.attributeInfosByLocation[e]:this.attributeInfosByName[t]||null}getAttributeLocation(t){const e=this.getAttributeInfo(t);return e?e.location:-1}getAttributeAccessor(t){const e=this.getAttributeInfo(t);return e?e.accessor:null}getVaryingInfo(t){const e=Number(t);return Number.isFinite(e)?this.varyingInfos[e]:this.varyingInfosByName[t]||null}getVaryingIndex(t){const e=this.getVaryingInfo();return e?e.location:-1}getVaryingAccessor(t){const e=this.getVaryingInfo();return e?e.accessor:null}_readAttributesFromProgram(t){const{gl:e}=t,n=e.getProgramParameter(t.handle,35721);for(let r=0;r<n;r++){const{name:n,type:i,size:o}=e.getActiveAttrib(t.handle,r),s=e.getAttribLocation(t.handle,n);s>=0&&this._addAttribute(s,n,i,o)}this.attributeInfos.sort(((t,e)=>t.location-e.location))}_readVaryingsFromProgram(t){const{gl:e}=t;if(!(0,s.D0)(e))return;const n=e.getProgramParameter(t.handle,35971);for(let r=0;r<n;r++){const{name:n,type:i,size:o}=e.getTransformFeedbackVarying(t.handle,r);this._addVarying(r,n,i,o)}this.varyingInfos.sort(((t,e)=>t.location-e.location))}_addAttribute(t,e,n,r){const{type:i,components:o}=(0,k.hJ)(n),s={type:i,size:r*o};this._inferProperties(t,e,s);const a={location:t,name:e,accessor:new L.Z(s)};this.attributeInfos.push(a),this.attributeInfosByLocation[t]=a,this.attributeInfosByName[a.name]=a}_inferProperties(t,e,n){/instance/i.test(e)&&(n.divisor=1)}_addVarying(t,e,n,r){const{type:i,components:o}=(0,k.hJ)(n),s={location:t,name:e,accessor:new L.Z({type:i,size:r*o})};this.varyingInfos.push(s),this.varyingInfosByName[s.name]=s}}var N=n(9579);const F=35981,B=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class z extends r.Z{constructor(t,e={}){super(t,e),this.stubRemovedMethods("Program","v6.0",B),this._isCached=!1,this.initialize(e),Object.seal(this),this._setId(e.id)}initialize(t={}){const{hash:e,vs:n,fs:r,varyings:i,bufferMode:o=F}=t;return this.hash=e||"",this.vs="string"==typeof n?new O(this.gl,{id:`${t.id}-vs`,source:n}):n,this.fs="string"==typeof r?new R(this.gl,{id:`${t.id}-fs`,source:r}):r,(0,l.h)(this.vs instanceof O),(0,l.h)(this.fs instanceof R),this.uniforms={},this._textureUniforms={},i&&i.length>0&&((0,s.KQ)(this.gl),this.varyings=i,this.gl2.transformFeedbackVaryings(this.handle,i,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new D(this),this.setProps(t)}delete(t={}){return this._isCached?this:super.delete(t)}setProps(t){return"uniforms"in t&&this.setUniforms(t.uniforms),this}draw({logPriority:t,drawMode:e=4,vertexCount:n,offset:r=0,start:i,end:o,isIndexed:a=!1,indexType:u=5123,instanceCount:c=0,isInstanced:h=c>0,vertexArray:p=null,transformFeedback:f,framebuffer:d,parameters:g={},uniforms:m,samplers:A}){if((m||A)&&(s.cM.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(m||{})),s.cM.priority>=t){const r=d?d.id:"default",i=`mode=${(0,N.km)(this.gl,e)} verts=${n} instances=${c} indexType=${(0,N.km)(this.gl,u)} isInstanced=${h} isIndexed=${a} Framebuffer=${r}`;s.cM.log(t,i)()}return(0,l.h)(p),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===n||h&&0===c||(p.bindForDraw(n,c,(()=>{if(void 0!==d&&(g=Object.assign({},g,{framebuffer:d})),f){const t=(0,k.$Z)(e);f.begin(t)}this._bindTextures(),(0,s.s8)(this.gl,g,(()=>{a&&h?this.gl2.drawElementsInstanced(e,n,u,r,c):a&&(0,s.D0)(this.gl)&&!isNaN(i)&&!isNaN(o)?this.gl2.drawRangeElements(e,i,o,n,u,r):a?this.gl.drawElements(e,n,u,r):h?this.gl2.drawArraysInstanced(e,r,n,c):this.gl.drawArrays(e,r,n)})),f&&f.end()})),0))}setUniforms(t={}){s.cM.priority>=2&&function(t,e,n){for(const r in t){const i=t[r];if((!n||Boolean(n[r]))&&!v(i))throw e=e?`${e} `:"",console.error(`${e} Bad uniform ${r}`,i),new Error(`${e} Bad uniform ${r}`)}}(t,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const e in t){const n=t[e],r=this._uniformSetters[e];if(r){let t=n,s=!1;if(t instanceof o.Z&&(t=t.texture),t instanceof i.Z)if(s=this.uniforms[e]!==n,s){void 0===r.textureIndex&&(r.textureIndex=this._textureIndexCounter++);const n=t,{textureIndex:i}=r;n.bind(i),t=i,this._textureUniforms[e]=n}else t=r.textureIndex;else this._textureUniforms[e]&&delete this._textureUniforms[e];(r(t)||s)&&b(this.uniforms,e,n)}}return this}_areTexturesRenderable(){let t=!0;for(const e in this._textureUniforms){const n=this._textureUniforms[e];n.update(),t=t&&n.loaded}return t}_bindTextures(){for(const t in this._textureUniforms){const e=this._uniformSetters[t].textureIndex;this._textureUniforms[t].bind(e)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(t){const e=this.gl.getAttachedShaders(t),n={};for(const t of e)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:n.vs=new O({handle:t});break;case 35632:n.fs=new R({handle:t})}return n}_getParameter(t){return this.gl.getProgramParameter(this.handle,t)}_setId(t){if(!t){const t=this._getName();this.id=(0,C.hQ)(t)}}_getName(){let t=this.vs.getName()||this.fs.getName();return t=t.replace(/shader/i,""),t=t?`${t}-program`:"program",t}_compileAndLink(){const{gl:t}=this;if(t.attachShader(this.handle,this.vs.handle),t.attachShader(this.handle,this.fs.handle),s.cM.time(4,`linkProgram for ${this._getName()}`)(),t.linkProgram(this.handle),s.cM.timeEnd(4,`linkProgram for ${this._getName()}`)(),t.debug||s.cM.level>0){if(!t.getProgramParameter(this.handle,35714))throw new Error(`Error linking: ${t.getProgramInfoLog(this.handle)}`);if(t.validateProgram(this.handle),!t.getProgramParameter(this.handle,35715))throw new Error(`Error validating: ${t.getProgramInfoLog(this.handle)}`)}}_readUniformLocationsFromLinkedProgram(){const{gl:t}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let e=0;e<this._uniformCount;e++){const n=this.gl.getActiveUniform(this.handle,e),{name:r}=_(n.name);let i=t.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=y(t,i,n),n.size>1)for(let e=0;e<n.size;e++)i=t.getUniformLocation(this.handle,`${r}[${e}]`),this._uniformSetters[`${r}[${e}]`]=y(t,i,n)}this._textureIndexCounter=0}getActiveUniforms(t,e){return this.gl2.getActiveUniforms(this.handle,t,e)}getUniformBlockIndex(t){return this.gl2.getUniformBlockIndex(this.handle,t)}getActiveUniformBlockParameter(t,e){return this.gl2.getActiveUniformBlockParameter(this.handle,t,e)}uniformBlockBinding(t,e){this.gl2.uniformBlockBinding(this.handle,t,e)}}},9830:(t,e,n)=>{"use strict";n.d(e,{Z:()=>l});var r=n(7577);const i="EXT_color_buffer_float",o={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:i,bpp:2},33327:{gl2:i,bpp:4},34842:{gl2:i,bpp:8},33326:{gl2:i,bpp:4},33328:{gl2:i,bpp:8},34836:{gl2:i,bpp:16},35898:{gl2:i,bpp:4}};var s=n(9450),a=n(2525);class l extends r.Z{static isSupported(t,{format:e}={format:null}){return!e||function(t,e,n){const r=n[e];if(!r)return!1;const i=(0,s.D0)(t)&&r.gl2||r.gl1;return"string"==typeof i?t.getExtension(i):i}(t,e,o)}static getSamplesForFormat(t,{format:e}){return t.getInternalformatParameter(36161,e,32937)}constructor(t,e={}){super(t,e),this.initialize(e),Object.seal(this)}initialize({format:t,width:e=1,height:n=1,samples:r=0}){return(0,a.h)(t,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==r&&(0,s.D0)(this.gl)?this.gl.renderbufferStorageMultisample(36161,r,t,e,n):this.gl.renderbufferStorage(36161,t,e,n),this.format=t,this.width=e,this.height=n,this.samples=r,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*o[this.format].bpp),this}resize({width:t,height:e}){return t!==this.width||e!==this.height?this.initialize({width:t,height:e,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(t){this.gl.bindRenderbuffer(36161,t)}_syncHandle(t){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(t){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,t)}}},7577:(t,e,n)=>{"use strict";n.d(e,{Z:()=>c});var r=n(9450),i=n(9835),o=n(9579),s=n(2525),a=n(4538),l=n(7469);const u="Resource subclass must define virtual methods";class c{constructor(t,e={}){(0,r.JD)(t);const{id:n,userData:i={}}=e;this.gl=t,this.gl2=t,this.id=n||(0,a.hQ)(this.constructor.name),this.userData=i,this._bound=!1,this._handle=e.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return`${this.constructor.name}(${this.id})`}get handle(){return this._handle}delete({deleteChildren:t=!1}={}){const e=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,e&&t&&e.filter(Boolean).forEach((t=>t.delete())),this}bind(t=this.handle){if("function"!=typeof t)return this._bindHandle(t),this;let e;return this._bound?e=t():(this._bindHandle(this.handle),this._bound=!0,e=t(),this._bound=!1,this._bindHandle(null)),e}unbind(){this.bind(null)}getParameter(t,e={}){t=(0,o.sF)(this.gl,t),(0,s.h)(t);const n=(this.constructor.PARAMETERS||{})[t];if(n){const t=(0,r.D0)(this.gl);if("webgl2"in n&&!t||"extension"in n&&!this.gl.getExtension(n.extension)){const e=n.webgl1,r="webgl2"in n?n.webgl2:n.webgl1;return t?r:e}}return this._getParameter(t,e)}getParameters(t={}){const{parameters:e,keys:n}=t,i=this.constructor.PARAMETERS||{},s=(0,r.D0)(this.gl),a={},l=e||Object.keys(i);for(const e of l){const r=i[e];if(r&&(!("webgl2"in r)||s)&&(!("extension"in r)||this.gl.getExtension(r.extension))){const i=n?(0,o.km)(this.gl,e):e;a[i]=this.getParameter(e,t),n&&"GLenum"===r.type&&(a[i]=(0,o.km)(this.gl,a[i]))}}return a}setParameter(t,e){t=(0,o.sF)(this.gl,t),(0,s.h)(t);const n=(this.constructor.PARAMETERS||{})[t];if(n){const t=(0,r.D0)(this.gl);if("webgl2"in n&&!t||"extension"in n&&!this.gl.getExtension(n.extension))throw new Error("Parameter not available on this platform");"GLenum"===n.type&&(e=(0,o.sF)(e))}return this._setParameter(t,e),this}setParameters(t){for(const e in t)this.setParameter(e,t[e]);return this}stubRemovedMethods(t,e,n){return(0,l.F)(this,t,e,n)}initialize(t){}_createHandle(){throw new Error(u)}_deleteHandle(){throw new Error(u)}_bindHandle(t){throw new Error(u)}_getOptsFromHandle(){throw new Error(u)}_getParameter(t,e){throw new Error(u)}_setParameter(t,e){throw new Error(u)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const t=this.constructor.name,e=i.l.get("Resource Counts");e.get("Resources Created").incrementCount(),e.get(`${t}s Created`).incrementCount(),e.get(`${t}s Active`).incrementCount()}_removeStats(){const t=this.constructor.name;i.l.get("Resource Counts").get(`${t}s Active`).decrementCount()}_trackAllocatedMemory(t,e=this.constructor.name){const n=i.l.get("Memory Usage");n.get("GPU Memory").addCount(t),n.get(`${e} Memory`).addCount(t),this.byteLength=t}_trackDeallocatedMemory(t=this.constructor.name){const e=i.l.get("Memory Usage");e.get("GPU Memory").subtractCount(this.byteLength),e.get(`${t} Memory`).subtractCount(this.byteLength),this.byteLength=0}}},4912:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(9450),i=n(5008),o=n(2525);class s extends i.Z{static isSupported(t,e){return i.Z.isSupported(t,e)}constructor(t,e={}){var n;(0,r.JD)(t),(e instanceof Promise||"string"==typeof e)&&(e={data:e}),"string"==typeof e.data&&(e=Object.assign({},e,{data:(n=e.data,(0,o.h)("string"==typeof n),n=""+n,new Promise(((t,e)=>{try{const r=new Image;r.onload=()=>t(r),r.onerror=()=>e(new Error(`Could not load image ${n}.`)),r.crossOrigin="anonymous",r.src=n}catch(t){e(t)}})))})),super(t,Object.assign({},e,{target:3553})),this.initialize(e),Object.seal(this)}}},1319:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(9450),i=n(5008),o=n(3889),s=n(3478);class a extends i.Z{static isSupported(t){return(0,r.D0)(t)}constructor(t,e={}){(0,r.KQ)(t),super(t,e=Object.assign({depth:1},e,{target:32879,unpackFlipY:!1})),this.initialize(e),Object.seal(this)}setImageData({level:t=0,dataFormat:e=6408,width:n,height:i,depth:a=1,border:l=0,format:u,type:c=5121,offset:h=0,data:p,parameters:f={}}){if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),(0,r.s8)(this.gl,f,(()=>{ArrayBuffer.isView(p)&&this.gl.texImage3D(this.target,t,e,n,i,a,l,u,c,p),p instanceof s.Z&&(this.gl.bindBuffer(35052,p.handle),this.gl.texImage3D(this.target,t,e,n,i,a,l,u,c,h))})),p&&p.byteLength)this._trackAllocatedMemory(p.byteLength,"Texture");else{const t=o.C[this.dataFormat]||4,e=o.pH[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*t*e,"Texture")}return this.loaded=!0,this}}},7952:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(9450),i=n(5008);const o=[34069,34070,34071,34072,34073,34074];class s extends i.Z{constructor(t,e={}){(0,r.JD)(t),super(t,Object.assign({},e,{target:34067})),this.initialize(e),Object.seal(this)}initialize(t={}){const{mipmaps:e=!0,parameters:n={}}=t;return this.opts=t,this.setCubeMapImageData(t).then((()=>{this.loaded=!0,e&&this.generateMipmap(t),this.setParameters(n)})),this}subImage({face:t,data:e,x:n=0,y:r=0,mipmapLevel:i=0}){return this._subImage({target:t,data:e,x:n,y:r,mipmapLevel:i})}async setCubeMapImageData({width:t,height:e,pixels:n,data:i,border:s=0,format:a=6408,type:l=5121}){const{gl:u}=this,c=n||i,h=await Promise.all(o.map((t=>{const e=c[t];return Promise.all(Array.isArray(e)?e:[e])})));this.bind(),o.forEach(((n,i)=>{h[i].length>1&&!1!==this.opts.mipmaps&&r.cM.warn(`${this.id} has mipmap and multiple LODs.`)(),h[i].forEach(((r,i)=>{t&&e?u.texImage2D(n,i,a,t,e,s,a,l,r):u.texImage2D(n,i,a,a,l,r)}))})),this.unbind()}setImageDataForFace(t){const{face:e,width:n,height:r,pixels:i,data:o,border:s=0,format:a=6408,type:l=5121}=t,{gl:u}=this,c=i||o;return this.bind(),c instanceof Promise?c.then((n=>this.setImageDataForFace(Object.assign({},t,{face:e,data:n,pixels:n})))):this.width||this.height?u.texImage2D(e,0,a,n,r,s,a,l,c):u.texImage2D(e,0,a,a,l,c),this}}s.FACES=o},3889:(t,e,n)=>{"use strict";n.d(e,{ae:()=>i,C:()=>o,pH:()=>s,br:()=>a,KR:()=>l});var r=n(9450);const i={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},o={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},s={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function a(t,e){const n=i[e];if(!n)return!1;if(void 0===n.gl1&&void 0===n.gl2)return!0;const o=(0,r.D0)(t)&&n.gl2||n.gl1;return"string"==typeof o?t.getExtension(o):o}function l(t,e){const n=i[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}},5008:(t,e,n)=>{"use strict";n.d(e,{Z:()=>p});var r=n(9450),i=n(9718),o=n(7577),s=n(3478),a=n(3889),l=n(2525),u=n(4538);const c=[9729,9728],h=i.CO.WebGLBuffer||function(){};class p extends o.Z{static isSupported(t,e={}){const{format:n,linearFiltering:r}=e;let i=!0;return n&&(i=i&&(0,a.br)(t,n),i=i&&(!r||(0,a.KR)(t,n))),i}constructor(t,e){const{id:n=(0,u.hQ)("texture"),handle:r,target:i}=e;super(t,{id:n,handle:r}),this.target=i,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return`Texture(${this.id},${this.width}x${this.height})`}initialize(t={}){let e=t.data;if(e instanceof Promise)return e.then((e=>this.initialize(Object.assign({},t,{pixels:e,data:e})))),this;const n="undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement;if(n&&e.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,e.addEventListener("loadeddata",(()=>this.initialize(t))),this;const{pixels:i=null,format:o=6408,border:s=0,recreate:a=!1,parameters:l={},pixelStore:u={},textureUnit:c}=t;e||(e=i);let{width:h,height:p,dataFormat:f,type:d,compressed:g=!1,mipmaps:m=!0}=t;const{depth:A=0}=t;return({width:h,height:p,compressed:g,dataFormat:f,type:d}=this._deduceParameters({format:o,type:d,dataFormat:f,compressed:g,data:e,width:h,height:p})),this.width=h,this.height=p,this.depth=A,this.format=o,this.type=d,this.dataFormat=f,this.border=s,this.textureUnit=c,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),m&&this._isNPOT()&&(r.cM.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),m=!1,this._updateForNPOT(l)),this.mipmaps=m,this.setImageData({data:e,width:h,height:p,depth:A,format:o,type:d,dataFormat:f,border:s,mipmaps:m,parameters:u,compressed:g}),m&&this.generateMipmap(),this.setParameters(l),a&&(this.data=e),n&&(this._video={video:e,parameters:l,lastTime:e.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?e.currentTime:-1}),this}update(){if(this._video){const{video:t,parameters:e,lastTime:n}=this._video;if(n===t.currentTime||t.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:t,parameters:e}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=t.currentTime}}resize({height:t,width:e,mipmaps:n=!1}){return e!==this.width||t!==this.height?this.initialize({width:e,height:t,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:n}):this}generateMipmap(t={}){return this._isNPOT()?(r.cM.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),(0,r.s8)(this.gl,t,(()=>{this.gl.generateMipmap(this.target)})),this.gl.bindTexture(this.target,null),this)}setImageData(t){this._trackDeallocatedMemory("Texture");const{target:e=this.target,pixels:n=null,level:i=0,format:o=this.format,border:s=this.border,offset:u=0,parameters:c={}}=t;let{data:h=null,type:p=this.type,width:f=this.width,height:d=this.height,dataFormat:g=this.dataFormat,compressed:m=!1}=t;h||(h=n),({type:p,dataFormat:g,compressed:m,width:f,height:d}=this._deduceParameters({format:o,type:p,dataFormat:g,compressed:m,data:h,width:f,height:d}));const{gl:A}=this;A.bindTexture(this.target,this.handle);let y,_=null;if(({data:h,dataType:_}=this._getDataType({data:h,compressed:m})),(0,r.s8)(this.gl,c,(()=>{switch(_){case"null":A.texImage2D(e,i,o,f,d,s,g,p,h);break;case"typed-array":A.texImage2D(e,i,o,f,d,s,g,p,h,u);break;case"buffer":y=(0,r.KQ)(A),y.bindBuffer(35052,h.handle||h),y.texImage2D(e,i,o,f,d,s,g,p,u),y.bindBuffer(35052,null);break;case"browser-object":(0,r.D0)(A)?A.texImage2D(e,i,o,f,d,s,g,p,h):A.texImage2D(e,i,o,g,p,h);break;case"compressed":for(const[t,n]of h.entries())A.compressedTexImage2D(e,t,n.format,n.width,n.height,s,n.data);break;default:(0,l.h)(!1,"Unknown image data type")}})),h&&h.byteLength)this._trackAllocatedMemory(h.byteLength,"Texture");else{const t=a.C[this.dataFormat]||4,e=a.pH[this.type]||1;this._trackAllocatedMemory(this.width*this.height*t*e,"Texture")}return this.loaded=!0,this}setSubImageData({target:t=this.target,pixels:e=null,data:n=null,x:i=0,y:o=0,width:a=this.width,height:u=this.height,level:c=0,format:p=this.format,type:f=this.type,dataFormat:d=this.dataFormat,compressed:g=!1,offset:m=0,border:A=this.border,parameters:y={}}){if(({type:f,dataFormat:d,compressed:g,width:a,height:u}=this._deduceParameters({format:p,type:f,dataFormat:d,compressed:g,data:n,width:a,height:u})),(0,l.h)(0===this.depth,"texSubImage not supported for 3D textures"),n||(n=e),n&&n.data){const t=n;n=t.data,a=t.shape[0],u=t.shape[1]}n instanceof s.Z&&(n=n.handle),this.gl.bindTexture(this.target,this.handle),(0,r.s8)(this.gl,y,(()=>{if(g)this.gl.compressedTexSubImage2D(t,c,i,o,a,u,p,n);else if(null===n)this.gl.texSubImage2D(t,c,i,o,a,u,d,f,null);else if(ArrayBuffer.isView(n))this.gl.texSubImage2D(t,c,i,o,a,u,d,f,n,m);else if(n instanceof h){const e=(0,r.KQ)(this.gl);e.bindBuffer(35052,n),e.texSubImage2D(t,c,i,o,a,u,d,f,m),e.bindBuffer(35052,null)}else(0,r.D0)(this.gl)?(0,r.KQ)(this.gl).texSubImage2D(t,c,i,o,a,u,d,f,n):this.gl.texSubImage2D(t,c,i,o,d,f,n)})),this.gl.bindTexture(this.target,null)}copyFramebuffer(t={}){return r.cM.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(t=this.textureUnit){const{gl:e}=this;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,this.handle),t}unbind(t=this.textureUnit){const{gl:e}=this;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,null),t}_getDataType({data:t,compressed:e=!1}){return e?{data:t,dataType:"compressed"}:null===t?{data:t,dataType:"null"}:ArrayBuffer.isView(t)?{data:t,dataType:"typed-array"}:t instanceof s.Z?{data:t.handle,dataType:"buffer"}:t instanceof h?{data:t,dataType:"buffer"}:{data:t,dataType:"browser-object"}}_deduceParameters(t){const{format:e,data:n}=t;let{width:r,height:i,dataFormat:o,type:s,compressed:l}=t;const u=a.ae[e];return o=o||u&&u.dataFormat,s=s||u&&u.types[0],l=l||u&&u.compressed,({width:r,height:i}=this._deduceImageSize(n,r,i)),{dataFormat:o,type:s,compressed:l,width:r,height:i,format:e,data:n}}_deduceImageSize(t,e,n){let r;return r="undefined"!=typeof ImageData&&t instanceof ImageData?{width:t.width,height:t.height}:"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement?{width:t.naturalWidth,height:t.naturalHeight}:"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?{width:t.width,height:t.height}:"undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement?{width:t.videoWidth,height:t.videoHeight}:t?{width:e,height:n}:{width:e>=0?e:1,height:n>=0?n:1},(0,l.h)(r,"Could not deduced texture size"),(0,l.h)(void 0===e||r.width===e,"Deduced texture width does not match supplied width"),(0,l.h)(void 0===n||r.height===n,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(t){switch(t){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const e=this.gl.getTexParameter(this.target,t);return this.gl.bindTexture(this.target,null),e}}_setParameter(t,e){switch(this.gl.bindTexture(this.target,this.handle),e=this._getNPOTParam(t,e),t){case 33082:case 33083:this.gl.texParameterf(this.handle,t,e);break;case 4096:case 4097:(0,l.h)(!1);break;default:this.gl.texParameteri(this.target,t,e)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!((0,r.D0)(this.gl)||!this.width||!this.height||(0,u.wt)(this.width)&&(0,u.wt)(this.height))}_updateForNPOT(t){void 0===t[this.gl.TEXTURE_MIN_FILTER]&&(t[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===t[this.gl.TEXTURE_WRAP_S]&&(t[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===t[this.gl.TEXTURE_WRAP_T]&&(t[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(t,e){if(this._isNPOT())switch(t){case 10241:-1===c.indexOf(e)&&(e=9729);break;case 10242:case 10243:33071!==e&&(e=33071)}return e}}},1053:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(9450),i=n(7577),o=n(3478),s=n(4538);class a extends i.Z{static isSupported(t){return(0,r.D0)(t)}constructor(t,e={}){(0,r.KQ)(t),super(t,e),this.initialize(e),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(t={}){return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,(0,s.nK)(this.buffers)||this.bind((()=>this._unbindBuffers())),this.setProps(t),this}setProps(t){"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"bindOnUse"in t&&(t=t.bindOnUse),"buffers"in t&&this.setBuffers(t.buffers)}setBuffers(t={}){return this.bind((()=>{for(const e in t)this.setBuffer(e,t[e])})),this}setBuffer(t,e){const n=this._getVaryingIndex(t),{buffer:i,byteSize:o,byteOffset:s}=this._getBufferParams(e);return n<0?(this.unused[t]=i,r.cM.warn((()=>`${this.id} unused varying buffer ${t}`))(),this):(this.buffers[n]=e,this.bindOnUse||this._bindBuffer(n,i,s,o),this)}begin(t=0){return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(t),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(t){let e,n,r;return t instanceof o.Z==0?(r=t.buffer,n=t.byteSize,e=t.byteOffset):r=t,void 0===e&&void 0===n||(e=e||0,n=n||r.byteLength-e),{buffer:r,byteOffset:e,byteSize:n}}_getVaryingInfo(t){return this.configuration&&this.configuration.getVaryingInfo(t)}_getVaryingIndex(t){if(this.configuration)return this.configuration.getVaryingInfo(t).location;const e=Number(t);return Number.isFinite(e)?e:-1}_bindBuffers(){if(this.bindOnUse)for(const t in this.buffers){const{buffer:e,byteSize:n,byteOffset:r}=this._getBufferParams(this.buffers[t]);this._bindBuffer(t,e,r,n)}}_unbindBuffers(){if(this.bindOnUse)for(const t in this.buffers)this._bindBuffer(t,null)}_bindBuffer(t,e,n=0,r){const i=e&&e.handle;return i&&void 0!==r?this.gl.bindBufferRange(35982,t,i,n,r):this.gl.bindBufferBase(35982,t,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(t){this.gl.bindTransformFeedback(36386,this.handle)}}},4211:(t,e,n)=>{"use strict";n.d(e,{U6:()=>s,ag:()=>a,N$:()=>l});var r=n(6948),i=n(9450),o=n(2525);function s(t,e){return a(t,e)}function a(t,e){return(e=Array.isArray(e)?e:[e]).every((e=>u(t,e)))}function l(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in r.Z)void 0===t.luma.caps[e]&&(t.luma.caps[e]=u(t,e));return t.luma.caps}function u(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},void 0===t.luma.caps[e]&&(t.luma.caps[e]=function(t,e){const n=r.Z[e];let s;(0,o.h)(n,e);const a=(0,i.D0)(t)&&n[1]||n[0];if("function"==typeof a)s=a(t);else if(Array.isArray(a)){s=!0;for(const e of a)s=s&&Boolean(t.getExtension(e))}else"string"==typeof a?s=Boolean(t.getExtension(a)):"boolean"==typeof a?s=a:(0,o.h)(!1);return s}(t,e)),t.luma.caps[e]||i.cM.log(2,`Feature: ${e} not supported`)(),t.luma.caps[e]}},6948:(t,e,n)=>{"use strict";n.d(e,{h:()=>o,Z:()=>s});var r=n(3849),i=n(4912);const o={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"},s={[o.WEBGL2]:[!1,!0],[o.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[o.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[o.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[o.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[o.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[o.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[o.FLOAT_BLEND]:["EXT_float_blend"],[o.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[o.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[o.TEXTURE_FLOAT]:["OES_texture_float",!0],[o.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[o.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[o.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[o.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[o.COLOR_ATTACHMENT_RGBA32F]:[function(t){const e=new i.Z(t,{format:6408,type:5126,dataFormat:6408}),n=new r.Z(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),o=n.getStatus();return e.delete(),n.delete(),36053===o},"EXT_color_buffer_float"],[o.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[o.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[o.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[o.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[o.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[o.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]}},9835:(t,e,n)=>{"use strict";n.d(e,{l:()=>a});var r=n(9450),i=n(8295),o=n(9718);const s="8.5.10",a=new class{constructor(){this.stats=new Map}get(t){return this.stats.has(t)||this.stats.set(t,new i.Z({id:t})),this.stats.get(t)}};if(o.CO.luma&&o.CO.luma.VERSION!==s)throw new Error(`luma.gl - multiple VERSIONs detected: ${o.CO.luma.VERSION} vs 8.5.10`);o.CO.luma||((0,o.jU)()&&r.cM.log(1,"luma.gl 8.5.10 - set luma.log.level=1 (or higher) to trace rendering")(),o.CO.luma=o.CO.luma||{VERSION:s,version:s,log:r.cM,stats:a,globals:{modules:{},nodeIO:{}}}),o.CO.luma},2525:(t,e,n)=>{"use strict";function r(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}n.d(e,{h:()=>r})},2610:(t,e,n)=>{"use strict";n.d(e,{k:()=>i});var r=n(9450);function i(t,e,n){const{removedProps:i={},deprecatedProps:o={},replacedProps:s={}}=n;for(const n in i)if(n in e){const e=i[n]?`${t}.${i[n]}`:"N/A";r.cM.removed(`${t}.${n}`,e)()}for(const n in o)if(n in e){const e=o[n];r.cM.deprecated(`${t}.${n}`,`${t}.${e}`)()}let a=null;for(const n in s)if(n in e){const i=s[n];r.cM.deprecated(`${t}.${n}`,`${t}.${i}`)(),a=a||Object.assign({},e),a[i]=e[n],delete a[n]}return a||e}},7469:(t,e,n)=>{"use strict";n.d(e,{F:()=>i});var r=n(9450);function i(t,e,n,i){const o=`See luma.gl ${n} Upgrade Guide at https://luma.gl/docs/upgrade-guide`,s=Object.getPrototypeOf(t);i.forEach((t=>{s.methodName||(s[t]=()=>{throw r.cM.removed(`Calling removed method ${e}.${t}: `,o)(),new Error(t)})}))}},4538:(t,e,n)=>{"use strict";n.d(e,{hQ:()=>o,wt:()=>s,nK:()=>a});var r=n(2525);const i={};function o(t="id"){return i[t]=i[t]||1,`${t}-${i[t]++}`}function s(t){return(0,r.h)("number"==typeof t,"Input must be a number"),t&&0==(t&t-1)}function a(t){let e=!0;for(const n in t){e=!1;break}return e}},8522:(t,e,n)=>{"use strict";n.d(e,{$Z:()=>l,hJ:()=>u,jG:()=>c});var r=n(2525);const i=5126,o=5124,s=5125,a={[i]:[i,1,"float"],35664:[i,2,"vec2"],35665:[i,3,"vec3"],35666:[i,4,"vec4"],[o]:[o,1,"int"],35667:[o,2,"ivec2"],35668:[o,3,"ivec3"],35669:[o,4,"ivec4"],[s]:[s,1,"uint"],36294:[s,2,"uvec2"],36295:[s,3,"uvec3"],36296:[s,4,"uvec4"],35670:[i,1,"bool"],35671:[i,2,"bvec2"],35672:[i,3,"bvec3"],35673:[i,4,"bvec4"],35674:[i,8,"mat2"],35685:[i,8,"mat2x3"],35686:[i,8,"mat2x4"],35675:[i,12,"mat3"],35687:[i,12,"mat3x2"],35688:[i,12,"mat3x4"],35676:[i,16,"mat4"],35689:[i,16,"mat4x2"],35690:[i,16,"mat4x3"]};function l(t){switch(t){case 0:return 0;case 1:case 3:case 2:return 1;case 4:case 5:case 6:return 4;default:return(0,r.h)(!1),0}}function u(t){const e=a[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function c(t,e){switch(t){case 5120:case 5121:case 5122:case 5123:t=i}for(const n in a){const[r,i,o]=a[n];if(r===t&&i===e)return{glType:n,name:o}}return null}},9579:(t,e,n)=>{"use strict";n.d(e,{sF:()=>i,km:()=>o});var r=n(2525);function i(t,e){if("string"!=typeof e)return e;const n=Number(e);if(!isNaN(n))return n;const i=t[e=e.replace(/^.*\./,"")];return(0,r.h)(void 0!==i,`Accessing undefined constant GL.${e}`),i}function o(t,e){e=Number(e);for(const n in t)if(t[n]===e)return`GL.${n}`;return String(e)}},3296:(t,e,n)=>{"use strict";n.d(e,{h:()=>l,Y:()=>u});var r=n(4912),i=n(7952),o=n(1319),s=n(3849),a=n(2525);function l(t,e){(0,a.h)(t instanceof r.Z||t instanceof i.Z||t instanceof o.Z);const n=t.constructor,{gl:s,width:l,height:u,format:c,type:h,dataFormat:p,border:f,mipmaps:d}=t;return new n(s,Object.assign({width:l,height:u,format:c,type:h,dataFormat:p,border:f,mipmaps:d},e))}function u(t,e){const{gl:n,width:r,height:i,id:o}=t;return new s.Z(n,Object.assign({},e,{id:`framebuffer-for-${o}`,width:r,height:i,attachments:{36064:t}}))}},9335:(t,e,n)=>{"use strict";function r(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error("Failed to deduce GL constant from typed array")}}function i(t,{clamped:e=!0}={}){switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function o({data:t,width:e,height:n,bytesPerPixel:r=4,temp:i}){const o=e*r;i=i||new Uint8Array(o);for(let e=0;e<n/2;++e){const r=e*o,s=(n-e-1)*o;i.set(t.subarray(r,r+o)),t.copyWithin(r,s,s+o),t.set(i,s)}}function s({data:t,width:e,height:n}){const r=Math.round(e/2),i=Math.round(n/2),o=new Uint8Array(r*i*4);for(let n=0;n<i;n++)for(let i=0;i<r;i++)for(let s=0;s<4;s++)o[4*(n*r+i)+s]=t[4*(2*n*e+2*i)+s];return{data:o,width:r,height:i}}n.d(e,{O:()=>r,vN:()=>i,c$:()=>o,KS:()=>s})},9296:t=>{"use strict";t.exports=n,t.exports.default=n;var e=1e20;function n(t,e,n,r,i,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=r||.25,this.fontFamily=i||"sans-serif",this.fontWeight=o||"normal",this.radius=n||8;var s=this.size=this.fontSize+2*this.buffer,a=s+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=s,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Uint16Array(a),this.useMetrics=void 0!==this.ctx.measureText("A").actualBoundingBoxLeft,this.middle=Math.round(s/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function r(t,e,n,r,o,s){for(var a=0;a<e;a++)i(t,a,e,n,r,o,s);for(var l=0;l<n;l++)i(t,l*e,1,e,r,o,s)}function i(t,n,r,i,o,s,a){var l,u,c,h;for(s[0]=0,a[0]=-e,a[1]=e,l=0;l<i;l++)o[l]=t[n+l*r];for(l=1,u=0,c=0;l<i;l++){do{h=s[u],c=(o[l]-o[h]+l*l-h*h)/(l-h)/2}while(c<=a[u]&&--u>-1);s[++u]=l,a[u]=c,a[u+1]=e}for(l=0,u=0;l<i;l++){for(;a[u+1]<l;)u++;h=s[u],t[n+l*r]=o[h]+(l-h)*(l-h)}}n.prototype._draw=function(t,n){var i,o,s,a,l,u,c,h,p,f=this.ctx.measureText(t),d=f.width,g=2*this.buffer;n&&this.useMetrics?(l=Math.floor(f.actualBoundingBoxAscent),h=this.buffer+Math.ceil(f.actualBoundingBoxAscent),u=this.buffer,c=this.buffer,i=(o=Math.min(this.size,Math.ceil(f.actualBoundingBoxRight-f.actualBoundingBoxLeft)))+g,s=(a=Math.min(this.size-u,Math.ceil(f.actualBoundingBoxAscent+f.actualBoundingBoxDescent)))+g,this.ctx.textBaseline="alphabetic"):(i=o=this.size,s=a=this.size,l=19*this.fontSize/24,u=c=0,h=this.middle,this.ctx.textBaseline="middle"),o&&a&&(this.ctx.clearRect(c,u,o,a),this.ctx.fillText(t,this.buffer,h),p=this.ctx.getImageData(c,u,o,a));var m=new Uint8ClampedArray(i*s);return function(t,n,r,i,o,s,a){s.fill(e,0,n*r),a.fill(0,0,n*r);for(var l=(n-i)/2,u=0;u<o;u++)for(var c=0;c<i;c++){var h=(u+l)*n+c+l,p=t.data[4*(u*i+c)+3]/255;if(1===p)s[h]=0,a[h]=e;else if(0===p)s[h]=e,a[h]=0;else{var f=Math.max(0,.5-p),d=Math.max(0,p-.5);s[h]=f*f,a[h]=d*d}}}(p,i,s,o,a,this.gridOuter,this.gridInner),r(this.gridOuter,i,s,this.f,this.v,this.z),r(this.gridInner,i,s,this.f,this.v,this.z),function(t,e,n,r,i,o,s){for(var a=0;a<e*n;a++){var l=Math.sqrt(r[a])-Math.sqrt(i[a]);t[a]=Math.round(255-255*(l/o+s))}}(m,i,s,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:m,metrics:{width:o,height:a,sdfWidth:i,sdfHeight:s,top:l,left:0,advance:d}}},n.prototype.draw=function(t){return this._draw(t,!1).data},n.prototype.drawWithMetrics=function(t){return this._draw(t,!0)}},6357:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var r=n(4034),i=n(394);class o extends(function(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}(Array)){get ELEMENTS(){return(0,i.Z)(!1),0}clone(){return(new this.constructor).copy(this)}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}fromArray(t,e=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}to(t){return t===this?this:(0,r.kJ)(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toArray(t=[],e=0){for(let n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(r.vc)}formatString(t){let e="";for(let n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+(0,r.Bw)(this[n],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}equals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(!(0,r.fS)(this[e],t[e]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,e,n){void 0===n&&(n=e,e=t,t=this);for(let r=0;r<this.ELEMENTS;++r){const i=t[r];this[r]=i+n*(e[r]-i)}return this.check()}min(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}max(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}clamp(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}add(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]+=e[t];return this.check()}subtract(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]-=e[t];return this.check()}scale(t){if(Array.isArray(t))return this.multiply(t);for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}sub(t){return this.subtract(t)}setScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}addScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}divideScalar(t){return this.scale(1/t)}clampScalar(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}multiplyByScalar(t){return this.scale(t)}get elements(){return this}check(){if(r.vc.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let t=this.length===this.ELEMENTS;for(let e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}}},1e3:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(6357),i=n(6281),o=n(4034),s=n(394);class a extends r.Z{get ELEMENTS(){return(0,s.Z)(!1),0}get RANK(){return(0,s.Z)(!1),0}toString(){let t="[";if(o.vc.printRowMajor){t+="row-major:";for(let e=0;e<this.RANK;++e)for(let n=0;n<this.RANK;++n)t+=" ".concat(this[n*this.RANK+e])}else{t+="column-major:";for(let e=0;e<this.ELEMENTS;++e)t+=" ".concat(this[e])}return t+="]",t}getElementIndex(t,e){return e*this.RANK+t}getElement(t,e){return this[e*this.RANK+t]}setElement(t,e,n){return this[e*this.RANK+t]=(0,i.u5)(n),this}getColumn(t,e=new Array(this.RANK).fill(-0)){const n=t*this.RANK;for(let t=0;t<this.RANK;++t)e[t]=this[n+t];return e}setColumn(t,e){const n=t*this.RANK;for(let t=0;t<this.RANK;++t)this[n+t]=e[t];return this}}},2678:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(6357),i=n(6281),o=n(394);class s extends r.Z{get ELEMENTS(){return(0,o.Z)(!1),0}copy(t){return(0,o.Z)(!1),this}get x(){return this[0]}set x(t){this[0]=(0,i.u5)(t)}get y(){return this[1]}set y(t){this[1]=(0,i.u5)(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let e=0;for(let n=0;n<this.ELEMENTS;++n){const r=this[n]-t[n];e+=r*r}return(0,i.u5)(e)}dot(t){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return(0,i.u5)(e)}normalize(){const t=this.magnitude();if(0!==t)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}multiply(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e[t];return this.check()}divide(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e[t];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return(0,o.Z)(t>=0&&t<this.ELEMENTS,"index is out of range"),(0,i.u5)(this[t])}setComponent(t,e){return(0,o.Z)(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}addVectors(t,e){return this.copy(t).add(e)}subVectors(t,e){return this.copy(t).subtract(e)}multiplyVectors(t,e){return this.copy(t).multiply(e)}addScaledVector(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}}},540:(t,e,n)=>{"use strict";n.d(e,{Z:()=>f});var r=n(1e3),i=n(6281),o=n(1031),s=n(2125),a=n(4219),l=n(7964);const u=Object.freeze([1,0,0,0,1,0,0,0,1]),c=Object.freeze([0,0,0,0,0,0,0,0,0]),h=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL1ROW0:3,COL1ROW1:4,COL1ROW2:5,COL2ROW0:6,COL2ROW1:7,COL2ROW2:8}),p={};class f extends r.Z{static get IDENTITY(){return p.IDENTITY=p.IDENTITY||Object.freeze(new f(u)),p.IDENTITY}static get ZERO(){return p.ZERO=p.ZERO||Object.freeze(new f(c)),p.ZERO}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return h}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}set(t,e,n,r,i,o,s,a,l){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=i,this[5]=o,this[6]=s,this[7]=a,this[8]=l,this.check()}setRowMajor(t,e,n,r,i,o,s,a,l){return this[0]=t,this[1]=r,this[2]=s,this[3]=e,this[4]=i,this[5]=a,this[6]=n,this[7]=o,this[8]=l,this.check()}determinant(){return s.GH(this)}identity(){return this.copy(u)}fromQuaternion(t){return s.en(this,t),this.check()}transpose(){return s.p4(this,this),this.check()}invert(){return s.U_(this,this),this.check()}multiplyLeft(t){return s.Jp(this,t,this),this.check()}multiplyRight(t){return s.Jp(this,this,t),this.check()}rotate(t){return s.U1(this,this,t),this.check()}scale(t){return Array.isArray(t)?s.bA(this,this,t):s.bA(this,this,[t,t,t]),this.check()}translate(t){return s.Iu(this,this,t),this.check()}transform(t,e){switch(t.length){case 2:e=a.kK(e||[-0,-0],t,this);break;case 3:e=l.kK(e||[-0,-0,-0],t,this);break;case 4:e=(0,o._x)(e||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return(0,i.IL)(e,t.length),e}transformVector(t,e){return(0,i.x9)("Matrix3.transformVector"),this.transform(t,e)}transformVector2(t,e){return(0,i.x9)("Matrix3.transformVector"),this.transform(t,e)}transformVector3(t,e){return(0,i.x9)("Matrix3.transformVector"),this.transform(t,e)}}},3467:(t,e,n)=>{"use strict";n.d(e,{Z:()=>m});var r=n(6281),i=n(1e3),o=n(1031),s=n(473);function a(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=e[9],f=e[10],d=e[11],g=e[12],m=e[13],A=e[14],y=e[15],_=n[0],v=n[1],b=n[2],x=n[3];return t[0]=_*r+v*a+b*h+x*g,t[1]=_*i+v*l+b*p+x*m,t[2]=_*o+v*u+b*f+x*A,t[3]=_*s+v*c+b*d+x*y,_=n[4],v=n[5],b=n[6],x=n[7],t[4]=_*r+v*a+b*h+x*g,t[5]=_*i+v*l+b*p+x*m,t[6]=_*o+v*u+b*f+x*A,t[7]=_*s+v*c+b*d+x*y,_=n[8],v=n[9],b=n[10],x=n[11],t[8]=_*r+v*a+b*h+x*g,t[9]=_*i+v*l+b*p+x*m,t[10]=_*o+v*u+b*f+x*A,t[11]=_*s+v*c+b*d+x*y,_=n[12],v=n[13],b=n[14],x=n[15],t[12]=_*r+v*a+b*h+x*g,t[13]=_*i+v*l+b*p+x*m,t[14]=_*o+v*u+b*f+x*A,t[15]=_*s+v*c+b*d+x*y,t}function l(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}var u=n(4219),c=n(7964),h=n(2493);const p=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),f=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),d=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),g={};class m extends i.Z{static get IDENTITY(){return g.IDENTITY=g.IDENTITY||Object.freeze(new m(p)),g.IDENTITY}static get ZERO(){return g.ZERO=g.ZERO||Object.freeze(new m(f)),g.ZERO}get INDICES(){return d}get ELEMENTS(){return 16}get RANK(){return 4}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,e,n,r,i,o,s,a,l,u,c,h,p,f,d,g){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=i,this[5]=o,this[6]=s,this[7]=a,this[8]=l,this[9]=u,this[10]=c,this[11]=h,this[12]=p,this[13]=f,this[14]=d,this[15]=g,this.check()}setRowMajor(t,e,n,r,i,o,s,a,l,u,c,h,p,f,d,g){return this[0]=t,this[1]=i,this[2]=l,this[3]=p,this[4]=e,this[5]=o,this[6]=u,this[7]=f,this[8]=n,this[9]=s,this[10]=c,this[11]=d,this[12]=r,this[13]=a,this[14]=h,this[15]=g,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(p)}fromQuaternion(t){return function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n+n,a=r+r,l=i+i,u=n*s,c=r*s,h=r*a,p=i*s,f=i*a,d=i*l,g=o*s,m=o*a,A=o*l;t[0]=1-h-d,t[1]=c+A,t[2]=p-m,t[3]=0,t[4]=c-A,t[5]=1-u-d,t[6]=f+g,t[7]=0,t[8]=p+m,t[9]=f-g,t[10]=1-u-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(this,t),this.check()}frustum({left:t,right:e,bottom:n,top:r,near:i,far:o}){return o===1/0?m._computeInfinitePerspectiveOffCenter(this,t,e,n,r,i):function(t,e,n,r,i,o,s){var a=1/(n-e),l=1/(i-r),u=1/(o-s);t[0]=2*o*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*l,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*l,t[10]=(s+o)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*u,t[15]=0}(this,t,e,n,r,i,o),this.check()}static _computeInfinitePerspectiveOffCenter(t,e,n,r,i,o){const s=2*o/(n-e),a=2*o/(i-r),l=(n+e)/(n-e),u=(i+r)/(i-r),c=-2*o;return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=l,t[9]=u,t[10]=-1,t[11]=-1,t[12]=0,t[13]=0,t[14]=c,t[15]=0,t}lookAt(t,e,n){return 1===arguments.length&&({eye:t,center:e,up:n}=t),function(t,e,n,r){var i,o,a,l,u,c,h,p,f,d,g=e[0],m=e[1],A=e[2],y=r[0],_=r[1],v=r[2],b=n[0],x=n[1],w=n[2];Math.abs(g-b)<s.Ib&&Math.abs(m-x)<s.Ib&&Math.abs(A-w)<s.Ib?function(t){t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(t):(h=g-b,p=m-x,f=A-w,i=_*(f*=d=1/Math.hypot(h,p,f))-v*(p*=d),o=v*(h*=d)-y*f,a=y*p-_*h,(d=Math.hypot(i,o,a))?(i*=d=1/d,o*=d,a*=d):(i=0,o=0,a=0),l=p*a-f*o,u=f*i-h*a,c=h*o-p*i,(d=Math.hypot(l,u,c))?(l*=d=1/d,u*=d,c*=d):(l=0,u=0,c=0),t[0]=i,t[1]=l,t[2]=h,t[3]=0,t[4]=o,t[5]=u,t[6]=p,t[7]=0,t[8]=a,t[9]=c,t[10]=f,t[11]=0,t[12]=-(i*g+o*m+a*A),t[13]=-(l*g+u*m+c*A),t[14]=-(h*g+p*m+f*A),t[15]=1)}(this,t,e=e||[0,0,0],n=n||[0,1,0]),this.check()}ortho({left:t,right:e,bottom:n,top:r,near:i=.1,far:o=500}){return function(t,e,n,r,i,o,s){var a=1/(e-n),l=1/(r-i),u=1/(o-s);t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*l,t[14]=(s+o)*u,t[15]=1}(this,t,e,n,r,i,o),this.check()}orthographic({fovy:t=45*Math.PI/180,aspect:e=1,focalDistance:n=1,near:r=.1,far:i=500}){if(t>2*Math.PI)throw Error("radians");const o=t/2,s=n*Math.tan(o),a=s*e;return(new m).ortho({left:-a,right:a,bottom:-s,top:s,near:r,far:i})}perspective({fovy:t,fov:e=45*Math.PI/180,aspect:n=1,near:r=.1,far:i=500}={}){if((t=t||e)>2*Math.PI)throw Error("radians");return function(t,e,n,r,i){var o,s=1/Math.tan(e/2);t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r)}(this,t,n,r,i),this.check()}determinant(){return e=(t=this)[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],l=t[7],u=t[8],c=t[9],h=t[10],p=t[11],f=t[12],d=t[13],g=t[14],(e*s-n*o)*(h*(m=t[15])-p*g)-(e*a-r*o)*(c*m-p*d)+(e*l-i*o)*(c*g-h*d)+(n*a-r*s)*(u*m-p*f)-(n*l-i*s)*(u*g-h*f)+(r*l-i*a)*(u*d-c*f);var t,e,n,r,i,o,s,a,l,u,c,h,p,f,d,g,m}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t=[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=null){const n=this.getScale(e||[-0,-0,-0]),r=1/n[0],i=1/n[1],o=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*i,t[2]=this[2]*o,t[3]=0,t[4]=this[4]*r,t[5]=this[5]*i,t[6]=this[6]*o,t[7]=0,t[8]=this[8]*r,t[9]=this[9]*i,t[10]=this[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t=[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=null){const n=this.getScale(e||[-0,-0,-0]),r=1/n[0],i=1/n[1],o=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*i,t[2]=this[2]*o,t[3]=this[4]*r,t[4]=this[5]*i,t[5]=this[6]*o,t[6]=this[8]*r,t[7]=this[9]*i,t[8]=this[10]*o,t}transpose(){return function(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15]}(this,this),this.check()}invert(){var t,e,n,r,i,o,s,a,l,u,c,h,p,f,d,g,m,A,y,_,v,b,x,w,E,S,T,P,M,C,I;return t=this,n=(e=this)[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],p=e[10],f=e[11],d=e[12],g=e[13],m=e[14],(I=(y=n*a-r*s)*(C=p*(A=e[15])-f*m)-(_=n*l-i*s)*(M=h*A-f*g)+(v=n*u-o*s)*(P=h*m-p*g)+(b=r*l-i*a)*(T=c*A-f*d)-(x=r*u-o*a)*(S=c*m-p*d)+(w=i*u-o*l)*(E=c*g-h*d))&&(I=1/I,t[0]=(a*C-l*M+u*P)*I,t[1]=(i*M-r*C-o*P)*I,t[2]=(g*w-m*x+A*b)*I,t[3]=(p*x-h*w-f*b)*I,t[4]=(l*T-s*C-u*S)*I,t[5]=(n*C-i*T+o*S)*I,t[6]=(m*v-d*w-A*_)*I,t[7]=(c*w-p*v+f*_)*I,t[8]=(s*M-a*T+u*E)*I,t[9]=(r*T-n*M-o*E)*I,t[10]=(d*x-g*v+A*y)*I,t[11]=(h*v-c*x-f*y)*I,t[12]=(a*S-s*P-l*E)*I,t[13]=(n*P-r*S+i*E)*I,t[14]=(g*_-d*b-m*y)*I,t[15]=(c*b-h*_+p*y)*I),this.check()}multiplyLeft(t){return a(this,t,this),this.check()}multiplyRight(t){return a(this,this,t),this.check()}rotateX(t){var e,n,r,i,o,s,a,l,u,c,h,p,f;return e=this,n=this,r=t,i=Math.sin(r),o=Math.cos(r),s=n[4],a=n[5],l=n[6],u=n[7],c=n[8],h=n[9],p=n[10],f=n[11],n!==e&&(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[4]=s*o+c*i,e[5]=a*o+h*i,e[6]=l*o+p*i,e[7]=u*o+f*i,e[8]=c*o-s*i,e[9]=h*o-a*i,e[10]=p*o-l*i,e[11]=f*o-u*i,this.check()}rotateY(t){var e,n,r,i,o,s,a,l,u,c,h,p,f;return e=this,n=this,r=t,i=Math.sin(r),o=Math.cos(r),s=n[0],a=n[1],l=n[2],u=n[3],c=n[8],h=n[9],p=n[10],f=n[11],n!==e&&(e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[0]=s*o-c*i,e[1]=a*o-h*i,e[2]=l*o-p*i,e[3]=u*o-f*i,e[8]=s*i+c*o,e[9]=a*i+h*o,e[10]=l*i+p*o,e[11]=u*i+f*o,this.check()}rotateZ(t){var e,n,r,i,o,s,a,l,u,c,h,p,f;return e=this,n=this,r=t,i=Math.sin(r),o=Math.cos(r),s=n[0],a=n[1],l=n[2],u=n[3],c=n[4],h=n[5],p=n[6],f=n[7],n!==e&&(e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[0]=s*o+c*i,e[1]=a*o+h*i,e[2]=l*o+p*i,e[3]=u*o+f*i,e[4]=c*o-s*i,e[5]=h*o-a*i,e[6]=p*o-l*i,e[7]=f*o-u*i,this.check()}rotateXYZ([t,e,n]){return this.rotateX(t).rotateY(e).rotateZ(n)}rotateAxis(t,e){return function(t,e,n,r){var i,o,a,l,u,c,h,p,f,d,g,m,A,y,_,v,b,x,w,E,S,T,P,M,C=r[0],I=r[1],O=r[2],R=Math.hypot(C,I,O);R<s.Ib||(C*=R=1/R,I*=R,O*=R,i=Math.sin(n),a=1-(o=Math.cos(n)),l=e[0],u=e[1],c=e[2],h=e[3],p=e[4],f=e[5],d=e[6],g=e[7],m=e[8],A=e[9],y=e[10],_=e[11],v=C*C*a+o,b=I*C*a+O*i,x=O*C*a-I*i,w=C*I*a-O*i,E=I*I*a+o,S=O*I*a+C*i,T=C*O*a+I*i,P=I*O*a-C*i,M=O*O*a+o,t[0]=l*v+p*b+m*x,t[1]=u*v+f*b+A*x,t[2]=c*v+d*b+y*x,t[3]=h*v+g*b+_*x,t[4]=l*w+p*E+m*S,t[5]=u*w+f*E+A*S,t[6]=c*w+d*E+y*S,t[7]=h*w+g*E+_*S,t[8]=l*T+p*P+m*M,t[9]=u*T+f*P+A*M,t[10]=c*T+d*P+y*M,t[11]=h*T+g*P+_*M,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]))}(this,this,t,e),this.check()}scale(t){return Array.isArray(t)?l(this,this,t):l(this,this,[t,t,t]),this.check()}translate(t){var e,n,r,i,o,s,a,l,u,c,h,p,f,d,g,m,A,y;return e=this,n=this,m=(r=t)[0],A=r[1],y=r[2],n===e?(e[12]=n[0]*m+n[4]*A+n[8]*y+n[12],e[13]=n[1]*m+n[5]*A+n[9]*y+n[13],e[14]=n[2]*m+n[6]*A+n[10]*y+n[14],e[15]=n[3]*m+n[7]*A+n[11]*y+n[15]):(i=n[0],o=n[1],s=n[2],a=n[3],l=n[4],u=n[5],c=n[6],h=n[7],p=n[8],f=n[9],d=n[10],g=n[11],e[0]=i,e[1]=o,e[2]=s,e[3]=a,e[4]=l,e[5]=u,e[6]=c,e[7]=h,e[8]=p,e[9]=f,e[10]=d,e[11]=g,e[12]=i*m+l*A+p*y+n[12],e[13]=o*m+u*A+f*y+n[13],e[14]=s*m+c*A+d*y+n[14],e[15]=a*m+h*A+g*y+n[15]),this.check()}transform(t,e){return 4===t.length?(e=h.fF(e||[-0,-0,-0,-0],t,this),(0,r.IL)(e,4),e):this.transformAsPoint(t,e)}transformAsPoint(t,e){const{length:n}=t;switch(n){case 2:e=u.fF(e||[-0,-0],t,this);break;case 3:e=c.fF(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return(0,r.IL)(e,t.length),e}transformAsVector(t,e){switch(t.length){case 2:e=(0,o.pb)(e||[-0,-0],t,this);break;case 3:e=(0,o.pL)(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return(0,r.IL)(e,t.length),e}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,e,n){return this.identity().translate([t,e,n])}transformPoint(t,e){return(0,r.x9)("Matrix4.transformPoint","3.0"),this.transformAsPoint(t,e)}transformVector(t,e){return(0,r.x9)("Matrix4.transformVector","3.0"),this.transformAsPoint(t,e)}transformDirection(t,e){return(0,r.x9)("Matrix4.transformDirection","3.0"),this.transformAsVector(t,e)}}},7696:(t,e,n)=>{"use strict";n.d(e,{Z:()=>S});var r=n(6357),i=n(6281),o=n(394),s=n(473),a=n(2125),l=n(7964),u=n(2493);function c(){var t=new s.WT(4);return s.WT!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function h(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function p(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=n[0],l=n[1],u=n[2],c=n[3];return t[0]=r*c+s*a+i*u-o*l,t[1]=i*c+s*l+o*a-r*u,t[2]=o*c+s*u+r*l-i*a,t[3]=s*c-r*a-i*l-o*u,t}u.d9,u.al,u.JG,u.t8;var f,d,g,m=u.IH,A=u.bA,y=u.AK,_=u.t7,v=u.kE,b=u.we,x=u.Fv,w=(u.I6,u.fS,f=l.Ue(),d=l.al(1,0,0),g=l.al(0,1,0),function(t,e,n){var r=l.AK(e,n);return r<-.999999?(l.kC(f,d,e),l.Zh(f)<1e-6&&l.kC(f,g,e),l.Fv(f,f),h(t,f,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(l.kC(f,e,n),t[0]=f[0],t[1]=f[1],t[2]=f[2],t[3]=1+r,x(t,t))});c(),c(),a.Ue();const E=[0,0,0,1];class S extends r.Z{constructor(t=0,e=0,n=0,r=1){super(-0,-0,-0,-0),Array.isArray(t)&&1===arguments.length?this.copy(t):this.set(t,e,n,r)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}set(t,e,n,r){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this.check()}fromMatrix3(t){return function(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var o=(i+1)%3,s=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*o+o]-e[3*s+s]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*o+s]-e[3*s+o])*n,t[o]=(e[3*o+i]+e[3*i+o])*n,t[s]=(e[3*s+i]+e[3*i+s])*n}}(this,t),this.check()}identity(){var t;return(t=this)[0]=0,t[1]=0,t[2]=0,t[3]=1,this.check()}fromAxisRotation(t,e){return h(this,t,e),this.check()}setAxisAngle(t,e){return this.fromAxisRotation(t,e)}get ELEMENTS(){return 4}get x(){return this[0]}set x(t){this[0]=(0,i.u5)(t)}get y(){return this[1]}set y(t){this[1]=(0,i.u5)(t)}get z(){return this[2]}set z(t){this[2]=(0,i.u5)(t)}get w(){return this[3]}set w(t){this[3]=(0,i.u5)(t)}len(){return v(this)}lengthSquared(){return b(this)}dot(t,e){if(void 0!==e)throw new Error("Quaternion.dot only takes one argument");return y(this,t)}rotationTo(t,e){return w(this,t,e),this.check()}add(t,e){if(void 0!==e)throw new Error("Quaternion.add only takes one argument");return m(this,this,t),this.check()}calculateW(){var t,e,n,r;return t=this,e=this[0],n=this[1],r=this[2],t[0]=e,t[1]=n,t[2]=r,t[3]=Math.sqrt(Math.abs(1-e*e-n*n-r*r)),this.check()}conjugate(){var t,e;return e=this,(t=this)[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],this.check()}invert(){return function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n*n+r*r+i*i+o*o,a=s?1/s:0;t[0]=-n*a,t[1]=-r*a,t[2]=-i*a,t[3]=o*a}(this,this),this.check()}lerp(t,e,n){return _(this,t,e,n),this.check()}multiplyRight(t,e){return(0,o.Z)(!e),p(this,this,t),this.check()}multiplyLeft(t,e){return(0,o.Z)(!e),p(this,t,this),this.check()}normalize(){const t=this.len(),e=t>0?1/t:0;return this[0]=this[0]*e,this[1]=this[1]*e,this[2]=this[2]*e,this[3]=this[3]*e,0===t&&(this[3]=1),this.check()}rotateX(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);t[0]=r*l+s*a,t[1]=i*l+o*a,t[2]=o*l-i*a,t[3]=s*l-r*a}(this,this,t),this.check()}rotateY(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);t[0]=r*l-o*a,t[1]=i*l+s*a,t[2]=o*l+r*a,t[3]=s*l-i*a}(this,this,t),this.check()}rotateZ(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);t[0]=r*l+i*a,t[1]=i*l-r*a,t[2]=o*l+s*a,t[3]=s*l-o*a}(this,this,t),this.check()}scale(t){return A(this,this,t),this.check()}slerp(t,e,n){switch(arguments.length){case 1:({start:t=E,target:e,ratio:n}=arguments[0]);break;case 2:[e,n]=arguments,t=this}return r=this,o=e,a=n,f=(i=t)[0],d=i[1],g=i[2],m=i[3],A=o[0],y=o[1],_=o[2],v=o[3],(u=f*A+d*y+g*_+m*v)<0&&(u=-u,A=-A,y=-y,_=-_,v=-v),1-u>s.Ib?(l=Math.acos(u),c=Math.sin(l),h=Math.sin((1-a)*l)/c,p=Math.sin(a*l)/c):(h=1-a,p=a),r[0]=h*f+p*A,r[1]=h*d+p*y,r[2]=h*g+p*_,r[3]=h*m+p*v,this.check();var r,i,o,a,l,u,c,h,p,f,d,g,m,A,y,_,v}transformVector4(t,e=t){return u.VC(e,t,this),(0,i.IL)(e,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(t,e){return this.setAxisAngle(t,e)}premultiply(t,e){return this.multiplyLeft(t,e)}multiply(t,e){return this.multiplyRight(t,e)}}},7858:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(4034),i=n(3855),o=n(7964);const s=1e-6;class a{constructor({phi:t=0,theta:e=0,radius:n=1,bearing:r,pitch:i,altitude:o,radiusScale:s=6371e3}={}){this.phi=t,this.theta=e,this.radius=n||o||1,this.radiusScale=s||1,void 0!==r&&(this.bearing=r),void 0!==i&&(this.pitch=i),this.check()}toString(){return this.formatString(r.vc)}formatString({printTypes:t=!1}){const e=r.Bw;return"".concat(t?"Spherical":"","[rho:").concat(e(this.radius),",theta:").concat(e(this.theta),",phi:").concat(e(this.phi),"]")}equals(t){return(0,r.fS)(this.radius,t.radius)&&(0,r.fS)(this.theta,t.theta)&&(0,r.fS)(this.phi,t.phi)}exactEquals(t){return this.radius===t.radius&&this.theta===t.theta&&this.phi===t.phi}get bearing(){return 180-(0,r.RW)(this.phi)}set bearing(t){this.phi=Math.PI-(0,r.uR)(t)}get pitch(){return(0,r.RW)(this.theta)}set pitch(t){this.theta=(0,r.uR)(t)}get longitude(){return(0,r.RW)(this.phi)}get latitude(){return(0,r.RW)(this.theta)}get lng(){return(0,r.RW)(this.phi)}get lat(){return(0,r.RW)(this.theta)}get z(){return(this.radius-1)*this.radiusScale}set(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this.check()}clone(){return(new a).copy(this)}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this.check()}fromLngLatZ([t,e,n]){this.radius=1+n/this.radiusScale,this.phi=(0,r.uR)(e),this.theta=(0,r.uR)(t)}fromVector3(t){return this.radius=o.kE(t),this.radius>0&&(this.theta=Math.atan2(t[0],t[1]),this.phi=Math.acos((0,r.uZ)(t[2]/this.radius,-1,1))),this.check()}toVector3(){return new i.Z(0,0,this.radius).rotateX({radians:this.theta}).rotateZ({radians:this.phi})}makeSafe(){return this.phi=Math.max(s,Math.min(Math.PI-s,this.phi)),this}check(){if(!(Number.isFinite(this.phi)&&Number.isFinite(this.theta)&&this.radius>0))throw new Error("SphericalCoordinates: some fields set to invalid numbers");return this}}},7069:(t,e,n)=>{"use strict";n.d(e,{Z:()=>l});var r=n(2678),i=n(4034),o=n(6281),s=n(4219),a=n(1031);class l extends r.Z{constructor(t=0,e=0){super(2),(0,i.kJ)(t)&&1===arguments.length?this.copy(t):(i.vc.debug&&((0,o.u5)(t),(0,o.u5)(e)),this[0]=t,this[1]=e)}set(t,e){return this[0]=t,this[1]=e,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this.check()}fromObject(t){return i.vc.debug&&((0,o.u5)(t.x),(0,o.u5)(t.y)),this[0]=t.x,this[1]=t.y,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return s.fF(this,this,t),this.check()}transformAsVector(t){return(0,a.pb)(this,this,t),this.check()}transformByMatrix3(t){return s.kK(this,this,t),this.check()}transformByMatrix2x3(t){return s.iu(this,this,t),this.check()}transformByMatrix2(t){return s.c(this,this,t),this.check()}}},3855:(t,e,n)=>{"use strict";n.d(e,{Z:()=>c});var r=n(2678),i=n(4034),o=n(6281),s=n(7964),a=n(1031);const l=[0,0,0],u={};class c extends r.Z{static get ZERO(){return u.ZERO=u.ZERO||Object.freeze(new c(0,0,0,0))}constructor(t=0,e=0,n=0){super(-0,-0,-0),1===arguments.length&&(0,i.kJ)(t)?this.copy(t):(i.vc.debug&&((0,o.u5)(t),(0,o.u5)(e),(0,o.u5)(n)),this[0]=t,this[1]=e,this[2]=n)}set(t,e,n){return this[0]=t,this[1]=e,this[2]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return i.vc.debug&&((0,o.u5)(t.x),(0,o.u5)(t.y),(0,o.u5)(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=(0,o.u5)(t)}angle(t){return s.EU(this,t)}cross(t){return s.kC(this,this,t),this.check()}rotateX({radians:t,origin:e=l}){return s.lM(this,this,e,t),this.check()}rotateY({radians:t,origin:e=l}){return s.uD(this,this,e,t),this.check()}rotateZ({radians:t,origin:e=l}){return s.jI(this,this,e,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return s.fF(this,this,t),this.check()}transformAsVector(t){return(0,a.pL)(this,this,t),this.check()}transformByMatrix3(t){return s.kK(this,this,t),this.check()}transformByMatrix2(t){return(0,a.eQ)(this,this,t),this.check()}transformByQuaternion(t){return s.VC(this,this,t),this.check()}}},394:(t,e,n)=>{"use strict";function r(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}n.d(e,{Z:()=>r})},4034:(t,e,n)=>{"use strict";n.d(e,{vc:()=>s,jQ:()=>a,Bw:()=>l,kJ:()=>u,d9:()=>c,Yr:()=>p,Ux:()=>f,uR:()=>d,RW:()=>g,O$:()=>m,mC:()=>A,OR:()=>y,ZR:()=>_,Kh:()=>v,z4:()=>b,uZ:()=>x,t7:()=>w,fS:()=>E,I6:()=>S,BJ:()=>T});var r=n(394);const i=1/Math.PI*180,o=1/180*Math.PI,s={};function a(t={}){for(const e in t)(0,r.Z)(e in s),s[e]=t[e];return s}function l(t,{precision:e=s.precision||4}={}){return t=function(t){return Math.round(t/s.EPSILON)*s.EPSILON}(t),"".concat(parseFloat(t.toPrecision(e)))}function u(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function c(t){return t.clone?t.clone():new Array(...t)}function h(t,e,n){if(u(t)){n=n||((r=t).clone?r.clone():new Array(r.length));for(let r=0;r<n.length&&r<t.length;++r)n[r]=e(t[r],r,n);return n}var r;return e(t)}function p(t){return d(t)}function f(t){return g(t)}function d(t,e){return h(t,(t=>t*o),e)}function g(t,e){return h(t,(t=>t*i),e)}function m(t){return h(t,(t=>Math.sin(t)))}function A(t){return h(t,(t=>Math.cos(t)))}function y(t){return h(t,(t=>Math.tan(t)))}function _(t){return h(t,(t=>Math.asin(t)))}function v(t){return h(t,(t=>Math.acos(t)))}function b(t){return h(t,(t=>Math.atan(t)))}function x(t,e,n){return h(t,(t=>Math.max(e,Math.min(n,t))))}function w(t,e,n){return u(t)?t.map(((t,r)=>w(t,e[r],n))):n*e+(1-n)*t}function E(t,e,n){const r=s.EPSILON;n&&(s.EPSILON=n);try{if(t===e)return!0;if(u(t)&&u(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!E(t[n],e[n]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):!(!Number.isFinite(t)||!Number.isFinite(e))&&Math.abs(t-e)<=s.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{s.EPSILON=r}}function S(t,e){if(t===e)return!0;if(t&&"object"==typeof t&&e&&"object"==typeof e){if(t.constructor!==e.constructor)return!1;if(t.exactEquals)return t.exactEquals(e)}if(u(t)&&u(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!S(t[n],e[n]))return!1;return!0}return!1}function T(t,e){const n=s.EPSILON;let r;s.EPSILON=t;try{r=e()}finally{s.EPSILON=n}return r}s.EPSILON=1e-12,s.debug=!1,s.precision=4,s.printTypes=!1,s.printDegrees=!1,s.printRowMajor=!0},1031:(t,e,n)=>{"use strict";function r(t,e,n){const r=e[0],i=e[1],o=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/o,t[1]=(n[1]*r+n[5]*i)/o,t}function i(t,e,n){const r=e[0],i=e[1],o=e[2],s=n[3]*r+n[7]*i+n[11]*o||1;return t[0]=(n[0]*r+n[4]*i+n[8]*o)/s,t[1]=(n[1]*r+n[5]*i+n[9]*o)/s,t[2]=(n[2]*r+n[6]*i+n[10]*o)/s,t}function o(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function s(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t[3]=e[3],t}function a(t,e,n){const r=e[0],i=e[1],o=e[2];return t[0]=n[0]*r+n[3]*i+n[6]*o,t[1]=n[1]*r+n[4]*i+n[7]*o,t[2]=n[2]*r+n[5]*i+n[8]*o,t[3]=e[3],t}n.d(e,{pb:()=>r,pL:()=>i,eQ:()=>o,G7:()=>s,_x:()=>a})},9057:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});const r={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:2*Math.PI}},6281:(t,e,n)=>{"use strict";n.d(e,{u5:()=>i,IL:()=>o,x9:()=>a});var r=n(4034);function i(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function o(t,e,n=""){if(r.vc.debug&&!function(t,e){if(t.length!==e)return!1;for(let e=0;e<t.length;++e)if(!Number.isFinite(t[e]))return!1;return!0}(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}const s={};function a(t,e){s[t]||(s[t]=!0,console.warn("".concat(t," has been removed in version ").concat(e,", see upgrade guide for more information")))}},473:(t,e,n)=>{"use strict";n.d(e,{Ib:()=>r,WT:()=>i});var r=1e-6,i="undefined"!=typeof Float32Array?Float32Array:Array;Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)})},2125:(t,e,n)=>{"use strict";n.d(e,{Ue:()=>i,p4:()=>o,U_:()=>s,GH:()=>a,Jp:()=>l,Iu:()=>u,U1:()=>c,bA:()=>h,en:()=>p});var r=n(473);function i(){var t=new r.WT(9);return r.WT!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function o(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function s(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=c*s-a*u,p=-c*o+a*l,f=u*o-s*l,d=n*h+r*p+i*f;return d?(d=1/d,t[0]=h*d,t[1]=(-c*r+i*u)*d,t[2]=(a*r-i*s)*d,t[3]=p*d,t[4]=(c*n-i*l)*d,t[5]=(-a*n+i*o)*d,t[6]=f*d,t[7]=(-u*n+r*l)*d,t[8]=(s*n-r*o)*d,t):null}function a(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],l=t[7],u=t[8];return e*(u*o-s*l)+n*(-u*i+s*a)+r*(l*i-o*a)}function l(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=n[0],f=n[1],d=n[2],g=n[3],m=n[4],A=n[5],y=n[6],_=n[7],v=n[8];return t[0]=p*r+f*s+d*u,t[1]=p*i+f*a+d*c,t[2]=p*o+f*l+d*h,t[3]=g*r+m*s+A*u,t[4]=g*i+m*a+A*c,t[5]=g*o+m*l+A*h,t[6]=y*r+_*s+v*u,t[7]=y*i+_*a+v*c,t[8]=y*o+_*l+v*h,t}function u(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=n[0],f=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=a,t[5]=l,t[6]=p*r+f*s+u,t[7]=p*i+f*a+c,t[8]=p*o+f*l+h,t}function c(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=Math.sin(n),f=Math.cos(n);return t[0]=f*r+p*s,t[1]=f*i+p*a,t[2]=f*o+p*l,t[3]=f*s-p*r,t[4]=f*a-p*i,t[5]=f*l-p*o,t[6]=u,t[7]=c,t[8]=h,t}function h(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function p(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n+n,a=r+r,l=i+i,u=n*s,c=r*s,h=r*a,p=i*s,f=i*a,d=i*l,g=o*s,m=o*a,A=o*l;return t[0]=1-h-d,t[3]=c-A,t[6]=p+m,t[1]=c+A,t[4]=1-u-d,t[7]=f-g,t[2]=p-m,t[5]=f+g,t[8]=1-u-h,t}},4219:(t,e,n)=>{"use strict";n.d(e,{c:()=>o,iu:()=>s,kK:()=>a,fF:()=>l});var r,i=n(473);function o(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t}function s(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t}function a(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function l(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}r=new i.WT(2),i.WT!=Float32Array&&(r[0]=0,r[1]=0)},7964:(t,e,n)=>{"use strict";n.d(e,{Ue:()=>i,kE:()=>o,al:()=>s,Fv:()=>a,AK:()=>l,kC:()=>u,fF:()=>c,kK:()=>h,VC:()=>p,lM:()=>f,uD:()=>d,jI:()=>g,EU:()=>m,Zh:()=>A});var r=n(473);function i(){var t=new r.WT(3);return r.WT!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function o(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function s(t,e,n){var i=new r.WT(3);return i[0]=t,i[1]=e,i[2]=n,i}function a(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function l(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function u(t,e,n){var r=e[0],i=e[1],o=e[2],s=n[0],a=n[1],l=n[2];return t[0]=i*l-o*a,t[1]=o*s-r*l,t[2]=r*a-i*s,t}function c(t,e,n){var r=e[0],i=e[1],o=e[2],s=n[3]*r+n[7]*i+n[11]*o+n[15];return s=s||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/s,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/s,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/s,t}function h(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t}function p(t,e,n){var r=n[0],i=n[1],o=n[2],s=n[3],a=e[0],l=e[1],u=e[2],c=i*u-o*l,h=o*a-r*u,p=r*l-i*a,f=i*p-o*h,d=o*c-r*p,g=r*h-i*c,m=2*s;return c*=m,h*=m,p*=m,f*=2,d*=2,g*=2,t[0]=a+c+f,t[1]=l+h+d,t[2]=u+p+g,t}function f(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function d(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function g(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function m(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],s=e[1],a=e[2],u=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(o*o+s*s+a*a),c=u&&l(t,e)/u;return Math.acos(Math.min(Math.max(c,-1),1))}var A=o;i()},2493:(t,e,n)=>{"use strict";n.d(e,{d9:()=>o,al:()=>s,JG:()=>a,t8:()=>l,IH:()=>u,bA:()=>c,kE:()=>h,we:()=>p,Fv:()=>f,AK:()=>d,t7:()=>g,fF:()=>m,VC:()=>A,I6:()=>y,fS:()=>_});var r,i=n(473);function o(t){var e=new i.WT(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function s(t,e,n,r){var o=new i.WT(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=r,o}function a(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function l(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function u(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function c(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function h(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function p(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function f(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n*n+r*r+i*i+o*o;return s>0&&(s=1/Math.sqrt(s)),t[0]=n*s,t[1]=r*s,t[2]=i*s,t[3]=o*s,t}function d(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function g(t,e,n,r){var i=e[0],o=e[1],s=e[2],a=e[3];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=s+r*(n[2]-s),t[3]=a+r*(n[3]-a),t}function m(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*s,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*s,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*s,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*s,t}function A(t,e,n){var r=e[0],i=e[1],o=e[2],s=n[0],a=n[1],l=n[2],u=n[3],c=u*r+a*o-l*i,h=u*i+l*r-s*o,p=u*o+s*i-a*r,f=-s*r-a*i-l*o;return t[0]=c*u+f*-s+h*-l-p*-a,t[1]=h*u+f*-a+p*-s-c*-l,t[2]=p*u+f*-l+c*-a-h*-s,t[3]=e[3],t}function y(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function _(t,e){var n=t[0],r=t[1],o=t[2],s=t[3],a=e[0],l=e[1],u=e[2],c=e[3];return Math.abs(n-a)<=i.Ib*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-l)<=i.Ib*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(o-u)<=i.Ib*Math.max(1,Math.abs(o),Math.abs(u))&&Math.abs(s-c)<=i.Ib*Math.max(1,Math.abs(s),Math.abs(c))}r=new i.WT(4),i.WT!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0)},5215:(t,e,n)=>{"use strict";n.d(e,{wG:()=>r,WZ:()=>B,GU:()=>Z,dj:()=>N,ct:()=>G,OT:()=>s,ap:()=>o,Ny:()=>i});const r={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function i(t,e,n={}){const r=function(t,e={}){return Math.sign(o(t,e))}(t,n);return r!==e&&(function(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,o=(r-n)/i,s=Math.floor(o/2);for(let e=0;e<s;++e){const r=n+e*i,s=n+(o-1-e)*i;for(let e=0;e<i;++e){const n=t[r+e];t[r+e]=t[s+e],t[s+e]=n}}}(t,n),!0)}function o(t,e={}){const{start:n=0,end:r=t.length}=e,i=e.size||2;let o=0;for(let e=n,s=r-i;e<r;e+=i)o+=(t[e]-t[s])*(t[e+1]+t[s+1]),s=e;return o/2}function s(t,e,n,r){n=n||2;const i=e&&e.length,o=i?e[0]*n:t.length;let s=a(t,0,o,n,!0,r&&r[0]);const c=[];if(!s||s.next===s.prev)return c;let h,p,f,m,A,_,v;if(i&&(s=function(t,e,n,r,i){const o=[];let s,u,c,h,p;for(s=0,u=e.length;s<u;s++)c=e[s]*r,h=s<u-1?e[s+1]*r:t.length,p=a(t,c,h,r,!1,i&&i[s+1]),p===p.next&&(p.steiner=!0),o.push(y(p));for(o.sort(d),s=0;s<o.length;s++)g(o[s],n),n=l(n,n.next);return n}(t,e,s,n,r)),t.length>80*n){m=p=t[0],A=f=t[1];for(let e=n;e<o;e+=n)_=t[e],v=t[e+1],_<m&&(m=_),v<A&&(A=v),_>p&&(p=_),v>f&&(f=v);h=Math.max(p-m,f-A),h=0!==h?1/h:0}return u(s,c,n,m,A,h),c}function a(t,e,n,r,i,s){let a,l;if(void 0===s&&(s=o(t,{start:e,end:n,size:r})),i===s<0)for(a=e;a<n;a+=r)l=M(a,t[a],t[a+1],l);else for(a=n-r;a>=e;a-=r)l=M(a,t[a],t[a+1],l);return l&&x(l,l.next)&&(C(l),l=l.next),l}function l(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!x(r,r.next)&&0!==b(r.prev,r,r.next))r=r.next;else{if(C(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function u(t,e,n,r,i,o,s){if(!t)return;!s&&o&&function(t,e,n,r){let i=t;do{null===i.z&&(i.z=A(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){let e,n,r,i,o,s,a,l,u=1;do{for(i=t,t=null,l=null,r=0;i;){for(r++,s=i,o=0,n=0;n<u&&(o++,s=s.nextZ,s);n++);for(a=u;o>0||a>0&&s;)0!==o&&(0===a||!s||i.z<=s.z)?(e=i,i=i.nextZ,o--):(e=s,s=s.nextZ,a--),l?l.nextZ=e:t=e,e.prevZ=l,l=e;i=s}l.nextZ=null,u*=2}while(r>1)}(i)}(t,r,i,o);let a,d,g=t;for(;t.prev!==t.next;)if(a=t.prev,d=t.next,o?h(t,r,i,o):c(t))e.push(a.i/n),e.push(t.i/n),e.push(d.i/n),C(t),t=d.next,g=d.next;else if((t=d)===g){s?1===s?u(t=p(l(t),e,n),e,n,r,i,o,2):2===s&&f(t,e,n,r,i,o):u(l(t),e,n,r,i,o,1);break}}function c(t){const e=t.prev,n=t,r=t.next;if(b(e,n,r)>=0)return!1;let i=t.next.next;for(;i!==t.prev;){if(_(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&b(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function h(t,e,n,r){const i=t.prev,o=t,s=t.next;if(b(i,o,s)>=0)return!1;const a=i.x<o.x?i.x<s.x?i.x:s.x:o.x<s.x?o.x:s.x,l=i.y<o.y?i.y<s.y?i.y:s.y:o.y<s.y?o.y:s.y,u=i.x>o.x?i.x>s.x?i.x:s.x:o.x>s.x?o.x:s.x,c=i.y>o.y?i.y>s.y?i.y:s.y:o.y>s.y?o.y:s.y,h=A(a,l,e,n,r),p=A(u,c,e,n,r);let f=t.prevZ,d=t.nextZ;for(;f&&f.z>=h&&d&&d.z<=p;){if(f!==t.prev&&f!==t.next&&_(i.x,i.y,o.x,o.y,s.x,s.y,f.x,f.y)&&b(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,d!==t.prev&&d!==t.next&&_(i.x,i.y,o.x,o.y,s.x,s.y,d.x,d.y)&&b(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;f&&f.z>=h;){if(f!==t.prev&&f!==t.next&&_(i.x,i.y,o.x,o.y,s.x,s.y,f.x,f.y)&&b(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;d&&d.z<=p;){if(d!==t.prev&&d!==t.next&&_(i.x,i.y,o.x,o.y,s.x,s.y,d.x,d.y)&&b(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function p(t,e,n){let r=t;do{const i=r.prev,o=r.next.next;!x(i,o)&&w(i,r,r.next,o)&&T(i,o)&&T(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),C(r),C(r.next),r=t=o),r=r.next}while(r!==t);return l(r)}function f(t,e,n,r,i,o){let s=t;do{let t=s.next.next;for(;t!==s.prev;){if(s.i!==t.i&&v(s,t)){let a=P(s,t);return s=l(s,s.next),a=l(a,a.next),u(s,e,n,r,i,o),void u(a,e,n,r,i,o)}t=t.next}s=s.next}while(s!==t)}function d(t,e){return t.x-e.x}function g(t,e){if(e=function(t,e){let n=e;const r=t.x,i=t.y;let o,s=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){const t=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>s){if(s=t,t===r){if(i===n.y)return n;if(i===n.next.y)return n.next}o=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!o)return null;if(r===s)return o;const a=o,l=o.x,u=o.y;let c,h=1/0;n=o;do{r>=n.x&&n.x>=l&&r!==n.x&&_(i<u?r:s,i,l,u,i<u?s:r,i,n.x,n.y)&&(c=Math.abs(i-n.y)/(r-n.x),T(n,t)&&(c<h||c===h&&(n.x>o.x||n.x===o.x&&m(o,n)))&&(o=n,h=c)),n=n.next}while(n!==a);return o}(t,e),e){const n=P(e,t);l(e,e.next),l(n,n.next)}}function m(t,e){return b(t.prev,t,e.prev)<0&&b(e.next,t,t.next)<0}function A(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function y(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function _(t,e,n,r,i,o,s,a){return(i-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(r-a)-(n-s)*(e-a)>=0&&(n-s)*(o-a)-(i-s)*(r-a)>=0}function v(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&w(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(T(t,e)&&T(e,t)&&function(t,e){let n=t,r=!1;const i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(b(t.prev,t,e.prev)||b(t,e.prev,e))||x(t,e)&&b(t.prev,t,t.next)>0&&b(e.prev,e,e.next)>0)}function b(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function x(t,e){return t.x===e.x&&t.y===e.y}function w(t,e,n,r){const i=S(b(t,e,n)),o=S(b(t,e,r)),s=S(b(n,r,t)),a=S(b(n,r,e));return i!==o&&s!==a||!(0!==i||!E(t,n,e))||!(0!==o||!E(t,r,e))||!(0!==s||!E(n,t,r))||!(0!==a||!E(n,e,r))}function E(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function S(t){return t>0?1:t<0?-1:0}function T(t,e){return b(t.prev,t,t.next)<0?b(t,e,t.next)>=0&&b(t,t.prev,e)>=0:b(t,e,t.prev)<0||b(t,t.next,e)<0}function P(t,e){const n=new I(t.i,t.x,t.y),r=new I(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function M(t,e,n,r){const i=new I(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function C(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function I(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function O(t,e,n,r,i=[]){let o,s;if(8&n)o=(r[3]-t[1])/(e[1]-t[1]),s=3;else if(4&n)o=(r[1]-t[1])/(e[1]-t[1]),s=1;else if(2&n)o=(r[2]-t[0])/(e[0]-t[0]),s=2;else{if(!(1&n))return null;o=(r[0]-t[0])/(e[0]-t[0]),s=0}for(let n=0;n<t.length;n++)i[n]=(1&s)===n?r[s]:o*(e[n]-t[n])+t[n];return i}function R(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function L(t,e){const n=e.length,r=t.length;if(r>0){let i=!0;for(let o=0;o<n;o++)if(t[r-n+o]!==e[o]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function k(t,e){const n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function D(t,e,n,r,i=[]){const o=r+e*n;for(let e=0;e<n;e++)i[e]=t[o+e];return i}function N(t,e={}){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:o=[0,0],startIndex:s=0,endIndex:a=t.length}=e,l=(a-s)/n;let u=[];const c=[u],h=D(t,0,n,s);let p,f;const d=j(h,i,o,[]),g=[];L(u,h);for(let e=1;e<l;e++){for(p=D(t,e,n,s,p),f=R(p,d);f;){O(h,p,f,d,g);const t=R(g,d);t&&(O(h,g,t,d,g),f=t),L(u,g),k(h,g),U(d,i,f),r&&u.length>n&&(u=[],c.push(u),L(u,h)),f=R(p,d)}L(u,p),k(h,p)}return r?c:c[0]}function F(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function B(t,e,n={}){if(!t.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:o=[0,0],edgeTypes:s=!1}=n,a=[],l=[{pos:t,types:s&&new Array(t.length/r).fill(1),holes:e||[]}],u=[[],[]];let c=[];for(;l.length;){const{pos:t,types:e,holes:n}=l.shift();V(t,r,n[0]||t.length,u),c=j(u[0],i,o,c);const h=R(u[1],c);if(h){let i=z(t,e,r,0,n[0]||t.length,c,h);const o={pos:i[0].pos,types:i[0].types,holes:[]},a={pos:i[1].pos,types:i[1].types,holes:[]};l.push(o,a);for(let l=0;l<n.length;l++)i=z(t,e,r,n[l],n[l+1]||t.length,c,h),i[0]&&(o.holes.push(o.pos.length),o.pos=F(o.pos,i[0].pos),s&&(o.types=F(o.types,i[0].types))),i[1]&&(a.holes.push(a.pos.length),a.pos=F(a.pos,i[1].pos),s&&(a.types=F(a.types,i[1].types)))}else{const r={positions:t};s&&(r.edgeTypes=e),n.length&&(r.holeIndices=n),a.push(r)}}return a}function z(t,e,n,r,i,o,s){const a=(i-r)/n,l=[],u=[],c=[],h=[],p=[];let f,d,g;const m=D(t,a-1,n,r);let A=Math.sign(8&s?m[1]-o[3]:m[0]-o[2]),y=e&&e[a-1],_=0,v=0;for(let i=0;i<a;i++)f=D(t,i,n,r,f),d=Math.sign(8&s?f[1]-o[3]:f[0]-o[2]),g=e&&e[r/n+i],d&&A&&A!==d&&(O(m,f,s,o,p),L(l,p)&&c.push(y),L(u,p)&&h.push(y)),d<=0?(L(l,f)&&c.push(g),_-=d):c.length&&(c[c.length-1]=0),d>=0?(L(u,f)&&h.push(g),v+=d):h.length&&(h[h.length-1]=0),k(m,f),A=d,y=g;return[_?{pos:l,types:e&&c}:null,v?{pos:u,types:e&&h}:null]}function j(t,e,n,r){const i=Math.floor((t[0]-n[0])/e)*e+n[0],o=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=o,r[2]=i+e,r[3]=o+e,r}function U(t,e,n){8&n?(t[1]+=e,t[3]+=e):4&n?(t[1]-=e,t[3]-=e):2&n?(t[0]+=e,t[2]+=e):1&n&&(t[0]-=e,t[2]-=e)}function V(t,e,n,r){let i=1/0,o=-1/0,s=1/0,a=-1/0;for(let r=0;r<n;r+=e){const e=t[r],n=t[r+1];i=e<i?e:i,o=e>o?e:o,s=n<s?n:s,a=n>a?n:a}return r[0][0]=i,r[0][1]=s,r[1][0]=o,r[1][1]=a,r}function G(t,e={}){const{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:o=!0}=e,s=t.slice(r,i);H(s,n,0,i-r);const a=N(s,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(o)for(const t of a)X(t,n);return a}function Z(t,e,n={}){const{size:r=2,normalize:i=!0,edgeTypes:o=!1}=n;e=e||[];const s=[],a=[];let l=0,u=0;for(let i=0;i<=e.length;i++){const o=e[i]||t.length,c=u,h=q(t,r,l,o);for(let e=h;e<o;e++)s[u++]=t[e];for(let e=l;e<h;e++)s[u++]=t[e];H(s,r,c,u),W(s,r,c,u,n.maxLatitude),l=o,a[i]=u}a.pop();const c=B(s,a,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:o});if(i)for(const t of c)X(t.positions,r);return c}function q(t,e,n,r){let i=-1,o=-1;for(let s=n+1;s<r;s+=e){const e=Math.abs(t[s]);e>i&&(i=e,o=s-1)}return o}function W(t,e,n,r,i=85.051129){const o=t[n],s=t[r-e];if(Math.abs(o-s)>180){const r=D(t,0,e,n);r[0]+=360*Math.round((s-o)/360),L(t,r),r[1]=Math.sign(r[1])*i,L(t,r),r[0]=o,L(t,r)}}function H(t,e,n,r){let i,o=t[0];for(let s=n;s<r;s+=e){i=t[s];const e=i-o;(e>180||e<-180)&&(i-=360*Math.round(e/360)),t[s]=o=i}}function X(t,e){let n;const r=t.length/e;for(let i=0;i<r&&(n=t[i*e],(n+180)%360==0);i++);const i=360*-Math.round(n/360);if(0!==i)for(let n=0;n<r;n++)t[n*e]+=i}},7682:(t,e,n)=>{"use strict";n.d(e,{DW:()=>z,eG:()=>P,Lu:()=>O,Xg:()=>D,if:()=>G,sj:()=>R,zX:()=>F,ro:()=>T,up:()=>Z,Bf:()=>S,c7:()=>I,wl:()=>C,lf:()=>M,w5:()=>w,QA:()=>j,CT:()=>k,sO:()=>x,es:()=>E,aW:()=>L,EO:()=>b});var r,i=1e-6,o="undefined"!=typeof Float32Array?Float32Array:Array;function s(t,e){const n=function(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*s,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*s,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*s,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*s,t}([],e,t);return function(t,e,n){t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n}(n,n,1/n[3]),n}function a(t,e){const n=t%e;return n<0?e+n:n}Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)}),r=new o(4),o!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0);const l=Math.log2||function(t){return Math.log(t)*Math.LOG2E};function u(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=e[9],f=e[10],d=e[11],g=e[12],m=e[13],A=e[14],y=e[15],_=n[0],v=n[1],b=n[2],x=n[3];return t[0]=_*r+v*a+b*h+x*g,t[1]=_*i+v*l+b*p+x*m,t[2]=_*o+v*u+b*f+x*A,t[3]=_*s+v*c+b*d+x*y,_=n[4],v=n[5],b=n[6],x=n[7],t[4]=_*r+v*a+b*h+x*g,t[5]=_*i+v*l+b*p+x*m,t[6]=_*o+v*u+b*f+x*A,t[7]=_*s+v*c+b*d+x*y,_=n[8],v=n[9],b=n[10],x=n[11],t[8]=_*r+v*a+b*h+x*g,t[9]=_*i+v*l+b*p+x*m,t[10]=_*o+v*u+b*f+x*A,t[11]=_*s+v*c+b*d+x*y,_=n[12],v=n[13],b=n[14],x=n[15],t[12]=_*r+v*a+b*h+x*g,t[13]=_*i+v*l+b*p+x*m,t[14]=_*o+v*u+b*f+x*A,t[15]=_*s+v*c+b*d+x*y,t}function c(t,e,n){var r,i,o,s,a,l,u,c,h,p,f,d,g=n[0],m=n[1],A=n[2];return e===t?(t[12]=e[0]*g+e[4]*m+e[8]*A+e[12],t[13]=e[1]*g+e[5]*m+e[9]*A+e[13],t[14]=e[2]*g+e[6]*m+e[10]*A+e[14],t[15]=e[3]*g+e[7]*m+e[11]*A+e[15]):(r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=e[9],f=e[10],d=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=a,t[5]=l,t[6]=u,t[7]=c,t[8]=h,t[9]=p,t[10]=f,t[11]=d,t[12]=r*g+a*m+h*A+e[12],t[13]=i*g+l*m+p*A+e[13],t[14]=o*g+u*m+f*A+e[14],t[15]=s*g+c*m+d*A+e[15]),t}function h(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function p(t,e){var n=t[0],r=t[1],o=t[2],s=t[3],a=t[4],l=t[5],u=t[6],c=t[7],h=t[8],p=t[9],f=t[10],d=t[11],g=t[12],m=t[13],A=t[14],y=t[15],_=e[0],v=e[1],b=e[2],x=e[3],w=e[4],E=e[5],S=e[6],T=e[7],P=e[8],M=e[9],C=e[10],I=e[11],O=e[12],R=e[13],L=e[14],k=e[15];return Math.abs(n-_)<=i*Math.max(1,Math.abs(n),Math.abs(_))&&Math.abs(r-v)<=i*Math.max(1,Math.abs(r),Math.abs(v))&&Math.abs(o-b)<=i*Math.max(1,Math.abs(o),Math.abs(b))&&Math.abs(s-x)<=i*Math.max(1,Math.abs(s),Math.abs(x))&&Math.abs(a-w)<=i*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(l-E)<=i*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(u-S)<=i*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(c-T)<=i*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(h-P)<=i*Math.max(1,Math.abs(h),Math.abs(P))&&Math.abs(p-M)<=i*Math.max(1,Math.abs(p),Math.abs(M))&&Math.abs(f-C)<=i*Math.max(1,Math.abs(f),Math.abs(C))&&Math.abs(d-I)<=i*Math.max(1,Math.abs(d),Math.abs(I))&&Math.abs(g-O)<=i*Math.max(1,Math.abs(g),Math.abs(O))&&Math.abs(m-R)<=i*Math.max(1,Math.abs(m),Math.abs(R))&&Math.abs(A-L)<=i*Math.max(1,Math.abs(A),Math.abs(L))&&Math.abs(y-k)<=i*Math.max(1,Math.abs(y),Math.abs(k))}function f(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function d(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t}!function(){var t=new o(2);o!=Float32Array&&(t[0]=0,t[1]=0)}();function g(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}!function(){var t=new o(3);o!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0)}();const m=Math.PI,A=m/4,y=m/180,_=180/m,v=512;function b(t){return Math.pow(2,t)}function x(t){return l(t)}function w([t,e]){g(Number.isFinite(t)),g(Number.isFinite(e)&&e>=-90&&e<=90,"invalid latitude");const n=e*y;return[v*(t*y+m)/(2*m),v*(m+Math.log(Math.tan(A+.5*n)))/(2*m)]}function E([t,e]){const n=t/v*(2*m)-m,r=2*(Math.atan(Math.exp(e/v*(2*m)-m))-A);return[n*_,r*_]}function S({latitude:t}){g(Number.isFinite(t));return x(4003e4*Math.cos(t*y))-9}function T({latitude:t,longitude:e,highPrecision:n=!1}){g(Number.isFinite(t)&&Number.isFinite(e));const r={},i=Math.cos(t*y),o=512/360,s=o/i,a=12790407194604047e-21/i;if(r.unitsPerMeter=[a,a,a],r.metersPerUnit=[1/a,1/a,1/a],r.unitsPerDegree=[o,s,a],r.degreesPerUnit=[.703125,1/s,1/a],n){const e=y*Math.tan(t*y)/i,n=o*e/2,l=12790407194604047e-21*e,u=l/s*a;r.unitsPerDegree2=[0,n,l],r.unitsPerMeter2=[u,0,u]}return r}function P(t,e){const[n,r,i]=t,[o,s,a]=e,{unitsPerMeter:l,unitsPerMeter2:u}=T({longitude:n,latitude:r,highPrecision:!0}),c=w(t);c[0]+=o*(l[0]+u[0]*s),c[1]+=s*(l[1]+u[1]*s);const h=E(c),p=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[h[0],h[1],p]:h}function M({height:t,pitch:e,bearing:n,altitude:r,scale:i,center:o=null}){const s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return c(s,s,[0,0,-r]),function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],s=e[5],a=e[6],l=e[7],u=e[8],c=e[9],h=e[10],p=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+u*r,t[5]=s*i+c*r,t[6]=a*i+h*r,t[7]=l*i+p*r,t[8]=u*i-o*r,t[9]=c*i-s*r,t[10]=h*i-a*r,t[11]=p*i-l*r}(s,s,-e*y),function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],s=e[1],a=e[2],l=e[3],u=e[4],c=e[5],h=e[6],p=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+u*r,t[1]=s*i+c*r,t[2]=a*i+h*r,t[3]=l*i+p*r,t[4]=u*i-o*r,t[5]=c*i-s*r,t[6]=h*i-a*r,t[7]=p*i-l*r}(s,s,n*y),h(s,s,[i/=t,i,i]),o&&c(s,s,function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}([],o)),s}function C({width:t,height:e,fovy:n=O(1.5),altitude:r,pitch:i=0,nearZMultiplier:o=1,farZMultiplier:s=1}){void 0!==r&&(n=O(r));const a=.5*n*y,l=R(n),u=i*y,c=Math.sin(a)*l/Math.sin(Math.min(Math.max(Math.PI/2-u-a,.01),Math.PI-.01));return{fov:2*a,aspect:t/e,focalDistance:l,near:o,far:(Math.sin(u)*c+l)*s}}function I({width:t,height:e,pitch:n,altitude:r,fovy:i,nearZMultiplier:o,farZMultiplier:s}){const{fov:a,aspect:l,near:u,far:c}=C({width:t,height:e,altitude:r,fovy:i,pitch:n,nearZMultiplier:o,farZMultiplier:s}),h=function(t,e,n,r,i){var o,s=1/Math.tan(e/2);return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}([],a,l,u,c);return h}function O(t){return 2*Math.atan(.5/t)*_}function R(t){return.5/Math.tan(.5*t*y)}function L(t,e){const[n,r,i=0]=t;return g(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),s(e,[n,r,i,1])}function k(t,e,n=0){const[r,i,o]=t;if(g(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(o))return s(e,[r,i,o,1]);const a=s(e,[r,i,0,1]),l=s(e,[r,i,1,1]),u=a[2],c=l[2];return d([],a,l,u===c?0:((n||0)-u)/(c-u))}function D({width:t,height:e,bounds:n,minExtent:r=0,maxZoom:i=24,padding:o=0,offset:s=[0,0]}){const[[a,u],[c,h]]=n;Number.isFinite(o)?o={top:o,bottom:o,left:o,right:o}:g(Number.isFinite(o.top)&&Number.isFinite(o.bottom)&&Number.isFinite(o.left)&&Number.isFinite(o.right));const p=new z({width:t,height:e,longitude:0,latitude:0,zoom:0}),f=p.project([a,h]),d=p.project([c,u]),m=[Math.max(Math.abs(d[0]-f[0]),r),Math.max(Math.abs(d[1]-f[1]),r)],A=[t-o.left-o.right-2*Math.abs(s[0]),e-o.top-o.bottom-2*Math.abs(s[1])];g(A[0]>0&&A[1]>0);const y=A[0]/m[0],_=A[1]/m[1],v=(o.right-o.left)/2/y,b=(o.bottom-o.top)/2/_,x=[(d[0]+f[0])/2+v,(d[1]+f[1])/2+b],w=p.unproject(x),E=Math.min(i,p.zoom+l(Math.abs(Math.min(y,_))));return g(Number.isFinite(E)),{longitude:w[0],latitude:w[1],zoom:E}}const N=Math.PI/180;function F(t,e=0){const{width:n,height:r,unproject:i}=t,o={targetZ:e},s=i([0,r],o),a=i([n,r],o);let l,u;return(t.fovy?.5*t.fovy*N:Math.atan(.5/t.altitude))>(90-t.pitch)*N-.01?(l=B(t,0,e),u=B(t,n,e)):(l=i([0,0],o),u=i([n,0],o)),[s,a,u,l]}function B(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=s(r,[e,0,1,1]),o=s(r,[e,t.height,1,1]),a=E(d([],i,o,(n*t.distanceScales.unitsPerMeter[2]-i[2])/(o[2]-i[2])));return a[2]=n,a}class z{constructor({width:t,height:e,latitude:n=0,longitude:r=0,zoom:i=0,pitch:o=0,bearing:s=0,altitude:a=null,fovy:l=null,position:u=null,nearZMultiplier:c=.02,farZMultiplier:h=1.01}={width:1,height:1}){t=t||1,e=e||1,null===l&&null===a?l=O(a=1.5):null===l?l=O(a):null===a&&(a=R(l));const p=b(i);a=Math.max(.75,a);const f=T({longitude:r,latitude:n}),d=w([r,n]);d[2]=0,u&&function(t,e,n){t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2]}(d,d,function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}([],u,f.unitsPerMeter)),this.projectionMatrix=I({width:t,height:e,pitch:o,fovy:l,nearZMultiplier:c,farZMultiplier:h}),this.viewMatrix=M({height:e,scale:p,center:d,pitch:o,bearing:s,altitude:a}),this.width=t,this.height=e,this.scale=p,this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=o,this.bearing=s,this.altitude=a,this.fovy=l,this.center=d,this.meterOffset=u||[0,0,0],this.distanceScales=f,this._initMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),Object.freeze(this)}_initMatrices(){const{width:t,height:e,projectionMatrix:n,viewMatrix:r}=this,i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];u(i,i,n),u(i,i,r),this.viewProjectionMatrix=i;const o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];h(o,o,[t/2,-e/2,1]),c(o,o,[1,-1,0]),u(o,o,i);const s=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],p=e[10],f=e[11],d=e[12],g=e[13],m=e[14],A=e[15],y=n*a-r*s,_=n*l-i*s,v=n*u-o*s,b=r*l-i*a,x=r*u-o*a,w=i*u-o*l,E=c*g-h*d,S=c*m-p*d,T=c*A-f*d,P=h*m-p*g,M=h*A-f*g,C=p*A-f*m,I=y*C-_*M+v*P+b*T-x*S+w*E;return I?(I=1/I,t[0]=(a*C-l*M+u*P)*I,t[1]=(i*M-r*C-o*P)*I,t[2]=(g*w-m*x+A*b)*I,t[3]=(p*x-h*w-f*b)*I,t[4]=(l*T-s*C-u*S)*I,t[5]=(n*C-i*T+o*S)*I,t[6]=(m*v-d*w-A*_)*I,t[7]=(c*w-p*v+f*_)*I,t[8]=(s*M-a*T+u*E)*I,t[9]=(r*T-n*M-o*E)*I,t[10]=(d*x-g*v+A*y)*I,t[11]=(h*v-c*x-f*y)*I,t[12]=(a*S-s*P-l*E)*I,t[13]=(n*P-r*S+i*E)*I,t[14]=(g*_-d*b-m*y)*I,t[15]=(c*b-h*_+p*y)*I,t):null}([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o);if(!s)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=o,this.pixelUnprojectionMatrix=s}equals(t){return t instanceof z&&t.width===this.width&&t.height===this.height&&p(t.projectionMatrix,this.projectionMatrix)&&p(t.viewMatrix,this.viewMatrix)}project(t,{topLeft:e=!0}={}){const n=L(this.projectPosition(t),this.pixelProjectionMatrix),[r,i]=n,o=e?i:this.height-i;return 2===t.length?[r,o]:[r,o,n[2]]}unproject(t,{topLeft:e=!0,targetZ:n}={}){const[r,i,o]=t,s=e?i:this.height-i,a=n&&n*this.distanceScales.unitsPerMeter[2],l=k([r,s,o],this.pixelUnprojectionMatrix,a),[u,c,h]=this.unprojectPosition(l);return Number.isFinite(o)?[u,c,h]:Number.isFinite(n)?[u,c,n]:[u,c]}projectPosition(t){const[e,n]=w(t);return[e,n,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[e,n]=E(t);return[e,n,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){return w(t)}unprojectFlat(t){return E(t)}getMapCenterByLngLatPosition({lngLat:t,pos:e}){const n=k(e,this.pixelUnprojectionMatrix),r=f([],w(t),function(t,e){return t[0]=-e[0],t[1]=-e[1],t}([],n));return E(f([],this.center,r))}getLocationAtPoint({lngLat:t,pos:e}){return this.getMapCenterByLngLatPosition({lngLat:t,pos:e})}fitBounds(t,e={}){const{width:n,height:r}=this,{longitude:i,latitude:o,zoom:s}=D(Object.assign({width:n,height:r,bounds:t},e));return new z({width:n,height:r,longitude:i,latitude:o,zoom:s})}getBounds(t){const e=this.getBoundingRegion(t),n=Math.min(...e.map((t=>t[0]))),r=Math.max(...e.map((t=>t[0])));return[[n,Math.min(...e.map((t=>t[1])))],[r,Math.max(...e.map((t=>t[1])))]]}getBoundingRegion(t={}){return F(this,t.z||0)}}function j({width:t,height:e,longitude:n,latitude:r,zoom:i,pitch:o=0,bearing:s=0}){(n<-180||n>180)&&(n=a(n+180,360)-180),(s<-180||s>180)&&(s=a(s+180,360)-180);const u=l(e/512);if(i<=u)i=u,r=0;else{const t=e/2/Math.pow(2,i),n=E([0,t])[1];if(r<n)r=n;else{const e=E([0,512-t])[1];r>e&&(r=e)}}return{width:t,height:e,longitude:n,latitude:r,zoom:i,pitch:o,bearing:s}}const U=["longitude","latitude","zoom"],V={curve:1.414,speed:1.2};function G(t,e,n,r={}){const i={},{startZoom:o,startCenterXY:s,uDelta:a,w0:l,u1:u,S:c,rho:h,rho2:p,r0:d}=q(t,e,r);if(u<.01){for(const r of U){const o=t[r],s=e[r];i[r]=(g=n)*s+(1-g)*o}return i}var g;const m=n*c,A=Math.cosh(d)/Math.cosh(d+h*m),y=l*((Math.cosh(d)*Math.tanh(d+h*m)-Math.sinh(d))/p)/u,_=o+x(1/A),v=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}([],a,y);f(v,v,s);const b=E(v);return i.longitude=b[0],i.latitude=b[1],i.zoom=_,i}function Z(t,e,n={}){n=Object.assign({},V,n);const{screenSpeed:r,speed:i,maxDuration:o}=n,{S:s,rho:a}=q(t,e,n),l=1e3*s;let u;return u=Number.isFinite(r)?l/(r/a):l/i,Number.isFinite(o)&&u>o?0:u}function q(t,e,n){const r=(n=Object.assign({},V,n)).curve,i=t.zoom,o=[t.longitude,t.latitude],s=b(i),a=e.zoom,l=[e.longitude,e.latitude],u=b(a-i),c=w(o),h=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}([],w(l),c),p=Math.max(t.width,t.height),f=p/u,d=(E=(x=h)[0],S=x[1],Math.hypot(E,S)*s),g=Math.max(d,.01),m=r*r,A=(f*f-p*p+m*m*g*g)/(2*p*m*g),y=(f*f-p*p-m*m*g*g)/(2*f*m*g),_=Math.log(Math.sqrt(A*A+1)-A),v=Math.log(Math.sqrt(y*y+1)-y);var x,E,S;return{startZoom:i,startCenterXY:c,uDelta:h,w0:p,u1:d,S:(v-_)/r,rho:r,rho2:m,r0:_,r1:v}}},3023:(t,e)=>{"use strict";if("function"==typeof Symbol&&Symbol.for){var n=Symbol.for;n("react.element"),n("react.portal"),n("react.fragment"),n("react.strict_mode"),n("react.profiler"),n("react.provider"),n("react.context"),n("react.forward_ref"),n("react.suspense"),n("react.suspense_list"),n("react.memo"),n("react.lazy"),n("react.block"),n("react.server.block"),n("react.fundamental"),n("react.debug_trace_mode"),n("react.legacy_hidden")}},6607:(t,e,n)=>{"use strict";n(3023)},8295:(t,e,n)=>{"use strict";function r(){let t;if("undefined"!=typeof window&&window.performance)t=window.performance.now();else if("undefined"!=typeof process&&process.hrtime){const e=process.hrtime();t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}n.d(e,{Z:()=>o});class i{constructor(t,e){this.name=t,this.type=e,this.sampleSize=1,this.reset()}setSampleSize(t){return this.sampleSize=t,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(t){return this._count+=t,this._samples++,this._checkSampling(),this}subtractCount(t){return this._count-=t,this._samples++,this._checkSampling(),this}addTime(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=r(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(r()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class o{constructor({id:t,stats:e}){this.id=t,this.stats={},this._initializeStats(e),Object.seal(this)}get(t,e="count"){return this._getOrCreate({name:t,type:e})}get size(){return Object.keys(this.stats).length}reset(){for(const t in this.stats)this.stats[t].reset();return this}forEach(t){for(const e in this.stats)t(this.stats[e])}getTable(){const t={};return this.forEach((e=>{t[e.name]={time:e.time||0,count:e.count||0,average:e.getAverageTime()||0,hz:e.getHz()||0}})),t}_initializeStats(t=[]){t.forEach((t=>this._getOrCreate(t)))}_getOrCreate(t){if(!t||!t.name)return null;const{name:e,type:n}=t;return this.stats[e]||(this.stats[e]=t instanceof i?t:new i(e,n)),this.stats[e]}}},5913:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=r(n(1208)),o=r(n(3737)),s=r(n(1013)),a=n(4102),l=n(611);e.default=function(t,e,n){void 0===n&&(n={});for(var r=l.getGeom(t).coordinates,u=0,c=0;c<r.length&&!(e>=u&&c===r.length-1);c++){if(u>=e){var h=e-u;if(h){var p=i.default(r[c],r[c-1])-180;return o.default(r[c],h,p,n)}return a.point(r[c])}u+=s.default(r[c],r[c+1],n)}return a.point(r[r.length-1])}},1070:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1540),i=6378137;function o(t){var e=0;if(t&&t.length>0){e+=Math.abs(s(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(s(t[n]))}return e}function s(t){var e,n,r,o,s,l,u=0,c=t.length;if(c>2){for(l=0;l<c;l++)l===c-2?(r=c-2,o=c-1,s=0):l===c-1?(r=c-1,o=0,s=1):(r=l,o=l+1,s=l+2),e=t[r],n=t[o],u+=(a(t[s][0])-a(e[0]))*Math.sin(a(n[1]));u=u*i*i/2}return u}function a(t){return t*Math.PI/180}e.default=function(t){return r.geomReduce(t,(function(t,e){return t+function(t){var e,n=0;switch(t.type){case"Polygon":return o(t.coordinates);case"MultiPolygon":for(e=0;e<t.coordinates.length;e++)n+=o(t.coordinates[e]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(e)}),0)}},3652:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4102);e.default=function(t,e){void 0===e&&(e={});var n=Number(t[0]),i=Number(t[1]),o=Number(t[2]),s=Number(t[3]);if(6===t.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var a=[n,i],l=[n,s],u=[o,s],c=[o,i];return r.polygon([[a,c,u,l,a]],e.properties,{bbox:t,id:e.id})}},9705:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1540);function i(t){var e=[1/0,1/0,-1/0,-1/0];return r.coordEach(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}i.default=i,e.default=i},1208:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4102),i=n(611);e.default=function t(e,n,o){if(void 0===o&&(o={}),!0===o.final)return function(e,n){var r=t(n,e);return(r+180)%360}(e,n);var s=i.getCoord(e),a=i.getCoord(n),l=r.degreesToRadians(s[0]),u=r.degreesToRadians(a[0]),c=r.degreesToRadians(s[1]),h=r.degreesToRadians(a[1]),p=Math.sin(u-l)*Math.cos(h),f=Math.cos(c)*Math.sin(h)-Math.sin(c)*Math.cos(h)*Math.cos(u-l);return r.radiansToDegrees(Math.atan2(p,f))}},3809:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(611);e.default=function(t){for(var e,n,i=r.getCoords(t),o=0,s=1;s<i.length;)e=n||i[0],o+=((n=i[s])[0]-e[0])*(n[1]+e[1]),s++;return o>0}},8147:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(611);function i(t,e,n){var r=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var i=0,o=e.length-1;i<e.length;o=i++){var s=e[i][0],a=e[i][1],l=e[o][0],u=e[o][1];if(t[1]*(s-l)+a*(l-t[0])+u*(t[0]-s)==0&&(s-t[0])*(l-t[0])<=0&&(a-t[1])*(u-t[1])<=0)return!n;a>t[1]!=u>t[1]&&t[0]<(l-s)*(t[1]-a)/(u-a)+s&&(r=!r)}return r}e.default=function(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var o=r.getCoord(t),s=r.getGeom(e),a=s.type,l=e.bbox,u=s.coordinates;if(l&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(o,l))return!1;"Polygon"===a&&(u=[u]);for(var c=!1,h=0;h<u.length&&!c;h++)if(i(o,u[h][0],n.ignoreBoundary)){for(var p=!1,f=1;f<u[h].length&&!p;)i(o,u[h][f],!n.ignoreBoundary)&&(p=!0),f++;p||(c=!0)}return c}},5950:(t,e,n)=>{"use strict";var r=n(8230),i=n(675),o=n(1540),s=n(1621),a=n(4102);function l(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var u=l(r);function c(t,e,n){var r=(n=n||{}).units||"kilometers",i=n.steps||8;if(!t)throw new Error("geojson is required");if("object"!=typeof n)throw new Error("options must be an object");if("number"!=typeof i)throw new Error("steps must be an number");if(void 0===e)throw new Error("radius is required");if(i<=0)throw new Error("steps must be greater than 0");var s=[];switch(t.type){case"GeometryCollection":return o.geomEach(t,(function(t){var n=h(t,e,r,i);n&&s.push(n)})),a.featureCollection(s);case"FeatureCollection":return o.featureEach(t,(function(t){var n=h(t,e,r,i);n&&o.featureEach(n,(function(t){t&&s.push(t)}))})),a.featureCollection(s)}return h(t,e,r,i)}function h(t,e,n,r){var l=t.properties||{},c="Feature"===t.type?t.geometry:t;if("GeometryCollection"===c.type){var g=[];return o.geomEach(t,(function(t){var i=h(t,e,n,r);i&&g.push(i)})),a.featureCollection(g)}var m=function(t){var e=u.default(t).geometry.coordinates,n=[-e[0],-e[1]];return s.geoAzimuthalEquidistant().rotate(n).scale(a.earthRadius)}(c),A={type:c.type,coordinates:f(c.coordinates,m)},y=(new i.GeoJSONReader).read(A),_=a.radiansToLength(a.lengthToRadians(e,n),"meters"),v=i.BufferOp.bufferOp(y,_,r);if(!p((v=(new i.GeoJSONWriter).write(v)).coordinates)){var b={type:v.type,coordinates:d(v.coordinates,m)};return a.feature(b,l)}}function p(t){return Array.isArray(t[0])?p(t[0]):isNaN(t[0])}function f(t,e){return"object"!=typeof t[0]?e(t):t.map((function(t){return f(t,e)}))}function d(t,e){return"object"!=typeof t[0]?e.invert(t):t.map((function(t){return d(t,e)}))}t.exports=c,t.exports.default=c},8230:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=r(n(9705)),o=n(4102);e.default=function(t,e){void 0===e&&(e={});var n=i.default(t),r=(n[0]+n[2])/2,s=(n[1]+n[3])/2;return o.point([r,s],e.properties,e)}},6338:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1540),i=n(4102);e.default=function(t,e){void 0===e&&(e={});var n=0,o=0,s=0;return r.coordEach(t,(function(t){n+=t[0],o+=t[1],s++}),!0),i.point([n/s,o/s],e.properties)}},265:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=r(n(3737)),o=n(4102);e.default=function(t,e,n){void 0===n&&(n={});for(var r=n.steps||64,s=n.properties?n.properties:!Array.isArray(t)&&"Feature"===t.type&&t.properties?t.properties:{},a=[],l=0;l<r;l++)a.push(i.default(t,e,-360*l/r,n).geometry.coordinates);return a.push(a[0]),o.polygon([a],s)}},6565:(t,e)=>{"use strict";function n(t){var e={type:"Feature"};return Object.keys(t).forEach((function(n){switch(n){case"type":case"properties":case"geometry":return;default:e[n]=t[n]}})),e.properties=r(t.properties),e.geometry=i(t.geometry),e}function r(t){var e={};return t?(Object.keys(t).forEach((function(n){var i=t[n];"object"==typeof i?null===i?e[n]=null:Array.isArray(i)?e[n]=i.map((function(t){return t})):e[n]=r(i):e[n]=i})),e):e}function i(t){var e={type:t.type};return t.bbox&&(e.bbox=t.bbox),"GeometryCollection"===t.type?(e.geometries=t.geometries.map((function(t){return i(t)})),e):(e.coordinates=o(t.coordinates),e)}function o(t){var e=t;return"object"!=typeof e[0]?e.slice():e.map((function(t){return o(t)}))}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return n(t);case"FeatureCollection":return function(t){var e={type:"FeatureCollection"};return Object.keys(t).forEach((function(n){switch(n){case"type":case"features":return;default:e[n]=t[n]}})),e.features=t.features.map((function(t){return n(t)})),e}(t);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return i(t);default:throw new Error("unknown GeoJSON type")}}},7269:function(t){t.exports=function(){"use strict";function t(n,r,i,o,s){for(;o>i;){if(o-i>600){var a=o-i+1,l=r-i+1,u=Math.log(a),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(a-c)/a)*(l-a/2<0?-1:1);t(n,r,Math.max(i,Math.floor(r-l*c/a+h)),Math.min(o,Math.floor(r+(a-l)*c/a+h)),s)}var p=n[r],f=i,d=o;for(e(n,i,r),s(n[o],p)>0&&e(n,i,o);f<d;){for(e(n,f,d),f++,d--;s(n[f],p)<0;)f++;for(;s(n[d],p)>0;)d--}0===s(n[i],p)?e(n,i,d):e(n,++d,o),d<=r&&(i=d+1),r<=d&&(o=d-1)}}function e(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function n(t,e){return t<e?-1:t>e?1:0}return function(e,r,i,o,s){t(e,r,i||0,o||e.length-1,s||n)}}()},67:(t,e,n)=>{"use strict";t.exports=i,t.exports.default=i;var r=n(7269);function i(t,e){if(!(this instanceof i))return new i(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function o(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function s(t,e){a(t,0,t.children.length,e,t)}function a(t,e,n,r,i){i||(i=g(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o,s=e;s<n;s++)o=t.children[s],l(i,t.leaf?r(o):o);return i}function l(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function c(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function p(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function d(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function g(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function m(t,e,n,i,o){for(var s,a=[e,n];a.length;)(n=a.pop())-(e=a.pop())<=i||(s=e+Math.ceil((n-e)/i/2)*i,r(t,s,e,n,o),a.push(e,s,s,n))}i.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],r=this.toBBox;if(!d(t,e))return n;for(var i,o,s,a,l=[];e;){for(i=0,o=e.children.length;i<o;i++)s=e.children[i],d(t,a=e.leaf?r(s):s)&&(e.leaf?n.push(s):f(t,a)?this._all(s,n):l.push(s));e=l.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!d(t,e))return!1;for(var r,i,o,s,a=[];e;){for(r=0,i=e.children.length;r<i;r++)if(o=e.children[r],d(t,s=e.leaf?n(o):o)){if(e.leaf||f(t,s))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var i=this.data;this.data=r,r=i}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=g([]),this},remove:function(t,e){if(!t)return this;for(var n,r,i,s,a=this.data,l=this.toBBox(t),u=[],c=[];a||u.length;){if(a||(a=u.pop(),r=u[u.length-1],n=c.pop(),s=!0),a.leaf&&-1!==(i=o(t,a.children,e)))return a.children.splice(i,1),u.push(a),this._condense(u),this;s||a.leaf||!f(a,l)?r?(n++,a=r.children[n],s=!1):a=null:(u.push(a),c.push(n),n=0,r=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:u,compareMinY:c,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,r){var i,o=n-e+1,a=this._maxEntries;if(o<=a)return s(i=g(t.slice(e,n+1)),this.toBBox),i;r||(r=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,r-1))),(i=g([])).leaf=!1,i.height=r;var l,u,c,h,p=Math.ceil(o/a),f=p*Math.ceil(Math.sqrt(a));for(m(t,e,n,f,this.compareMinX),l=e;l<=n;l+=f)for(m(t,l,c=Math.min(l+f-1,n),p,this.compareMinY),u=l;u<=c;u+=p)h=Math.min(u+p-1,c),i.children.push(this._build(t,u,h,r-1));return s(i,this.toBBox),i},_chooseSubtree:function(t,e,n,r){for(var i,o,s,a,l,u,c,p,f,d;r.push(e),!e.leaf&&r.length-1!==n;){for(c=p=1/0,i=0,o=e.children.length;i<o;i++)l=h(s=e.children[i]),f=t,d=s,(u=(Math.max(d.maxX,f.maxX)-Math.min(d.minX,f.minX))*(Math.max(d.maxY,f.maxY)-Math.min(d.minY,f.minY))-l)<p?(p=u,c=l<c?l:c,a=s):u===p&&l<c&&(c=l,a=s);e=a||e.children[0]}return e},_insert:function(t,e,n){var r=this.toBBox,i=n?t:r(t),o=[],s=this._chooseSubtree(i,this.data,e,o);for(s.children.push(t),l(s,i);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(i,o,e)},_split:function(t,e){var n=t[e],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var o=this._chooseSplitIndex(n,i,r),a=g(n.children.splice(o,n.children.length-o));a.height=n.height,a.leaf=n.leaf,s(n,this.toBBox),s(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},_splitRoot:function(t,e){this.data=g([t,e]),this.data.height=t.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var r,i,o,s,l,u,c,p,f,d,g,m,A,y;for(u=c=1/0,r=e;r<=n-e;r++)f=i=a(t,0,r,this.toBBox),d=o=a(t,r,n,this.toBBox),void 0,void 0,void 0,void 0,g=Math.max(f.minX,d.minX),m=Math.max(f.minY,d.minY),A=Math.min(f.maxX,d.maxX),y=Math.min(f.maxY,d.maxY),s=Math.max(0,A-g)*Math.max(0,y-m),l=h(i)+h(o),s<u?(u=s,p=r,c=l<c?l:c):s===u&&l<c&&(c=l,p=r);return p},_chooseSplitAxis:function(t,e,n){var r=t.leaf?this.compareMinX:u,i=t.leaf?this.compareMinY:c;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)},_allDistMargin:function(t,e,n,r){t.children.sort(r);var i,o,s=this.toBBox,u=a(t,0,e,s),c=a(t,n-e,n,s),h=p(u)+p(c);for(i=e;i<n-e;i++)o=t.children[i],l(u,t.leaf?s(o):o),h+=p(u);for(i=n-e-1;i>=e;i--)o=t.children[i],l(c,t.leaf?s(o):o),h+=p(c);return h},_adjustParentBBoxes:function(t,e,n){for(var r=n;r>=0;r--)l(e[r],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():s(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},3737:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4102),i=n(611);e.default=function(t,e,n,o){void 0===o&&(o={});var s=i.getCoord(t),a=r.degreesToRadians(s[0]),l=r.degreesToRadians(s[1]),u=r.degreesToRadians(n),c=r.lengthToRadians(e,o.units),h=Math.asin(Math.sin(l)*Math.cos(c)+Math.cos(l)*Math.sin(c)*Math.cos(u)),p=a+Math.atan2(Math.sin(u)*Math.sin(c)*Math.cos(l),Math.cos(c)-Math.sin(l)*Math.sin(h)),f=r.radiansToDegrees(p),d=r.radiansToDegrees(h);return r.point([f,d],o.properties)}},8727:(t,e,n)=>{"use strict";var r=n(2676),i=n(4102),o=n(611);function s(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var a=s(r);function l(t,e){var n=o.getGeom(t),r=o.getGeom(e),s=t.properties||{},l=a.default.difference(n.coordinates,r.coordinates);return 0===l.length?null:1===l.length?i.polygon(l[0],s):i.multiPolygon(l,s)}t.exports=l,t.exports.default=l},1013:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(611),i=n(4102);e.default=function(t,e,n){void 0===n&&(n={});var o=r.getCoord(t),s=r.getCoord(e),a=i.degreesToRadians(s[1]-o[1]),l=i.degreesToRadians(s[0]-o[0]),u=i.degreesToRadians(o[1]),c=i.degreesToRadians(s[1]),h=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(l/2),2)*Math.cos(u)*Math.cos(c);return i.radiansToLength(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)),n.units)}},1211:(t,e,n)=>{"use strict";var r=n(4102),i=n(2054),o=n(7460),s=n(611);function a(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var l=a(i),u=a(o);function c(t,e,n,i){var o=(i=i||{}).steps||64,a=i.units||"kilometers",c=i.angle||0,p=i.pivot||t,f=i.properties||t.properties||{};if(!t)throw new Error("center is required");if(!e)throw new Error("xSemiAxis is required");if(!n)throw new Error("ySemiAxis is required");if(!r.isObject(i))throw new Error("options must be an object");if(!r.isNumber(o))throw new Error("steps must be a number");if(!r.isNumber(c))throw new Error("angle must be a number");var d=s.getCoord(t);if("degrees"===a)var g=r.degreesToRadians(c);else e=l.default(t,e,90,{units:a}),n=l.default(t,n,0,{units:a}),e=s.getCoord(e)[0]-d[0],n=s.getCoord(n)[1]-d[1];for(var m=[],A=0;A<o;A+=1){var y=-360*A/o,_=e*n/Math.sqrt(Math.pow(n,2)+Math.pow(e,2)*Math.pow(h(y),2)),v=e*n/Math.sqrt(Math.pow(e,2)+Math.pow(n,2)/Math.pow(h(y),2));if(y<-90&&y>=-270&&(_=-_),y<-180&&y>=-360&&(v=-v),"degrees"===a){var b=_*Math.cos(g)+v*Math.sin(g),x=v*Math.cos(g)-_*Math.sin(g);_=b,v=x}m.push([_+d[0],v+d[1]])}return m.push(m[0]),"degrees"===a?r.polygon([m],f):u.default(r.polygon([m],f),c,{pivot:p})}function h(t){var e=t*Math.PI/180;return Math.tan(e)}t.exports=c,t.exports.default=c},4102:(t,e)=>{"use strict";function n(t,e,n){void 0===n&&(n={});var r={type:"Feature"};return(0===n.id||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function r(t,e,r){if(void 0===r&&(r={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!f(t[0])||!f(t[1]))throw new Error("coordinates must contain numbers");return n({type:"Point",coordinates:t},e,r)}function i(t,e,r){void 0===r&&(r={});for(var i=0,o=t;i<o.length;i++){var s=o[i];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return n({type:"Polygon",coordinates:t},e,r)}function o(t,e,r){if(void 0===r&&(r={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return n({type:"LineString",coordinates:t},e,r)}function s(t,e){void 0===e&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function a(t,e,r){return void 0===r&&(r={}),n({type:"MultiLineString",coordinates:t},e,r)}function l(t,e,r){return void 0===r&&(r={}),n({type:"MultiPoint",coordinates:t},e,r)}function u(t,e,r){return void 0===r&&(r={}),n({type:"MultiPolygon",coordinates:t},e,r)}function c(t,n){void 0===n&&(n="kilometers");var r=e.factors[n];if(!r)throw new Error(n+" units is invalid");return t*r}function h(t,n){void 0===n&&(n="kilometers");var r=e.factors[n];if(!r)throw new Error(n+" units is invalid");return t/r}function p(t){return t%(2*Math.PI)*180/Math.PI}function f(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=6371008.8,e.factors={centimeters:100*e.earthRadius,centimetres:100*e.earthRadius,degrees:e.earthRadius/111325,feet:3.28084*e.earthRadius,inches:39.37*e.earthRadius,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:1e3*e.earthRadius,millimetres:1e3*e.earthRadius,nauticalmiles:e.earthRadius/1852,radians:1,yards:1.0936*e.earthRadius},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1.0936133},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},e.feature=n,e.geometry=function(t,e,n){switch(void 0===n&&(n={}),t){case"Point":return r(e).geometry;case"LineString":return o(e).geometry;case"Polygon":return i(e).geometry;case"MultiPoint":return l(e).geometry;case"MultiLineString":return a(e).geometry;case"MultiPolygon":return u(e).geometry;default:throw new Error(t+" is invalid")}},e.point=r,e.points=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return r(t,e)})),n)},e.polygon=i,e.polygons=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return i(t,e)})),n)},e.lineString=o,e.lineStrings=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return o(t,e)})),n)},e.featureCollection=s,e.multiLineString=a,e.multiPoint=l,e.multiPolygon=u,e.geometryCollection=function(t,e,r){return void 0===r&&(r={}),n({type:"GeometryCollection",geometries:t},e,r)},e.round=function(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n},e.radiansToLength=c,e.lengthToRadians=h,e.lengthToDegrees=function(t,e){return p(h(t,e))},e.bearingToAzimuth=function(t){var e=t%360;return e<0&&(e+=360),e},e.radiansToDegrees=p,e.degreesToRadians=function(t){return t%360*Math.PI/180},e.convertLength=function(t,e,n){if(void 0===e&&(e="kilometers"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("length must be a positive number");return c(h(t,e),n)},e.convertArea=function(t,n,r){if(void 0===n&&(n="meters"),void 0===r&&(r="kilometers"),!(t>=0))throw new Error("area must be a positive number");var i=e.areaFactors[n];if(!i)throw new Error("invalid original units");var o=e.areaFactors[r];if(!o)throw new Error("invalid final units");return t/i*o},e.isNumber=f,e.isObject=function(t){return!!t&&t.constructor===Object},e.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!f(t))throw new Error("bbox must only contain numbers")}))},e.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}},4170:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=n(4102),o=n(611),s=r(n(2676));e.default=function(t,e,n){void 0===n&&(n={});var r=o.getGeom(t),a=o.getGeom(e),l=s.default.intersection(r.coordinates,a.coordinates);return 0===l.length?null:1===l.length?i.polygon(l[0],n.properties):i.multiPolygon(l,n.properties)}},611:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4102);e.getCoord=function(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")},e.getCoords=function(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")},e.containsNumber=function t(e){if(e.length>1&&r.isNumber(e[0])&&r.isNumber(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return t(e[0]);throw new Error("coordinates must only contain numbers")},e.geojsonType=function(t,e,n){if(!e||!n)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.type)},e.featureOf=function(t,e,n){if(!t)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)},e.collectionOf=function(t,e,n){if(!t)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+n+", FeatureCollection required");for(var r=0,i=t.features;r<i.length;r++){var o=i[r];if(!o||"Feature"!==o.type||!o.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!o.geometry||o.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+o.geometry.type)}},e.getGeom=function(t){return"Feature"===t.type?t.geometry:t},e.getType=function(t,e){return"FeatureCollection"===t.type?"FeatureCollection":"GeometryCollection"===t.type?"GeometryCollection":"Feature"===t.type&&null!==t.geometry?t.geometry.type:t.type}},3663:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=n(4102),o=n(611),s=r(n(4590)),a=n(1540),l=r(n(1787));function u(t,e){var n=o.getCoords(t),r=o.getCoords(e);if(2!==n.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==r.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var s=n[0][0],a=n[0][1],l=n[1][0],u=n[1][1],c=r[0][0],h=r[0][1],p=r[1][0],f=r[1][1],d=(f-h)*(l-s)-(p-c)*(u-a);if(0===d)return null;var g=((p-c)*(a-h)-(f-h)*(s-c))/d,m=((l-s)*(a-h)-(u-a)*(s-c))/d;if(g>=0&&g<=1&&m>=0&&m<=1){var A=s+g*(l-s),y=a+g*(u-a);return i.point([A,y])}return null}e.default=function(t,e){var n={},r=[];if("LineString"===t.type&&(t=i.feature(t)),"LineString"===e.type&&(e=i.feature(e)),"Feature"===t.type&&"Feature"===e.type&&null!==t.geometry&&null!==e.geometry&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length){var c=u(t,e);return c&&r.push(c),i.featureCollection(r)}var h=l.default();return h.load(s.default(e)),a.featureEach(s.default(t),(function(t){a.featureEach(h.search(t),(function(e){var i=u(t,e);if(i){var s=o.getCoords(i).join(",");n[s]||(n[s]=!0,r.push(i))}}))})),i.featureCollection(r)}},4590:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4102),i=n(611),o=n(1540);e.default=function(t){if(!t)throw new Error("geojson is required");var e=[];return o.flattenEach(t,(function(t){!function(t,e){var n=[],o=t.geometry;if(null!==o){switch(o.type){case"Polygon":n=i.getCoords(o);break;case"LineString":n=[i.getCoords(o)]}n.forEach((function(n){var i=function(t,e){var n=[];return t.reduce((function(t,i){var o,s,a,l,u,c,h=r.lineString([t,i],e);return h.bbox=(s=i,a=(o=t)[0],l=o[1],[a<(u=s[0])?a:u,l<(c=s[1])?l:c,a>u?a:u,l>c?l:c]),n.push(h),i})),n}(n,t.properties);i.forEach((function(t){t.id=e.length,e.push(t)}))}))}}(t,e)})),r.featureCollection(e)}},1540:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4102);function i(t,e,n){if(null!==t)for(var r,o,s,a,l,u,c,h,p=0,f=0,d=t.type,g="FeatureCollection"===d,m="Feature"===d,A=g?t.features.length:1,y=0;y<A;y++){l=(h=!!(c=g?t.features[y].geometry:m?t.geometry:t)&&"GeometryCollection"===c.type)?c.geometries.length:1;for(var _=0;_<l;_++){var v=0,b=0;if(null!==(a=h?c.geometries[_]:c)){u=a.coordinates;var x=a.type;switch(p=!n||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case"Point":if(!1===e(u,f,y,v,b))return!1;f++,v++;break;case"LineString":case"MultiPoint":for(r=0;r<u.length;r++){if(!1===e(u[r],f,y,v,b))return!1;f++,"MultiPoint"===x&&v++}"LineString"===x&&v++;break;case"Polygon":case"MultiLineString":for(r=0;r<u.length;r++){for(o=0;o<u[r].length-p;o++){if(!1===e(u[r][o],f,y,v,b))return!1;f++}"MultiLineString"===x&&v++,"Polygon"===x&&b++}"Polygon"===x&&v++;break;case"MultiPolygon":for(r=0;r<u.length;r++){for(b=0,o=0;o<u[r].length;o++){for(s=0;s<u[r][o].length-p;s++){if(!1===e(u[r][o][s],f,y,v,b))return!1;f++}b++}v++}break;case"GeometryCollection":for(r=0;r<a.geometries.length;r++)if(!1===i(a.geometries[r],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function o(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length&&!1!==e(t.features[n].properties,n);n++);break;case"Feature":e(t.properties,0)}}function s(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length&&!1!==e(t.features[n],n);n++);}function a(t,e){var n,r,i,o,s,a,l,u,c,h,p=0,f="FeatureCollection"===t.type,d="Feature"===t.type,g=f?t.features.length:1;for(n=0;n<g;n++){for(a=f?t.features[n].geometry:d?t.geometry:t,u=f?t.features[n].properties:d?t.properties:{},c=f?t.features[n].bbox:d?t.bbox:void 0,h=f?t.features[n].id:d?t.id:void 0,s=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,i=0;i<s;i++)if(null!==(o=l?a.geometries[i]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,p,u,c,h))return!1;break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(!1===e(o.geometries[r],p,u,c,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,p,u,c,h))return!1;p++}}function l(t,e){a(t,(function(t,n,i,o,s){var a,l=null===t?null:t.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return!1!==e(r.feature(t,i,{bbox:o,id:s}),n,0)&&void 0}switch(l){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var u=0;u<t.coordinates.length;u++){var c={type:a,coordinates:t.coordinates[u]};if(!1===e(r.feature(c,i),n,u))return!1}}))}function u(t,e){l(t,(function(t,n,o){var s=0;if(t.geometry){var a=t.geometry.type;if("Point"!==a&&"MultiPoint"!==a){var l,u=0,c=0,h=0;return!1!==i(t,(function(i,a,p,f,d){if(void 0===l||n>u||f>c||d>h)return l=i,u=n,c=f,h=d,void(s=0);var g=r.lineString([l,i],t.properties);if(!1===e(g,n,o,d,s))return!1;s++,l=i}))&&void 0}}}))}function c(t,e){if(!t)throw new Error("geojson is required");l(t,(function(t,n,i){if(null!==t.geometry){var o=t.geometry.type,s=t.geometry.coordinates;switch(o){case"LineString":if(!1===e(t,n,i,0,0))return!1;break;case"Polygon":for(var a=0;a<s.length;a++)if(!1===e(r.lineString(s[a],t.properties),n,i,a))return!1}}}))}e.coordAll=function(t){var e=[];return i(t,(function(t){e.push(t)})),e},e.coordEach=i,e.coordReduce=function(t,e,n,r){var o=n;return i(t,(function(t,r,i,s,a){o=0===r&&void 0===n?t:e(o,t,r,i,s,a)}),r),o},e.featureEach=s,e.featureReduce=function(t,e,n){var r=n;return s(t,(function(t,i){r=0===i&&void 0===n?t:e(r,t,i)})),r},e.findPoint=function(t,e){if(e=e||{},!r.isObject(e))throw new Error("options is invalid");var n,i=e.featureIndex||0,o=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.coordIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":i<0&&(i=t.features.length+i),l=l||t.features[i].properties,n=t.features[i].geometry;break;case"Feature":l=l||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var u=n.coordinates;switch(n.type){case"Point":return r.point(u,l,e);case"MultiPoint":return o<0&&(o=u.length+o),r.point(u[o],l,e);case"LineString":return a<0&&(a=u.length+a),r.point(u[a],l,e);case"Polygon":return s<0&&(s=u.length+s),a<0&&(a=u[s].length+a),r.point(u[s][a],l,e);case"MultiLineString":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a),r.point(u[o][a],l,e);case"MultiPolygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),a<0&&(a=u[o][s].length-a),r.point(u[o][s][a],l,e)}throw new Error("geojson is invalid")},e.findSegment=function(t,e){if(e=e||{},!r.isObject(e))throw new Error("options is invalid");var n,i=e.featureIndex||0,o=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.segmentIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":i<0&&(i=t.features.length+i),l=l||t.features[i].properties,n=t.features[i].geometry;break;case"Feature":l=l||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var u=n.coordinates;switch(n.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=u.length+a-1),r.lineString([u[a],u[a+1]],l,e);case"Polygon":return s<0&&(s=u.length+s),a<0&&(a=u[s].length+a-1),r.lineString([u[s][a],u[s][a+1]],l,e);case"MultiLineString":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a-1),r.lineString([u[o][a],u[o][a+1]],l,e);case"MultiPolygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),a<0&&(a=u[o][s].length-a-1),r.lineString([u[o][s][a],u[o][s][a+1]],l,e)}throw new Error("geojson is invalid")},e.flattenEach=l,e.flattenReduce=function(t,e,n){var r=n;return l(t,(function(t,i,o){r=0===i&&0===o&&void 0===n?t:e(r,t,i,o)})),r},e.geomEach=a,e.geomReduce=function(t,e,n){var r=n;return a(t,(function(t,i,o,s,a){r=0===i&&void 0===n?t:e(r,t,i,o,s,a)})),r},e.lineEach=c,e.lineReduce=function(t,e,n){var r=n;return c(t,(function(t,i,o,s){r=0===i&&void 0===n?t:e(r,t,i,o,s)})),r},e.propEach=o,e.propReduce=function(t,e,n){var r=n;return o(t,(function(t,i){r=0===i&&void 0===n?t:e(r,t,i)})),r},e.segmentEach=u,e.segmentReduce=function(t,e,n){var r=n,i=!1;return u(t,(function(t,o,s,a,l){r=!1===i&&void 0===n?t:e(r,t,o,s,a,l),i=!0})),r}},3807:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=r(n(1208)),o=r(n(1013)),s=r(n(3737)),a=r(n(3663)),l=n(1540),u=n(4102),c=n(611);e.default=function(t,e,n){void 0===n&&(n={});var r=u.point([1/0,1/0],{dist:1/0}),h=0;return l.flattenEach(t,(function(t){for(var l=c.getCoords(t),p=0;p<l.length-1;p++){var f=u.point(l[p]);f.properties.dist=o.default(e,f,n);var d=u.point(l[p+1]);d.properties.dist=o.default(e,d,n);var g=o.default(f,d,n),m=Math.max(f.properties.dist,d.properties.dist),A=i.default(f,d),y=s.default(e,m,A+90,n),_=s.default(e,m,A-90,n),v=a.default(u.lineString([y.geometry.coordinates,_.geometry.coordinates]),u.lineString([f.geometry.coordinates,d.geometry.coordinates])),b=null;v.features.length>0&&((b=v.features[0]).properties.dist=o.default(e,b,n),b.properties.location=h+o.default(f,b,n)),f.properties.dist<r.properties.dist&&((r=f).properties.index=p,r.properties.location=h),d.properties.dist<r.properties.dist&&((r=d).properties.index=p+1,r.properties.location=h+g),b&&b.properties.dist<r.properties.dist&&((r=b).properties.index=p),h+=g}})),r}},3892:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=r(n(1013)),o=n(4102),s=n(611),a=n(1540),l=r(n(6213));function u(t,e){return t[0]*e[0]+t[1]*e[1]}function c(t,e,n){return"planar"===n.method?l.default(t,e,n):i.default(t,e,n)}e.default=function(t,e,n){if(void 0===n&&(n={}),n.method||(n.method="geodesic"),n.units||(n.units="kilometers"),!t)throw new Error("pt is required");if(Array.isArray(t)?t=o.point(t):"Point"===t.type?t=o.feature(t):s.featureOf(t,"Point","point"),!e)throw new Error("line is required");Array.isArray(e)?e=o.lineString(e):"LineString"===e.type?e=o.feature(e):s.featureOf(e,"LineString","line");var r=1/0,i=t.geometry.coordinates;return a.segmentEach(e,(function(t){var e=t.geometry.coordinates[0],o=t.geometry.coordinates[1],s=function(t,e,n,r){var i=[n[0]-e[0],n[1]-e[1]],o=u([t[0]-e[0],t[1]-e[1]],i);if(o<=0)return c(t,e,{method:r.method,units:"degrees"});var s=u(i,i);if(s<=o)return c(t,n,{method:r.method,units:"degrees"});var a=o/s;return c(t,[e[0]+a*i[0],e[1]+a*i[1]],{method:r.method,units:"degrees"})}(i,e,o,n);s<r&&(r=s)})),o.convertLength(r,"degrees",n.units)}},7383:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4102),i=n(611);function o(t,e){return void 0===e&&(e={}),a(i.getGeom(t).coordinates,e.properties?e.properties:"Feature"===t.type?t.properties:{})}function s(t,e){void 0===e&&(e={});var n=i.getGeom(t).coordinates,o=e.properties?e.properties:"Feature"===t.type?t.properties:{},s=[];return n.forEach((function(t){s.push(a(t,o))})),r.featureCollection(s)}function a(t,e){return t.length>1?r.multiLineString(t,e):r.lineString(t[0],e)}e.default=function(t,e){void 0===e&&(e={});var n=i.getGeom(t);switch(e.properties||"Feature"!==t.type||(e.properties=t.properties),n.type){case"Polygon":return o(n,e);case"MultiPolygon":return s(n,e);default:throw new Error("invalid poly")}},e.polygonToLine=o,e.multiPolygonToLine=s,e.coordsToLine=a},1138:(t,e,n)=>{"use strict";var r=n(6565),i=n(3809),o=n(1540),s=n(611),a=n(4102);function l(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var u=l(r),c=l(i);function h(t,e){if(e=e||{},!a.isObject(e))throw new Error("options is invalid");var n=e.reverse||!1,r=e.mutate||!1;if(!t)throw new Error("<geojson> is required");if("boolean"!=typeof n)throw new Error("<reverse> must be a boolean");if("boolean"!=typeof r)throw new Error("<mutate> must be a boolean");!1===r&&(t=u.default(t));var i=[];switch(t.type){case"GeometryCollection":return o.geomEach(t,(function(t){p(t,n)})),t;case"FeatureCollection":return o.featureEach(t,(function(t){o.featureEach(p(t,n),(function(t){i.push(t)}))})),a.featureCollection(i)}return p(t,n)}function p(t,e){switch("Feature"===t.type?t.geometry.type:t.type){case"GeometryCollection":return o.geomEach(t,(function(t){p(t,e)})),t;case"LineString":return f(s.getCoords(t),e),t;case"Polygon":return d(s.getCoords(t),e),t;case"MultiLineString":return s.getCoords(t).forEach((function(t){f(t,e)})),t;case"MultiPolygon":return s.getCoords(t).forEach((function(t){d(t,e)})),t;case"Point":case"MultiPoint":return t}}function f(t,e){c.default(t)===e&&t.reverse()}function d(t,e){c.default(t[0])!==e&&t[0].reverse();for(var n=1;n<t.length;n++)c.default(t[n])===e&&t[n].reverse()}t.exports=h,t.exports.default=h},6912:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4102),i=n(611);function o(t,e){var n=r.degreesToRadians(t[1]),i=r.degreesToRadians(e[1]),o=r.degreesToRadians(e[0]-t[0]);o>Math.PI&&(o-=2*Math.PI),o<-Math.PI&&(o+=2*Math.PI);var s=Math.log(Math.tan(i/2+Math.PI/4)/Math.tan(n/2+Math.PI/4)),a=Math.atan2(o,s);return(r.radiansToDegrees(a)+360)%360}e.default=function(t,e,n){var r;return void 0===n&&(n={}),(r=n.final?o(i.getCoord(e),i.getCoord(t)):o(i.getCoord(t),i.getCoord(e)))>180?-(360-r):r}},2054:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4102),i=n(611);e.default=function(t,e,n,o){void 0===o&&(o={});var s=e<0,a=r.convertLength(Math.abs(e),o.units,"meters");s&&(a=-Math.abs(a));var l=i.getCoord(t),u=function(t,e,n,i){var o=e/(i=void 0===i?r.earthRadius:Number(i)),s=t[0]*Math.PI/180,a=r.degreesToRadians(t[1]),l=r.degreesToRadians(n),u=o*Math.cos(l),c=a+u;Math.abs(c)>Math.PI/2&&(c=c>0?Math.PI-c:-Math.PI-c);var h=Math.log(Math.tan(c/2+Math.PI/4)/Math.tan(a/2+Math.PI/4)),p=Math.abs(h)>1e-11?u/h:Math.cos(a);return[(180*(s+o*Math.sin(l)/p)/Math.PI+540)%360-180,180*c/Math.PI]}(l,a,n);return u[0]+=u[0]-l[0]>180?-360:l[0]-u[0]>180?360:0,r.point(u,o.properties)}},6213:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4102),i=n(611);e.default=function(t,e,n){void 0===n&&(n={});var o=i.getCoord(t),s=i.getCoord(e);s[0]+=s[0]-o[0]>180?-360:o[0]-s[0]>180?360:0;var a=function(t,e,n){var i=n=void 0===n?r.earthRadius:Number(n),o=t[1]*Math.PI/180,s=e[1]*Math.PI/180,a=s-o,l=Math.abs(e[0]-t[0])*Math.PI/180;l>Math.PI&&(l-=2*Math.PI);var u=Math.log(Math.tan(s/2+Math.PI/4)/Math.tan(o/2+Math.PI/4)),c=Math.abs(u)>1e-11?a/u:Math.cos(o);return Math.sqrt(a*a+c*c*l*l)*i}(o,s);return r.convertLength(a,"meters",n.units)}},7460:(t,e,n)=>{"use strict";var r=n(6338),i=n(6912),o=n(6213),s=n(2054),a=n(6565),l=n(1540),u=n(611),c=n(4102);function h(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var p=h(r),f=h(i),d=h(o),g=h(s),m=h(a);function A(t,e,n){if(n=n||{},!c.isObject(n))throw new Error("options is invalid");var r=n.pivot,i=n.mutate;if(!t)throw new Error("geojson is required");if(null==e||isNaN(e))throw new Error("angle is required");return 0===e||(r||(r=p.default(t)),!1!==i&&void 0!==i||(t=m.default(t)),l.coordEach(t,(function(t){var n=f.default(r,t)+e,i=d.default(r,t),o=u.getCoords(g.default(r,i,n));t[0]=o[0],t[1]=o[1]}))),t}t.exports=A,t.exports.default=A},7517:(t,e,n)=>{"use strict";var r=n(6565),i=n(8230),o=n(6338),s=n(9705),a=n(6912),l=n(6213),u=n(2054),c=n(1540),h=n(4102),p=n(611);function f(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var d=f(r),g=f(i),m=f(o),A=f(s),y=f(a),_=f(l),v=f(u);function b(t,e,n){if(n=n||{},!h.isObject(n))throw new Error("options is invalid");var r=n.origin,i=n.mutate;if(!t)throw new Error("geojson required");if("number"!=typeof e||0===e)throw new Error("invalid factor");var o=Array.isArray(r)||"object"==typeof r;return!0!==i&&(t=d.default(t)),"FeatureCollection"!==t.type||o?x(t,e,r):(c.featureEach(t,(function(n,i){t.features[i]=x(n,e,r)})),t)}function x(t,e,n){var r="Point"===p.getType(t);return n=function(t,e){if(null==e&&(e="centroid"),Array.isArray(e)||"object"==typeof e)return p.getCoord(e);var n=t.bbox?t.bbox:A.default(t),r=n[0],i=n[1],o=n[2],s=n[3];switch(e){case"sw":case"southwest":case"westsouth":case"bottomleft":return h.point([r,i]);case"se":case"southeast":case"eastsouth":case"bottomright":return h.point([o,i]);case"nw":case"northwest":case"westnorth":case"topleft":return h.point([r,s]);case"ne":case"northeast":case"eastnorth":case"topright":return h.point([o,s]);case"center":return g.default(t);case void 0:case null:case"centroid":return m.default(t);default:throw new Error("invalid origin")}}(t,n),1===e||r||c.coordEach(t,(function(t){var r=_.default(n,t),i=y.default(n,t),o=r*e,s=p.getCoords(v.default(n,o,i));t[0]=s[0],t[1]=s[1],3===t.length&&(t[2]*=e)})),t}t.exports=b,t.exports.default=b},2418:(t,e,n)=>{"use strict";var r=n(1540),i=n(4102),o=n(611),s=n(6565),a=n(2054);function l(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var u=l(s),c=l(a);function h(t,e,n,s){if(s=s||{},!i.isObject(s))throw new Error("options is invalid");var a=s.units,l=s.zTranslation,h=s.mutate;if(!t)throw new Error("geojson is required");if(null==e||isNaN(e))throw new Error("distance is required");if(l&&"number"!=typeof l&&isNaN(l))throw new Error("zTranslation is not a number");if(l=void 0!==l?l:0,0===e&&0===l)return t;if(null==n||isNaN(n))throw new Error("direction is required");return e<0&&(e=-e,n+=180),!1!==h&&void 0!==h||(t=u.default(t)),r.coordEach(t,(function(t){var r=o.getCoords(c.default(t,e,n,{units:a}));t[0]=r[0],t[1]=r[1],l&&3===t.length&&(t[2]+=l)})),t}t.exports=h,t.exports.default=h},1959:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=r(n(2676)),o=n(611),s=n(4102);e.default=function(t,e,n){void 0===n&&(n={});var r=o.getGeom(t),a=o.getGeom(e),l=i.default.union(r.coordinates,a.coordinates);return 0===l.length?null:1===l.length?s.polygon(l[0],n.properties):s.multiPolygon(l,n.properties)}},9538:function(t){t.exports=function(){"use strict";function t(n,r,i,o,s){for(;o>i;){if(o-i>600){var a=o-i+1,l=r-i+1,u=Math.log(a),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(a-c)/a)*(l-a/2<0?-1:1);t(n,r,Math.max(i,Math.floor(r-l*c/a+h)),Math.min(o,Math.floor(r+(a-l)*c/a+h)),s)}var p=n[r],f=i,d=o;for(e(n,i,r),s(n[o],p)>0&&e(n,i,o);f<d;){for(e(n,f,d),f++,d--;s(n[f],p)<0;)f++;for(;s(n[d],p)>0;)d--}0===s(n[i],p)?e(n,i,d):e(n,++d,o),d<=r&&(i=d+1),r<=d&&(o=d-1)}}function e(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function n(t,e){return t<e?-1:t>e?1:0}return function(e,r,i,o,s){t(e,r,i||0,o||e.length-1,s||n)}}()},4860:(t,e,n)=>{"use strict";t.exports=i,t.exports.default=i;var r=n(9538);function i(t,e){if(!(this instanceof i))return new i(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function o(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function s(t,e){a(t,0,t.children.length,e,t)}function a(t,e,n,r,i){i||(i=g(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o,s=e;s<n;s++)o=t.children[s],l(i,t.leaf?r(o):o);return i}function l(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function c(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function p(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function d(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function g(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function m(t,e,n,i,o){for(var s,a=[e,n];a.length;)(n=a.pop())-(e=a.pop())<=i||(s=e+Math.ceil((n-e)/i/2)*i,r(t,s,e,n,o),a.push(e,s,s,n))}i.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],r=this.toBBox;if(!d(t,e))return n;for(var i,o,s,a,l=[];e;){for(i=0,o=e.children.length;i<o;i++)s=e.children[i],d(t,a=e.leaf?r(s):s)&&(e.leaf?n.push(s):f(t,a)?this._all(s,n):l.push(s));e=l.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!d(t,e))return!1;for(var r,i,o,s,a=[];e;){for(r=0,i=e.children.length;r<i;r++)if(o=e.children[r],d(t,s=e.leaf?n(o):o)){if(e.leaf||f(t,s))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var i=this.data;this.data=r,r=i}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=g([]),this},remove:function(t,e){if(!t)return this;for(var n,r,i,s,a=this.data,l=this.toBBox(t),u=[],c=[];a||u.length;){if(a||(a=u.pop(),r=u[u.length-1],n=c.pop(),s=!0),a.leaf&&-1!==(i=o(t,a.children,e)))return a.children.splice(i,1),u.push(a),this._condense(u),this;s||a.leaf||!f(a,l)?r?(n++,a=r.children[n],s=!1):a=null:(u.push(a),c.push(n),n=0,r=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:u,compareMinY:c,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,r){var i,o=n-e+1,a=this._maxEntries;if(o<=a)return s(i=g(t.slice(e,n+1)),this.toBBox),i;r||(r=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,r-1))),(i=g([])).leaf=!1,i.height=r;var l,u,c,h,p=Math.ceil(o/a),f=p*Math.ceil(Math.sqrt(a));for(m(t,e,n,f,this.compareMinX),l=e;l<=n;l+=f)for(m(t,l,c=Math.min(l+f-1,n),p,this.compareMinY),u=l;u<=c;u+=p)h=Math.min(u+p-1,c),i.children.push(this._build(t,u,h,r-1));return s(i,this.toBBox),i},_chooseSubtree:function(t,e,n,r){for(var i,o,s,a,l,u,c,p,f,d;r.push(e),!e.leaf&&r.length-1!==n;){for(c=p=1/0,i=0,o=e.children.length;i<o;i++)l=h(s=e.children[i]),f=t,d=s,(u=(Math.max(d.maxX,f.maxX)-Math.min(d.minX,f.minX))*(Math.max(d.maxY,f.maxY)-Math.min(d.minY,f.minY))-l)<p?(p=u,c=l<c?l:c,a=s):u===p&&l<c&&(c=l,a=s);e=a||e.children[0]}return e},_insert:function(t,e,n){var r=this.toBBox,i=n?t:r(t),o=[],s=this._chooseSubtree(i,this.data,e,o);for(s.children.push(t),l(s,i);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(i,o,e)},_split:function(t,e){var n=t[e],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var o=this._chooseSplitIndex(n,i,r),a=g(n.children.splice(o,n.children.length-o));a.height=n.height,a.leaf=n.leaf,s(n,this.toBBox),s(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},_splitRoot:function(t,e){this.data=g([t,e]),this.data.height=t.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var r,i,o,s,l,u,c,p,f,d,g,m,A,y;for(u=c=1/0,r=e;r<=n-e;r++)f=i=a(t,0,r,this.toBBox),d=o=a(t,r,n,this.toBBox),void 0,void 0,void 0,void 0,g=Math.max(f.minX,d.minX),m=Math.max(f.minY,d.minY),A=Math.min(f.maxX,d.maxX),y=Math.min(f.maxY,d.maxY),s=Math.max(0,A-g)*Math.max(0,y-m),l=h(i)+h(o),s<u?(u=s,p=r,c=l<c?l:c):s===u&&l<c&&(c=l,p=r);return p},_chooseSplitAxis:function(t,e,n){var r=t.leaf?this.compareMinX:u,i=t.leaf?this.compareMinY:c;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)},_allDistMargin:function(t,e,n,r){t.children.sort(r);var i,o,s=this.toBBox,u=a(t,0,e,s),c=a(t,n-e,n,s),h=p(u)+p(c);for(i=e;i<n-e;i++)o=t.children[i],l(u,t.leaf?s(o):o),h+=p(u);for(i=n-e-1;i>=e;i--)o=t.children[i],l(c,t.leaf?s(o):o),h+=p(c);return h},_adjustParentBBoxes:function(t,e,n){for(var r=n;r>=0;r--)l(e[r],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():s(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},1924:(t,e,n)=>{"use strict";var r=n(210),i=n(5559),o=i(r("String.prototype.indexOf"));t.exports=function(t,e){var n=r(t,!!e);return"function"==typeof n&&o(t,".prototype.")>-1?i(n):n}},5559:(t,e,n)=>{"use strict";var r=n(8612),i=n(210),o=i("%Function.prototype.apply%"),s=i("%Function.prototype.call%"),a=i("%Reflect.apply%",!0)||r.call(s,o),l=i("%Object.getOwnPropertyDescriptor%",!0),u=i("%Object.defineProperty%",!0),c=i("%Math.max%");if(u)try{u({},"a",{value:1})}catch(t){u=null}t.exports=function(t){var e=a(r,s,arguments);if(l&&u){var n=l(e,"length");n.configurable&&u(e,"length",{value:1+c(0,t.length-(arguments.length-1))})}return e};var h=function(){return a(r,o,arguments)};u?u(t.exports,"apply",{value:h}):t.exports.apply=h},2273:(t,e,n)=>{"use strict";var r=n(2582),i=n(3842),o=n(6960),s=n(8639).orient2d;function a(t,e,n){e=Math.max(0,void 0===e?2:e),n=n||0;var i=function(t){for(var e=t[0],n=t[0],r=t[0],i=t[0],s=0;s<t.length;s++){var a=t[s];a[0]<e[0]&&(e=a),a[0]>r[0]&&(r=a),a[1]<n[1]&&(n=a),a[1]>i[1]&&(i=a)}var l=[e,n,r,i],u=l.slice();for(s=0;s<t.length;s++)o(t[s],l)||u.push(t[s]);return function(t){t.sort(_);for(var e=[],n=0;n<t.length;n++){for(;e.length>=2&&f(e[e.length-2],e[e.length-1],t[n])<=0;)e.pop();e.push(t[n])}for(var r=[],i=t.length-1;i>=0;i--){for(;r.length>=2&&f(r[r.length-2],r[r.length-1],t[i])<=0;)r.pop();r.push(t[i])}return r.pop(),e.pop(),e.concat(r)}(u)}(t),s=new r(16);s.toBBox=function(t){return{minX:t[0],minY:t[1],maxX:t[0],maxY:t[1]}},s.compareMinX=function(t,e){return t[0]-e[0]},s.compareMinY=function(t,e){return t[1]-e[1]},s.load(t);for(var a,u=[],c=0;c<i.length;c++){var h=i[c];s.remove(h),a=g(h,a),u.push(a)}var p=new r(16);for(c=0;c<u.length;c++)p.insert(d(u[c]));for(var A=e*e,y=n*n;u.length;){var v=u.shift(),b=v.p,x=v.next.p,w=m(b,x);if(!(w<y)){var E=w/A;(h=l(s,v.prev.p,b,x,v.next.next.p,E,p))&&Math.min(m(h,b),m(h,x))<=E&&(u.push(v),u.push(g(h,v)),s.remove(h),p.remove(v),p.insert(d(v)),p.insert(d(v.next)))}}v=a;var S=[];do{S.push(v.p),v=v.next}while(v!==a);return S.push(v.p),S}function l(t,e,n,r,o,s,a){for(var l=new i([],u),h=t.data;h;){for(var f=0;f<h.children.length;f++){var d=h.children[f],g=h.leaf?A(d,n,r):c(n,r,d);g>s||l.push({node:d,dist:g})}for(;l.length&&!l.peek().node.children;){var m=l.pop(),y=m.node,_=A(y,e,n),v=A(y,r,o);if(m.dist<_&&m.dist<v&&p(n,y,a)&&p(r,y,a))return y}(h=l.pop())&&(h=h.node)}return null}function u(t,e){return t.dist-e.dist}function c(t,e,n){if(h(t,n)||h(e,n))return 0;var r=y(t[0],t[1],e[0],e[1],n.minX,n.minY,n.maxX,n.minY);if(0===r)return 0;var i=y(t[0],t[1],e[0],e[1],n.minX,n.minY,n.minX,n.maxY);if(0===i)return 0;var o=y(t[0],t[1],e[0],e[1],n.maxX,n.minY,n.maxX,n.maxY);if(0===o)return 0;var s=y(t[0],t[1],e[0],e[1],n.minX,n.maxY,n.maxX,n.maxY);return 0===s?0:Math.min(r,i,o,s)}function h(t,e){return t[0]>=e.minX&&t[0]<=e.maxX&&t[1]>=e.minY&&t[1]<=e.maxY}function p(t,e,n){for(var r,i,o,s,a=Math.min(t[0],e[0]),l=Math.min(t[1],e[1]),u=Math.max(t[0],e[0]),c=Math.max(t[1],e[1]),h=n.search({minX:a,minY:l,maxX:u,maxY:c}),p=0;p<h.length;p++)if(r=h[p].p,i=h[p].next.p,o=t,r!==(s=e)&&i!==o&&f(r,i,o)>0!=f(r,i,s)>0&&f(o,s,r)>0!=f(o,s,i)>0)return!1;return!0}function f(t,e,n){return s(t[0],t[1],e[0],e[1],n[0],n[1])}function d(t){var e=t.p,n=t.next.p;return t.minX=Math.min(e[0],n[0]),t.minY=Math.min(e[1],n[1]),t.maxX=Math.max(e[0],n[0]),t.maxY=Math.max(e[1],n[1]),t}function g(t,e){var n={p:t,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return e?(n.next=e.next,n.prev=e,e.next.prev=n,e.next=n):(n.prev=n,n.next=n),n}function m(t,e){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r}function A(t,e,n){var r=e[0],i=e[1],o=n[0]-r,s=n[1]-i;if(0!==o||0!==s){var a=((t[0]-r)*o+(t[1]-i)*s)/(o*o+s*s);a>1?(r=n[0],i=n[1]):a>0&&(r+=o*a,i+=s*a)}return(o=t[0]-r)*o+(s=t[1]-i)*s}function y(t,e,n,r,i,o,s,a){var l,u,c,h,p=n-t,f=r-e,d=s-i,g=a-o,m=t-i,A=e-o,y=p*p+f*f,_=p*d+f*g,v=d*d+g*g,b=p*m+f*A,x=d*m+g*A,w=y*v-_*_,E=w,S=w;0===w?(u=0,E=1,h=x,S=v):(h=y*x-_*b,(u=_*x-v*b)<0?(u=0,h=x,S=v):u>E&&(u=E,h=x+_,S=v)),h<0?(h=0,-b<0?u=0:-b>y?u=E:(u=-b,E=y)):h>S&&(h=S,-b+_<0?u=0:-b+_>y?u=E:(u=-b+_,E=y));var T=(1-(c=0===h?0:h/S))*i+c*s-((1-(l=0===u?0:u/E))*t+l*n),P=(1-c)*o+c*a-((1-l)*e+l*r);return T*T+P*P}function _(t,e){return t[0]===e[0]?t[1]-e[1]:t[0]-e[0]}i.default&&(i=i.default),t.exports=a,t.exports.default=a},4120:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(7537),i=n.n(r),o=n(3645),s=n.n(o)()(i());s.push([t.id,"html, body {\n    width: 100vw;\n    height: 100vh;\n    padding: 0;\n    margin: 0;\n}\n\n#app {\n    width: 99%;\n    height: 99%;\n}\n\n#deckgl-wrapper {\n    overflow: hidden;\n}","",{version:3,sources:["webpack://./src/App.css"],names:[],mappings:"AAAA;IACI,YAAY;IACZ,aAAa;IACb,UAAU;IACV,SAAS;AACb;;AAEA;IACI,UAAU;IACV,WAAW;AACf;;AAEA;IACI,gBAAgB;AACpB",sourcesContent:["html, body {\n    width: 100vw;\n    height: 100vh;\n    padding: 0;\n    margin: 0;\n}\n\n#app {\n    width: 99%;\n    height: 99%;\n}\n\n#deckgl-wrapper {\n    overflow: hidden;\n}"],sourceRoot:""}]);const a=s},3645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",r=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),r&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),r&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,r,i,o){"string"==typeof t&&(t=[[null,t,void 0]]);var s={};if(r)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(s[l]=!0)}for(var u=0;u<t.length;u++){var c=[].concat(t[u]);r&&s[c[0]]||(void 0!==o&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=o),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),i&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=i):c[4]="".concat(i)),e.push(c))}},e}},7537:t=>{"use strict";t.exports=function(t){var e=t[1],n=t[3];if(!n)return e;if("function"==typeof btoa){var r=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),o="/*# ".concat(i," */"),s=n.sources.map((function(t){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(t," */")}));return[e].concat(s).concat([o]).join("\n")}return[e].join("\n")}},1621:(t,e,n)=>{"use strict";function r(){return new i}function i(){this.reset()}n.r(e),n.d(e,{geoAlbers:()=>br,geoAlbersUsa:()=>xr,geoArea:()=>X,geoAzimuthalEqualArea:()=>Tr,geoAzimuthalEqualAreaRaw:()=>Sr,geoAzimuthalEquidistant:()=>Mr,geoAzimuthalEquidistantRaw:()=>Pr,geoBounds:()=>jt,geoCentroid:()=>te,geoCircle:()=>he,geoClipExtent:()=>Ee,geoConicConformal:()=>kr,geoConicConformalRaw:()=>Lr,geoConicEqualArea:()=>vr,geoConicEqualAreaRaw:()=>_r,geoConicEquidistant:()=>Br,geoConicEquidistantRaw:()=>Fr,geoContains:()=>He,geoDistance:()=>Be,geoEquirectangular:()=>Nr,geoEquirectangularRaw:()=>Dr,geoGnomonic:()=>jr,geoGnomonicRaw:()=>zr,geoGraticule:()=>Ye,geoGraticule10:()=>Qe,geoIdentity:()=>Vr,geoInterpolate:()=>Ke,geoLength:()=>De,geoMercator:()=>Ir,geoMercatorRaw:()=>Cr,geoNaturalEarth1:()=>Zr,geoNaturalEarth1Raw:()=>Gr,geoOrthographic:()=>Wr,geoOrthographicRaw:()=>qr,geoPath:()=>nr,geoProjection:()=>mr,geoProjectionMutator:()=>Ar,geoRotation:()=>le,geoStereographic:()=>Xr,geoStereographicRaw:()=>Hr,geoStream:()=>D,geoTransform:()=>lr,geoTransverseMercator:()=>Yr,geoTransverseMercatorRaw:()=>$r}),i.prototype={constructor:i,reset:function(){this.s=this.t=0},add:function(t){s(o,t,this.t),s(this,o.s,this.s),this.s?this.t+=o.t:this.s=o.t},valueOf:function(){return this.s}};var o=new i;function s(t,e,n){var r=t.s=e+n,i=r-e,o=r-i;t.t=e-o+(n-i)}var a=1e-6,l=Math.PI,u=l/2,c=l/4,h=2*l,p=180/l,f=l/180,d=Math.abs,g=Math.atan,m=Math.atan2,A=Math.cos,y=Math.ceil,_=Math.exp,v=(Math.floor,Math.log),b=Math.pow,x=Math.sin,w=Math.sign||function(t){return t>0?1:t<0?-1:0},E=Math.sqrt,S=Math.tan;function T(t){return t>1?0:t<-1?l:Math.acos(t)}function P(t){return t>1?u:t<-1?-u:Math.asin(t)}function M(t){return(t=x(t/2))*t}function C(){}function I(t,e){t&&R.hasOwnProperty(t.type)&&R[t.type](t,e)}var O={Feature:function(t,e){I(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)I(n[r].geometry,e)}},R={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){L(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)L(n[r],e,0)},Polygon:function(t,e){k(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)k(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)I(n[r],e)}};function L(t,e,n){var r,i=-1,o=t.length-n;for(e.lineStart();++i<o;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function k(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)L(t[n],e,1);e.polygonEnd()}function D(t,e){t&&O.hasOwnProperty(t.type)?O[t.type](t,e):I(t,e)}var N,F,B,z,j,U=r(),V=r(),G={point:C,lineStart:C,lineEnd:C,polygonStart:function(){U.reset(),G.lineStart=Z,G.lineEnd=q},polygonEnd:function(){var t=+U;V.add(t<0?h+t:t),this.lineStart=this.lineEnd=this.point=C},sphere:function(){V.add(h)}};function Z(){G.point=W}function q(){H(N,F)}function W(t,e){G.point=H,N=t,F=e,B=t*=f,z=A(e=(e*=f)/2+c),j=x(e)}function H(t,e){var n=(t*=f)-B,r=n>=0?1:-1,i=r*n,o=A(e=(e*=f)/2+c),s=x(e),a=j*s,l=z*o+a*A(i),u=a*r*x(i);U.add(m(u,l)),B=t,z=o,j=s}function X(t){return V.reset(),D(t,G),2*V}function $(t){return[m(t[1],t[0]),P(t[2])]}function Y(t){var e=t[0],n=t[1],r=A(n);return[r*A(e),r*x(e),x(n)]}function Q(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function K(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function J(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function tt(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function et(t){var e=E(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var nt,rt,it,ot,st,at,lt,ut,ct,ht,pt,ft,dt,gt,mt,At,yt,_t,vt,bt,xt,wt,Et,St,Tt,Pt,Mt=r(),Ct={point:It,lineStart:Rt,lineEnd:Lt,polygonStart:function(){Ct.point=kt,Ct.lineStart=Dt,Ct.lineEnd=Nt,Mt.reset(),G.polygonStart()},polygonEnd:function(){G.polygonEnd(),Ct.point=It,Ct.lineStart=Rt,Ct.lineEnd=Lt,U<0?(nt=-(it=180),rt=-(ot=90)):Mt>a?ot=90:Mt<-a&&(rt=-90),ht[0]=nt,ht[1]=it}};function It(t,e){ct.push(ht=[nt=t,it=t]),e<rt&&(rt=e),e>ot&&(ot=e)}function Ot(t,e){var n=Y([t*f,e*f]);if(ut){var r=K(ut,n),i=K([r[1],-r[0],0],r);et(i),i=$(i);var o,s=t-st,a=s>0?1:-1,l=i[0]*p*a,u=d(s)>180;u^(a*st<l&&l<a*t)?(o=i[1]*p)>ot&&(ot=o):u^(a*st<(l=(l+360)%360-180)&&l<a*t)?(o=-i[1]*p)<rt&&(rt=o):(e<rt&&(rt=e),e>ot&&(ot=e)),u?t<st?Ft(nt,t)>Ft(nt,it)&&(it=t):Ft(t,it)>Ft(nt,it)&&(nt=t):it>=nt?(t<nt&&(nt=t),t>it&&(it=t)):t>st?Ft(nt,t)>Ft(nt,it)&&(it=t):Ft(t,it)>Ft(nt,it)&&(nt=t)}else ct.push(ht=[nt=t,it=t]);e<rt&&(rt=e),e>ot&&(ot=e),ut=n,st=t}function Rt(){Ct.point=Ot}function Lt(){ht[0]=nt,ht[1]=it,Ct.point=It,ut=null}function kt(t,e){if(ut){var n=t-st;Mt.add(d(n)>180?n+(n>0?360:-360):n)}else at=t,lt=e;G.point(t,e),Ot(t,e)}function Dt(){G.lineStart()}function Nt(){kt(at,lt),G.lineEnd(),d(Mt)>a&&(nt=-(it=180)),ht[0]=nt,ht[1]=it,ut=null}function Ft(t,e){return(e-=t)<0?e+360:e}function Bt(t,e){return t[0]-e[0]}function zt(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}function jt(t){var e,n,r,i,o,s,a;if(ot=it=-(nt=rt=1/0),ct=[],D(t,Ct),n=ct.length){for(ct.sort(Bt),e=1,o=[r=ct[0]];e<n;++e)zt(r,(i=ct[e])[0])||zt(r,i[1])?(Ft(r[0],i[1])>Ft(r[0],r[1])&&(r[1]=i[1]),Ft(i[0],r[1])>Ft(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(s=-1/0,e=0,r=o[n=o.length-1];e<=n;r=i,++e)i=o[e],(a=Ft(r[1],i[0]))>s&&(s=a,nt=i[0],it=r[1])}return ct=ht=null,nt===1/0||rt===1/0?[[NaN,NaN],[NaN,NaN]]:[[nt,rt],[it,ot]]}var Ut,Vt,Gt={sphere:C,point:Zt,lineStart:Wt,lineEnd:$t,polygonStart:function(){Gt.lineStart=Yt,Gt.lineEnd=Qt},polygonEnd:function(){Gt.lineStart=Wt,Gt.lineEnd=$t}};function Zt(t,e){t*=f;var n=A(e*=f);qt(n*A(t),n*x(t),x(e))}function qt(t,e,n){++pt,dt+=(t-dt)/pt,gt+=(e-gt)/pt,mt+=(n-mt)/pt}function Wt(){Gt.point=Ht}function Ht(t,e){t*=f;var n=A(e*=f);St=n*A(t),Tt=n*x(t),Pt=x(e),Gt.point=Xt,qt(St,Tt,Pt)}function Xt(t,e){t*=f;var n=A(e*=f),r=n*A(t),i=n*x(t),o=x(e),s=m(E((s=Tt*o-Pt*i)*s+(s=Pt*r-St*o)*s+(s=St*i-Tt*r)*s),St*r+Tt*i+Pt*o);ft+=s,At+=s*(St+(St=r)),yt+=s*(Tt+(Tt=i)),_t+=s*(Pt+(Pt=o)),qt(St,Tt,Pt)}function $t(){Gt.point=Zt}function Yt(){Gt.point=Kt}function Qt(){Jt(wt,Et),Gt.point=Zt}function Kt(t,e){wt=t,Et=e,t*=f,e*=f,Gt.point=Jt;var n=A(e);St=n*A(t),Tt=n*x(t),Pt=x(e),qt(St,Tt,Pt)}function Jt(t,e){t*=f;var n=A(e*=f),r=n*A(t),i=n*x(t),o=x(e),s=Tt*o-Pt*i,a=Pt*r-St*o,l=St*i-Tt*r,u=E(s*s+a*a+l*l),c=P(u),h=u&&-c/u;vt+=h*s,bt+=h*a,xt+=h*l,ft+=c,At+=c*(St+(St=r)),yt+=c*(Tt+(Tt=i)),_t+=c*(Pt+(Pt=o)),qt(St,Tt,Pt)}function te(t){pt=ft=dt=gt=mt=At=yt=_t=vt=bt=xt=0,D(t,Gt);var e=vt,n=bt,r=xt,i=e*e+n*n+r*r;return i<1e-12&&(e=At,n=yt,r=_t,ft<a&&(e=dt,n=gt,r=mt),(i=e*e+n*n+r*r)<1e-12)?[NaN,NaN]:[m(n,e)*p,P(r/E(i))*p]}function ee(t){return function(){return t}}function ne(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n}function re(t,e){return[t>l?t-h:t<-l?t+h:t,e]}function ie(t,e,n){return(t%=h)?e||n?ne(se(t),ae(e,n)):se(t):e||n?ae(e,n):re}function oe(t){return function(e,n){return[(e+=t)>l?e-h:e<-l?e+h:e,n]}}function se(t){var e=oe(t);return e.invert=oe(-t),e}function ae(t,e){var n=A(t),r=x(t),i=A(e),o=x(e);function s(t,e){var s=A(e),a=A(t)*s,l=x(t)*s,u=x(e),c=u*n+a*r;return[m(l*i-c*o,a*n-u*r),P(c*i+l*o)]}return s.invert=function(t,e){var s=A(e),a=A(t)*s,l=x(t)*s,u=x(e),c=u*i-l*o;return[m(l*i+u*o,a*n+c*r),P(c*n-a*r)]},s}function le(t){function e(e){return(e=t(e[0]*f,e[1]*f))[0]*=p,e[1]*=p,e}return t=ie(t[0]*f,t[1]*f,t.length>2?t[2]*f:0),e.invert=function(e){return(e=t.invert(e[0]*f,e[1]*f))[0]*=p,e[1]*=p,e},e}function ue(t,e,n,r,i,o){if(n){var s=A(e),a=x(e),l=r*n;null==i?(i=e+r*h,o=e-l/2):(i=ce(s,i),o=ce(s,o),(r>0?i<o:i>o)&&(i+=r*h));for(var u,c=i;r>0?c>o:c<o;c-=l)u=$([s,-a*A(c),-a*x(c)]),t.point(u[0],u[1])}}function ce(t,e){(e=Y(e))[0]-=t,et(e);var n=T(-e[1]);return((-e[2]<0?-n:n)+h-a)%h}function he(){var t,e,n=ee([0,0]),r=ee(90),i=ee(6),o={point:function(n,r){t.push(n=e(n,r)),n[0]*=p,n[1]*=p}};function s(){var s=n.apply(this,arguments),a=r.apply(this,arguments)*f,l=i.apply(this,arguments)*f;return t=[],e=ie(-s[0]*f,-s[1]*f,0).invert,ue(o,a,l,1),s={type:"Polygon",coordinates:[t]},t=e=null,s}return s.center=function(t){return arguments.length?(n="function"==typeof t?t:ee([+t[0],+t[1]]),s):n},s.radius=function(t){return arguments.length?(r="function"==typeof t?t:ee(+t),s):r},s.precision=function(t){return arguments.length?(i="function"==typeof t?t:ee(+t),s):i},s}function pe(){var t,e=[];return{point:function(e,n){t.push([e,n])},lineStart:function(){e.push(t=[])},lineEnd:C,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function fe(t,e){return d(t[0]-e[0])<a&&d(t[1]-e[1])<a}function de(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function ge(t,e,n,r,i){var o,s,a=[],l=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],s=t[e];if(fe(r,s)){for(i.lineStart(),o=0;o<e;++o)i.point((r=t[o])[0],r[1]);i.lineEnd()}else a.push(n=new de(r,t,null,!0)),l.push(n.o=new de(r,null,n,!1)),a.push(n=new de(s,t,null,!1)),l.push(n.o=new de(s,null,n,!0))}})),a.length){for(l.sort(e),me(a),me(l),o=0,s=l.length;o<s;++o)l[o].e=n=!n;for(var u,c,h=a[0];;){for(var p=h,f=!0;p.v;)if((p=p.n)===h)return;u=p.z,i.lineStart();do{if(p.v=p.o.v=!0,p.e){if(f)for(o=0,s=u.length;o<s;++o)i.point((c=u[o])[0],c[1]);else r(p.x,p.n.x,1,i);p=p.n}else{if(f)for(u=p.p.z,o=u.length-1;o>=0;--o)i.point((c=u[o])[0],c[1]);else r(p.x,p.p.x,-1,i);p=p.p}u=(p=p.o).z,f=!f}while(!p.v);i.lineEnd()}}}function me(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}function Ae(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}re.invert=re,1===(Ut=Ae).length&&(Vt=Ut,Ut=function(t,e){return Ae(Vt(t),e)});var ye=Array.prototype;function _e(t){for(var e,n,r,i=t.length,o=-1,s=0;++o<i;)s+=t[o].length;for(n=new Array(s);--i>=0;)for(e=(r=t[i]).length;--e>=0;)n[--s]=r[e];return n}function ve(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);++r<i;)o[r]=t+r*n;return o}ye.slice,ye.map,Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);var be=1e9,xe=-be;function we(t,e,n,r){function i(i,o){return t<=i&&i<=n&&e<=o&&o<=r}function o(i,o,a,l){var c=0,h=0;if(null==i||(c=s(i,a))!==(h=s(o,a))||u(i,o)<0^a>0)do{l.point(0===c||3===c?t:n,c>1?r:e)}while((c=(c+a+4)%4)!==h);else l.point(o[0],o[1])}function s(r,i){return d(r[0]-t)<a?i>0?0:3:d(r[0]-n)<a?i>0?2:1:d(r[1]-e)<a?i>0?1:0:i>0?3:2}function l(t,e){return u(t.x,e.x)}function u(t,e){var n=s(t,1),r=s(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(s){var a,u,c,h,p,f,d,g,m,A,y,_=s,v=pe(),b={point:x,lineStart:function(){b.point=w,u&&u.push(c=[]),A=!0,m=!1,d=g=NaN},lineEnd:function(){a&&(w(h,p),f&&m&&v.rejoin(),a.push(v.result())),b.point=x,m&&_.lineEnd()},polygonStart:function(){_=v,a=[],u=[],y=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,i=u.length;n<i;++n)for(var o,s,a=u[n],l=1,c=a.length,h=a[0],p=h[0],f=h[1];l<c;++l)o=p,s=f,p=(h=a[l])[0],f=h[1],s<=r?f>r&&(p-o)*(r-s)>(f-s)*(t-o)&&++e:f<=r&&(p-o)*(r-s)<(f-s)*(t-o)&&--e;return e}(),n=y&&e,i=(a=_e(a)).length;(n||i)&&(s.polygonStart(),n&&(s.lineStart(),o(null,null,1,s),s.lineEnd()),i&&ge(a,l,e,o,s),s.polygonEnd()),_=s,a=u=c=null}};function x(t,e){i(t,e)&&_.point(t,e)}function w(o,s){var a=i(o,s);if(u&&c.push([o,s]),A)h=o,p=s,f=a,A=!1,a&&(_.lineStart(),_.point(o,s));else if(a&&m)_.point(o,s);else{var l=[d=Math.max(xe,Math.min(be,d)),g=Math.max(xe,Math.min(be,g))],v=[o=Math.max(xe,Math.min(be,o)),s=Math.max(xe,Math.min(be,s))];!function(t,e,n,r,i,o){var s,a=t[0],l=t[1],u=0,c=1,h=e[0]-a,p=e[1]-l;if(s=n-a,h||!(s>0)){if(s/=h,h<0){if(s<u)return;s<c&&(c=s)}else if(h>0){if(s>c)return;s>u&&(u=s)}if(s=i-a,h||!(s<0)){if(s/=h,h<0){if(s>c)return;s>u&&(u=s)}else if(h>0){if(s<u)return;s<c&&(c=s)}if(s=r-l,p||!(s>0)){if(s/=p,p<0){if(s<u)return;s<c&&(c=s)}else if(p>0){if(s>c)return;s>u&&(u=s)}if(s=o-l,p||!(s<0)){if(s/=p,p<0){if(s>c)return;s>u&&(u=s)}else if(p>0){if(s<u)return;s<c&&(c=s)}return u>0&&(t[0]=a+u*h,t[1]=l+u*p),c<1&&(e[0]=a+c*h,e[1]=l+c*p),!0}}}}}(l,v,t,e,n,r)?a&&(_.lineStart(),_.point(o,s),y=!1):(m||(_.lineStart(),_.point(l[0],l[1])),_.point(v[0],v[1]),a||_.lineEnd(),y=!1)}d=o,g=s,m=a}return b}}function Ee(){var t,e,n,r=0,i=0,o=960,s=500;return n={stream:function(n){return t&&e===n?t:t=we(r,i,o,s)(e=n)},extent:function(a){return arguments.length?(r=+a[0][0],i=+a[0][1],o=+a[1][0],s=+a[1][1],t=e=null,n):[[r,i],[o,s]]}}}var Se=r();function Te(t,e){var n=e[0],r=e[1],i=[x(n),-A(n),0],o=0,s=0;Se.reset();for(var u=0,p=t.length;u<p;++u)if(d=(f=t[u]).length)for(var f,d,g=f[d-1],y=g[0],_=g[1]/2+c,v=x(_),b=A(_),w=0;w<d;++w,y=S,v=M,b=C,g=E){var E=f[w],S=E[0],T=E[1]/2+c,M=x(T),C=A(T),I=S-y,O=I>=0?1:-1,R=O*I,L=R>l,k=v*M;if(Se.add(m(k*O*x(R),b*C+k*A(R))),o+=L?I+O*h:I,L^y>=n^S>=n){var D=K(Y(g),Y(E));et(D);var N=K(i,D);et(N);var F=(L^I>=0?-1:1)*P(N[2]);(r>F||r===F&&(D[0]||D[1]))&&(s+=L^I>=0?1:-1)}}return(o<-a||o<a&&Se<-a)^1&s}var Pe,Me,Ce,Ie=r(),Oe={sphere:C,point:C,lineStart:function(){Oe.point=Le,Oe.lineEnd=Re},lineEnd:C,polygonStart:C,polygonEnd:C};function Re(){Oe.point=Oe.lineEnd=C}function Le(t,e){Pe=t*=f,Me=x(e*=f),Ce=A(e),Oe.point=ke}function ke(t,e){t*=f;var n=x(e*=f),r=A(e),i=d(t-Pe),o=A(i),s=r*x(i),a=Ce*n-Me*r*o,l=Me*n+Ce*r*o;Ie.add(m(E(s*s+a*a),l)),Pe=t,Me=n,Ce=r}function De(t){return Ie.reset(),D(t,Oe),+Ie}var Ne=[null,null],Fe={type:"LineString",coordinates:Ne};function Be(t,e){return Ne[0]=t,Ne[1]=e,De(Fe)}var ze={Feature:function(t,e){return Ue(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)if(Ue(n[r].geometry,e))return!0;return!1}},je={Sphere:function(){return!0},Point:function(t,e){return Ve(t.coordinates,e)},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(Ve(n[r],e))return!0;return!1},LineString:function(t,e){return Ge(t.coordinates,e)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(Ge(n[r],e))return!0;return!1},Polygon:function(t,e){return Ze(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(Ze(n[r],e))return!0;return!1},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)if(Ue(n[r],e))return!0;return!1}};function Ue(t,e){return!(!t||!je.hasOwnProperty(t.type))&&je[t.type](t,e)}function Ve(t,e){return 0===Be(t,e)}function Ge(t,e){var n=Be(t[0],t[1]);return Be(t[0],e)+Be(e,t[1])<=n+a}function Ze(t,e){return!!Te(t.map(qe),We(e))}function qe(t){return(t=t.map(We)).pop(),t}function We(t){return[t[0]*f,t[1]*f]}function He(t,e){return(t&&ze.hasOwnProperty(t.type)?ze[t.type]:Ue)(t,e)}function Xe(t,e,n){var r=ve(t,e-a,n).concat(e);return function(t){return r.map((function(e){return[t,e]}))}}function $e(t,e,n){var r=ve(t,e-a,n).concat(e);return function(t){return r.map((function(e){return[e,t]}))}}function Ye(){var t,e,n,r,i,o,s,l,u,c,h,p,f=10,g=f,m=90,A=360,_=2.5;function v(){return{type:"MultiLineString",coordinates:b()}}function b(){return ve(y(r/m)*m,n,m).map(h).concat(ve(y(l/A)*A,s,A).map(p)).concat(ve(y(e/f)*f,t,f).filter((function(t){return d(t%m)>a})).map(u)).concat(ve(y(o/g)*g,i,g).filter((function(t){return d(t%A)>a})).map(c))}return v.lines=function(){return b().map((function(t){return{type:"LineString",coordinates:t}}))},v.outline=function(){return{type:"Polygon",coordinates:[h(r).concat(p(s).slice(1),h(n).reverse().slice(1),p(l).reverse().slice(1))]}},v.extent=function(t){return arguments.length?v.extentMajor(t).extentMinor(t):v.extentMinor()},v.extentMajor=function(t){return arguments.length?(r=+t[0][0],n=+t[1][0],l=+t[0][1],s=+t[1][1],r>n&&(t=r,r=n,n=t),l>s&&(t=l,l=s,s=t),v.precision(_)):[[r,l],[n,s]]},v.extentMinor=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],o=+n[0][1],i=+n[1][1],e>t&&(n=e,e=t,t=n),o>i&&(n=o,o=i,i=n),v.precision(_)):[[e,o],[t,i]]},v.step=function(t){return arguments.length?v.stepMajor(t).stepMinor(t):v.stepMinor()},v.stepMajor=function(t){return arguments.length?(m=+t[0],A=+t[1],v):[m,A]},v.stepMinor=function(t){return arguments.length?(f=+t[0],g=+t[1],v):[f,g]},v.precision=function(a){return arguments.length?(_=+a,u=Xe(o,i,90),c=$e(e,t,_),h=Xe(l,s,90),p=$e(r,n,_),v):_},v.extentMajor([[-180,-89.999999],[180,89.999999]]).extentMinor([[-180,-80.000001],[180,80.000001]])}function Qe(){return Ye()()}function Ke(t,e){var n=t[0]*f,r=t[1]*f,i=e[0]*f,o=e[1]*f,s=A(r),a=x(r),l=A(o),u=x(o),c=s*A(n),h=s*x(n),d=l*A(i),g=l*x(i),y=2*P(E(M(o-r)+s*l*M(i-n))),_=x(y),v=y?function(t){var e=x(t*=y)/_,n=x(y-t)/_,r=n*c+e*d,i=n*h+e*g,o=n*a+e*u;return[m(i,r)*p,m(o,E(r*r+i*i))*p]}:function(){return[n*p,r*p]};return v.distance=y,v}function Je(t){return t}var tn,en,nn,rn,on=r(),sn=r(),an={point:C,lineStart:C,lineEnd:C,polygonStart:function(){an.lineStart=ln,an.lineEnd=hn},polygonEnd:function(){an.lineStart=an.lineEnd=an.point=C,on.add(d(sn)),sn.reset()},result:function(){var t=on/2;return on.reset(),t}};function ln(){an.point=un}function un(t,e){an.point=cn,tn=nn=t,en=rn=e}function cn(t,e){sn.add(rn*t-nn*e),nn=t,rn=e}function hn(){cn(tn,en)}const pn=an;var fn=1/0,dn=fn,gn=-fn,mn=gn,An={point:function(t,e){t<fn&&(fn=t),t>gn&&(gn=t),e<dn&&(dn=e),e>mn&&(mn=e)},lineStart:C,lineEnd:C,polygonStart:C,polygonEnd:C,result:function(){var t=[[fn,dn],[gn,mn]];return gn=mn=-(dn=fn=1/0),t}};const yn=An;var _n,vn,bn,xn,wn=0,En=0,Sn=0,Tn=0,Pn=0,Mn=0,Cn=0,In=0,On=0,Rn={point:Ln,lineStart:kn,lineEnd:Fn,polygonStart:function(){Rn.lineStart=Bn,Rn.lineEnd=zn},polygonEnd:function(){Rn.point=Ln,Rn.lineStart=kn,Rn.lineEnd=Fn},result:function(){var t=On?[Cn/On,In/On]:Mn?[Tn/Mn,Pn/Mn]:Sn?[wn/Sn,En/Sn]:[NaN,NaN];return wn=En=Sn=Tn=Pn=Mn=Cn=In=On=0,t}};function Ln(t,e){wn+=t,En+=e,++Sn}function kn(){Rn.point=Dn}function Dn(t,e){Rn.point=Nn,Ln(bn=t,xn=e)}function Nn(t,e){var n=t-bn,r=e-xn,i=E(n*n+r*r);Tn+=i*(bn+t)/2,Pn+=i*(xn+e)/2,Mn+=i,Ln(bn=t,xn=e)}function Fn(){Rn.point=Ln}function Bn(){Rn.point=jn}function zn(){Un(_n,vn)}function jn(t,e){Rn.point=Un,Ln(_n=bn=t,vn=xn=e)}function Un(t,e){var n=t-bn,r=e-xn,i=E(n*n+r*r);Tn+=i*(bn+t)/2,Pn+=i*(xn+e)/2,Mn+=i,Cn+=(i=xn*t-bn*e)*(bn+t),In+=i*(xn+e),On+=3*i,Ln(bn=t,xn=e)}const Vn=Rn;function Gn(t){this._context=t}Gn.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,h)}},result:C};var Zn,qn,Wn,Hn,Xn,$n=r(),Yn={point:C,lineStart:function(){Yn.point=Qn},lineEnd:function(){Zn&&Kn(qn,Wn),Yn.point=C},polygonStart:function(){Zn=!0},polygonEnd:function(){Zn=null},result:function(){var t=+$n;return $n.reset(),t}};function Qn(t,e){Yn.point=Kn,qn=Hn=t,Wn=Xn=e}function Kn(t,e){Hn-=t,Xn-=e,$n.add(E(Hn*Hn+Xn*Xn)),Hn=t,Xn=e}const Jn=Yn;function tr(){this._string=[]}function er(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function nr(t,e){var n,r,i=4.5;function o(t){return t&&("function"==typeof i&&r.pointRadius(+i.apply(this,arguments)),D(t,n(r))),r.result()}return o.area=function(t){return D(t,n(pn)),pn.result()},o.measure=function(t){return D(t,n(Jn)),Jn.result()},o.bounds=function(t){return D(t,n(yn)),yn.result()},o.centroid=function(t){return D(t,n(Vn)),Vn.result()},o.projection=function(e){return arguments.length?(n=null==e?(t=null,Je):(t=e).stream,o):t},o.context=function(t){return arguments.length?(r=null==t?(e=null,new tr):new Gn(e=t),"function"!=typeof i&&r.pointRadius(i),o):e},o.pointRadius=function(t){return arguments.length?(i="function"==typeof t?t:(r.pointRadius(+t),+t),o):i},o.projection(t).context(e)}function rr(t,e,n,r){return function(i,o){var s,a,l,u=e(o),c=i.invert(r[0],r[1]),h=pe(),p=e(h),f=!1,d={point:g,lineStart:A,lineEnd:y,polygonStart:function(){d.point=_,d.lineStart=v,d.lineEnd=b,a=[],s=[]},polygonEnd:function(){d.point=g,d.lineStart=A,d.lineEnd=y,a=_e(a);var t=Te(s,c);a.length?(f||(o.polygonStart(),f=!0),ge(a,or,t,n,o)):t&&(f||(o.polygonStart(),f=!0),o.lineStart(),n(null,null,1,o),o.lineEnd()),f&&(o.polygonEnd(),f=!1),a=s=null},sphere:function(){o.polygonStart(),o.lineStart(),n(null,null,1,o),o.lineEnd(),o.polygonEnd()}};function g(e,n){var r=i(e,n);t(e=r[0],n=r[1])&&o.point(e,n)}function m(t,e){var n=i(t,e);u.point(n[0],n[1])}function A(){d.point=m,u.lineStart()}function y(){d.point=g,u.lineEnd()}function _(t,e){l.push([t,e]);var n=i(t,e);p.point(n[0],n[1])}function v(){p.lineStart(),l=[]}function b(){_(l[0][0],l[0][1]),p.lineEnd();var t,e,n,r,i=p.clean(),u=h.result(),c=u.length;if(l.pop(),s.push(l),l=null,c)if(1&i){if((e=(n=u[0]).length-1)>0){for(f||(o.polygonStart(),f=!0),o.lineStart(),t=0;t<e;++t)o.point((r=n[t])[0],r[1]);o.lineEnd()}}else c>1&&2&i&&u.push(u.pop().concat(u.shift())),a.push(u.filter(ir))}return d}}function ir(t){return t.length>1}function or(t,e){return((t=t.x)[0]<0?t[1]-u-a:u-t[1])-((e=e.x)[0]<0?e[1]-u-a:u-e[1])}tr.prototype={_radius:4.5,_circle:er(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=er(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}};const sr=rr((function(){return!0}),(function(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,s){var c=o>0?l:-l,h=d(o-n);d(h-l)<a?(t.point(n,r=(r+s)/2>0?u:-u),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(c,r),t.point(o,r),e=0):i!==c&&h>=l&&(d(n-i)<a&&(n-=i*a),d(o-c)<a&&(o-=c*a),r=function(t,e,n,r){var i,o,s=x(t-n);return d(s)>a?g((x(e)*(o=A(r))*x(n)-x(r)*(i=A(e))*x(t))/(i*o*s)):(e+r)/2}(n,r,o,s),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(c,r),e=0),t.point(n=o,r=s),i=c},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}),(function(t,e,n,r){var i;if(null==t)i=n*u,r.point(-l,i),r.point(0,i),r.point(l,i),r.point(l,0),r.point(l,-i),r.point(0,-i),r.point(-l,-i),r.point(-l,0),r.point(-l,i);else if(d(t[0]-e[0])>a){var o=t[0]<e[0]?l:-l;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(e[0],e[1])}),[-l,-u]);function ar(t,e){var n=A(t),r=n>0,i=d(n)>a;function o(t,e){return A(t)*A(e)>n}function s(t,e,r){var i=[1,0,0],o=K(Y(t),Y(e)),s=Q(o,o),u=o[0],c=s-u*u;if(!c)return!r&&t;var h=n*s/c,p=-n*u/c,f=K(i,o),g=tt(i,h);J(g,tt(o,p));var m=f,A=Q(g,m),y=Q(m,m),_=A*A-y*(Q(g,g)-1);if(!(_<0)){var v=E(_),b=tt(m,(-A-v)/y);if(J(b,g),b=$(b),!r)return b;var x,w=t[0],S=e[0],T=t[1],P=e[1];S<w&&(x=w,w=S,S=x);var M=S-w,C=d(M-l)<a;if(!C&&P<T&&(x=T,T=P,P=x),C||M<a?C?T+P>0^b[1]<(d(b[0]-w)<a?T:P):T<=b[1]&&b[1]<=P:M>l^(w<=b[0]&&b[0]<=S)){var I=tt(m,(-A+v)/y);return J(I,g),[b,$(I)]}}}function u(e,n){var i=r?t:l-t,o=0;return e<-i?o|=1:e>i&&(o|=2),n<-i?o|=4:n>i&&(o|=8),o}return rr(o,(function(t){var e,n,c,h,p;return{lineStart:function(){h=c=!1,p=1},point:function(f,d){var g,m=[f,d],A=o(f,d),y=r?A?0:u(f,d):A?u(f+(f<0?l:-l),d):0;if(!e&&(h=c=A)&&t.lineStart(),A!==c&&(!(g=s(e,m))||fe(e,g)||fe(m,g))&&(m[0]+=a,m[1]+=a,A=o(m[0],m[1])),A!==c)p=0,A?(t.lineStart(),g=s(m,e),t.point(g[0],g[1])):(g=s(e,m),t.point(g[0],g[1]),t.lineEnd()),e=g;else if(i&&e&&r^A){var _;y&n||!(_=s(m,e,!0))||(p=0,r?(t.lineStart(),t.point(_[0][0],_[0][1]),t.point(_[1][0],_[1][1]),t.lineEnd()):(t.point(_[1][0],_[1][1]),t.lineEnd(),t.lineStart(),t.point(_[0][0],_[0][1])))}!A||e&&fe(e,m)||t.point(m[0],m[1]),e=m,c=A,n=y},lineEnd:function(){c&&t.lineEnd(),e=null},clean:function(){return p|(h&&c)<<1}}}),(function(n,r,i,o){ue(o,t,e,i,n,r)}),r?[0,-t]:[-l,t-l])}function lr(t){return{stream:ur(t)}}function ur(t){return function(e){var n=new cr;for(var r in t)n[r]=t[r];return n.stream=e,n}}function cr(){}function hr(t,e,n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],o=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),null!=o&&t.clipExtent(null),D(n,t.stream(yn));var s=yn.result(),a=Math.min(r/(s[1][0]-s[0][0]),i/(s[1][1]-s[0][1])),l=+e[0][0]+(r-a*(s[1][0]+s[0][0]))/2,u=+e[0][1]+(i-a*(s[1][1]+s[0][1]))/2;return null!=o&&t.clipExtent(o),t.scale(150*a).translate([l,u])}function pr(t,e,n){return hr(t,[[0,0],e],n)}cr.prototype={constructor:cr,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var fr=A(30*f);function dr(t,e){return+e?function(t,e){function n(r,i,o,s,l,u,c,h,p,f,g,A,y,_){var v=c-r,b=h-i,x=v*v+b*b;if(x>4*e&&y--){var w=s+f,S=l+g,T=u+A,M=E(w*w+S*S+T*T),C=P(T/=M),I=d(d(T)-1)<a||d(o-p)<a?(o+p)/2:m(S,w),O=t(I,C),R=O[0],L=O[1],k=R-r,D=L-i,N=b*k-v*D;(N*N/x>e||d((v*k+b*D)/x-.5)>.3||s*f+l*g+u*A<fr)&&(n(r,i,o,s,l,u,R,L,I,w/=M,S/=M,T,y,_),_.point(R,L),n(R,L,I,w,S,T,c,h,p,f,g,A,y,_))}}return function(e){var r,i,o,s,a,l,u,c,h,p,f,d,g={point:m,lineStart:A,lineEnd:_,polygonStart:function(){e.polygonStart(),g.lineStart=v},polygonEnd:function(){e.polygonEnd(),g.lineStart=A}};function m(n,r){n=t(n,r),e.point(n[0],n[1])}function A(){c=NaN,g.point=y,e.lineStart()}function y(r,i){var o=Y([r,i]),s=t(r,i);n(c,h,u,p,f,d,c=s[0],h=s[1],u=r,p=o[0],f=o[1],d=o[2],16,e),e.point(c,h)}function _(){g.point=m,e.lineEnd()}function v(){A(),g.point=b,g.lineEnd=x}function b(t,e){y(r=t,e),i=c,o=h,s=p,a=f,l=d,g.point=y}function x(){n(c,h,u,p,f,d,i,o,r,s,a,l,16,e),g.lineEnd=_,_()}return g}}(t,e):function(t){return ur({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)}var gr=ur({point:function(t,e){this.stream.point(t*f,e*f)}});function mr(t){return Ar((function(){return t}))()}function Ar(t){var e,n,r,i,o,s,a,l,u,c,h=150,d=480,g=250,m=0,A=0,y=0,_=0,v=0,b=null,x=sr,w=null,S=Je,T=.5,P=dr(I,T);function M(t){return[(t=o(t[0]*f,t[1]*f))[0]*h+n,r-t[1]*h]}function C(t){return(t=o.invert((t[0]-n)/h,(r-t[1])/h))&&[t[0]*p,t[1]*p]}function I(t,i){return[(t=e(t,i))[0]*h+n,r-t[1]*h]}function O(){o=ne(i=ie(y,_,v),e);var t=e(m,A);return n=d-t[0]*h,r=g+t[1]*h,R()}function R(){return u=c=null,M}return M.stream=function(t){return u&&c===t?u:u=gr(x(i,P(S(c=t))))},M.clipAngle=function(t){return arguments.length?(x=+t?ar(b=t*f,6*f):(b=null,sr),R()):b*p},M.clipExtent=function(t){return arguments.length?(S=null==t?(w=s=a=l=null,Je):we(w=+t[0][0],s=+t[0][1],a=+t[1][0],l=+t[1][1]),R()):null==w?null:[[w,s],[a,l]]},M.scale=function(t){return arguments.length?(h=+t,O()):h},M.translate=function(t){return arguments.length?(d=+t[0],g=+t[1],O()):[d,g]},M.center=function(t){return arguments.length?(m=t[0]%360*f,A=t[1]%360*f,O()):[m*p,A*p]},M.rotate=function(t){return arguments.length?(y=t[0]%360*f,_=t[1]%360*f,v=t.length>2?t[2]%360*f:0,O()):[y*p,_*p,v*p]},M.precision=function(t){return arguments.length?(P=dr(I,T=t*t),R()):E(T)},M.fitExtent=function(t,e){return hr(M,t,e)},M.fitSize=function(t,e){return pr(M,t,e)},function(){return e=t.apply(this,arguments),M.invert=e.invert&&C,O()}}function yr(t){var e=0,n=l/3,r=Ar(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*f,n=t[1]*f):[e*p,n*p]},i}function _r(t,e){var n=x(t),r=(n+x(e))/2;if(d(r)<a)return function(t){var e=A(t);function n(t,n){return[t*e,x(n)/e]}return n.invert=function(t,n){return[t/e,P(n*e)]},n}(t);var i=1+n*(2*r-n),o=E(i)/r;function s(t,e){var n=E(i-2*r*x(e))/r;return[n*x(t*=r),o-n*A(t)]}return s.invert=function(t,e){var n=o-e;return[m(t,d(n))/r*w(n),P((i-(t*t+n*n)*r*r)/(2*r))]},s}function vr(){return yr(_r).scale(155.424).center([0,33.6442])}function br(){return vr().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function xr(){var t,e,n,r,i,o,s=br(),l=vr().rotate([154,0]).center([-2,58.5]).parallels([55,65]),u=vr().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(t,e){o=[t,e]}};function h(t){var e=t[0],s=t[1];return o=null,n.point(e,s),o||(r.point(e,s),o)||(i.point(e,s),o)}function p(){return t=e=null,h}return h.invert=function(t){var e=s.scale(),n=s.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?l:i>=.166&&i<.234&&r>=-.214&&r<-.115?u:s).invert(t)},h.stream=function(n){return t&&e===n?t:(r=[s.stream(e=n),l.stream(n),u.stream(n)],i=r.length,t={point:function(t,e){for(var n=-1;++n<i;)r[n].point(t,e)},sphere:function(){for(var t=-1;++t<i;)r[t].sphere()},lineStart:function(){for(var t=-1;++t<i;)r[t].lineStart()},lineEnd:function(){for(var t=-1;++t<i;)r[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<i;)r[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<i;)r[t].polygonEnd()}});var r,i},h.precision=function(t){return arguments.length?(s.precision(t),l.precision(t),u.precision(t),p()):s.precision()},h.scale=function(t){return arguments.length?(s.scale(t),l.scale(.35*t),u.scale(t),h.translate(s.translate())):s.scale()},h.translate=function(t){if(!arguments.length)return s.translate();var e=s.scale(),o=+t[0],h=+t[1];return n=s.translate(t).clipExtent([[o-.455*e,h-.238*e],[o+.455*e,h+.238*e]]).stream(c),r=l.translate([o-.307*e,h+.201*e]).clipExtent([[o-.425*e+a,h+.12*e+a],[o-.214*e-a,h+.234*e-a]]).stream(c),i=u.translate([o-.205*e,h+.212*e]).clipExtent([[o-.214*e+a,h+.166*e+a],[o-.115*e-a,h+.234*e-a]]).stream(c),p()},h.fitExtent=function(t,e){return hr(h,t,e)},h.fitSize=function(t,e){return pr(h,t,e)},h.scale(1070)}function wr(t){return function(e,n){var r=A(e),i=A(n),o=t(r*i);return[o*i*x(e),o*x(n)]}}function Er(t){return function(e,n){var r=E(e*e+n*n),i=t(r),o=x(i),s=A(i);return[m(e*o,r*s),P(r&&n*o/r)]}}var Sr=wr((function(t){return E(2/(1+t))}));function Tr(){return mr(Sr).scale(124.75).clipAngle(179.999)}Sr.invert=Er((function(t){return 2*P(t/2)}));var Pr=wr((function(t){return(t=T(t))&&t/x(t)}));function Mr(){return mr(Pr).scale(79.4188).clipAngle(179.999)}function Cr(t,e){return[t,v(S((u+e)/2))]}function Ir(){return Or(Cr).scale(961/h)}function Or(t){var e,n,r,i=mr(t),o=i.center,s=i.scale,a=i.translate,u=i.clipExtent,c=null;function h(){var o=l*s(),a=i(le(i.rotate()).invert([0,0]));return u(null==c?[[a[0]-o,a[1]-o],[a[0]+o,a[1]+o]]:t===Cr?[[Math.max(a[0]-o,c),e],[Math.min(a[0]+o,n),r]]:[[c,Math.max(a[1]-o,e)],[n,Math.min(a[1]+o,r)]])}return i.scale=function(t){return arguments.length?(s(t),h()):s()},i.translate=function(t){return arguments.length?(a(t),h()):a()},i.center=function(t){return arguments.length?(o(t),h()):o()},i.clipExtent=function(t){return arguments.length?(null==t?c=e=n=r=null:(c=+t[0][0],e=+t[0][1],n=+t[1][0],r=+t[1][1]),h()):null==c?null:[[c,e],[n,r]]},h()}function Rr(t){return S((u+t)/2)}function Lr(t,e){var n=A(t),r=t===e?x(t):v(n/A(e))/v(Rr(e)/Rr(t)),i=n*b(Rr(t),r)/r;if(!r)return Cr;function o(t,e){i>0?e<-u+a&&(e=-u+a):e>u-a&&(e=u-a);var n=i/b(Rr(e),r);return[n*x(r*t),i-n*A(r*t)]}return o.invert=function(t,e){var n=i-e,o=w(r)*E(t*t+n*n);return[m(t,d(n))/r*w(n),2*g(b(i/o,1/r))-u]},o}function kr(){return yr(Lr).scale(109.5).parallels([30,30])}function Dr(t,e){return[t,e]}function Nr(){return mr(Dr).scale(152.63)}function Fr(t,e){var n=A(t),r=t===e?x(t):(n-A(e))/(e-t),i=n/r+t;if(d(r)<a)return Dr;function o(t,e){var n=i-e,o=r*t;return[n*x(o),i-n*A(o)]}return o.invert=function(t,e){var n=i-e;return[m(t,d(n))/r*w(n),i-w(r)*E(t*t+n*n)]},o}function Br(){return yr(Fr).scale(131.154).center([0,13.9389])}function zr(t,e){var n=A(e),r=A(t)*n;return[n*x(t)/r,x(e)/r]}function jr(){return mr(zr).scale(144.049).clipAngle(60)}function Ur(t,e,n,r){return 1===t&&1===e&&0===n&&0===r?Je:ur({point:function(i,o){this.stream.point(i*t+n,o*e+r)}})}function Vr(){var t,e,n,r,i,o,s=1,a=0,l=0,u=1,c=1,h=Je,p=null,f=Je;function d(){return r=i=null,o}return o={stream:function(t){return r&&i===t?r:r=h(f(i=t))},clipExtent:function(r){return arguments.length?(f=null==r?(p=t=e=n=null,Je):we(p=+r[0][0],t=+r[0][1],e=+r[1][0],n=+r[1][1]),d()):null==p?null:[[p,t],[e,n]]},scale:function(t){return arguments.length?(h=Ur((s=+t)*u,s*c,a,l),d()):s},translate:function(t){return arguments.length?(h=Ur(s*u,s*c,a=+t[0],l=+t[1]),d()):[a,l]},reflectX:function(t){return arguments.length?(h=Ur(s*(u=t?-1:1),s*c,a,l),d()):u<0},reflectY:function(t){return arguments.length?(h=Ur(s*u,s*(c=t?-1:1),a,l),d()):c<0},fitExtent:function(t,e){return hr(o,t,e)},fitSize:function(t,e){return pr(o,t,e)}}}function Gr(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function Zr(){return mr(Gr).scale(175.295)}function qr(t,e){return[A(e)*x(t),x(e)]}function Wr(){return mr(qr).scale(249.5).clipAngle(90.000001)}function Hr(t,e){var n=A(e),r=1+A(t)*n;return[n*x(t)/r,x(e)/r]}function Xr(){return mr(Hr).scale(250).clipAngle(142)}function $r(t,e){return[v(S((u+e)/2)),-t]}function Yr(){var t=Or($r),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)}Pr.invert=Er((function(t){return t})),Cr.invert=function(t,e){return[t,2*g(_(e))-u]},Dr.invert=Dr,zr.invert=Er(g),Gr.invert=function(t,e){var n,r=e,i=25;do{var o=r*r,s=o*o;r-=n=(r*(1.007226+o*(.015085+s*(.028874*o-.044475-.005916*s)))-e)/(1.007226+o*(.045255+s*(.259866*o-.311325-.005916*11*s)))}while(d(n)>a&&--i>0);return[t/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]},qr.invert=Er(P),Hr.invert=Er((function(t){return 2*g(t)})),$r.invert=function(t,e){return[-e,2*g(_(t))-u]}},251:(t,e,n)=>{var r=n(2215),i=n(2584),o=n(609),s=n(8420),a=n(2847),l=n(8923),u=Date.prototype.getTime;function c(t){return null==t}function h(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length||"function"!=typeof t.copy||"function"!=typeof t.slice||t.length>0&&"number"!=typeof t[0])}t.exports=function t(e,n,p){var f=p||{};return!!(f.strict?o(e,n):e===n)||(!e||!n||"object"!=typeof e&&"object"!=typeof n?f.strict?o(e,n):e==n:function(e,n,o){var p,f;if(typeof e!=typeof n)return!1;if(c(e)||c(n))return!1;if(e.prototype!==n.prototype)return!1;if(i(e)!==i(n))return!1;var d=s(e),g=s(n);if(d!==g)return!1;if(d||g)return e.source===n.source&&a(e)===a(n);if(l(e)&&l(n))return u.call(e)===u.call(n);var m=h(e),A=h(n);if(m!==A)return!1;if(m||A){if(e.length!==n.length)return!1;for(p=0;p<e.length;p++)if(e[p]!==n[p])return!1;return!0}if(typeof e!=typeof n)return!1;try{var y=r(e),_=r(n)}catch(t){return!1}if(y.length!==_.length)return!1;for(y.sort(),_.sort(),p=y.length-1;p>=0;p--)if(y[p]!=_[p])return!1;for(p=y.length-1;p>=0;p--)if(!t(e[f=y[p]],n[f],o))return!1;return!0}(e,n,f))}},4289:(t,e,n)=>{"use strict";var r=n(2215),i="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),o=Object.prototype.toString,s=Array.prototype.concat,a=Object.defineProperty,l=a&&function(){var t={};try{for(var e in a(t,"x",{enumerable:!1,value:t}),t)return!1;return t.x===t}catch(t){return!1}}(),u=function(t,e,n,r){var i;(!(e in t)||"function"==typeof(i=r)&&"[object Function]"===o.call(i)&&r())&&(l?a(t,e,{configurable:!0,enumerable:!1,value:n,writable:!0}):t[e]=n)},c=function(t,e){var n=arguments.length>2?arguments[2]:{},o=r(e);i&&(o=s.call(o,Object.getOwnPropertySymbols(e)));for(var a=0;a<o.length;a+=1)u(t,o[a],e[o[a]],n[o[a]])};c.supportsDescriptors=!!l,t.exports=c},8317:t=>{function e(t,e,n,r){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(t,e,n,r)}e.prototype.run=function(t,e,n,r){this._init(t,e,n,r);for(var i=0;i<this._datasetLength;i++)if(1!==this._visited[i]){this._visited[i]=1;var o=this._regionQuery(i);if(o.length<this.minPts)this.noise.push(i);else{var s=this.clusters.length;this.clusters.push([]),this._addToCluster(i,s),this._expandCluster(s,o)}}return this.clusters},e.prototype._init=function(t,e,n,r){if(t){if(!(t instanceof Array))throw Error("Dataset must be of type array, "+typeof t+" given");this.dataset=t,this.clusters=[],this.noise=[],this._datasetLength=t.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}e&&(this.epsilon=e),n&&(this.minPts=n),r&&(this.distance=r)},e.prototype._expandCluster=function(t,e){for(var n=0;n<e.length;n++){var r=e[n];if(1!==this._visited[r]){this._visited[r]=1;var i=this._regionQuery(r);i.length>=this.minPts&&(e=this._mergeArrays(e,i))}1!==this._assigned[r]&&this._addToCluster(r,t)}},e.prototype._addToCluster=function(t,e){this.clusters[e].push(t),this._assigned[t]=1},e.prototype._regionQuery=function(t){for(var e=[],n=0;n<this._datasetLength;n++)this.distance(this.dataset[t],this.dataset[n])<this.epsilon&&e.push(n);return e},e.prototype._mergeArrays=function(t,e){for(var n=e.length,r=0;r<n;r++){var i=e[r];t.indexOf(i)<0&&t.push(i)}return t},e.prototype._euclideanDistance=function(t,e){for(var n=0,r=Math.min(t.length,e.length);r--;)n+=(t[r]-e[r])*(t[r]-e[r]);return Math.sqrt(n)},t.exports&&(t.exports=e)},3781:t=>{function e(t,e,n){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(t,e,n)}e.prototype.init=function(t,e,n){this.assignments=[],this.centroids=[],void 0!==t&&(this.dataset=t),void 0!==e&&(this.k=e),void 0!==n&&(this.distance=n)},e.prototype.run=function(t,e){this.init(t,e);for(var n=this.dataset.length,r=0;r<this.k;r++)this.centroids[r]=this.randomCentroid();for(var i=!0;i;){i=this.assign();for(var o=0;o<this.k;o++){for(var s=new Array(c),a=0,l=0;l<c;l++)s[l]=0;for(var u=0;u<n;u++){var c=this.dataset[u].length;if(o===this.assignments[u]){for(l=0;l<c;l++)s[l]+=this.dataset[u][l];a++}}if(a>0){for(l=0;l<c;l++)s[l]/=a;this.centroids[o]=s}else this.centroids[o]=this.randomCentroid(),i=!0}}return this.getClusters()},e.prototype.randomCentroid=function(){var t,e,n=this.dataset.length-1;do{e=Math.round(Math.random()*n),t=this.dataset[e]}while(this.centroids.indexOf(t)>=0);return t},e.prototype.assign=function(){for(var t,e=!1,n=this.dataset.length,r=0;r<n;r++)(t=this.argmin(this.dataset[r],this.centroids,this.distance))!=this.assignments[r]&&(this.assignments[r]=t,e=!0);return e},e.prototype.getClusters=function(){for(var t,e=new Array(this.k),n=0;n<this.assignments.length;n++)void 0===e[t=this.assignments[n]]&&(e[t]=[]),e[t].push(n);return e},e.prototype.argmin=function(t,e,n){for(var r,i=Number.MAX_VALUE,o=0,s=e.length,a=0;a<s;a++)(r=n(t,e[a]))<i&&(i=r,o=a);return o},e.prototype.distance=function(t,e){for(var n=0,r=Math.min(t.length,e.length);r--;){var i=t[r]-e[r];n+=i*i}return Math.sqrt(n)},t.exports&&(t.exports=e)},3763:(t,e,n)=>{if(t.exports)var r=n(7985);function i(t,e,n,r){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(t,e,n,r)}i.prototype.run=function(t,e,n,i){this._init(t,e,n,i);for(var o=0,s=this.dataset.length;o<s;o++)if(1!==this._processed[o]){this._processed[o]=1,this.clusters.push([o]);var a=this.clusters.length-1;this._orderedList.push(o);var l=new r(null,null,"asc"),u=this._regionQuery(o);void 0!==this._distanceToCore(o)&&(this._updateQueue(o,u,l),this._expandCluster(a,l))}return this.clusters},i.prototype.getReachabilityPlot=function(){for(var t=[],e=0,n=this._orderedList.length;e<n;e++){var r=this._orderedList[e],i=this._reachability[r];t.push([r,i])}return t},i.prototype._init=function(t,e,n,r){if(t){if(!(t instanceof Array))throw Error("Dataset must be of type array, "+typeof t+" given");this.dataset=t,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}e&&(this.epsilon=e),n&&(this.minPts=n),r&&(this.distance=r)},i.prototype._updateQueue=function(t,e,n){var r=this;this._coreDistance=this._distanceToCore(t),e.forEach((function(e){if(void 0===r._processed[e]){var i=r.distance(r.dataset[t],r.dataset[e]),o=Math.max(r._coreDistance,i);void 0===r._reachability[e]?(r._reachability[e]=o,n.insert(e,o)):o<r._reachability[e]&&(r._reachability[e]=o,n.remove(e),n.insert(e,o))}}))},i.prototype._expandCluster=function(t,e){for(var n=e.getElements(),r=0,i=n.length;r<i;r++){var o=n[r];if(void 0===this._processed[o]){var s=this._regionQuery(o);this._processed[o]=1,this.clusters[t].push(o),this._orderedList.push(o),void 0!==this._distanceToCore(o)&&(this._updateQueue(o,s,e),this._expandCluster(t,e))}}},i.prototype._distanceToCore=function(t){for(var e=this.epsilon,n=0;n<e;n++)if(this._regionQuery(t,n).length>=this.minPts)return n},i.prototype._regionQuery=function(t,e){e=e||this.epsilon;for(var n=[],r=0,i=this.dataset.length;r<i;r++)this.distance(this.dataset[t],this.dataset[r])<e&&n.push(r);return n},i.prototype._euclideanDistance=function(t,e){for(var n=0,r=Math.min(t.length,e.length);r--;)n+=(t[r]-e[r])*(t[r]-e[r]);return Math.sqrt(n)},t.exports&&(t.exports=i)},7985:t=>{function e(t,e,n){this._queue=[],this._priorities=[],this._sorting="desc",this._init(t,e,n)}e.prototype.insert=function(t,e){for(var n=this._queue.length,r=n;r--;){var i=this._priorities[r];"desc"===this._sorting?e>i&&(n=r):e<i&&(n=r)}this._insertAt(t,e,n)},e.prototype.remove=function(t){for(var e=this._queue.length;e--;)if(t===this._queue[e]){this._queue.splice(e,1),this._priorities.splice(e,1);break}},e.prototype.forEach=function(t){this._queue.forEach(t)},e.prototype.getElements=function(){return this._queue},e.prototype.getElementPriority=function(t){return this._priorities[t]},e.prototype.getPriorities=function(){return this._priorities},e.prototype.getElementsWithPriorities=function(){for(var t=[],e=0,n=this._queue.length;e<n;e++)t.push([this._queue[e],this._priorities[e]]);return t},e.prototype._init=function(t,e,n){if(t&&e){if(this._queue=[],this._priorities=[],t.length!==e.length)throw new Error("Arrays must have the same length");for(var r=0;r<t.length;r++)this.insert(t[r],e[r])}n&&(this._sorting=n)},e.prototype._insertAt=function(t,e,n){this._queue.length===n?(this._queue.push(t),this._priorities.push(e)):(this._queue.splice(n,0,t),this._priorities.splice(n,0,e))},t.exports&&(t.exports=e)},2606:(t,e,n)=>{t.exports&&(t.exports={DBSCAN:n(8317),KMEANS:n(3781),OPTICS:n(3763),PriorityQueue:n(7985)})},9187:t=>{"use strict";function e(t,e,o){o=o||2;var s,a,l,h,p,d,g,m=e&&e.length,A=m?e[0]*o:t.length,y=n(t,0,A,o,!0),_=[];if(!y||y.next===y.prev)return _;if(m&&(y=function(t,e,i,o){var s,a,l,h=[];for(s=0,a=e.length;s<a;s++)(l=n(t,e[s]*o,s<a-1?e[s+1]*o:t.length,o,!1))===l.next&&(l.steiner=!0),h.push(f(l));for(h.sort(u),s=0;s<h.length;s++)i=r(i=c(h[s],i),i.next);return i}(t,e,y,o)),t.length>80*o){s=l=t[0],a=h=t[1];for(var v=o;v<A;v+=o)(p=t[v])<s&&(s=p),(d=t[v+1])<a&&(a=d),p>l&&(l=p),d>h&&(h=d);g=0!==(g=Math.max(l-s,h-a))?1/g:0}return i(y,_,o,s,a,g),_}function n(t,e,n,r,i){var o,s;if(i===T(t,e,n,r)>0)for(o=e;o<n;o+=r)s=w(o,t[o],t[o+1],s);else for(o=n-r;o>=e;o-=r)s=w(o,t[o],t[o+1],s);return s&&A(s,s.next)&&(E(s),s=s.next),s}function r(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!A(r,r.next)&&0!==m(r.prev,r,r.next))r=r.next;else{if(E(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function i(t,e,n,u,c,h,f){if(t){!f&&h&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=p(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,s,a,l,u=1;do{for(n=t,t=null,o=null,s=0;n;){for(s++,r=n,a=0,e=0;e<u&&(a++,r=r.nextZ);e++);for(l=u;a>0||l>0&&r;)0!==a&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,l--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,u*=2}while(s>1)}(i)}(t,u,c,h);for(var d,g,m=t;t.prev!==t.next;)if(d=t.prev,g=t.next,h?s(t,u,c,h):o(t))e.push(d.i/n),e.push(t.i/n),e.push(g.i/n),E(t),t=g.next,m=g.next;else if((t=g)===m){f?1===f?i(t=a(r(t),e,n),e,n,u,c,h,2):2===f&&l(t,e,n,u,c,h):i(r(t),e,n,u,c,h,1);break}}}function o(t){var e=t.prev,n=t,r=t.next;if(m(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(d(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&m(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function s(t,e,n,r){var i=t.prev,o=t,s=t.next;if(m(i,o,s)>=0)return!1;for(var a=i.x<o.x?i.x<s.x?i.x:s.x:o.x<s.x?o.x:s.x,l=i.y<o.y?i.y<s.y?i.y:s.y:o.y<s.y?o.y:s.y,u=i.x>o.x?i.x>s.x?i.x:s.x:o.x>s.x?o.x:s.x,c=i.y>o.y?i.y>s.y?i.y:s.y:o.y>s.y?o.y:s.y,h=p(a,l,e,n,r),f=p(u,c,e,n,r),g=t.prevZ,A=t.nextZ;g&&g.z>=h&&A&&A.z<=f;){if(g!==t.prev&&g!==t.next&&d(i.x,i.y,o.x,o.y,s.x,s.y,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;if(g=g.prevZ,A!==t.prev&&A!==t.next&&d(i.x,i.y,o.x,o.y,s.x,s.y,A.x,A.y)&&m(A.prev,A,A.next)>=0)return!1;A=A.nextZ}for(;g&&g.z>=h;){if(g!==t.prev&&g!==t.next&&d(i.x,i.y,o.x,o.y,s.x,s.y,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;g=g.prevZ}for(;A&&A.z<=f;){if(A!==t.prev&&A!==t.next&&d(i.x,i.y,o.x,o.y,s.x,s.y,A.x,A.y)&&m(A.prev,A,A.next)>=0)return!1;A=A.nextZ}return!0}function a(t,e,n){var i=t;do{var o=i.prev,s=i.next.next;!A(o,s)&&y(o,i,i.next,s)&&b(o,s)&&b(s,o)&&(e.push(o.i/n),e.push(i.i/n),e.push(s.i/n),E(i),E(i.next),i=t=s),i=i.next}while(i!==t);return r(i)}function l(t,e,n,o,s,a){var l=t;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&g(l,u)){var c=x(l,u);return l=r(l,l.next),c=r(c,c.next),i(l,e,n,o,s,a),void i(c,e,n,o,s,a)}u=u.next}l=l.next}while(l!==t)}function u(t,e){return t.x-e.x}function c(t,e){var n=function(t,e){var n,r=e,i=t.x,o=t.y,s=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var a=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=i&&a>s){if(s=a,a===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===s)return n;var l,u=n,c=n.x,p=n.y,f=1/0;r=n;do{i>=r.x&&r.x>=c&&i!==r.x&&d(o<p?i:s,o,c,p,o<p?s:i,o,r.x,r.y)&&(l=Math.abs(o-r.y)/(i-r.x),b(r,t)&&(l<f||l===f&&(r.x>n.x||r.x===n.x&&h(n,r)))&&(n=r,f=l)),r=r.next}while(r!==u);return n}(t,e);if(!n)return e;var i=x(n,t),o=r(n,n.next);return r(i,i.next),e===n?o:e}function h(t,e){return m(t.prev,t,e.prev)<0&&m(e.next,t,t.next)<0}function p(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function f(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function d(t,e,n,r,i,o,s,a){return(i-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(r-a)-(n-s)*(e-a)>=0&&(n-s)*(o-a)-(i-s)*(r-a)>=0}function g(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&y(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(b(t,e)&&b(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(m(t.prev,t,e.prev)||m(t,e.prev,e))||A(t,e)&&m(t.prev,t,t.next)>0&&m(e.prev,e,e.next)>0)}function m(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function A(t,e){return t.x===e.x&&t.y===e.y}function y(t,e,n,r){var i=v(m(t,e,n)),o=v(m(t,e,r)),s=v(m(n,r,t)),a=v(m(n,r,e));return i!==o&&s!==a||!(0!==i||!_(t,n,e))||!(0!==o||!_(t,r,e))||!(0!==s||!_(n,t,r))||!(0!==a||!_(n,e,r))}function _(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function v(t){return t>0?1:t<0?-1:0}function b(t,e){return m(t.prev,t,t.next)<0?m(t,e,t.next)>=0&&m(t,t.prev,e)>=0:m(t,e,t.prev)<0||m(t,t.next,e)<0}function x(t,e){var n=new S(t.i,t.x,t.y),r=new S(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function w(t,e,n,r){var i=new S(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function E(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function S(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function T(t,e,n,r){for(var i=0,o=e,s=n-r;o<n;o+=r)i+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return i}t.exports=e,t.exports.default=e,e.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,s=Math.abs(T(t,0,o,n));if(i)for(var a=0,l=e.length;a<l;a++){var u=e[a]*n,c=a<l-1?e[a+1]*n:t.length;s-=Math.abs(T(t,u,c,n))}var h=0;for(a=0;a<r.length;a+=3){var p=r[a]*n,f=r[a+1]*n,d=r[a+2]*n;h+=Math.abs((t[p]-t[d])*(t[f+1]-t[p+1])-(t[p]-t[f])*(t[d+1]-t[p+1]))}return 0===s&&0===h?0:Math.abs((h-s)/s)},e.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[i][o][s]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n}},7187:t=>{"use strict";var e,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};e=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var i=Number.isNaN||function(t){return t!=t};function o(){o.init.call(this)}t.exports=o,t.exports.once=function(t,e){return new Promise((function(n,r){function i(n){t.removeListener(e,o),r(n)}function o(){"function"==typeof t.removeListener&&t.removeListener("error",i),n([].slice.call(arguments))}g(t,e,o,{once:!0}),"error"!==e&&function(t,e,n){"function"==typeof t.on&&g(t,"error",e,{once:!0})}(t,i)}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function a(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function l(t){return void 0===t._maxListeners?o.defaultMaxListeners:t._maxListeners}function u(t,e,n,r){var i,o,s,u;if(a(n),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),s=o[e]),void 0===s)s=o[e]=n,++t._eventsCount;else if("function"==typeof s?s=o[e]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(i=l(t))>0&&s.length>i&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=s.length,u=c,console&&console.warn&&console.warn(u)}return t}function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=c.bind(r);return i.listener=n,r.wrapFn=i,i}function p(t,e,n){var r=t._events;if(void 0===r)return[];var i=r[e];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(i):d(i,i.length)}function f(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function d(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function g(t,e,n,r){if("function"==typeof t.on)r.once?t.once(e,n):t.on(e,n);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function i(o){r.once&&t.removeEventListener(e,i),n(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(t){if("number"!=typeof t||t<0||i(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");s=t}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||i(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},o.prototype.getMaxListeners=function(){return l(this)},o.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var i="error"===t,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=o[t];if(void 0===l)return!1;if("function"==typeof l)r(l,this,e);else{var u=l.length,c=d(l,u);for(n=0;n<u;++n)r(c[n],this,e)}return!0},o.prototype.addListener=function(t,e){return u(this,t,e,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(t,e){return u(this,t,e,!0)},o.prototype.once=function(t,e){return a(e),this.on(t,h(this,t,e)),this},o.prototype.prependOnceListener=function(t,e){return a(e),this.prependListener(t,h(this,t,e)),this},o.prototype.removeListener=function(t,e){var n,r,i,o,s;if(a(e),void 0===(r=this._events))return this;if(void 0===(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===e||n[o].listener===e){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,i),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,s||e)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(t){var e,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},o.prototype.listeners=function(t){return p(this,t,!0)},o.prototype.rawListeners=function(t){return p(this,t,!1)},o.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):f.call(t,e)},o.prototype.listenerCount=f,o.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]}},7648:t=>{"use strict";var e="Function.prototype.bind called on incompatible ",n=Array.prototype.slice,r=Object.prototype.toString,i="[object Function]";t.exports=function(t){var o=this;if("function"!=typeof o||r.call(o)!==i)throw new TypeError(e+o);for(var s,a=n.call(arguments,1),l=function(){if(this instanceof s){var e=o.apply(this,a.concat(n.call(arguments)));return Object(e)===e?e:this}return o.apply(t,a.concat(n.call(arguments)))},u=Math.max(0,o.length-a.length),c=[],h=0;h<u;h++)c.push("$"+h);if(s=Function("binder","return function ("+c.join(",")+"){ return binder.apply(this,arguments); }")(l),o.prototype){var p=function(){};p.prototype=o.prototype,s.prototype=new p,p.prototype=null}return s}},8612:(t,e,n)=>{"use strict";var r=n(7648);t.exports=Function.prototype.bind||r},9657:(t,e,n)=>{var r=n(251),i=function(t){this.precision=t&&t.precision?t.precision:17,this.direction=!(!t||!t.direction)&&t.direction,this.pseudoNode=!(!t||!t.pseudoNode)&&t.pseudoNode,this.objectComparator=t&&t.objectComparator?t.objectComparator:a};function o(t){return t.coordinates.map((function(e){return{type:t.type.replace("Multi",""),coordinates:e}}))}function s(t,e){return t.hasOwnProperty("coordinates")?t.coordinates.length===e.coordinates.length:t.length===e.length}function a(t,e){return r(t,e,{strict:!0})}i.prototype.compare=function(t,e){if(t.type!==e.type||!s(t,e))return!1;switch(t.type){case"Point":return this.compareCoord(t.coordinates,e.coordinates);case"LineString":return this.compareLine(t.coordinates,e.coordinates,0,!1);case"Polygon":return this.comparePolygon(t,e);case"Feature":return this.compareFeature(t,e);default:if(0===t.type.indexOf("Multi")){var n=this,r=o(t),i=o(e);return r.every((function(t){return this.some((function(e){return n.compare(t,e)}))}),i)}}return!1},i.prototype.compareCoord=function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n].toFixed(this.precision)!==e[n].toFixed(this.precision))return!1;return!0},i.prototype.compareLine=function(t,e,n,r){if(!s(t,e))return!1;var i=this.pseudoNode?t:this.removePseudo(t),o=this.pseudoNode?e:this.removePseudo(e);if(!r||this.compareCoord(i[0],o[0])||(o=this.fixStartIndex(o,i))){var a=this.compareCoord(i[n],o[n]);return this.direction||a?this.comparePath(i,o):!!this.compareCoord(i[n],o[o.length-(1+n)])&&this.comparePath(i.slice().reverse(),o)}},i.prototype.fixStartIndex=function(t,e){for(var n,r=-1,i=0;i<t.length;i++)if(this.compareCoord(t[i],e[0])){r=i;break}return r>=0&&(n=[].concat(t.slice(r,t.length),t.slice(1,r+1))),n},i.prototype.comparePath=function(t,e){var n=this;return t.every((function(t,e){return n.compareCoord(t,this[e])}),e)},i.prototype.comparePolygon=function(t,e){if(this.compareLine(t.coordinates[0],e.coordinates[0],1,!0)){var n=t.coordinates.slice(1,t.coordinates.length),r=e.coordinates.slice(1,e.coordinates.length),i=this;return n.every((function(t){return this.some((function(e){return i.compareLine(t,e,1,!0)}))}),r)}return!1},i.prototype.compareFeature=function(t,e){return!(t.id!==e.id||!this.objectComparator(t.properties,e.properties)||!this.compareBBox(t,e))&&this.compare(t.geometry,e.geometry)},i.prototype.compareBBox=function(t,e){return!!(!t.bbox&&!e.bbox||t.bbox&&e.bbox&&this.compareCoord(t.bbox,e.bbox))},i.prototype.removePseudo=function(t){return t},t.exports=i},1787:(t,e,n)=>{var r=n(2582),i=n(4102),o=n(1540),s=n(9705).default,a=o.featureEach,l=(o.coordEach,i.polygon,i.featureCollection);function u(t){var e=new r(t);return e.insert=function(t){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:s(t),r.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach((function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:s(t),e.push(t)})):a(t,(function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:s(t),e.push(t)})),r.prototype.load.call(this,e)},e.remove=function(t,e){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:s(t),r.prototype.remove.call(this,t,e)},e.clear=function(){return r.prototype.clear.call(this)},e.search=function(t){var e=r.prototype.search.call(this,this.toBBox(t));return l(e)},e.collides=function(t){return r.prototype.collides.call(this,this.toBBox(t))},e.all=function(){var t=r.prototype.all.call(this);return l(t)},e.toJSON=function(){return r.prototype.toJSON.call(this)},e.fromJSON=function(t){return r.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;if(t.bbox)e=t.bbox;else if(Array.isArray(t)&&4===t.length)e=t;else if(Array.isArray(t)&&6===t.length)e=[t[0],t[1],t[3],t[4]];else if("Feature"===t.type)e=s(t);else{if("FeatureCollection"!==t.type)throw new Error("invalid geojson");e=s(t)}return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}},e}t.exports=u,t.exports.default=u},210:(t,e,n)=>{"use strict";var r,i=SyntaxError,o=Function,s=TypeError,a=function(t){try{return o('"use strict"; return ('+t+").constructor;")()}catch(t){}},l=Object.getOwnPropertyDescriptor;if(l)try{l({},"")}catch(t){l=null}var u=function(){throw new s},c=l?function(){try{return u}catch(t){try{return l(arguments,"callee").get}catch(t){return u}}}():u,h=n(1405)(),p=Object.getPrototypeOf||function(t){return t.__proto__},f={},d="undefined"==typeof Uint8Array?r:p(Uint8Array),g={"%AggregateError%":"undefined"==typeof AggregateError?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?r:ArrayBuffer,"%ArrayIteratorPrototype%":h?p([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":f,"%AsyncGenerator%":f,"%AsyncGeneratorFunction%":f,"%AsyncIteratorPrototype%":f,"%Atomics%":"undefined"==typeof Atomics?r:Atomics,"%BigInt%":"undefined"==typeof BigInt?r:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?r:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?r:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?r:FinalizationRegistry,"%Function%":o,"%GeneratorFunction%":f,"%Int8Array%":"undefined"==typeof Int8Array?r:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?r:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":h?p(p([][Symbol.iterator]())):r,"%JSON%":"object"==typeof JSON?JSON:r,"%Map%":"undefined"==typeof Map?r:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&h?p((new Map)[Symbol.iterator]()):r,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?r:Promise,"%Proxy%":"undefined"==typeof Proxy?r:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?r:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?r:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&h?p((new Set)[Symbol.iterator]()):r,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":h?p(""[Symbol.iterator]()):r,"%Symbol%":h?Symbol:r,"%SyntaxError%":i,"%ThrowTypeError%":c,"%TypedArray%":d,"%TypeError%":s,"%Uint8Array%":"undefined"==typeof Uint8Array?r:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?r:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?r:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?r:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?r:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?r:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?r:WeakSet},m=function t(e){var n;if("%AsyncFunction%"===e)n=a("async function () {}");else if("%GeneratorFunction%"===e)n=a("function* () {}");else if("%AsyncGeneratorFunction%"===e)n=a("async function* () {}");else if("%AsyncGenerator%"===e){var r=t("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if("%AsyncIteratorPrototype%"===e){var i=t("%AsyncGenerator%");i&&(n=p(i.prototype))}return g[e]=n,n},A={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},y=n(8612),_=n(7642),v=y.call(Function.call,Array.prototype.concat),b=y.call(Function.apply,Array.prototype.splice),x=y.call(Function.call,String.prototype.replace),w=y.call(Function.call,String.prototype.slice),E=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,S=/\\(\\)?/g,T=function(t){var e=w(t,0,1),n=w(t,-1);if("%"===e&&"%"!==n)throw new i("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==e)throw new i("invalid intrinsic syntax, expected opening `%`");var r=[];return x(t,E,(function(t,e,n,i){r[r.length]=n?x(i,S,"$1"):e||t})),r},P=function(t,e){var n,r=t;if(_(A,r)&&(r="%"+(n=A[r])[0]+"%"),_(g,r)){var o=g[r];if(o===f&&(o=m(r)),void 0===o&&!e)throw new s("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:n,name:r,value:o}}throw new i("intrinsic "+t+" does not exist!")};t.exports=function(t,e){if("string"!=typeof t||0===t.length)throw new s("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof e)throw new s('"allowMissing" argument must be a boolean');var n=T(t),r=n.length>0?n[0]:"",o=P("%"+r+"%",e),a=o.name,u=o.value,c=!1,h=o.alias;h&&(r=h[0],b(n,v([0,1],h)));for(var p=1,f=!0;p<n.length;p+=1){var d=n[p],m=w(d,0,1),A=w(d,-1);if(('"'===m||"'"===m||"`"===m||'"'===A||"'"===A||"`"===A)&&m!==A)throw new i("property names with quotes must have matching quotes");if("constructor"!==d&&f||(c=!0),_(g,a="%"+(r+="."+d)+"%"))u=g[a];else if(null!=u){if(!(d in u)){if(!e)throw new s("base intrinsic for "+t+" exists, but the property is not available.");return}if(l&&p+1>=n.length){var y=l(u,d);u=(f=!!y)&&"get"in y&&!("originalValue"in y.get)?y.get:u[d]}else f=_(u,d),u=u[d];f&&!c&&(g[a]=u)}}return u}},9685:(t,e,n)=>{"use strict";n.d(e,{WT:()=>r});var r="undefined"!=typeof Float32Array?Float32Array:Array;Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)})},5975:(t,e,n)=>{"use strict";function r(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],p=e[10],f=e[11],d=e[12],g=e[13],m=e[14],A=e[15],y=n*a-r*s,_=n*l-i*s,v=n*u-o*s,b=r*l-i*a,x=r*u-o*a,w=i*u-o*l,E=c*g-h*d,S=c*m-p*d,T=c*A-f*d,P=h*m-p*g,M=h*A-f*g,C=p*A-f*m,I=y*C-_*M+v*P+b*T-x*S+w*E;return I?(I=1/I,t[0]=(a*C-l*M+u*P)*I,t[1]=(i*M-r*C-o*P)*I,t[2]=(g*w-m*x+A*b)*I,t[3]=(p*x-h*w-f*b)*I,t[4]=(l*T-s*C-u*S)*I,t[5]=(n*C-i*T+o*S)*I,t[6]=(m*v-d*w-A*_)*I,t[7]=(c*w-p*v+f*_)*I,t[8]=(s*M-a*T+u*E)*I,t[9]=(r*T-n*M-o*E)*I,t[10]=(d*x-g*v+A*y)*I,t[11]=(h*v-c*x-f*y)*I,t[12]=(a*S-s*P-l*E)*I,t[13]=(n*P-r*S+i*E)*I,t[14]=(g*_-d*b-m*y)*I,t[15]=(c*b-h*_+p*y)*I,t):null}function i(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=e[9],f=e[10],d=e[11],g=e[12],m=e[13],A=e[14],y=e[15],_=n[0],v=n[1],b=n[2],x=n[3];return t[0]=_*r+v*a+b*h+x*g,t[1]=_*i+v*l+b*p+x*m,t[2]=_*o+v*u+b*f+x*A,t[3]=_*s+v*c+b*d+x*y,_=n[4],v=n[5],b=n[6],x=n[7],t[4]=_*r+v*a+b*h+x*g,t[5]=_*i+v*l+b*p+x*m,t[6]=_*o+v*u+b*f+x*A,t[7]=_*s+v*c+b*d+x*y,_=n[8],v=n[9],b=n[10],x=n[11],t[8]=_*r+v*a+b*h+x*g,t[9]=_*i+v*l+b*p+x*m,t[10]=_*o+v*u+b*f+x*A,t[11]=_*s+v*c+b*d+x*y,_=n[12],v=n[13],b=n[14],x=n[15],t[12]=_*r+v*a+b*h+x*g,t[13]=_*i+v*l+b*p+x*m,t[14]=_*o+v*u+b*f+x*A,t[15]=_*s+v*c+b*d+x*y,t}function o(t,e,n){var r,i,o,s,a,l,u,c,h,p,f,d,g=n[0],m=n[1],A=n[2];return e===t?(t[12]=e[0]*g+e[4]*m+e[8]*A+e[12],t[13]=e[1]*g+e[5]*m+e[9]*A+e[13],t[14]=e[2]*g+e[6]*m+e[10]*A+e[14],t[15]=e[3]*g+e[7]*m+e[11]*A+e[15]):(r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=e[9],f=e[10],d=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=a,t[5]=l,t[6]=u,t[7]=c,t[8]=h,t[9]=p,t[10]=f,t[11]=d,t[12]=r*g+a*m+h*A+e[12],t[13]=i*g+l*m+p*A+e[13],t[14]=o*g+u*m+f*A+e[14],t[15]=s*g+c*m+d*A+e[15]),t}function s(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}n.d(e,{U_:()=>r,Jp:()=>i,Iu:()=>o,bA:()=>s})},1437:(t,e,n)=>{"use strict";n.d(e,{IH:()=>o,tk:()=>s});var r,i=n(9685);function o(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function s(t,e){return t[0]=-e[0],t[1]=-e[1],t}r=new i.WT(2),i.WT!=Float32Array&&(r[0]=0,r[1]=0)},7160:(t,e,n)=>{"use strict";n.d(e,{t7:()=>i,lu:()=>s,Zh:()=>a,x9:()=>l});var r=n(9685);function i(t,e,n,r){var i=e[0],o=e[1],s=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=s+r*(n[2]-s),t}var o,s=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},a=function(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)},l=function(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r};o=new r.WT(3),r.WT!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0)},8333:(t,e,n)=>{"use strict";n.d(e,{bA:()=>o,fF:()=>s});var r,i=n(9685);function o(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function s(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*s,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*s,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*s,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*s,t}r=new i.WT(4),i.WT!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0)},9144:(t,e,n)=>{var r,i=void 0!==n.g?n.g:"undefined"!=typeof window?window:{},o=n(7579);"undefined"!=typeof document?r=document:(r=i["__GLOBAL_DOCUMENT_CACHE@4"])||(r=i["__GLOBAL_DOCUMENT_CACHE@4"]=o),t.exports=r},9947:(t,e,n)=>{"use strict";n.r(e),n.d(e,{UNITS:()=>d,h3IndexToSplitLong:()=>A,splitLongToh3Index:()=>_,h3IsValid:()=>L,h3IsPentagon:()=>k,h3IsResClassIII:()=>D,h3GetBaseCell:()=>N,h3GetFaces:()=>F,h3GetResolution:()=>B,geoToH3:()=>z,h3ToGeo:()=>j,h3ToGeoBoundary:()=>U,h3ToParent:()=>V,h3ToChildren:()=>G,h3ToCenterChild:()=>Z,kRing:()=>q,kRingDistances:()=>W,hexRing:()=>H,polyfill:()=>X,h3SetToMultiPolygon:()=>$,compact:()=>Y,uncompact:()=>Q,h3IndexesAreNeighbors:()=>K,getH3UnidirectionalEdge:()=>J,getOriginH3IndexFromUnidirectionalEdge:()=>tt,getDestinationH3IndexFromUnidirectionalEdge:()=>et,h3UnidirectionalEdgeIsValid:()=>nt,getH3IndexesFromUnidirectionalEdge:()=>rt,getH3UnidirectionalEdgesFromHexagon:()=>it,getH3UnidirectionalEdgeBoundary:()=>ot,h3Distance:()=>st,h3Line:()=>at,experimentalH3ToLocalIj:()=>lt,experimentalLocalIjToH3:()=>ut,pointDist:()=>ct,cellArea:()=>ht,exactEdgeLength:()=>pt,hexArea:()=>ft,edgeLength:()=>dt,numHexagons:()=>gt,getRes0Indexes:()=>mt,getPentagonIndexes:()=>At,degsToRads:()=>yt,radsToDegs:()=>_t});var r=function(t){var e,n=void 0!==(t=t||{})?t:{},r={};for(e in n)n.hasOwnProperty(e)&&(r[e]=n[e]);var i,o=[],s="";document.currentScript&&(s=document.currentScript.src),s=0!==s.indexOf("blob:")?s.substr(0,s.lastIndexOf("/")+1):"",i=function(t,e,n){var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.onload=function(){if(200==r.status||0==r.status&&r.response)e(r.response);else{var i=X(t);i?e(i.buffer):n()}},r.onerror=n,r.send(null)};var a=n.print||console.log.bind(console),l=n.printErr||console.warn.bind(console);for(e in r)r.hasOwnProperty(e)&&(n[e]=r[e]);r=null,n.arguments&&(o=n.arguments);var u=0,c=function(){return u},h=!1;function p(t){var e=n["_"+t];return e||at("Assertion failed: "+("Cannot call unknown function "+t+", make sure it is exported")),e}function f(t,e,n,r,i){var o={string:function(t){var e=0;if(null!=t&&0!==t){var n=1+(t.length<<2);!function(t,e,n){!function(t,e,n,r){if(!(r>0))return 0;for(var i=n+r-1,o=0;o<t.length;++o){var s=t.charCodeAt(o);if(s>=55296&&s<=57343&&(s=65536+((1023&s)<<10)|1023&t.charCodeAt(++o)),s<=127){if(n>=i)break;e[n++]=s}else if(s<=2047){if(n+1>=i)break;e[n++]=192|s>>6,e[n++]=128|63&s}else if(s<=65535){if(n+2>=i)break;e[n++]=224|s>>12,e[n++]=128|s>>6&63,e[n++]=128|63&s}else{if(n+3>=i)break;e[n++]=240|s>>18,e[n++]=128|s>>12&63,e[n++]=128|s>>6&63,e[n++]=128|63&s}}e[n]=0}(t,m,e,n)}(t,e=J(n),n)}return e},array:function(t){var e=J(t.length);return function(t,e){g.set(t,e)}(t,e),e}},s=p(t),a=[],l=0;if(r)for(var u=0;u<r.length;u++){var c=o[n[u]];c?(0===l&&(l=et()),a[u]=c(r[u])):a[u]=r[u]}var h=s.apply(null,a);return h=function(t){return"string"===e?x(t):"boolean"===e?Boolean(t):t}(h),0!==l&&tt(l),h}var d,g,m,A,y,_,v,b="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function x(t,e){return t?function(t,e,n){for(var r=e+n,i=e;t[i]&&!(i>=r);)++i;if(i-e>16&&t.subarray&&b)return b.decode(t.subarray(e,i));for(var o="";e<i;){var s=t[e++];if(128&s){var a=63&t[e++];if(192!=(224&s)){var l=63&t[e++];if((s=224==(240&s)?(15&s)<<12|a<<6|l:(7&s)<<18|a<<12|l<<6|63&t[e++])<65536)o+=String.fromCharCode(s);else{var u=s-65536;o+=String.fromCharCode(55296|u>>10,56320|1023&u)}}else o+=String.fromCharCode((31&s)<<6|a)}else o+=String.fromCharCode(s)}return o}(m,t,e):""}function w(t,e){return t%e>0&&(t+=e-t%e),t}function E(t){d=t,n.HEAP8=g=new Int8Array(t),n.HEAP16=A=new Int16Array(t),n.HEAP32=y=new Int32Array(t),n.HEAPU8=m=new Uint8Array(t),n.HEAPU16=new Uint16Array(t),n.HEAPU32=new Uint32Array(t),n.HEAPF32=_=new Float32Array(t),n.HEAPF64=v=new Float64Array(t)}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");var S=n.TOTAL_MEMORY||33554432;function T(t){for(;t.length>0;){var e=t.shift();if("function"!=typeof e){var r=e.func;"number"==typeof r?void 0===e.arg?n.dynCall_v(r):n.dynCall_vi(r,e.arg):r(void 0===e.arg?null:e.arg)}else e()}}S=(d=n.buffer?n.buffer:new ArrayBuffer(S)).byteLength,E(d),y[6004]=5266928;var P=[],M=[],C=[],I=[],O=Math.abs,R=Math.ceil,L=Math.floor,k=Math.min,D=0,N=null,F=null;n.preloadedImages={},n.preloadedAudios={};var B,z,j=null,U="data:application/octet-stream;base64,";function V(t){return String.prototype.startsWith?t.startsWith(U):0===t.indexOf(U)}function G(t){return t.replace(/\b__Z[\w\d_]+/g,(function(t){return t==t?t:t+" ["+t+"]"}))}function Z(){var t=new Error;if(!t.stack){try{throw new Error(0)}catch(e){t=e}if(!t.stack)return"(no stack trace available)"}return t.stack.toString()}function q(){return g.length}function W(t){try{var e=new ArrayBuffer(t);if(e.byteLength!=t)return;return new Int8Array(e).set(g),K(e),E(e),1}catch(t){}}j="data:application/octet-stream;base64,AAAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAABAAAAAMAAAAGAAAABQAAAAIAAAAAAAAAAgAAAAMAAAABAAAABAAAAAYAAAAAAAAABQAAAAMAAAAGAAAABAAAAAUAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAABAAAABQAAAAIAAAAAAAAAAQAAAAMAAAAGAAAABAAAAAYAAAAAAAAABQAAAAIAAAABAAAABAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAgAAAAMAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAABgAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAABgAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAAAAAAABgAAAAAAAAADAAAAAgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAUAAAAEAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAEAAAAAAAAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAUAAAACAAAABAAAAAMAAAAIAAAAAQAAAAcAAAAGAAAACQAAAAAAAAADAAAAAgAAAAIAAAAGAAAACgAAAAsAAAAAAAAAAQAAAAUAAAADAAAADQAAAAEAAAAHAAAABAAAAAwAAAAAAAAABAAAAH8AAAAPAAAACAAAAAMAAAAAAAAADAAAAAUAAAACAAAAEgAAAAoAAAAIAAAAAAAAABAAAAAGAAAADgAAAAsAAAARAAAAAQAAAAkAAAACAAAABwAAABUAAAAJAAAAEwAAAAMAAAANAAAAAQAAAAgAAAAFAAAAFgAAABAAAAAEAAAAAAAAAA8AAAAJAAAAEwAAAA4AAAAUAAAAAQAAAAcAAAAGAAAACgAAAAsAAAAYAAAAFwAAAAUAAAACAAAAEgAAAAsAAAARAAAAFwAAABkAAAACAAAABgAAAAoAAAAMAAAAHAAAAA0AAAAaAAAABAAAAA8AAAADAAAADQAAABoAAAAVAAAAHQAAAAMAAAAMAAAABwAAAA4AAAB/AAAAEQAAABsAAAAJAAAAFAAAAAYAAAAPAAAAFgAAABwAAAAfAAAABAAAAAgAAAAMAAAAEAAAABIAAAAhAAAAHgAAAAgAAAAFAAAAFgAAABEAAAALAAAADgAAAAYAAAAjAAAAGQAAABsAAAASAAAAGAAAAB4AAAAgAAAABQAAAAoAAAAQAAAAEwAAACIAAAAUAAAAJAAAAAcAAAAVAAAACQAAABQAAAAOAAAAEwAAAAkAAAAoAAAAGwAAACQAAAAVAAAAJgAAABMAAAAiAAAADQAAAB0AAAAHAAAAFgAAABAAAAApAAAAIQAAAA8AAAAIAAAAHwAAABcAAAAYAAAACwAAAAoAAAAnAAAAJQAAABkAAAAYAAAAfwAAACAAAAAlAAAACgAAABcAAAASAAAAGQAAABcAAAARAAAACwAAAC0AAAAnAAAAIwAAABoAAAAqAAAAHQAAACsAAAAMAAAAHAAAAA0AAAAbAAAAKAAAACMAAAAuAAAADgAAABQAAAARAAAAHAAAAB8AAAAqAAAALAAAAAwAAAAPAAAAGgAAAB0AAAArAAAAJgAAAC8AAAANAAAAGgAAABUAAAAeAAAAIAAAADAAAAAyAAAAEAAAABIAAAAhAAAAHwAAACkAAAAsAAAANQAAAA8AAAAWAAAAHAAAACAAAAAeAAAAGAAAABIAAAA0AAAAMgAAACUAAAAhAAAAHgAAADEAAAAwAAAAFgAAABAAAAApAAAAIgAAABMAAAAmAAAAFQAAADYAAAAkAAAAMwAAACMAAAAuAAAALQAAADgAAAARAAAAGwAAABkAAAAkAAAAFAAAACIAAAATAAAANwAAACgAAAA2AAAAJQAAACcAAAA0AAAAOQAAABgAAAAXAAAAIAAAACYAAAB/AAAAIgAAADMAAAAdAAAALwAAABUAAAAnAAAAJQAAABkAAAAXAAAAOwAAADkAAAAtAAAAKAAAABsAAAAkAAAAFAAAADwAAAAuAAAANwAAACkAAAAxAAAANQAAAD0AAAAWAAAAIQAAAB8AAAAqAAAAOgAAACsAAAA+AAAAHAAAACwAAAAaAAAAKwAAAD4AAAAvAAAAQAAAABoAAAAqAAAAHQAAACwAAAA1AAAAOgAAAEEAAAAcAAAAHwAAACoAAAAtAAAAJwAAACMAAAAZAAAAPwAAADsAAAA4AAAALgAAADwAAAA4AAAARAAAABsAAAAoAAAAIwAAAC8AAAAmAAAAKwAAAB0AAABFAAAAMwAAAEAAAAAwAAAAMQAAAB4AAAAhAAAAQwAAAEIAAAAyAAAAMQAAAH8AAAA9AAAAQgAAACEAAAAwAAAAKQAAADIAAAAwAAAAIAAAAB4AAABGAAAAQwAAADQAAAAzAAAARQAAADYAAABHAAAAJgAAAC8AAAAiAAAANAAAADkAAABGAAAASgAAACAAAAAlAAAAMgAAADUAAAA9AAAAQQAAAEsAAAAfAAAAKQAAACwAAAA2AAAARwAAADcAAABJAAAAIgAAADMAAAAkAAAANwAAACgAAAA2AAAAJAAAAEgAAAA8AAAASQAAADgAAABEAAAAPwAAAE0AAAAjAAAALgAAAC0AAAA5AAAAOwAAAEoAAABOAAAAJQAAACcAAAA0AAAAOgAAAH8AAAA+AAAATAAAACwAAABBAAAAKgAAADsAAAA/AAAATgAAAE8AAAAnAAAALQAAADkAAAA8AAAASAAAAEQAAABQAAAAKAAAADcAAAAuAAAAPQAAADUAAAAxAAAAKQAAAFEAAABLAAAAQgAAAD4AAAArAAAAOgAAACoAAABSAAAAQAAAAEwAAAA/AAAAfwAAADgAAAAtAAAATwAAADsAAABNAAAAQAAAAC8AAAA+AAAAKwAAAFQAAABFAAAAUgAAAEEAAAA6AAAANQAAACwAAABWAAAATAAAAEsAAABCAAAAQwAAAFEAAABVAAAAMQAAADAAAAA9AAAAQwAAAEIAAAAyAAAAMAAAAFcAAABVAAAARgAAAEQAAAA4AAAAPAAAAC4AAABaAAAATQAAAFAAAABFAAAAMwAAAEAAAAAvAAAAWQAAAEcAAABUAAAARgAAAEMAAAA0AAAAMgAAAFMAAABXAAAASgAAAEcAAABZAAAASQAAAFsAAAAzAAAARQAAADYAAABIAAAAfwAAAEkAAAA3AAAAUAAAADwAAABYAAAASQAAAFsAAABIAAAAWAAAADYAAABHAAAANwAAAEoAAABOAAAAUwAAAFwAAAA0AAAAOQAAAEYAAABLAAAAQQAAAD0AAAA1AAAAXgAAAFYAAABRAAAATAAAAFYAAABSAAAAYAAAADoAAABBAAAAPgAAAE0AAAA/AAAARAAAADgAAABdAAAATwAAAFoAAABOAAAASgAAADsAAAA5AAAAXwAAAFwAAABPAAAATwAAAE4AAAA/AAAAOwAAAF0AAABfAAAATQAAAFAAAABEAAAASAAAADwAAABjAAAAWgAAAFgAAABRAAAAVQAAAF4AAABlAAAAPQAAAEIAAABLAAAAUgAAAGAAAABUAAAAYgAAAD4AAABMAAAAQAAAAFMAAAB/AAAASgAAAEYAAABkAAAAVwAAAFwAAABUAAAARQAAAFIAAABAAAAAYQAAAFkAAABiAAAAVQAAAFcAAABlAAAAZgAAAEIAAABDAAAAUQAAAFYAAABMAAAASwAAAEEAAABoAAAAYAAAAF4AAABXAAAAUwAAAGYAAABkAAAAQwAAAEYAAABVAAAAWAAAAEgAAABbAAAASQAAAGMAAABQAAAAaQAAAFkAAABhAAAAWwAAAGcAAABFAAAAVAAAAEcAAABaAAAATQAAAFAAAABEAAAAagAAAF0AAABjAAAAWwAAAEkAAABZAAAARwAAAGkAAABYAAAAZwAAAFwAAABTAAAATgAAAEoAAABsAAAAZAAAAF8AAABdAAAATwAAAFoAAABNAAAAbQAAAF8AAABqAAAAXgAAAFYAAABRAAAASwAAAGsAAABoAAAAZQAAAF8AAABcAAAATwAAAE4AAABtAAAAbAAAAF0AAABgAAAAaAAAAGIAAABuAAAATAAAAFYAAABSAAAAYQAAAH8AAABiAAAAVAAAAGcAAABZAAAAbwAAAGIAAABuAAAAYQAAAG8AAABSAAAAYAAAAFQAAABjAAAAUAAAAGkAAABYAAAAagAAAFoAAABxAAAAZAAAAGYAAABTAAAAVwAAAGwAAAByAAAAXAAAAGUAAABmAAAAawAAAHAAAABRAAAAVQAAAF4AAABmAAAAZQAAAFcAAABVAAAAcgAAAHAAAABkAAAAZwAAAFsAAABhAAAAWQAAAHQAAABpAAAAbwAAAGgAAABrAAAAbgAAAHMAAABWAAAAXgAAAGAAAABpAAAAWAAAAGcAAABbAAAAcQAAAGMAAAB0AAAAagAAAF0AAABjAAAAWgAAAHUAAABtAAAAcQAAAGsAAAB/AAAAZQAAAF4AAABzAAAAaAAAAHAAAABsAAAAZAAAAF8AAABcAAAAdgAAAHIAAABtAAAAbQAAAGwAAABdAAAAXwAAAHUAAAB2AAAAagAAAG4AAABiAAAAaAAAAGAAAAB3AAAAbwAAAHMAAABvAAAAYQAAAG4AAABiAAAAdAAAAGcAAAB3AAAAcAAAAGsAAABmAAAAZQAAAHgAAABzAAAAcgAAAHEAAABjAAAAdAAAAGkAAAB1AAAAagAAAHkAAAByAAAAcAAAAGQAAABmAAAAdgAAAHgAAABsAAAAcwAAAG4AAABrAAAAaAAAAHgAAAB3AAAAcAAAAHQAAABnAAAAdwAAAG8AAABxAAAAaQAAAHkAAAB1AAAAfwAAAG0AAAB2AAAAcQAAAHkAAABqAAAAdgAAAHgAAABsAAAAcgAAAHUAAAB5AAAAbQAAAHcAAABvAAAAcwAAAG4AAAB5AAAAdAAAAHgAAAB4AAAAcwAAAHIAAABwAAAAeQAAAHcAAAB2AAAAeQAAAHQAAAB4AAAAdwAAAHUAAABxAAAAdgAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAQAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAADAAAABQAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAgAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAABQAAAAUAAAAAAAAAAAAAAP////8BAAAAAAAAAAMAAAAEAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAQAAAP//////////AQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAIAAAAAAAAAAAAAAAEAAAACAAAABgAAAAQAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAoAAAACAAAAAAAAAAAAAAABAAAAAQAAAAUAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAAAAAAAAAAAAAEAAAADAAAABwAAAAYAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAJAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAAAAAAAAAAAAQAAAAQAAAAIAAAACgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAAAAAAAAAAABAAAACwAAAA8AAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAgAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAAAAAAAAAAABAAAADAAAABAAAAAMAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAEAAAAKAAAAEwAAAAgAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAgAAAAAAAAAAAAAAAQAAAA0AAAARAAAADQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAAAAAAAAAAAAAEAAAAOAAAAEgAAAA8AAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAAAAAABAAAA//////////8TAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABIAAAAAAAAAGAAAAAAAAAAhAAAAAAAAAB4AAAAAAAAAIAAAAAMAAAAxAAAAAQAAADAAAAADAAAAMgAAAAMAAAAIAAAAAAAAAAUAAAAFAAAACgAAAAUAAAAWAAAAAAAAABAAAAAAAAAAEgAAAAAAAAApAAAAAQAAACEAAAAAAAAAHgAAAAAAAAAEAAAAAAAAAAAAAAAFAAAAAgAAAAUAAAAPAAAAAQAAAAgAAAAAAAAABQAAAAUAAAAfAAAAAQAAABYAAAAAAAAAEAAAAAAAAAACAAAAAAAAAAYAAAAAAAAADgAAAAAAAAAKAAAAAAAAAAsAAAAAAAAAEQAAAAMAAAAYAAAAAQAAABcAAAADAAAAGQAAAAMAAAAAAAAAAAAAAAEAAAAFAAAACQAAAAUAAAAFAAAAAAAAAAIAAAAAAAAABgAAAAAAAAASAAAAAQAAAAoAAAAAAAAACwAAAAAAAAAEAAAAAQAAAAMAAAAFAAAABwAAAAUAAAAIAAAAAQAAAAAAAAAAAAAAAQAAAAUAAAAQAAAAAQAAAAUAAAAAAAAAAgAAAAAAAAAHAAAAAAAAABUAAAAAAAAAJgAAAAAAAAAJAAAAAAAAABMAAAAAAAAAIgAAAAMAAAAOAAAAAQAAABQAAAADAAAAJAAAAAMAAAADAAAAAAAAAA0AAAAFAAAAHQAAAAUAAAABAAAAAAAAAAcAAAAAAAAAFQAAAAAAAAAGAAAAAQAAAAkAAAAAAAAAEwAAAAAAAAAEAAAAAgAAAAwAAAAFAAAAGgAAAAUAAAAAAAAAAQAAAAMAAAAAAAAADQAAAAUAAAACAAAAAQAAAAEAAAAAAAAABwAAAAAAAAAaAAAAAAAAACoAAAAAAAAAOgAAAAAAAAAdAAAAAAAAACsAAAAAAAAAPgAAAAMAAAAmAAAAAQAAAC8AAAADAAAAQAAAAAMAAAAMAAAAAAAAABwAAAAFAAAALAAAAAUAAAANAAAAAAAAABoAAAAAAAAAKgAAAAAAAAAVAAAAAQAAAB0AAAAAAAAAKwAAAAAAAAAEAAAAAwAAAA8AAAAFAAAAHwAAAAUAAAADAAAAAQAAAAwAAAAAAAAAHAAAAAUAAAAHAAAAAQAAAA0AAAAAAAAAGgAAAAAAAAAfAAAAAAAAACkAAAAAAAAAMQAAAAAAAAAsAAAAAAAAADUAAAAAAAAAPQAAAAMAAAA6AAAAAQAAAEEAAAADAAAASwAAAAMAAAAPAAAAAAAAABYAAAAFAAAAIQAAAAUAAAAcAAAAAAAAAB8AAAAAAAAAKQAAAAAAAAAqAAAAAQAAACwAAAAAAAAANQAAAAAAAAAEAAAABAAAAAgAAAAFAAAAEAAAAAUAAAAMAAAAAQAAAA8AAAAAAAAAFgAAAAUAAAAaAAAAAQAAABwAAAAAAAAAHwAAAAAAAAAyAAAAAAAAADAAAAAAAAAAMQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAIQAAAAMAAAAYAAAAAwAAABIAAAADAAAAEAAAAAMAAABGAAAAAAAAAEMAAAAAAAAAQgAAAAMAAAA0AAAAAwAAADIAAAAAAAAAMAAAAAAAAAAlAAAAAwAAACAAAAAAAAAAHgAAAAMAAABTAAAAAAAAAFcAAAADAAAAVQAAAAMAAABKAAAAAwAAAEYAAAAAAAAAQwAAAAAAAAA5AAAAAQAAADQAAAADAAAAMgAAAAAAAAAZAAAAAAAAABcAAAAAAAAAGAAAAAMAAAARAAAAAAAAAAsAAAADAAAACgAAAAMAAAAOAAAAAwAAAAYAAAADAAAAAgAAAAMAAAAtAAAAAAAAACcAAAAAAAAAJQAAAAMAAAAjAAAAAwAAABkAAAAAAAAAFwAAAAAAAAAbAAAAAwAAABEAAAAAAAAACwAAAAMAAAA/AAAAAAAAADsAAAADAAAAOQAAAAMAAAA4AAAAAwAAAC0AAAAAAAAAJwAAAAAAAAAuAAAAAwAAACMAAAADAAAAGQAAAAAAAAAkAAAAAAAAABQAAAAAAAAADgAAAAMAAAAiAAAAAAAAABMAAAADAAAACQAAAAMAAAAmAAAAAwAAABUAAAADAAAABwAAAAMAAAA3AAAAAAAAACgAAAAAAAAAGwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAFAAAAAAAAAAzAAAAAwAAACIAAAAAAAAAEwAAAAMAAABIAAAAAAAAADwAAAADAAAALgAAAAMAAABJAAAAAwAAADcAAAAAAAAAKAAAAAAAAABHAAAAAwAAADYAAAADAAAAJAAAAAAAAABAAAAAAAAAAC8AAAAAAAAAJgAAAAMAAAA+AAAAAAAAACsAAAADAAAAHQAAAAMAAAA6AAAAAwAAACoAAAADAAAAGgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAMwAAAAMAAABSAAAAAwAAAEAAAAAAAAAALwAAAAAAAABMAAAAAwAAAD4AAAAAAAAAKwAAAAMAAABhAAAAAAAAAFkAAAADAAAARwAAAAMAAABiAAAAAwAAAFQAAAAAAAAARQAAAAAAAABgAAAAAwAAAFIAAAADAAAAQAAAAAAAAABLAAAAAAAAAEEAAAAAAAAAOgAAAAMAAAA9AAAAAAAAADUAAAADAAAALAAAAAMAAAAxAAAAAwAAACkAAAADAAAAHwAAAAMAAABeAAAAAAAAAFYAAAAAAAAATAAAAAMAAABRAAAAAwAAAEsAAAAAAAAAQQAAAAAAAABCAAAAAwAAAD0AAAAAAAAANQAAAAMAAABrAAAAAAAAAGgAAAADAAAAYAAAAAMAAABlAAAAAwAAAF4AAAAAAAAAVgAAAAAAAABVAAAAAwAAAFEAAAADAAAASwAAAAAAAAA5AAAAAAAAADsAAAAAAAAAPwAAAAMAAABKAAAAAAAAAE4AAAADAAAATwAAAAMAAABTAAAAAwAAAFwAAAADAAAAXwAAAAMAAAAlAAAAAAAAACcAAAADAAAALQAAAAMAAAA0AAAAAAAAADkAAAAAAAAAOwAAAAAAAABGAAAAAwAAAEoAAAAAAAAATgAAAAMAAAAYAAAAAAAAABcAAAADAAAAGQAAAAMAAAAgAAAAAwAAACUAAAAAAAAAJwAAAAMAAAAyAAAAAwAAADQAAAAAAAAAOQAAAAAAAAAuAAAAAAAAADwAAAAAAAAASAAAAAMAAAA4AAAAAAAAAEQAAAADAAAAUAAAAAMAAAA/AAAAAwAAAE0AAAADAAAAWgAAAAMAAAAbAAAAAAAAACgAAAADAAAANwAAAAMAAAAjAAAAAAAAAC4AAAAAAAAAPAAAAAAAAAAtAAAAAwAAADgAAAAAAAAARAAAAAMAAAAOAAAAAAAAABQAAAADAAAAJAAAAAMAAAARAAAAAwAAABsAAAAAAAAAKAAAAAMAAAAZAAAAAwAAACMAAAAAAAAALgAAAAAAAABHAAAAAAAAAFkAAAAAAAAAYQAAAAMAAABJAAAAAAAAAFsAAAADAAAAZwAAAAMAAABIAAAAAwAAAFgAAAADAAAAaQAAAAMAAAAzAAAAAAAAAEUAAAADAAAAVAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAWQAAAAAAAAA3AAAAAwAAAEkAAAAAAAAAWwAAAAMAAAAmAAAAAAAAAC8AAAADAAAAQAAAAAMAAAAiAAAAAwAAADMAAAAAAAAARQAAAAMAAAAkAAAAAwAAADYAAAAAAAAARwAAAAAAAABgAAAAAAAAAGgAAAAAAAAAawAAAAMAAABiAAAAAAAAAG4AAAADAAAAcwAAAAMAAABhAAAAAwAAAG8AAAADAAAAdwAAAAMAAABMAAAAAAAAAFYAAAADAAAAXgAAAAMAAABSAAAAAAAAAGAAAAAAAAAAaAAAAAAAAABUAAAAAwAAAGIAAAAAAAAAbgAAAAMAAAA6AAAAAAAAAEEAAAADAAAASwAAAAMAAAA+AAAAAwAAAEwAAAAAAAAAVgAAAAMAAABAAAAAAwAAAFIAAAAAAAAAYAAAAAAAAABVAAAAAAAAAFcAAAAAAAAAUwAAAAMAAABlAAAAAAAAAGYAAAADAAAAZAAAAAMAAABrAAAAAwAAAHAAAAADAAAAcgAAAAMAAABCAAAAAAAAAEMAAAADAAAARgAAAAMAAABRAAAAAAAAAFUAAAAAAAAAVwAAAAAAAABeAAAAAwAAAGUAAAAAAAAAZgAAAAMAAAAxAAAAAAAAADAAAAADAAAAMgAAAAMAAAA9AAAAAwAAAEIAAAAAAAAAQwAAAAMAAABLAAAAAwAAAFEAAAAAAAAAVQAAAAAAAABfAAAAAAAAAFwAAAAAAAAAUwAAAAAAAABPAAAAAAAAAE4AAAAAAAAASgAAAAMAAAA/AAAAAQAAADsAAAADAAAAOQAAAAMAAABtAAAAAAAAAGwAAAAAAAAAZAAAAAUAAABdAAAAAQAAAF8AAAAAAAAAXAAAAAAAAABNAAAAAQAAAE8AAAAAAAAATgAAAAAAAAB1AAAABAAAAHYAAAAFAAAAcgAAAAUAAABqAAAAAQAAAG0AAAAAAAAAbAAAAAAAAABaAAAAAQAAAF0AAAABAAAAXwAAAAAAAABaAAAAAAAAAE0AAAAAAAAAPwAAAAAAAABQAAAAAAAAAEQAAAAAAAAAOAAAAAMAAABIAAAAAQAAADwAAAADAAAALgAAAAMAAABqAAAAAAAAAF0AAAAAAAAATwAAAAUAAABjAAAAAQAAAFoAAAAAAAAATQAAAAAAAABYAAAAAQAAAFAAAAAAAAAARAAAAAAAAAB1AAAAAwAAAG0AAAAFAAAAXwAAAAUAAABxAAAAAQAAAGoAAAAAAAAAXQAAAAAAAABpAAAAAQAAAGMAAAABAAAAWgAAAAAAAABpAAAAAAAAAFgAAAAAAAAASAAAAAAAAABnAAAAAAAAAFsAAAAAAAAASQAAAAMAAABhAAAAAQAAAFkAAAADAAAARwAAAAMAAABxAAAAAAAAAGMAAAAAAAAAUAAAAAUAAAB0AAAAAQAAAGkAAAAAAAAAWAAAAAAAAABvAAAAAQAAAGcAAAAAAAAAWwAAAAAAAAB1AAAAAgAAAGoAAAAFAAAAWgAAAAUAAAB5AAAAAQAAAHEAAAAAAAAAYwAAAAAAAAB3AAAAAQAAAHQAAAABAAAAaQAAAAAAAAB3AAAAAAAAAG8AAAAAAAAAYQAAAAAAAABzAAAAAAAAAG4AAAAAAAAAYgAAAAMAAABrAAAAAQAAAGgAAAADAAAAYAAAAAMAAAB5AAAAAAAAAHQAAAAAAAAAZwAAAAUAAAB4AAAAAQAAAHcAAAAAAAAAbwAAAAAAAABwAAAAAQAAAHMAAAAAAAAAbgAAAAAAAAB1AAAAAQAAAHEAAAAFAAAAaQAAAAUAAAB2AAAAAQAAAHkAAAAAAAAAdAAAAAAAAAByAAAAAQAAAHgAAAABAAAAdwAAAAAAAAByAAAAAAAAAHAAAAAAAAAAawAAAAAAAABkAAAAAAAAAGYAAAAAAAAAZQAAAAMAAABTAAAAAQAAAFcAAAADAAAAVQAAAAMAAAB2AAAAAAAAAHgAAAAAAAAAcwAAAAUAAABsAAAAAQAAAHIAAAAAAAAAcAAAAAAAAABcAAAAAQAAAGQAAAAAAAAAZgAAAAAAAAB1AAAAAAAAAHkAAAAFAAAAdwAAAAUAAABtAAAAAQAAAHYAAAAAAAAAeAAAAAAAAABfAAAAAQAAAGwAAAABAAAAcgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAB+ogX28rbpPxqumpJv+fM/165tC4ns9D+XaEnTqUsEQFrOtNlC4PA/3U+0XG6P9b9TdUUBxTTjP4PUp8ex1ty/B1rD/EN43z+lcDi6LLrZP/a45NWEHMY/oJ5ijLDZ+j/xw3rjxWPjP2B8A46ioQdAotff3wla2z+FMSpA1jj+v6b5Y1mtPbS/cIu8K0F457/2esiyJpDNv98k5Ts2NeA/pvljWa09tD88ClUJ60MDQPZ6yLImkM0/4ONKxa0UBcD2uOTVhBzGv5G7JRxGave/8cN648Vj47+HCwtkjAXIv6LX398JWtu/qyheaCAL9D9TdUUBxTTjv4gyTxslhwVAB1rD/EN4378EH/28teoFwH6iBfbytum/F6ztFYdK/r/Xrm0Liez0vwcS6wNGWeO/Ws602ULg8L9TCtRLiLT8P8pi5RexJsw/BlIKPVwR5T95Wyu0/QjnP5PjoT7YYcu/mBhKZ6zrwj8wRYS7NebuP3qW6geh+Ls/SLrixebL3r+pcyymN9XrPwmkNHp7xec/GWNMZVAA17+82s+x2BLiPwn2ytbJ9ek/LgEH1sMS1j8yp/2LhTfeP+SnWwtQBbu/d38gkp5X7z8ytsuHaADGPzUYObdf1+m/7IauECWhwz+cjSACjzniP76Z+wUhN9K/1+GEKzup67+/GYr/04baPw6idWOvsuc/ZedTWsRa5b/EJQOuRzi0v/OncYhHPes/h49PixY53j+i8wWfC03Nvw2idWOvsue/ZedTWsRa5T/EJQOuRzi0P/KncYhHPeu/iY9PixY53r+i8wWfC03NP9anWwtQBbs/d38gkp5X778ytsuHaADGvzUYObdf1+k/74auECWhw7+cjSACjzniv8CZ+wUhN9I/1uGEKzup6z+/GYr/04bavwmkNHp7xee/F2NMZVAA1z+82s+x2BLivwr2ytbJ9em/KwEH1sMS1r8yp/2LhTfev81i5RexJsy/BlIKPVwR5b95Wyu0/Qjnv5DjoT7YYcs/nBhKZ6zrwr8wRYS7Nebuv3OW6geh+Lu/SLrixebL3j+pcyymN9Xrv8rHIFfWehZAMBwUdlo0DECTUc17EOb2PxpVB1SWChdAzjbhb9pTDUDQhmdvECX5P9FlMKCC9+g/IIAzjELgE0DajDngMv8GQFhWDmDPjNs/y1guLh96EkAxPi8k7DIEQJCc4URlhRhA3eLKKLwkEECqpNAyTBD/P6xpjXcDiwVAFtl//cQm4z+Ibt3XKiYTQM7mCLUb3QdAoM1t8yVv7D8aLZv2Nk8UQEAJPV5nQwxAtSsfTCoE9z9TPjXLXIIWQBVanC5W9AtAYM3d7Adm9j++5mQz1FoWQBUThyaVBghAwH5muQsV7T89Q1qv82MUQJoWGOfNuBdAzrkClkmwDkDQjKq77t37Py+g0dtitsE/ZwAMTwVPEUBojepluNwBQGYbtuW+t9w/HNWIJs6MEkDTNuQUSlgEQKxktPP5TcQ/ixbLB8JjEUCwuWjXMQYCQAS/R09FkRdAowpiZjhhDkB7LmlczD/7P01iQmhhsAVAnrtTwDy84z/Z6jfQ2TgTQChOCXMnWwpAhrW3daoz8z/HYJvVPI4VQLT3ik5FcA5Angi7LOZd+z+NNVzDy5gXQBXdvVTFUA1AYNMgOeYe+T8+qHXGCwkXQKQTOKwa5AJA8gFVoEMW0T+FwzJyttIRQAEAAAD/////BwAAAP////8xAAAA/////1cBAAD/////YQkAAP////+nQQAA/////5HLAQD/////95AMAP/////B9lcAAAAAAAAAAAAAAAAAAgAAAP////8OAAAA/////2IAAAD/////rgIAAP/////CEgAA/////06DAAD/////IpcDAP/////uIRkA/////4LtrwAAAAAAAAAAAAAAAAAAAAAAAgAAAP//////////AQAAAAMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////wIAAAD//////////wEAAAAAAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA/////////////////////wEAAAD///////////////8CAAAA////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD///////////////////////////////8CAAAA////////////////AQAAAP////////////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAAAQAAAP//////////AgAAAP//////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAAEAAAD//////////wIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAgAAAAAAAAACAAAAAQAAAAEAAAACAAAAAgAAAAAAAAAFAAAABQAAAAAAAAACAAAAAgAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAABAAAAAgAAAAIAAAACAAAAAAAAAAUAAAAGAAAAAAAAAAIAAAACAAAAAwAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAIAAAAAAAAAAgAAAAEAAAADAAAAAgAAAAIAAAAAAAAABQAAAAcAAAAAAAAAAgAAAAIAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAACAAAAAQAAAAQAAAACAAAAAgAAAAAAAAAFAAAACAAAAAAAAAACAAAAAgAAAAMAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAACAAAAAAAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAUAAAAJAAAAAAAAAAIAAAACAAAAAwAAAAUAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAIAAAACAAAAAAAAAAMAAAAOAAAAAgAAAAAAAAACAAAAAwAAAAAAAAAAAAAAAgAAAAIAAAADAAAABgAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAgAAAAIAAAAAAAAAAwAAAAoAAAACAAAAAAAAAAIAAAADAAAAAQAAAAAAAAACAAAAAgAAAAMAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAgAAAAAAAAADAAAACwAAAAIAAAAAAAAAAgAAAAMAAAACAAAAAAAAAAIAAAACAAAAAwAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAACAAAAAAAAAAMAAAAMAAAAAgAAAAAAAAACAAAAAwAAAAMAAAAAAAAAAgAAAAIAAAADAAAACQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAIAAAAAAAAAAwAAAA0AAAACAAAAAAAAAAIAAAADAAAABAAAAAAAAAACAAAAAgAAAAMAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAgAAAAAAAAADAAAABgAAAAIAAAAAAAAAAgAAAAMAAAAPAAAAAAAAAAIAAAACAAAAAwAAAAsAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAIAAAACAAAAAAAAAAMAAAAHAAAAAgAAAAAAAAACAAAAAwAAABAAAAAAAAAAAgAAAAIAAAADAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAIAAAAAAAAAAwAAAAgAAAACAAAAAAAAAAIAAAADAAAAEQAAAAAAAAACAAAAAgAAAAMAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAACAAAAAgAAAAAAAAADAAAACQAAAAIAAAAAAAAAAgAAAAMAAAASAAAAAAAAAAIAAAACAAAAAwAAAA4AAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAACAAAAAAAAAAMAAAAFAAAAAgAAAAAAAAACAAAAAwAAABMAAAAAAAAAAgAAAAIAAAADAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAgAAAAAAAAACAAAAAQAAABMAAAACAAAAAgAAAAAAAAAFAAAACgAAAAAAAAACAAAAAgAAAAMAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABEAAAACAAAAAAAAAAIAAAABAAAADwAAAAIAAAACAAAAAAAAAAUAAAALAAAAAAAAAAIAAAACAAAAAwAAABEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAIAAAAAAAAAAgAAAAEAAAAQAAAAAgAAAAIAAAAAAAAABQAAAAwAAAAAAAAAAgAAAAIAAAADAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAACAAAAAQAAABEAAAACAAAAAgAAAAAAAAAFAAAADQAAAAAAAAACAAAAAgAAAAMAAAATAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAACAAAAAAAAAAIAAAABAAAAEgAAAAIAAAACAAAAAAAAAAUAAAAOAAAAAAAAAAIAAAACAAAAAwAAAAIAAAABAAAAAAAAAAEAAAACAAAAAAAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAEAAAAAAAAAAgAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAgAAAAAAAAABAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAFAAAAAAAAAAEAAAAAAAAAAAAAAMuhRbbsNlBBYqHW9OmHIkF9XBuqnS31QAK37uYhNMhAOSo3UUupm0DC+6pc6JxvQHV9eseEEEJAzURsCyqlFEB8BQ4NMJjnPyy3tBoS97o/xawXQznRjj89J2K2CZxhP6vX43RIIDQ/S8isgygEBz+LvFHQkmzaPjFFFO7wMq4+AADMLkTtjkIAAOgkJqxhQgAAU7B0MjRCAADwpBcVB0IAAACYP2HaQQAAAIn/Ja5BzczM4Eg6gUHNzMxMU7BTQTMzMzNfgCZBAAAAAEi3+UAAAAAAwGPNQDMzMzMzy6BAmpmZmZkxc0AzMzMzM/NFQDMzMzMzMxlAzczMzMzM7D+ygXSx2U6RQKimJOvQKnpA23hmONTHY0A/AGcxyudNQNb3K647mzZA+S56rrwWIUAm4kUQ+9UJQKre9hGzh/M/BLvoy9WG3T+LmqMf8VHGP2m3nYNV37A/gbFHcyeCmT+cBPWBckiDP61tZACjKW0/q2RbYVUYVj8uDypVyLNAP6jGS5cA5zBBwcqhBdCNGUEGEhQ/JVEDQT6WPnRbNO1AB/AWSJgT1kDfUWNCNLDAQNk+5C33OqlAchWL34QSk0DKvtDIrNV8QNF0G3kFzGVASSeWhBl6UED+/0mNGuk4QGjA/dm/1CJALPLPMql6DEDSHoDrwpP1P2jouzWST+A/egAAAAAAAABKAwAAAAAAAPoWAAAAAAAAyqAAAAAAAAB6ZQQAAAAAAErGHgAAAAAA+mvXAAAAAADK8+MFAAAAAHqqOykAAAAASqmhIAEAAAD6oGvkBwAAAMpm8T43AAAAes+ZuIIBAABKrDQMkwoAAPq1cFUFSgAAyvkUViUGAgAAAAAAAwAAAAYAAAACAAAABQAAAAEAAAAEAAAAAAAAAAAAAAAFAAAAAwAAAAEAAAAGAAAABAAAAAIAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAA/////wAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAP////8AAAAAAAAAAAEAAAABAAAAAAAAAAAAAAD/////AAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAAAAAAABAAEAAAEBAAAAAAABAAAAAQAAAAEAAQAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAHAAAABwAAAAEAAAACAAAABAAAAAMAAAAAAAAAAAAAAAcAAAADAAAAAQAAAAIAAAAFAAAABAAAAAAAAAAAAAAAYWxnb3MuYwBfcG9seWZpbGxJbnRlcm5hbABhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0dlb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9HZW9Cb3VuZGFyeQBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGgzVG9Mb2NhbElqawBiYXNlQ2VsbCAhPSBvcmlnaW5CYXNlQ2VsbAAhKG9yaWdpbk9uUGVudCAmJiBpbmRleE9uUGVudCkAcGVudGFnb25Sb3RhdGlvbnMgPj0gMABkaXJlY3Rpb25Sb3RhdGlvbnMgPj0gMABiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvSDMAIV9pc0Jhc2VDZWxsUGVudGFnb24oYmFzZUNlbGwpAGJhc2VDZWxsUm90YXRpb25zID49IDAAd2l0aGluUGVudGFnb25Sb3RhdGlvbnMgPj0gMABncmFwaC0+YnVja2V0cyAhPSBOVUxMAHZlcnRleEdyYXBoLmMAaW5pdFZlcnRleEdyYXBoAG5vZGUgIT0gTlVMTABhZGRWZXJ0ZXhOb2Rl";var H="function"==typeof atob?atob:function(t){var e,n,r,i,o,s,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="",u=0;t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{e=a.indexOf(t.charAt(u++))<<2|(i=a.indexOf(t.charAt(u++)))>>4,n=(15&i)<<4|(o=a.indexOf(t.charAt(u++)))>>2,r=(3&o)<<6|(s=a.indexOf(t.charAt(u++))),l+=String.fromCharCode(e),64!==o&&(l+=String.fromCharCode(n)),64!==s&&(l+=String.fromCharCode(r))}while(u<t.length);return l};function X(t){if(V(t))return function(t){try{for(var e=H(t),n=new Uint8Array(e.length),r=0;r<e.length;++r)n[r]=e.charCodeAt(r);return n}catch(t){throw new Error("Converting base64 string to bytes failed.")}}(t.slice(U.length))}var $,Y,Q=function(t,e,n){var r=new t.Int8Array(n),i=new t.Int32Array(n),o=(new t.Uint8Array(n),new t.Float32Array(n),new t.Float64Array(n)),s=0|e.p,a=t.Math.floor,l=t.Math.abs,u=t.Math.sqrt,c=t.Math.pow,h=t.Math.cos,p=t.Math.sin,f=t.Math.tan,d=t.Math.acos,g=t.Math.asin,m=t.Math.atan,A=t.Math.atan2,y=t.Math.ceil,_=t.Math.imul,v=t.Math.min,b=t.Math.clz32,x=e.b,w=e.c,E=e.d,S=e.e,T=e.f,P=e.g,M=e.h,C=e.i,I=24048;function O(t,e,n,r){var i,o;0|R(t|=0,e|=0,n|=0,r|=0,0)&&(Me(0|r,0,(o=1+(0|_(3*n|0,n+1|0))|0)<<3|0),(i=0|_e(o,4))&&(L(t,e,n,r,i,o,0),ye(i)))}function R(t,e,n,r,o){t|=0,e|=0,n|=0,o|=0;var s,a=0,l=0,u=0,c=0,h=0,p=0,f=0,d=0;if(s=I,I=I+16|0,d=s,i[(a=r|=0)>>2]=t,i[a+4>>2]=e,(a=0!=(0|o))&&(i[o>>2]=0),0|kt(t,e))return I=s,1;i[d>>2]=0;t:do{if((0|n)>=1)if(a)for(h=0,p=1,f=1,l=0,a=t;;){if(!(l|h)){if(0==(0|(a=0|k(a,e,4,d)))&0==(0|(e=0|w()))){a=2;break t}if(0|kt(a,e)){a=1;break t}}if(0==(0|(a=0|k(a,e,0|i[16+(h<<2)>>2],d)))&0==(0|(e=0|w()))){a=2;break t}if(i[(t=r+(f<<3)|0)>>2]=a,i[t+4>>2]=e,i[o+(f<<2)>>2]=p,t=(0|(l=l+1|0))==(0|p),c=6==(0|(u=h+1|0)),0|kt(a,e)){a=1;break t}if((0|(p=p+(c&t&1)|0))>(0|n)){a=0;break}h=t?c?0:u:h,f=f+1|0,l=t?0:l}else for(h=0,p=1,f=1,l=0,a=t;;){if(!(l|h)){if(0==(0|(a=0|k(a,e,4,d)))&0==(0|(e=0|w()))){a=2;break t}if(0|kt(a,e)){a=1;break t}}if(0==(0|(a=0|k(a,e,0|i[16+(h<<2)>>2],d)))&0==(0|(e=0|w()))){a=2;break t}if(i[(t=r+(f<<3)|0)>>2]=a,i[t+4>>2]=e,t=(0|(l=l+1|0))==(0|p),c=6==(0|(u=h+1|0)),0|kt(a,e)){a=1;break t}if((0|(p=p+(c&t&1)|0))>(0|n)){a=0;break}h=t?c?0:u:h,f=f+1|0,l=t?0:l}else a=0}while(0);return I=s,0|a}function L(t,e,n,r,o,s,a){n|=0,r|=0,o|=0,s|=0,a|=0;var l,u,c=0,h=0,p=0,f=0,d=0;if(u=I,I=I+16|0,l=u,0==(0|(t|=0))&0==(0|(e|=0)))I=u;else{if(c=0|xe(0|t,0|e,0|s,((0|s)<0)<<31>>31|0),w(),!(0==(0|(d=0|i[(f=h=r+(c<<3)|0)>>2]))&0==(0|(f=0|i[f+4>>2]))|(p=(0|d)==(0|t)&(0|f)==(0|e))))do{p=(0|(f=0|i[(d=h=r+((c=(c+1|0)%(0|s)|0)<<3)|0)>>2]))==(0|t)&(0|(d=0|i[d+4>>2]))==(0|e)}while(!(0==(0|f)&0==(0|d)|p));c=o+(c<<2)|0,p&&(0|i[c>>2])<=(0|a)||(i[(d=h)>>2]=t,i[d+4>>2]=e,i[c>>2]=a,(0|a)>=(0|n)||(d=a+1|0,i[l>>2]=0,L(f=0|k(t,e,2,l),0|w(),n,r,o,s,d),i[l>>2]=0,L(f=0|k(t,e,3,l),0|w(),n,r,o,s,d),i[l>>2]=0,L(f=0|k(t,e,1,l),0|w(),n,r,o,s,d),i[l>>2]=0,L(f=0|k(t,e,5,l),0|w(),n,r,o,s,d),i[l>>2]=0,L(f=0|k(t,e,4,l),0|w(),n,r,o,s,d),i[l>>2]=0,L(f=0|k(t,e,6,l),0|w(),n,r,o,s,d))),I=u}}function k(t,e,n,r){t|=0,e|=0,n|=0;var o,s,a=0,l=0,u=0,c=0,h=0,p=0,f=0;if((0|i[(r|=0)>>2])>0){a=0;do{n=0|lt(n),a=a+1|0}while((0|a)<(0|i[r>>2]))}o=0|we(0|t,0|e,45),w(),s=127&o,l=0|Dt(t,e),a=0|we(0|t,0|e,52),w(),a&=15;t:do{if(a)for(;;){if(p=0|we(0|t,0|e,0|(h=3*(15-a|0)|0)),w(),p&=7,f=0==(0|jt(a)),a=a+-1|0,c=0|Ee(7,0,0|h),e&=~(0|w()),t=(h=0|Ee(0|i[(f?464:48)+(28*p|0)+(n<<2)>>2],0,0|h))|t&~c,e|=0|w(),!(n=0|i[(f?672:256)+(28*p|0)+(n<<2)>>2])){n=0;break t}if(!a){u=6;break}}else u=6}while(0);6==(0|u)&&(t|=p=0|Ee(0|(f=0|i[880+(28*s|0)+(n<<2)>>2]),0,45),e=0|w()|-1040385&e,n=0|i[4304+(28*s|0)+(n<<2)>>2],127==(127&f|0)&&(f=0|Ee(0|i[880+(28*s|0)+20>>2],0,45),e=0|w()|-1040385&e,n=0|i[4304+(28*s|0)+20>>2],t=0|Ft(f|t,e),e=0|w(),i[r>>2]=1+(0|i[r>>2]))),u=0|we(0|t,0|e,45),w(),u&=127;t:do{if(0|N(u)){e:do{if(1==(0|Dt(t,e))){if((0|s)!=(0|u)){if(0|j(u,0|i[7728+(28*s|0)>>2])){t=0|zt(t,e),l=1,e=0|w();break}t=0|Ft(t,e),l=1,e=0|w();break}switch(0|l){case 5:t=0|zt(t,e),e=0|w(),i[r>>2]=5+(0|i[r>>2]),l=0;break e;case 3:t=0|Ft(t,e),e=0|w(),i[r>>2]=1+(0|i[r>>2]),l=0;break e;default:return f=0,x(0|(p=0)),0|f}}else l=0}while(0);if((0|n)>0){a=0;do{t=0|Nt(t,e),e=0|w(),a=a+1|0}while((0|a)!=(0|n))}if((0|s)!=(0|u)){if(!(0|F(u))){if(0!=(0|l)|5!=(0|Dt(t,e)))break;i[r>>2]=1+(0|i[r>>2]);break}switch(127&o){case 8:case 118:break t}3!=(0|Dt(t,e))&&(i[r>>2]=1+(0|i[r>>2]))}}else if((0|n)>0){a=0;do{t=0|Ft(t,e),e=0|w(),a=a+1|0}while((0|a)!=(0|n))}}while(0);return i[r>>2]=((0|i[r>>2])+n|0)%6|0,f=t,x(0|(p=e)),0|f}function D(t,e,n,r,s,a){e|=0,n|=0,r|=0,s|=0,a|=0;var l,u,c,h,p,f,d,g,m,A=0,y=0,_=0,v=0,b=0,x=0,E=0,S=0,T=0,P=0,M=0,C=0,O=0,R=0;if(m=I,I=I+48|0,f=m+32|0,d=m+16|0,g=m,(0|(A=0|i[(t|=0)>>2]))<=0)return I=m,0;l=t+4|0,u=f+8|0,c=d+8|0,h=g+8|0,p=((0|e)<0)<<31>>31,M=0;t:for(;;){T=(y=0|i[l>>2])+(M<<4)|0,i[f>>2]=i[T>>2],i[f+4>>2]=i[T+4>>2],i[f+8>>2]=i[T+8>>2],i[f+12>>2]=i[T+12>>2],(0|M)==(A+-1|0)?(i[d>>2]=i[y>>2],i[d+4>>2]=i[y+4>>2],i[d+8>>2]=i[y+8>>2],i[d+12>>2]=i[y+12>>2]):(T=y+(M+1<<4)|0,i[d>>2]=i[T>>2],i[d+4>>2]=i[T+4>>2],i[d+8>>2]=i[T+8>>2],i[d+12>>2]=i[T+12>>2]),T=0|W(f,d,n);e:do{if((0|T)>0){P=+(0|T),S=0;n:for(;;){R=+(T-S|0),O=+(0|S),o[g>>3]=+o[f>>3]*R/P+ +o[d>>3]*O/P,o[h>>3]=+o[u>>3]*R/P+ +o[c>>3]*O/P,y=0|xe(0|(x=0|Ut(g,n)),0|(E=0|w()),0|e,0|p),w(),v=0|i[(_=A=a+(y<<3)|0)>>2],_=0|i[_+4>>2];r:do{if(0==(0|v)&0==(0|_))C=14;else for(b=0;;){if((0|b)>(0|e)){A=1;break r}if((0|v)==(0|x)&(0|_)==(0|E)){A=7;break r}if(0==(0|(v=0|i[(_=A=a+((y=(y+1|0)%(0|e)|0)<<3)|0)>>2]))&0==(0|(_=0|i[_+4>>2]))){C=14;break}b=b+1|0}}while(0);switch(14==(0|C)&&(C=0,0==(0|x)&0==(0|E)?A=7:(i[A>>2]=x,i[A+4>>2]=E,A=0|i[r>>2],i[(b=s+(A<<3)|0)>>2]=x,i[b+4>>2]=E,i[r>>2]=A+1,A=0)),7&A){case 7:case 0:break;default:break n}if((0|T)<=(0|(S=S+1|0))){C=8;break e}}if(0|A){A=-1,C=20;break t}}else C=8}while(0);if(8==(0|C)&&(C=0),(0|(M=M+1|0))>=(0|(A=0|i[t>>2]))){A=0,C=20;break}}return 20==(0|C)?(I=m,0|A):0}function N(t){return 0|i[7728+(28*(t|=0)|0)+16>>2]}function F(t){return 4==(0|(t|=0))|117==(0|t)|0}function B(t){return 0|i[11152+(216*(0|i[(t|=0)>>2])|0)+(72*(0|i[t+4>>2])|0)+(24*(0|i[t+8>>2])|0)+(i[t+12>>2]<<3)>>2]}function z(t){return 0|i[11152+(216*(0|i[(t|=0)>>2])|0)+(72*(0|i[t+4>>2])|0)+(24*(0|i[t+8>>2])|0)+(i[t+12>>2]<<3)+4>>2]}function j(t,e){return e|=0,(0|i[7728+(28*(t|=0)|0)+20>>2])==(0|e)?0|(e=1):0|(e=(0|i[7728+(28*t|0)+24>>2])==(0|e))}function U(t,e){return 0|i[880+(28*(t|=0)|0)+((e|=0)<<2)>>2]}function V(t,e){return e|=0,(0|i[880+(28*(t|=0)|0)>>2])==(0|e)?0|(e=0):(0|i[880+(28*t|0)+4>>2])==(0|e)?0|(e=1):(0|i[880+(28*t|0)+8>>2])==(0|e)?0|(e=2):(0|i[880+(28*t|0)+12>>2])==(0|e)?0|(e=3):(0|i[880+(28*t|0)+16>>2])==(0|e)?0|(e=4):(0|i[880+(28*t|0)+20>>2])==(0|e)?0|(e=5):0|((0|i[880+(28*t|0)+24>>2])==(0|e)?6:7)}function G(t){return+o[16+(t|=0)>>3]<+o[t+24>>3]|0}function Z(t,e){t|=0;var n,r,i=0;return(i=+o[(e|=0)>>3])>=+o[t+8>>3]&&i<=+o[t>>3]?(n=+o[t+16>>3],i=+o[t+24>>3],e=(r=+o[e+8>>3])>=i,t=r<=n&1,n<i?e&&(t=1):e||(t=0),0|(e=0!=(0|t))):0|(e=0)}function q(t,e){t|=0,e|=0;var n,r,s,a,u,c,h=0,p=0;a=I,I=I+288|0,n=a+264|0,r=a+96|0,p=(h=s=a)+96|0;do{i[h>>2]=0,h=h+4|0}while((0|h)<(0|p));return Wt(e,s),Zt(p=0|i[(h=s)>>2],h=0|i[h+4>>2],n),qt(p,h,r),u=+Mt(n,r+8|0),o[n>>3]=+o[t>>3],o[(h=n+8|0)>>3]=+o[t+16>>3],o[r>>3]=+o[t+8>>3],o[(p=r+8|0)>>3]=+o[t+24>>3],c=+Mt(n,r),p=~~+y(+c*c/+Se(+ +l(+(+o[h>>3]-+o[p>>3])/(+o[n>>3]-+o[r>>3])),3)/(u*(2.59807621135*u)*.8)),I=a,0|(0==(0|p)?1:p)}function W(t,e,n){t|=0,e|=0,n|=0;var r,o,s,a,l,u=0,c=0;a=I,I=I+288|0,r=a+264|0,o=a+96|0,c=(u=s=a)+96|0;do{i[u>>2]=0,u=u+4|0}while((0|u)<(0|c));return Wt(n,s),Zt(u=0|i[(c=s)>>2],c=0|i[c+4>>2],r),qt(u,c,o),l=+Mt(r,o+8|0),c=~~+y(+ +Mt(t,e)/(2*l)),I=a,0|(0==(0|c)?1:c)}function H(t,e,n,r){e|=0,n|=0,r|=0,i[(t|=0)>>2]=e,i[t+4>>2]=n,i[t+8>>2]=r}function X(t,e){t|=0;var n,r,s,a,u=0,c=0,h=0,p=0,f=0,d=0,g=0;i[(a=8+(e|=0)|0)>>2]=0,r=+o[t>>3],p=+l(+r),s=+o[t+8>>3],p+=.5*(f=+l(+s)/.8660254037844386),p-=+(0|(u=~~p)),f-=+(0|(t=~~f));do{if(p<.5){if(p<.3333333333333333){if(i[e>>2]=u,f<.5*(p+1)){i[e+4>>2]=t;break}t=t+1|0,i[e+4>>2]=t;break}if(t=(1&!(f<(g=1-p)))+t|0,i[e+4>>2]=t,g<=f&f<2*p){u=u+1|0,i[e>>2]=u;break}i[e>>2]=u;break}if(!(p<.6666666666666666)){if(u=u+1|0,i[e>>2]=u,f<.5*p){i[e+4>>2]=t;break}t=t+1|0,i[e+4>>2]=t;break}if(f<1-p){if(i[e+4>>2]=t,2*p-1<f){i[e>>2]=u;break}}else t=t+1|0,i[e+4>>2]=t;u=u+1|0,i[e>>2]=u}while(0);do{if(r<0){if(1&t){u=~~(+(0|u)-(2*(+((d=0|ve(0|u,((0|u)<0)<<31>>31|0,0|(d=(t+1|0)/2|0),((0|d)<0)<<31>>31|0))>>>0)+4294967296*+(0|w()))+1)),i[e>>2]=u;break}u=~~(+(0|u)-2*(+((d=0|ve(0|u,((0|u)<0)<<31>>31|0,0|(d=(0|t)/2|0),((0|d)<0)<<31>>31|0))>>>0)+4294967296*+(0|w()))),i[e>>2]=u;break}}while(0);d=e+4|0,s<0&&(u=u-((1|t<<1)/2|0)|0,i[e>>2]=u,t=0-t|0,i[d>>2]=t),c=t-u|0,(0|u)<0?(h=0-u|0,i[d>>2]=c,i[a>>2]=h,i[e>>2]=0,t=c,u=0):h=0,(0|t)<0&&(u=u-t|0,i[e>>2]=u,h=h-t|0,i[a>>2]=h,i[d>>2]=0,t=0),n=u-h|0,c=t-h|0,(0|h)<0&&(i[e>>2]=n,i[d>>2]=c,i[a>>2]=0,t=c,u=n,h=0),(0|(c=(0|h)<(0|(c=(0|t)<(0|u)?t:u))?h:c))<=0||(i[e>>2]=u-c,i[d>>2]=t-c,i[a>>2]=h-c)}function $(t){var e,n=0,r=0,o=0,s=0,a=0;n=0|i[(t|=0)>>2],r=0|i[(e=t+4|0)>>2],(0|n)<0&&(r=r-n|0,i[e>>2]=r,i[(a=t+8|0)>>2]=(0|i[a>>2])-n,i[t>>2]=0,n=0),(0|r)<0?(n=n-r|0,i[t>>2]=n,s=(0|i[(a=t+8|0)>>2])-r|0,i[a>>2]=s,i[e>>2]=0,r=0):(a=s=t+8|0,s=0|i[s>>2]),(0|s)<0&&(n=n-s|0,i[t>>2]=n,r=r-s|0,i[e>>2]=r,i[a>>2]=0,s=0),(0|(o=(0|s)<(0|(o=(0|r)<(0|n)?r:n))?s:o))<=0||(i[t>>2]=n-o,i[e>>2]=r-o,i[a>>2]=s-o)}function Y(t,e){var n,r;e|=0,r=0|i[8+(t|=0)>>2],n=+((0|i[t+4>>2])-r|0),o[e>>3]=+((0|i[t>>2])-r|0)-.5*n,o[e+8>>3]=.8660254037844386*n}function Q(t,e,n){t|=0,e|=0,i[(n|=0)>>2]=(0|i[e>>2])+(0|i[t>>2]),i[n+4>>2]=(0|i[e+4>>2])+(0|i[t+4>>2]),i[n+8>>2]=(0|i[e+8>>2])+(0|i[t+8>>2])}function K(t,e,n){t|=0,e|=0,i[(n|=0)>>2]=(0|i[t>>2])-(0|i[e>>2]),i[n+4>>2]=(0|i[t+4>>2])-(0|i[e+4>>2]),i[n+8>>2]=(0|i[t+8>>2])-(0|i[e+8>>2])}function J(t,e){e|=0;var n,r=0;r=0|_(0|i[(t|=0)>>2],e),i[t>>2]=r,n=0|_(0|i[(r=t+4|0)>>2],e),i[r>>2]=n,e=0|_(0|i[(t=t+8|0)>>2],e),i[t>>2]=e}function tt(t){var e,n,r=0,o=0,s=0,a=0,l=0;l=(0|(n=0|i[(t|=0)>>2]))<0,t=(t=(o=(0|(a=((e=(0|(s=(0|i[t+4>>2])-(l?n:0)|0))<0)?0-s|0:0)+((0|i[t+8>>2])-(l?n:0))|0))<0)?0:a)-((s=(0|(o=(0|t)<(0|(o=(0|(r=(e?0:s)-(o?a:0)|0))<(0|(a=(l?0:n)-(e?s:0)-(o?a:0)|0))?r:a))?t:o))>0)?o:0)|0,r=r-(s?o:0)|0;t:do{switch(a-(s?o:0)|0){case 0:switch(0|r){case 0:return 0|(0==(0|t)?0:1==(0|t)?1:7);case 1:return 0|(0==(0|t)?2:1==(0|t)?3:7);default:break t}case 1:switch(0|r){case 0:return 0|(0==(0|t)?4:1==(0|t)?5:7);case 1:if(t)break t;return 6;default:break t}}}while(0);return 7}function et(t){var e,n,r=0,o=0,s=0,a=0,l=0;o=0|i[(e=8+(t|=0)|0)>>2],s=0|me(+((3*(r=(0|i[t>>2])-o|0)|0)-(o=(0|i[(n=t+4|0)>>2])-o|0)|0)/7),i[t>>2]=s,r=0|me(+((o<<1)+r|0)/7),i[n>>2]=r,i[e>>2]=0,o=r-s|0,(0|s)<0?(l=0-s|0,i[n>>2]=o,i[e>>2]=l,i[t>>2]=0,r=o,s=0,o=l):o=0,(0|r)<0&&(s=s-r|0,i[t>>2]=s,o=o-r|0,i[e>>2]=o,i[n>>2]=0,r=0),l=s-o|0,a=r-o|0,(0|o)<0?(i[t>>2]=l,i[n>>2]=a,i[e>>2]=0,r=a,a=l,o=0):a=s,(0|(s=(0|o)<(0|(s=(0|r)<(0|a)?r:a))?o:s))<=0||(i[t>>2]=a-s,i[n>>2]=r-s,i[e>>2]=o-s)}function nt(t){var e,n,r=0,o=0,s=0,a=0,l=0;o=0|i[(e=8+(t|=0)|0)>>2],s=0|me(+(((r=(0|i[t>>2])-o|0)<<1)+(o=(0|i[(n=t+4|0)>>2])-o|0)|0)/7),i[t>>2]=s,r=0|me(+((3*o|0)-r|0)/7),i[n>>2]=r,i[e>>2]=0,o=r-s|0,(0|s)<0?(l=0-s|0,i[n>>2]=o,i[e>>2]=l,i[t>>2]=0,r=o,s=0,o=l):o=0,(0|r)<0&&(s=s-r|0,i[t>>2]=s,o=o-r|0,i[e>>2]=o,i[n>>2]=0,r=0),l=s-o|0,a=r-o|0,(0|o)<0?(i[t>>2]=l,i[n>>2]=a,i[e>>2]=0,r=a,a=l,o=0):a=s,(0|(s=(0|o)<(0|(s=(0|r)<(0|a)?r:a))?o:s))<=0||(i[t>>2]=a-s,i[n>>2]=r-s,i[e>>2]=o-s)}function rt(t){var e,n,r,o=0,s=0,a=0,l=0;o=0|i[(t|=0)>>2],s=0|i[(n=t+4|0)>>2],a=0|i[(r=t+8|0)>>2],l=s+(3*o|0)|0,i[t>>2]=l,s=a+(3*s|0)|0,i[n>>2]=s,o=(3*a|0)+o|0,i[r>>2]=o,a=s-l|0,(0|l)<0?(o=o-l|0,i[n>>2]=a,i[r>>2]=o,i[t>>2]=0,s=a,a=0):a=l,(0|s)<0&&(a=a-s|0,i[t>>2]=a,o=o-s|0,i[r>>2]=o,i[n>>2]=0,s=0),e=a-o|0,l=s-o|0,(0|o)<0?(i[t>>2]=e,i[n>>2]=l,i[r>>2]=0,a=e,o=0):l=s,(0|(s=(0|o)<(0|(s=(0|l)<(0|a)?l:a))?o:s))<=0||(i[t>>2]=a-s,i[n>>2]=l-s,i[r>>2]=o-s)}function it(t){var e,n,r,o=0,s=0,a=0,l=0;l=0|i[(t|=0)>>2],a=(3*(o=0|i[(n=t+4|0)>>2])|0)+l|0,l=(s=0|i[(r=t+8|0)>>2])+(3*l|0)|0,i[t>>2]=l,i[n>>2]=a,o=(3*s|0)+o|0,i[r>>2]=o,s=a-l|0,(0|l)<0?(o=o-l|0,i[n>>2]=s,i[r>>2]=o,i[t>>2]=0,l=0):s=a,(0|s)<0&&(l=l-s|0,i[t>>2]=l,o=o-s|0,i[r>>2]=o,i[n>>2]=0,s=0),e=l-o|0,a=s-o|0,(0|o)<0?(i[t>>2]=e,i[n>>2]=a,i[r>>2]=0,l=e,o=0):a=s,(0|(s=(0|o)<(0|(s=(0|a)<(0|l)?a:l))?o:s))<=0||(i[t>>2]=l-s,i[n>>2]=a-s,i[r>>2]=o-s)}function ot(t,e){t|=0;var n,r,o,s=0,a=0,l=0;((e|=0)-1|0)>>>0>=6||(l=(0|i[15472+(12*e|0)>>2])+(0|i[t>>2])|0,i[t>>2]=l,o=t+4|0,a=(0|i[15472+(12*e|0)+4>>2])+(0|i[o>>2])|0,i[o>>2]=a,r=t+8|0,e=(0|i[15472+(12*e|0)+8>>2])+(0|i[r>>2])|0,i[r>>2]=e,s=a-l|0,(0|l)<0?(e=e-l|0,i[o>>2]=s,i[r>>2]=e,i[t>>2]=0,a=0):(s=a,a=l),(0|s)<0&&(a=a-s|0,i[t>>2]=a,e=e-s|0,i[r>>2]=e,i[o>>2]=0,s=0),n=a-e|0,l=s-e|0,(0|e)<0?(i[t>>2]=n,i[o>>2]=l,i[r>>2]=0,a=n,e=0):l=s,(0|(s=(0|e)<(0|(s=(0|l)<(0|a)?l:a))?e:s))<=0||(i[t>>2]=a-s,i[o>>2]=l-s,i[r>>2]=e-s))}function st(t){var e,n,r,o=0,s=0,a=0,l=0;l=0|i[(t|=0)>>2],a=(o=0|i[(n=t+4|0)>>2])+l|0,l=(s=0|i[(r=t+8|0)>>2])+l|0,i[t>>2]=l,i[n>>2]=a,o=s+o|0,i[r>>2]=o,s=a-l|0,(0|l)<0?(o=o-l|0,i[n>>2]=s,i[r>>2]=o,i[t>>2]=0,a=0):(s=a,a=l),(0|s)<0&&(a=a-s|0,i[t>>2]=a,o=o-s|0,i[r>>2]=o,i[n>>2]=0,s=0),e=a-o|0,l=s-o|0,(0|o)<0?(i[t>>2]=e,i[n>>2]=l,i[r>>2]=0,a=e,o=0):l=s,(0|(s=(0|o)<(0|(s=(0|l)<(0|a)?l:a))?o:s))<=0||(i[t>>2]=a-s,i[n>>2]=l-s,i[r>>2]=o-s)}function at(t){var e,n,r,o=0,s=0,a=0,l=0;o=0|i[(t|=0)>>2],a=0|i[(n=t+4|0)>>2],s=0|i[(r=t+8|0)>>2],l=a+o|0,i[t>>2]=l,a=s+a|0,i[n>>2]=a,o=s+o|0,i[r>>2]=o,s=a-l|0,(0|l)<0?(o=o-l|0,i[n>>2]=s,i[r>>2]=o,i[t>>2]=0,a=0):(s=a,a=l),(0|s)<0&&(a=a-s|0,i[t>>2]=a,o=o-s|0,i[r>>2]=o,i[n>>2]=0,s=0),e=a-o|0,l=s-o|0,(0|o)<0?(i[t>>2]=e,i[n>>2]=l,i[r>>2]=0,a=e,o=0):l=s,(0|(s=(0|o)<(0|(s=(0|l)<(0|a)?l:a))?o:s))<=0||(i[t>>2]=a-s,i[n>>2]=l-s,i[r>>2]=o-s)}function lt(t){switch(0|(t|=0)){case 1:t=5;break;case 5:t=4;break;case 4:t=6;break;case 6:t=2;break;case 2:t=3;break;case 3:t=1}return 0|t}function ut(t){switch(0|(t|=0)){case 1:t=3;break;case 3:t=2;break;case 2:t=6;break;case 6:t=4;break;case 4:t=5;break;case 5:t=1}return 0|t}function ct(t){var e,n,r,o=0,s=0,a=0,l=0;o=0|i[(t|=0)>>2],s=0|i[(n=t+4|0)>>2],a=0|i[(r=t+8|0)>>2],l=s+(o<<1)|0,i[t>>2]=l,s=a+(s<<1)|0,i[n>>2]=s,o=(a<<1)+o|0,i[r>>2]=o,a=s-l|0,(0|l)<0?(o=o-l|0,i[n>>2]=a,i[r>>2]=o,i[t>>2]=0,s=a,a=0):a=l,(0|s)<0&&(a=a-s|0,i[t>>2]=a,o=o-s|0,i[r>>2]=o,i[n>>2]=0,s=0),e=a-o|0,l=s-o|0,(0|o)<0?(i[t>>2]=e,i[n>>2]=l,i[r>>2]=0,a=e,o=0):l=s,(0|(s=(0|o)<(0|(s=(0|l)<(0|a)?l:a))?o:s))<=0||(i[t>>2]=a-s,i[n>>2]=l-s,i[r>>2]=o-s)}function ht(t){var e,n,r,o=0,s=0,a=0,l=0;l=0|i[(t|=0)>>2],a=((o=0|i[(n=t+4|0)>>2])<<1)+l|0,l=(s=0|i[(r=t+8|0)>>2])+(l<<1)|0,i[t>>2]=l,i[n>>2]=a,o=(s<<1)+o|0,i[r>>2]=o,s=a-l|0,(0|l)<0?(o=o-l|0,i[n>>2]=s,i[r>>2]=o,i[t>>2]=0,l=0):s=a,(0|s)<0&&(l=l-s|0,i[t>>2]=l,o=o-s|0,i[r>>2]=o,i[n>>2]=0,s=0),e=l-o|0,a=s-o|0,(0|o)<0?(i[t>>2]=e,i[n>>2]=a,i[r>>2]=0,l=e,o=0):a=s,(0|(s=(0|o)<(0|(s=(0|a)<(0|l)?a:l))?o:s))<=0||(i[t>>2]=l-s,i[n>>2]=a-s,i[r>>2]=o-s)}function pt(t,e){e|=0;var n,r,o,s=0,a=0,l=0;return o=(0|(r=(0|i[(t|=0)>>2])-(0|i[e>>2])|0))<0,n=(0|(a=(0|i[t+4>>2])-(0|i[e+4>>2])-(o?r:0)|0))<0,e=(e=(t=(0|(l=(o?0-r|0:0)+(0|i[t+8>>2])-(0|i[e+8>>2])+(n?0-a|0:0)|0))<0)?0:l)-((a=(0|(t=(0|e)<(0|(t=(0|(s=(n?0:a)-(t?l:0)|0))<(0|(l=(o?0:r)-(n?a:0)-(t?l:0)|0))?s:l))?e:t))>0)?t:0)|0,s=s-(a?t:0)|0,0|((0|(t=(0|(t=l-(a?t:0)|0))>-1?t:0-t|0))>(0|(e=(0|(s=(0|s)>-1?s:0-s|0))>(0|(e=(0|e)>-1?e:0-e|0))?s:e))?t:e)}function ft(t,e){var n;e|=0,n=0|i[8+(t|=0)>>2],i[e>>2]=(0|i[t>>2])-n,i[e+4>>2]=(0|i[t+4>>2])-n}function dt(t,e){e|=0;var n,r,o,s=0,a=0,l=0;a=0|i[(t|=0)>>2],i[e>>2]=a,t=0|i[t+4>>2],i[(r=e+4|0)>>2]=t,i[(o=e+8|0)>>2]=0,s=t-a|0,(0|a)<0?(t=0-a|0,i[r>>2]=s,i[o>>2]=t,i[e>>2]=0,a=0):(s=t,t=0),(0|s)<0&&(a=a-s|0,i[e>>2]=a,t=t-s|0,i[o>>2]=t,i[r>>2]=0,s=0),n=a-t|0,l=s-t|0,(0|t)<0?(i[e>>2]=n,i[r>>2]=l,i[o>>2]=0,s=l,l=n,t=0):l=a,(0|(a=(0|t)<(0|(a=(0|s)<(0|l)?s:l))?t:a))<=0||(i[e>>2]=l-a,i[r>>2]=s-a,i[o>>2]=t-a)}function gt(t){var e,n,r,o;n=(o=0|i[(e=8+(t|=0)|0)>>2])-(0|i[t>>2])|0,i[t>>2]=n,t=(0|i[(r=t+4|0)>>2])-o|0,i[r>>2]=t,i[e>>2]=0-(t+n)}function mt(t){var e,n,r=0,o=0,s=0,a=0,l=0;r=0-(o=0|i[(t|=0)>>2])|0,i[t>>2]=r,i[(e=t+8|0)>>2]=0,a=(s=0|i[(n=t+4|0)>>2])+o|0,(0|o)>0?(i[n>>2]=a,i[e>>2]=o,i[t>>2]=0,r=0,s=a):o=0,(0|s)<0?(l=r-s|0,i[t>>2]=l,o=o-s|0,i[e>>2]=o,i[n>>2]=0,a=l-o|0,r=0-o|0,(0|o)<0?(i[t>>2]=a,i[n>>2]=r,i[e>>2]=0,s=r,o=0):(s=0,a=l)):a=r,(0|(r=(0|o)<(0|(r=(0|s)<(0|a)?s:a))?o:r))<=0||(i[t>>2]=a-r,i[n>>2]=s-r,i[e>>2]=o-r)}function At(t,e,n,r){e|=0,n|=0,r|=0;var s,a=0,l=0,u=0,c=0;if(s=I,I=I+32|0,function(t,e){e|=0;var n,r,i=0;i=+o[(t|=0)>>3],n=+h(+i),i=+p(+i),o[e+16>>3]=i,i=+o[t+8>>3],r=n*+h(+i),o[e>>3]=r,i=n*+p(+i),o[e+8>>3]=i}(t|=0,l=s),i[n>>2]=0,a=+le(15888,l),(u=+le(15912,l))<a&&(i[n>>2]=1,a=u),(u=+le(15936,l))<a&&(i[n>>2]=2,a=u),(u=+le(15960,l))<a&&(i[n>>2]=3,a=u),(u=+le(15984,l))<a&&(i[n>>2]=4,a=u),(u=+le(16008,l))<a&&(i[n>>2]=5,a=u),(u=+le(16032,l))<a&&(i[n>>2]=6,a=u),(u=+le(16056,l))<a&&(i[n>>2]=7,a=u),(u=+le(16080,l))<a&&(i[n>>2]=8,a=u),(u=+le(16104,l))<a&&(i[n>>2]=9,a=u),(u=+le(16128,l))<a&&(i[n>>2]=10,a=u),(u=+le(16152,l))<a&&(i[n>>2]=11,a=u),(u=+le(16176,l))<a&&(i[n>>2]=12,a=u),(u=+le(16200,l))<a&&(i[n>>2]=13,a=u),(u=+le(16224,l))<a&&(i[n>>2]=14,a=u),(u=+le(16248,l))<a&&(i[n>>2]=15,a=u),(u=+le(16272,l))<a&&(i[n>>2]=16,a=u),(u=+le(16296,l))<a&&(i[n>>2]=17,a=u),(u=+le(16320,l))<a&&(i[n>>2]=18,a=u),(u=+le(16344,l))<a&&(i[n>>2]=19,a=u),(u=+d(+(1-.5*a)))<1e-16)return i[r>>2]=0,i[r+4>>2]=0,i[r+8>>2]=0,i[r+12>>2]=0,void(I=s);if(n=0|i[n>>2],a=+Tt((a=+o[16368+(24*n|0)>>3])-+Tt(+function(t,e){t|=0;var n,r,i,s,a;return s=+o[(e|=0)>>3],r=+h(+s),i=+o[e+8>>3]-+o[t+8>>3],a=r*+p(+i),n=+o[t>>3],+ +A(+a,+(+p(+s)*+h(+n)-+h(+i)*(r*+p(+n))))}(15568+(n<<4)|0,t))),c=0|jt(e)?+Tt(a+-.3334731722518321):a,a=+f(+u)/.381966011250105,(0|e)>0){l=0;do{a*=2.6457513110645907,l=l+1|0}while((0|l)!=(0|e))}u=+h(+c)*a,o[r>>3]=u,c=+p(+c)*a,o[r+8>>3]=c,I=s}function yt(t,e,n,r,s){e|=0,n|=0,r|=0,s|=0;var a=0,c=0;if(a=+function(t){var e,n;return n=+o[(t|=0)>>3],e=+o[t+8>>3],+ +u(+(n*n+e*e))}(t|=0),a<1e-16)return e=15568+(e<<4)|0,i[s>>2]=i[e>>2],i[s+4>>2]=i[e+4>>2],i[s+8>>2]=i[e+8>>2],void(i[s+12>>2]=i[e+12>>2]);if(c=+A(+ +o[t+8>>3],+ +o[t>>3]),(0|n)>0){t=0;do{a/=2.6457513110645907,t=t+1|0}while((0|t)!=(0|n))}r?(a/=3,n=0==(0|jt(n)),a=+m(.381966011250105*(n?a:a/2.6457513110645907))):(a=+m(.381966011250105*a),0|jt(n)&&(c=+Tt(c+.3334731722518321))),function(t,e,n,r){t|=0,e=+e,r|=0;var s=0,a=0,u=0,c=0;if((n=+n)<1e-16)return i[r>>2]=i[t>>2],i[r+4>>2]=i[t+4>>2],i[r+8>>2]=i[t+8>>2],void(i[r+12>>2]=i[t+12>>2]);a=e<0?e+6.283185307179586:e,a=e>=6.283185307179586?a+-6.283185307179586:a;do{if(!(a<1e-16)){if(s=+l(+(a+-3.141592653589793))<1e-16,e=+o[t>>3],s){e-=n,o[r>>3]=e,s=r;break}if(u=+h(+n),n=+p(+n),e=u*+p(+e)+ +h(+a)*(n*+h(+e)),e=+g(+((e=e>1?1:e)<-1?-1:e)),o[r>>3]=e,+l(+(e+-1.5707963267948966))<1e-16)return o[r>>3]=1.5707963267948966,void(o[r+8>>3]=0);if(+l(+(e+1.5707963267948966))<1e-16)return o[r>>3]=-1.5707963267948966,void(o[r+8>>3]=0);if(c=+h(+e),a=n*+p(+a)/c,n=+o[t>>3],e=(u-+p(+e)*+p(+n))/+h(+n)/c,u=a>1?1:a,e=e>1?1:e,(e=+o[t+8>>3]+ +A(+(u<-1?-1:u),+(e<-1?-1:e)))>3.141592653589793)do{e+=-6.283185307179586}while(e>3.141592653589793);if(e<-3.141592653589793)do{e+=6.283185307179586}while(e<-3.141592653589793);return void(o[r+8>>3]=e)}e=+o[t>>3]+n,o[r>>3]=e,s=r}while(0);if(+l(+(e+-1.5707963267948966))<1e-16)return o[s>>3]=1.5707963267948966,void(o[r+8>>3]=0);if(+l(+(e+1.5707963267948966))<1e-16)return o[s>>3]=-1.5707963267948966,void(o[r+8>>3]=0);if((e=+o[t+8>>3])>3.141592653589793)do{e+=-6.283185307179586}while(e>3.141592653589793);if(e<-3.141592653589793)do{e+=6.283185307179586}while(e<-3.141592653589793);o[r+8>>3]=e}(15568+(e<<4)|0,+Tt(+o[16368+(24*e|0)>>3]-c),a,s)}function _t(t,e,n){var r,o;e|=0,n|=0,r=I,I=I+16|0,Y(4+(t|=0)|0,o=r),yt(o,0|i[t>>2],e,0,n),I=r}function vt(t,e,n,r,s){t|=0,e|=0,n|=0,r|=0,s|=0;var a,l,u,c,h,p,f,d,g,m,A,y,_,v,b,x,w,S,T,P,M,C,O=0,R=0,L=0,k=0,D=0,N=0;if(C=I,I=I+272|0,k=C+240|0,T=C,P=C+224|0,M=C+208|0,A=C+176|0,y=C+160|0,_=C+192|0,v=C+144|0,b=C+128|0,x=C+112|0,w=C+96|0,S=C+80|0,i[(O=C+256|0)>>2]=e,i[k>>2]=i[t>>2],i[k+4>>2]=i[t+4>>2],i[k+8>>2]=i[t+8>>2],i[k+12>>2]=i[t+12>>2],bt(k,O,T),i[s>>2]=0,(0|(k=r+n+(5==(0|r)&1)|0))<=(0|n))I=C;else{l=P+4|0,u=A+4|0,c=n+5|0,h=16848+((a=0|i[O>>2])<<2)|0,p=16928+(a<<2)|0,f=b+8|0,d=x+8|0,g=w+8|0,m=M+4|0,L=n;t:for(;;){R=T+(((0|L)%5|0)<<4)|0,i[M>>2]=i[R>>2],i[M+4>>2]=i[R+4>>2],i[M+8>>2]=i[R+8>>2],i[M+12>>2]=i[R+12>>2];do{}while(2==(0|xt(M,a,0,1)));if((0|L)>(0|n)&0!=(0|jt(e))){if(i[A>>2]=i[M>>2],i[A+4>>2]=i[M+4>>2],i[A+8>>2]=i[M+8>>2],i[A+12>>2]=i[M+12>>2],Y(l,y),r=0|i[A>>2],O=0|i[17008+(80*r|0)+(i[P>>2]<<2)>>2],i[A>>2]=i[18608+(80*r|0)+(20*O|0)>>2],(0|(R=0|i[18608+(80*r|0)+(20*O|0)+16>>2]))>0){t=0;do{st(u),t=t+1|0}while((0|t)<(0|R))}switch(R=18608+(80*r|0)+(20*O|0)+4|0,i[_>>2]=i[R>>2],i[_+4>>2]=i[R+4>>2],i[_+8>>2]=i[R+8>>2],J(_,3*(0|i[h>>2])|0),Q(u,_,u),$(u),Y(u,v),D=+(0|i[p>>2]),o[b>>3]=3*D,o[f>>3]=0,N=-1.5*D,o[x>>3]=N,o[d>>3]=2.598076211353316*D,o[w>>3]=N,o[g>>3]=-2.598076211353316*D,0|i[17008+(80*(0|i[A>>2])|0)+(i[M>>2]<<2)>>2]){case 1:t=x,r=b;break;case 3:t=w,r=x;break;case 2:t=b,r=w;break;default:t=12;break t}se(y,v,r,t,S),yt(S,0|i[A>>2],a,1,s+8+(i[s>>2]<<4)|0),i[s>>2]=1+(0|i[s>>2])}if((0|L)<(0|c)&&(Y(m,A),yt(A,0|i[M>>2],a,1,s+8+(i[s>>2]<<4)|0),i[s>>2]=1+(0|i[s>>2])),i[P>>2]=i[M>>2],i[P+4>>2]=i[M+4>>2],i[P+8>>2]=i[M+8>>2],i[P+12>>2]=i[M+12>>2],(0|(L=L+1|0))>=(0|k)){t=3;break}}3!=(0|t)?12==(0|t)&&E(22474,22521,581,22531):I=C}}function bt(t,e,n){t|=0,e|=0,n|=0;var r,o=0,s=0,a=0,l=0,u=0;r=I,I=I+128|0,s=r,l=20208,u=60+(a=o=r+64|0)|0;do{i[a>>2]=i[l>>2],a=a+4|0,l=l+4|0}while((0|a)<(0|u));l=20272,u=(a=s)+60|0;do{i[a>>2]=i[l>>2],a=a+4|0,l=l+4|0}while((0|a)<(0|u));o=(u=0==(0|jt(0|i[e>>2])))?o:s,ct(s=t+4|0),ht(s),0|jt(0|i[e>>2])&&(it(s),i[e>>2]=1+(0|i[e>>2])),i[n>>2]=i[t>>2],Q(s,o,e=n+4|0),$(e),i[n+16>>2]=i[t>>2],Q(s,o+12|0,e=n+20|0),$(e),i[n+32>>2]=i[t>>2],Q(s,o+24|0,e=n+36|0),$(e),i[n+48>>2]=i[t>>2],Q(s,o+36|0,e=n+52|0),$(e),i[n+64>>2]=i[t>>2],Q(s,o+48|0,n=n+68|0),$(n),I=r}function xt(t,e,n,r){n|=0,r|=0;var o,s,a,l,u,c,h=0,p=0,f=0,d=0,g=0;if(c=I,I=I+32|0,u=c+12|0,s=c,g=4+(t|=0)|0,d=0|i[16928+((e|=0)<<2)>>2],d=(l=0!=(0|r))?3*d|0:d,h=0|i[g>>2],o=0|i[(a=t+8|0)>>2],l){if((0|(h=o+h+(r=0|i[(p=t+12|0)>>2])|0))==(0|d))return I=c,1;f=p}else h=o+h+(r=0|i[(f=t+12|0)>>2])|0;if((0|h)<=(0|d))return I=c,0;do{if((0|r)>0){if(r=0|i[t>>2],(0|o)>0){p=18608+(80*r|0)+60|0,r=t;break}r=18608+(80*r|0)+40|0,n?(H(u,d,0,0),K(g,u,s),at(s),Q(s,u,g),p=r,r=t):(p=r,r=t)}else p=18608+(80*(0|i[t>>2])|0)+20|0,r=t}while(0);if(i[r>>2]=i[p>>2],(0|i[(h=p+16|0)>>2])>0){r=0;do{st(g),r=r+1|0}while((0|r)<(0|i[h>>2]))}return t=p+4|0,i[u>>2]=i[t>>2],i[u+4>>2]=i[t+4>>2],i[u+8>>2]=i[t+8>>2],e=0|i[16848+(e<<2)>>2],J(u,l?3*e|0:e),Q(g,u,g),$(g),r=l&&((0|i[a>>2])+(0|i[g>>2])+(0|i[f>>2])|0)==(0|d)?1:2,I=c,0|r}function wt(t,e){t|=0,e|=0;var n=0;do{n=0|xt(t,e,0,1)}while(2==(0|n));return 0|n}function Et(t,e,n,r,s){t|=0,e|=0,n|=0,r|=0,s|=0;var a,l,u,c,h,p,f,d,g,m,A,y,_,v,b,x,w,S,T=0,P=0,M=0,C=0,O=0;if(S=I,I=I+240|0,v=S+208|0,b=S,x=S+192|0,w=S+176|0,g=S+160|0,m=S+144|0,A=S+128|0,y=S+112|0,_=S+96|0,i[(T=S+224|0)>>2]=e,i[v>>2]=i[t>>2],i[v+4>>2]=i[t+4>>2],i[v+8>>2]=i[t+8>>2],i[v+12>>2]=i[t+12>>2],St(v,T,b),i[s>>2]=0,(0|(d=r+n+(6==(0|r)&1)|0))<=(0|n))I=S;else{l=n+6|0,u=16928+((a=0|i[T>>2])<<2)|0,c=m+8|0,h=A+8|0,p=y+8|0,f=x+4|0,P=0,M=n,r=-1;t:for(;;){if(t=b+((T=(0|M)%6|0)<<4)|0,i[x>>2]=i[t>>2],i[x+4>>2]=i[t+4>>2],i[x+8>>2]=i[t+8>>2],i[x+12>>2]=i[t+12>>2],t=P,P=0|xt(x,a,0,1),(0|M)>(0|n)&0!=(0|jt(e))&&1!=(0|t)&&(0|i[x>>2])!=(0|r)){switch(Y(b+(((T+5|0)%6|0)<<4)+4|0,w),Y(b+(T<<4)+4|0,g),C=+(0|i[u>>2]),o[m>>3]=3*C,o[c>>3]=0,O=-1.5*C,o[A>>3]=O,o[h>>3]=2.598076211353316*C,o[y>>3]=O,o[p>>3]=-2.598076211353316*C,T=0|i[v>>2],0|i[17008+(80*T|0)+(((0|r)==(0|T)?0|i[x>>2]:r)<<2)>>2]){case 1:t=A,r=m;break;case 3:t=y,r=A;break;case 2:t=m,r=y;break;default:t=8;break t}se(w,g,r,t,_),0|ae(w,_)||0|ae(g,_)||(yt(_,0|i[v>>2],a,1,s+8+(i[s>>2]<<4)|0),i[s>>2]=1+(0|i[s>>2]))}if((0|M)<(0|l)&&(Y(f,w),yt(w,0|i[x>>2],a,1,s+8+(i[s>>2]<<4)|0),i[s>>2]=1+(0|i[s>>2])),(0|(M=M+1|0))>=(0|d)){t=3;break}r=0|i[x>>2]}3!=(0|t)?8==(0|t)&&E(22557,22521,746,22602):I=S}}function St(t,e,n){t|=0,e|=0,n|=0;var r,o=0,s=0,a=0,l=0,u=0;r=I,I=I+160|0,s=r,l=20336,u=72+(a=o=r+80|0)|0;do{i[a>>2]=i[l>>2],a=a+4|0,l=l+4|0}while((0|a)<(0|u));l=20416,u=(a=s)+72|0;do{i[a>>2]=i[l>>2],a=a+4|0,l=l+4|0}while((0|a)<(0|u));o=(u=0==(0|jt(0|i[e>>2])))?o:s,ct(s=t+4|0),ht(s),0|jt(0|i[e>>2])&&(it(s),i[e>>2]=1+(0|i[e>>2])),i[n>>2]=i[t>>2],Q(s,o,e=n+4|0),$(e),i[n+16>>2]=i[t>>2],Q(s,o+12|0,e=n+20|0),$(e),i[n+32>>2]=i[t>>2],Q(s,o+24|0,e=n+36|0),$(e),i[n+48>>2]=i[t>>2],Q(s,o+36|0,e=n+52|0),$(e),i[n+64>>2]=i[t>>2],Q(s,o+48|0,e=n+68|0),$(e),i[n+80>>2]=i[t>>2],Q(s,o+60|0,n=n+84|0),$(n),I=r}function Tt(t){var e;return e=(t=+t)<0?t+6.283185307179586:t,+(t>=6.283185307179586?e+-6.283185307179586:e)}function Pt(t,e){return e|=0,+l(+(+o[(t|=0)>>3]-+o[e>>3]))<17453292519943298e-27?0|(e=+l(+(+o[t+8>>3]-+o[e+8>>3]))<17453292519943298e-27):0|(e=0)}function Mt(t,e){t|=0;var n,r,i,s=0;return r=+o[(e|=0)>>3],n=+o[t>>3],s=(i=+p(.5*(r-n)))*i+(s=+p(.5*(+o[e+8>>3]-+o[t+8>>3])))*(+h(+r)*+h(+n)*s),2*+A(+ +u(+s),+ +u(+(1-s)))*6371.007180918475}function Ct(t,e,n){t|=0,n|=0;var r,i,s,a,l=0,c=0,d=0,g=0,y=0,_=0;return _=+o[(e|=0)>>3],s=+o[t>>3],y=+p(.5*(_-s)),d=+o[e+8>>3],i=+o[t+8>>3],g=+p(.5*(d-i)),r=+h(+s),a=+h(+_),g=2*+A(+ +u(+(g=y*y+g*(a*r*g))),+ +u(+(1-g))),y=+o[n>>3],_=+p(.5*(y-_)),l=+o[n+8>>3],d=+p(.5*(l-d)),c=+h(+y),d=2*+A(+ +u(+(d=_*_+d*(a*c*d))),+ +u(+(1-d))),y=+p(.5*(s-y)),l=+p(.5*(i-l)),l=2*+A(+ +u(+(l=y*y+l*(r*c*l))),+ +u(+(1-l))),4*+m(+ +u(+ +f(.5*(c=.5*(g+d+l)))*+f(.5*(c-g))*+f(.5*(c-d))*+f(.5*(c-l))))}function It(t,e){return e=0|we(0|(t|=0),0|(e|=0),45),w(),127&e|0}function Ot(t,e){var n=0,r=0,i=0,o=0,s=0,a=0;if(!(!0&134217728==(-16777216&(e|=0)|0)))return 0;if(s=0|we(0|(t|=0),0|e,45),w(),(s&=127)>>>0>121)return 0;n=0|we(0|t,0|e,52),w(),n&=15;do{if(0|n){for(i=1,r=0;;){if(o=0|we(0|t,0|e,3*(15-i|0)|0),w(),0!=(0|(o&=7))&(1^r)){if(1==(0|o)&0!=(0|N(s))){a=0,r=13;break}r=1}if(7==(0|o)){a=0,r=13;break}if(!(i>>>0<n>>>0)){r=9;break}i=i+1|0}if(9==(0|r)){if(15!=(0|n))break;return 1}if(13==(0|r))return 0|a}}while(0);for(;;){if(a=0|we(0|t,0|e,3*(14-n|0)|0),w(),!(7==(7&a|0)&!0)){a=0,r=13;break}if(!(n>>>0<14)){a=1,r=13;break}n=n+1|0}return 13==(0|r)?0|a:0}function Rt(t,e,n){n|=0;var r=0,i=0;if(r=0|we(0|(t|=0),0|(e|=0),52),w(),(0|(r&=15))>=(0|n)){if((0|r)!=(0|n))if(n>>>0<=15){if(t|=i=0|Ee(0|n,0,52),e=0|w()|-15728641&e,(0|r)>(0|n))do{i=0|Ee(7,0,3*(14-n|0)|0),n=n+1|0,t|=i,e=0|w()|e}while((0|n)<(0|r))}else e=0,t=0}else e=0,t=0;return x(0|e),0|t}function Lt(t,e,n,r){n|=0,r|=0;var o,s=0,a=0,l=0,u=0,c=0,h=0;if(l=0|we(0|(t|=0),0|(e|=0),52),w(),(0|n)<16&(0|(l&=15))<=(0|n)){if((0|l)==(0|n))return i[(n=r)>>2]=t,void(i[n+4>>2]=e);if(o=(0|(c=0|ee(7,n-l|0)))/7|0,u=0|we(0|t,0|e,45),w(),0|N(127&u)){t:do{if(l)for(a=1;;){if(s=0|we(0|t,0|e,3*(15-a|0)|0),w(),0|(s&=7))break t;if(!(a>>>0<l>>>0)){s=0;break}a=a+1|0}else s=0}while(0);a=0==(0|s)}else a=0;if(h=0|Ee(l+1|0,0,52),s=0|w()|-15728641&e,Lt(e=(h|t)&~(e=0|Ee(7,0,0|(u=3*(14-l|0)|0))),l=s&~(0|w()),n,r),s=r+(o<<3)|0,!a)return Lt((h=0|Ee(1,0,0|u))|e,0|w()|l,n,s),h=s+(o<<3)|0,Lt((c=0|Ee(2,0,0|u))|e,0|w()|l,n,h),h=h+(o<<3)|0,Lt((c=0|Ee(3,0,0|u))|e,0|w()|l,n,h),h=h+(o<<3)|0,Lt((c=0|Ee(4,0,0|u))|e,0|w()|l,n,h),h=h+(o<<3)|0,Lt((c=0|Ee(5,0,0|u))|e,0|w()|l,n,h),void Lt((c=0|Ee(6,0,0|u))|e,0|w()|l,n,h+(o<<3)|0);a=s+(o<<3)|0,(0|c)>6&&(Me(0|s,0,8+(h=(a>>>0>(c=s+8|0)>>>0?a:c)+-1+(0-s)|0)&-8|0),s=c+(h>>>3<<3)|0),Lt((h=0|Ee(2,0,0|u))|e,0|w()|l,n,s),h=s+(o<<3)|0,Lt((c=0|Ee(3,0,0|u))|e,0|w()|l,n,h),h=h+(o<<3)|0,Lt((c=0|Ee(4,0,0|u))|e,0|w()|l,n,h),h=h+(o<<3)|0,Lt((c=0|Ee(5,0,0|u))|e,0|w()|l,n,h),Lt((c=0|Ee(6,0,0|u))|e,0|w()|l,n,h+(o<<3)|0)}}function kt(t,e){var n=0,r=0,i=0;if(i=0|we(0|(t|=0),0|(e|=0),45),w(),!(0|N(127&i)))return 0;i=0|we(0|t,0|e,52),w(),i&=15;t:do{if(i)for(r=1;;){if(n=0|we(0|t,0|e,3*(15-r|0)|0),w(),0|(n&=7))break t;if(!(r>>>0<i>>>0)){n=0;break}r=r+1|0}else n=0}while(0);return 0|0==(0|n)&1}function Dt(t,e){var n=0,r=0,i=0;if(i=0|we(0|(t|=0),0|(e|=0),52),w(),!(i&=15))return 0;for(r=1;;){if(n=0|we(0|t,0|e,3*(15-r|0)|0),w(),0|(n&=7)){r=5;break}if(!(r>>>0<i>>>0)){n=0,r=5;break}r=r+1|0}return 5==(0|r)?0|n:0}function Nt(t,e){var n=0,r=0,i=0,o=0,s=0,a=0,l=0;if(l=0|we(0|(t|=0),0|(e|=0),52),w(),!(l&=15))return l=t,x(0|(a=e)),0|l;for(a=1,n=0;;){r=0|Ee(7,0,0|(o=3*(15-a|0)|0)),i=0|w(),s=0|we(0|t,0|e,0|o),w(),t=(o=0|Ee(0|lt(7&s),0,0|o))|t&~r,e=(s=0|w())|e&~i;t:do{if(!n)if(0==(o&r|0)&0==(s&i|0))n=0;else if(r=0|we(0|t,0|e,52),w(),r&=15){n=1;e:for(;;){switch(s=0|we(0|t,0|e,3*(15-n|0)|0),w(),7&s){case 1:break e;case 0:break;default:n=1;break t}if(!(n>>>0<r>>>0)){n=1;break t}n=n+1|0}for(n=1;;){if(i=0|we(0|t,0|e,0|(s=3*(15-n|0)|0)),w(),o=0|Ee(7,0,0|s),e&=~(0|w()),t=t&~o|(s=0|Ee(0|lt(7&i),0,0|s)),e=0|e|w(),!(n>>>0<r>>>0)){n=1;break}n=n+1|0}}else n=1}while(0);if(!(a>>>0<l>>>0))break;a=a+1|0}return x(0|e),0|t}function Ft(t,e){var n=0,r=0,i=0,o=0,s=0;if(r=0|we(0|(t|=0),0|(e|=0),52),w(),!(r&=15))return r=t,x(0|(n=e)),0|r;for(n=1;s=0|we(0|t,0|e,0|(o=3*(15-n|0)|0)),w(),i=0|Ee(7,0,0|o),e&=~(0|w()),t=(o=0|Ee(0|lt(7&s),0,0|o))|t&~i,e=0|w()|e,n>>>0<r>>>0;)n=n+1|0;return x(0|e),0|t}function Bt(t,e){var n=0,r=0,i=0,o=0,s=0,a=0,l=0;if(l=0|we(0|(t|=0),0|(e|=0),52),w(),!(l&=15))return l=t,x(0|(a=e)),0|l;for(a=1,n=0;;){r=0|Ee(7,0,0|(o=3*(15-a|0)|0)),i=0|w(),s=0|we(0|t,0|e,0|o),w(),t=(o=0|Ee(0|ut(7&s),0,0|o))|t&~r,e=(s=0|w())|e&~i;t:do{if(!n)if(0==(o&r|0)&0==(s&i|0))n=0;else if(r=0|we(0|t,0|e,52),w(),r&=15){n=1;e:for(;;){switch(s=0|we(0|t,0|e,3*(15-n|0)|0),w(),7&s){case 1:break e;case 0:break;default:n=1;break t}if(!(n>>>0<r>>>0)){n=1;break t}n=n+1|0}for(n=1;;){if(o=0|Ee(7,0,0|(i=3*(15-n|0)|0)),s=e&~(0|w()),e=0|we(0|t,0|e,0|i),w(),t=t&~o|(e=0|Ee(0|ut(7&e),0,0|i)),e=0|s|w(),!(n>>>0<r>>>0)){n=1;break}n=n+1|0}}else n=1}while(0);if(!(a>>>0<l>>>0))break;a=a+1|0}return x(0|e),0|t}function zt(t,e){var n=0,r=0,i=0,o=0,s=0;if(r=0|we(0|(t|=0),0|(e|=0),52),w(),!(r&=15))return r=t,x(0|(n=e)),0|r;for(n=1;o=0|Ee(7,0,0|(s=3*(15-n|0)|0)),i=e&~(0|w()),e=0|we(0|t,0|e,0|s),w(),t=(e=0|Ee(0|ut(7&e),0,0|s))|t&~o,e=0|w()|i,n>>>0<r>>>0;)n=n+1|0;return x(0|e),0|t}function jt(t){return 0|(0|(t|=0))%2}function Ut(t,e){var n,r;return t|=0,r=I,I=I+16|0,n=r,(e|=0)>>>0<=15&&2146435072!=(2146435072&i[t+4>>2]|0)&&2146435072!=(2146435072&i[t+8+4>>2]|0)?(function(t,e,n){var r,i;r=I,I=I+16|0,At(t|=0,e|=0,n|=0,i=r),X(i,n+4|0),I=r}(t,e,n),e=0|function(t,e){t|=0;var n,r=0,o=0,s=0,a=0,l=0,u=0,c=0,h=0;if(n=I,I=I+64|0,u=n+40|0,o=n+24|0,s=n+12|0,a=n,Ee(0|(e|=0),0,52),r=134225919|w(),!e)return(0|i[t+4>>2])>2||(0|i[t+8>>2])>2||(0|i[t+12>>2])>2?(u=0,x(0|(l=0)),I=n,0|u):(Ee(0|B(t),0,45),l=0|w()|r,u=-1,x(0|l),I=n,0|u);if(i[u>>2]=i[t>>2],i[u+4>>2]=i[t+4>>2],i[u+8>>2]=i[t+8>>2],i[u+12>>2]=i[t+12>>2],l=u+4|0,(0|e)>0)for(t=-1;i[o>>2]=i[l>>2],i[o+4>>2]=i[l+4>>2],i[o+8>>2]=i[l+8>>2],1&e?(et(l),i[s>>2]=i[l>>2],i[s+4>>2]=i[l+4>>2],i[s+8>>2]=i[l+8>>2],rt(s)):(nt(l),i[s>>2]=i[l>>2],i[s+4>>2]=i[l+4>>2],i[s+8>>2]=i[l+8>>2],it(s)),K(o,s,a),$(a),c=0|Ee(7,0,0|(h=3*(15-e|0)|0)),r&=~(0|w()),t=(h=0|Ee(0|tt(a),0,0|h))|t&~c,r=0|w()|r,(0|e)>1;)e=e+-1|0;else t=-1;t:do{if((0|i[l>>2])<=2&&(0|i[u+8>>2])<=2&&(0|i[u+12>>2])<=2){if(e=0|Ee(0|(o=0|B(u)),0,45),e|=t,t=0|w()|-1040385&r,a=0|z(u),!(0|N(o))){if((0|a)<=0)break;for(s=0;;){if(o=0|we(0|e,0|t,52),w(),o&=15)for(r=1;u=0|we(0|e,0|t,0|(h=3*(15-r|0)|0)),w(),c=0|Ee(7,0,0|h),t&=~(0|w()),e=e&~c|(h=0|Ee(0|lt(7&u),0,0|h)),t=0|t|w(),r>>>0<o>>>0;)r=r+1|0;if((0|(s=s+1|0))==(0|a))break t}}s=0|we(0|e,0|t,52),w(),s&=15;e:do{if(s){r=1;n:for(;;){switch(h=0|we(0|e,0|t,3*(15-r|0)|0),w(),7&h){case 1:break n;case 0:break;default:break e}if(!(r>>>0<s>>>0))break e;r=r+1|0}if(0|j(o,0|i[u>>2]))for(r=1;c=0|Ee(7,0,0|(u=3*(15-r|0)|0)),h=t&~(0|w()),t=0|we(0|e,0|t,0|u),w(),e=e&~c|(t=0|Ee(0|ut(7&t),0,0|u)),t=0|h|w(),r>>>0<s>>>0;)r=r+1|0;else for(r=1;u=0|we(0|e,0|t,0|(h=3*(15-r|0)|0)),w(),c=0|Ee(7,0,0|h),t&=~(0|w()),e=e&~c|(h=0|Ee(0|lt(7&u),0,0|h)),t=0|t|w(),r>>>0<s>>>0;)r=r+1|0}}while(0);if((0|a)>0){r=0;do{e=0|Nt(e,t),t=0|w(),r=r+1|0}while((0|r)!=(0|a))}}else e=0,t=0}while(0);return h=e,x(0|(c=t)),I=n,0|h}(n,e),t=0|w()):(t=0,e=0),x(0|t),I=r,0|e}function Vt(t,e,n){var r,o=0,s=0,a=0;if(r=4+(n|=0)|0,s=0|we(0|(t|=0),0|(e|=0),52),w(),s&=15,a=0|we(0|t,0|e,45),w(),o=0==(0|s),0|N(127&a)){if(o)return 1;o=1}else{if(o)return 0;o=0==(0|i[r>>2])&&0==(0|i[n+8>>2])?0!=(0|i[n+12>>2])&1:1}for(n=1;1&n?rt(r):it(r),a=0|we(0|t,0|e,3*(15-n|0)|0),w(),ot(r,7&a),n>>>0<s>>>0;)n=n+1|0;return 0|o}function Gt(t,e,n){n|=0;var r,o,s=0,a=0,l=0,u=0,c=0,h=0;o=I,I=I+16|0,r=o,h=0|we(0|(t|=0),0|(e|=0),45),w(),h&=127;t:do{if(0!=(0|N(h))&&(l=0|we(0|t,0|e,52),w(),0!=(0|(l&=15)))){s=1;e:for(;;){switch(c=0|we(0|t,0|e,3*(15-s|0)|0),w(),7&c){case 5:break e;case 0:break;default:s=e;break t}if(!(s>>>0<l>>>0)){s=e;break t}s=s+1|0}for(a=1,s=e;u=0|Ee(7,0,0|(e=3*(15-a|0)|0)),c=s&~(0|w()),s=0|we(0|t,0|s,0|e),w(),t=t&~u|(s=0|Ee(0|ut(7&s),0,0|e)),s=0|c|w(),a>>>0<l>>>0;)a=a+1|0}else s=e}while(0);if(c=7728+(28*h|0)|0,i[n>>2]=i[c>>2],i[n+4>>2]=i[c+4>>2],i[n+8>>2]=i[c+8>>2],i[n+12>>2]=i[c+12>>2],0|Vt(t,s,n)){if(u=n+4|0,i[r>>2]=i[u>>2],i[r+4>>2]=i[u+4>>2],i[r+8>>2]=i[u+8>>2],l=0|we(0|t,0|s,52),w(),c=15&l,1&l?(it(u),l=c+1|0):l=c,0|N(h)){t:do{if(c)for(e=1;;){if(a=0|we(0|t,0|s,3*(15-e|0)|0),w(),0|(a&=7)){s=a;break t}if(!(e>>>0<c>>>0)){s=0;break}e=e+1|0}else s=0}while(0);s=4==(0|s)&1}else s=0;if(0|xt(n,l,s,0)){if(0|N(h))do{}while(0!=(0|xt(n,l,0,0)));(0|l)!=(0|c)&&nt(u)}else(0|l)!=(0|c)&&(i[u>>2]=i[r>>2],i[u+4>>2]=i[r+4>>2],i[u+8>>2]=i[r+8>>2]);I=o}else I=o}function Zt(t,e,n){var r,i;n|=0,r=I,I=I+16|0,Gt(t|=0,e|=0,i=r),e=0|we(0|t,0|e,52),w(),_t(i,15&e,n),I=r}function qt(t,e,n){n|=0;var r,i,o=0,s=0;i=I,I=I+16|0,Gt(t|=0,e|=0,r=i),o=0|we(0|t,0|e,45),w(),o=0==(0|N(127&o)),s=0|we(0|t,0|e,52),w(),s&=15;t:do{if(!o){if(0|s)for(o=1;;){if(!(0==((0|Ee(7,0,3*(15-o|0)|0))&t|0)&0==((0|w())&e|0)))break t;if(!(o>>>0<s>>>0))break;o=o+1|0}return vt(r,s,0,5,n),void(I=i)}}while(0);Et(r,s,0,6,n),I=i}function Wt(t,e){e|=0;var n,r=0,o=0,s=0,a=0,l=0,u=0;if(Ee(0|(t|=0),0,52),n=134225919|w(),(0|t)<1){o=0,r=0;do{0|N(o)&&(Ee(0|o,0,45),l=0|n|w(),i[(t=e+(r<<3)|0)>>2]=-1,i[t+4>>2]=l,r=r+1|0),o=o+1|0}while(122!=(0|o))}else{l=0,r=0;do{if(0|N(l)){for(Ee(0|l,0,45),o=1,s=-1,a=0|n|w();s&=~(u=0|Ee(7,0,3*(15-o|0)|0)),a&=~(0|w()),(0|o)!=(0|t);)o=o+1|0;i[(u=e+(r<<3)|0)>>2]=s,i[u+4>>2]=a,r=r+1|0}l=l+1|0}while(122!=(0|l))}}function Ht(t,e,n,r){var o,s=0,a=0,l=0,u=0,c=0;if(o=I,I=I+64|0,l=o,(0|(t|=0))==(0|(n|=0))&(0|(e|=0))==(0|(r|=0))|!1|134217728!=(2013265920&e|0)|!1|134217728!=(2013265920&r|0))return I=o,0;if(s=0|we(0|t,0|e,52),w(),s&=15,a=0|we(0|n,0|r,52),w(),(0|s)!=(15&a|0))return I=o,0;if(a=s+-1|0,s>>>0>1&&(c=0|Rt(t,e,a),u=0|w(),(0|c)==(0|(a=0|Rt(n,r,a)))&(0|u)==(0|w()))){if(s=0|we(0|t,0|e,0|(a=3*(15^s)|0)),w(),s&=7,a=0|we(0|n,0|r,0|a),w(),0==(0|s)|0==(0|(a&=7)))return I=o,1;if((0|i[21136+(s<<2)>>2])==(0|a))return I=o,1;if((0|i[21168+(s<<2)>>2])==(0|a))return I=o,1}a=(s=l)+56|0;do{i[s>>2]=0,s=s+4|0}while((0|s)<(0|a));return O(t,e,1,l),s=(0|i[(c=l)>>2])==(0|n)&&(0|i[c+4>>2])==(0|r)||(0|i[(c=l+8|0)>>2])==(0|n)&&(0|i[c+4>>2])==(0|r)||(0|i[(c=l+16|0)>>2])==(0|n)&&(0|i[c+4>>2])==(0|r)||(0|i[(c=l+24|0)>>2])==(0|n)&&(0|i[c+4>>2])==(0|r)||(0|i[(c=l+32|0)>>2])==(0|n)&&(0|i[c+4>>2])==(0|r)||(0|i[(c=l+40|0)>>2])==(0|n)&&(0|i[c+4>>2])==(0|r)?1:1&((0|i[(s=l+48|0)>>2])==(0|n)?(0|i[s+4>>2])==(0|r):0),I=o,0|s}function Xt(t,e,n){n|=0;var r,o,s,a,l=0;if(s=I,I=I+16|0,o=s,l=0|we(0|(t|=0),0|(e|=0),56),w(),e=0|function(t,e,n){n|=0;var r,o=0;return o=0|kt(t|=0,e|=0),(n+-1|0)>>>0>5||1==(0|n)&(r=0!=(0|o))?-1:(o=0|function(t,e){var n,r,o,s=0,a=0,l=0,u=0,c=0;if(o=I,I=I+32|0,r=o,Gt(t|=0,e|=0,n=o+16|0),l=0|It(t,e),c=0|Dt(t,e),function(t,e){t=7728+(28*(t|=0)|0)|0,i[(e|=0)>>2]=i[t>>2],i[e+4>>2]=i[t+4>>2],i[e+8>>2]=i[t+8>>2],i[e+12>>2]=i[t+12>>2]}(l,r),e=0|function(t,e){t|=0;var n=0,r=0;if((e|=0)>>>0>20)return-1;do{if((0|i[11152+(216*e|0)>>2])!=(0|t))if((0|i[11152+(216*e|0)+8>>2])!=(0|t))if((0|i[11152+(216*e|0)+16>>2])!=(0|t))if((0|i[11152+(216*e|0)+24>>2])!=(0|t))if((0|i[11152+(216*e|0)+32>>2])!=(0|t))if((0|i[11152+(216*e|0)+40>>2])!=(0|t))if((0|i[11152+(216*e|0)+48>>2])!=(0|t))if((0|i[11152+(216*e|0)+56>>2])!=(0|t))if((0|i[11152+(216*e|0)+64>>2])!=(0|t))if((0|i[11152+(216*e|0)+72>>2])!=(0|t))if((0|i[11152+(216*e|0)+80>>2])!=(0|t))if((0|i[11152+(216*e|0)+88>>2])!=(0|t))if((0|i[11152+(216*e|0)+96>>2])!=(0|t))if((0|i[11152+(216*e|0)+104>>2])!=(0|t))if((0|i[11152+(216*e|0)+112>>2])!=(0|t))if((0|i[11152+(216*e|0)+120>>2])!=(0|t))if((0|i[11152+(216*e|0)+128>>2])!=(0|t)){if((0|i[11152+(216*e|0)+136>>2])!=(0|t)){if((0|i[11152+(216*e|0)+144>>2])==(0|t)){t=0,n=2,r=0;break}if((0|i[11152+(216*e|0)+152>>2])==(0|t)){t=0,n=2,r=1;break}if((0|i[11152+(216*e|0)+160>>2])==(0|t)){t=0,n=2,r=2;break}if((0|i[11152+(216*e|0)+168>>2])==(0|t)){t=1,n=2,r=0;break}if((0|i[11152+(216*e|0)+176>>2])==(0|t)){t=1,n=2,r=1;break}if((0|i[11152+(216*e|0)+184>>2])==(0|t)){t=1,n=2,r=2;break}if((0|i[11152+(216*e|0)+192>>2])==(0|t)){t=2,n=2,r=0;break}if((0|i[11152+(216*e|0)+200>>2])==(0|t)){t=2,n=2,r=1;break}if((0|i[11152+(216*e|0)+208>>2])==(0|t)){t=2,n=2,r=2;break}return-1}t=2,n=1,r=2}else t=2,n=1,r=1;else t=2,n=1,r=0;else t=1,n=1,r=2;else t=1,n=1,r=1;else t=1,n=1,r=0;else t=0,n=1,r=2;else t=0,n=1,r=1;else t=0,n=1,r=0;else t=2,n=0,r=2;else t=2,n=0,r=1;else t=2,n=0,r=0;else t=1,n=0,r=2;else t=1,n=0,r=1;else t=1,n=0,r=0;else t=0,n=0,r=2;else t=0,n=0,r=1;else t=0,n=0,r=0}while(0);return 0|i[11152+(216*e|0)+(72*n|0)+(24*t|0)+(r<<3)+4>>2]}(l,0|i[n>>2]),!(0|N(l)))return I=o,0|e;switch(0|l){case 4:t=0,s=14;break;case 14:t=1,s=14;break;case 24:t=2,s=14;break;case 38:t=3,s=14;break;case 49:t=4,s=14;break;case 58:t=5,s=14;break;case 63:t=6,s=14;break;case 72:t=7,s=14;break;case 83:t=8,s=14;break;case 97:t=9,s=14;break;case 107:t=10,s=14;break;case 117:t=11,s=14;break;default:u=0,a=0}return 14==(0|s)&&(u=0|i[22096+(24*t|0)+8>>2],a=0|i[22096+(24*t|0)+16>>2]),(0|(t=0|i[n>>2]))!=(0|i[r>>2])&&(l=0|F(l))|(0|(t=0|i[n>>2]))==(0|a)&&(e=(e+1|0)%6|0),3==(0|c)&(0|t)==(0|a)?(I=o,0|(e+5|0)%6):5==(0|c)&(0|t)==(0|u)?(I=o,0|(e+1|0)%6):(I=o,0|e)}(t,e),r?0|(n=(5-o+(0|i[22384+(n<<2)>>2])|0)%5|0):0|(n=(6-o+(0|i[22416+(n<<2)>>2])|0)%6|0))}(r=(a=!0&268435456==(2013265920&e|0))?t:0,t=a?-2130706433&e|134217728:0,7&l),-1==(0|e))return i[n>>2]=0,void(I=s);Gt(r,t,o),l=0|we(0|r,0|t,52),w(),l&=15,0|kt(r,t)?vt(o,l,e,2,n):Et(o,l,e,2,n),I=s}function $t(t){t|=0;var e,n,r=0;return(e=0|_e(1,12))||E(22691,22646,49,22704),0|(r=0|i[(n=t+4|0)>>2])?(i[(r=r+8|0)>>2]=e,i[n>>2]=e,0|e):(0|i[t>>2]&&E(22721,22646,61,22744),i[(r=t)>>2]=e,i[n>>2]=e,0|e)}function Yt(t,e){var n,r;return t|=0,e|=0,(r=0|Ae(24))||E(22758,22646,78,22772),i[r>>2]=i[e>>2],i[r+4>>2]=i[e+4>>2],i[r+8>>2]=i[e+8>>2],i[r+12>>2]=i[e+12>>2],i[r+16>>2]=0,0|(n=0|i[(e=t+4|0)>>2])?(i[n+16>>2]=r,i[e>>2]=r,0|r):(0|i[t>>2]&&E(22787,22646,82,22772),i[t>>2]=r,i[e>>2]=r,0|r)}function Qt(t){var e,n,r=0,s=0,a=0,u=0,c=0,h=0,p=0,f=0,d=0,g=0,m=0,A=0,y=0,_=0,v=0,b=0,x=0,w=0,S=0,T=0,P=0,M=0,C=0,I=0,O=0,R=0,L=0,k=0,D=0,N=0;if(0|i[(u=8+(t|=0)|0)>>2])return 1;if(!(a=0|i[t>>2]))return 0;r=a,s=0;do{s=s+1|0,r=0|i[r+8>>2]}while(0!=(0|r));if(s>>>0<2)return 0;(n=0|Ae(s<<2))||E(22807,22646,317,22826),(e=0|Ae(s<<5))||E(22848,22646,321,22826),i[t>>2]=0,i[(M=t+4|0)>>2]=0,i[u>>2]=0,s=0,k=0,P=0,m=0;t:for(;;){if(g=0|i[a>>2]){c=0,h=g;do{if(f=+o[h+8>>3],r=h,h=0|i[h+16>>2],p=+o[(u=(d=0==(0|h))?g:h)+8>>3],+l(+(f-p))>3.141592653589793){N=14;break}c+=(p-f)*(+o[r>>3]+ +o[u>>3])}while(!d);if(14==(0|N)){N=0,c=0,r=g;do{T=+o[r+8>>3],R=0|i[(L=r+16|0)>>2],S=+o[(R=0==(0|R)?g:R)+8>>3],c+=(+o[r>>3]+ +o[R>>3])*((S<0?S+6.283185307179586:S)-(T<0?T+6.283185307179586:T)),r=0|i[(0==(0|r)?a:L)>>2]}while(0!=(0|r))}c>0?(i[n+(k<<2)>>2]=a,k=k+1|0,u=P,r=m):N=19}else N=19;if(19==(0|N)){N=0;do{if(!s){if(m){u=M,h=m+8|0,r=a,s=t;break}if(0|i[t>>2]){N=27;break t}u=M,h=t,r=a,s=t;break}if(0|i[(r=s+8|0)>>2]){N=21;break t}if(!(s=0|_e(1,12))){N=23;break t}i[r>>2]=s,u=s+4|0,h=s,r=m}while(0);if(i[h>>2]=a,i[u>>2]=a,h=e+(P<<5)|0,d=0|i[a>>2]){for(o[(g=e+(P<<5)+8|0)>>3]=17976931348623157e292,o[(m=e+(P<<5)+24|0)>>3]=17976931348623157e292,o[h>>3]=-17976931348623157e292,o[(A=e+(P<<5)+16|0)>>3]=-17976931348623157e292,x=17976931348623157e292,w=-17976931348623157e292,u=0,y=d,f=17976931348623157e292,v=17976931348623157e292,b=-17976931348623157e292,p=-17976931348623157e292;c=+o[y>>3],T=+o[y+8>>3],y=0|i[y+16>>2],S=+o[((_=0==(0|y))?d:y)+8>>3],c<f&&(o[g>>3]=c,f=c),T<v&&(o[m>>3]=T,v=T),c>b?o[h>>3]=c:c=b,T>p&&(o[A>>3]=T,p=T),x=T>0&T<x?T:x,w=T<0&T>w?T:w,u|=+l(+(T-S))>3.141592653589793,!_;)b=c;u&&(o[A>>3]=w,o[m>>3]=x)}else i[h>>2]=0,i[h+4>>2]=0,i[h+8>>2]=0,i[h+12>>2]=0,i[h+16>>2]=0,i[h+20>>2]=0,i[h+24>>2]=0,i[h+28>>2]=0;u=P+1|0}if(a=0|i[(L=a+8|0)>>2],i[L>>2]=0,!a){N=45;break}P=u,m=r}if(21==(0|N))E(22624,22646,35,22658);else if(23==(0|N))E(22678,22646,37,22658);else if(27==(0|N))E(22721,22646,61,22744);else if(45==(0|N)){t:do{if((0|k)>0){for(L=0==(0|u),O=u<<2,R=0==(0|t),I=0,r=0;;){if(C=0|i[n+(I<<2)>>2],L)N=73;else{if(!(P=0|Ae(O))){N=50;break}if(!(M=0|Ae(O))){N=52;break}e:do{if(R)s=0;else{for(u=0,s=0,h=t;a=e+(u<<5)|0,0|Kt(0|i[h>>2],a,0|i[C>>2])?(i[P+(s<<2)>>2]=h,i[M+(s<<2)>>2]=a,_=s+1|0):_=s,h=0|i[h+8>>2];)u=u+1|0,s=_;if((0|_)>0)if(a=0|i[P>>2],1==(0|_))s=a;else for(A=0,y=-1,s=a,m=a;;){for(d=0|i[m>>2],a=0,h=0;g=(0|(u=0|i[i[P+(h<<2)>>2]>>2]))==(0|d)?a:a+(1&(0|Kt(u,0|i[M+(h<<2)>>2],0|i[d>>2])))|0,(0|(h=h+1|0))!=(0|_);)a=g;if(s=(u=(0|g)>(0|y))?m:s,(0|(a=A+1|0))==(0|_))break e;A=a,y=u?g:y,m=0|i[P+(a<<2)>>2]}else s=0}}while(0);if(ye(P),ye(M),s){if(a=0|i[(u=s+4|0)>>2])s=a+8|0;else if(0|i[s>>2]){N=70;break}i[s>>2]=C,i[u>>2]=C}else N=73}if(73==(0|N)){if(N=0,0|(r=0|i[C>>2]))do{M=r,r=0|i[r+16>>2],ye(M)}while(0!=(0|r));ye(C),r=2}if((0|(I=I+1|0))>=(0|k)){D=r;break t}}50==(0|N)?E(22863,22646,249,22882):52==(0|N)?E(22901,22646,252,22882):70==(0|N)&&E(22721,22646,61,22744)}else D=0}while(0);return ye(n),ye(e),0|D}return 0}function Kt(t,e,n){t|=0;var r,s=0,a=0,l=0,u=0,c=0,h=0,p=0;if(!(0|Z(e|=0,n|=0)))return 0;if(e=0|G(e),r=+o[n>>3],s=e&(s=+o[n+8>>3])<0?s+6.283185307179586:s,!(t=0|i[t>>2]))return 0;if(e){e=0,n=t;t:for(;;){for(;u=+o[n>>3],h=+o[n+8>>3],p=0|i[(n=n+16|0)>>2],l=+o[(p=0==(0|p)?t:p)>>3],a=+o[p+8>>3],u>l?(c=u,u=h):(c=l,l=u,u=a,a=h),r<l|r>c;)if(!(n=0|i[n>>2])){n=22;break t}if(s=(u=u<0?u+6.283185307179586:u)==s|(h=a<0?a+6.283185307179586:a)==s?s+-2220446049250313e-31:s,((h+=(r-l)/(c-l)*(u-h))<0?h+6.283185307179586:h)>s&&(e^=1),!(n=0|i[n>>2])){n=22;break}}if(22==(0|n))return 0|e}else{e=0,n=t;t:for(;;){for(;u=+o[n>>3],h=+o[n+8>>3],p=0|i[(n=n+16|0)>>2],l=+o[(p=0==(0|p)?t:p)>>3],a=+o[p+8>>3],u>l?(c=u,u=h):(c=l,l=u,u=a,a=h),r<l|r>c;)if(!(n=0|i[n>>2])){n=22;break t}if(a+(r-l)/(c-l)*(u-a)>(s=u==s|a==s?s+-2220446049250313e-31:s)&&(e^=1),!(n=0|i[n>>2])){n=22;break}}if(22==(0|n))return 0|e}return 0}function Jt(t,e,n,o,s){n|=0,o|=0,s|=0;var a,l,u,c,h=0,p=0,f=0,d=0,g=0,m=0,A=0,y=0,_=0,v=0;if(c=I,I=I+32|0,v=c+16|0,u=c,h=0|we(0|(t|=0),0|(e|=0),52),w(),h&=15,A=0|we(0|n,0|o,52),w(),(0|h)!=(15&A|0))return I=c,1;if(g=0|we(0|t,0|e,45),w(),g&=127,m=0|we(0|n,0|o,45),w(),A=(0|g)!=(0|(m&=127))){if(7==(0|(f=0|V(g,m))))return I=c,2;7==(0|(d=0|V(m,g)))?E(22925,22949,151,22959):(y=f,p=d)}else y=0,p=0;a=0|N(g),l=0|N(m),i[v>>2]=0,i[v+4>>2]=0,i[v+8>>2]=0,i[v+12>>2]=0;do{if(y){if(f=(0|(m=0|i[4304+(28*g|0)+(y<<2)>>2]))>0,l)if(f){g=0,d=n,f=o;do{d=0|Bt(d,f),f=0|w(),1==(0|(p=0|ut(p)))&&(p=0|ut(1)),g=g+1|0}while((0|g)!=(0|m));m=p,g=d,d=f}else m=p,g=n,d=o;else if(f){g=0,d=n,f=o;do{d=0|zt(d,f),f=0|w(),p=0|ut(p),g=g+1|0}while((0|g)!=(0|m));m=p,g=d,d=f}else m=p,g=n,d=o;if(Vt(g,d,v),A||E(22972,22949,181,22959),(f=0!=(0|a))&(p=0!=(0|l))&&E(22999,22949,182,22959),f){if(p=0|Dt(t,e),0|r[22032+(7*p|0)+y>>0]){h=3;break}g=d=0|i[21200+(28*p|0)+(y<<2)>>2],_=26}else if(p){if(p=0|Dt(g,d),0|r[22032+(7*p|0)+m>>0]){h=4;break}g=0,d=0|i[21200+(28*m|0)+(p<<2)>>2],_=26}else p=0;if(26==(0|_))if((0|d)<=-1&&E(23030,22949,212,22959),(0|g)<=-1&&E(23053,22949,213,22959),(0|d)>0){f=v+4|0,p=0;do{at(f),p=p+1|0}while((0|p)!=(0|d));p=g}else p=g;if(i[u>>2]=0,i[u+4>>2]=0,i[u+8>>2]=0,ot(u,y),0|h)for(;0|jt(h)?rt(u):it(u),(0|h)>1;)h=h+-1|0;if((0|p)>0){h=0;do{at(u),h=h+1|0}while((0|h)!=(0|p))}Q(_=v+4|0,u,_),$(_),_=50}else if(Vt(n,o,v),0!=(0|a)&0!=(0|l))if((0|m)!=(0|g)&&E(23077,22949,243,22959),p=0|Dt(t,e),h=0|Dt(n,o),0|r[22032+(7*p|0)+h>>0])h=5;else if((0|(p=0|i[21200+(28*p|0)+(h<<2)>>2]))>0){f=v+4|0,h=0;do{at(f),h=h+1|0}while((0|h)!=(0|p));_=50}else _=50;else _=50}while(0);return 50==(0|_)&&(h=v+4|0,i[s>>2]=i[h>>2],i[s+4>>2]=i[h+4>>2],i[s+8>>2]=i[h+8>>2],h=0),I=c,0|h}function te(t,e,n,r){n|=0,r|=0;var o,s,a=0,l=0,u=0,c=0,h=0,p=0,f=0,d=0,g=0,m=0,A=0,y=0,_=0;if(s=I,I=I+48|0,u=s+36|0,c=s+24|0,h=s+12|0,p=s,l=0|we(0|(t|=0),0|(e|=0),52),w(),l&=15,d=0|we(0|t,0|e,45),w(),o=0|N(d&=127),Ee(0|l,0,52),A=134225919|w(),i[(m=r)>>2]=-1,i[m+4>>2]=A,!l)return(0|i[n>>2])>1||(0|i[n+4>>2])>1||(0|i[n+8>>2])>1||127==(0|(a=0|U(d,0|tt(n))))?(I=s,0|(A=1)):(g=0|Ee(0|a,0,45),m=0|w(),m=-1040385&i[(d=r)+4>>2]|m,i[(A=r)>>2]=i[d>>2]|g,i[A+4>>2]=m,I=s,0|(A=0));for(i[u>>2]=i[n>>2],i[u+4>>2]=i[n+4>>2],i[u+8>>2]=i[n+8>>2];i[c>>2]=i[u>>2],i[c+4>>2]=i[u+4>>2],i[c+8>>2]=i[u+8>>2],0|jt(l)?(et(u),i[h>>2]=i[u>>2],i[h+4>>2]=i[u+4>>2],i[h+8>>2]=i[u+8>>2],rt(h)):(nt(u),i[h>>2]=i[u>>2],i[h+4>>2]=i[u+4>>2],i[h+8>>2]=i[u+8>>2],it(h)),K(c,h,p),$(p),y=0|i[(m=r)>>2],m=0|i[m+4>>2],n=0|Ee(7,0,0|(_=3*(15-l|0)|0)),m&=~(0|w()),_=0|Ee(0|tt(p),0,0|_),m=0|w()|m,i[(A=r)>>2]=_|y&~n,i[A+4>>2]=m,(0|l)>1;)l=l+-1|0;t:do{if((0|i[u>>2])<=1&&(0|i[u+4>>2])<=1&&(0|i[u+8>>2])<=1){p=127==(0|(c=0|U(d,l=0|tt(u))))?0:0|N(c);e:do{if(l){if(o){if(u=21408+(28*(0|Dt(t,e))|0)+(l<<2)|0,(0|(u=0|i[u>>2]))>0){n=0;do{l=0|lt(l),n=n+1|0}while((0|n)!=(0|u))}if(1==(0|l)){a=3;break t}127==(0|(n=0|U(d,l)))&&E(23104,22949,376,23134),0|N(n)?E(23147,22949,377,23134):(g=u,f=l,a=n)}else g=0,f=l,a=c;if((0|(h=0|i[4304+(28*d|0)+(f<<2)>>2]))<=-1&&E(23178,22949,384,23134),!p){if((0|g)<=-1&&E(23030,22949,417,23134),0|g){l=0,n=0|i[(u=r)>>2],u=0|i[u+4>>2];do{n=0|Ft(n,u),u=0|w(),i[(_=r)>>2]=n,i[_+4>>2]=u,l=l+1|0}while((0|l)<(0|g))}if((0|h)<=0){l=54;break}for(l=0,n=0|i[(u=r)>>2],u=0|i[u+4>>2];;)if(n=0|Ft(n,u),u=0|w(),i[(_=r)>>2]=n,i[_+4>>2]=u,(0|(l=l+1|0))==(0|h)){l=54;break e}}if(7==(0|(c=0|V(a,d)))&&E(22925,22949,393,23134),n=0|i[(l=r)>>2],l=0|i[l+4>>2],(0|h)>0){u=0;do{n=0|Ft(n,l),l=0|w(),i[(_=r)>>2]=n,i[_+4>>2]=l,u=u+1|0}while((0|u)!=(0|h))}if(n=0|Dt(n,l),_=0|F(a),(0|(n=0|i[(_?21824:21616)+(28*c|0)+(n<<2)>>2]))<=-1&&E(23030,22949,412,23134),n){l=0,u=0|i[(c=r)>>2],c=0|i[c+4>>2];do{u=0|Nt(u,c),c=0|w(),i[(_=r)>>2]=u,i[_+4>>2]=c,l=l+1|0}while((0|l)<(0|n));l=54}else l=54}else if(0!=(0|o)&0!=(0|p))if(l=21408+(28*(_=0|Dt(t,e))|0)+((0|Dt(0|i[(l=r)>>2],0|i[l+4>>2]))<<2)|0,(0|(l=0|i[l>>2]))<=-1&&E(23201,22949,433,23134),l){a=0,n=0|i[(u=r)>>2],u=0|i[u+4>>2];do{n=0|Ft(n,u),u=0|w(),i[(_=r)>>2]=n,i[_+4>>2]=u,a=a+1|0}while((0|a)<(0|l));a=c,l=54}else a=c,l=55;else a=c,l=54}while(0);if(54==(0|l)&&p&&(l=55),55==(0|l)&&1==(0|Dt(0|i[(_=r)>>2],0|i[_+4>>2]))){a=4;break}A=0|i[(_=r)>>2],_=-1040385&i[_+4>>2],y=0|Ee(0|a,0,45),_=0|_|w(),i[(a=r)>>2]=A|y,i[a+4>>2]=_,a=0}else a=2}while(0);return I=s,0|a}function ee(t,e){var n=0;if(!(e|=0))return 1;n=t|=0,t=1;do{t=0|_(0==(1&e|0)?1:n,t),e>>=1,n=0|_(n,n)}while(0!=(0|e));return 0|t}function ne(t,e,n){t|=0;var r,s,a=0,l=0,u=0,c=0,h=0,p=0,f=0,d=0;if(!(0|Z(e|=0,n|=0)))return 0;if(e=0|G(e),s=+o[n>>3],a=e&(a=+o[n+8>>3])<0?a+6.283185307179586:a,(0|(d=0|i[t>>2]))<=0)return 0;if(r=0|i[t+4>>2],e){e=0,n=-1,t=0;t:for(;;){for(f=t;c=+o[r+(f<<4)>>3],p=+o[r+(f<<4)+8>>3],u=+o[r+((t=(n+2|0)%(0|d)|0)<<4)>>3],l=+o[r+(t<<4)+8>>3],c>u?(h=c,c=p):(h=u,u=c,c=l,l=p),s<u|s>h;){if(!((0|(n=f+1|0))<(0|d))){n=22;break t}t=f,f=n,n=t}if(a=(c=c<0?c+6.283185307179586:c)==a|(p=l<0?l+6.283185307179586:l)==a?a+-2220446049250313e-31:a,((p+=(s-u)/(h-u)*(c-p))<0?p+6.283185307179586:p)>a&&(e^=1),(0|(t=f+1|0))>=(0|d)){n=22;break}n=f}if(22==(0|n))return 0|e}else{e=0,n=-1,t=0;t:for(;;){for(f=t;c=+o[r+(f<<4)>>3],p=+o[r+(f<<4)+8>>3],u=+o[r+((t=(n+2|0)%(0|d)|0)<<4)>>3],l=+o[r+(t<<4)+8>>3],c>u?(h=c,c=p):(h=u,u=c,c=l,l=p),s<u|s>h;){if(!((0|(n=f+1|0))<(0|d))){n=22;break t}t=f,f=n,n=t}if(l+(s-u)/(h-u)*(c-l)>(a=c==a|l==a?a+-2220446049250313e-31:a)&&(e^=1),(0|(t=f+1|0))>=(0|d)){n=22;break}n=f}if(22==(0|n))return 0|e}return 0}function re(t,e){e|=0;var n,r,s,a,u,c=0,h=0,p=0,f=0,d=0,g=0,m=0,A=0,y=0,_=0,v=0,b=0;if(!(r=0|i[(t|=0)>>2]))return i[e>>2]=0,i[e+4>>2]=0,i[e+8>>2]=0,i[e+12>>2]=0,i[e+16>>2]=0,i[e+20>>2]=0,i[e+24>>2]=0,void(i[e+28>>2]=0);if(o[(s=e+8|0)>>3]=17976931348623157e292,o[(a=e+24|0)>>3]=17976931348623157e292,o[e>>3]=-17976931348623157e292,o[(u=e+16|0)>>3]=-17976931348623157e292,!((0|r)<=0)){for(n=0|i[t+4>>2],A=17976931348623157e292,y=-17976931348623157e292,_=0,t=-1,f=17976931348623157e292,d=17976931348623157e292,m=-17976931348623157e292,h=-17976931348623157e292,v=0;c=+o[n+(v<<4)>>3],g=+o[n+(v<<4)+8>>3],p=+o[n+(((0|(t=t+2|0))==(0|r)?0:t)<<4)+8>>3],c<f&&(o[s>>3]=c,f=c),g<d&&(o[a>>3]=g,d=g),c>m?o[e>>3]=c:c=m,g>h&&(o[u>>3]=g,h=g),A=g>0&g<A?g:A,y=g<0&g>y?g:y,_|=+l(+(g-p))>3.141592653589793,(0|(t=v+1|0))!=(0|r);)b=v,m=c,v=t,t=b;_&&(o[u>>3]=y,o[a>>3]=A)}}function ie(t,e){e|=0;var n,r=0,s=0,a=0,u=0,c=0,h=0,p=0,f=0,d=0,g=0,m=0,A=0,y=0,_=0,v=0,b=0,x=0,w=0,E=0,S=0,T=0;if(y=0|i[(t|=0)>>2]){if(o[(_=e+8|0)>>3]=17976931348623157e292,o[(v=e+24|0)>>3]=17976931348623157e292,o[e>>3]=-17976931348623157e292,o[(b=e+16|0)>>3]=-17976931348623157e292,(0|y)>0){for(a=0|i[t+4>>2],m=17976931348623157e292,A=-17976931348623157e292,s=0,r=-1,p=17976931348623157e292,f=17976931348623157e292,g=-17976931348623157e292,c=-17976931348623157e292,x=0;u=+o[a+(x<<4)>>3],d=+o[a+(x<<4)+8>>3],h=+o[a+(((0|(S=r+2|0))==(0|y)?0:S)<<4)+8>>3],u<p&&(o[_>>3]=u,p=u),d<f&&(o[v>>3]=d,f=d),u>g?o[e>>3]=u:u=g,d>c&&(o[b>>3]=d,c=d),m=d>0&d<m?d:m,A=d<0&d>A?d:A,s|=+l(+(d-h))>3.141592653589793,(0|(r=x+1|0))!=(0|y);)S=x,g=u,x=r,r=S;s&&(o[b>>3]=A,o[v>>3]=m)}}else i[e>>2]=0,i[e+4>>2]=0,i[e+8>>2]=0,i[e+12>>2]=0,i[e+16>>2]=0,i[e+20>>2]=0,i[e+24>>2]=0,i[e+28>>2]=0;if(!((0|(r=0|i[(S=t+8|0)>>2]))<=0)){n=t+12|0,E=0;do{if(a=0|i[n>>2],s=E,v=e+((E=E+1|0)<<5)|0,b=0|i[a+(s<<3)>>2]){if(o[(x=e+(E<<5)+8|0)>>3]=17976931348623157e292,o[(t=e+(E<<5)+24|0)>>3]=17976931348623157e292,o[v>>3]=-17976931348623157e292,o[(w=e+(E<<5)+16|0)>>3]=-17976931348623157e292,(0|b)>0){for(y=0|i[a+(s<<3)+4>>2],m=17976931348623157e292,A=-17976931348623157e292,a=0,s=-1,_=0,p=17976931348623157e292,f=17976931348623157e292,d=-17976931348623157e292,c=-17976931348623157e292;u=+o[y+(_<<4)>>3],g=+o[y+(_<<4)+8>>3],h=+o[y+(((0|(s=s+2|0))==(0|b)?0:s)<<4)+8>>3],u<p&&(o[x>>3]=u,p=u),g<f&&(o[t>>3]=g,f=g),u>d?o[v>>3]=u:u=d,g>c&&(o[w>>3]=g,c=g),m=g>0&g<m?g:m,A=g<0&g>A?g:A,a|=+l(+(g-h))>3.141592653589793,(0|(s=_+1|0))!=(0|b);)T=_,_=s,d=u,s=T;a&&(o[w>>3]=A,o[t>>3]=m)}}else i[v>>2]=0,i[v+4>>2]=0,i[v+8>>2]=0,i[v+12>>2]=0,i[v+16>>2]=0,i[v+20>>2]=0,i[v+24>>2]=0,i[v+28>>2]=0,r=0|i[S>>2]}while((0|E)<(0|r))}}function oe(t,e,n){var r=0,o=0,s=0;if(!(0|ne(t|=0,e|=0,n|=0)))return 0;if((0|i[(o=t+8|0)>>2])<=0)return 1;for(r=t+12|0,t=0;;){if(s=t,t=t+1|0,0|ne((0|i[r>>2])+(s<<3)|0,e+(t<<5)|0,n)){t=0,r=6;break}if((0|t)>=(0|i[o>>2])){t=1,r=6;break}}return 6==(0|r)?0|t:0}function se(t,e,n,r,i){e|=0,n|=0,r|=0,i|=0;var s,a,l,u,c,h,p,f=0;u=+o[(t|=0)>>3],l=+o[e>>3]-u,a=+o[t+8>>3],s=+o[e+8>>3]-a,h=+o[n>>3],f=((f=+o[r>>3]-h)*(a-(p=+o[n+8>>3]))-(u-h)*(c=+o[r+8>>3]-p))/(l*c-s*f),o[i>>3]=u+l*f,o[i+8>>3]=a+s*f}function ae(t,e){return e|=0,+o[(t|=0)>>3]!=+o[e>>3]?0|(e=0):0|(e=+o[t+8>>3]==+o[e+8>>3])}function le(t,e){var n,r,i;return e|=0,+((i=+o[(t|=0)>>3]-+o[e>>3])*i+(r=+o[t+8>>3]-+o[e+8>>3])*r+(n=+o[t+16>>3]-+o[e+16>>3])*n)}function ue(t,e,n){t|=0,n|=0;var r=0;(0|(e|=0))>0?(r=0|_e(e,4),i[t>>2]=r,r||E(23230,23253,40,23267)):i[t>>2]=0,i[t+4>>2]=e,i[t+8>>2]=0,i[t+12>>2]=n}function ce(t){var e,n,r,s=0,a=0,u=0,h=0;e=4+(t|=0)|0,n=t+12|0,r=t+8|0;t:for(;;){for(a=0|i[e>>2],s=0;;){if((0|s)>=(0|a))break t;if(u=0|i[t>>2],h=0|i[u+(s<<2)>>2])break;s=s+1|0}s=u+(~~(+l(+ +c(10,+ +(15-(0|i[n>>2])|0))*(+o[h>>3]+ +o[h+8>>3]))%+(0|a))>>>0<<2)|0,a=0|i[s>>2];e:do{if(0|a){if(u=h+32|0,(0|a)==(0|h))i[s>>2]=i[u>>2];else{if(!(s=0|i[(a=a+32|0)>>2]))break;for(;(0|s)!=(0|h);)if(!(s=0|i[(a=s+32|0)>>2]))break e;i[a>>2]=i[u>>2]}ye(h),i[r>>2]=(0|i[r>>2])-1}}while(0)}ye(0|i[t>>2])}function he(t){var e,n=0,r=0;for(e=0|i[4+(t|=0)>>2],r=0;;){if((0|r)>=(0|e)){n=0,r=4;break}if(n=0|i[(0|i[t>>2])+(r<<2)>>2]){r=4;break}r=r+1|0}return 4==(0|r)?0|n:0}function pe(t,e){e|=0;var n=0,r=0,s=0,a=0;if(n=~~(+l(+ +c(10,+ +(15-(0|i[12+(t|=0)>>2])|0))*(+o[e>>3]+ +o[e+8>>3]))%+(0|i[t+4>>2]))>>>0,n=(0|i[t>>2])+(n<<2)|0,!(r=0|i[n>>2]))return 1;a=e+32|0;do{if((0|r)!=(0|e)){if(!(n=0|i[r+32>>2]))return 1;for(s=n;;){if((0|s)==(0|e)){s=8;break}if(!(n=0|i[s+32>>2])){n=1,s=10;break}r=s,s=n}if(8==(0|s)){i[r+32>>2]=i[a>>2];break}if(10==(0|s))return 0|n}else i[n>>2]=i[a>>2]}while(0);return ye(e),i[(a=t+8|0)>>2]=(0|i[a>>2])-1,0}function fe(t,e,n){t|=0,e|=0,n|=0;var r,s=0,a=0,u=0;(r=0|Ae(40))||E(23283,23253,98,23296),i[r>>2]=i[e>>2],i[r+4>>2]=i[e+4>>2],i[r+8>>2]=i[e+8>>2],i[r+12>>2]=i[e+12>>2],i[(a=r+16|0)>>2]=i[n>>2],i[a+4>>2]=i[n+4>>2],i[a+8>>2]=i[n+8>>2],i[a+12>>2]=i[n+12>>2],i[r+32>>2]=0,a=~~(+l(+ +c(10,+ +(15-(0|i[t+12>>2])|0))*(+o[e>>3]+ +o[e+8>>3]))%+(0|i[t+4>>2]))>>>0,a=(0|i[t>>2])+(a<<2)|0,s=0|i[a>>2];do{if(s){for(;!(0|Pt(s,e)&&0|Pt(s+16|0,n));)if(a=0|i[s+32>>2],!(0|i[(s=0==(0|a)?s:a)+32>>2])){u=10;break}if(10==(0|u)){i[s+32>>2]=r;break}return ye(r),0|s}i[a>>2]=r}while(0);return i[(u=t+8|0)>>2]=1+(0|i[u>>2]),0|r}function de(t,e,n){e|=0,n|=0;var r=0,s=0;if(s=~~(+l(+ +c(10,+ +(15-(0|i[12+(t|=0)>>2])|0))*(+o[e>>3]+ +o[e+8>>3]))%+(0|i[t+4>>2]))>>>0,!(s=0|i[(0|i[t>>2])+(s<<2)>>2]))return 0;if(!n){for(t=s;;){if(0|Pt(t,e)){r=10;break}if(!(t=0|i[t+32>>2])){t=0,r=10;break}}if(10==(0|r))return 0|t}for(t=s;;){if(0|Pt(t,e)&&0|Pt(t+16|0,n)){r=10;break}if(!(t=0|i[t+32>>2])){t=0,r=10;break}}return 10==(0|r)?0|t:0}function ge(t,e){e|=0;var n=0;if(n=~~(+l(+ +c(10,+ +(15-(0|i[12+(t|=0)>>2])|0))*(+o[e>>3]+ +o[e+8>>3]))%+(0|i[t+4>>2]))>>>0,!(t=0|i[(0|i[t>>2])+(n<<2)>>2]))return 0;for(;;){if(0|Pt(t,e)){e=5;break}if(!(t=0|i[t+32>>2])){t=0,e=5;break}}return 5==(0|e)?0|t:0}function me(t){return 0|~~+function(t){return+ +Ce(+(t=+t))}(t=+t)}function Ae(t){t|=0;var e,n=0,r=0,o=0,s=0,a=0,l=0,u=0,c=0,h=0,p=0,f=0,d=0,g=0,m=0,A=0,y=0,_=0,v=0,b=0,x=0;e=I,I=I+16|0,d=e;do{if(t>>>0<245){if(t=(h=t>>>0<11?16:t+11&-8)>>>3,3&(r=(f=0|i[5829])>>>t)|0)return o=0|i[(r=8+(t=23356+((n=(1&r^1)+t|0)<<1<<2)|0)|0)>>2],(0|(a=0|i[(s=o+8|0)>>2]))==(0|t)?i[5829]=f&~(1<<n):(i[a+12>>2]=t,i[r>>2]=a),x=n<<3,i[o+4>>2]=3|x,i[(x=o+x+4|0)>>2]=1|i[x>>2],I=e,0|s;if(h>>>0>(p=0|i[5831])>>>0){if(0|r)return n=((n=r<<t&((n=2<<t)|0-n))&0-n)-1|0,a=0|i[(t=8+(n=23356+((o=((r=(n>>>=u=n>>>12&16)>>>5&8)|u|(a=(n>>>=r)>>>2&4)|(t=(n>>>=a)>>>1&2)|(o=(n>>>=t)>>>1&1))+(n>>>o)|0)<<1<<2)|0)|0)>>2],(0|(r=0|i[(u=a+8|0)>>2]))==(0|n)?(t=f&~(1<<o),i[5829]=t):(i[r+12>>2]=n,i[t>>2]=r,t=f),l=(x=o<<3)-h|0,i[a+4>>2]=3|h,i[4+(s=a+h|0)>>2]=1|l,i[a+x>>2]=l,0|p&&(o=0|i[5834],r=23356+((n=p>>>3)<<1<<2)|0,t&(n=1<<n)?n=0|i[(t=r+8|0)>>2]:(i[5829]=t|n,n=r,t=r+8|0),i[t>>2]=o,i[n+12>>2]=o,i[o+8>>2]=n,i[o+12>>2]=r),i[5831]=l,i[5834]=s,I=e,0|u;if(a=0|i[5830]){for(r=(a&0-a)-1|0,r=c=0|i[23620+(((o=(r>>>=s=r>>>12&16)>>>5&8)|s|(l=(r>>>=o)>>>2&4)|(u=(r>>>=l)>>>1&2)|(c=(r>>>=u)>>>1&1))+(r>>>c)<<2)>>2],u=c,c=(-8&i[c+4>>2])-h|0;(t=0|i[r+16>>2])||(t=0|i[r+20>>2]);)r=t,u=(s=(l=(-8&i[t+4>>2])-h|0)>>>0<c>>>0)?t:u,c=s?l:c;if((l=u+h|0)>>>0>u>>>0){s=0|i[u+24>>2],n=0|i[u+12>>2];do{if((0|n)==(0|u)){if(!(n=0|i[(t=u+20|0)>>2])&&!(n=0|i[(t=u+16|0)>>2])){r=0;break}for(;;)if(r=0|i[(o=n+20|0)>>2])n=r,t=o;else{if(!(r=0|i[(o=n+16|0)>>2]))break;n=r,t=o}i[t>>2]=0,r=n}else r=0|i[u+8>>2],i[r+12>>2]=n,i[n+8>>2]=r,r=n}while(0);do{if(0|s){if(n=0|i[u+28>>2],(0|u)==(0|i[(t=23620+(n<<2)|0)>>2])){if(i[t>>2]=r,!r){i[5830]=a&~(1<<n);break}}else if(i[((0|i[(x=s+16|0)>>2])==(0|u)?x:s+20|0)>>2]=r,!r)break;i[r+24>>2]=s,0|(n=0|i[u+16>>2])&&(i[r+16>>2]=n,i[n+24>>2]=r),0|(n=0|i[u+20>>2])&&(i[r+20>>2]=n,i[n+24>>2]=r)}}while(0);return c>>>0<16?(x=c+h|0,i[u+4>>2]=3|x,i[(x=u+x+4|0)>>2]=1|i[x>>2]):(i[u+4>>2]=3|h,i[l+4>>2]=1|c,i[l+c>>2]=c,0|p&&(o=0|i[5834],r=23356+((n=p>>>3)<<1<<2)|0,(n=1<<n)&f?n=0|i[(t=r+8|0)>>2]:(i[5829]=n|f,n=r,t=r+8|0),i[t>>2]=o,i[n+12>>2]=o,i[o+8>>2]=n,i[o+12>>2]=r),i[5831]=c,i[5834]=l),I=e,0|u+8}f=h}else f=h}else f=h}else if(t>>>0<=4294967231)if(h=-8&(t=t+11|0),o=0|i[5830]){s=0-h|0,c=(t>>>=8)?h>>>0>16777215?31:h>>>(7+(c=14-((u=(520192+(A=t<<(f=(t+1048320|0)>>>16&8))|0)>>>16&4)|f|(c=(245760+(A<<=u)|0)>>>16&2))+(A<<c>>>15)|0)|0)&1|c<<1:0,r=0|i[23620+(c<<2)>>2];t:do{if(r)for(t=0,u=h<<(31==(0|c)?0:25-(c>>>1)|0),a=0;;){if((l=(-8&i[r+4>>2])-h|0)>>>0<s>>>0){if(!l){t=r,s=0,A=65;break t}t=r,s=l}if(a=0==(0|(A=0|i[r+20>>2]))|(0|A)==(0|(r=0|i[r+16+(u>>>31<<2)>>2]))?a:A,!r){r=a,A=61;break}u<<=1}else r=0,t=0,A=61}while(0);if(61==(0|A)){if(0==(0|r)&0==(0|t)){if(!(t=((t=2<<c)|0-t)&o)){f=h;break}f=(t&0-t)-1|0,t=0,r=0|i[23620+(((a=(f>>>=l=f>>>12&16)>>>5&8)|l|(u=(f>>>=a)>>>2&4)|(c=(f>>>=u)>>>1&2)|(r=(f>>>=c)>>>1&1))+(f>>>r)<<2)>>2]}r?A=65:(u=t,l=s)}if(65==(0|A))for(a=r;;){if(s=(r=(f=(-8&i[a+4>>2])-h|0)>>>0<s>>>0)?f:s,t=r?a:t,(r=0|i[a+16>>2])||(r=0|i[a+20>>2]),!r){u=t,l=s;break}a=r}if(0!=(0|u)&&l>>>0<((0|i[5831])-h|0)>>>0&&(p=u+h|0)>>>0>u>>>0){a=0|i[u+24>>2],n=0|i[u+12>>2];do{if((0|n)==(0|u)){if(!(n=0|i[(t=u+20|0)>>2])&&!(n=0|i[(t=u+16|0)>>2])){n=0;break}for(;;)if(r=0|i[(s=n+20|0)>>2])n=r,t=s;else{if(!(r=0|i[(s=n+16|0)>>2]))break;n=r,t=s}i[t>>2]=0}else x=0|i[u+8>>2],i[x+12>>2]=n,i[n+8>>2]=x}while(0);do{if(a){if(t=0|i[u+28>>2],(0|u)==(0|i[(r=23620+(t<<2)|0)>>2])){if(i[r>>2]=n,!n){o&=~(1<<t),i[5830]=o;break}}else if(i[((0|i[(x=a+16|0)>>2])==(0|u)?x:a+20|0)>>2]=n,!n)break;i[n+24>>2]=a,0|(t=0|i[u+16>>2])&&(i[n+16>>2]=t,i[t+24>>2]=n),(t=0|i[u+20>>2])&&(i[n+20>>2]=t,i[t+24>>2]=n)}}while(0);t:do{if(l>>>0<16)x=l+h|0,i[u+4>>2]=3|x,i[(x=u+x+4|0)>>2]=1|i[x>>2];else{if(i[u+4>>2]=3|h,i[p+4>>2]=1|l,i[p+l>>2]=l,n=l>>>3,l>>>0<256){r=23356+(n<<1<<2)|0,(t=0|i[5829])&(n=1<<n)?n=0|i[(t=r+8|0)>>2]:(i[5829]=t|n,n=r,t=r+8|0),i[t>>2]=p,i[n+12>>2]=p,i[p+8>>2]=n,i[p+12>>2]=r;break}if(n=23620+((r=(n=l>>>8)?l>>>0>16777215?31:l>>>(7+(r=14-((v=(520192+(x=n<<(b=(n+1048320|0)>>>16&8))|0)>>>16&4)|b|(r=(245760+(x<<=v)|0)>>>16&2))+(x<<r>>>15)|0)|0)&1|r<<1:0)<<2)|0,i[p+28>>2]=r,i[4+(t=p+16|0)>>2]=0,i[t>>2]=0,!(o&(t=1<<r))){i[5830]=o|t,i[n>>2]=p,i[p+24>>2]=n,i[p+12>>2]=p,i[p+8>>2]=p;break}n=0|i[n>>2];e:do{if((-8&i[n+4>>2]|0)!=(0|l)){for(o=l<<(31==(0|r)?0:25-(r>>>1)|0);t=0|i[(r=n+16+(o>>>31<<2)|0)>>2];){if((-8&i[t+4>>2]|0)==(0|l)){n=t;break e}o<<=1,n=t}i[r>>2]=p,i[p+24>>2]=n,i[p+12>>2]=p,i[p+8>>2]=p;break t}}while(0);x=0|i[(b=n+8|0)>>2],i[x+12>>2]=p,i[b>>2]=p,i[p+8>>2]=x,i[p+12>>2]=n,i[p+24>>2]=0}}while(0);return I=e,0|u+8}f=h}else f=h;else f=-1}while(0);if((r=0|i[5831])>>>0>=f>>>0)return n=r-f|0,t=0|i[5834],n>>>0>15?(x=t+f|0,i[5834]=x,i[5831]=n,i[x+4>>2]=1|n,i[t+r>>2]=n,i[t+4>>2]=3|f):(i[5831]=0,i[5834]=0,i[t+4>>2]=3|r,i[(x=t+r+4|0)>>2]=1|i[x>>2]),I=e,0|t+8;if((l=0|i[5832])>>>0>f>>>0)return v=l-f|0,i[5832]=v,b=(x=0|i[5835])+f|0,i[5835]=b,i[b+4>>2]=1|v,i[x+4>>2]=3|f,I=e,0|x+8;if(0|i[5947]?t=0|i[5949]:(i[5949]=4096,i[5948]=4096,i[5950]=-1,i[5951]=-1,i[5952]=0,i[5940]=0,i[5947]=-16&d^1431655768,t=4096),u=f+48|0,(h=(a=t+(c=f+47|0)|0)&(s=0-t|0))>>>0<=f>>>0)return I=e,0;if(0|(t=0|i[5939])&&(d=(p=0|i[5937])+h|0)>>>0<=p>>>0|d>>>0>t>>>0)return I=e,0;t:do{if(4&i[5940])n=0,A=143;else{r=0|i[5835];e:do{if(r){for(o=23764;!((d=0|i[o>>2])>>>0<=r>>>0&&(d+(0|i[o+4>>2])|0)>>>0>r>>>0);){if(!(t=0|i[o+8>>2])){A=128;break e}o=t}if((n=a-l&s)>>>0<2147483647)if((0|(t=0|Ie(0|n)))==((0|i[o>>2])+(0|i[o+4>>2])|0)){if(-1!=(0|t)){l=n,a=t,A=145;break t}}else o=t,A=136;else n=0}else A=128}while(0);do{if(128==(0|A))if(-1!=(0|(r=0|Ie(0)))&&(n=r,m=(n=(0==((m=(g=0|i[5948])-1|0)&n|0)?0:(m+n&0-g)-n|0)+h|0)+(g=0|i[5937])|0,n>>>0>f>>>0&n>>>0<2147483647)){if(0|(d=0|i[5939])&&m>>>0<=g>>>0|m>>>0>d>>>0){n=0;break}if((0|(t=0|Ie(0|n)))==(0|r)){l=n,a=r,A=145;break t}o=t,A=136}else n=0}while(0);do{if(136==(0|A)){if(r=0-n|0,!(u>>>0>n>>>0&n>>>0<2147483647&-1!=(0|o))){if(-1==(0|o)){n=0;break}l=n,a=o,A=145;break t}if((t=c-n+(t=0|i[5949])&0-t)>>>0>=2147483647){l=n,a=o,A=145;break t}if(-1==(0|Ie(0|t))){Ie(0|r),n=0;break}l=t+n|0,a=o,A=145;break t}}while(0);i[5940]=4|i[5940],A=143}}while(0);if(143==(0|A)&&h>>>0<2147483647&&!(-1==(0|(v=0|Ie(0|h)))|1^(_=(y=(m=0|Ie(0))-v|0)>>>0>(f+40|0)>>>0)|v>>>0<m>>>0&-1!=(0|v)&-1!=(0|m)^1)&&(l=_?y:n,a=v,A=145),145==(0|A)){n=(0|i[5937])+l|0,i[5937]=n,n>>>0>(0|i[5938])>>>0&&(i[5938]=n),c=0|i[5835];t:do{if(c){for(n=23764;;){if((0|a)==((t=0|i[n>>2])+(r=0|i[n+4>>2])|0)){A=154;break}if(!(o=0|i[n+8>>2]))break;n=o}if(154==(0|A)&&(b=n+4|0,0==(8&i[n+12>>2]|0))&&a>>>0>c>>>0&t>>>0<=c>>>0){i[b>>2]=r+l,b=c+(v=0==(7&(v=c+8|0)|0)?0:0-v&7)|0,v=(x=(0|i[5832])+l|0)-v|0,i[5835]=b,i[5832]=v,i[b+4>>2]=1|v,i[c+x+4>>2]=40,i[5836]=i[5951];break}for(a>>>0<(0|i[5833])>>>0&&(i[5833]=a),r=a+l|0,n=23764;;){if((0|i[n>>2])==(0|r)){A=162;break}if(!(t=0|i[n+8>>2]))break;n=t}if(162==(0|A)&&0==(8&i[n+12>>2]|0)){i[n>>2]=a,i[(p=n+4|0)>>2]=(0|i[p>>2])+l,h=(p=a+(0==(7&(p=a+8|0)|0)?0:0-p&7)|0)+f|0,u=(n=r+(0==(7&(n=r+8|0)|0)?0:0-n&7)|0)-p-f|0,i[p+4>>2]=3|f;e:do{if((0|c)==(0|n))x=(0|i[5832])+u|0,i[5832]=x,i[5835]=h,i[h+4>>2]=1|x;else{if((0|i[5834])==(0|n)){x=(0|i[5831])+u|0,i[5831]=x,i[5834]=h,i[h+4>>2]=1|x,i[h+x>>2]=x;break}if(1==(3&(t=0|i[n+4>>2])|0)){l=-8&t,o=t>>>3;n:do{if(t>>>0<256){if(t=0|i[n+8>>2],(0|(r=0|i[n+12>>2]))==(0|t)){i[5829]=i[5829]&~(1<<o);break}i[t+12>>2]=r,i[r+8>>2]=t;break}a=0|i[n+24>>2],t=0|i[n+12>>2];do{if((0|t)==(0|n)){if(t=0|i[(o=4+(r=n+16|0)|0)>>2])r=o;else if(!(t=0|i[r>>2])){t=0;break}for(;;)if(o=0|i[(s=t+20|0)>>2])t=o,r=s;else{if(!(o=0|i[(s=t+16|0)>>2]))break;t=o,r=s}i[r>>2]=0}else x=0|i[n+8>>2],i[x+12>>2]=t,i[t+8>>2]=x}while(0);if(!a)break;o=23620+((r=0|i[n+28>>2])<<2)|0;do{if((0|i[o>>2])==(0|n)){if(i[o>>2]=t,0|t)break;i[5830]=i[5830]&~(1<<r);break n}if(i[((0|i[(x=a+16|0)>>2])==(0|n)?x:a+20|0)>>2]=t,!t)break n}while(0);if(i[t+24>>2]=a,0|(o=0|i[(r=n+16|0)>>2])&&(i[t+16>>2]=o,i[o+24>>2]=t),!(r=0|i[r+4>>2]))break;i[t+20>>2]=r,i[r+24>>2]=t}while(0);n=n+l|0,s=l+u|0}else s=u;if(i[(n=n+4|0)>>2]=-2&i[n>>2],i[h+4>>2]=1|s,i[h+s>>2]=s,n=s>>>3,s>>>0<256){r=23356+(n<<1<<2)|0,(t=0|i[5829])&(n=1<<n)?n=0|i[(t=r+8|0)>>2]:(i[5829]=t|n,n=r,t=r+8|0),i[t>>2]=h,i[n+12>>2]=h,i[h+8>>2]=n,i[h+12>>2]=r;break}n=s>>>8;do{if(n){if(s>>>0>16777215){o=31;break}o=s>>>(7+(o=14-((v=(520192+(x=n<<(b=(n+1048320|0)>>>16&8))|0)>>>16&4)|b|(o=(245760+(x<<=v)|0)>>>16&2))+(x<<o>>>15)|0)|0)&1|o<<1}else o=0}while(0);if(n=23620+(o<<2)|0,i[h+28>>2]=o,i[4+(t=h+16|0)>>2]=0,i[t>>2]=0,!((t=0|i[5830])&(r=1<<o))){i[5830]=t|r,i[n>>2]=h,i[h+24>>2]=n,i[h+12>>2]=h,i[h+8>>2]=h;break}n=0|i[n>>2];n:do{if((-8&i[n+4>>2]|0)!=(0|s)){for(o=s<<(31==(0|o)?0:25-(o>>>1)|0);t=0|i[(r=n+16+(o>>>31<<2)|0)>>2];){if((-8&i[t+4>>2]|0)==(0|s)){n=t;break n}o<<=1,n=t}i[r>>2]=h,i[h+24>>2]=n,i[h+12>>2]=h,i[h+8>>2]=h;break e}}while(0);x=0|i[(b=n+8|0)>>2],i[x+12>>2]=h,i[b>>2]=h,i[h+8>>2]=x,i[h+12>>2]=n,i[h+24>>2]=0}}while(0);return I=e,0|p+8}for(n=23764;!((t=0|i[n>>2])>>>0<=c>>>0&&(x=t+(0|i[n+4>>2])|0)>>>0>c>>>0);)n=0|i[n+8>>2];n=(t=(t=(s=x+-47|0)+(0==(7&(t=s+8|0)|0)?0:0-t&7)|0)>>>0<(s=c+16|0)>>>0?c:t)+8|0,b=a+(v=0==(7&(v=a+8|0)|0)?0:0-v&7)|0,v=(r=l+-40|0)-v|0,i[5835]=b,i[5832]=v,i[b+4>>2]=1|v,i[a+r+4>>2]=40,i[5836]=i[5951],i[(r=t+4|0)>>2]=27,i[n>>2]=i[5941],i[n+4>>2]=i[5942],i[n+8>>2]=i[5943],i[n+12>>2]=i[5944],i[5941]=a,i[5942]=l,i[5944]=0,i[5943]=n,n=t+24|0;do{b=n,i[(n=n+4|0)>>2]=7}while((b+8|0)>>>0<x>>>0);if((0|t)!=(0|c)){if(a=t-c|0,i[r>>2]=-2&i[r>>2],i[c+4>>2]=1|a,i[t>>2]=a,n=a>>>3,a>>>0<256){r=23356+(n<<1<<2)|0,(t=0|i[5829])&(n=1<<n)?n=0|i[(t=r+8|0)>>2]:(i[5829]=t|n,n=r,t=r+8|0),i[t>>2]=c,i[n+12>>2]=c,i[c+8>>2]=n,i[c+12>>2]=r;break}if(r=23620+((o=(n=a>>>8)?a>>>0>16777215?31:a>>>(7+(o=14-((v=(520192+(x=n<<(b=(n+1048320|0)>>>16&8))|0)>>>16&4)|b|(o=(245760+(x<<=v)|0)>>>16&2))+(x<<o>>>15)|0)|0)&1|o<<1:0)<<2)|0,i[c+28>>2]=o,i[c+20>>2]=0,i[s>>2]=0,!((n=0|i[5830])&(t=1<<o))){i[5830]=n|t,i[r>>2]=c,i[c+24>>2]=r,i[c+12>>2]=c,i[c+8>>2]=c;break}n=0|i[r>>2];e:do{if((-8&i[n+4>>2]|0)!=(0|a)){for(o=a<<(31==(0|o)?0:25-(o>>>1)|0);t=0|i[(r=n+16+(o>>>31<<2)|0)>>2];){if((-8&i[t+4>>2]|0)==(0|a)){n=t;break e}o<<=1,n=t}i[r>>2]=c,i[c+24>>2]=n,i[c+12>>2]=c,i[c+8>>2]=c;break t}}while(0);x=0|i[(b=n+8|0)>>2],i[x+12>>2]=c,i[b>>2]=c,i[c+8>>2]=x,i[c+12>>2]=n,i[c+24>>2]=0}}else 0==(0|(x=0|i[5833]))|a>>>0<x>>>0&&(i[5833]=a),i[5941]=a,i[5942]=l,i[5944]=0,i[5838]=i[5947],i[5837]=-1,i[5842]=23356,i[5841]=23356,i[5844]=23364,i[5843]=23364,i[5846]=23372,i[5845]=23372,i[5848]=23380,i[5847]=23380,i[5850]=23388,i[5849]=23388,i[5852]=23396,i[5851]=23396,i[5854]=23404,i[5853]=23404,i[5856]=23412,i[5855]=23412,i[5858]=23420,i[5857]=23420,i[5860]=23428,i[5859]=23428,i[5862]=23436,i[5861]=23436,i[5864]=23444,i[5863]=23444,i[5866]=23452,i[5865]=23452,i[5868]=23460,i[5867]=23460,i[5870]=23468,i[5869]=23468,i[5872]=23476,i[5871]=23476,i[5874]=23484,i[5873]=23484,i[5876]=23492,i[5875]=23492,i[5878]=23500,i[5877]=23500,i[5880]=23508,i[5879]=23508,i[5882]=23516,i[5881]=23516,i[5884]=23524,i[5883]=23524,i[5886]=23532,i[5885]=23532,i[5888]=23540,i[5887]=23540,i[5890]=23548,i[5889]=23548,i[5892]=23556,i[5891]=23556,i[5894]=23564,i[5893]=23564,i[5896]=23572,i[5895]=23572,i[5898]=23580,i[5897]=23580,i[5900]=23588,i[5899]=23588,i[5902]=23596,i[5901]=23596,i[5904]=23604,i[5903]=23604,b=a+(v=0==(7&(v=a+8|0)|0)?0:0-v&7)|0,v=(x=l+-40|0)-v|0,i[5835]=b,i[5832]=v,i[b+4>>2]=1|v,i[a+x+4>>2]=40,i[5836]=i[5951]}while(0);if((n=0|i[5832])>>>0>f>>>0)return v=n-f|0,i[5832]=v,b=(x=0|i[5835])+f|0,i[5835]=b,i[b+4>>2]=1|v,i[x+4>>2]=3|f,I=e,0|x+8}return i[(x=23312)>>2]=12,I=e,0}function ye(t){var e=0,n=0,r=0,o=0,s=0,a=0,l=0,u=0;if(t|=0){n=t+-8|0,o=0|i[5833],u=n+(e=-8&(t=0|i[t+-4>>2]))|0;do{if(1&t)l=n,a=n;else{if(r=0|i[n>>2],!(3&t))return;if(s=r+e|0,(a=n+(0-r)|0)>>>0<o>>>0)return;if((0|i[5834])==(0|a)){if(3!=(3&(e=0|i[(t=u+4|0)>>2])|0)){l=a,e=s;break}return i[5831]=s,i[t>>2]=-2&e,i[a+4>>2]=1|s,void(i[a+s>>2]=s)}if(n=r>>>3,r>>>0<256){if(t=0|i[a+8>>2],(0|(e=0|i[a+12>>2]))==(0|t)){i[5829]=i[5829]&~(1<<n),l=a,e=s;break}i[t+12>>2]=e,i[e+8>>2]=t,l=a,e=s;break}o=0|i[a+24>>2],t=0|i[a+12>>2];do{if((0|t)==(0|a)){if(t=0|i[(n=4+(e=a+16|0)|0)>>2])e=n;else if(!(t=0|i[e>>2])){t=0;break}for(;;)if(n=0|i[(r=t+20|0)>>2])t=n,e=r;else{if(!(n=0|i[(r=t+16|0)>>2]))break;t=n,e=r}i[e>>2]=0}else l=0|i[a+8>>2],i[l+12>>2]=t,i[t+8>>2]=l}while(0);if(o){if(e=0|i[a+28>>2],(0|i[(n=23620+(e<<2)|0)>>2])==(0|a)){if(i[n>>2]=t,!t){i[5830]=i[5830]&~(1<<e),l=a,e=s;break}}else if(i[((0|i[(l=o+16|0)>>2])==(0|a)?l:o+20|0)>>2]=t,!t){l=a,e=s;break}i[t+24>>2]=o,0|(n=0|i[(e=a+16|0)>>2])&&(i[t+16>>2]=n,i[n+24>>2]=t),(e=0|i[e+4>>2])?(i[t+20>>2]=e,i[e+24>>2]=t,l=a,e=s):(l=a,e=s)}else l=a,e=s}}while(0);if(!(a>>>0>=u>>>0)&&1&(r=0|i[(t=u+4|0)>>2])){if(2&r)i[t>>2]=-2&r,i[l+4>>2]=1|e,i[a+e>>2]=e,o=e;else{if((0|i[5835])==(0|u)){if(u=(0|i[5832])+e|0,i[5832]=u,i[5835]=l,i[l+4>>2]=1|u,(0|l)!=(0|i[5834]))return;return i[5834]=0,void(i[5831]=0)}if((0|i[5834])==(0|u))return u=(0|i[5831])+e|0,i[5831]=u,i[5834]=a,i[l+4>>2]=1|u,void(i[a+u>>2]=u);o=(-8&r)+e|0,n=r>>>3;do{if(r>>>0<256){if(e=0|i[u+8>>2],(0|(t=0|i[u+12>>2]))==(0|e)){i[5829]=i[5829]&~(1<<n);break}i[e+12>>2]=t,i[t+8>>2]=e;break}s=0|i[u+24>>2],t=0|i[u+12>>2];do{if((0|t)==(0|u)){if(t=0|i[(n=4+(e=u+16|0)|0)>>2])e=n;else if(!(t=0|i[e>>2])){n=0;break}for(;;)if(n=0|i[(r=t+20|0)>>2])t=n,e=r;else{if(!(n=0|i[(r=t+16|0)>>2]))break;t=n,e=r}i[e>>2]=0,n=t}else n=0|i[u+8>>2],i[n+12>>2]=t,i[t+8>>2]=n,n=t}while(0);if(0|s){if(t=0|i[u+28>>2],(0|i[(e=23620+(t<<2)|0)>>2])==(0|u)){if(i[e>>2]=n,!n){i[5830]=i[5830]&~(1<<t);break}}else if(i[((0|i[(r=s+16|0)>>2])==(0|u)?r:s+20|0)>>2]=n,!n)break;i[n+24>>2]=s,0|(e=0|i[(t=u+16|0)>>2])&&(i[n+16>>2]=e,i[e+24>>2]=n),0|(t=0|i[t+4>>2])&&(i[n+20>>2]=t,i[t+24>>2]=n)}}while(0);if(i[l+4>>2]=1|o,i[a+o>>2]=o,(0|l)==(0|i[5834]))return void(i[5831]=o)}if(t=o>>>3,o>>>0<256)return n=23356+(t<<1<<2)|0,(e=0|i[5829])&(t=1<<t)?t=0|i[(e=n+8|0)>>2]:(i[5829]=e|t,t=n,e=n+8|0),i[e>>2]=l,i[t+12>>2]=l,i[l+8>>2]=t,void(i[l+12>>2]=n);t=23620+((r=(t=o>>>8)?o>>>0>16777215?31:o>>>(7+(r=14-((s=(520192+(u=t<<(a=(t+1048320|0)>>>16&8))|0)>>>16&4)|a|(r=(245760+(u<<=s)|0)>>>16&2))+(u<<r>>>15)|0)|0)&1|r<<1:0)<<2)|0,i[l+28>>2]=r,i[l+20>>2]=0,i[l+16>>2]=0,e=0|i[5830],n=1<<r;t:do{if(e&n){t=0|i[t>>2];e:do{if((-8&i[t+4>>2]|0)!=(0|o)){for(r=o<<(31==(0|r)?0:25-(r>>>1)|0);e=0|i[(n=t+16+(r>>>31<<2)|0)>>2];){if((-8&i[e+4>>2]|0)==(0|o)){t=e;break e}r<<=1,t=e}i[n>>2]=l,i[l+24>>2]=t,i[l+12>>2]=l,i[l+8>>2]=l;break t}}while(0);u=0|i[(a=t+8|0)>>2],i[u+12>>2]=l,i[a>>2]=l,i[l+8>>2]=u,i[l+12>>2]=t,i[l+24>>2]=0}else i[5830]=e|n,i[t>>2]=l,i[l+24>>2]=t,i[l+12>>2]=l,i[l+8>>2]=l}while(0);if(u=(0|i[5837])-1|0,i[5837]=u,!(0|u)){for(t=23772;t=0|i[t>>2];)t=t+8|0;i[5837]=-1}}}}function _e(t,e){e|=0;var n=0;return(t|=0)?(n=0|_(e,t),(e|t)>>>0>65535&&(n=(0|(n>>>0)/(t>>>0))==(0|e)?n:-1)):n=0,(t=0|Ae(n))&&3&i[t+-4>>2]?(Me(0|t,0,0|n),0|t):0|t}function ve(t,e,n,r){return 0|(x(0|(r=(e|=0)-(r|=0)-((n|=0)>>>0>(t|=0)>>>0|0)>>>0)),t-n>>>0|0)}function be(t){return 0|((t|=0)?31-(0|b(t^t-1))|0:32)}function xe(t,e,n,r){var o,s;return s=I,I=I+16|0,function(t,e,n,r,o){o|=0;var s=0,a=0,l=0,u=0,c=0,h=0,p=0,f=0,d=0,g=0;if(h=t|=0,a=n|=0,l=f=r|=0,!(c=u=e|=0))return s=0!=(0|o),l?s?(i[o>>2]=0|t,i[o+4>>2]=0&e,o=0,0|(x(0|(f=0)),o)):(o=0,0|(x(0|(f=0)),o)):(s&&(i[o>>2]=(h>>>0)%(a>>>0),i[o+4>>2]=0),o=(h>>>0)/(a>>>0)>>>0,0|(x(0|(f=0)),o));s=0==(0|l);do{if(a){if(!s){if((s=(0|b(0|l))-(0|b(0|c))|0)>>>0<=31){a=p=s+1|0,t=h>>>(p>>>0)&(e=s-31>>31)|c<<(l=31-s|0),e&=c>>>(p>>>0),s=0,l=h<<l;break}return o?(i[o>>2]=0|t,i[o+4>>2]=u|0&e,o=0,0|(x(0|(f=0)),o)):(o=0,0|(x(0|(f=0)),o))}if((s=a-1|0)&a|0){a=l=33+(0|b(0|a))-(0|b(0|c))|0,t=(p=32-l|0)-1>>31&c>>>((d=l-32|0)>>>0)|(c<<p|h>>>(l>>>0))&(e=d>>31),e&=c>>>(l>>>0),s=h<<(g=64-l|0)&(u=p>>31),l=(c<<g|h>>>(d>>>0))&u|h<<p&l-33>>31;break}return 0|o&&(i[o>>2]=s&h,i[o+4>>2]=0),1==(0|a)?(g=0|t,0|(x(0|(d=u|0&e)),g)):(d=c>>>((g=0|be(0|a))>>>0)|0,g=c<<32-g|h>>>(g>>>0)|0,0|(x(0|d),g))}if(s)return 0|o&&(i[o>>2]=(c>>>0)%(a>>>0),i[o+4>>2]=0),g=(c>>>0)/(a>>>0)>>>0,0|(x(0|(d=0)),g);if(!h)return 0|o&&(i[o>>2]=0,i[o+4>>2]=(c>>>0)%(l>>>0)),g=(c>>>0)/(l>>>0)>>>0,0|(x(0|(d=0)),g);if(!((s=l-1|0)&l))return 0|o&&(i[o>>2]=0|t,i[o+4>>2]=s&c|0&e),d=0,g=c>>>((0|be(0|l))>>>0),0|(x(0|d),g);if((s=(0|b(0|l))-(0|b(0|c))|0)>>>0<=30){a=e=s+1|0,t=c<<(l=31-s|0)|h>>>(e>>>0),e=c>>>(e>>>0),s=0,l=h<<l;break}return o?(i[o>>2]=0|t,i[o+4>>2]=u|0&e,g=0,0|(x(0|(d=0)),g)):(g=0,0|(x(0|(d=0)),g))}while(0);if(a){c=0|function(t,e,n,r){return 0|(x((e|=0)+(r|=0)+((n=(t|=0)+(n|=0)>>>0)>>>0<t>>>0|0)>>>0|0),0|n)}(0|(p=0|n),0|(h=f|0&r),-1,-1),n=0|w(),u=l,l=0;do{r=u,u=s>>>31|u<<1,s=l|s<<1,ve(0|c,0|n,0|(r=t<<1|r>>>31|0),0|(f=t>>>31|e<<1|0)),l=1&(d=(g=0|w())>>31|((0|g)<0?-1:0)<<1),t=0|ve(0|r,0|f,d&p|0,(((0|g)<0?-1:0)>>31|((0|g)<0?-1:0)<<1)&h|0),e=0|w(),a=a-1|0}while(0!=(0|a));c=u,u=0}else c=l,u=0,l=0;a=0,0|o&&(i[o>>2]=t,i[o+4>>2]=e),g=-2&(s<<1|0)|l,x(0|(d=(0|s)>>>31|(c|a)<<1|0&(a<<1|s>>>31)|u))}(t|=0,e|=0,n|=0,r|=0,o=0|s),I=s,0|(x(0|i[o+4>>2]),0|i[o>>2])}function we(t,e,n){return t|=0,e|=0,(0|(n|=0))<32?(x(e>>>n|0),t>>>n|(e&(1<<n)-1)<<32-n):(x(0),e>>>n-32|0)}function Ee(t,e,n){return t|=0,(0|(n|=0))<32?(x((e|=0)<<n|(t&(1<<n)-1<<32-n)>>>32-n|0),t<<n):(x(t<<n-32|0),0)}function Se(t,e){return e=+e,(t=+t)!=t?+e:e!=e?+t:+v(+t,+e)}function Te(t){return(t=+t)>=0?+a(t+.5):+y(t-.5)}function Pe(t,e,n){t|=0,e|=0;var o,s,a=0;if((0|(n|=0))>=8192)return P(0|t,0|e,0|n),0|t;if(s=0|t,o=t+n|0,(3&t)==(3&e)){for(;3&t;){if(!n)return 0|s;r[t>>0]=0|r[e>>0],t=t+1|0,e=e+1|0,n=n-1|0}for(a=(n=-4&o|0)-64|0;(0|t)<=(0|a);)i[t>>2]=i[e>>2],i[t+4>>2]=i[e+4>>2],i[t+8>>2]=i[e+8>>2],i[t+12>>2]=i[e+12>>2],i[t+16>>2]=i[e+16>>2],i[t+20>>2]=i[e+20>>2],i[t+24>>2]=i[e+24>>2],i[t+28>>2]=i[e+28>>2],i[t+32>>2]=i[e+32>>2],i[t+36>>2]=i[e+36>>2],i[t+40>>2]=i[e+40>>2],i[t+44>>2]=i[e+44>>2],i[t+48>>2]=i[e+48>>2],i[t+52>>2]=i[e+52>>2],i[t+56>>2]=i[e+56>>2],i[t+60>>2]=i[e+60>>2],t=t+64|0,e=e+64|0;for(;(0|t)<(0|n);)i[t>>2]=i[e>>2],t=t+4|0,e=e+4|0}else for(n=o-4|0;(0|t)<(0|n);)r[t>>0]=0|r[e>>0],r[t+1>>0]=0|r[e+1>>0],r[t+2>>0]=0|r[e+2>>0],r[t+3>>0]=0|r[e+3>>0],t=t+4|0,e=e+4|0;for(;(0|t)<(0|o);)r[t>>0]=0|r[e>>0],t=t+1|0,e=e+1|0;return 0|s}function Me(t,e,n){e|=0;var o,s=0,a=0,l=0;if(o=(t|=0)+(n|=0)|0,e&=255,(0|n)>=67){for(;3&t;)r[t>>0]=e,t=t+1|0;for(l=e|e<<8|e<<16|e<<24,a=(s=-4&o|0)-64|0;(0|t)<=(0|a);)i[t>>2]=l,i[t+4>>2]=l,i[t+8>>2]=l,i[t+12>>2]=l,i[t+16>>2]=l,i[t+20>>2]=l,i[t+24>>2]=l,i[t+28>>2]=l,i[t+32>>2]=l,i[t+36>>2]=l,i[t+40>>2]=l,i[t+44>>2]=l,i[t+48>>2]=l,i[t+52>>2]=l,i[t+56>>2]=l,i[t+60>>2]=l,t=t+64|0;for(;(0|t)<(0|s);)i[t>>2]=l,t=t+4|0}for(;(0|t)<(0|o);)r[t>>0]=e,t=t+1|0;return o-n|0}function Ce(t){return(t=+t)>=0?+a(t+.5):+y(t-.5)}function Ie(t){var e,n,r;return t|=0,r=0|T(),(0|t)>0&(0|(e=(n=0|i[s>>2])+t|0))<(0|n)|(0|e)<0?(C(0|e),S(12),-1):(0|e)>(0|r)&&!(0|M(0|e))?(S(12),-1):(i[s>>2]=e,0|n)}return{___uremdi3:xe,_bitshift64Lshr:we,_bitshift64Shl:Ee,_calloc:_e,_cellAreaKm2:function(t,e){var n,r,o,s=0;if(o=I,I=I+192|0,r=o,Zt(t|=0,e|=0,n=o+168|0),qt(t,e,r),(0|(e=0|i[r>>2]))>0){if(s=+Ct(r+8|0,r+8+((1!=(0|e)&1)<<4)|0,n)+0,1!=(0|e)){t=1;do{s+=+Ct(r+8+(t<<4)|0,r+8+(((0|(t=t+1|0))%(0|e)|0)<<4)|0,n)}while((0|t)<(0|e))}}else s=0;return I=o,6371.007180918475*s*6371.007180918475},_cellAreaM2:function(t,e){var n,r,o,s=0;if(o=I,I=I+192|0,r=o,Zt(t|=0,e|=0,n=o+168|0),qt(t,e,r),(0|(e=0|i[r>>2]))>0){if(s=+Ct(r+8|0,r+8+((1!=(0|e)&1)<<4)|0,n)+0,1!=(0|e)){t=1;do{s+=+Ct(r+8+(t<<4)|0,r+8+(((0|(t=t+1|0))%(0|e)|0)<<4)|0,n)}while((0|t)<(0|e))}}else s=0;return I=o,6371.007180918475*s*6371.007180918475*1e3*1e3},_cellAreaRads2:function(t,e){var n,r,o,s=0;if(o=I,I=I+192|0,r=o,Zt(t|=0,e|=0,n=o+168|0),qt(t,e,r),(0|(e=0|i[r>>2]))<=0)return I=o,+(s=0);if(s=+Ct(r+8|0,r+8+((1!=(0|e)&1)<<4)|0,n)+0,1==(0|e))return I=o,+s;t=1;do{s+=+Ct(r+8+(t<<4)|0,r+8+(((0|(t=t+1|0))%(0|e)|0)<<4)|0,n)}while((0|t)<(0|e));return I=o,+s},_compact:function(t,e,n){e|=0;var r,o=0,s=0,a=0,l=0,u=0,c=0,h=0,p=0,f=0,d=0,g=0,m=0,A=0,y=0,_=0,v=0,b=0,x=0,E=0,S=0,T=0;if(!(n|=0))return 0;if(o=0|i[(s=t|=0)>>2],!0&0==(15728640&(s=0|i[s+4>>2])|0)){if((0|n)<=0)return 0;if(i[(S=e)>>2]=o,i[S+4>>2]=s,1==(0|n))return 0;o=1;do{E=0|i[4+(x=t+(o<<3)|0)>>2],i[(S=e+(o<<3)|0)>>2]=i[x>>2],i[S+4>>2]=E,o=o+1|0}while((0|o)!=(0|n));return 0}if(!(E=0|Ae(x=n<<3)))return-3;if(Pe(0|E,0|t,0|x),!(r=0|_e(n,8)))return ye(E),-3;o=n;t:for(;;){v=0|we(0|(p=0|i[(l=E)>>2]),0|(l=0|i[l+4>>2]),52),w(),b=(v&=15)-1|0,_=(0|o)>0;e:do{if(_){if(y=((0|o)<0)<<31>>31,m=0|Ee(0|b,0,52),A=0|w(),b>>>0>15)for(s=0,t=p,n=l;;){if(!(0==(0|t)&0==(0|n))){if(a=0|we(0|t,0|n,52),w(),u=(0|(a&=15))<(0|b),a=(0|a)==(0|b),n=0|xe(0|(h=u?0:a?t:0),0|(t=u?0:a?n:0),0|o,0|y),w(),0==(0|(c=0|i[(u=a=r+(n<<3)|0)>>2]))&0==(0|(u=0|i[u+4>>2])))n=h;else for(m=0,g=n,d=u,n=h;;){if((0|m)>(0|o)){S=41;break t}if((0|c)==(0|n)&(-117440513&d|0)==(0|t)){h=0|we(0|c,0|d,56),w(),f=1+(h&=7)|0,A=0|we(0|c,0|d,45),w();n:do{if(0|N(127&A)){if(c=0|we(0|c,0|d,52),w(),!(c&=15)){u=6;break}for(u=1;;){if(!(0==((A=0|Ee(7,0,3*(15-u|0)|0))&n|0)&0==((0|w())&t|0))){u=7;break n}if(!(u>>>0<c>>>0)){u=6;break}u=u+1|0}}else u=7}while(0);if((h+2|0)>>>0>u>>>0){S=51;break t}A=0|Ee(0|f,0,56),t=0|w()|-117440513&t,i[(u=a)>>2]=0,i[u+4>>2]=0,u=g,n|=A}else u=(g+1|0)%(0|o)|0;if(0==(0|(c=0|i[(d=a=r+(u<<3)|0)>>2]))&0==(0|(d=0|i[d+4>>2])))break;m=m+1|0,g=u}i[(A=a)>>2]=n,i[A+4>>2]=t}if((0|(s=s+1|0))>=(0|o))break e;t=0|i[(n=E+(s<<3)|0)>>2],n=0|i[n+4>>2]}for(s=0,t=p,n=l;;){if(!(0==(0|t)&0==(0|n))){if(u=0|we(0|t,0|n,52),w(),(0|(u&=15))>=(0|b)){if((0|u)!=(0|b)&&(t|=m,n=-15728641&n|A,u>>>0>=v>>>0)){a=b;do{g=0|Ee(7,0,3*(14-a|0)|0),a=a+1|0,t|=g,n=0|w()|n}while(a>>>0<u>>>0)}}else t=0,n=0;if(u=0|xe(0|t,0|n,0|o,0|y),w(),!(0==(0|(h=0|i[(c=a=r+(u<<3)|0)>>2]))&0==(0|(c=0|i[c+4>>2]))))for(g=0;;){if((0|g)>(0|o)){S=41;break t}if((0|h)==(0|t)&(-117440513&c|0)==(0|n)){f=0|we(0|h,0|c,56),w(),d=1+(f&=7)|0,T=0|we(0|h,0|c,45),w();n:do{if(0|N(127&T)){if(h=0|we(0|h,0|c,52),w(),!(h&=15)){c=6;break}for(c=1;;){if(!(0==((T=0|Ee(7,0,3*(15-c|0)|0))&t|0)&0==((0|w())&n|0))){c=7;break n}if(!(c>>>0<h>>>0)){c=6;break}c=c+1|0}}else c=7}while(0);if((f+2|0)>>>0>c>>>0){S=51;break t}T=0|Ee(0|d,0,56),n=0|w()|-117440513&n,i[(d=a)>>2]=0,i[d+4>>2]=0,t|=T}else u=(u+1|0)%(0|o)|0;if(0==(0|(h=0|i[(c=a=r+(u<<3)|0)>>2]))&0==(0|(c=0|i[c+4>>2])))break;g=g+1|0}i[(T=a)>>2]=t,i[T+4>>2]=n}if((0|(s=s+1|0))>=(0|o))break e;t=0|i[(n=E+(s<<3)|0)>>2],n=0|i[n+4>>2]}}}while(0);if((o+5|0)>>>0<11){S=99;break}if(!(A=0|_e((0|o)/6|0,8))){S=58;break}e:do{if(_){g=0,d=0;do{if(!(0==(0|(s=0|i[(t=u=r+(g<<3)|0)>>2]))&0==(0|(t=0|i[t+4>>2])))){c=0|we(0|s,0|t,56),w(),n=1+(c&=7)|0,h=-117440513&t,T=0|we(0|s,0|t,45),w();n:do{if(0|N(127&T)){if(f=0|we(0|s,0|t,52),w(),0|(f&=15))for(a=1;;){if(!(0==(s&(T=0|Ee(7,0,3*(15-a|0)|0))|0)&0==(h&(0|w())|0)))break n;if(!(a>>>0<f>>>0))break;a=a+1|0}s|=t=0|Ee(0|n,0,56),t=0|w()|h,i[(n=u)>>2]=s,i[n+4>>2]=t,n=c+2|0}}while(0);7==(0|n)&&(i[(T=A+(d<<3)|0)>>2]=s,i[T+4>>2]=-117440513&t,d=d+1|0)}g=g+1|0}while((0|g)!=(0|o));if(_){if(m=((0|o)<0)<<31>>31,f=0|Ee(0|b,0,52),g=0|w(),b>>>0>15)for(t=0,s=0;;){do{if(!(0==(0|p)&0==(0|l))){for(c=0|we(0|p,0|l,52),w(),a=(0|(c&=15))<(0|b),c=(0|c)==(0|b),a=0|xe(0|(u=a?0:c?p:0),0|(c=a?0:c?l:0),0|o,0|m),w(),n=0;;){if((0|n)>(0|o)){S=98;break t}if((-117440513&(h=0|i[4+(T=r+(a<<3)|0)>>2])|0)==(0|c)&&(0|i[T>>2])==(0|u)){S=70;break}if((0|i[(T=r+((a=(a+1|0)%(0|o)|0)<<3)|0)>>2])==(0|u)&&(0|i[T+4>>2])==(0|c))break;n=n+1|0}if(70==(0|S)&&(S=0,!0&100663296==(117440512&h|0)))break;i[(T=e+(s<<3)|0)>>2]=p,i[T+4>>2]=l,s=s+1|0}}while(0);if((0|(t=t+1|0))>=(0|o)){o=d;break e}p=0|i[(l=E+(t<<3)|0)>>2],l=0|i[l+4>>2]}for(t=0,s=0;;){do{if(!(0==(0|p)&0==(0|l))){if(c=0|we(0|p,0|l,52),w(),(0|(c&=15))>=(0|b))if((0|c)!=(0|b))if(n=p|f,a=-15728641&l|g,c>>>0<v>>>0)c=a;else{u=b;do{T=0|Ee(7,0,3*(14-u|0)|0),u=u+1|0,n|=T,a=0|w()|a}while(u>>>0<c>>>0);c=a}else n=p,c=l;else n=0,c=0;for(u=0|xe(0|n,0|c,0|o,0|m),w(),a=0;;){if((0|a)>(0|o)){S=98;break t}if((-117440513&(h=0|i[4+(T=r+(u<<3)|0)>>2])|0)==(0|c)&&(0|i[T>>2])==(0|n)){S=93;break}if((0|i[(T=r+((u=(u+1|0)%(0|o)|0)<<3)|0)>>2])==(0|n)&&(0|i[T+4>>2])==(0|c))break;a=a+1|0}if(93==(0|S)&&(S=0,!0&100663296==(117440512&h|0)))break;i[(T=e+(s<<3)|0)>>2]=p,i[T+4>>2]=l,s=s+1|0}}while(0);if((0|(t=t+1|0))>=(0|o)){o=d;break e}p=0|i[(l=E+(t<<3)|0)>>2],l=0|i[l+4>>2]}}else s=0,o=d}else s=0,o=0}while(0);if(Me(0|r,0,0|x),Pe(0|E,0|A,o<<3|0),ye(A),!o)break;e=e+(s<<3)|0}return 41==(0|S)?(ye(E),ye(r),0|(T=-1)):51==(0|S)?(ye(E),ye(r),0|(T=-2)):58==(0|S)?(ye(E),ye(r),0|(T=-3)):98==(0|S)?(ye(A),ye(E),ye(r),0|(T=-1)):(99==(0|S)&&Pe(0|e,0|E,o<<3|0),ye(E),ye(r),0|(T=0))},_destroyLinkedPolygon:function(t){var e=0,n=0,r=0,o=0;if(t|=0)for(r=1;;){if(0|(e=0|i[t>>2]))do{if(0|(n=0|i[e>>2]))do{o=n,n=0|i[n+16>>2],ye(o)}while(0!=(0|n));o=e,e=0|i[e+8>>2],ye(o)}while(0!=(0|e));if(e=t,t=0|i[t+8>>2],r||ye(e),!t)break;r=0}},_edgeLengthKm:function(t){return+ +o[20752+((t|=0)<<3)>>3]},_edgeLengthM:function(t){return+ +o[20880+((t|=0)<<3)>>3]},_emscripten_replace_memory:function(t){return r=new Int8Array(t),new Uint8Array(t),i=new Int32Array(t),new Float32Array(t),o=new Float64Array(t),n=t,!0},_exactEdgeLengthKm:function(t,e){var n,r,s=0,a=0,l=0,c=0,f=0,d=0;if(r=I,I=I+176|0,Xt(t|=0,e|=0,n=r),(0|(t=0|i[n>>2]))<=1)return I=r,+(l=0);e=t+-1|0,t=0,s=0,a=+o[n+8>>3],l=+o[n+16>>3];do{f=a,a=+o[n+8+((t=t+1|0)<<4)>>3],d=+p(.5*(a-f)),c=l,l=+o[n+8+(t<<4)+8>>3],c=d*d+(c=+p(.5*(l-c)))*(+h(+f)*+h(+a)*c),s+=2*+A(+ +u(+c),+ +u(+(1-c)))}while((0|t)!=(0|e));return I=r,+(d=6371.007180918475*s)},_exactEdgeLengthM:function(t,e){var n,r,s=0,a=0,l=0,c=0,f=0,d=0;if(r=I,I=I+176|0,Xt(t|=0,e|=0,n=r),(0|(t=0|i[n>>2]))<=1)return I=r,+(l=0);e=t+-1|0,t=0,s=0,a=+o[n+8>>3],l=+o[n+16>>3];do{f=a,a=+o[n+8+((t=t+1|0)<<4)>>3],d=+p(.5*(a-f)),c=l,l=+o[n+8+(t<<4)+8>>3],c=d*d+(c=+p(.5*(l-c)))*(+h(+f)*+h(+a)*c),s+=2*+A(+ +u(+c),+ +u(+(1-c)))}while((0|t)!=(0|e));return I=r,+(d=6371.007180918475*s*1e3)},_exactEdgeLengthRads:function(t,e){var n,r,s=0,a=0,l=0,c=0,f=0,d=0;if(r=I,I=I+176|0,Xt(t|=0,e|=0,n=r),(0|(t=0|i[n>>2]))<=1)return I=r,+(l=0);e=t+-1|0,t=0,s=0,a=+o[n+8>>3],l=+o[n+16>>3];do{f=a,a=+o[n+8+((t=t+1|0)<<4)>>3],d=+p(.5*(a-f)),c=l,l=+o[n+8+(t<<4)+8>>3],c=d*d+(c=+p(.5*(l-c)))*(+h(+a)*+h(+f)*c),s+=2*+A(+ +u(+c),+ +u(+(1-c)))}while((0|t)<(0|e));return I=r,+s},_experimentalH3ToLocalIj:function(t,e,n,r,i){var o,s;return i|=0,s=I,I=I+16|0,(t=0|Jt(t|=0,e|=0,n|=0,r|=0,o=s))||(ft(o,i),t=0),I=s,0|t},_experimentalLocalIjToH3:function(t,e,n,r){var i,o;return t|=0,e|=0,r|=0,i=I,I=I+16|0,dt(n|=0,o=i),r=0|te(t,e,o,r),I=i,0|r},_free:ye,_geoToH3:Ut,_getDestinationH3IndexFromUnidirectionalEdge:function(t,e){t|=0;var n,r,o=0;return n=I,I=I+16|0,o=n,!0&268435456==(2013265920&(e|=0)|0)?(r=0|we(0|t,0|e,56),w(),i[o>>2]=0,o=0|k(t,-2130706433&e|134217728,7&r,o),e=0|w(),x(0|e),I=n,0|o):(o=0,x(0|(e=0)),I=n,0|o)},_getH3IndexesFromUnidirectionalEdge:function(t,e,n){t|=0;var r,o,s,a,l=0;s=I,I=I+16|0,r=s,a=!0&268435456==(2013265920&(e|=0)|0),o=-2130706433&e|134217728,i[(l=n|=0)>>2]=a?t:0,i[l+4>>2]=a?o:0,a?(e=0|we(0|t,0|e,56),w(),i[r>>2]=0,t=0|k(t,o,7&e,r),e=0|w()):(t=0,e=0),i[(l=n+8|0)>>2]=t,i[l+4>>2]=e,I=s},_getH3UnidirectionalEdge:function(t,e,n,r){var o,s,a=0,l=0,u=0,c=0,h=0;if(s=I,I=I+16|0,o=s,!(0|Ht(t|=0,e|=0,n|=0,r|=0)))return c=0,x(0|(u=0)),I=s,0|c;for(u=-2130706433&e,a=(a=0==(0|kt(t,e)))?1:2;i[o>>2]=0,l=a+1|0,!((0|(h=0|k(t,e,a,o)))==(0|n)&(0|w())==(0|r));){if(!(l>>>0<7)){a=0,t=0,c=6;break}a=l}return 6==(0|c)?(x(0|a),I=s,0|t):(h=0|Ee(0|a,0,56),c=0|u|w()|268435456,h|=t,x(0|c),I=s,0|h)},_getH3UnidirectionalEdgeBoundary:Xt,_getH3UnidirectionalEdgesFromHexagon:function(t,e,n){n|=0;var r,o=0;r=0==(0|kt(t|=0,e|=0)),e&=-2130706433,i[(o=n)>>2]=r?t:0,i[o+4>>2]=r?285212672|e:0,i[(o=n+8|0)>>2]=t,i[o+4>>2]=301989888|e,i[(o=n+16|0)>>2]=t,i[o+4>>2]=318767104|e,i[(o=n+24|0)>>2]=t,i[o+4>>2]=335544320|e,i[(o=n+32|0)>>2]=t,i[o+4>>2]=352321536|e,i[(n=n+40|0)>>2]=t,i[n+4>>2]=369098752|e},_getOriginH3IndexFromUnidirectionalEdge:function(t,e){var n;return t|=0,x(0|((n=!0&268435456==(2013265920&(e|=0)|0))?-2130706433&e|134217728:0)),0|(n?t:0)},_getPentagonIndexes:Wt,_getRes0Indexes:function(t){t|=0;var e=0,n=0,r=0;e=0;do{Ee(0|e,0,45),r=134225919|w(),i[(n=t+(e<<3)|0)>>2]=-1,i[n+4>>2]=r,e=e+1|0}while(122!=(0|e))},_h3Distance:function(t,e,n,r){var i,o,s;return n|=0,r|=0,s=I,I=I+32|0,o=s,t=0==(0|Jt(t|=0,e|=0,t,e,i=s+12|0))&&0==(0|Jt(t,e,n,r,o))?0|pt(i,o):-1,I=s,0|t},_h3GetBaseCell:It,_h3GetFaces:function t(e,n,r){r|=0;var o,s=0,a=0,l=0,u=0,c=0,h=0,p=0,f=0;o=I,I=I+128|0,p=o+112|0,l=o+96|0,f=o,a=0|we(0|(e|=0),0|(n|=0),52),w(),c=15&a,i[p>>2]=c,u=0|we(0|e,0|n,45),w(),u&=127;t:do{if(0|N(u)){if(0|c)for(s=1;;){if(!(0==((h=0|Ee(7,0,3*(15-s|0)|0))&e|0)&0==((0|w())&n|0))){a=0;break t}if(!(s>>>0<c>>>0))break;s=s+1|0}if(!(1&a))return h=0|Ee(c+1|0,0,52),f=0|w()|-15728641&n,t((h|e)&~(p=0|Ee(7,0,3*(14-c|0)|0)),f&~(0|w()),r),void(I=o);a=1}else a=0}while(0);Gt(e,n,l),a?(bt(l,p,f),h=5):(St(l,p,f),h=6);t:do{if(0|N(u))if(c)for(s=1;;){if(!(0==((u=0|Ee(7,0,3*(15-s|0)|0))&e|0)&0==((0|w())&n|0))){s=8;break t}if(!(s>>>0<c>>>0)){s=20;break}s=s+1|0}else s=20;else s=8}while(0);if(Me(0|r,-1,0|s),a){a=0;do{for(wt(l=f+(a<<4)|0,0|i[p>>2]),l=0|i[l>>2],s=0;!(-1==(0|(c=0|i[(u=r+(s<<2)|0)>>2]))|(0|c)==(0|l));)s=s+1|0;i[u>>2]=l,a=a+1|0}while((0|a)!=(0|h))}else{a=0;do{for(xt(l=f+(a<<4)|0,0|i[p>>2],0,1),l=0|i[l>>2],s=0;!(-1==(0|(c=0|i[(u=r+(s<<2)|0)>>2]))|(0|c)==(0|l));)s=s+1|0;i[u>>2]=l,a=a+1|0}while((0|a)!=(0|h))}I=o},_h3GetResolution:function(t,e){return e=0|we(0|(t|=0),0|(e|=0),52),w(),15&e|0},_h3IndexesAreNeighbors:Ht,_h3IsPentagon:kt,_h3IsResClassIII:function(t,e){return e=0|we(0|(t|=0),0|(e|=0),52),w(),1&e|0},_h3IsValid:Ot,_h3Line:function(t,e,n,r,o){n|=0,r|=0,o|=0;var s,a=0,u=0,c=0,h=0,p=0,f=0,d=0,g=0,m=0,A=0,y=0,_=0,v=0,b=0,x=0,w=0,E=0;if(s=I,I=I+48|0,u=s+12|0,w=s,0==(0|Jt(t|=0,e|=0,t,e,a=s+24|0))&&0==(0|Jt(t,e,n,r,u))){if((0|(x=0|pt(a,u)))<0)return I=s,0|x;for(i[a>>2]=0,i[a+4>>2]=0,i[a+8>>2]=0,i[u>>2]=0,i[u+4>>2]=0,i[u+8>>2]=0,Jt(t,e,t,e,a),Jt(t,e,n,r,u),gt(a),gt(u),x?(m=+(0|x),b=a,n=f=0|i[a>>2],r=d=0|i[(_=a+4|0)>>2],a=g=0|i[(v=a+8|0)>>2],A=+((0|i[u>>2])-f|0)/m,y=+((0|i[u+4>>2])-d|0)/m,m=+((0|i[u+8>>2])-g|0)/m):(_=r=a+4|0,v=g=a+8|0,b=a,n=0|i[a>>2],r=0|i[r>>2],a=0|i[g>>2],A=0,y=0,m=0),i[w>>2]=n,i[(g=w+4|0)>>2]=r,i[(d=w+8|0)>>2]=a,f=0;;){E=A*(h=+(0|f))+ +(0|n),c=y*h+ +(0|i[_>>2]),h=m*h+ +(0|i[v>>2]),r=~~+Te(+E),u=~~+Te(+c),n=~~+Te(+h),E=+l(+(+(0|r)-E)),c=+l(+(+(0|u)-c)),h=+l(+(+(0|n)-h));do{if(!(E>c&E>h)){if(p=0-r|0,c>h){a=p-n|0;break}a=u,n=p-u|0;break}r=0-(u+n)|0,a=u}while(0);if(i[w>>2]=r,i[g>>2]=a,i[d>>2]=n,mt(w),te(t,e,w,o+(f<<3)|0),(0|f)==(0|x))break;f=f+1|0,n=0|i[b>>2]}return I=s,0}return I=s,-1},_h3LineSize:function(t,e,n,r){var i,o,s;return n|=0,r|=0,s=I,I=I+32|0,o=s,t=0==(0|Jt(t|=0,e|=0,t,e,i=s+12|0))&&0==(0|Jt(t,e,n,r,o))?0|pt(i,o):-1,I=s,(t>>>31^1)+t|0},_h3SetToLinkedGeo:function(t,e,n){n|=0;var r,o,s,a=0;if(s=I,I=I+32|0,r=s,function(t,e,n){t|=0,n|=0;var r,o,s=0,a=0,l=0,u=0,c=0;if(o=I,I=I+176|0,r=o,(0|(e|=0))<1)return ue(n,0,0),void(I=o);u=0|we(0|i[(u=t)>>2],0|i[u+4>>2],52),w(),ue(n,(0|e)>6?e:6,15&u),u=0;do{if(qt(0|i[(s=t+(u<<3)|0)>>2],0|i[s+4>>2],r),(0|(s=0|i[r>>2]))>0){c=0;do{l=r+8+(c<<4)|0,(a=0|de(n,s=r+8+(((0|(c=c+1|0))%(0|s)|0)<<4)|0,l))?pe(n,a):fe(n,l,s),s=0|i[r>>2]}while((0|c)<(0|s))}u=u+1|0}while((0|u)!=(0|e));I=o}(t|=0,e|=0,o=s+16|0),i[n>>2]=0,i[n+4>>2]=0,i[n+8>>2]=0,!(t=0|he(o)))return Qt(n),ce(o),void(I=s);do{e=0|$t(n);do{Yt(e,t),a=t+16|0,i[r>>2]=i[a>>2],i[r+4>>2]=i[a+4>>2],i[r+8>>2]=i[a+8>>2],i[r+12>>2]=i[a+12>>2],pe(o,t),t=0|ge(o,r)}while(0!=(0|t));t=0|he(o)}while(0!=(0|t));Qt(n),ce(o),I=s},_h3ToCenterChild:function(t,e,n){n|=0;var r=0,i=0;if(r=0|we(0|(t|=0),0|(e|=0),52),w(),(0|n)<16&(0|(r&=15))<=(0|n)){if((0|r)!=(0|n)&&(t|=i=0|Ee(0|n,0,52),e=0|w()|-15728641&e,(0|r)<(0|n)))do{i=0|Ee(7,0,3*(14-r|0)|0),r=r+1|0,t&=~i,e&=~(0|w())}while((0|r)<(0|n))}else e=0,t=0;return x(0|e),0|t},_h3ToChildren:Lt,_h3ToGeo:Zt,_h3ToGeoBoundary:qt,_h3ToParent:Rt,_h3UnidirectionalEdgeIsValid:function(t,e){var n=0;if(!(!0&268435456==(2013265920&(e|=0)|0)))return 0;switch(n=0|we(0|(t|=0),0|e,56),w(),7&n){case 0:case 7:return 0}return!0&16777216==(117440512&e|0)&0!=(0|kt(t,n=-2130706433&e|134217728))?0|(n=0):0|(n=0|Ot(t,n))},_hexAreaKm2:function(t){return+ +o[20496+((t|=0)<<3)>>3]},_hexAreaM2:function(t){return+ +o[20624+((t|=0)<<3)>>3]},_hexRing:function(t,e,n,r){t|=0,e|=0,r|=0;var o,s=0,a=0,l=0,u=0,c=0,h=0,p=0;if(o=I,I=I+16|0,p=o,!(n|=0))return i[(p=r)>>2]=t,i[p+4>>2]=e,I=o,0;i[p>>2]=0;t:do{if(0|kt(t,e))t=1;else{if(a=(0|n)>0){s=0,h=t;do{if(0==(0|(h=0|k(h,e,4,p)))&0==(0|(e=0|w()))){t=2;break t}if(s=s+1|0,0|kt(h,e)){t=1;break t}}while((0|s)<(0|n));if(i[(c=r)>>2]=h,i[c+4>>2]=e,c=n+-1|0,a){a=0,l=1,s=h,t=e;do{if(0==(0|(s=0|k(s,t,2,p)))&0==(0|(t=0|w()))){t=2;break t}if(i[(u=r+(l<<3)|0)>>2]=s,i[u+4>>2]=t,l=l+1|0,0|kt(s,t)){t=1;break t}a=a+1|0}while((0|a)<(0|n));u=0,a=l;do{if(0==(0|(s=0|k(s,t,3,p)))&0==(0|(t=0|w()))){t=2;break t}if(i[(l=r+(a<<3)|0)>>2]=s,i[l+4>>2]=t,a=a+1|0,0|kt(s,t)){t=1;break t}u=u+1|0}while((0|u)<(0|n));l=0;do{if(0==(0|(s=0|k(s,t,1,p)))&0==(0|(t=0|w()))){t=2;break t}if(i[(u=r+(a<<3)|0)>>2]=s,i[u+4>>2]=t,a=a+1|0,0|kt(s,t)){t=1;break t}l=l+1|0}while((0|l)<(0|n));l=0;do{if(0==(0|(s=0|k(s,t,5,p)))&0==(0|(t=0|w()))){t=2;break t}if(i[(u=r+(a<<3)|0)>>2]=s,i[u+4>>2]=t,a=a+1|0,0|kt(s,t)){t=1;break t}l=l+1|0}while((0|l)<(0|n));l=0;do{if(0==(0|(s=0|k(s,t,4,p)))&0==(0|(t=0|w()))){t=2;break t}if(i[(u=r+(a<<3)|0)>>2]=s,i[u+4>>2]=t,a=a+1|0,0|kt(s,t)){t=1;break t}l=l+1|0}while((0|l)<(0|n));for(l=0;;){if(0==(0|(s=0|k(s,t,6,p)))&0==(0|(t=0|w()))){t=2;break t}if((0|l)!=(0|c)){if(i[(u=r+(a<<3)|0)>>2]=s,i[u+4>>2]=t,0|kt(s,t)){t=1;break t}a=a+1|0}if((0|(l=l+1|0))>=(0|n)){l=h,a=e;break}}}else l=h,s=h,a=e,t=e}else i[(l=r)>>2]=t,i[l+4>>2]=e,l=t,s=t,a=e,t=e;t=1&((0|l)!=(0|s)|(0|a)!=(0|t))}}while(0);return I=o,0|t},_i64Subtract:ve,_kRing:O,_kRingDistances:function(t,e,n,r,i){var o;if(0|R(t|=0,e|=0,n|=0,r|=0,i|=0)){if(Me(0|r,0,(o=1+(0|_(3*n|0,n+1|0))|0)<<3|0),0|i)return Me(0|i,0,o<<2|0),void L(t,e,n,r,i,o,0);(i=0|_e(o,4))&&(L(t,e,n,r,i,o,0),ye(i))}},_llvm_minnum_f64:Se,_llvm_round_f64:Te,_malloc:Ae,_maxFaceCount:function(t,e){var n=0,r=0;if(r=0|we(0|(t|=0),0|(e|=0),45),w(),!(0|N(127&r)))return 2;if(r=0|we(0|t,0|e,52),w(),!(r&=15))return 5;for(n=1;;){if(!(0==((0|Ee(7,0,3*(15-n|0)|0))&t|0)&0==((0|w())&e|0))){n=2,t=6;break}if(!(n>>>0<r>>>0)){n=5,t=6;break}n=n+1|0}return 6==(0|t)?0|n:0},_maxH3ToChildrenSize:function(t,e,n){return n|=0,t=0|we(0|(t|=0),0|(e|=0),52),w(),(0|n)<16&(0|(t&=15))<=(0|n)?0|(n=0|ee(7,n-t|0)):0|(n=0)},_maxKringSize:function(t){return 1+(0|_(3*(t|=0)|0,t+1|0))|0},_maxPolyfillSize:function(t,e){e|=0;var n,r=0,o=0,s=0,a=0,l=0;if(n=I,I=I+48|0,s=n+8|0,o=n,a=0|i[4+(l=t|=0)>>2],i[(r=o)>>2]=i[l>>2],i[r+4>>2]=a,re(o,s),s=0|q(s,e),e=0|i[o>>2],(0|(o=0|i[t+8>>2]))<=0)return I=n,0|(l=(a=(0|s)<(0|(l=e)))?l:s)+12;r=0|i[t+12>>2],t=0;do{e=(0|i[r+(t<<3)>>2])+e|0,t=t+1|0}while((0|t)<(0|o));return I=n,0|(l=(l=(0|s)<(0|e))?e:s)+12},_maxUncompactSize:function(t,e,n){t|=0;var r=0,o=0,s=0,a=0;if((0|(e|=0))<=0)return 0;if((0|(n|=0))>=16){for(r=0;;){if(!(0==(0|i[(a=t+(r<<3)|0)>>2])&0==(0|i[a+4>>2]))){r=-1,o=13;break}if((0|(r=r+1|0))>=(0|e)){r=0,o=13;break}}if(13==(0|o))return 0|r}r=0,a=0;t:for(;;){s=0|i[(o=t+(a<<3)|0)>>2],o=0|i[o+4>>2];do{if(!(0==(0|s)&0==(0|o))){if(o=0|we(0|s,0|o,52),w(),(0|(o&=15))>(0|n)){r=-1,o=13;break t}if((0|o)==(0|n)){r=r+1|0;break}r=(0|ee(7,n-o|0))+r|0;break}}while(0);if((0|(a=a+1|0))>=(0|e)){o=13;break}}return 13==(0|o)?0|r:0},_memcpy:Pe,_memset:Me,_numHexagons:function(t){var e;return t=0|i[(e=21008+((t|=0)<<3)|0)>>2],x(0|i[e+4>>2]),0|t},_pentagonIndexCount:function(){return 12},_pointDistKm:Mt,_pointDistM:function(t,e){t|=0;var n,r,i,s=0;return r=+o[(e|=0)>>3],n=+o[t>>3],s=(i=+p(.5*(r-n)))*i+(s=+p(.5*(+o[e+8>>3]-+o[t+8>>3])))*(+h(+r)*+h(+n)*s),2*+A(+ +u(+s),+ +u(+(1-s)))*6371.007180918475*1e3},_pointDistRads:function(t,e){t|=0;var n,r,i,s=0;return r=+o[(e|=0)>>3],n=+o[t>>3],s=(i=+p(.5*(r-n)))*i+(s=+p(.5*(+o[e+8>>3]-+o[t+8>>3])))*(+h(+r)*+h(+n)*s),2*+A(+ +u(+s),+ +u(+(1-s)))},_polyfill:function(t,e,n){var r,o=0,s=0,a=0,l=0,u=0;if(r=I,I=I+48|0,o=r+8|0,s=r,0|function(t,e,n){e|=0,n|=0;var r,o,s,a,l,u=0,c=0,h=0,p=0,f=0,d=0,g=0,m=0,A=0,y=0,_=0,v=0,b=0,x=0,S=0,T=0,P=0,M=0,C=0,O=0,k=0,N=0,F=0,B=0,z=0;if(l=I,I=I+112|0,o=l+80|0,d=l+72|0,s=l,a=l+56|0,(z=0|Ae(32+(i[(g=8+(t|=0)|0)>>2]<<5)|0))||E(22848,22448,800,22456),ie(t,z),u=0|i[(h=t)+4>>2],i[(f=d)>>2]=i[h>>2],i[f+4>>2]=u,re(d,o),f=0|q(o,e),u=0|i[d>>2],(0|(h=0|i[g>>2]))>0){p=0|i[t+12>>2],c=0;do{u=(0|i[p+(c<<3)>>2])+u|0,c=c+1|0}while((0|c)!=(0|h))}if(c=0|_e(r=(f=(0|f)<(0|u)?u:f)+12|0,8),m=0|_e(r,8),i[o>>2]=0,B=0|i[(F=t)+4>>2],i[(u=d)>>2]=i[F>>2],i[u+4>>2]=B,0|(u=0|D(d,r,e,o,c,m)))return ye(c),ye(m),ye(z),I=l,0|u;t:do{if((0|i[g>>2])>0){for(h=t+12|0,u=0;p=0|D((0|i[h>>2])+(u<<3)|0,r,e,o,c,m),u=u+1|0,!(0|p);)if((0|u)>=(0|i[g>>2]))break t;return ye(c),ye(m),ye(z),I=l,0|p}}while(0);(0|f)>-12&&Me(0|m,0,((0|r)>1?r:1)<<3|0);t:do{if((0|i[o>>2])>0){B=((0|r)<0)<<31>>31,M=c,C=m,O=c,k=c,N=m,F=c,u=c,x=c,S=m,T=m,P=m,c=m;e:for(;;){for(b=0|i[o>>2],_=0,v=0,h=0;;){f=(p=s)+56|0;do{i[p>>2]=0,p=p+4|0}while((0|p)<(0|f));if(0|R(d=0|i[(e=M+(_<<3)|0)>>2],e=0|i[e+4>>2],1,s,0)){f=(p=s)+56|0;do{i[p>>2]=0,p=p+4|0}while((0|p)<(0|f));0|(p=0|_e(7,4))&&(L(d,e,1,s,p,7,0),ye(p))}y=0;do{m=0|i[(A=s+(y<<3)|0)>>2],A=0|i[A+4>>2];n:do{if(!(0==(0|m)&0==(0|A))){if(d=0|xe(0|m,0|A,0|r,0|B),w(),!(0==(0|(e=0|i[(f=p=n+(d<<3)|0)>>2]))&0==(0|(f=0|i[f+4>>2]))))for(g=0;;){if((0|g)>(0|r))break e;if((0|e)==(0|m)&(0|f)==(0|A))break n;if(0==(0|(e=0|i[(f=p=n+((d=(d+1|0)%(0|r)|0)<<3)|0)>>2]))&0==(0|(f=0|i[f+4>>2])))break;g=g+1|0}0==(0|m)&0==(0|A)||(Zt(m,A,a),0|oe(t,z,a)&&(i[(g=p)>>2]=m,i[g+4>>2]=A,i[(g=C+(h<<3)|0)>>2]=m,i[g+4>>2]=A,h=h+1|0))}}while(0);y=y+1|0}while(y>>>0<7);if((0|(v=v+1|0))>=(0|b))break;_=_+1|0}if((0|b)>0&&Me(0|O,0,b<<3|0),i[o>>2]=h,!((0|h)>0))break t;m=c,A=P,y=F,_=T,v=S,b=C,c=x,P=u,T=k,S=O,x=m,u=A,F=N,N=y,k=_,O=v,C=M,M=b}return ye(k),ye(N),ye(z),I=l,-1}u=m}while(0);return ye(z),ye(c),ye(u),I=l,0}(t|=0,e|=0,n|=0)){if(a=0|i[(u=t)+4>>2],i[(l=s)>>2]=i[u>>2],i[l+4>>2]=a,re(s,o),l=0|q(o,e),e=0|i[s>>2],(0|(a=0|i[t+8>>2]))>0){s=0|i[t+12>>2],o=0;do{e=(0|i[s+(o<<3)>>2])+e|0,o=o+1|0}while((0|o)!=(0|a))}(0|(e=(0|l)<(0|e)?e:l))<=-12||Me(0|n,0,8+(((0|(u=e+11|0))>0?u:0)<<3)|0),I=r}else I=r},_res0IndexCount:function(){return 122},_round:Ce,_sbrk:Ie,_sizeOfCoordIJ:function(){return 8},_sizeOfGeoBoundary:function(){return 168},_sizeOfGeoCoord:function(){return 16},_sizeOfGeoPolygon:function(){return 16},_sizeOfGeofence:function(){return 8},_sizeOfH3Index:function(){return 8},_sizeOfLinkedGeoPolygon:function(){return 12},_uncompact:function(t,e,n,r,o){t|=0,n|=0,r|=0;var s=0,a=0,l=0,u=0,c=0,h=0;if((0|(e|=0))<=0)return 0;if((0|(o|=0))>=16){for(s=0;;){if(!(0==(0|i[(h=t+(s<<3)|0)>>2])&0==(0|i[h+4>>2]))){s=14;break}if((0|(s=s+1|0))>=(0|e)){a=0,s=16;break}}if(14==(0|s))return 0|((0|r)>0?-2:-1);if(16==(0|s))return 0|a}s=0,h=0;t:for(;;){a=0|i[(l=c=t+(h<<3)|0)>>2],l=0|i[l+4>>2];do{if(!(0==(0|a)&0==(0|l))){if((0|s)>=(0|r)){a=-1,s=16;break t}if(u=0|we(0|a,0|l,52),w(),(0|(u&=15))>(0|o)){a=-2,s=16;break t}if((0|u)==(0|o)){i[(c=n+(s<<3)|0)>>2]=a,i[c+4>>2]=l,s=s+1|0;break}if((0|(a=(0|ee(7,o-u|0))+s|0))>(0|r)){a=-1,s=16;break t}Lt(0|i[c>>2],0|i[c+4>>2],o,n+(s<<3)|0),s=a}}while(0);if((0|(h=h+1|0))>=(0|e)){a=0,s=16;break}}return 16==(0|s)?0|a:0},establishStackSpace:function(t,e){I=t|=0},stackAlloc:function(t){var e;return e=I,I=15+(I=I+(t|=0)|0)&-16,0|e},stackRestore:function(t){I=t|=0},stackSave:function(){return 0|I}}}({Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},{a:at,b:function(t){u=t},c,d:function(t,e,n,r){at("Assertion failed: "+x(t)+", at: "+[e?x(e):"unknown filename",n,r?x(r):"unknown function"])},e:function(t){return n.___errno_location&&(y[n.___errno_location()>>2]=t),t},f:q,g:function(t,e,n){m.set(m.subarray(e,e+n),t)},h:function(t){var e=q(),n=16777216,r=2130706432;if(t>r)return!1;for(var i=Math.max(e,16777216);i<t;)i=i<=536870912?w(2*i,n):Math.min(w((3*i+2147483648)/4,n),r);return!!W(i)},i:function(t){at("OOM")},j:function(t){return t},k:G,l:W,m:Z,n:function(){var t=Z();return n.extraStackTrace&&(t+="\n"+n.extraStackTrace()),G(t)},o:24032,p:24016},d),K=(n.___uremdi3=Q.___uremdi3,n._bitshift64Lshr=Q._bitshift64Lshr,n._bitshift64Shl=Q._bitshift64Shl,n._calloc=Q._calloc,n._cellAreaKm2=Q._cellAreaKm2,n._cellAreaM2=Q._cellAreaM2,n._cellAreaRads2=Q._cellAreaRads2,n._compact=Q._compact,n._destroyLinkedPolygon=Q._destroyLinkedPolygon,n._edgeLengthKm=Q._edgeLengthKm,n._edgeLengthM=Q._edgeLengthM,n._emscripten_replace_memory=Q._emscripten_replace_memory),J=(n._exactEdgeLengthKm=Q._exactEdgeLengthKm,n._exactEdgeLengthM=Q._exactEdgeLengthM,n._exactEdgeLengthRads=Q._exactEdgeLengthRads,n._experimentalH3ToLocalIj=Q._experimentalH3ToLocalIj,n._experimentalLocalIjToH3=Q._experimentalLocalIjToH3,n._free=Q._free,n._geoToH3=Q._geoToH3,n._getDestinationH3IndexFromUnidirectionalEdge=Q._getDestinationH3IndexFromUnidirectionalEdge,n._getH3IndexesFromUnidirectionalEdge=Q._getH3IndexesFromUnidirectionalEdge,n._getH3UnidirectionalEdge=Q._getH3UnidirectionalEdge,n._getH3UnidirectionalEdgeBoundary=Q._getH3UnidirectionalEdgeBoundary,n._getH3UnidirectionalEdgesFromHexagon=Q._getH3UnidirectionalEdgesFromHexagon,n._getOriginH3IndexFromUnidirectionalEdge=Q._getOriginH3IndexFromUnidirectionalEdge,n._getPentagonIndexes=Q._getPentagonIndexes,n._getRes0Indexes=Q._getRes0Indexes,n._h3Distance=Q._h3Distance,n._h3GetBaseCell=Q._h3GetBaseCell,n._h3GetFaces=Q._h3GetFaces,n._h3GetResolution=Q._h3GetResolution,n._h3IndexesAreNeighbors=Q._h3IndexesAreNeighbors,n._h3IsPentagon=Q._h3IsPentagon,n._h3IsResClassIII=Q._h3IsResClassIII,n._h3IsValid=Q._h3IsValid,n._h3Line=Q._h3Line,n._h3LineSize=Q._h3LineSize,n._h3SetToLinkedGeo=Q._h3SetToLinkedGeo,n._h3ToCenterChild=Q._h3ToCenterChild,n._h3ToChildren=Q._h3ToChildren,n._h3ToGeo=Q._h3ToGeo,n._h3ToGeoBoundary=Q._h3ToGeoBoundary,n._h3ToParent=Q._h3ToParent,n._h3UnidirectionalEdgeIsValid=Q._h3UnidirectionalEdgeIsValid,n._hexAreaKm2=Q._hexAreaKm2,n._hexAreaM2=Q._hexAreaM2,n._hexRing=Q._hexRing,n._i64Subtract=Q._i64Subtract,n._kRing=Q._kRing,n._kRingDistances=Q._kRingDistances,n._llvm_minnum_f64=Q._llvm_minnum_f64,n._llvm_round_f64=Q._llvm_round_f64,n._malloc=Q._malloc,n._maxFaceCount=Q._maxFaceCount,n._maxH3ToChildrenSize=Q._maxH3ToChildrenSize,n._maxKringSize=Q._maxKringSize,n._maxPolyfillSize=Q._maxPolyfillSize,n._maxUncompactSize=Q._maxUncompactSize,n._memcpy=Q._memcpy,n._memset=Q._memset,n._numHexagons=Q._numHexagons,n._pentagonIndexCount=Q._pentagonIndexCount,n._pointDistKm=Q._pointDistKm,n._pointDistM=Q._pointDistM,n._pointDistRads=Q._pointDistRads,n._polyfill=Q._polyfill,n._res0IndexCount=Q._res0IndexCount,n._round=Q._round,n._sbrk=Q._sbrk,n._sizeOfCoordIJ=Q._sizeOfCoordIJ,n._sizeOfGeoBoundary=Q._sizeOfGeoBoundary,n._sizeOfGeoCoord=Q._sizeOfGeoCoord,n._sizeOfGeoPolygon=Q._sizeOfGeoPolygon,n._sizeOfGeofence=Q._sizeOfGeofence,n._sizeOfH3Index=Q._sizeOfH3Index,n._sizeOfLinkedGeoPolygon=Q._sizeOfLinkedGeoPolygon,n._uncompact=Q._uncompact,n.establishStackSpace=Q.establishStackSpace,n.stackAlloc=Q.stackAlloc),tt=n.stackRestore=Q.stackRestore,et=n.stackSave=Q.stackSave;if(n.asm=Q,n.cwrap=function(t,e,n,r){var i=(n=n||[]).every((function(t){return"number"===t}));return"string"!==e&&i&&!r?p(t):function(){return f(t,e,n,arguments)}},n.setValue=function(t,e,n,r){switch("*"===(n=n||"i8").charAt(n.length-1)&&(n="i32"),n){case"i1":case"i8":g[t>>0]=e;break;case"i16":A[t>>1]=e;break;case"i32":y[t>>2]=e;break;case"i64":z=[e>>>0,(B=e,+O(B)>=1?B>0?(0|k(+L(B/4294967296),4294967295))>>>0:~~+R((B-+(~~B>>>0))/4294967296)>>>0:0)],y[t>>2]=z[0],y[t+4>>2]=z[1];break;case"float":_[t>>2]=e;break;case"double":v[t>>3]=e;break;default:at("invalid type for setValue: "+n)}},n.getValue=function(t,e,n){switch("*"===(e=e||"i8").charAt(e.length-1)&&(e="i32"),e){case"i1":case"i8":return g[t>>0];case"i16":return A[t>>1];case"i32":case"i64":return y[t>>2];case"float":return _[t>>2];case"double":return v[t>>3];default:at("invalid type for getValue: "+e)}return null},n.getTempRet0=c,j){V(j)||($=j,j=n.locateFile?n.locateFile($,s):s+$),D++,n.monitorRunDependencies&&n.monitorRunDependencies(D);var nt=function(t){t.byteLength&&(t=new Uint8Array(t)),m.set(t,8),n.memoryInitializerRequest&&delete n.memoryInitializerRequest.response,function(t){if(D--,n.monitorRunDependencies&&n.monitorRunDependencies(D),0==D&&(null!==N&&(clearInterval(N),N=null),F)){var e=F;F=null,e()}}()},rt=function(){i(j,nt,(function(){throw"could not load memory initializer "+j}))},it=X(j);if(it)nt(it.buffer);else if(n.memoryInitializerRequest){var ot=function(){var t=n.memoryInitializerRequest,e=t.response;if(200!==t.status&&0!==t.status){var r=X(n.memoryInitializerRequestURL);if(!r)return console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+t.status+", retrying "+j),void rt();e=r.buffer}nt(e)};n.memoryInitializerRequest.response?setTimeout(ot,0):n.memoryInitializerRequest.addEventListener("load",ot)}else rt()}function st(t){function e(){Y||(Y=!0,h||(T(M),T(C),n.onRuntimeInitialized&&n.onRuntimeInitialized(),function(){if(n.postRun)for("function"==typeof n.postRun&&(n.postRun=[n.postRun]);n.postRun.length;)t=n.postRun.shift(),I.unshift(t);var t;T(I)}()))}t=t||o,D>0||(function(){if(n.preRun)for("function"==typeof n.preRun&&(n.preRun=[n.preRun]);n.preRun.length;)t=n.preRun.shift(),P.unshift(t);var t;T(P)}(),D>0||(n.setStatus?(n.setStatus("Running..."),setTimeout((function(){setTimeout((function(){n.setStatus("")}),1),e()}),1)):e()))}function at(t){throw n.onAbort&&n.onAbort(t),a(t+=""),l(t),h=!0,"abort("+t+"). Build with -s ASSERTIONS=1 for more info."}if(F=function t(){Y||st(),Y||(F=t)},n.run=st,n.abort=at,n.preInit)for("function"==typeof n.preInit&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();return st(),t}("object"==typeof r?r:{}),i="number",o={};[["sizeOfH3Index",i],["sizeOfGeoCoord",i],["sizeOfGeoBoundary",i],["sizeOfGeoPolygon",i],["sizeOfGeofence",i],["sizeOfLinkedGeoPolygon",i],["sizeOfCoordIJ",i],["h3IsValid",i,[i,i]],["geoToH3",i,[i,i,i]],["h3ToGeo",null,[i,i,i]],["h3ToGeoBoundary",null,[i,i,i]],["maxKringSize",i,[i]],["kRing",null,[i,i,i,i]],["kRingDistances",null,[i,i,i,i,i]],["hexRing",null,[i,i,i,i]],["maxPolyfillSize",i,[i,i]],["polyfill",null,[i,i,i]],["h3SetToLinkedGeo",null,[i,i,i]],["destroyLinkedPolygon",null,[i]],["compact",i,[i,i,i]],["uncompact",i,[i,i,i,i,i]],["maxUncompactSize",i,[i,i,i]],["h3IsPentagon",i,[i,i]],["h3IsResClassIII",i,[i,i]],["h3GetBaseCell",i,[i,i]],["h3GetResolution",i,[i,i]],["maxFaceCount",i,[i,i]],["h3GetFaces",null,[i,i,i]],["h3ToParent",i,[i,i,i]],["h3ToChildren",null,[i,i,i,i]],["h3ToCenterChild",i,[i,i,i]],["maxH3ToChildrenSize",i,[i,i,i]],["h3IndexesAreNeighbors",i,[i,i,i,i]],["getH3UnidirectionalEdge",i,[i,i,i,i]],["getOriginH3IndexFromUnidirectionalEdge",i,[i,i]],["getDestinationH3IndexFromUnidirectionalEdge",i,[i,i]],["h3UnidirectionalEdgeIsValid",i,[i,i]],["getH3IndexesFromUnidirectionalEdge",null,[i,i,i]],["getH3UnidirectionalEdgesFromHexagon",null,[i,i,i]],["getH3UnidirectionalEdgeBoundary",null,[i,i,i]],["h3Distance",i,[i,i,i,i]],["h3Line",i,[i,i,i,i,i]],["h3LineSize",i,[i,i,i,i]],["experimentalH3ToLocalIj",i,[i,i,i,i,i]],["experimentalLocalIjToH3",i,[i,i,i,i]],["hexAreaM2",i,[i]],["hexAreaKm2",i,[i]],["edgeLengthM",i,[i]],["edgeLengthKm",i,[i]],["pointDistM",i,[i,i]],["pointDistKm",i,[i,i]],["pointDistRads",i,[i,i]],["cellAreaM2",i,[i,i]],["cellAreaKm2",i,[i,i]],["cellAreaRads2",i,[i,i]],["exactEdgeLengthM",i,[i,i]],["exactEdgeLengthKm",i,[i,i]],["exactEdgeLengthRads",i,[i,i]],["numHexagons",i,[i]],["getRes0Indexes",null,[i]],["res0IndexCount",i],["getPentagonIndexes",null,[i,i]],["pentagonIndexCount",i]].forEach((function(t){o[t[0]]=r.cwrap.apply(r,t)}));var s=16,a=o.sizeOfH3Index(),l=o.sizeOfGeoCoord(),u=o.sizeOfGeoBoundary(),c=o.sizeOfGeoPolygon(),h=o.sizeOfGeofence(),p=o.sizeOfLinkedGeoPolygon(),f=o.sizeOfCoordIJ(),d={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function g(t){if("number"!=typeof t||t<0||t>15||Math.floor(t)!==t)throw new Error("Invalid resolution: "+t)}var m=/[^0-9a-fA-F]/;function A(t){if(Array.isArray(t)&&2===t.length&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if("string"!=typeof t||m.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),s);return[parseInt(t.substring(t.length-8),s),e]}function y(t){if(t>=0)return t.toString(s);var e=v(8,(t&=2147483647).toString(s));return(parseInt(e[0],s)+8).toString(s)+e.substring(1)}function _(t,e){return y(e)+v(8,y(t))}function v(t,e){for(var n=t-e.length,r="",i=0;i<n;i++)r+="0";return r+e}function b(t,e,n){for(var i=t.length,o=r._calloc(i,l),s=n?1:0,a=n?0:1,u=0;u<2*i;u+=2)r.HEAPF64.set([t[u/2][s],t[u/2][a]].map(yt),o/8+u);return r.HEAPU32.set([i,o],e/4),e}function x(t){return[t,r.getTempRet0()]}function w(t){var e=x(t),n=e[0],r=e[1];return r?_(n,r):null}function E(t,e){void 0===e&&(e=0);var n=r.getValue(t+4*e*2,"i32"),i=r.getValue(t+4*(2*e+1),"i32");return i?_(n,i):null}function S(t,e,n){r.HEAPU32.set(A(t),e/4+2*n)}function T(t,e){for(var n=[],r=0;r<e;r++){var i=E(t,r);null!==i&&n.push(i)}return n}function P(t,e){for(var n=e.length,r=0;r<n;r++)S(e[r],t,r)}function M(t,e){var n=r._calloc(1,l);return r.HEAPF64.set([t,e].map(yt),n/8),n}function C(t){return _t(r.getValue(t,"double"))}function I(t){return[C(t),C(t+8)]}function O(t){return[C(t+8),C(t)]}function R(t,e,n){for(var i=r.getValue(t,"i32"),o=t+8,s=[],a=e?O:I,l=0;l<2*i;l+=2)s.push(a(o+8*l));return n&&s.push(s[0]),s}function L(t){var e=A(t),n=e[0],r=e[1];return Boolean(o.h3IsValid(n,r))}function k(t){var e=A(t),n=e[0],r=e[1];return Boolean(o.h3IsPentagon(n,r))}function D(t){var e=A(t),n=e[0],r=e[1];return Boolean(o.h3IsResClassIII(n,r))}function N(t){var e=A(t),n=e[0],r=e[1];return o.h3GetBaseCell(n,r)}function F(t){var e=A(t),n=e[0],i=e[1],s=o.maxFaceCount(n,i),a=r._malloc(4*s);o.h3GetFaces(n,i,a);var l=function(t,e){for(var n=[],i=0;i<e;i++){var o=r.getValue(t+4*i,"i32");o>=0&&n.push(o)}return n}(a,s);return r._free(a),l}function B(t){var e=A(t),n=e[0],r=e[1];return o.h3IsValid(n,r)?o.h3GetResolution(n,r):-1}function z(t,e,n){var i=r._malloc(l);r.HEAPF64.set([t,e].map(yt),i/8);var s=w(o.geoToH3(i,n));return r._free(i),s}function j(t){var e=r._malloc(l),n=A(t),i=n[0],s=n[1];o.h3ToGeo(i,s,e);var a=I(e);return r._free(e),a}function U(t,e){var n=r._malloc(u),i=A(t),s=i[0],a=i[1];o.h3ToGeoBoundary(s,a,n);var l=R(n,e,e);return r._free(n),l}function V(t,e){var n=A(t),r=n[0],i=n[1];return w(o.h3ToParent(r,i,e))}function G(t,e){if(!L(t))return[];var n=A(t),i=n[0],s=n[1],l=o.maxH3ToChildrenSize(i,s,e),u=r._calloc(l,a);o.h3ToChildren(i,s,e,u);var c=T(u,l);return r._free(u),c}function Z(t,e){var n=A(t),r=n[0],i=n[1];return w(o.h3ToCenterChild(r,i,e))}function q(t,e){var n=A(t),i=n[0],s=n[1],l=o.maxKringSize(e),u=r._calloc(l,a);o.kRing(i,s,e,u);var c=T(u,l);return r._free(u),c}function W(t,e){var n=A(t),i=n[0],s=n[1],l=o.maxKringSize(e),u=r._calloc(l,a),c=r._calloc(l,4);o.kRingDistances(i,s,e,u,c);for(var h=[],p=0;p<e+1;p++)h.push([]);for(var f=0;f<2*l;f+=2){var d=r.getValue(u+4*f,"i32"),g=r.getValue(u+4*(f+1),"i32"),m=r.getValue(c+f/2*4,"i32");0===d&&0===g||h[m].push(_(d,g))}return r._free(u),r._free(c),h}function H(t,e){var n=0===e?1:6*e,i=r._calloc(n,a);if(0!==o.hexRing.apply(o,A(t).concat([e],[i])))throw r._free(i),new Error("Failed to get hexRing (encountered a pentagon?)");var s=T(i,n);return r._free(i),s}function X(t,e,n){if(g(e),n=Boolean(n),0===t.length||0===t[0].length)return[];"number"==typeof t[0][0]&&(t=[t]);var i=function(t,e){var n,i=t.length-1,o=r._calloc(c),s=0+h,a=s+4;if(b(t[0],o+0,e),i>0){n=r._calloc(i,h);for(var l=0;l<i;l++)b(t[l+1],n+h*l,e)}return r.setValue(o+s,i,"i32"),r.setValue(o+a,n,"i32"),o}(t,n),s=o.maxPolyfillSize(i,e),l=r._calloc(s,a);o.polyfill(i,e,l);var u=T(l,s);return r._free(l),function(t){var e=0+h,n=e+4;r._free(r.getValue(t+0+4,"i8*"));var i=r.getValue(t+e,"i32");if(i>0){for(var o=r.getValue(t+n,"i32"),s=0;s<i;s++)r._free(r.getValue(o+h*s+4,"i8*"));r._free(o)}r._free(t)}(i),u}function $(t,e){if(!t||!t.length)return[];var n=t.length,i=r._calloc(n,a);P(i,t);var s=r._calloc(p),l=s;o.h3SetToLinkedGeo(i,n,s);var u=function(t,e){for(var n,i,o,s,a=[],l=e?O:I;t;){for(a.push(n=[]),i=r.getValue(t,"i8*");i;){for(n.push(o=[]),s=r.getValue(i,"i8*");s;)o.push(l(s)),s=r.getValue(s+16,"i8*");e&&o.push(o[0]),i=r.getValue(i+8,"i8*")}t=r.getValue(t+8,"i8*")}return a}(s,e);return o.destroyLinkedPolygon(l),r._free(l),r._free(i),u}function Y(t){if(!t||!t.length)return[];var e=t.length,n=r._calloc(e,a);P(n,t);var i=r._calloc(e,a);if(0!==o.compact(n,i,e))throw r._free(n),r._free(i),new Error("Failed to compact, malformed input data (duplicate hexagons?)");var s=T(i,e);return r._free(n),r._free(i),s}function Q(t,e){if(g(e),!t||!t.length)return[];var n=t.length,i=r._calloc(n,a);P(i,t);var s=o.maxUncompactSize(i,n,e),l=r._calloc(s,a);if(0!==o.uncompact(i,n,l,s,e))throw r._free(i),r._free(l),new Error("Failed to uncompact (bad resolution?)");var u=T(l,s);return r._free(i),r._free(l),u}function K(t,e){var n=A(t),r=n[0],i=n[1],s=A(e),a=s[0],l=s[1];return Boolean(o.h3IndexesAreNeighbors(r,i,a,l))}function J(t,e){var n=A(t),r=n[0],i=n[1],s=A(e),a=s[0],l=s[1];return w(o.getH3UnidirectionalEdge(r,i,a,l))}function tt(t){var e=A(t),n=e[0],r=e[1];return w(o.getOriginH3IndexFromUnidirectionalEdge(n,r))}function et(t){var e=A(t),n=e[0],r=e[1];return w(o.getDestinationH3IndexFromUnidirectionalEdge(n,r))}function nt(t){var e=A(t),n=e[0],r=e[1];return Boolean(o.h3UnidirectionalEdgeIsValid(n,r))}function rt(t){var e=A(t),n=e[0],i=e[1],s=r._calloc(2,a);o.getH3IndexesFromUnidirectionalEdge(n,i,s);var l=T(s,2);return r._free(s),l}function it(t){var e=A(t),n=e[0],i=e[1],s=r._calloc(6,a);o.getH3UnidirectionalEdgesFromHexagon(n,i,s);var l=T(s,6);return r._free(s),l}function ot(t,e){var n=r._malloc(u),i=A(t),s=i[0],a=i[1];o.getH3UnidirectionalEdgeBoundary(s,a,n);var l=R(n,e);return r._free(n),l}function st(t,e){var n=A(t),r=n[0],i=n[1],s=A(e),a=s[0],l=s[1];return o.h3Distance(r,i,a,l)}function at(t,e){var n=A(t),i=n[0],s=n[1],l=A(e),u=l[0],c=l[1],h=o.h3LineSize(i,s,u,c);if(h<0)throw new Error("Line cannot be calculated");var p=r._calloc(h,a);o.h3Line(i,s,u,c,p);var f=T(p,h);return r._free(p),f}function lt(t,e){var n,i=r._malloc(f),s=o.experimentalH3ToLocalIj.apply(o,A(t).concat(A(e),[i])),a=(n=i,{i:r.getValue(n,"i32"),j:r.getValue(n+4,"i32")});switch(r._free(i),s){case 0:return a;case 1:throw new Error("Incompatible origin and index.");default:throw new Error("Local IJ coordinates undefined for this origin and index pair. The index may be too far from the origin.");case 3:case 4:case 5:throw new Error("Encountered possible pentagon distortion")}}function ut(t,e){if(!e||"number"!=typeof e.i||"number"!=typeof e.j)throw new Error("Coordinates must be provided as an {i, j} object");var n,i,s,l,u=r._malloc(f),c=r._malloc(a);n=u,s=(i=e).i,l=i.j,r.setValue(n,s,"i32"),r.setValue(n+4,l,"i32");var h=o.experimentalLocalIjToH3.apply(o,A(t).concat([u],[c])),p=E(c);if(r._free(u),r._free(c),0!==h)throw new Error("Index not defined for this origin and IJ coordinates pair. IJ coordinates may be too far from origin, or a pentagon distortion was encountered.");return p}function ct(t,e,n){var i,s=M(t[0],t[1]),a=M(e[0],e[1]);switch(n){case d.m:i=o.pointDistM(s,a);break;case d.km:i=o.pointDistKm(s,a);break;case d.rads:i=o.pointDistRads(s,a);break;default:i=null}if(r._free(s),r._free(a),null===i)throw new Error("Unknown unit: "+n);return i}function ht(t,e){var n=A(t),r=n[0],i=n[1];switch(e){case d.m2:return o.cellAreaM2(r,i);case d.km2:return o.cellAreaKm2(r,i);case d.rads2:return o.cellAreaRads2(r,i);default:throw new Error("Unknown unit: "+e)}}function pt(t,e){var n=A(t),r=n[0],i=n[1];switch(e){case d.m:return o.exactEdgeLengthM(r,i);case d.km:return o.exactEdgeLengthKm(r,i);case d.rads:return o.exactEdgeLengthRads(r,i);default:throw new Error("Unknown unit: "+e)}}function ft(t,e){switch(g(t),e){case d.m2:return o.hexAreaM2(t);case d.km2:return o.hexAreaKm2(t);default:throw new Error("Unknown unit: "+e)}}function dt(t,e){switch(g(t),e){case d.m:return o.edgeLengthM(t);case d.km:return o.edgeLengthKm(t);default:throw new Error("Unknown unit: "+e)}}function gt(t){g(t);var e=x(o.numHexagons(t)),n=e[0],r=e[1];return r?r*Math.pow(2,32)+n:n}function mt(){var t=o.res0IndexCount(),e=r._malloc(a*t);o.getRes0Indexes(e);var n=T(e,t);return r._free(e),n}function At(t){g(t);var e=o.pentagonIndexCount(),n=r._malloc(a*e);o.getPentagonIndexes(t,n);var i=T(n,e);return r._free(n),i}function yt(t){return t*Math.PI/180}function _t(t){return 180*t/Math.PI}},840:(t,e,n)=>{var r;!function(i,o,s,a){"use strict";var l,u=["","webkit","Moz","MS","ms","o"],c=o.createElement("div"),h=Math.round,p=Math.abs,f=Date.now;function d(t,e,n){return setTimeout(b(t,n),e)}function g(t,e,n){return!!Array.isArray(t)&&(m(t,n[e],n),!0)}function m(t,e,n){var r;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==a)for(r=0;r<t.length;)e.call(n,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function A(t,e,n){var r="DEPRECATED METHOD: "+e+"\n"+n+" AT \n";return function(){var e=new Error("get-stack-trace"),n=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=i.console&&(i.console.warn||i.console.log);return o&&o.call(i.console,r,n),t.apply(this,arguments)}}l="function"!=typeof Object.assign?function(t){if(t===a||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==a&&null!==r)for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])}return e}:Object.assign;var y=A((function(t,e,n){for(var r=Object.keys(e),i=0;i<r.length;)(!n||n&&t[r[i]]===a)&&(t[r[i]]=e[r[i]]),i++;return t}),"extend","Use `assign`."),_=A((function(t,e){return y(t,e,!0)}),"merge","Use `assign`.");function v(t,e,n){var r,i=e.prototype;(r=t.prototype=Object.create(i)).constructor=t,r._super=i,n&&l(r,n)}function b(t,e){return function(){return t.apply(e,arguments)}}function x(t,e){return"function"==typeof t?t.apply(e&&e[0]||a,e):t}function w(t,e){return t===a?e:t}function E(t,e,n){m(M(e),(function(e){t.addEventListener(e,n,!1)}))}function S(t,e,n){m(M(e),(function(e){t.removeEventListener(e,n,!1)}))}function T(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function P(t,e){return t.indexOf(e)>-1}function M(t){return t.trim().split(/\s+/g)}function C(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var r=0;r<t.length;){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}function I(t){return Array.prototype.slice.call(t,0)}function O(t,e,n){for(var r=[],i=[],o=0;o<t.length;){var s=e?t[o][e]:t[o];C(i,s)<0&&r.push(t[o]),i[o]=s,o++}return n&&(r=e?r.sort((function(t,n){return t[e]>n[e]})):r.sort()),r}function R(t,e){for(var n,r,i=e[0].toUpperCase()+e.slice(1),o=0;o<u.length;){if((r=(n=u[o])?n+i:e)in t)return r;o++}return a}var L=1;function k(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||i}var D="ontouchstart"in i,N=R(i,"PointerEvent")!==a,F=D&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),B="touch",z="mouse",j=["x","y"],U=["clientX","clientY"];function V(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){x(t.options.enable,[t])&&n.handler(e)},this.init()}function G(t,e,n){var r=n.pointers.length,i=n.changedPointers.length,o=1&e&&r-i==0,s=12&e&&r-i==0;n.isFirst=!!o,n.isFinal=!!s,o&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,r=e.pointers,i=r.length;n.firstInput||(n.firstInput=Z(e)),i>1&&!n.firstMultiple?n.firstMultiple=Z(e):1===i&&(n.firstMultiple=!1);var o=n.firstInput,s=n.firstMultiple,l=s?s.center:o.center,u=e.center=q(r);e.timeStamp=f(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=$(l,u),e.distance=X(l,u),function(t,e){var n=e.center,r=t.offsetDelta||{},i=t.prevDelta||{},o=t.prevInput||{};1!==e.eventType&&4!==o.eventType||(i=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y}),e.deltaX=i.x+(n.x-r.x),e.deltaY=i.y+(n.y-r.y)}(n,e),e.offsetDirection=H(e.deltaX,e.deltaY);var c,h,d=W(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=d.x,e.overallVelocityY=d.y,e.overallVelocity=p(d.x)>p(d.y)?d.x:d.y,e.scale=s?(c=s.pointers,X((h=r)[0],h[1],U)/X(c[0],c[1],U)):1,e.rotation=s?function(t,e){return $(e[1],e[0],U)+$(t[1],t[0],U)}(s.pointers,r):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,r,i,o,s=t.lastInterval||e,l=e.timeStamp-s.timeStamp;if(8!=e.eventType&&(l>25||s.velocity===a)){var u=e.deltaX-s.deltaX,c=e.deltaY-s.deltaY,h=W(l,u,c);r=h.x,i=h.y,n=p(h.x)>p(h.y)?h.x:h.y,o=H(u,c),t.lastInterval=e}else n=s.velocity,r=s.velocityX,i=s.velocityY,o=s.direction;e.velocity=n,e.velocityX=r,e.velocityY=i,e.direction=o}(n,e);var g=t.element;T(e.srcEvent.target,g)&&(g=e.srcEvent.target),e.target=g}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function Z(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:h(t.pointers[n].clientX),clientY:h(t.pointers[n].clientY)},n++;return{timeStamp:f(),pointers:e,center:q(e),deltaX:t.deltaX,deltaY:t.deltaY}}function q(t){var e=t.length;if(1===e)return{x:h(t[0].clientX),y:h(t[0].clientY)};for(var n=0,r=0,i=0;i<e;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:h(n/e),y:h(r/e)}}function W(t,e,n){return{x:e/t||0,y:n/t||0}}function H(t,e){return t===e?1:p(t)>=p(e)?t<0?2:4:e<0?8:16}function X(t,e,n){n||(n=j);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function $(t,e,n){n||(n=j);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return 180*Math.atan2(i,r)/Math.PI}V.prototype={handler:function(){},init:function(){this.evEl&&E(this.element,this.evEl,this.domHandler),this.evTarget&&E(this.target,this.evTarget,this.domHandler),this.evWin&&E(k(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&S(this.element,this.evEl,this.domHandler),this.evTarget&&S(this.target,this.evTarget,this.domHandler),this.evWin&&S(k(this.element),this.evWin,this.domHandler)}};var Y={mousedown:1,mousemove:2,mouseup:4},Q="mousedown",K="mousemove mouseup";function J(){this.evEl=Q,this.evWin=K,this.pressed=!1,V.apply(this,arguments)}v(J,V,{handler:function(t){var e=Y[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:z,srcEvent:t}))}});var tt={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},et={2:B,3:"pen",4:z,5:"kinect"},nt="pointerdown",rt="pointermove pointerup pointercancel";function it(){this.evEl=nt,this.evWin=rt,V.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&(nt="MSPointerDown",rt="MSPointerMove MSPointerUp MSPointerCancel"),v(it,V,{handler:function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),i=tt[r],o=et[t.pointerType]||t.pointerType,s=o==B,a=C(e,t.pointerId,"pointerId");1&i&&(0===t.button||s)?a<0&&(e.push(t),a=e.length-1):12&i&&(n=!0),a<0||(e[a]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(a,1))}});var ot={touchstart:1,touchmove:2,touchend:4,touchcancel:8},st="touchstart",at="touchstart touchmove touchend touchcancel";function lt(){this.evTarget=st,this.evWin=at,this.started=!1,V.apply(this,arguments)}function ut(t,e){var n=I(t.touches),r=I(t.changedTouches);return 12&e&&(n=O(n.concat(r),"identifier",!0)),[n,r]}v(lt,V,{handler:function(t){var e=ot[t.type];if(1===e&&(this.started=!0),this.started){var n=ut.call(this,t,e);12&e&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:B,srcEvent:t})}}});var ct={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ht="touchstart touchmove touchend touchcancel";function pt(){this.evTarget=ht,this.targetIds={},V.apply(this,arguments)}function ft(t,e){var n=I(t.touches),r=this.targetIds;if(3&e&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,s=I(t.changedTouches),a=[],l=this.target;if(o=n.filter((function(t){return T(t.target,l)})),1===e)for(i=0;i<o.length;)r[o[i].identifier]=!0,i++;for(i=0;i<s.length;)r[s[i].identifier]&&a.push(s[i]),12&e&&delete r[s[i].identifier],i++;return a.length?[O(o.concat(a),"identifier",!0),a]:void 0}function dt(){V.apply(this,arguments);var t=b(this.handler,this);this.touch=new pt(this.manager,t),this.mouse=new J(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function gt(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,mt.call(this,e)):12&t&&mt.call(this,e)}function mt(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout((function(){var t=r.indexOf(n);t>-1&&r.splice(t,1)}),2500)}}function At(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],o=Math.abs(e-i.x),s=Math.abs(n-i.y);if(o<=25&&s<=25)return!0}return!1}v(pt,V,{handler:function(t){var e=ct[t.type],n=ft.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:B,srcEvent:t})}}),v(dt,V,{handler:function(t,e,n){var r=n.pointerType==B,i=n.pointerType==z;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)gt.call(this,e,n);else if(i&&At.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var yt=R(c.style,"touchAction"),_t=yt!==a,vt="compute",bt="auto",xt="manipulation",wt="none",Et="pan-x",St="pan-y",Tt=function(){if(!_t)return!1;var t={},e=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){t[n]=!e||i.CSS.supports("touch-action",n)})),t}();function Pt(t,e){this.manager=t,this.set(e)}Pt.prototype={set:function(t){t==vt&&(t=this.compute()),_t&&this.manager.element.style&&Tt[t]&&(this.manager.element.style[yt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return m(this.manager.recognizers,(function(e){x(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(P(t,wt))return wt;var e=P(t,Et),n=P(t,St);return e&&n?wt:e||n?e?Et:St:P(t,xt)?xt:bt}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var r=this.actions,i=P(r,wt)&&!Tt.none,o=P(r,St)&&!Tt["pan-y"],s=P(r,Et)&&!Tt["pan-x"];if(i){var a=1===t.pointers.length,l=t.distance<2,u=t.deltaTime<250;if(a&&l&&u)return}if(!s||!o)return i||o&&6&n||s&&24&n?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var Mt=32;function Ct(t){this.options=l({},this.defaults,t||{}),this.id=L++,this.manager=null,this.options.enable=w(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function It(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}function Ot(t){return 16==t?"down":8==t?"up":2==t?"left":4==t?"right":""}function Rt(t,e){var n=e.manager;return n?n.get(t):t}function Lt(){Ct.apply(this,arguments)}function kt(){Lt.apply(this,arguments),this.pX=null,this.pY=null}function Dt(){Lt.apply(this,arguments)}function Nt(){Ct.apply(this,arguments),this._timer=null,this._input=null}function Ft(){Lt.apply(this,arguments)}function Bt(){Lt.apply(this,arguments)}function zt(){Ct.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function jt(t,e){return(e=e||{}).recognizers=w(e.recognizers,jt.defaults.preset),new Ut(t,e)}function Ut(t,e){this.options=l({},jt.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new(this.options.inputClass||(N?it:F?pt:D?dt:J))(this,G),this.touchAction=new Pt(this,this.options.touchAction),Vt(this,!0),m(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function Vt(t,e){var n,r=t.element;r.style&&(m(t.options.cssProps,(function(i,o){n=R(r.style,o),e?(t.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=t.oldCssProps[n]||""})),e||(t.oldCssProps={}))}Ct.prototype={defaults:{},set:function(t){return l(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(g(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=Rt(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return g(t,"dropRecognizeWith",this)||(t=Rt(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(g(t,"requireFailure",this))return this;var e=this.requireFail;return-1===C(e,t=Rt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(g(t,"dropRequireFailure",this))return this;t=Rt(t,this);var e=C(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function r(n){e.manager.emit(n,t)}n<8&&r(e.options.event+It(n)),r(e.options.event),t.additionalEvent&&r(t.additionalEvent),n>=8&&r(e.options.event+It(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=Mt},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},recognize:function(t){var e=l({},t);if(!x(this.options.enable,[this,e]))return this.reset(),void(this.state=Mt);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},v(Lt,Ct,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=6&e,i=this.attrTest(t);return r&&(8&n||!i)?16|e:r||i?4&n?8|e:2&e?4|e:2:Mt}}),v(kt,Lt,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var t=this.options.direction,e=[];return 6&t&&e.push(St),24&t&&e.push(Et),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,i=t.direction,o=t.deltaX,s=t.deltaY;return i&e.direction||(6&e.direction?(i=0===o?1:o<0?2:4,n=o!=this.pX,r=Math.abs(t.deltaX)):(i=0===s?1:s<0?8:16,n=s!=this.pY,r=Math.abs(t.deltaY))),t.direction=i,n&&r>e.threshold&&i&e.direction},attrTest:function(t){return Lt.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Ot(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),v(Dt,Lt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[wt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),v(Nt,Ct,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[bt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime>e.time;if(this._input=t,!r||!n||12&t.eventType&&!i)this.reset();else if(1&t.eventType)this.reset(),this._timer=d((function(){this.state=8,this.tryEmit()}),e.time,this);else if(4&t.eventType)return 8;return Mt},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=f(),this.manager.emit(this.options.event,this._input)))}}),v(Ft,Lt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[wt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),v(Bt,Lt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return kt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return 30&n?e=t.overallVelocity:6&n?e=t.overallVelocityX:24&n&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&p(e)>this.options.velocity&&4&t.eventType},emit:function(t){var e=Ot(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),v(zt,Ct,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[xt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime<e.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(r&&i&&n){if(4!=t.eventType)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,s=!this.pCenter||X(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,s&&o?this.count+=1:this.count=1,this._input=t,0==this.count%e.taps)return this.hasRequireFailures()?(this._timer=d((function(){this.state=8,this.tryEmit()}),e.interval,this),2):8}return Mt},failTimeout:function(){return this._timer=d((function(){this.state=Mt}),this.options.interval,this),Mt},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),jt.VERSION="2.0.7",jt.defaults={domEvents:!1,touchAction:vt,enable:!0,inputTarget:null,inputClass:null,preset:[[Ft,{enable:!1}],[Dt,{enable:!1},["rotate"]],[Bt,{direction:6}],[kt,{direction:6},["swipe"]],[zt],[zt,{event:"doubletap",taps:2},["tap"]],[Nt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Ut.prototype={set:function(t){return l(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var r=this.recognizers,i=e.curRecognizer;(!i||i&&8&i.state)&&(i=e.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],2===e.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(t),!i&&14&n.state&&(i=e.curRecognizer=n),o++}},get:function(t){if(t instanceof Ct)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(g(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(g(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=C(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(t!==a&&e!==a){var n=this.handlers;return m(M(t),(function(t){n[t]=n[t]||[],n[t].push(e)})),this}},off:function(t,e){if(t!==a){var n=this.handlers;return m(M(t),(function(t){e?n[t]&&n[t].splice(C(n[t],e),1):delete n[t]})),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var n=o.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](e),r++}},destroy:function(){this.element&&Vt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},l(jt,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Mt,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Ut,Input:V,TouchAction:Pt,TouchInput:pt,MouseInput:J,PointerEventInput:it,TouchMouseInput:dt,SingleTouchInput:lt,Recognizer:Ct,AttrRecognizer:Lt,Tap:zt,Pan:kt,Swipe:Bt,Pinch:Dt,Rotate:Ft,Press:Nt,on:E,off:S,each:m,merge:_,extend:y,assign:l,inherit:v,bindFn:b,prefixed:R}),(void 0!==i?i:"undefined"!=typeof self?self:{}).Hammer=jt,(r=function(){return jt}.call(e,n,e,t))===a||(t.exports=r)}(window,document)},1405:(t,e,n)=>{"use strict";var r="undefined"!=typeof Symbol&&Symbol,i=n(5419);t.exports=function(){return"function"==typeof r&&"function"==typeof Symbol&&"symbol"==typeof r("foo")&&"symbol"==typeof Symbol("bar")&&i()}},5419:t=>{"use strict";t.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var t={},e=Symbol("test"),n=Object(e);if("string"==typeof e)return!1;if("[object Symbol]"!==Object.prototype.toString.call(e))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(e in t[e]=42,t)return!1;if("function"==typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var r=Object.getOwnPropertySymbols(t);if(1!==r.length||r[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var i=Object.getOwnPropertyDescriptor(t,e);if(42!==i.value||!0!==i.enumerable)return!1}return!0}},6410:(t,e,n)=>{"use strict";var r=n(5419);t.exports=function(){return r()&&!!Symbol.toStringTag}},7642:(t,e,n)=>{"use strict";var r=n(8612);t.exports=r.call(Function.call,Object.prototype.hasOwnProperty)},8679:(t,e,n)=>{"use strict";var r=n(9864),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};function l(t){return r.isMemo(t)?s:a[t.$$typeof]||i}a[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a[r.Memo]=s;var u=Object.defineProperty,c=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,p=Object.getOwnPropertyDescriptor,f=Object.getPrototypeOf,d=Object.prototype;t.exports=function t(e,n,r){if("string"!=typeof n){if(d){var i=f(n);i&&i!==d&&t(e,i,r)}var s=c(n);h&&(s=s.concat(h(n)));for(var a=l(e),g=l(n),m=0;m<s.length;++m){var A=s[m];if(!(o[A]||r&&r[A]||g&&g[A]||a&&a[A])){var y=p(n,A);try{u(e,A,y)}catch(t){}}}}return e}},645:(t,e)=>{e.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,l=(1<<a)-1,u=l>>1,c=-7,h=n?i-1:0,p=n?-1:1,f=t[e+h];for(h+=p,o=f&(1<<-c)-1,f>>=-c,c+=a;c>0;o=256*o+t[e+h],h+=p,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=r;c>0;s=256*s+t[e+h],h+=p,c-=8);if(0===o)o=1-u;else{if(o===l)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,r),o-=u}return(f?-1:1)*s*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var s,a,l,u=8*o-i-1,c=(1<<u)-1,h=c>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,d=r?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),(e+=s+h>=1?p/l:p*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=c?(a=0,s=c):s+h>=1?(a=(e*l-1)*Math.pow(2,i),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;t[n+f]=255&a,f+=d,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;t[n+f]=255&s,f+=d,s/=256,u-=8);t[n+f-d]|=128*g}},2584:(t,e,n)=>{"use strict";var r=n(6410)(),i=n(1924)("Object.prototype.toString"),o=function(t){return!(r&&t&&"object"==typeof t&&Symbol.toStringTag in t)&&"[object Arguments]"===i(t)},s=function(t){return!!o(t)||null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Array]"!==i(t)&&"[object Function]"===i(t.callee)},a=function(){return o(arguments)}();o.isLegacyArguments=s,t.exports=a?o:s},8923:(t,e,n)=>{"use strict";var r=Date.prototype.getDay,i=Object.prototype.toString,o=n(6410)();t.exports=function(t){return"object"==typeof t&&null!==t&&(o?function(t){try{return r.call(t),!0}catch(t){return!1}}(t):"[object Date]"===i.call(t))}},8420:(t,e,n)=>{"use strict";var r,i,o,s,a=n(1924),l=n(6410)();if(l){r=a("Object.prototype.hasOwnProperty"),i=a("RegExp.prototype.exec"),o={};var u=function(){throw o};s={toString:u,valueOf:u},"symbol"==typeof Symbol.toPrimitive&&(s[Symbol.toPrimitive]=u)}var c=a("Object.prototype.toString"),h=Object.getOwnPropertyDescriptor;t.exports=l?function(t){if(!t||"object"!=typeof t)return!1;var e=h(t,"lastIndex");if(!e||!r(e,"value"))return!1;try{i(t,s)}catch(t){return t===o}}:function(t){return!(!t||"object"!=typeof t&&"function"!=typeof t)&&"[object RegExp]"===c(t)}},3096:(t,e,n)=>{var r="Expected a function",i=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,a=/^0o[0-7]+$/i,l=parseInt,u="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,c="object"==typeof self&&self&&self.Object===Object&&self,h=u||c||Function("return this")(),p=Object.prototype.toString,f=Math.max,d=Math.min,g=function(){return h.Date.now()};function m(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function A(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==p.call(t)}(t))return NaN;if(m(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=m(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(i,"");var n=s.test(t);return n||a.test(t)?l(t.slice(2),n?2:8):o.test(t)?NaN:+t}t.exports=function(t,e,n){var i=!0,o=!0;if("function"!=typeof t)throw new TypeError(r);return m(n)&&(i="leading"in n?!!n.leading:i,o="trailing"in n?!!n.trailing:o),function(t,e,n){var i,o,s,a,l,u,c=0,h=!1,p=!1,y=!0;if("function"!=typeof t)throw new TypeError(r);function _(e){var n=i,r=o;return i=o=void 0,c=e,a=t.apply(r,n)}function v(t){return c=t,l=setTimeout(x,e),h?_(t):a}function b(t){var n=t-u;return void 0===u||n>=e||n<0||p&&t-c>=s}function x(){var t=g();if(b(t))return w(t);l=setTimeout(x,function(t){var n=e-(t-u);return p?d(n,s-(t-c)):n}(t))}function w(t){return l=void 0,y&&i?_(t):(i=o=void 0,a)}function E(){var t=g(),n=b(t);if(i=arguments,o=this,u=t,n){if(void 0===l)return v(u);if(p)return l=setTimeout(x,e),_(u)}return void 0===l&&(l=setTimeout(x,e)),a}return e=A(e)||0,m(n)&&(h=!!n.leading,s=(p="maxWait"in n)?f(A(n.maxWait)||0,e):s,y="trailing"in n?!!n.trailing:y),E.cancel=function(){void 0!==l&&clearTimeout(l),c=0,i=u=o=l=void 0},E.flush=function(){return void 0===l?a:w(g())},E}(t,e,{leading:i,maxWait:e,trailing:o})}},514:function(t,e){var n,r;void 0===(r="function"==typeof(n=function(){"use strict";function t(t,e,n){this.low=0|t,this.high=0|e,this.unsigned=!!n}function e(t){return!0===(t&&t.__isLong__)}t.prototype.__isLong__,Object.defineProperty(t.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),t.isLong=e;var n={},r={};function i(t,e){var i,o,a;return e?(a=0<=(t>>>=0)&&t<256)&&(o=r[t])?o:(i=s(t,(0|t)<0?-1:0,!0),a&&(r[t]=i),i):(a=-128<=(t|=0)&&t<128)&&(o=n[t])?o:(i=s(t,t<0?-1:0,!1),a&&(n[t]=i),i)}function o(t,e){if(isNaN(t)||!isFinite(t))return e?g:d;if(e){if(t<0)return g;if(t>=h)return v}else{if(t<=-p)return b;if(t+1>=p)return _}return t<0?o(-t,e).neg():s(t%c|0,t/c|0,e)}function s(e,n,r){return new t(e,n,r)}t.fromInt=i,t.fromNumber=o,t.fromBits=s;var a=Math.pow;function l(t,e,n){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return d;if("number"==typeof e?(n=e,e=!1):e=!!e,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return l(t.substring(1),e,n).neg();for(var i=o(a(n,8)),s=d,u=0;u<t.length;u+=8){var c=Math.min(8,t.length-u),h=parseInt(t.substring(u,u+c),n);if(c<8){var p=o(a(n,c));s=s.mul(p).add(o(h))}else s=(s=s.mul(i)).add(o(h))}return s.unsigned=e,s}function u(e){return e instanceof t?e:"number"==typeof e?o(e):"string"==typeof e?l(e):s(e.low,e.high,e.unsigned)}t.fromString=l,t.fromValue=u;var c=4294967296,h=c*c,p=h/2,f=i(1<<24),d=i(0);t.ZERO=d;var g=i(0,!0);t.UZERO=g;var m=i(1);t.ONE=m;var A=i(1,!0);t.UONE=A;var y=i(-1);t.NEG_ONE=y;var _=s(-1,2147483647,!1);t.MAX_VALUE=_;var v=s(-1,-1,!0);t.MAX_UNSIGNED_VALUE=v;var b=s(0,-2147483648,!1);t.MIN_VALUE=b;var x=t.prototype;return x.toInt=function(){return this.unsigned?this.low>>>0:this.low},x.toNumber=function(){return this.unsigned?(this.high>>>0)*c+(this.low>>>0):this.high*c+(this.low>>>0)},x.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(b)){var e=o(t),n=this.div(e),r=n.mul(e).sub(this);return n.toString(t)+r.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var i=o(a(t,6),this.unsigned),s=this,l="";;){var u=s.div(i),c=(s.sub(u.mul(i)).toInt()>>>0).toString(t);if((s=u).isZero())return c+l;for(;c.length<6;)c="0"+c;l=""+c+l}},x.getHighBits=function(){return this.high},x.getHighBitsUnsigned=function(){return this.high>>>0},x.getLowBits=function(){return this.low},x.getLowBitsUnsigned=function(){return this.low>>>0},x.getNumBitsAbs=function(){if(this.isNegative())return this.eq(b)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&0==(t&1<<e);e--);return 0!=this.high?e+33:e+1},x.isZero=function(){return 0===this.high&&0===this.low},x.isNegative=function(){return!this.unsigned&&this.high<0},x.isPositive=function(){return this.unsigned||this.high>=0},x.isOdd=function(){return 1==(1&this.low)},x.isEven=function(){return 0==(1&this.low)},x.equals=function(t){return e(t)||(t=u(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&this.high===t.high&&this.low===t.low},x.eq=x.equals,x.notEquals=function(t){return!this.eq(t)},x.neq=x.notEquals,x.lessThan=function(t){return this.comp(t)<0},x.lt=x.lessThan,x.lessThanOrEqual=function(t){return this.comp(t)<=0},x.lte=x.lessThanOrEqual,x.greaterThan=function(t){return this.comp(t)>0},x.gt=x.greaterThan,x.greaterThanOrEqual=function(t){return this.comp(t)>=0},x.gte=x.greaterThanOrEqual,x.compare=function(t){if(e(t)||(t=u(t)),this.eq(t))return 0;var n=this.isNegative(),r=t.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},x.comp=x.compare,x.negate=function(){return!this.unsigned&&this.eq(b)?b:this.not().add(m)},x.neg=x.negate,x.add=function(t){e(t)||(t=u(t));var n=this.high>>>16,r=65535&this.high,i=this.low>>>16,o=65535&this.low,a=t.high>>>16,l=65535&t.high,c=t.low>>>16,h=0,p=0,f=0,d=0;return f+=(d+=o+(65535&t.low))>>>16,p+=(f+=i+c)>>>16,h+=(p+=r+l)>>>16,h+=n+a,s((f&=65535)<<16|(d&=65535),(h&=65535)<<16|(p&=65535),this.unsigned)},x.subtract=function(t){return e(t)||(t=u(t)),this.add(t.neg())},x.sub=x.subtract,x.multiply=function(t){if(this.isZero())return d;if(e(t)||(t=u(t)),t.isZero())return d;if(this.eq(b))return t.isOdd()?b:d;if(t.eq(b))return this.isOdd()?b:d;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(f)&&t.lt(f))return o(this.toNumber()*t.toNumber(),this.unsigned);var n=this.high>>>16,r=65535&this.high,i=this.low>>>16,a=65535&this.low,l=t.high>>>16,c=65535&t.high,h=t.low>>>16,p=65535&t.low,g=0,m=0,A=0,y=0;return A+=(y+=a*p)>>>16,m+=(A+=i*p)>>>16,A&=65535,m+=(A+=a*h)>>>16,g+=(m+=r*p)>>>16,m&=65535,g+=(m+=i*h)>>>16,m&=65535,g+=(m+=a*c)>>>16,g+=n*p+r*h+i*c+a*l,s((A&=65535)<<16|(y&=65535),(g&=65535)<<16|(m&=65535),this.unsigned)},x.mul=x.multiply,x.divide=function(t){if(e(t)||(t=u(t)),t.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?g:d;var n,r,i;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return g;if(t.gt(this.shru(1)))return A;i=g}else{if(this.eq(b))return t.eq(m)||t.eq(y)?b:t.eq(b)?m:(n=this.shr(1).div(t).shl(1)).eq(d)?t.isNegative()?m:y:(r=this.sub(t.mul(n)),i=n.add(r.div(t)));if(t.eq(b))return this.unsigned?g:d;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();i=d}for(r=this;r.gte(t);){n=Math.max(1,Math.floor(r.toNumber()/t.toNumber()));for(var s=Math.ceil(Math.log(n)/Math.LN2),l=s<=48?1:a(2,s-48),c=o(n),h=c.mul(t);h.isNegative()||h.gt(r);)h=(c=o(n-=l,this.unsigned)).mul(t);c.isZero()&&(c=m),i=i.add(c),r=r.sub(h)}return i},x.div=x.divide,x.modulo=function(t){return e(t)||(t=u(t)),this.sub(this.div(t).mul(t))},x.mod=x.modulo,x.not=function(){return s(~this.low,~this.high,this.unsigned)},x.and=function(t){return e(t)||(t=u(t)),s(this.low&t.low,this.high&t.high,this.unsigned)},x.or=function(t){return e(t)||(t=u(t)),s(this.low|t.low,this.high|t.high,this.unsigned)},x.xor=function(t){return e(t)||(t=u(t)),s(this.low^t.low,this.high^t.high,this.unsigned)},x.shiftLeft=function(t){return e(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?s(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):s(0,this.low<<t-32,this.unsigned)},x.shl=x.shiftLeft,x.shiftRight=function(t){return e(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?s(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):s(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},x.shr=x.shiftRight,x.shiftRightUnsigned=function(t){if(e(t)&&(t=t.toInt()),0==(t&=63))return this;var n=this.high;return t<32?s(this.low>>>t|n<<32-t,n>>>t,this.unsigned):s(32===t?n:n>>>t-32,0,this.unsigned)},x.shru=x.shiftRightUnsigned,x.toSigned=function(){return this.unsigned?s(this.low,this.high,!1):this},x.toUnsigned=function(){return this.unsigned?this:s(this.low,this.high,!0)},x.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},x.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24&255,255&t,t>>>8&255,t>>>16&255,t>>>24&255]},x.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24&255,t>>>16&255,t>>>8&255,255&t,e>>>24&255,e>>>16&255,e>>>8&255,255&e]},t})?n.apply(e,[]):n)||(t.exports=r)},6158:function(t){t.exports=function(){"use strict";var t,e,n;function r(r,i){if(t)if(e){var o="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/api/#transpiling-v2'); }; var sharedChunk = {}; ("+t+")(sharedChunk); ("+e+")(sharedChunk); self.onerror = null;",s={};t(s),n=i(s),"undefined"!=typeof window&&(n.workerUrl=window.URL.createObjectURL(new Blob([o],{type:"text/javascript"})))}else e=i;else t=i}return r(0,(function(t){var e="2.5.1",n=r;function r(t,e,n,r){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(r-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=r,this.p2x=n,this.p2y=r}r.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},r.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},r.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},r.prototype.solveCurveX=function(t,e){var n,r,i,o,s;for(void 0===e&&(e=1e-6),i=t,s=0;s<8;s++){if(o=this.sampleCurveX(i)-t,Math.abs(o)<e)return i;var a=this.sampleCurveDerivativeX(i);if(Math.abs(a)<1e-6)break;i-=o/a}if((i=t)<(n=0))return n;if(i>(r=1))return r;for(;n<r;){if(o=this.sampleCurveX(i),Math.abs(o-t)<e)return i;t>o?n=i:r=i,i=.5*(r-n)+n}return i},r.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var i=o;function o(t,e){this.x=t,this.y=e}o.prototype={clone:function(){return new o(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=r,this},_rotateAround:function(t,e){var n=Math.cos(t),r=Math.sin(t),i=e.y+r*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-r*(this.y-e.y),this.y=i,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},o.convert=function(t){return t instanceof o?t:Array.isArray(t)?new o(t[0],t[1]):t};var s="undefined"!=typeof self?self:{};const a=Math.pow(2,53)-1,l=Math.PI/180,u=180/Math.PI;function c(t){return t*l}const h=[[0,0],[1,0],[1,1],[0,1]];function p(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}function f(t,e,r,i){const o=new n(t,e,r,i);return function(t){return o.solve(t)}}const d=f(.25,.1,.25,1);function g(t,e,n){return Math.min(n,Math.max(e,t))}function m(t,e,n){const r=n-e,i=((t-e)%r+r)%r+e;return i===e?n:i}function A(t,e,n){if(!t.length)return n(null,[]);let r=t.length;const i=new Array(t.length);let o=null;t.forEach(((t,s)=>{e(t,((t,e)=>{t&&(o=t),i[s]=e,0==--r&&n(o,i)}))}))}function y(t){const e=[];for(const n in t)e.push(t[n]);return e}function _(t,...e){for(const n of e)for(const e in n)t[e]=n[e];return t}let v=1;function b(){return v++}function x(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function w(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function E(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function S(t,e){t.forEach((t=>{e[t]&&(e[t]=e[t].bind(e))}))}function T(t,e){return-1!==t.indexOf(e,t.length-e.length)}function P(t,e,n){const r={};for(const i in t)r[i]=e.call(n||this,t[i],i,t);return r}function M(t,e,n){const r={};for(const i in t)e.call(n||this,t[i],i,t)&&(r[i]=t[i]);return r}function C(t){return Array.isArray(t)?t.map(C):"object"==typeof t&&t?P(t,C):t}const I={};function O(t){I[t]||("undefined"!=typeof console&&console.warn(t),I[t]=!0)}function R(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function L(t){let e=0;for(let n,r,i=0,o=t.length,s=o-1;i<o;s=i++)n=t[i],r=t[s],e+=(r.x-n.x)*(n.y+r.y);return e}function k(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function D(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((t,n,r,i)=>{const o=r||i;return e[n]=!o||o.toLowerCase(),""})),e["max-age"]){const t=parseInt(e["max-age"],10);isNaN(t)?delete e["max-age"]:e["max-age"]=t}return e}let N,F,B,z=null;function j(t){if(null==z){const e=t.navigator?t.navigator.userAgent:null;z=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return z}function U(t){try{const e=s[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch(t){return!1}}const V={now:()=>void 0!==B?B:s.performance.now(),setNow(t){B=t},restoreNow(){B=void 0},frame(t){const e=s.requestAnimationFrame(t);return{cancel:()=>s.cancelAnimationFrame(e)}},getImageData(t,e=0){const n=s.document.createElement("canvas"),r=n.getContext("2d");if(!r)throw new Error("failed to create canvas 2d context");return n.width=t.width,n.height=t.height,r.drawImage(t,0,0,t.width,t.height),r.getImageData(-e,-e,t.width+2*e,t.height+2*e)},resolveURL:t=>(N||(N=s.document.createElement("a")),N.href=t,N.href),get devicePixelRatio(){return s.devicePixelRatio},get prefersReducedMotion(){return!!s.matchMedia&&(null==F&&(F=s.matchMedia("(prefers-reduced-motion: reduce)")),F.matches)}};let G;const Z={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==G){const t=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{G=null!="MISSING_ENV_VAR".API_URL_REGEX?new RegExp("MISSING_ENV_VAR".API_URL_REGEX):t}catch(e){G=t}}return G},get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},q={supported:!1,testSupport:function(t){!X&&H&&($?Y(t):W=t)}};let W,H,X=!1,$=!1;function Y(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,H),t.isContextLost())return;q.supported=!0}catch(t){}t.deleteTexture(e),X=!0}s.document&&(H=s.document.createElement("img"),H.onload=function(){W&&Y(W),W=null,$=!0},H.onerror=function(){X=!0,W=null},H.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Q="01",K="NO_ACCESS_TOKEN";function J(t){return 0===t.indexOf("mapbox:")}function tt(t){return Z.API_URL_REGEX.test(t)}const et=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function nt(t){const e=t.match(et);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function rt(t){const e=t.params.length?`?${t.params.join("&")}`:"";return`${t.protocol}://${t.authority}${t.path}${e}`}function it(t){if(!t)return null;const e=t.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(s.atob(e[1]).split("").map((t=>"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2))).join("")))}catch(t){return null}}class ot{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const e=it(Z.ACCESS_TOKEN);let n="";return n=e&&e.u?s.btoa(encodeURIComponent(e.u).replace(/%([0-9A-F]{2})/g,((t,e)=>String.fromCharCode(Number("0x"+e))))):Z.ACCESS_TOKEN||"",t?`mapbox.eventData.${t}:${n}`:`mapbox.eventData:${n}`}fetchEventData(){const t=U("localStorage"),e=this.getStorageKey(),n=this.getStorageKey("uuid");if(t)try{const t=s.localStorage.getItem(e);t&&(this.eventData=JSON.parse(t));const r=s.localStorage.getItem(n);r&&(this.anonId=r)}catch(t){O("Unable to read from LocalStorage")}}saveEventData(){const t=U("localStorage"),e=this.getStorageKey(),n=this.getStorageKey("uuid");if(t)try{s.localStorage.setItem(n,this.anonId),Object.keys(this.eventData).length>=1&&s.localStorage.setItem(e,JSON.stringify(this.eventData))}catch(t){O("Unable to write to LocalStorage")}}processRequests(t){}postEvent(t,n,r,i){if(!Z.EVENTS_URL)return;const o=nt(Z.EVENTS_URL);o.params.push(`access_token=${i||Z.ACCESS_TOKEN||""}`);const s={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:e,skuId:Q,userId:this.anonId},a=n?_(s,n):s,l={url:rt(o),headers:{"Content-Type":"text/plain"},body:JSON.stringify([a])};this.pendingRequest=Tt(l,(t=>{this.pendingRequest=null,r(t),this.saveEventData(),this.processRequests(i)}))}queueRequest(t,e){this.queue.push(t),this.processRequests(e)}}const st=new class extends ot{constructor(t){super("appUserTurnstile"),this._customAccessToken=t}postTurnstileEvent(t,e){Z.EVENTS_URL&&Z.ACCESS_TOKEN&&Array.isArray(t)&&t.some((t=>J(t)||tt(t)))&&this.queueRequest(Date.now(),e)}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=it(Z.ACCESS_TOKEN),n=e?e.u:Z.ACCESS_TOKEN;let r=n!==this.eventData.tokenU;E(this.anonId)||(this.anonId=x(),r=!0);const i=this.queue.shift();if(this.eventData.lastSuccess){const t=new Date(this.eventData.lastSuccess),e=new Date(i),n=(i-this.eventData.lastSuccess)/864e5;r=r||n>=1||n<-1||t.getDate()!==e.getDate()}else r=!0;if(!r)return this.processRequests();this.postEvent(i,{"enabled.telemetry":!1},(t=>{t||(this.eventData.lastSuccess=i,this.eventData.tokenU=n)}),t)}},at=st.postTurnstileEvent.bind(st),lt=new class extends ot{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(t,e,n,r){this.skuToken=e,this.errorCb=r,Z.EVENTS_URL&&(n||Z.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(K)))}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),E(this.anonId)||(this.anonId=x()),this.postEvent(n,{skuToken:this.skuToken},(t=>{t?this.errorCb(t):e&&(this.success[e]=!0)}),t))}},ut=lt.postMapLoadEvent.bind(lt),ct=new class extends ot{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(t,e,n,r){if(!Z.API_URL||!Z.SESSION_PATH)return;const i=nt(Z.API_URL+Z.SESSION_PATH);i.params.push(`sku=${e||""}`),i.params.push(`access_token=${r||Z.ACCESS_TOKEN||""}`);const o={url:rt(i),headers:{"Content-Type":"text/plain"}};this.pendingRequest=Pt(o,(t=>{this.pendingRequest=null,n(t),this.saveEventData(),this.processRequests(r)}))}getSessionAPI(t,e,n,r){this.skuToken=e,this.errorCb=r,Z.SESSION_PATH&&Z.API_URL&&(n||Z.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(K)))}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||this.getSession(n,this.skuToken,(t=>{t?this.errorCb(t):e&&(this.success[e]=!0)}),t)}},ht=ct.getSessionAPI.bind(ct),pt=new Set,ft="mapbox-tiles";let dt,gt,mt=500,At=50;function yt(){s.caches&&!dt&&(dt=s.caches.open(ft))}function _t(t){const e=t.indexOf("?");return e<0?t:t.slice(0,e)}let vt=1/0;const bt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(bt);class xt extends Error{constructor(t,e,n){401===e&&tt(n)&&(t+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(t),this.status=e,this.url=n}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const wt=k()?()=>self.worker&&self.worker.referrer:()=>("blob:"===s.location.protocol?s.parent:s).location.href,Et=function(t,e){if(!(/^file:/.test(n=t.url)||/^file:/.test(wt())&&!/^\w+:/.test(n))){if(s.fetch&&s.Request&&s.AbortController&&s.Request.prototype.hasOwnProperty("signal"))return function(t,e){const n=new s.AbortController,r=new s.Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,referrer:wt(),signal:n.signal});let i=!1,o=!1;const a=(l=r.url).indexOf("sku=")>0&&tt(l);var l;"json"===t.type&&r.headers.set("Accept","application/json");const u=(n,i,l)=>{if(o)return;if(n&&"SecurityError"!==n.message&&O(n),i&&l)return c(i);const u=Date.now();s.fetch(r).then((n=>{if(n.ok){const t=a?n.clone():null;return c(n,t,u)}return e(new xt(n.statusText,n.status,t.url))})).catch((t=>{20!==t.code&&e(new Error(t.message))}))},c=(n,a,l)=>{("arrayBuffer"===t.type?n.arrayBuffer():"json"===t.type?n.json():n.text()).then((t=>{o||(a&&l&&function(t,e,n){if(yt(),!dt)return;const r={status:e.status,statusText:e.statusText,headers:new s.Headers};e.headers.forEach(((t,e)=>r.headers.set(e,t)));const i=D(e.headers.get("Cache-Control")||"");i["no-store"]||(i["max-age"]&&r.headers.set("Expires",new Date(n+1e3*i["max-age"]).toUTCString()),new Date(r.headers.get("Expires")).getTime()-n<42e4||function(t,e){if(void 0===gt)try{new Response(new ReadableStream),gt=!0}catch(t){gt=!1}gt?e(t.body):t.blob().then(e)}(e,(e=>{const n=new s.Response(e,r);yt(),dt&&dt.then((e=>e.put(_t(t.url),n))).catch((t=>O(t.message)))})))}(r,a,l),i=!0,e(null,t,n.headers.get("Cache-Control"),n.headers.get("Expires")))})).catch((t=>{o||e(new Error(t.message))}))};return a?function(t,e){if(yt(),!dt)return e(null);const n=_t(t.url);dt.then((t=>{t.match(n).then((r=>{const i=function(t){if(!t)return!1;const e=new Date(t.headers.get("Expires")||0),n=D(t.headers.get("Cache-Control")||"");return e>Date.now()&&!n["no-cache"]}(r);t.delete(n),i&&t.put(n,r.clone()),e(null,r,i)})).catch(e)})).catch(e)}(r,u):u(null,null),{cancel:()=>{o=!0,i||n.abort()}}}(t,e);if(k()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var n;return function(t,e){const n=new s.XMLHttpRequest;n.open(t.method||"GET",t.url,!0),"arrayBuffer"===t.type&&(n.responseType="arraybuffer");for(const e in t.headers)n.setRequestHeader(e,t.headers[e]);return"json"===t.type&&(n.responseType="text",n.setRequestHeader("Accept","application/json")),n.withCredentials="include"===t.credentials,n.onerror=()=>{e(new Error(n.statusText))},n.onload=()=>{if((n.status>=200&&n.status<300||0===n.status)&&null!==n.response){let r=n.response;if("json"===t.type)try{r=JSON.parse(n.response)}catch(t){return e(t)}e(null,r,n.getResponseHeader("Cache-Control"),n.getResponseHeader("Expires"))}else e(new xt(n.statusText,n.status,t.url))},n.send(t.body),{cancel:()=>n.abort()}}(t,e)},St=function(t,e){return Et(_(t,{type:"arrayBuffer"}),e)},Tt=function(t,e){return Et(_(t,{method:"POST"}),e)},Pt=function(t,e){return Et(_(t,{method:"GET"}),e)};function Mt(t){const e=s.document.createElement("a");return e.href=t,e.protocol===s.document.location.protocol&&e.host===s.document.location.host}const Ct="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let It,Ot;It=[],Ot=0;const Rt=function(t,e){if(q.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),Ot>=Z.MAX_PARALLEL_IMAGE_REQUESTS){const n={requestParameters:t,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return It.push(n),n}Ot++;let n=!1;const r=()=>{if(!n)for(n=!0,Ot--;It.length&&Ot<Z.MAX_PARALLEL_IMAGE_REQUESTS;){const t=It.shift(),{requestParameters:e,callback:n,cancelled:r}=t;r||(t.cancel=Rt(e,n).cancel)}},i=St(t,((t,n,i,o)=>{r(),t?e(t):n&&(s.createImageBitmap?function(t,e){const n=new s.Blob([new Uint8Array(t)],{type:"image/png"});s.createImageBitmap(n).then((t=>{e(null,t)})).catch((t=>{e(new Error(`Could not load image because of ${t.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))}))}(n,((t,n)=>e(t,n,i,o))):function(t,e){const n=new s.Image,r=s.URL;n.onload=()=>{e(null,n),r.revokeObjectURL(n.src),n.onload=null,s.requestAnimationFrame((()=>{n.src=Ct}))},n.onerror=()=>e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const i=new s.Blob([new Uint8Array(t)],{type:"image/png"});n.src=t.byteLength?r.createObjectURL(i):Ct}(n,((t,n)=>e(t,n,i,o))))}));return{cancel:()=>{i.cancel(),r()}}};function Lt(t,e,n){n[t]&&-1!==n[t].indexOf(e)||(n[t]=n[t]||[],n[t].push(e))}function kt(t,e,n){if(n&&n[t]){const r=n[t].indexOf(e);-1!==r&&n[t].splice(r,1)}}class Dt{constructor(t,e={}){_(this,e),this.type=t}}class Nt extends Dt{constructor(t,e={}){super("error",_({error:t},e))}}class Ft{on(t,e){return this._listeners=this._listeners||{},Lt(t,e,this._listeners),this}off(t,e){return kt(t,e,this._listeners),kt(t,e,this._oneTimeListeners),this}once(t,e){return e?(this._oneTimeListeners=this._oneTimeListeners||{},Lt(t,e,this._oneTimeListeners),this):new Promise((e=>this.once(t,e)))}fire(t,e){"string"==typeof t&&(t=new Dt(t,e||{}));const n=t.type;if(this.listens(n)){t.target=this;const e=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];for(const n of e)n.call(this,t);const r=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];for(const e of r)kt(n,e,this._oneTimeListeners),e.call(this,t);const i=this._eventedParent;i&&(_(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),i.fire(t))}else t instanceof Nt&&console.error(t.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,e){return this._eventedParent=t,this._eventedParentData=e,this}}var Bt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},fog:{type:"fog"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{},sky:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_sky:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},fog:{range:{type:"array",default:[.5,10],minimum:-20,maximum:20,length:2,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:.1,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number","property-type":"data-constant",default:1,minimum:0,maximum:1e3,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_sky:{"sky-type":{type:"enum",values:{gradient:{},atmosphere:{}},default:"atmosphere",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{type:"array",value:"number",length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,requires:[{"sky-type":"atmosphere"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{type:"number",requires:[{"sky-type":"atmosphere"}],default:10,minimum:0,maximum:100,transition:!1,"property-type":"data-constant"},"sky-gradient-center":{type:"array",requires:[{"sky-type":"gradient"}],value:"number",default:[0,0],length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{type:"number",requires:[{"sky-type":"gradient"}],default:90,minimum:0,maximum:180,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient":{type:"color",default:["interpolate",["linear"],["sky-radial-progress"],.8,"#87ceeb",1,"white"],transition:!1,requires:[{"sky-type":"gradient"}],expression:{interpolated:!0,parameters:["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class zt{constructor(t,e,n,r){this.message=(t?`${t}: `:"")+n,r&&(this.identifier=r),null!=e&&e.__line__&&(this.line=e.__line__)}}function jt(t){const e=t.value;return e?[new zt(t.key,e,"constants have been deprecated as of v8")]:[]}function Ut(t,...e){for(const n of e)for(const e in n)t[e]=n[e];return t}function Vt(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Gt(t){if(Array.isArray(t))return t.map(Gt);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const n in t)e[n]=Gt(t[n]);return e}return Vt(t)}class Zt extends Error{constructor(t,e){super(e),this.message=e,this.key=t}}class qt{constructor(t,e=[]){this.parent=t,this.bindings={};for(const[t,n]of e)this.bindings[t]=n}concat(t){return new qt(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Wt={kind:"null"},Ht={kind:"number"},Xt={kind:"string"},$t={kind:"boolean"},Yt={kind:"color"},Qt={kind:"object"},Kt={kind:"value"},Jt={kind:"collator"},te={kind:"formatted"},ee={kind:"resolvedImage"};function ne(t,e){return{kind:"array",itemType:t,N:e}}function re(t){if("array"===t.kind){const e=re(t.itemType);return"number"==typeof t.N?`array<${e}, ${t.N}>`:"value"===t.itemType.kind?"array":`array<${e}>`}return t.kind}const ie=[Wt,Ht,Xt,$t,Yt,te,Qt,ne(Kt),ee];function oe(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!oe(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(const t of ie)if(!oe(t,e))return null}return`Expected ${re(t)} but found ${re(e)} instead.`}function se(t,e){return e.some((e=>e.kind===t.kind))}function ae(t,e){return e.some((e=>"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"==typeof t:e===typeof t))}function le(t){var e={exports:{}};return t(e,e.exports),e.exports}var ue=le((function(t,e){var n={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function r(t){return(t=Math.round(t))<0?0:t>255?255:t}function i(t){return r("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function o(t){return(e="%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e}function s(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}try{e.parseCSSColor=function(t){var e,a=t.replace(/ /g,"").toLowerCase();if(a in n)return n[a].slice();if("#"===a[0])return 4===a.length?(e=parseInt(a.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===a.length&&(e=parseInt(a.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var l=a.indexOf("("),u=a.indexOf(")");if(-1!==l&&u+1===a.length){var c=a.substr(0,l),h=a.substr(l+1,u-(l+1)).split(","),p=1;switch(c){case"rgba":if(4!==h.length)return null;p=o(h.pop());case"rgb":return 3!==h.length?null:[i(h[0]),i(h[1]),i(h[2]),p];case"hsla":if(4!==h.length)return null;p=o(h.pop());case"hsl":if(3!==h.length)return null;var f=(parseFloat(h[0])%360+360)%360/360,d=o(h[1]),g=o(h[2]),m=g<=.5?g*(d+1):g+d-g*d,A=2*g-m;return[r(255*s(A,m,f+1/3)),r(255*s(A,m,f)),r(255*s(A,m,f-1/3)),p];default:return null}}return null}}catch(t){}}));class ce{constructor(t,e,n,r=1){this.r=t,this.g=e,this.b=n,this.a=r}static parse(t){if(!t)return;if(t instanceof ce)return t;if("string"!=typeof t)return;const e=ue.parseCSSColor(t);return e?new ce(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3]):void 0}toString(){const[t,e,n,r]=this.toArray();return`rgba(${Math.round(t)},${Math.round(e)},${Math.round(n)},${r})`}toArray(){const{r:t,g:e,b:n,a:r}=this;return 0===r?[0,0,0,0]:[255*t/r,255*e/r,255*n/r,r]}}ce.black=new ce(0,0,0,1),ce.white=new ce(1,1,1,1),ce.transparent=new ce(0,0,0,0),ce.red=new ce(1,0,0,1),ce.blue=new ce(0,0,1,1);class he{constructor(t,e,n){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,e){return this.collator.compare(t,e)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class pe{constructor(t,e,n,r,i){this.text=t,this.image=e,this.scale=n,this.fontStack=r,this.textColor=i}}class fe{constructor(t){this.sections=t}static fromString(t){return new fe([new pe(t,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some((t=>0!==t.text.length||t.image&&0!==t.image.name.length))}static factory(t){return t instanceof fe?t:fe.fromString(t)}toString(){return 0===this.sections.length?"":this.sections.map((t=>t.text)).join("")}serialize(){const t=["format"];for(const e of this.sections){if(e.image){t.push(["image",e.image.name]);continue}t.push(e.text);const n={};e.fontStack&&(n["text-font"]=["literal",e.fontStack.split(",")]),e.scale&&(n["font-scale"]=e.scale),e.textColor&&(n["text-color"]=["rgba"].concat(e.textColor.toArray())),t.push(n)}return t}}class de{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new de({name:t,available:!1}):null}serialize(){return["image",this.name]}}function ge(t,e,n,r){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===r||"number"==typeof r&&r>=0&&r<=1?null:`Invalid rgba value [${[t,e,n,r].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof r?[t,e,n,r]:[t,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function me(t){if(null===t)return!0;if("string"==typeof t)return!0;if("boolean"==typeof t)return!0;if("number"==typeof t)return!0;if(t instanceof ce)return!0;if(t instanceof he)return!0;if(t instanceof fe)return!0;if(t instanceof de)return!0;if(Array.isArray(t)){for(const e of t)if(!me(e))return!1;return!0}if("object"==typeof t){for(const e in t)if(!me(t[e]))return!1;return!0}return!1}function Ae(t){if(null===t)return Wt;if("string"==typeof t)return Xt;if("boolean"==typeof t)return $t;if("number"==typeof t)return Ht;if(t instanceof ce)return Yt;if(t instanceof he)return Jt;if(t instanceof fe)return te;if(t instanceof de)return ee;if(Array.isArray(t)){const e=t.length;let n;for(const e of t){const t=Ae(e);if(n){if(n===t)continue;n=Kt;break}n=t}return ne(n||Kt,e)}return Qt}function ye(t){const e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof ce||t instanceof fe||t instanceof de?t.toString():JSON.stringify(t)}class _e{constructor(t,e){this.type=t,this.value=e}static parse(t,e){if(2!==t.length)return e.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!me(t[1]))return e.error("invalid value");const n=t[1];let r=Ae(n);const i=e.expectedType;return"array"!==r.kind||0!==r.N||!i||"array"!==i.kind||"number"==typeof i.N&&0!==i.N||(r=i),new _e(r,n)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof ce?["rgba"].concat(this.value.toArray()):this.value instanceof fe?this.value.serialize():this.value}}class ve{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const be={string:Xt,number:Ht,boolean:$t,object:Qt};class xe{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");let n,r=1;const i=t[0];if("array"===i){let i,o;if(t.length>2){const n=t[1];if("string"!=typeof n||!(n in be)||"object"===n)return e.error('The item type argument of "array" must be one of string, number, boolean',1);i=be[n],r++}else i=Kt;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);o=t[2],r++}n=ne(i,o)}else n=be[i];const o=[];for(;r<t.length;r++){const n=e.parse(t[r],r,Kt);if(!n)return null;o.push(n)}return new xe(n,o)}evaluate(t){for(let e=0;e<this.args.length;e++){const n=this.args[e].evaluate(t);if(!oe(this.type,Ae(n)))return n;if(e===this.args.length-1)throw new ve(`Expected value to be of type ${re(this.type)}, but found ${re(Ae(n))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}serialize(){const t=this.type,e=[t.kind];if("array"===t.kind){const n=t.itemType;if("string"===n.kind||"number"===n.kind||"boolean"===n.kind){e.push(n.kind);const r=t.N;("number"==typeof r||this.args.length>1)&&e.push(r)}}return e.concat(this.args.map((t=>t.serialize())))}}class we{constructor(t){this.type=te,this.sections=t}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const n=t[1];if(!Array.isArray(n)&&"object"==typeof n)return e.error("First argument must be an image or text section.");const r=[];let i=!1;for(let n=1;n<=t.length-1;++n){const o=t[n];if(i&&"object"==typeof o&&!Array.isArray(o)){i=!1;let t=null;if(o["font-scale"]&&(t=e.parse(o["font-scale"],1,Ht),!t))return null;let n=null;if(o["text-font"]&&(n=e.parse(o["text-font"],1,ne(Xt)),!n))return null;let s=null;if(o["text-color"]&&(s=e.parse(o["text-color"],1,Yt),!s))return null;const a=r[r.length-1];a.scale=t,a.font=n,a.textColor=s}else{const o=e.parse(t[n],1,Kt);if(!o)return null;const s=o.type.kind;if("string"!==s&&"value"!==s&&"null"!==s&&"resolvedImage"!==s)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");i=!0,r.push({content:o,scale:null,font:null,textColor:null})}}return new we(r)}evaluate(t){return new fe(this.sections.map((e=>{const n=e.content.evaluate(t);return Ae(n)===ee?new pe("",n,null,null,null):new pe(ye(n),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)})))}eachChild(t){for(const e of this.sections)t(e.content),e.scale&&t(e.scale),e.font&&t(e.font),e.textColor&&t(e.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const e of this.sections){t.push(e.content.serialize());const n={};e.scale&&(n["font-scale"]=e.scale.serialize()),e.font&&(n["text-font"]=e.font.serialize()),e.textColor&&(n["text-color"]=e.textColor.serialize()),t.push(n)}return t}}class Ee{constructor(t){this.type=ee,this.input=t}static parse(t,e){if(2!==t.length)return e.error("Expected two arguments.");const n=e.parse(t[1],1,Xt);return n?new Ee(n):e.error("No image name provided.")}evaluate(t){const e=this.input.evaluate(t),n=de.fromString(e);return n&&t.availableImages&&(n.available=t.availableImages.indexOf(e)>-1),n}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Se={"to-boolean":$t,"to-color":Yt,"to-number":Ht,"to-string":Xt};class Te{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const n=t[0];if(("to-boolean"===n||"to-string"===n)&&2!==t.length)return e.error("Expected one argument.");const r=Se[n],i=[];for(let n=1;n<t.length;n++){const r=e.parse(t[n],n,Kt);if(!r)return null;i.push(r)}return new Te(r,i)}evaluate(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){let e,n;for(const r of this.args){if(e=r.evaluate(t),n=null,e instanceof ce)return e;if("string"==typeof e){const n=t.parseColor(e);if(n)return n}else if(Array.isArray(e)&&(n=e.length<3||e.length>4?`Invalid rbga value ${JSON.stringify(e)}: expected an array containing either three or four numeric values.`:ge(e[0],e[1],e[2],e[3]),!n))return new ce(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new ve(n||`Could not parse color from value '${"string"==typeof e?e:String(JSON.stringify(e))}'`)}if("number"===this.type.kind){let e=null;for(const n of this.args){if(e=n.evaluate(t),null===e)return 0;const r=Number(e);if(!isNaN(r))return r}throw new ve(`Could not convert ${JSON.stringify(e)} to number.`)}return"formatted"===this.type.kind?fe.fromString(ye(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?de.fromString(ye(this.args[0].evaluate(t))):ye(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}serialize(){if("formatted"===this.type.kind)return new we([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Ee(this.args[0]).serialize();const t=[`to-${this.type.kind}`];return this.eachChild((e=>{t.push(e.serialize())})),t}}const Pe=["Unknown","Point","LineString","Polygon"];class Me{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Pe[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=ce.parse(t)),e}}class Ce{constructor(t,e,n,r){this.name=t,this.type=e,this._evaluate=n,this.args=r}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map((t=>t.serialize())))}static parse(t,e){const n=t[0],r=Ce.definitions[n];if(!r)return e.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0);const i=Array.isArray(r)?r[0]:r.type,o=Array.isArray(r)?[[r[1],r[2]]]:r.overloads,s=o.filter((([e])=>!Array.isArray(e)||e.length===t.length-1));let a=null;for(const[r,o]of s){a=new Ke(e.registry,e.path,null,e.scope);const s=[];let l=!1;for(let e=1;e<t.length;e++){const n=t[e],i=Array.isArray(r)?r[e-1]:r.type,o=a.parse(n,1+s.length,i);if(!o){l=!0;break}s.push(o)}if(!l)if(Array.isArray(r)&&r.length!==s.length)a.error(`Expected ${r.length} arguments, but found ${s.length} instead.`);else{for(let t=0;t<s.length;t++){const e=Array.isArray(r)?r[t]:r.type,n=s[t];a.concat(t+1).checkSubtype(e,n.type)}if(0===a.errors.length)return new Ce(n,i,o,s)}}if(1===s.length)e.errors.push(...a.errors);else{const n=(s.length?s:o).map((([t])=>{return e=t,Array.isArray(e)?`(${e.map(re).join(", ")})`:`(${re(e.type)}...)`;var e})).join(" | "),r=[];for(let n=1;n<t.length;n++){const i=e.parse(t[n],1+r.length);if(!i)return null;r.push(re(i.type))}e.error(`Expected arguments of type ${n}, but found (${r.join(", ")}) instead.`)}return null}static register(t,e){Ce.definitions=e;for(const n in e)t[n]=Ce}}class Ie{constructor(t,e,n){this.type=Jt,this.locale=n,this.caseSensitive=t,this.diacriticSensitive=e}static parse(t,e){if(2!==t.length)return e.error("Expected one argument.");const n=t[1];if("object"!=typeof n||Array.isArray(n))return e.error("Collator options argument must be an object.");const r=e.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,$t);if(!r)return null;const i=e.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,$t);if(!i)return null;let o=null;return n.locale&&(o=e.parse(n.locale,1,Xt),!o)?null:new Ie(r,i,o)}evaluate(t){return new he(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}const Oe=8192;function Re(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function Le(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function ke(t,e){const n=(180+t[0])/360,r=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,i=Math.pow(2,e.z);return[Math.round(n*i*Oe),Math.round(r*i*Oe)]}function De(t,e,n){const r=t[0]-e[0],i=t[1]-e[1],o=t[0]-n[0],s=t[1]-n[1];return r*s-o*i==0&&r*o<=0&&i*s<=0}function Ne(t,e){let n=!1;for(let s=0,a=e.length;s<a;s++){const a=e[s];for(let e=0,s=a.length;e<s-1;e++){if(De(t,a[e],a[e+1]))return!1;(i=a[e])[1]>(r=t)[1]!=(o=a[e+1])[1]>r[1]&&r[0]<(o[0]-i[0])*(r[1]-i[1])/(o[1]-i[1])+i[0]&&(n=!n)}}var r,i,o;return n}function Fe(t,e){for(let n=0;n<e.length;n++)if(Ne(t,e[n]))return!0;return!1}function Be(t,e,n,r){const i=r[0]-n[0],o=r[1]-n[1],s=(t[0]-n[0])*o-i*(t[1]-n[1]),a=(e[0]-n[0])*o-i*(e[1]-n[1]);return s>0&&a<0||s<0&&a>0}function ze(t,e,n){for(const u of n)for(let n=0;n<u.length-1;++n)if(0!=(a=[(s=u[n+1])[0]-(o=u[n])[0],s[1]-o[1]])[0]*(l=[(i=e)[0]-(r=t)[0],i[1]-r[1]])[1]-a[1]*l[0]&&Be(r,i,o,s)&&Be(o,s,r,i))return!0;var r,i,o,s,a,l;return!1}function je(t,e){for(let n=0;n<t.length;++n)if(!Ne(t[n],e))return!1;for(let n=0;n<t.length-1;++n)if(ze(t[n],t[n+1],e))return!1;return!0}function Ue(t,e){for(let n=0;n<e.length;n++)if(je(t,e[n]))return!0;return!1}function Ve(t,e,n){const r=[];for(let i=0;i<t.length;i++){const o=[];for(let r=0;r<t[i].length;r++){const s=ke(t[i][r],n);Re(e,s),o.push(s)}r.push(o)}return r}function Ge(t,e,n){const r=[];for(let i=0;i<t.length;i++){const o=Ve(t[i],e,n);r.push(o)}return r}function Ze(t,e,n,r){if(t[0]<n[0]||t[0]>n[2]){const e=.5*r;let i=t[0]-n[0]>e?-r:n[0]-t[0]>e?r:0;0===i&&(i=t[0]-n[2]>e?-r:n[2]-t[0]>e?r:0),t[0]+=i}Re(e,t)}function qe(t,e,n,r){const i=Math.pow(2,r.z)*Oe,o=[r.x*Oe,r.y*Oe],s=[];for(const r of t)for(const t of r){const r=[t.x+o[0],t.y+o[1]];Ze(r,e,n,i),s.push(r)}return s}function We(t,e,n,r){const i=Math.pow(2,r.z)*Oe,o=[r.x*Oe,r.y*Oe],s=[];for(const n of t){const t=[];for(const r of n){const n=[r.x+o[0],r.y+o[1]];Re(e,n),t.push(n)}s.push(t)}if(e[2]-e[0]<=i/2){(a=e)[0]=a[1]=1/0,a[2]=a[3]=-1/0;for(const t of s)for(const r of t)Ze(r,e,n,i)}var a;return s}class He{constructor(t,e){this.type=$t,this.geojson=t,this.geometries=e}static parse(t,e){if(2!==t.length)return e.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(me(t[1])){const e=t[1];if("FeatureCollection"===e.type)for(let t=0;t<e.features.length;++t){const n=e.features[t].geometry.type;if("Polygon"===n||"MultiPolygon"===n)return new He(e,e.features[t].geometry)}else if("Feature"===e.type){const t=e.geometry.type;if("Polygon"===t||"MultiPolygon"===t)return new He(e,e.geometry)}else if("Polygon"===e.type||"MultiPolygon"===e.type)return new He(e,e)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){const n=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if("Polygon"===e.type){const o=Ve(e.coordinates,r,i),s=qe(t.geometry(),n,r,i);if(!Le(n,r))return!1;for(const t of s)if(!Ne(t,o))return!1}if("MultiPolygon"===e.type){const o=Ge(e.coordinates,r,i),s=qe(t.geometry(),n,r,i);if(!Le(n,r))return!1;for(const t of s)if(!Fe(t,o))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){const n=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if("Polygon"===e.type){const o=Ve(e.coordinates,r,i),s=We(t.geometry(),n,r,i);if(!Le(n,r))return!1;for(const t of s)if(!je(t,o))return!1}if("MultiPolygon"===e.type){const o=Ge(e.coordinates,r,i),s=We(t.geometry(),n,r,i);if(!Le(n,r))return!1;for(const t of s)if(!Ue(t,o))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function Xe(t){if(t instanceof Ce){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof He)return!1;let e=!0;return t.eachChild((t=>{e&&!Xe(t)&&(e=!1)})),e}function $e(t){if(t instanceof Ce&&"feature-state"===t.name)return!1;let e=!0;return t.eachChild((t=>{e&&!$e(t)&&(e=!1)})),e}function Ye(t,e){if(t instanceof Ce&&e.indexOf(t.name)>=0)return!1;let n=!0;return t.eachChild((t=>{n&&!Ye(t,e)&&(n=!1)})),n}class Qe{constructor(t,e){this.type=e.type,this.name=t,this.boundExpression=e}static parse(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");const n=t[1];return e.scope.has(n)?new Qe(n,e.scope.get(n)):e.error(`Unknown variable "${n}". Make sure "${n}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Ke{constructor(t,e=[],n,r=new qt,i=[]){this.registry=t,this.path=e,this.key=e.map((t=>`[${t}]`)).join(""),this.scope=r,this.errors=i,this.expectedType=n}parse(t,e,n,r,i={}){return e?this.concat(e,n,r)._parse(t,i):this._parse(t,i)}_parse(t,e){function n(t,e,n){return"assert"===n?new xe(e,[t]):"coerce"===n?new Te(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const r=t[0];if("string"!=typeof r)return this.error(`Expression name must be a string, but found ${typeof r} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const i=this.registry[r];if(i){let r=i.parse(t,this);if(!r)return null;if(this.expectedType){const t=this.expectedType,i=r.type;if("string"!==t.kind&&"number"!==t.kind&&"boolean"!==t.kind&&"object"!==t.kind&&"array"!==t.kind||"value"!==i.kind)if("color"!==t.kind&&"formatted"!==t.kind&&"resolvedImage"!==t.kind||"value"!==i.kind&&"string"!==i.kind){if(this.checkSubtype(t,i))return null}else r=n(r,t,e.typeAnnotation||"coerce");else r=n(r,t,e.typeAnnotation||"assert")}if(!(r instanceof _e)&&"resolvedImage"!==r.type.kind&&Je(r)){const e=new Me;try{r=new _e(r.type,r.evaluate(e))}catch(t){return this.error(t.message),null}}return r}return this.error(`Unknown expression "${r}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,e,n){const r="number"==typeof t?this.path.concat(t):this.path,i=n?this.scope.concat(n):this.scope;return new Ke(this.registry,r,e||null,i,this.errors)}error(t,...e){const n=`${this.key}${e.map((t=>`[${t}]`)).join("")}`;this.errors.push(new Zt(n,t))}checkSubtype(t,e){const n=oe(t,e);return n&&this.error(n),n}}function Je(t){if(t instanceof Qe)return Je(t.boundExpression);if(t instanceof Ce&&"error"===t.name)return!1;if(t instanceof Ie)return!1;if(t instanceof He)return!1;const e=t instanceof Te||t instanceof xe;let n=!0;return t.eachChild((t=>{n=e?n&&Je(t):n&&t instanceof _e})),!!n&&Xe(t)&&Ye(t,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script"])}function tn(t,e){const n=t.length-1;let r,i,o=0,s=n,a=0;for(;o<=s;)if(a=Math.floor((o+s)/2),r=t[a],i=t[a+1],r<=e){if(a===n||e<i)return a;o=a+1}else{if(!(r>e))throw new ve("Input is not a number.");s=a-1}return 0}class en{constructor(t,e,n){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(const[t,e]of n)this.labels.push(t),this.outputs.push(e)}static parse(t,e){if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");const n=e.parse(t[1],1,Ht);if(!n)return null;const r=[];let i=null;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);for(let n=1;n<t.length;n+=2){const o=1===n?-1/0:t[n],s=t[n+1],a=n,l=n+1;if("number"!=typeof o)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',a);if(r.length&&r[r.length-1][0]>=o)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',a);const u=e.parse(s,l,i);if(!u)return null;i=i||u.type,r.push([o,u])}return new en(i,n,r)}evaluate(t){const e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);const r=this.input.evaluate(t);if(r<=e[0])return n[0].evaluate(t);const i=e.length;return r>=e[i-1]?n[i-1].evaluate(t):n[tn(e,r)].evaluate(t)}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}serialize(){const t=["step",this.input.serialize()];for(let e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t}}function nn(t,e,n){return t*(1-n)+e*n}var rn=Object.freeze({__proto__:null,number:nn,color:function(t,e,n){return new ce(nn(t.r,e.r,n),nn(t.g,e.g,n),nn(t.b,e.b,n),nn(t.a,e.a,n))},array:function(t,e,n){return t.map(((t,r)=>nn(t,e[r],n)))}});const on=.95047,sn=1.08883,an=4/29,ln=6/29,un=3*ln*ln,cn=Math.PI/180,hn=180/Math.PI;function pn(t){return t>.008856451679035631?Math.pow(t,1/3):t/un+an}function fn(t){return t>ln?t*t*t:un*(t-an)}function dn(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function gn(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function mn(t){const e=gn(t.r),n=gn(t.g),r=gn(t.b),i=pn((.4124564*e+.3575761*n+.1804375*r)/on),o=pn((.2126729*e+.7151522*n+.072175*r)/1);return{l:116*o-16,a:500*(i-o),b:200*(o-pn((.0193339*e+.119192*n+.9503041*r)/sn)),alpha:t.a}}function An(t){let e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,r=isNaN(t.b)?e:e-t.b/200;return e=1*fn(e),n=on*fn(n),r=sn*fn(r),new ce(dn(3.2404542*n-1.5371385*e-.4985314*r),dn(-.969266*n+1.8760108*e+.041556*r),dn(.0556434*n-.2040259*e+1.0572252*r),t.alpha)}function yn(t,e,n){const r=e-t;return t+n*(r>180||r<-180?r-360*Math.round(r/360):r)}const _n={forward:mn,reverse:An,interpolate:function(t,e,n){return{l:nn(t.l,e.l,n),a:nn(t.a,e.a,n),b:nn(t.b,e.b,n),alpha:nn(t.alpha,e.alpha,n)}}},vn={forward:function(t){const{l:e,a:n,b:r}=mn(t),i=Math.atan2(r,n)*hn;return{h:i<0?i+360:i,c:Math.sqrt(n*n+r*r),l:e,alpha:t.a}},reverse:function(t){const e=t.h*cn,n=t.c;return An({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:yn(t.h,e.h,n),c:nn(t.c,e.c,n),l:nn(t.l,e.l,n),alpha:nn(t.alpha,e.alpha,n)}}};var bn=Object.freeze({__proto__:null,lab:_n,hcl:vn});class xn{constructor(t,e,n,r,i){this.type=t,this.operator=e,this.interpolation=n,this.input=r,this.labels=[],this.outputs=[];for(const[t,e]of i)this.labels.push(t),this.outputs.push(e)}static interpolationFactor(t,e,r,i){let o=0;if("exponential"===t.name)o=wn(e,t.base,r,i);else if("linear"===t.name)o=wn(e,1,r,i);else if("cubic-bezier"===t.name){const s=t.controlPoints;o=new n(s[0],s[1],s[2],s[3]).solve(wn(e,1,r,i))}return o}static parse(t,e){let[n,r,i,...o]=t;if(!Array.isArray(r)||0===r.length)return e.error("Expected an interpolation type expression.",1);if("linear"===r[0])r={name:"linear"};else if("exponential"===r[0]){const t=r[1];if("number"!=typeof t)return e.error("Exponential interpolation requires a numeric base.",1,1);r={name:"exponential",base:t}}else{if("cubic-bezier"!==r[0])return e.error(`Unknown interpolation type ${String(r[0])}`,1,0);{const t=r.slice(1);if(4!==t.length||t.some((t=>"number"!=typeof t||t<0||t>1)))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);r={name:"cubic-bezier",controlPoints:t}}}if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(i=e.parse(i,2,Ht),!i)return null;const s=[];let a=null;"interpolate-hcl"===n||"interpolate-lab"===n?a=Yt:e.expectedType&&"value"!==e.expectedType.kind&&(a=e.expectedType);for(let t=0;t<o.length;t+=2){const n=o[t],r=o[t+1],i=t+3,l=t+4;if("number"!=typeof n)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',i);if(s.length&&s[s.length-1][0]>=n)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',i);const u=e.parse(r,l,a);if(!u)return null;a=a||u.type,s.push([n,u])}return"number"===a.kind||"color"===a.kind||"array"===a.kind&&"number"===a.itemType.kind&&"number"==typeof a.N?new xn(a,n,r,i,s):e.error(`Type ${re(a)} is not interpolatable.`)}evaluate(t){const e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);const r=this.input.evaluate(t);if(r<=e[0])return n[0].evaluate(t);const i=e.length;if(r>=e[i-1])return n[i-1].evaluate(t);const o=tn(e,r),s=xn.interpolationFactor(this.interpolation,r,e[o],e[o+1]),a=n[o].evaluate(t),l=n[o+1].evaluate(t);return"interpolate"===this.operator?rn[this.type.kind.toLowerCase()](a,l,s):"interpolate-hcl"===this.operator?vn.reverse(vn.interpolate(vn.forward(a),vn.forward(l),s)):_n.reverse(_n.interpolate(_n.forward(a),_n.forward(l),s))}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}serialize(){let t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const e=[this.operator,t,this.input.serialize()];for(let t=0;t<this.labels.length;t++)e.push(this.labels[t],this.outputs[t].serialize());return e}}function wn(t,e,n,r){const i=r-n,o=t-n;return 0===i?0:1===e?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}class En{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expectected at least one argument.");let n=null;const r=e.expectedType;r&&"value"!==r.kind&&(n=r);const i=[];for(const r of t.slice(1)){const t=e.parse(r,1+i.length,n,void 0,{typeAnnotation:"omit"});if(!t)return null;n=n||t.type,i.push(t)}const o=r&&i.some((t=>oe(r,t.type)));return new En(o?Kt:n,i)}evaluate(t){let e,n=null,r=0;for(const i of this.args)if(r++,n=i.evaluate(t),n&&n instanceof de&&!n.available&&(e||(e=n.name),n=null,r===this.args.length&&(n=e)),null!==n)break;return n}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}serialize(){const t=["coalesce"];return this.eachChild((e=>{t.push(e.serialize())})),t}}class Sn{constructor(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const e of this.bindings)t(e[1]);t(this.result)}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const n=[];for(let r=1;r<t.length-1;r+=2){const i=t[r];if("string"!=typeof i)return e.error(`Expected string, but found ${typeof i} instead.`,r);if(/[^a-zA-Z0-9_]/.test(i))return e.error("Variable names must contain only alphanumeric characters or '_'.",r);const o=e.parse(t[r+1],r+1);if(!o)return null;n.push([i,o])}const r=e.parse(t[t.length-1],t.length-1,e.expectedType,n);return r?new Sn(n,r):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[e,n]of this.bindings)t.push(e,n.serialize());return t.push(this.result.serialize()),t}}class Tn{constructor(t,e,n){this.type=t,this.index=e,this.input=n}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,Ht),r=e.parse(t[2],2,ne(e.expectedType||Kt));return n&&r?new Tn(r.type.itemType,n,r):null}evaluate(t){const e=this.index.evaluate(t),n=this.input.evaluate(t);if(e<0)throw new ve(`Array index out of bounds: ${e} < 0.`);if(e>=n.length)throw new ve(`Array index out of bounds: ${e} > ${n.length-1}.`);if(e!==Math.floor(e))throw new ve(`Array index must be an integer, but found ${e} instead.`);return n[e]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Pn{constructor(t,e){this.type=$t,this.needle=t,this.haystack=e}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,Kt),r=e.parse(t[2],2,Kt);return n&&r?se(n.type,[$t,Xt,Ht,Wt,Kt])?new Pn(n,r):e.error(`Expected first argument to be of type boolean, string, number or null, but found ${re(n.type)} instead`):null}evaluate(t){const e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!n)return!1;if(!ae(e,["boolean","string","number","null"]))throw new ve(`Expected first argument to be of type boolean, string, number or null, but found ${re(Ae(e))} instead.`);if(!ae(n,["string","array"]))throw new ve(`Expected second argument to be of type array or string, but found ${re(Ae(n))} instead.`);return n.indexOf(e)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Mn{constructor(t,e,n){this.type=Ht,this.needle=t,this.haystack=e,this.fromIndex=n}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,Kt),r=e.parse(t[2],2,Kt);if(!n||!r)return null;if(!se(n.type,[$t,Xt,Ht,Wt,Kt]))return e.error(`Expected first argument to be of type boolean, string, number or null, but found ${re(n.type)} instead`);if(4===t.length){const i=e.parse(t[3],3,Ht);return i?new Mn(n,r,i):null}return new Mn(n,r)}evaluate(t){const e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!ae(e,["boolean","string","number","null"]))throw new ve(`Expected first argument to be of type boolean, string, number or null, but found ${re(Ae(e))} instead.`);if(!ae(n,["string","array"]))throw new ve(`Expected second argument to be of type array or string, but found ${re(Ae(n))} instead.`);if(this.fromIndex){const r=this.fromIndex.evaluate(t);return n.indexOf(e,r)}return n.indexOf(e)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Cn{constructor(t,e,n,r,i,o){this.inputType=t,this.type=e,this.input=n,this.cases=r,this.outputs=i,this.otherwise=o}static parse(t,e){if(t.length<5)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return e.error("Expected an even number of arguments.");let n,r;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);const i={},o=[];for(let s=2;s<t.length-1;s+=2){let a=t[s];const l=t[s+1];Array.isArray(a)||(a=[a]);const u=e.concat(s);if(0===a.length)return u.error("Expected at least one branch label.");for(const t of a){if("number"!=typeof t&&"string"!=typeof t)return u.error("Branch labels must be numbers or strings.");if("number"==typeof t&&Math.abs(t)>Number.MAX_SAFE_INTEGER)return u.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof t&&Math.floor(t)!==t)return u.error("Numeric branch labels must be integer values.");if(n){if(u.checkSubtype(n,Ae(t)))return null}else n=Ae(t);if(void 0!==i[String(t)])return u.error("Branch labels must be unique.");i[String(t)]=o.length}const c=e.parse(l,s,r);if(!c)return null;r=r||c.type,o.push(c)}const s=e.parse(t[1],1,Kt);if(!s)return null;const a=e.parse(t[t.length-1],t.length-1,r);return a?"value"!==s.type.kind&&e.concat(1).checkSubtype(n,s.type)?null:new Cn(n,r,s,i,o,a):null}evaluate(t){const e=this.input.evaluate(t);return(Ae(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],e=Object.keys(this.cases).sort(),n=[],r={};for(const t of e){const e=r[this.cases[t]];void 0===e?(r[this.cases[t]]=n.length,n.push([this.cases[t],[t]])):n[e][1].push(t)}const i=t=>"number"===this.inputType.kind?Number(t):t;for(const[e,r]of n)t.push(1===r.length?i(r[0]):r.map(i)),t.push(this.outputs[e].serialize());return t.push(this.otherwise.serialize()),t}}class In{constructor(t,e,n){this.type=t,this.branches=e,this.otherwise=n}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return e.error("Expected an odd number of arguments.");let n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);const r=[];for(let i=1;i<t.length-1;i+=2){const o=e.parse(t[i],i,$t);if(!o)return null;const s=e.parse(t[i+1],i+1,n);if(!s)return null;r.push([o,s]),n=n||s.type}const i=e.parse(t[t.length-1],t.length-1,n);return i?new In(n,r,i):null}evaluate(t){for(const[e,n]of this.branches)if(e.evaluate(t))return n.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[e,n]of this.branches)t(e),t(n);t(this.otherwise)}outputDefined(){return this.branches.every((([t,e])=>e.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild((e=>{t.push(e.serialize())})),t}}class On{constructor(t,e,n,r){this.type=t,this.input=e,this.beginIndex=n,this.endIndex=r}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,Kt),r=e.parse(t[2],2,Ht);if(!n||!r)return null;if(!se(n.type,[ne(Kt),Xt,Kt]))return e.error(`Expected first argument to be of type array or string, but found ${re(n.type)} instead`);if(4===t.length){const i=e.parse(t[3],3,Ht);return i?new On(n.type,n,r,i):null}return new On(n.type,n,r)}evaluate(t){const e=this.input.evaluate(t),n=this.beginIndex.evaluate(t);if(!ae(e,["string","array"]))throw new ve(`Expected first argument to be of type array or string, but found ${re(Ae(e))} instead.`);if(this.endIndex){const r=this.endIndex.evaluate(t);return e.slice(n,r)}return e.slice(n)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Rn(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function Ln(t,e,n,r){return 0===r.compare(e,n)}function kn(t,e,n){const r="=="!==t&&"!="!==t;return class i{constructor(t,e,n){this.type=$t,this.lhs=t,this.rhs=e,this.collator=n,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}static parse(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");const n=t[0];let o=e.parse(t[1],1,Kt);if(!o)return null;if(!Rn(n,o.type))return e.concat(1).error(`"${n}" comparisons are not supported for type '${re(o.type)}'.`);let s=e.parse(t[2],2,Kt);if(!s)return null;if(!Rn(n,s.type))return e.concat(2).error(`"${n}" comparisons are not supported for type '${re(s.type)}'.`);if(o.type.kind!==s.type.kind&&"value"!==o.type.kind&&"value"!==s.type.kind)return e.error(`Cannot compare types '${re(o.type)}' and '${re(s.type)}'.`);r&&("value"===o.type.kind&&"value"!==s.type.kind?o=new xe(s.type,[o]):"value"!==o.type.kind&&"value"===s.type.kind&&(s=new xe(o.type,[s])));let a=null;if(4===t.length){if("string"!==o.type.kind&&"string"!==s.type.kind&&"value"!==o.type.kind&&"value"!==s.type.kind)return e.error("Cannot use collator to compare non-string types.");if(a=e.parse(t[3],3,Jt),!a)return null}return new i(o,s,a)}evaluate(i){const o=this.lhs.evaluate(i),s=this.rhs.evaluate(i);if(r&&this.hasUntypedArgument){const e=Ae(o),n=Ae(s);if(e.kind!==n.kind||"string"!==e.kind&&"number"!==e.kind)throw new ve(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${e.kind}, ${n.kind}) instead.`)}if(this.collator&&!r&&this.hasUntypedArgument){const t=Ae(o),n=Ae(s);if("string"!==t.kind||"string"!==n.kind)return e(i,o,s)}return this.collator?n(i,o,s,this.collator.evaluate(i)):e(i,o,s)}eachChild(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)}outputDefined(){return!0}serialize(){const e=[t];return this.eachChild((t=>{e.push(t.serialize())})),e}}}const Dn=kn("==",(function(t,e,n){return e===n}),Ln),Nn=kn("!=",(function(t,e,n){return e!==n}),(function(t,e,n,r){return!Ln(0,e,n,r)})),Fn=kn("<",(function(t,e,n){return e<n}),(function(t,e,n,r){return r.compare(e,n)<0})),Bn=kn(">",(function(t,e,n){return e>n}),(function(t,e,n,r){return r.compare(e,n)>0})),zn=kn("<=",(function(t,e,n){return e<=n}),(function(t,e,n,r){return r.compare(e,n)<=0})),jn=kn(">=",(function(t,e,n){return e>=n}),(function(t,e,n,r){return r.compare(e,n)>=0}));class Un{constructor(t,e,n,r,i){this.type=Xt,this.number=t,this.locale=e,this.currency=n,this.minFractionDigits=r,this.maxFractionDigits=i}static parse(t,e){if(3!==t.length)return e.error("Expected two arguments.");const n=e.parse(t[1],1,Ht);if(!n)return null;const r=t[2];if("object"!=typeof r||Array.isArray(r))return e.error("NumberFormat options argument must be an object.");let i=null;if(r.locale&&(i=e.parse(r.locale,1,Xt),!i))return null;let o=null;if(r.currency&&(o=e.parse(r.currency,1,Xt),!o))return null;let s=null;if(r["min-fraction-digits"]&&(s=e.parse(r["min-fraction-digits"],1,Ht),!s))return null;let a=null;return r["max-fraction-digits"]&&(a=e.parse(r["max-fraction-digits"],1,Ht),!a)?null:new Un(n,i,o,s,a)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class Vn{constructor(t){this.type=Ht,this.input=t}static parse(t,e){if(2!==t.length)return e.error(`Expected 1 argument, but found ${t.length-1} instead.`);const n=e.parse(t[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?e.error(`Expected argument of type string or array, but found ${re(n.type)} instead.`):new Vn(n):null}evaluate(t){const e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new ve(`Expected value to be of type string or array, but found ${re(Ae(e))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild((e=>{t.push(e.serialize())})),t}}const Gn={"==":Dn,"!=":Nn,">":Bn,"<":Fn,">=":jn,"<=":zn,array:xe,at:Tn,boolean:xe,case:In,coalesce:En,collator:Ie,format:we,image:Ee,in:Pn,"index-of":Mn,interpolate:xn,"interpolate-hcl":xn,"interpolate-lab":xn,length:Vn,let:Sn,literal:_e,match:Cn,number:xe,"number-format":Un,object:xe,slice:On,step:en,string:xe,"to-boolean":Te,"to-color":Te,"to-number":Te,"to-string":Te,var:Qe,within:He};function Zn(t,[e,n,r,i]){e=e.evaluate(t),n=n.evaluate(t),r=r.evaluate(t);const o=i?i.evaluate(t):1,s=ge(e,n,r,o);if(s)throw new ve(s);return new ce(e/255*o,n/255*o,r/255*o,o)}function qn(t,e){return t in e}function Wn(t,e){const n=e[t];return void 0===n?null:n}function Hn(t){return{type:t}}function Xn(t){return{result:"success",value:t}}function $n(t){return{result:"error",value:t}}function Yn(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function Qn(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function Kn(t){return!!t.expression&&t.expression.interpolated}function Jn(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function tr(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function er(t){return t}function nr(t,e){const n="color"===e.type,r=t.stops&&"object"==typeof t.stops[0][0],i=r||!(r||void 0!==t.property),o=t.type||(Kn(e)?"exponential":"interval");if(n&&((t=Ut({},t)).stops&&(t.stops=t.stops.map((t=>[t[0],ce.parse(t[1])]))),t.default=ce.parse(t.default?t.default:e.default)),t.colorSpace&&"rgb"!==t.colorSpace&&!bn[t.colorSpace])throw new Error(`Unknown color space: ${t.colorSpace}`);let s,a,l;if("exponential"===o)s=sr;else if("interval"===o)s=or;else if("categorical"===o){s=ir,a=Object.create(null);for(const e of t.stops)a[e[0]]=e[1];l=typeof t.stops[0][0]}else{if("identity"!==o)throw new Error(`Unknown function type "${o}"`);s=ar}if(r){const n={},r=[];for(let e=0;e<t.stops.length;e++){const i=t.stops[e],o=i[0].zoom;void 0===n[o]&&(n[o]={zoom:o,type:t.type,property:t.property,default:t.default,stops:[]},r.push(o)),n[o].stops.push([i[0].value,i[1]])}const i=[];for(const t of r)i.push([n[t].zoom,nr(n[t],e)]);const o={name:"linear"};return{kind:"composite",interpolationType:o,interpolationFactor:xn.interpolationFactor.bind(void 0,o),zoomStops:i.map((t=>t[0])),evaluate:({zoom:n},r)=>sr({stops:i,base:t.base},e,n).evaluate(n,r)}}if(i){const n="exponential"===o?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:n,interpolationFactor:xn.interpolationFactor.bind(void 0,n),zoomStops:t.stops.map((t=>t[0])),evaluate:({zoom:n})=>s(t,e,n,a,l)}}return{kind:"source",evaluate(n,r){const i=r&&r.properties?r.properties[t.property]:void 0;return void 0===i?rr(t.default,e.default):s(t,e,i,a,l)}}}function rr(t,e,n){return void 0!==t?t:void 0!==e?e:void 0!==n?n:void 0}function ir(t,e,n,r,i){return rr(typeof n===i?r[n]:void 0,t.default,e.default)}function or(t,e,n){if("number"!==Jn(n))return rr(t.default,e.default);const r=t.stops.length;if(1===r)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[r-1][0])return t.stops[r-1][1];const i=tn(t.stops.map((t=>t[0])),n);return t.stops[i][1]}function sr(t,e,n){const r=void 0!==t.base?t.base:1;if("number"!==Jn(n))return rr(t.default,e.default);const i=t.stops.length;if(1===i)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[i-1][0])return t.stops[i-1][1];const o=tn(t.stops.map((t=>t[0])),n),s=function(t,e,n,r){const i=r-n,o=t-n;return 0===i?0:1===e?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}(n,r,t.stops[o][0],t.stops[o+1][0]),a=t.stops[o][1],l=t.stops[o+1][1];let u=rn[e.type]||er;if(t.colorSpace&&"rgb"!==t.colorSpace){const e=bn[t.colorSpace];u=(t,n)=>e.reverse(e.interpolate(e.forward(t),e.forward(n),s))}return"function"==typeof a.evaluate?{evaluate(...t){const e=a.evaluate.apply(void 0,t),n=l.evaluate.apply(void 0,t);if(void 0!==e&&void 0!==n)return u(e,n,s)}}:u(a,l,s)}function ar(t,e,n){return"color"===e.type?n=ce.parse(n):"formatted"===e.type?n=fe.fromString(n.toString()):"resolvedImage"===e.type?n=de.fromString(n.toString()):Jn(n)===e.type||"enum"===e.type&&e.values[n]||(n=void 0),rr(n,t.default,e.default)}Ce.register(Gn,{error:[{kind:"error"},[Xt],(t,[e])=>{throw new ve(e.evaluate(t))}],typeof:[Xt,[Kt],(t,[e])=>re(Ae(e.evaluate(t)))],"to-rgba":[ne(Ht,4),[Yt],(t,[e])=>e.evaluate(t).toArray()],rgb:[Yt,[Ht,Ht,Ht],Zn],rgba:[Yt,[Ht,Ht,Ht,Ht],Zn],has:{type:$t,overloads:[[[Xt],(t,[e])=>qn(e.evaluate(t),t.properties())],[[Xt,Qt],(t,[e,n])=>qn(e.evaluate(t),n.evaluate(t))]]},get:{type:Kt,overloads:[[[Xt],(t,[e])=>Wn(e.evaluate(t),t.properties())],[[Xt,Qt],(t,[e,n])=>Wn(e.evaluate(t),n.evaluate(t))]]},"feature-state":[Kt,[Xt],(t,[e])=>Wn(e.evaluate(t),t.featureState||{})],properties:[Qt,[],t=>t.properties()],"geometry-type":[Xt,[],t=>t.geometryType()],id:[Kt,[],t=>t.id()],zoom:[Ht,[],t=>t.globals.zoom],"heatmap-density":[Ht,[],t=>t.globals.heatmapDensity||0],"line-progress":[Ht,[],t=>t.globals.lineProgress||0],"sky-radial-progress":[Ht,[],t=>t.globals.skyRadialProgress||0],accumulated:[Kt,[],t=>void 0===t.globals.accumulated?null:t.globals.accumulated],"+":[Ht,Hn(Ht),(t,e)=>{let n=0;for(const r of e)n+=r.evaluate(t);return n}],"*":[Ht,Hn(Ht),(t,e)=>{let n=1;for(const r of e)n*=r.evaluate(t);return n}],"-":{type:Ht,overloads:[[[Ht,Ht],(t,[e,n])=>e.evaluate(t)-n.evaluate(t)],[[Ht],(t,[e])=>-e.evaluate(t)]]},"/":[Ht,[Ht,Ht],(t,[e,n])=>e.evaluate(t)/n.evaluate(t)],"%":[Ht,[Ht,Ht],(t,[e,n])=>e.evaluate(t)%n.evaluate(t)],ln2:[Ht,[],()=>Math.LN2],pi:[Ht,[],()=>Math.PI],e:[Ht,[],()=>Math.E],"^":[Ht,[Ht,Ht],(t,[e,n])=>Math.pow(e.evaluate(t),n.evaluate(t))],sqrt:[Ht,[Ht],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[Ht,[Ht],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[Ht,[Ht],(t,[e])=>Math.log(e.evaluate(t))],log2:[Ht,[Ht],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[Ht,[Ht],(t,[e])=>Math.sin(e.evaluate(t))],cos:[Ht,[Ht],(t,[e])=>Math.cos(e.evaluate(t))],tan:[Ht,[Ht],(t,[e])=>Math.tan(e.evaluate(t))],asin:[Ht,[Ht],(t,[e])=>Math.asin(e.evaluate(t))],acos:[Ht,[Ht],(t,[e])=>Math.acos(e.evaluate(t))],atan:[Ht,[Ht],(t,[e])=>Math.atan(e.evaluate(t))],min:[Ht,Hn(Ht),(t,e)=>Math.min(...e.map((e=>e.evaluate(t))))],max:[Ht,Hn(Ht),(t,e)=>Math.max(...e.map((e=>e.evaluate(t))))],abs:[Ht,[Ht],(t,[e])=>Math.abs(e.evaluate(t))],round:[Ht,[Ht],(t,[e])=>{const n=e.evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[Ht,[Ht],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[Ht,[Ht],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[$t,[Xt,Kt],(t,[e,n])=>t.properties()[e.value]===n.value],"filter-id-==":[$t,[Kt],(t,[e])=>t.id()===e.value],"filter-type-==":[$t,[Xt],(t,[e])=>t.geometryType()===e.value],"filter-<":[$t,[Xt,Kt],(t,[e,n])=>{const r=t.properties()[e.value],i=n.value;return typeof r==typeof i&&r<i}],"filter-id-<":[$t,[Kt],(t,[e])=>{const n=t.id(),r=e.value;return typeof n==typeof r&&n<r}],"filter->":[$t,[Xt,Kt],(t,[e,n])=>{const r=t.properties()[e.value],i=n.value;return typeof r==typeof i&&r>i}],"filter-id->":[$t,[Kt],(t,[e])=>{const n=t.id(),r=e.value;return typeof n==typeof r&&n>r}],"filter-<=":[$t,[Xt,Kt],(t,[e,n])=>{const r=t.properties()[e.value],i=n.value;return typeof r==typeof i&&r<=i}],"filter-id-<=":[$t,[Kt],(t,[e])=>{const n=t.id(),r=e.value;return typeof n==typeof r&&n<=r}],"filter->=":[$t,[Xt,Kt],(t,[e,n])=>{const r=t.properties()[e.value],i=n.value;return typeof r==typeof i&&r>=i}],"filter-id->=":[$t,[Kt],(t,[e])=>{const n=t.id(),r=e.value;return typeof n==typeof r&&n>=r}],"filter-has":[$t,[Kt],(t,[e])=>e.value in t.properties()],"filter-has-id":[$t,[],t=>null!==t.id()&&void 0!==t.id()],"filter-type-in":[$t,[ne(Xt)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[$t,[ne(Kt)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[$t,[Xt,ne(Kt)],(t,[e,n])=>n.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[$t,[Xt,ne(Kt)],(t,[e,n])=>function(t,e,n,r){for(;n<=r;){const i=n+r>>1;if(e[i]===t)return!0;e[i]>t?r=i-1:n=i+1}return!1}(t.properties()[e.value],n.value,0,n.value.length-1)],all:{type:$t,overloads:[[[$t,$t],(t,[e,n])=>e.evaluate(t)&&n.evaluate(t)],[Hn($t),(t,e)=>{for(const n of e)if(!n.evaluate(t))return!1;return!0}]]},any:{type:$t,overloads:[[[$t,$t],(t,[e,n])=>e.evaluate(t)||n.evaluate(t)],[Hn($t),(t,e)=>{for(const n of e)if(n.evaluate(t))return!0;return!1}]]},"!":[$t,[$t],(t,[e])=>!e.evaluate(t)],"is-supported-script":[$t,[Xt],(t,[e])=>{const n=t.globals&&t.globals.isSupportedScript;return!n||n(e.evaluate(t))}],upcase:[Xt,[Xt],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[Xt,[Xt],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[Xt,Hn(Kt),(t,e)=>e.map((e=>ye(e.evaluate(t)))).join("")],"resolved-locale":[Xt,[Jt],(t,[e])=>e.evaluate(t).resolvedLocale()]});class lr{constructor(t,e){this.expression=t,this._warningHistory={},this._evaluator=new Me,this._defaultValue=e?function(t){return"color"===t.type&&tr(t.default)?new ce(0,0,0,0):"color"===t.type?ce.parse(t.default)||null:void 0===t.default?null:t.default}(e):null,this._enumValues=e&&"enum"===e.type?e.values:null}evaluateWithoutErrorHandling(t,e,n,r,i,o){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=n,this._evaluator.canonical=r,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=o,this.expression.evaluate(this._evaluator)}evaluate(t,e,n,r,i,o){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=n||null,this._evaluator.canonical=r,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=o||null;try{const t=this.expression.evaluate(this._evaluator);if(null==t||"number"==typeof t&&t!=t)return this._defaultValue;if(this._enumValues&&!(t in this._enumValues))throw new ve(`Expected value to be one of ${Object.keys(this._enumValues).map((t=>JSON.stringify(t))).join(", ")}, but found ${JSON.stringify(t)} instead.`);return t}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}}}function ur(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in Gn}function cr(t,e){const n=new Ke(Gn,[],e?function(t){const e={color:Yt,string:Xt,number:Ht,enum:Xt,boolean:$t,formatted:te,resolvedImage:ee};return"array"===t.type?ne(e[t.value]||Kt,t.length):e[t.type]}(e):void 0),r=n.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return r?Xn(new lr(r,e)):$n(n.errors)}class hr{constructor(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!$e(e.expression)}evaluateWithoutErrorHandling(t,e,n,r,i,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,r,i,o)}evaluate(t,e,n,r,i,o){return this._styleExpression.evaluate(t,e,n,r,i,o)}}class pr{constructor(t,e,n,r){this.kind=t,this.zoomStops=n,this._styleExpression=e,this.isStateDependent="camera"!==t&&!$e(e.expression),this.interpolationType=r}evaluateWithoutErrorHandling(t,e,n,r,i,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,r,i,o)}evaluate(t,e,n,r,i,o){return this._styleExpression.evaluate(t,e,n,r,i,o)}interpolationFactor(t,e,n){return this.interpolationType?xn.interpolationFactor(this.interpolationType,t,e,n):0}}function fr(t,e){if("error"===(t=cr(t,e)).result)return t;const n=t.value.expression,r=Xe(n);if(!r&&!Yn(e))return $n([new Zt("","data expressions not supported")]);const i=Ye(n,["zoom"]);if(!i&&!Qn(e))return $n([new Zt("","zoom expressions not supported")]);const o=gr(n);return o||i?o instanceof Zt?$n([o]):o instanceof xn&&!Kn(e)?$n([new Zt("",'"interpolate" expressions cannot be used with this property')]):Xn(o?new pr(r?"camera":"composite",t.value,o.labels,o instanceof xn?o.interpolation:void 0):new hr(r?"constant":"source",t.value)):$n([new Zt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class dr{constructor(t,e){this._parameters=t,this._specification=e,Ut(this,nr(this._parameters,this._specification))}static deserialize(t){return new dr(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function gr(t){let e=null;if(t instanceof Sn)e=gr(t.result);else if(t instanceof En){for(const n of t.args)if(e=gr(n),e)break}else(t instanceof en||t instanceof xn)&&t.input instanceof Ce&&"zoom"===t.input.name&&(e=t);return e instanceof Zt||t.eachChild((t=>{const n=gr(t);n instanceof Zt?e=n:!e&&n?e=new Zt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&n&&e!==n&&(e=new Zt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),e}function mr(t){const e=t.key,n=t.value,r=t.valueSpec||{},i=t.objectElementValidators||{},o=t.style,s=t.styleSpec;let a=[];const l=Jn(n);if("object"!==l)return[new zt(e,n,`object expected, ${l} found`)];for(const t in n){const l=t.split(".")[0],u=r[l]||r["*"];let c;if(i[l])c=i[l];else if(r[l])c=qr;else if(i["*"])c=i["*"];else{if(!r["*"]){a.push(new zt(e,n[t],`unknown property "${t}"`));continue}c=qr}a=a.concat(c({key:(e?`${e}.`:e)+t,value:n[t],valueSpec:u,style:o,styleSpec:s,object:n,objectKey:t},n))}for(const t in r)i[t]||r[t].required&&void 0===r[t].default&&void 0===n[t]&&a.push(new zt(e,n,`missing required property "${t}"`));return a}function Ar(t){const e=t.value,n=t.valueSpec,r=t.style,i=t.styleSpec,o=t.key,s=t.arrayElementValidator||qr;if("array"!==Jn(e))return[new zt(o,e,`array expected, ${Jn(e)} found`)];if(n.length&&e.length!==n.length)return[new zt(o,e,`array length ${n.length} expected, length ${e.length} found`)];if(n["min-length"]&&e.length<n["min-length"])return[new zt(o,e,`array length at least ${n["min-length"]} expected, length ${e.length} found`)];let a={type:n.value,values:n.values,minimum:n.minimum,maximum:n.maximum};i.$version<7&&(a.function=n.function),"object"===Jn(n.value)&&(a=n.value);let l=[];for(let t=0;t<e.length;t++)l=l.concat(s({array:e,arrayIndex:t,value:e[t],valueSpec:a,style:r,styleSpec:i,key:`${o}[${t}]`}));return l}function yr(t){const e=t.key,n=t.value,r=t.valueSpec;let i=Jn(n);if("number"===i&&n!=n&&(i="NaN"),"number"!==i)return[new zt(e,n,`number expected, ${i} found`)];if("minimum"in r){let i=r.minimum;if("array"===Jn(r.minimum)&&(i=r.minimum[t.arrayIndex]),n<i)return[new zt(e,n,`${n} is less than the minimum value ${i}`)]}if("maximum"in r){let i=r.maximum;if("array"===Jn(r.maximum)&&(i=r.maximum[t.arrayIndex]),n>i)return[new zt(e,n,`${n} is greater than the maximum value ${i}`)]}return[]}function _r(t){const e=t.valueSpec,n=Vt(t.value.type);let r,i,o,s={};const a="categorical"!==n&&void 0===t.value.property,l=!a,u="array"===Jn(t.value.stops)&&"array"===Jn(t.value.stops[0])&&"object"===Jn(t.value.stops[0][0]),c=mr({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===n)return[new zt(t.key,t.value,'identity function may not have a "stops" property')];let e=[];const r=t.value;return e=e.concat(Ar({key:t.key,value:r,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:h})),"array"===Jn(r)&&0===r.length&&e.push(new zt(t.key,r,"array must have at least one stop")),e},default:function(t){return qr({key:t.key,value:t.value,valueSpec:e,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===n&&a&&c.push(new zt(t.key,t.value,'missing required property "property"')),"identity"===n||t.value.stops||c.push(new zt(t.key,t.value,'missing required property "stops"')),"exponential"===n&&t.valueSpec.expression&&!Kn(t.valueSpec)&&c.push(new zt(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(l&&!Yn(t.valueSpec)?c.push(new zt(t.key,t.value,"property functions not supported")):a&&!Qn(t.valueSpec)&&c.push(new zt(t.key,t.value,"zoom functions not supported"))),"categorical"!==n&&!u||void 0!==t.value.property||c.push(new zt(t.key,t.value,'"property" property is required')),c;function h(t){let n=[];const r=t.value,a=t.key;if("array"!==Jn(r))return[new zt(a,r,`array expected, ${Jn(r)} found`)];if(2!==r.length)return[new zt(a,r,`array length 2 expected, length ${r.length} found`)];if(u){if("object"!==Jn(r[0]))return[new zt(a,r,`object expected, ${Jn(r[0])} found`)];if(void 0===r[0].zoom)return[new zt(a,r,"object stop key must have zoom")];if(void 0===r[0].value)return[new zt(a,r,"object stop key must have value")];if(o&&o>Vt(r[0].zoom))return[new zt(a,r[0].zoom,"stop zoom values must appear in ascending order")];Vt(r[0].zoom)!==o&&(o=Vt(r[0].zoom),i=void 0,s={}),n=n.concat(mr({key:`${a}[0]`,value:r[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:yr,value:p}}))}else n=n.concat(p({key:`${a}[0]`,value:r[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec},r));return ur(Gt(r[1]))?n.concat([new zt(`${a}[1]`,r[1],"expressions are not allowed in function stops.")]):n.concat(qr({key:`${a}[1]`,value:r[1],valueSpec:e,style:t.style,styleSpec:t.styleSpec}))}function p(t,o){const a=Jn(t.value),l=Vt(t.value),u=null!==t.value?t.value:o;if(r){if(a!==r)return[new zt(t.key,u,`${a} stop domain type must match previous stop domain type ${r}`)]}else r=a;if("number"!==a&&"string"!==a&&"boolean"!==a)return[new zt(t.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==a&&"categorical"!==n){let r=`number expected, ${a} found`;return Yn(e)&&void 0===n&&(r+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new zt(t.key,u,r)]}return"categorical"!==n||"number"!==a||isFinite(l)&&Math.floor(l)===l?"categorical"!==n&&"number"===a&&void 0!==i&&l<i?[new zt(t.key,u,"stop domain values must appear in ascending order")]:(i=l,"categorical"===n&&l in s?[new zt(t.key,u,"stop domain values must be unique")]:(s[l]=!0,[])):[new zt(t.key,u,`integer expected, found ${l}`)]}}function vr(t){const e=("property"===t.expressionContext?fr:cr)(Gt(t.value),t.valueSpec);if("error"===e.result)return e.value.map((e=>new zt(`${t.key}${e.key}`,t.value,e.message)));const n=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!n.outputDefined())return[new zt(t.key,t.value,`Invalid data expression for "${t.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===t.expressionContext&&"layout"===t.propertyType&&!$e(n))return[new zt(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext&&!$e(n))return[new zt(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!Ye(n,["zoom","feature-state"]))return[new zt(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!Xe(n))return[new zt(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function br(t){const e=t.key,n=t.value,r=t.valueSpec,i=[];return Array.isArray(r.values)?-1===r.values.indexOf(Vt(n))&&i.push(new zt(e,n,`expected one of [${r.values.join(", ")}], ${JSON.stringify(n)} found`)):-1===Object.keys(r.values).indexOf(Vt(n))&&i.push(new zt(e,n,`expected one of [${Object.keys(r.values).join(", ")}], ${JSON.stringify(n)} found`)),i}function xr(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!xr(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}const wr={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Er(t){if(null==t)return{filter:()=>!0,needGeometry:!1};xr(t)||(t=Pr(t));const e=cr(t,wr);if("error"===e.result)throw new Error(e.value.map((t=>`${t.key}: ${t.message}`)).join(", "));return{filter:(t,n,r)=>e.value.evaluate(t,n,{},r),needGeometry:Tr(t)}}function Sr(t,e){return t<e?-1:t>e?1:0}function Tr(t){if(!Array.isArray(t))return!1;if("within"===t[0])return!0;for(let e=1;e<t.length;e++)if(Tr(t[e]))return!0;return!1}function Pr(t){if(!t)return!0;const e=t[0];return t.length<=1?"any"!==e:"=="===e?Mr(t[1],t[2],"=="):"!="===e?Or(Mr(t[1],t[2],"==")):"<"===e||">"===e||"<="===e||">="===e?Mr(t[1],t[2],e):"any"===e?(n=t.slice(1),["any"].concat(n.map(Pr))):"all"===e?["all"].concat(t.slice(1).map(Pr)):"none"===e?["all"].concat(t.slice(1).map(Pr).map(Or)):"in"===e?Cr(t[1],t.slice(2)):"!in"===e?Or(Cr(t[1],t.slice(2))):"has"===e?Ir(t[1]):"!has"===e?Or(Ir(t[1])):"within"!==e||t;var n}function Mr(t,e,n){switch(t){case"$type":return[`filter-type-${n}`,e];case"$id":return[`filter-id-${n}`,e];default:return[`filter-${n}`,t,e]}}function Cr(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((t=>typeof t!=typeof e[0]))?["filter-in-large",t,["literal",e.sort(Sr)]]:["filter-in-small",t,["literal",e]]}}function Ir(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Or(t){return["!",t]}function Rr(t){return xr(Gt(t.value))?vr(Ut({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Lr(t)}function Lr(t){const e=t.value,n=t.key;if("array"!==Jn(e))return[new zt(n,e,`array expected, ${Jn(e)} found`)];const r=t.styleSpec;let i,o=[];if(e.length<1)return[new zt(n,e,"filter array must have at least 1 element")];switch(o=o.concat(br({key:`${n}[0]`,value:e[0],valueSpec:r.filter_operator,style:t.style,styleSpec:t.styleSpec})),Vt(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===Vt(e[1])&&o.push(new zt(n,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":3!==e.length&&o.push(new zt(n,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(i=Jn(e[1]),"string"!==i&&o.push(new zt(`${n}[1]`,e[1],`string expected, ${i} found`)));for(let s=2;s<e.length;s++)i=Jn(e[s]),"$type"===Vt(e[1])?o=o.concat(br({key:`${n}[${s}]`,value:e[s],valueSpec:r.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==i&&"number"!==i&&"boolean"!==i&&o.push(new zt(`${n}[${s}]`,e[s],`string, number, or boolean expected, ${i} found`));break;case"any":case"all":case"none":for(let r=1;r<e.length;r++)o=o.concat(Lr({key:`${n}[${r}]`,value:e[r],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":i=Jn(e[1]),2!==e.length?o.push(new zt(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):"string"!==i&&o.push(new zt(`${n}[1]`,e[1],`string expected, ${i} found`));break;case"within":i=Jn(e[1]),2!==e.length?o.push(new zt(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):"object"!==i&&o.push(new zt(`${n}[1]`,e[1],`object expected, ${i} found`))}return o}function kr(t,e){const n=t.key,r=t.style,i=t.styleSpec,o=t.value,s=t.objectKey,a=i[`${e}_${t.layerType}`];if(!a)return[];const l=s.match(/^(.*)-transition$/);if("paint"===e&&l&&a[l[1]]&&a[l[1]].transition)return qr({key:n,value:o,valueSpec:i.transition,style:r,styleSpec:i});const u=t.valueSpec||a[s];if(!u)return[new zt(n,o,`unknown property "${s}"`)];let c;if("string"===Jn(o)&&Yn(u)&&!u.tokens&&(c=/^{([^}]+)}$/.exec(o)))return[new zt(n,o,`"${s}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(c[1])} }\`.`)];const h=[];return"symbol"===t.layerType&&("text-field"===s&&r&&!r.glyphs&&h.push(new zt(n,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===s&&tr(Gt(o))&&"identity"===Vt(o.type)&&h.push(new zt(n,o,'"text-font" does not support identity functions'))),h.concat(qr({key:t.key,value:o,valueSpec:u,style:r,styleSpec:i,expressionContext:"property",propertyType:e,propertyKey:s}))}function Dr(t){return kr(t,"paint")}function Nr(t){return kr(t,"layout")}function Fr(t){let e=[];const n=t.value,r=t.key,i=t.style,o=t.styleSpec;n.type||n.ref||e.push(new zt(r,n,'either "type" or "ref" is required'));let s=Vt(n.type);const a=Vt(n.ref);if(n.id){const o=Vt(n.id);for(let s=0;s<t.arrayIndex;s++){const t=i.layers[s];Vt(t.id)===o&&e.push(new zt(r,n.id,`duplicate layer id "${n.id}", previously used at line ${t.id.__line__}`))}}if("ref"in n){let t;["type","source","source-layer","filter","layout"].forEach((t=>{t in n&&e.push(new zt(r,n[t],`"${t}" is prohibited for ref layers`))})),i.layers.forEach((e=>{Vt(e.id)===a&&(t=e)})),t?t.ref?e.push(new zt(r,n.ref,"ref cannot reference another ref layer")):s=Vt(t.type):e.push(new zt(r,n.ref,`ref layer "${a}" not found`))}else if("background"!==s&&"sky"!==s)if(n.source){const t=i.sources&&i.sources[n.source],o=t&&Vt(t.type);t?"vector"===o&&"raster"===s?e.push(new zt(r,n.source,`layer "${n.id}" requires a raster source`)):"raster"===o&&"raster"!==s?e.push(new zt(r,n.source,`layer "${n.id}" requires a vector source`)):"vector"!==o||n["source-layer"]?"raster-dem"===o&&"hillshade"!==s?e.push(new zt(r,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!n.paint||!n.paint["line-gradient"]||"geojson"===o&&t.lineMetrics||e.push(new zt(r,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new zt(r,n,`layer "${n.id}" must specify a "source-layer"`)):e.push(new zt(r,n.source,`source "${n.source}" not found`))}else e.push(new zt(r,n,'missing required property "source"'));return e=e.concat(mr({key:r,value:n,valueSpec:o.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":()=>[],type:()=>qr({key:`${r}.type`,value:n.type,valueSpec:o.layer.type,style:t.style,styleSpec:t.styleSpec,object:n,objectKey:"type"}),filter:Rr,layout:t=>mr({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":t=>Nr(Ut({layerType:s},t))}}),paint:t=>mr({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":t=>Dr(Ut({layerType:s},t))}})}})),e}function Br(t){const e=t.value,n=t.key,r=Jn(e);return"string"!==r?[new zt(n,e,`string expected, ${r} found`)]:[]}const zr={promoteId:function({key:t,value:e}){if("string"===Jn(e))return Br({key:t,value:e});{const n=[];for(const r in e)n.push(...Br({key:`${t}.${r}`,value:e[r]}));return n}}};function jr(t){const e=t.value,n=t.key,r=t.styleSpec,i=t.style;if(!e.type)return[new zt(n,e,'"type" is required')];const o=Vt(e.type);let s;switch(o){case"vector":case"raster":case"raster-dem":return s=mr({key:n,value:e,valueSpec:r[`source_${o.replace("-","_")}`],style:t.style,styleSpec:r,objectElementValidators:zr}),s;case"geojson":if(s=mr({key:n,value:e,valueSpec:r.source_geojson,style:i,styleSpec:r,objectElementValidators:zr}),e.cluster)for(const t in e.clusterProperties){const[r,i]=e.clusterProperties[t],o="string"==typeof r?[r,["accumulated"],["get",t]]:r;s.push(...vr({key:`${n}.${t}.map`,value:i,expressionContext:"cluster-map"})),s.push(...vr({key:`${n}.${t}.reduce`,value:o,expressionContext:"cluster-reduce"}))}return s;case"video":return mr({key:n,value:e,valueSpec:r.source_video,style:i,styleSpec:r});case"image":return mr({key:n,value:e,valueSpec:r.source_image,style:i,styleSpec:r});case"canvas":return[new zt(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return br({key:`${n}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:i,styleSpec:r})}}function Ur(t){const e=t.value,n=t.styleSpec,r=n.light,i=t.style;let o=[];const s=Jn(e);if(void 0===e)return o;if("object"!==s)return o=o.concat([new zt("light",e,`object expected, ${s} found`)]),o;for(const t in e){const s=t.match(/^(.*)-transition$/);o=o.concat(s&&r[s[1]]&&r[s[1]].transition?qr({key:t,value:e[t],valueSpec:n.transition,style:i,styleSpec:n}):r[t]?qr({key:t,value:e[t],valueSpec:r[t],style:i,styleSpec:n}):[new zt(t,e[t],`unknown property "${t}"`)])}return o}function Vr(t){const e=t.value,n=t.key,r=t.style,i=t.styleSpec,o=i.terrain;let s=[];const a=Jn(e);if(void 0===e)return s;if("object"!==a)return s=s.concat([new zt("terrain",e,`object expected, ${a} found`)]),s;for(const t in e){const n=t.match(/^(.*)-transition$/);s=s.concat(n&&o[n[1]]&&o[n[1]].transition?qr({key:t,value:e[t],valueSpec:i.transition,style:r,styleSpec:i}):o[t]?qr({key:t,value:e[t],valueSpec:o[t],style:r,styleSpec:i}):[new zt(t,e[t],`unknown property "${t}"`)])}if(e.source){const t=r.sources&&r.sources[e.source],i=t&&Vt(t.type);t?"raster-dem"!==i&&s.push(new zt(n,e.source,`terrain cannot be used with a source of type ${i}, it only be used with a "raster-dem" source type`)):s.push(new zt(n,e.source,`source "${e.source}" not found`))}else s.push(new zt(n,e,'terrain is missing required property "source"'));return s}function Gr(t){const e=t.value,n=t.style,r=t.styleSpec,i=r.fog;let o=[];const s=Jn(e);if(void 0===e)return o;if("object"!==s)return o=o.concat([new zt("fog",e,`object expected, ${s} found`)]),o;for(const t in e){const s=t.match(/^(.*)-transition$/);o=o.concat(s&&i[s[1]]&&i[s[1]].transition?qr({key:t,value:e[t],valueSpec:r.transition,style:n,styleSpec:r}):i[t]?qr({key:t,value:e[t],valueSpec:i[t],style:n,styleSpec:r}):[new zt(t,e[t],`unknown property "${t}"`)])}return o}const Zr={"*":()=>[],array:Ar,boolean:function(t){const e=t.value,n=t.key,r=Jn(e);return"boolean"!==r?[new zt(n,e,`boolean expected, ${r} found`)]:[]},number:yr,color:function(t){const e=t.key,n=t.value,r=Jn(n);return"string"!==r?[new zt(e,n,`color expected, ${r} found`)]:null===ue.parseCSSColor(n)?[new zt(e,n,`color expected, "${n}" found`)]:[]},constants:jt,enum:br,filter:Rr,function:_r,layer:Fr,object:mr,source:jr,light:Ur,terrain:Vr,fog:Gr,string:Br,formatted:function(t){return 0===Br(t).length?[]:vr(t)},resolvedImage:function(t){return 0===Br(t).length?[]:vr(t)}};function qr(t){const e=t.value,n=t.valueSpec,r=t.styleSpec;return n.expression&&tr(Vt(e))?_r(t):n.expression&&ur(Gt(e))?vr(t):n.type&&Zr[n.type]?Zr[n.type](t):mr(Ut({},t,{valueSpec:n.type?r[n.type]:n}))}function Wr(t){const e=t.value,n=t.key,r=Br(t);return r.length||(-1===e.indexOf("{fontstack}")&&r.push(new zt(n,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&r.push(new zt(n,e,'"glyphs" url must include a "{range}" token'))),r}function Hr(t,e=Bt){let n=[];return n=n.concat(qr({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:Wr,"*":()=>[]}})),t.constants&&(n=n.concat(jt({key:"constants",value:t.constants,style:t,styleSpec:e}))),Xr(n)}function Xr(t){return[].concat(t).sort(((t,e)=>t.line-e.line))}function $r(t){return function(...e){return Xr(t.apply(this,e))}}Hr.source=$r(jr),Hr.light=$r(Ur),Hr.terrain=$r(Vr),Hr.fog=$r(Gr),Hr.layer=$r(Fr),Hr.filter=$r(Rr),Hr.paintProperty=$r(Dr),Hr.layoutProperty=$r(Nr);const Yr=Hr,Qr=Yr.light,Kr=Yr.fog,Jr=Yr.paintProperty,ti=Yr.layoutProperty;function ei(t,e){let n=!1;if(e&&e.length)for(const r of e)t.fire(new Nt(new Error(r.message))),n=!0;return n}var ni=ri;function ri(t,e,n){var r=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var i=new Int32Array(this.arrayBuffer);t=i[0],this.d=(e=i[1])+2*(n=i[2]);for(var o=0;o<this.d*this.d;o++){var s=i[3+o],a=i[3+o+1];r.push(s===a?null:i.subarray(s,a))}var l=i[3+r.length+1];this.keys=i.subarray(i[3+r.length],l),this.bboxes=i.subarray(l),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var u=0;u<this.d*this.d;u++)r.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;var c=n/e*t;this.min=-c,this.max=t+c}ri.prototype.insert=function(t,e,n,r,i){this._forEachCell(e,n,r,i,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(i)},ri.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},ri.prototype._insertCell=function(t,e,n,r,i,o){this.cells[i].push(o)},ri.prototype.query=function(t,e,n,r,i){var o=this.min,s=this.max;if(t<=o&&e<=o&&s<=n&&s<=r&&!i)return Array.prototype.slice.call(this.keys);var a=[];return this._forEachCell(t,e,n,r,this._queryCell,a,{},i),a},ri.prototype._queryCell=function(t,e,n,r,i,o,s,a){var l=this.cells[i];if(null!==l)for(var u=this.keys,c=this.bboxes,h=0;h<l.length;h++){var p=l[h];if(void 0===s[p]){var f=4*p;(a?a(c[f+0],c[f+1],c[f+2],c[f+3]):t<=c[f+2]&&e<=c[f+3]&&n>=c[f+0]&&r>=c[f+1])?(s[p]=!0,o.push(u[p])):s[p]=!1}}},ri.prototype._forEachCell=function(t,e,n,r,i,o,s,a){for(var l=this._convertToCellCoord(t),u=this._convertToCellCoord(e),c=this._convertToCellCoord(n),h=this._convertToCellCoord(r),p=l;p<=c;p++)for(var f=u;f<=h;f++){var d=this.d*f+p;if((!a||a(this._convertFromCellCoord(p),this._convertFromCellCoord(f),this._convertFromCellCoord(p+1),this._convertFromCellCoord(f+1)))&&i.call(this,t,e,n,r,d,o,s,a))return}},ri.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},ri.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},ri.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=3+this.cells.length+1+1,n=0,r=0;r<this.cells.length;r++)n+=this.cells[r].length;var i=new Int32Array(e+n+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;for(var o=e,s=0;s<t.length;s++){var a=t[s];i[3+s]=o,i.set(a,o),o+=a.length}return i[3+t.length]=o,i.set(this.keys,o),i[3+t.length+1]=o+=this.keys.length,i.set(this.bboxes,o),o+=this.bboxes.length,i.buffer};const{ImageData:ii,ImageBitmap:oi}=s,si={};function ai(t,e,n={}){Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),si[t]={klass:e,omit:n.omit||[],shallow:n.shallow||[]}}ai("Object",Object),ni.serialize=function(t,e){const n=t.toArrayBuffer();return e&&e.push(n),{buffer:n}},ni.deserialize=function(t){return new ni(t.buffer)},ai("Grid",ni),ai("Color",ce),ai("Error",Error),ai("ResolvedImage",de),ai("StylePropertyFunction",dr),ai("StyleExpression",lr,{omit:["_evaluator"]}),ai("ZoomDependentExpression",pr),ai("ZoomConstantExpression",hr),ai("CompoundExpression",Ce,{omit:["_evaluate"]});for(const t in Gn)Gn[t]._classRegistryKey||ai(`Expression_${t}`,Gn[t]);function li(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function ui(t){return oi&&t instanceof oi}function ci(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(li(t)||ui(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){const n=t;return e&&e.push(n.buffer),n}if(t instanceof ii)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){const n=[];for(const r of t)n.push(ci(r,e));return n}if("object"==typeof t){const n=t.constructor,r=n._classRegistryKey;if(!r)throw new Error("can't serialize object of unregistered class");const i=n.serialize?n.serialize(t,e):{};if(!n.serialize){for(const n in t){if(!t.hasOwnProperty(n))continue;if(si[r].omit.indexOf(n)>=0)continue;const o=t[n];i[n]=si[r].shallow.indexOf(n)>=0?o:ci(o,e)}t instanceof Error&&(i.message=t.message)}if(i.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==r&&(i.$name=r),i}throw new Error("can't serialize object of type "+typeof t)}function hi(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||li(t)||ui(t)||ArrayBuffer.isView(t)||t instanceof ii)return t;if(Array.isArray(t))return t.map(hi);if("object"==typeof t){const e=t.$name||"Object",{klass:n}=si[e];if(!n)throw new Error(`can't deserialize unregistered class ${e}`);if(n.deserialize)return n.deserialize(t);const r=Object.create(n.prototype);for(const n of Object.keys(t)){if("$name"===n)continue;const i=t[n];r[n]=si[e].shallow.indexOf(n)>=0?i:hi(i)}return r}throw new Error("can't deserialize object of type "+typeof t)}class pi{constructor(){this.first=!0}update(t,e){const n=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=n,!0))}}const fi=t=>t>=1536&&t<=1791,di=t=>t>=1872&&t<=1919,gi=t=>t>=2208&&t<=2303,mi=t=>t>=11904&&t<=12031,Ai=t=>t>=12032&&t<=12255,yi=t=>t>=12272&&t<=12287,_i=t=>t>=12288&&t<=12351,vi=t=>t>=12352&&t<=12447,bi=t=>t>=12448&&t<=12543,xi=t=>t>=12544&&t<=12591,wi=t=>t>=12704&&t<=12735,Ei=t=>t>=12736&&t<=12783,Si=t=>t>=12784&&t<=12799,Ti=t=>t>=12800&&t<=13055,Pi=t=>t>=13056&&t<=13311,Mi=t=>t>=13312&&t<=19903,Ci=t=>t>=19968&&t<=40959,Ii=t=>t>=40960&&t<=42127,Oi=t=>t>=42128&&t<=42191,Ri=t=>t>=44032&&t<=55215,Li=t=>t>=63744&&t<=64255,ki=t=>t>=64336&&t<=65023,Di=t=>t>=65040&&t<=65055,Ni=t=>t>=65072&&t<=65103,Fi=t=>t>=65104&&t<=65135,Bi=t=>t>=65136&&t<=65279,zi=t=>t>=65280&&t<=65519;function ji(t){for(const e of t)if(Gi(e.charCodeAt(0)))return!0;return!1}function Ui(t){for(const e of t)if(!Vi(e.charCodeAt(0)))return!1;return!0}function Vi(t){return!(fi(t)||di(t)||gi(t)||ki(t)||Bi(t))}function Gi(t){return!(746!==t&&747!==t&&(t<4352||!(wi(t)||xi(t)||Ni(t)&&!(t>=65097&&t<=65103)||Li(t)||Pi(t)||mi(t)||Ei(t)||!(!_i(t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||Mi(t)||Ci(t)||Ti(t)||(t=>t>=12592&&t<=12687)(t)||(t=>t>=43360&&t<=43391)(t)||(t=>t>=55216&&t<=55295)(t)||(t=>t>=4352&&t<=4607)(t)||Ri(t)||vi(t)||yi(t)||(t=>t>=12688&&t<=12703)(t)||Ai(t)||Si(t)||bi(t)&&12540!==t||!(!zi(t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!Fi(t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||(t=>t>=5120&&t<=5759)(t)||(t=>t>=6320&&t<=6399)(t)||Di(t)||(t=>t>=19904&&t<=19967)(t)||Ii(t)||Oi(t))))}function Zi(t){return!(Gi(t)||function(t){return!!((t=>t>=128&&t<=255)(t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||(t=>t>=8192&&t<=8303)(t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||(t=>t>=8448&&t<=8527)(t)||(t=>t>=8528&&t<=8591)(t)||(t=>t>=8960&&t<=9215)(t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||(t=>t>=9216&&t<=9279)(t)&&9251!==t||(t=>t>=9280&&t<=9311)(t)||(t=>t>=9312&&t<=9471)(t)||(t=>t>=9632&&t<=9727)(t)||(t=>t>=9728&&t<=9983)(t)&&!(t>=9754&&t<=9759)||(t=>t>=11008&&t<=11263)(t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||_i(t)||bi(t)||(t=>t>=57344&&t<=63743)(t)||Ni(t)||Fi(t)||zi(t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)}(t))}function qi(t){return t>=1424&&t<=2303||ki(t)||Bi(t)}function Wi(t,e){return!(!e&&qi(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||(t=>t>=6016&&t<=6143)(t))}function Hi(t){for(const e of t)if(qi(e.charCodeAt(0)))return!0;return!1}const Xi="deferred",$i="loading",Yi="loaded";let Qi=null,Ki="unavailable",Ji=null;const to=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(Ki="error"),Qi&&Qi(t)};function eo(){no.fire(new Dt("pluginStateChange",{pluginStatus:Ki,pluginURL:Ji}))}const no=new Ft,ro=function(){return Ki},io=function(){if(Ki!==Xi||!Ji)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ki=$i,eo(),Ji&&St({url:Ji},(t=>{t?to(t):(Ki=Yi,eo())}))},oo={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Ki===Yi||null!=oo.applyArabicShaping,isLoading:()=>Ki===$i,setState(t){Ki=t.pluginStatus,Ji=t.pluginURL},isParsed:()=>null!=oo.applyArabicShaping&&null!=oo.processBidirectionalText&&null!=oo.processStyledBidirectionalText,getPluginURL:()=>Ji};class so{constructor(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new pi,this.transition={})}isSupportedScript(t){return function(t,e){for(const n of t)if(!Wi(n.charCodeAt(0),e))return!1;return!0}(t,oo.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,e=t-Math.floor(t),n=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*n}:{fromScale:.5,toScale:1,t:1-(1-n)*e}}}class ao{constructor(t,e){this.property=t,this.value=e,this.expression=function(t,e){if(tr(t))return new dr(t,e);if(ur(t)){const n=fr(t,e);if("error"===n.result)throw new Error(n.value.map((t=>`${t.key}: ${t.message}`)).join(", "));return n.value}{let n=t;return"string"==typeof t&&"color"===e.type&&(n=ce.parse(t)),{kind:"constant",evaluate:()=>n}}}(void 0===e?t.specification.default:e,t.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(t,e,n){return this.property.possiblyEvaluate(this,t,e,n)}}class lo{constructor(t){this.property=t,this.value=new ao(t,void 0)}transitioned(t,e){return new co(this.property,this.value,e,_({},t.transition,this.transition),t.now)}untransitioned(){return new co(this.property,this.value,null,{},0)}}class uo{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return C(this._values[t].value.value)}setValue(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new lo(this._values[t].property)),this._values[t].value=new ao(this._values[t].property,null===e?void 0:C(e))}getTransition(t){return C(this._values[t].transition)}setTransition(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new lo(this._values[t].property)),this._values[t].transition=C(e)||void 0}serialize(){const t={};for(const e of Object.keys(this._values)){const n=this.getValue(e);void 0!==n&&(t[e]=n);const r=this.getTransition(e);void 0!==r&&(t[`${e}-transition`]=r)}return t}transitioned(t,e){const n=new ho(this._properties);for(const r of Object.keys(this._values))n._values[r]=this._values[r].transitioned(t,e._values[r]);return n}untransitioned(){const t=new ho(this._properties);for(const e of Object.keys(this._values))t._values[e]=this._values[e].untransitioned();return t}}class co{constructor(t,e,n,r,i){const o=r.delay||0,s=r.duration||0;i=i||0,this.property=t,this.value=e,this.begin=i+o,this.end=this.begin+s,t.specification.transition&&(r.delay||r.duration)&&(this.prior=n)}possiblyEvaluate(t,e,n){const r=t.now||0,i=this.value.possiblyEvaluate(t,e,n),o=this.prior;if(o){if(r>this.end)return this.prior=null,i;if(this.value.isDataDriven())return this.prior=null,i;if(r<this.begin)return o.possiblyEvaluate(t,e,n);{const s=(r-this.begin)/(this.end-this.begin);return this.property.interpolate(o.possiblyEvaluate(t,e,n),i,p(s))}}return i}}class ho{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,e,n){const r=new go(this._properties);for(const i of Object.keys(this._values))r._values[i]=this._values[i].possiblyEvaluate(t,e,n);return r}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class po{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}getValue(t){return C(this._values[t].value)}setValue(t,e){this._values[t]=new ao(this._values[t].property,null===e?void 0:C(e))}serialize(){const t={};for(const e of Object.keys(this._values)){const n=this.getValue(e);void 0!==n&&(t[e]=n)}return t}possiblyEvaluate(t,e,n){const r=new go(this._properties);for(const i of Object.keys(this._values))r._values[i]=this._values[i].possiblyEvaluate(t,e,n);return r}}class fo{constructor(t,e,n){this.property=t,this.value=e,this.parameters=n}isConstant(){return"constant"===this.value.kind}constantOr(t){return"constant"===this.value.kind?this.value.value:t}evaluate(t,e,n,r){return this.property.evaluate(this.value,this.parameters,t,e,n,r)}}class go{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class mo{constructor(t){this.specification=t}possiblyEvaluate(t,e){return t.expression.evaluate(e)}interpolate(t,e,n){const r=rn[this.specification.type];return r?r(t,e,n):t}}class Ao{constructor(t,e){this.specification=t,this.overrides=e}possiblyEvaluate(t,e,n,r){return new fo(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(e,null,{},n,r)}:t.expression,e)}interpolate(t,e,n){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new fo(this,{kind:"constant",value:void 0},t.parameters);const r=rn[this.specification.type];return r?new fo(this,{kind:"constant",value:r(t.value.value,e.value.value,n)},t.parameters):t}evaluate(t,e,n,r,i,o){return"constant"===t.kind?t.value:t.evaluate(e,n,r,i,o)}}class yo extends Ao{possiblyEvaluate(t,e,n,r){if(void 0===t.value)return new fo(this,{kind:"constant",value:void 0},e);if("constant"===t.expression.kind){const i=t.expression.evaluate(e,null,{},n,r),o="resolvedImage"===t.property.specification.type&&"string"!=typeof i?i.name:i,s=this._calculate(o,o,o,e);return new fo(this,{kind:"constant",value:s},e)}if("camera"===t.expression.kind){const n=this._calculate(t.expression.evaluate({zoom:e.zoom-1}),t.expression.evaluate({zoom:e.zoom}),t.expression.evaluate({zoom:e.zoom+1}),e);return new fo(this,{kind:"constant",value:n},e)}return new fo(this,t.expression,e)}evaluate(t,e,n,r,i,o){if("source"===t.kind){const s=t.evaluate(e,n,r,i,o);return this._calculate(s,s,s,e)}return"composite"===t.kind?this._calculate(t.evaluate({zoom:Math.floor(e.zoom)-1},n,r),t.evaluate({zoom:Math.floor(e.zoom)},n,r),t.evaluate({zoom:Math.floor(e.zoom)+1},n,r),e):t.value}_calculate(t,e,n,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:t,to:e,other:n}:{from:n,to:e,other:t}}interpolate(t){return t}}class _o{constructor(t){this.specification=t}possiblyEvaluate(t,e,n,r){if(void 0!==t.value){if("constant"===t.expression.kind){const i=t.expression.evaluate(e,null,{},n,r);return this._calculate(i,i,i,e)}return this._calculate(t.expression.evaluate(new so(Math.floor(e.zoom-1),e)),t.expression.evaluate(new so(Math.floor(e.zoom),e)),t.expression.evaluate(new so(Math.floor(e.zoom+1),e)),e)}}_calculate(t,e,n,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:n,to:e}}interpolate(t){return t}}class vo{constructor(t){this.specification=t}possiblyEvaluate(t,e,n,r){return!!t.expression.evaluate(e,null,{},n,r)}interpolate(){return!1}}class bo{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const e in t){const n=t[e];n.specification.overridable&&this.overridableProperties.push(e);const r=this.defaultPropertyValues[e]=new ao(n,void 0),i=this.defaultTransitionablePropertyValues[e]=new lo(n);this.defaultTransitioningPropertyValues[e]=i.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=r.possiblyEvaluate({})}}}function xo(t,e){return 256*(t=g(Math.floor(t),0,255))+g(Math.floor(e),0,255)}ai("DataDrivenProperty",Ao),ai("DataConstantProperty",mo),ai("CrossFadedDataDrivenProperty",yo),ai("CrossFadedProperty",_o),ai("ColorRampProperty",vo);const wo={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Eo{constructor(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class So{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function To(t,e=1){let n=0,r=0;return{members:t.map((t=>{const i=wo[t.type].BYTES_PER_ELEMENT,o=n=Po(n,Math.max(e,i)),s=t.components||1;return r=Math.max(r,i),n+=i*s,{name:t.name,type:t.type,components:s,offset:o}})),size:Po(n,Math.max(r,e)),alignment:e}}function Po(t,e){return Math.ceil(t/e)*e}class Mo extends So{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e){const n=this.length;return this.resize(n+1),this.emplace(n,t,e)}emplace(t,e,n){const r=2*t;return this.int16[r+0]=e,this.int16[r+1]=n,t}}Mo.prototype.bytesPerElement=4,ai("StructArrayLayout2i4",Mo);class Co extends So{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,r){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n,r)}emplace(t,e,n,r,i){const o=4*t;return this.int16[o+0]=e,this.int16[o+1]=n,this.int16[o+2]=r,this.int16[o+3]=i,t}}Co.prototype.bytesPerElement=8,ai("StructArrayLayout4i8",Co);class Io extends So{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,r,i,o,s){const a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,r,i,o,s)}emplace(t,e,n,r,i,o,s,a){const l=6*t,u=12*t,c=3*t;return this.int16[l+0]=e,this.int16[l+1]=n,this.uint8[u+4]=r,this.uint8[u+5]=i,this.uint8[u+6]=o,this.uint8[u+7]=s,this.float32[c+2]=a,t}}Io.prototype.bytesPerElement=12,ai("StructArrayLayout2i4ub1f12",Io);class Oo extends So{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)}emplace(t,e,n,r){const i=3*t;return this.float32[i+0]=e,this.float32[i+1]=n,this.float32[i+2]=r,t}}Oo.prototype.bytesPerElement=12,ai("StructArrayLayout3f12",Oo);class Ro extends So{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,r,i,o,s,a,l,u){const c=this.length;return this.resize(c+1),this.emplace(c,t,e,n,r,i,o,s,a,l,u)}emplace(t,e,n,r,i,o,s,a,l,u,c){const h=10*t;return this.uint16[h+0]=e,this.uint16[h+1]=n,this.uint16[h+2]=r,this.uint16[h+3]=i,this.uint16[h+4]=o,this.uint16[h+5]=s,this.uint16[h+6]=a,this.uint16[h+7]=l,this.uint16[h+8]=u,this.uint16[h+9]=c,t}}Ro.prototype.bytesPerElement=20,ai("StructArrayLayout10ui20",Ro);class Lo extends So{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,r,i,o,s,a){const l=this.length;return this.resize(l+1),this.emplace(l,t,e,n,r,i,o,s,a)}emplace(t,e,n,r,i,o,s,a,l){const u=8*t;return this.uint16[u+0]=e,this.uint16[u+1]=n,this.uint16[u+2]=r,this.uint16[u+3]=i,this.uint16[u+4]=o,this.uint16[u+5]=s,this.uint16[u+6]=a,this.uint16[u+7]=l,t}}Lo.prototype.bytesPerElement=16,ai("StructArrayLayout8ui16",Lo);class ko extends So{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,r,i,o,s,a,l,u,c,h,p,f,d,g){const m=this.length;return this.resize(m+1),this.emplace(m,t,e,n,r,i,o,s,a,l,u,c,h,p,f,d,g)}emplace(t,e,n,r,i,o,s,a,l,u,c,h,p,f,d,g,m){const A=16*t;return this.int16[A+0]=e,this.int16[A+1]=n,this.int16[A+2]=r,this.int16[A+3]=i,this.uint16[A+4]=o,this.uint16[A+5]=s,this.uint16[A+6]=a,this.uint16[A+7]=l,this.int16[A+8]=u,this.int16[A+9]=c,this.int16[A+10]=h,this.int16[A+11]=p,this.int16[A+12]=f,this.int16[A+13]=d,this.int16[A+14]=g,this.int16[A+15]=m,t}}ko.prototype.bytesPerElement=32,ai("StructArrayLayout4i4ui4i4i32",ko);class Do extends So{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint32[1*t+0]=e,t}}Do.prototype.bytesPerElement=4,ai("StructArrayLayout1ul4",Do);class No extends So{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,r,i,o,s,a,l,u,c,h,p){const f=this.length;return this.resize(f+1),this.emplace(f,t,e,n,r,i,o,s,a,l,u,c,h,p)}emplace(t,e,n,r,i,o,s,a,l,u,c,h,p,f){const d=20*t,g=10*t;return this.int16[d+0]=e,this.int16[d+1]=n,this.int16[d+2]=r,this.int16[d+3]=i,this.int16[d+4]=o,this.float32[g+3]=s,this.float32[g+4]=a,this.float32[g+5]=l,this.float32[g+6]=u,this.int16[d+14]=c,this.uint32[g+8]=h,this.uint16[d+18]=p,this.uint16[d+19]=f,t}}No.prototype.bytesPerElement=40,ai("StructArrayLayout5i4f1i1ul2ui40",No);class Fo extends So{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,r,i,o,s){const a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,r,i,o,s)}emplace(t,e,n,r,i,o,s,a){const l=8*t;return this.int16[l+0]=e,this.int16[l+1]=n,this.int16[l+2]=r,this.int16[l+4]=i,this.int16[l+5]=o,this.int16[l+6]=s,this.int16[l+7]=a,t}}Fo.prototype.bytesPerElement=16,ai("StructArrayLayout3i2i2i16",Fo);class Bo extends So{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,r,i){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,n,r,i)}emplace(t,e,n,r,i,o){const s=4*t,a=8*t;return this.float32[s+0]=e,this.float32[s+1]=n,this.float32[s+2]=r,this.int16[a+6]=i,this.int16[a+7]=o,t}}Bo.prototype.bytesPerElement=16,ai("StructArrayLayout2f1f2i16",Bo);class zo extends So{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,r){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n,r)}emplace(t,e,n,r,i){const o=12*t,s=3*t;return this.uint8[o+0]=e,this.uint8[o+1]=n,this.float32[s+1]=r,this.float32[s+2]=i,t}}zo.prototype.bytesPerElement=12,ai("StructArrayLayout2ub2f12",zo);class jo extends So{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)}emplace(t,e,n,r){const i=3*t;return this.uint16[i+0]=e,this.uint16[i+1]=n,this.uint16[i+2]=r,t}}jo.prototype.bytesPerElement=6,ai("StructArrayLayout3ui6",jo);class Uo extends So{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,e,n,r,i,o,s,a,l,u,c,h,p,f,d,g,m,A,y,_,v){const b=this.length;return this.resize(b+1),this.emplace(b,t,e,n,r,i,o,s,a,l,u,c,h,p,f,d,g,m,A,y,_,v)}emplace(t,e,n,r,i,o,s,a,l,u,c,h,p,f,d,g,m,A,y,_,v,b){const x=30*t,w=15*t,E=60*t;return this.int16[x+0]=e,this.int16[x+1]=n,this.int16[x+2]=r,this.float32[w+2]=i,this.float32[w+3]=o,this.uint16[x+8]=s,this.uint16[x+9]=a,this.uint32[w+5]=l,this.uint32[w+6]=u,this.uint32[w+7]=c,this.uint16[x+16]=h,this.uint16[x+17]=p,this.uint16[x+18]=f,this.float32[w+10]=d,this.float32[w+11]=g,this.uint8[E+48]=m,this.uint8[E+49]=A,this.uint8[E+50]=y,this.uint32[w+13]=_,this.int16[x+28]=v,this.uint8[E+58]=b,t}}Uo.prototype.bytesPerElement=60,ai("StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60",Uo);class Vo extends So{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,e,n,r,i,o,s,a,l,u,c,h,p,f,d,g,m,A,y,_,v,b,x,w,E,S,T,P,M,C){const I=this.length;return this.resize(I+1),this.emplace(I,t,e,n,r,i,o,s,a,l,u,c,h,p,f,d,g,m,A,y,_,v,b,x,w,E,S,T,P,M,C)}emplace(t,e,n,r,i,o,s,a,l,u,c,h,p,f,d,g,m,A,y,_,v,b,x,w,E,S,T,P,M,C,I){const O=38*t,R=19*t;return this.int16[O+0]=e,this.int16[O+1]=n,this.int16[O+2]=r,this.float32[R+2]=i,this.float32[R+3]=o,this.int16[O+8]=s,this.int16[O+9]=a,this.int16[O+10]=l,this.int16[O+11]=u,this.int16[O+12]=c,this.int16[O+13]=h,this.uint16[O+14]=p,this.uint16[O+15]=f,this.uint16[O+16]=d,this.uint16[O+17]=g,this.uint16[O+18]=m,this.uint16[O+19]=A,this.uint16[O+20]=y,this.uint16[O+21]=_,this.uint16[O+22]=v,this.uint16[O+23]=b,this.uint16[O+24]=x,this.uint16[O+25]=w,this.uint16[O+26]=E,this.uint16[O+27]=S,this.uint16[O+28]=T,this.uint32[R+15]=P,this.float32[R+16]=M,this.float32[R+17]=C,this.float32[R+18]=I,t}}Vo.prototype.bytesPerElement=76,ai("StructArrayLayout3i2f6i15ui1ul3f76",Vo);class Go extends So{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.float32[1*t+0]=e,t}}Go.prototype.bytesPerElement=4,ai("StructArrayLayout1f4",Go);class Zo extends So{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)}emplace(t,e,n,r){const i=3*t;return this.int16[i+0]=e,this.int16[i+1]=n,this.int16[i+2]=r,t}}Zo.prototype.bytesPerElement=6,ai("StructArrayLayout3i6",Zo);class qo extends So{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,r){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n,r)}emplace(t,e,n,r,i){const o=6*t;return this.uint32[3*t+0]=e,this.uint16[o+2]=n,this.uint16[o+3]=r,this.uint16[o+4]=i,t}}qo.prototype.bytesPerElement=12,ai("StructArrayLayout1ul3ui12",qo);class Wo extends So{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e){const n=this.length;return this.resize(n+1),this.emplace(n,t,e)}emplace(t,e,n){const r=2*t;return this.uint16[r+0]=e,this.uint16[r+1]=n,t}}Wo.prototype.bytesPerElement=4,ai("StructArrayLayout2ui4",Wo);class Ho extends So{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint16[1*t+0]=e,t}}Ho.prototype.bytesPerElement=2,ai("StructArrayLayout1ui2",Ho);class Xo extends So{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,r,i){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,n,r,i)}emplace(t,e,n,r,i,o){const s=5*t;return this.float32[s+0]=e,this.float32[s+1]=n,this.float32[s+2]=r,this.float32[s+3]=i,this.float32[s+4]=o,t}}Xo.prototype.bytesPerElement=20,ai("StructArrayLayout5f20",Xo);class $o extends So{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e){const n=this.length;return this.resize(n+1),this.emplace(n,t,e)}emplace(t,e,n){const r=2*t;return this.float32[r+0]=e,this.float32[r+1]=n,t}}$o.prototype.bytesPerElement=8,ai("StructArrayLayout2f8",$o);class Yo extends So{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,r){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n,r)}emplace(t,e,n,r,i){const o=4*t;return this.float32[o+0]=e,this.float32[o+1]=n,this.float32[o+2]=r,this.float32[o+3]=i,t}}Yo.prototype.bytesPerElement=16,ai("StructArrayLayout4f16",Yo);class Qo extends Eo{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Qo.prototype.size=40;class Ko extends No{get(t){return new Qo(this,t)}}ai("CollisionBoxArray",Ko);class Jo extends Eo{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}Jo.prototype.size=60;class ts extends Uo{get(t){return new Jo(this,t)}}ai("PlacedSymbolArray",ts);class es extends Eo{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(t){this._structArray.uint32[this._pos4+15]=t}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}es.prototype.size=76;class ns extends Vo{get(t){return new es(this,t)}}ai("SymbolInstanceArray",ns);class rs extends Go{getoffsetX(t){return this.float32[1*t+0]}}ai("GlyphOffsetArray",rs);class is extends Zo{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}ai("SymbolLineVertexArray",is);class os extends Eo{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}os.prototype.size=12;class ss extends qo{get(t){return new os(this,t)}}ai("FeatureIndexArray",ss);class as extends Eo{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}as.prototype.size=4;class ls extends Wo{get(t){return new as(this,t)}}ai("FillExtrusionCentroidArray",ls);const us=To([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),cs=To([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var hs=le((function(t){t.exports=function(t,e){var n,r,i,o,s,a,l,u;for(r=t.length-(n=3&t.length),i=e,s=3432918353,a=461845907,u=0;u<r;)l=255&t.charCodeAt(u)|(255&t.charCodeAt(++u))<<8|(255&t.charCodeAt(++u))<<16|(255&t.charCodeAt(++u))<<24,++u,i=27492+(65535&(o=5*(65535&(i=(i^=l=(65535&(l=(l=(65535&l)*s+(((l>>>16)*s&65535)<<16)&4294967295)<<15|l>>>17))*a+(((l>>>16)*a&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);switch(l=0,n){case 3:l^=(255&t.charCodeAt(u+2))<<16;case 2:l^=(255&t.charCodeAt(u+1))<<8;case 1:i^=l=(65535&(l=(l=(65535&(l^=255&t.charCodeAt(u)))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<15|l>>>17))*a+(((l>>>16)*a&65535)<<16)&4294967295}return i^=t.length,i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^=i>>>16)>>>0}})),ps=le((function(t){t.exports=function(t,e){for(var n,r=t.length,i=e^r,o=0;r>=4;)n=1540483477*(65535&(n=255&t.charCodeAt(o)|(255&t.charCodeAt(++o))<<8|(255&t.charCodeAt(++o))<<16|(255&t.charCodeAt(++o))<<24))+((1540483477*(n>>>16)&65535)<<16),i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),r-=4,++o;switch(r){case 3:i^=(255&t.charCodeAt(o+2))<<16;case 2:i^=(255&t.charCodeAt(o+1))<<8;case 1:i=1540483477*(65535&(i^=255&t.charCodeAt(o)))+((1540483477*(i>>>16)&65535)<<16)}return i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16),(i^=i>>>15)>>>0}})),fs=hs,ds=ps;fs.murmur3=hs,fs.murmur2=ds;class gs{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,e,n,r){this.ids.push(ms(t)),this.positions.push(e,n,r)}getPositions(t){const e=ms(t);let n=0,r=this.ids.length-1;for(;n<r;){const t=n+r>>1;this.ids[t]>=e?r=t:n=t+1}const i=[];for(;this.ids[n]===e;)i.push({index:this.positions[3*n],start:this.positions[3*n+1],end:this.positions[3*n+2]}),n++;return i}static serialize(t,e){const n=new Float64Array(t.ids),r=new Uint32Array(t.positions);return As(n,r,0,n.length-1),e&&e.push(n.buffer,r.buffer),{ids:n,positions:r}}static deserialize(t){const e=new gs;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e}}function ms(t){const e=+t;return!isNaN(e)&&e<=a?e:fs(String(t))}function As(t,e,n,r){for(;n<r;){const i=t[n+r>>1];let o=n-1,s=r+1;for(;;){do{o++}while(t[o]<i);do{s--}while(t[s]>i);if(o>=s)break;ys(t,o,s),ys(e,3*o,3*s),ys(e,3*o+1,3*s+1),ys(e,3*o+2,3*s+2)}s-n<r-s?(As(t,e,n,s),n=s+1):(As(t,e,s+1,r),r=s)}}function ys(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}ai("FeaturePositionMap",gs);class _s{constructor(t,e){this.gl=t.gl,this.location=e}}class vs extends _s{constructor(t,e){super(t,e),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class bs extends _s{constructor(t,e){super(t,e),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class xs extends _s{constructor(t,e){super(t,e),this.current=ce.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const ws=new Float32Array(16),Es=new Float32Array(9);function Ss(t){return[xo(255*t.r,255*t.g),xo(255*t.b,255*t.a)]}class Ts{constructor(t,e,n){this.value=t,this.uniformNames=e.map((t=>`u_${t}`)),this.type=n}setUniform(t,e,n){t.set(n.constantOr(this.value))}getBinding(t,e,n){return"color"===this.type?new xs(t,e):new vs(t,e)}}class Ps{constructor(t,e){this.uniformNames=e.map((t=>`u_${t}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,e){this.pixelRatioFrom=e.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=e.tl.concat(e.br),this.patternTo=t.tl.concat(t.br)}setUniform(t,e,n,r){const i="u_pattern_to"===r||"u_dash_to"===r?this.patternTo:"u_pattern_from"===r||"u_dash_from"===r?this.patternFrom:"u_pixel_ratio_to"===r?this.pixelRatioTo:"u_pixel_ratio_from"===r?this.pixelRatioFrom:null;i&&t.set(i)}getBinding(t,e,n){return"u_pattern_from"===n||"u_pattern_to"===n||"u_dash_from"===n||"u_dash_to"===n?new bs(t,e):new vs(t,e)}}class Ms{constructor(t,e,n,r){this.expression=t,this.type=n,this.maxValue=0,this.paintVertexAttributes=e.map((t=>({name:`a_${t}`,type:"Float32",components:"color"===n?2:1,offset:0}))),this.paintVertexArray=new r}populatePaintArray(t,e,n,r,i){const o=this.paintVertexArray.length,s=this.expression.evaluate(new so(0),e,{},r,[],i);this.paintVertexArray.resize(t),this._setPaintValue(o,t,s)}updatePaintArray(t,e,n,r){const i=this.expression.evaluate({zoom:0},n,r);this._setPaintValue(t,e,i)}_setPaintValue(t,e,n){if("color"===this.type){const r=Ss(n);for(let n=t;n<e;n++)this.paintVertexArray.emplace(n,r[0],r[1])}else{for(let r=t;r<e;r++)this.paintVertexArray.emplace(r,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Cs{constructor(t,e,n,r,i,o){this.expression=t,this.uniformNames=e.map((t=>`u_${t}_t`)),this.type=n,this.useIntegerZoom=r,this.zoom=i,this.maxValue=0,this.paintVertexAttributes=e.map((t=>({name:`a_${t}`,type:"Float32",components:"color"===n?4:2,offset:0}))),this.paintVertexArray=new o}populatePaintArray(t,e,n,r,i){const o=this.expression.evaluate(new so(this.zoom),e,{},r,[],i),s=this.expression.evaluate(new so(this.zoom+1),e,{},r,[],i),a=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(a,t,o,s)}updatePaintArray(t,e,n,r){const i=this.expression.evaluate({zoom:this.zoom},n,r),o=this.expression.evaluate({zoom:this.zoom+1},n,r);this._setPaintValue(t,e,i,o)}_setPaintValue(t,e,n,r){if("color"===this.type){const i=Ss(n),o=Ss(r);for(let n=t;n<e;n++)this.paintVertexArray.emplace(n,i[0],i[1],o[0],o[1])}else{for(let i=t;i<e;i++)this.paintVertexArray.emplace(i,n,r);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(r))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,e){const n=this.useIntegerZoom?Math.floor(e.zoom):e.zoom,r=g(this.expression.interpolationFactor(n,this.zoom,this.zoom+1),0,1);t.set(r)}getBinding(t,e,n){return new vs(t,e)}}class Is{constructor(t,e,n,r,i,o,s){this.expression=t,this.type=n,this.useIntegerZoom=r,this.zoom=i,this.layerId=s,this.paintVertexAttributes=("array"===n?cs:us).members;for(let t=0;t<e.length;++t);this.zoomInPaintVertexArray=new o,this.zoomOutPaintVertexArray=new o}populatePaintArray(t,e,n){const r=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(r,t,e.patterns&&e.patterns[this.layerId],n)}updatePaintArray(t,e,n,r,i){this._setPaintValues(t,e,n.patterns&&n.patterns[this.layerId],i)}_setPaintValues(t,e,n,r){if(!r||!n)return;const{min:i,mid:o,max:s}=n,a=r[i],l=r[o],u=r[s];if(a&&l&&u)for(let n=t;n<e;n++)this._setPaintValue(this.zoomInPaintVertexArray,n,l,a),this._setPaintValue(this.zoomOutPaintVertexArray,n,l,u)}_setPaintValue(t,e,n,r){t.emplace(e,n.tl[0],n.tl[1],n.br[0],n.br[1],r.tl[0],r.tl[1],r.br[0],r.br[1],n.pixelRatio,r.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Os{constructor(t,e,n=(()=>!0)){this.binders={},this._buffers=[];const r=[];for(const i in t.paint._values){if(!n(i))continue;const o=t.paint.get(i);if(!(o instanceof fo&&Yn(o.property.specification)))continue;const s=ks(i,t.type),a=o.value,l=o.property.specification.type,u=o.property.useIntegerZoom,c=o.property.specification["property-type"],h="cross-faded"===c||"cross-faded-data-driven"===c,p="line-dasharray"===String(i)&&"constant"!==t.layout.get("line-cap").value.kind;if("constant"!==a.kind||p)if("source"===a.kind||p||h){const n=Fs(i,l,"source");this.binders[i]=h?new Is(a,s,l,u,e,n,t.id):new Ms(a,s,l,n),r.push(`/a_${i}`)}else{const t=Fs(i,l,"composite");this.binders[i]=new Cs(a,s,l,u,e,t),r.push(`/z_${i}`)}else this.binders[i]=h?new Ps(a.value,s):new Ts(a.value,s,l),r.push(`/u_${i}`)}this.cacheKey=r.sort().join("")}getMaxValue(t){const e=this.binders[t];return e instanceof Ms||e instanceof Cs?e.maxValue:0}populatePaintArrays(t,e,n,r,i){for(const o in this.binders){const s=this.binders[o];(s instanceof Ms||s instanceof Cs||s instanceof Is)&&s.populatePaintArray(t,e,n,r,i)}}setConstantPatternPositions(t,e){for(const n in this.binders){const r=this.binders[n];r instanceof Ps&&r.setConstantPatternPositions(t,e)}}updatePaintArrays(t,e,n,r,i){let o=!1;for(const s in t){const a=e.getPositions(s);for(const e of a){const a=n.feature(e.index);for(const n in this.binders){const l=this.binders[n];if((l instanceof Ms||l instanceof Cs||l instanceof Is)&&!0===l.expression.isStateDependent){const u=r.paint.get(n);l.expression=u.value,l.updatePaintArray(e.start,e.end,a,t[s],i),o=!0}}}}return o}defines(){const t=[];for(const e in this.binders){const n=this.binders[e];(n instanceof Ts||n instanceof Ps)&&t.push(...n.uniformNames.map((t=>`#define HAS_UNIFORM_${t}`)))}return t}getBinderAttributes(){const t=[];for(const e in this.binders){const n=this.binders[e];if(n instanceof Ms||n instanceof Cs||n instanceof Is)for(let e=0;e<n.paintVertexAttributes.length;e++)t.push(n.paintVertexAttributes[e].name)}return t}getBinderUniforms(){const t=[];for(const e in this.binders){const n=this.binders[e];if(n instanceof Ts||n instanceof Ps||n instanceof Cs)for(const e of n.uniformNames)t.push(e)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,e){const n=[];for(const r in this.binders){const i=this.binders[r];if(i instanceof Ts||i instanceof Ps||i instanceof Cs)for(const o of i.uniformNames)if(e[o]){const s=i.getBinding(t,e[o],o);n.push({name:o,property:r,binding:s})}}return n}setUniforms(t,e,n,r){for(const{name:t,property:i,binding:o}of e)this.binders[i].setUniform(o,r,n.get(i),t)}updatePaintBuffers(t){this._buffers=[];for(const e in this.binders){const n=this.binders[e];if(t&&n instanceof Is){const e=2===t.fromScale?n.zoomInPaintVertexBuffer:n.zoomOutPaintVertexBuffer;e&&this._buffers.push(e)}else(n instanceof Ms||n instanceof Cs)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}}upload(t){for(const e in this.binders){const n=this.binders[e];(n instanceof Ms||n instanceof Cs||n instanceof Is)&&n.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const e=this.binders[t];(e instanceof Ms||e instanceof Cs||e instanceof Is)&&e.destroy()}}}class Rs{constructor(t,e,n=(()=>!0)){this.programConfigurations={};for(const r of t)this.programConfigurations[r.id]=new Os(r,e,n);this.needsUpload=!1,this._featureMap=new gs,this._bufferOffset=0}populatePaintArrays(t,e,n,r,i,o){for(const n in this.programConfigurations)this.programConfigurations[n].populatePaintArrays(t,e,r,i,o);void 0!==e.id&&this._featureMap.add(e.id,n,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,e,n,r){for(const i of n)this.needsUpload=this.programConfigurations[i.id].updatePaintArrays(t,this._featureMap,e,i,r)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const Ls={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function ks(t,e){return Ls[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}const Ds={"line-pattern":{source:Ro,composite:Ro},"fill-pattern":{source:Ro,composite:Ro},"fill-extrusion-pattern":{source:Ro,composite:Ro},"line-dasharray":{source:Lo,composite:Lo}},Ns={color:{source:$o,composite:Yo},number:{source:Go,composite:$o}};function Fs(t,e,n){const r=Ds[t];return r&&r[n]||Ns[e][n]}ai("ConstantBinder",Ts),ai("CrossFadedConstantBinder",Ps),ai("SourceExpressionBinder",Ms),ai("CrossFadedCompositeBinder",Is),ai("CompositeExpressionBinder",Cs),ai("ProgramConfiguration",Os,{omit:["_buffers"]}),ai("ProgramConfigurationSet",Rs);const Bs="-transition";class zs extends Ft{constructor(t,e){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==t.type&&(this.metadata=(t=t).metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,"background"!==t.type&&"sky"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),e.layout&&(this._unevaluatedLayout=new po(e.layout)),e.paint)){this._transitionablePaint=new uo(e.paint);for(const e in t.paint)this.setPaintProperty(e,t.paint[e],{validate:!1});for(const e in t.layout)this.setLayoutProperty(e,t.layout[e],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new go(e.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,e,n={}){null!=e&&this._validate(ti,`layers.${this.id}.layout.${t}`,t,e,n)||("visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility=e)}getPaintProperty(t){return T(t,Bs)?this._transitionablePaint.getTransition(t.slice(0,-Bs.length)):this._transitionablePaint.getValue(t)}setPaintProperty(t,e,n={}){if(null!=e&&this._validate(Jr,`layers.${this.id}.paint.${t}`,t,e,n))return!1;if(T(t,Bs))return this._transitionablePaint.setTransition(t.slice(0,-Bs.length),e||void 0),!1;{const n=this._transitionablePaint._values[t],r="cross-faded-data-driven"===n.property.specification["property-type"],i=n.value.isDataDriven(),o=n.value;this._transitionablePaint.setValue(t,e),this._handleSpecialPaintPropertyUpdate(t);const s=this._transitionablePaint._values[t].value;return s.isDataDriven()||i||r||this._handleOverridablePaintPropertyUpdate(t,o,s)}}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getProgramConfiguration(t){return null}_handleOverridablePaintPropertyUpdate(t,e,n){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,e){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,e)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,e)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),M(t,((t,e)=>!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)))}_validate(t,e,n,r,i={}){return(!i||!1!==i.validate)&&ei(this,t.call(Yr,{key:e,layerType:this.type,objectKey:n,value:r,styleSpec:Bt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const e=this.paint.get(t);if(e instanceof fo&&Yn(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1}}const js=To([{name:"a_pos",components:2,type:"Int16"}],4),{members:Us}=js;class Vs{constructor(t=[]){this.segments=t}prepareSegment(t,e,n,r){let i=this.segments[this.segments.length-1];return t>Vs.MAX_VERTEX_ARRAY_LENGTH&&O(`Max vertices per segment is ${Vs.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!i||i.vertexLength+t>Vs.MAX_VERTEX_ARRAY_LENGTH||i.sortKey!==r)&&(i={vertexOffset:e.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},void 0!==r&&(i.sortKey=r),this.segments.push(i)),i}get(){return this.segments}destroy(){for(const t of this.segments)for(const e in t.vaos)t.vaos[e].destroy()}static simpleSegment(t,e,n,r){return new Vs([{vertexOffset:t,primitiveOffset:e,vertexLength:n,primitiveLength:r,vaos:{},sortKey:0}])}}Vs.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ai("SegmentVector",Vs);var Gs=8192;const Zs=Math.pow(2,14)-1,qs=-Zs-1;function Ws(t){const e=Gs/t.extent,n=t.loadGeometry();for(let t=0;t<n.length;t++){const r=n[t];for(let t=0;t<r.length;t++){const n=r[t],i=Math.round(n.x*e),o=Math.round(n.y*e);n.x=g(i,qs,Zs),n.y=g(o,qs,Zs),(i<n.x||i>n.x+1||o<n.y||o>n.y+1)&&O("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return n}function Hs(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?Ws(t):[]}}function Xs(t,e,n,r,i){t.emplaceBack(2*e+(r+1)/2,2*n+(i+1)/2)}class $s{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Mo,this.indexArray=new jo,this.segments=new Vs,this.programConfigurations=new Rs(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,n){const r=this.layers[0],i=[];let o=null;"circle"===r.type&&(o=r.layout.get("circle-sort-key"));for(const{feature:e,id:r,index:s,sourceLayerIndex:a}of t){const t=this.layers[0]._featureFilter.needGeometry,l=Hs(e,t);if(!this.layers[0]._featureFilter.filter(new so(this.zoom),l,n))continue;const u=o?o.evaluate(l,{},n):void 0,c={id:r,properties:e.properties,type:e.type,sourceLayerIndex:a,index:s,geometry:t?l.geometry:Ws(e),patterns:{},sortKey:u};i.push(c)}o&&i.sort(((t,e)=>t.sortKey-e.sortKey));for(const r of i){const{geometry:i,index:o,sourceLayerIndex:s}=r,a=t[o].feature;this.addFeature(r,i,o,n),e.featureIndex.insert(a,i,o,s,this.index)}}update(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Us),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,e,n,r){for(const n of e)for(const e of n){const n=e.x,r=e.y;if(n<0||n>=Gs||r<0||r>=Gs)continue;const i=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),o=i.vertexLength;Xs(this.layoutVertexArray,n,r,-1,-1),Xs(this.layoutVertexArray,n,r,1,-1),Xs(this.layoutVertexArray,n,r,1,1),Xs(this.layoutVertexArray,n,r,-1,1),this.indexArray.emplaceBack(o,o+1,o+2),this.indexArray.emplaceBack(o,o+3,o+2),i.vertexLength+=4,i.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,{},r)}}function Ys(t,e){for(let n=0;n<t.length;n++)if(oa(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(oa(t,e[n]))return!0;return!!ta(t,e)}function Qs(t,e,n){return!!oa(t,e)||!!na(e,t,n)}function Ks(t,e){if(1===t.length)return ia(e,t[0]);for(let n=0;n<e.length;n++){const r=e[n];for(let e=0;e<r.length;e++)if(oa(t,r[e]))return!0}for(let n=0;n<t.length;n++)if(ia(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(ta(t,e[n]))return!0;return!1}function Js(t,e,n){if(t.length>1){if(ta(t,e))return!0;for(let r=0;r<e.length;r++)if(na(e[r],t,n))return!0}for(let r=0;r<t.length;r++)if(na(t[r],e,n))return!0;return!1}function ta(t,e){if(0===t.length||0===e.length)return!1;for(let n=0;n<t.length-1;n++){const r=t[n],i=t[n+1];for(let t=0;t<e.length-1;t++)if(ea(r,i,e[t],e[t+1]))return!0}return!1}function ea(t,e,n,r){return R(t,n,r)!==R(e,n,r)&&R(t,e,n)!==R(t,e,r)}function na(t,e,n){const r=n*n;if(1===e.length)return t.distSqr(e[0])<r;for(let n=1;n<e.length;n++)if(ra(t,e[n-1],e[n])<r)return!0;return!1}function ra(t,e,n){const r=e.distSqr(n);if(0===r)return t.distSqr(e);const i=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/r;return t.distSqr(i<0?e:i>1?n:n.sub(e)._mult(i)._add(e))}function ia(t,e){let n,r,i,o=!1;for(let s=0;s<t.length;s++){n=t[s];for(let t=0,s=n.length-1;t<n.length;s=t++)r=n[t],i=n[s],r.y>e.y!=i.y>e.y&&e.x<(i.x-r.x)*(e.y-r.y)/(i.y-r.y)+r.x&&(o=!o)}return o}function oa(t,e){let n=!1;for(let r=0,i=t.length-1;r<t.length;i=r++){const o=t[r],s=t[i];o.y>e.y!=s.y>e.y&&e.x<(s.x-o.x)*(e.y-o.y)/(s.y-o.y)+o.x&&(n=!n)}return n}function sa(t,e,n,r,o){for(const i of t)if(e<=i.x&&n<=i.y&&r>=i.x&&o>=i.y)return!0;const s=[new i(e,n),new i(e,o),new i(r,o),new i(r,n)];if(t.length>2)for(const e of s)if(oa(t,e))return!0;for(let e=0;e<t.length-1;e++)if(aa(t[e],t[e+1],s))return!0;return!1}function aa(t,e,n){const r=n[0],i=n[2];if(t.x<r.x&&e.x<r.x||t.x>i.x&&e.x>i.x||t.y<r.y&&e.y<r.y||t.y>i.y&&e.y>i.y)return!1;const o=R(t,e,n[0]);return o!==R(t,e,n[1])||o!==R(t,e,n[2])||o!==R(t,e,n[3])}function la(t,e,n){const r=e.paint.get(t).value;return"constant"===r.kind?r.value:n.programConfigurations.get(e.id).getMaxValue(t)}function ua(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function ca(t,e,n,r,o){if(!e[0]&&!e[1])return t;const s=i.convert(e)._mult(o);"viewport"===n&&s._rotate(-r);const a=[];for(let e=0;e<t.length;e++)a.push(t[e].sub(s));return a}function ha(t,e,n,r){const o=i.convert(t)._mult(r);return"viewport"===e&&o._rotate(-n),o}ai("CircleBucket",$s,{omit:["layers"]});const pa=new bo({"circle-sort-key":new Ao(Bt.layout_circle["circle-sort-key"])});var fa={paint:new bo({"circle-radius":new Ao(Bt.paint_circle["circle-radius"]),"circle-color":new Ao(Bt.paint_circle["circle-color"]),"circle-blur":new Ao(Bt.paint_circle["circle-blur"]),"circle-opacity":new Ao(Bt.paint_circle["circle-opacity"]),"circle-translate":new mo(Bt.paint_circle["circle-translate"]),"circle-translate-anchor":new mo(Bt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new mo(Bt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new mo(Bt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ao(Bt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ao(Bt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ao(Bt.paint_circle["circle-stroke-opacity"])}),layout:pa},da="undefined"!=typeof Float32Array?Float32Array:Array;function ga(){var t=new da(9);return da!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function ma(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Aa(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=e[9],f=e[10],d=e[11],g=e[12],m=e[13],A=e[14],y=e[15],_=n[0],v=n[1],b=n[2],x=n[3];return t[0]=_*r+v*a+b*h+x*g,t[1]=_*i+v*l+b*p+x*m,t[2]=_*o+v*u+b*f+x*A,t[3]=_*s+v*c+b*d+x*y,t[4]=(_=n[4])*r+(v=n[5])*a+(b=n[6])*h+(x=n[7])*g,t[5]=_*i+v*l+b*p+x*m,t[6]=_*o+v*u+b*f+x*A,t[7]=_*s+v*c+b*d+x*y,t[8]=(_=n[8])*r+(v=n[9])*a+(b=n[10])*h+(x=n[11])*g,t[9]=_*i+v*l+b*p+x*m,t[10]=_*o+v*u+b*f+x*A,t[11]=_*s+v*c+b*d+x*y,t[12]=(_=n[12])*r+(v=n[13])*a+(b=n[14])*h+(x=n[15])*g,t[13]=_*i+v*l+b*p+x*m,t[14]=_*o+v*u+b*f+x*A,t[15]=_*s+v*c+b*d+x*y,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var ya=Aa;function _a(){var t=new da(3);return da!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function va(t){return Math.hypot(t[0],t[1],t[2])}function ba(t,e,n){var r=new da(3);return r[0]=t,r[1]=e,r[2]=n,r}function xa(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function wa(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Ea(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function Sa(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function Ta(t,e,n){var r=n[0],i=n[1],o=n[2],s=e[0],a=e[1],l=e[2],u=i*l-o*a,c=o*s-r*l,h=r*a-i*s,p=i*h-o*c,f=o*u-r*h,d=r*c-i*u,g=2*n[3];return c*=g,h*=g,f*=2,d*=2,t[0]=s+(u*=g)+(p*=2),t[1]=a+c+f,t[2]=l+h+d,t}var Pa,Ma=xa,Ca=wa,Ia=va;function Oa(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*s,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*s,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*s,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*s,t}function Ra(){var t=new da(4);return da!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function La(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function ka(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=r*l+s*a,t[1]=i*l+o*a,t[2]=o*l-i*a,t[3]=s*l-r*a,t}function Da(t,e,n,r,i,o,s,a,l){if(o&&t.queryGeometry.isAboveHorizon)return!1;o&&(l*=t.pixelToTileUnitsFactor);for(const u of e)for(const e of u){const u=e.add(a),c=i&&n.elevation?n.elevation.exaggeration()*i.getElevationAt(u.x,u.y,!0):0,h=o?u:Na(u,c,r),p=o?t.tilespaceRays.map((t=>za(t,c))):t.queryGeometry.screenGeometry,f=Oa([],[e.x,e.y,c,1],r);if(!s&&o?l*=f[3]/n.cameraToCenterDistance:s&&!o&&(l*=n.cameraToCenterDistance/f[3]),Qs(p,h,l))return!0}return!1}function Na(t,e,n){const r=Oa([],[t.x,t.y,e,1],n);return new i(r[0]/r[3],r[1]/r[3])}_a(),Pa=new da(4),da!=Float32Array&&(Pa[0]=0,Pa[1]=0,Pa[2]=0,Pa[3]=0),_a(),ba(1,0,0),ba(0,1,0),Ra(),Ra(),ga();const Fa=ba(0,0,0),Ba=ba(0,0,1);function za(t,e){const n=_a();return Fa[2]=e,t.intersectsPlane(Fa,Ba,n),new i(n[0],n[1])}class ja extends $s{}function Ua(t,{width:e,height:n},r,i){if(i){if(i instanceof Uint8ClampedArray)i=new Uint8Array(i.buffer);else if(i.length!==e*n*r)throw new RangeError("mismatched image size")}else i=new Uint8Array(e*n*r);return t.width=e,t.height=n,t.data=i,t}function Va(t,{width:e,height:n},r){if(e===t.width&&n===t.height)return;const i=Ua({},{width:e,height:n},r);Ga(t,i,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,e),height:Math.min(t.height,n)},r),t.width=e,t.height=n,t.data=i.data}function Ga(t,e,n,r,i,o){if(0===i.width||0===i.height)return e;if(i.width>t.width||i.height>t.height||n.x>t.width-i.width||n.y>t.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>e.width||i.height>e.height||r.x>e.width-i.width||r.y>e.height-i.height)throw new RangeError("out of range destination coordinates for image copy");const s=t.data,a=e.data;for(let l=0;l<i.height;l++){const u=((n.y+l)*t.width+n.x)*o,c=((r.y+l)*e.width+r.x)*o;for(let t=0;t<i.width*o;t++)a[c+t]=s[u+t]}return e}ai("HeatmapBucket",ja,{omit:["layers"]});class Za{constructor(t,e){Ua(this,t,1,e)}resize(t){Va(this,t,1)}clone(){return new Za({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,n,r,i){Ga(t,e,n,r,i,1)}}class qa{constructor(t,e){Ua(this,t,4,e)}resize(t){Va(this,t,4)}replace(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new qa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,n,r,i){Ga(t,e,n,r,i,4)}}ai("AlphaImage",Za),ai("RGBAImage",qa);var Wa={paint:new bo({"heatmap-radius":new Ao(Bt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ao(Bt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new mo(Bt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new vo(Bt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new mo(Bt.paint_heatmap["heatmap-opacity"])})};function Ha(t){const e={},n=t.resolution||256,r=t.clips?t.clips.length:1,i=t.image||new qa({width:n,height:r}),o=(n,r,o)=>{e[t.evaluationKey]=o;const s=t.expression.evaluate(e);i.data[n+r+0]=Math.floor(255*s.r/s.a),i.data[n+r+1]=Math.floor(255*s.g/s.a),i.data[n+r+2]=Math.floor(255*s.b/s.a),i.data[n+r+3]=Math.floor(255*s.a)};if(t.clips)for(let e=0,i=0;e<r;++e,i+=4*n)for(let r=0,s=0;r<n;r++,s+=4){const a=r/(n-1),{start:l,end:u}=t.clips[e];o(i,s,l*(1-a)+u*a)}else for(let t=0,e=0;t<n;t++,e+=4)o(0,e,t/(n-1));return i}var Xa={paint:new bo({"hillshade-illumination-direction":new mo(Bt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new mo(Bt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new mo(Bt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new mo(Bt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new mo(Bt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new mo(Bt.paint_hillshade["hillshade-accent-color"])})};const $a=To([{name:"a_pos",components:2,type:"Int16"}],4),{members:Ya}=$a;var Qa=Ja,Ka=Ja;function Ja(t,e,n){n=n||2;var r,i,o,s,a,l,u,c=e&&e.length,h=c?e[0]*n:t.length,p=tl(t,0,h,n,!0),f=[];if(!p||p.next===p.prev)return f;if(c&&(p=function(t,e,n,r){var i,o,s,a=[];for(i=0,o=e.length;i<o;i++)(s=tl(t,e[i]*r,i<o-1?e[i+1]*r:t.length,r,!1))===s.next&&(s.steiner=!0),a.push(hl(s));for(a.sort(al),i=0;i<a.length;i++)ll(a[i],n),n=el(n,n.next);return n}(t,e,p,n)),t.length>80*n){r=o=t[0],i=s=t[1];for(var d=n;d<h;d+=n)(a=t[d])<r&&(r=a),(l=t[d+1])<i&&(i=l),a>o&&(o=a),l>s&&(s=l);u=0!==(u=Math.max(o-r,s-i))?1/u:0}return nl(p,f,n,r,i,u),f}function tl(t,e,n,r,i){var o,s;if(i===El(t,e,n,r)>0)for(o=e;o<n;o+=r)s=bl(o,t[o],t[o+1],s);else for(o=n-r;o>=e;o-=r)s=bl(o,t[o],t[o+1],s);return s&&gl(s,s.next)&&(xl(s),s=s.next),s}function el(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!gl(r,r.next)&&0!==dl(r.prev,r,r.next))r=r.next;else{if(xl(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function nl(t,e,n,r,i,o,s){if(t){!s&&o&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=cl(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,s,a,l,u=1;do{for(n=t,t=null,o=null,s=0;n;){for(s++,r=n,a=0,e=0;e<u&&(a++,r=r.nextZ);e++);for(l=u;a>0||l>0&&r;)0!==a&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,l--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,u*=2}while(s>1)}(i)}(t,r,i,o);for(var a,l,u=t;t.prev!==t.next;)if(a=t.prev,l=t.next,o?il(t,r,i,o):rl(t))e.push(a.i/n),e.push(t.i/n),e.push(l.i/n),xl(t),t=l.next,u=l.next;else if((t=l)===u){s?1===s?nl(t=ol(el(t),e,n),e,n,r,i,o,2):2===s&&sl(t,e,n,r,i,o):nl(el(t),e,n,r,i,o,1);break}}}function rl(t){var e=t.prev,n=t,r=t.next;if(dl(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(pl(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&dl(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function il(t,e,n,r){var i=t.prev,o=t,s=t.next;if(dl(i,o,s)>=0)return!1;for(var a=i.x>o.x?i.x>s.x?i.x:s.x:o.x>s.x?o.x:s.x,l=i.y>o.y?i.y>s.y?i.y:s.y:o.y>s.y?o.y:s.y,u=cl(i.x<o.x?i.x<s.x?i.x:s.x:o.x<s.x?o.x:s.x,i.y<o.y?i.y<s.y?i.y:s.y:o.y<s.y?o.y:s.y,e,n,r),c=cl(a,l,e,n,r),h=t.prevZ,p=t.nextZ;h&&h.z>=u&&p&&p.z<=c;){if(h!==t.prev&&h!==t.next&&pl(i.x,i.y,o.x,o.y,s.x,s.y,h.x,h.y)&&dl(h.prev,h,h.next)>=0)return!1;if(h=h.prevZ,p!==t.prev&&p!==t.next&&pl(i.x,i.y,o.x,o.y,s.x,s.y,p.x,p.y)&&dl(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;h&&h.z>=u;){if(h!==t.prev&&h!==t.next&&pl(i.x,i.y,o.x,o.y,s.x,s.y,h.x,h.y)&&dl(h.prev,h,h.next)>=0)return!1;h=h.prevZ}for(;p&&p.z<=c;){if(p!==t.prev&&p!==t.next&&pl(i.x,i.y,o.x,o.y,s.x,s.y,p.x,p.y)&&dl(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function ol(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!gl(i,o)&&ml(i,r,r.next,o)&&_l(i,o)&&_l(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),xl(r),xl(r.next),r=t=o),r=r.next}while(r!==t);return el(r)}function sl(t,e,n,r,i,o){var s=t;do{for(var a=s.next.next;a!==s.prev;){if(s.i!==a.i&&fl(s,a)){var l=vl(s,a);return s=el(s,s.next),l=el(l,l.next),nl(s,e,n,r,i,o),void nl(l,e,n,r,i,o)}a=a.next}s=s.next}while(s!==t)}function al(t,e){return t.x-e.x}function ll(t,e){if(e=function(t,e){var n,r=e,i=t.x,o=t.y,s=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var a=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=i&&a>s){if(s=a,a===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===s)return n;var l,u=n,c=n.x,h=n.y,p=1/0;r=n;do{i>=r.x&&r.x>=c&&i!==r.x&&pl(o<h?i:s,o,c,h,o<h?s:i,o,r.x,r.y)&&(l=Math.abs(o-r.y)/(i-r.x),_l(r,t)&&(l<p||l===p&&(r.x>n.x||r.x===n.x&&ul(n,r)))&&(n=r,p=l)),r=r.next}while(r!==u);return n}(t,e)){var n=vl(e,t);el(e,e.next),el(n,n.next)}}function ul(t,e){return dl(t.prev,t,e.prev)<0&&dl(e.next,t,t.next)<0}function cl(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function hl(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function pl(t,e,n,r,i,o,s,a){return(i-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(r-a)-(n-s)*(e-a)>=0&&(n-s)*(o-a)-(i-s)*(r-a)>=0}function fl(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&ml(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(_l(t,e)&&_l(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(dl(t.prev,t,e.prev)||dl(t,e.prev,e))||gl(t,e)&&dl(t.prev,t,t.next)>0&&dl(e.prev,e,e.next)>0)}function dl(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function gl(t,e){return t.x===e.x&&t.y===e.y}function ml(t,e,n,r){var i=yl(dl(t,e,n)),o=yl(dl(t,e,r)),s=yl(dl(n,r,t)),a=yl(dl(n,r,e));return i!==o&&s!==a||!(0!==i||!Al(t,n,e))||!(0!==o||!Al(t,r,e))||!(0!==s||!Al(n,t,r))||!(0!==a||!Al(n,e,r))}function Al(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function yl(t){return t>0?1:t<0?-1:0}function _l(t,e){return dl(t.prev,t,t.next)<0?dl(t,e,t.next)>=0&&dl(t,t.prev,e)>=0:dl(t,e,t.prev)<0||dl(t,t.next,e)<0}function vl(t,e){var n=new wl(t.i,t.x,t.y),r=new wl(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function bl(t,e,n,r){var i=new wl(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function xl(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function wl(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function El(t,e,n,r){for(var i=0,o=e,s=n-r;o<n;o+=r)i+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return i}function Sl(t,e,n,r,i){Tl(t,e,n||0,r||t.length-1,i||Ml)}function Tl(t,e,n,r,i){for(;r>n;){if(r-n>600){var o=r-n+1,s=e-n+1,a=Math.log(o),l=.5*Math.exp(2*a/3),u=.5*Math.sqrt(a*l*(o-l)/o)*(s-o/2<0?-1:1);Tl(t,e,Math.max(n,Math.floor(e-s*l/o+u)),Math.min(r,Math.floor(e+(o-s)*l/o+u)),i)}var c=t[e],h=n,p=r;for(Pl(t,n,e),i(t[r],c)>0&&Pl(t,n,r);h<p;){for(Pl(t,h,p),h++,p--;i(t[h],c)<0;)h++;for(;i(t[p],c)>0;)p--}0===i(t[n],c)?Pl(t,n,p):Pl(t,++p,r),p<=e&&(n=p+1),e<=p&&(r=p-1)}}function Pl(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function Ml(t,e){return t<e?-1:t>e?1:0}function Cl(t,e){const n=t.length;if(n<=1)return[t];const r=[];let i,o;for(let e=0;e<n;e++){const n=L(t[e]);0!==n&&(t[e].area=Math.abs(n),void 0===o&&(o=n<0),o===n<0?(i&&r.push(i),i=[t[e]]):i.push(t[e]))}if(i&&r.push(i),e>1)for(let t=0;t<r.length;t++)r[t].length<=e||(Sl(r[t],e,1,r[t].length-1,Il),r[t]=r[t].slice(0,e));return r}function Il(t,e){return e.area-t.area}function Ol(t,e,n){const r=n.patternDependencies;let i=!1;for(const n of e){const e=n.paint.get(`${t}-pattern`);e.isConstant()||(i=!0);const o=e.constantOr(null);o&&(i=!0,r[o.to]=!0,r[o.from]=!0)}return i}function Rl(t,e,n,r,i){const o=i.patternDependencies;for(const s of e){const e=s.paint.get(`${t}-pattern`).value;if("constant"!==e.kind){let t=e.evaluate({zoom:r-1},n,{},i.availableImages),a=e.evaluate({zoom:r},n,{},i.availableImages),l=e.evaluate({zoom:r+1},n,{},i.availableImages);t=t&&t.name?t.name:t,a=a&&a.name?a.name:a,l=l&&l.name?l.name:l,o[t]=!0,o[a]=!0,o[l]=!0,n.patterns[s.id]={min:t,mid:a,max:l}}}return n}Ja.deviation=function(t,e,n,r){var i=e&&e.length,o=Math.abs(El(t,0,i?e[0]*n:t.length,n));if(i)for(var s=0,a=e.length;s<a;s++)o-=Math.abs(El(t,e[s]*n,s<a-1?e[s+1]*n:t.length,n));var l=0;for(s=0;s<r.length;s+=3){var u=r[s]*n,c=r[s+1]*n,h=r[s+2]*n;l+=Math.abs((t[u]-t[h])*(t[c+1]-t[u+1])-(t[u]-t[c])*(t[h+1]-t[u+1]))}return 0===o&&0===l?0:Math.abs((l-o)/o)},Ja.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[i][o][s]);i>0&&n.holes.push(r+=t[i-1].length)}return n},Qa.default=Ka;class Ll{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Mo,this.indexArray=new jo,this.indexArray2=new Wo,this.programConfigurations=new Rs(t.layers,t.zoom),this.segments=new Vs,this.segments2=new Vs,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,n){this.hasPattern=Ol("fill",this.layers,e);const r=this.layers[0].layout.get("fill-sort-key"),i=[];for(const{feature:o,id:s,index:a,sourceLayerIndex:l}of t){const t=this.layers[0]._featureFilter.needGeometry,u=Hs(o,t);if(!this.layers[0]._featureFilter.filter(new so(this.zoom),u,n))continue;const c=r?r.evaluate(u,{},n,e.availableImages):void 0,h={id:s,properties:o.properties,type:o.type,sourceLayerIndex:l,index:a,geometry:t?u.geometry:Ws(o),patterns:{},sortKey:c};i.push(h)}r&&i.sort(((t,e)=>t.sortKey-e.sortKey));for(const r of i){const{geometry:i,index:o,sourceLayerIndex:s}=r;if(this.hasPattern){const t=Rl("fill",this.layers,r,this.zoom,e);this.patternFeatures.push(t)}else this.addFeature(r,i,o,n,{});e.featureIndex.insert(t[o].feature,i,o,s,this.index)}}update(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)}addFeatures(t,e,n){for(const t of this.patternFeatures)this.addFeature(t,t.geometry,t.index,e,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ya),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,e,n,r,i){for(const t of Cl(e,500)){let e=0;for(const n of t)e+=n.length;const n=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray),r=n.vertexLength,i=[],o=[];for(const e of t){if(0===e.length)continue;e!==t[0]&&o.push(i.length/2);const n=this.segments2.prepareSegment(e.length,this.layoutVertexArray,this.indexArray2),r=n.vertexLength;this.layoutVertexArray.emplaceBack(e[0].x,e[0].y),this.indexArray2.emplaceBack(r+e.length-1,r),i.push(e[0].x),i.push(e[0].y);for(let t=1;t<e.length;t++)this.layoutVertexArray.emplaceBack(e[t].x,e[t].y),this.indexArray2.emplaceBack(r+t-1,r+t),i.push(e[t].x),i.push(e[t].y);n.vertexLength+=e.length,n.primitiveLength+=e.length}const s=Qa(i,o);for(let t=0;t<s.length;t+=3)this.indexArray.emplaceBack(r+s[t],r+s[t+1],r+s[t+2]);n.vertexLength+=e,n.primitiveLength+=s.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,i,r)}}ai("FillBucket",Ll,{omit:["layers","patternFeatures"]});const kl=new bo({"fill-sort-key":new Ao(Bt.layout_fill["fill-sort-key"])});var Dl={paint:new bo({"fill-antialias":new mo(Bt.paint_fill["fill-antialias"]),"fill-opacity":new Ao(Bt.paint_fill["fill-opacity"]),"fill-color":new Ao(Bt.paint_fill["fill-color"]),"fill-outline-color":new Ao(Bt.paint_fill["fill-outline-color"]),"fill-translate":new mo(Bt.paint_fill["fill-translate"]),"fill-translate-anchor":new mo(Bt.paint_fill["fill-translate-anchor"]),"fill-pattern":new yo(Bt.paint_fill["fill-pattern"])}),layout:kl};const Nl=To([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Fl=To([{name:"a_centroid_pos",components:2,type:"Uint16"}]),{members:Bl}=Nl;var zl=jl;function jl(t,e,n,r,i){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=r,this._values=i,t.readFields(Ul,this,e)}function Ul(t,e,n){1==t?e.id=n.readVarint():2==t?function(t,e){for(var n=t.readVarint()+t.pos;t.pos<n;){var r=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[r]=i}}(n,e):3==t?e.type=n.readVarint():4==t&&(e._geometry=n.pos)}function Vl(t){for(var e,n,r=0,i=0,o=t.length,s=o-1;i<o;s=i++)r+=((n=t[s]).x-(e=t[i]).x)*(e.y+n.y);return r}jl.types=["Unknown","Point","LineString","Polygon"],jl.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,r=1,o=0,s=0,a=0,l=[];t.pos<n;){if(o<=0){var u=t.readVarint();r=7&u,o=u>>3}if(o--,1===r||2===r)s+=t.readSVarint(),a+=t.readSVarint(),1===r&&(e&&l.push(e),e=[]),e.push(new i(s,a));else{if(7!==r)throw new Error("unknown command "+r);e&&e.push(e[0].clone())}}return e&&l.push(e),l},jl.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,r=0,i=0,o=0,s=1/0,a=-1/0,l=1/0,u=-1/0;t.pos<e;){if(r<=0){var c=t.readVarint();n=7&c,r=c>>3}if(r--,1===n||2===n)(i+=t.readSVarint())<s&&(s=i),i>a&&(a=i),(o+=t.readSVarint())<l&&(l=o),o>u&&(u=o);else if(7!==n)throw new Error("unknown command "+n)}return[s,l,a,u]},jl.prototype.toGeoJSON=function(t,e,n){var r,i,o=this.extent*Math.pow(2,n),s=this.extent*t,a=this.extent*e,l=this.loadGeometry(),u=jl.types[this.type];function c(t){for(var e=0;e<t.length;e++){var n=t[e];t[e]=[360*(n.x+s)/o-180,360/Math.PI*Math.atan(Math.exp((180-360*(n.y+a)/o)*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(r=0;r<l.length;r++)h[r]=l[r][0];c(l=h);break;case 2:for(r=0;r<l.length;r++)c(l[r]);break;case 3:for(l=function(t){var e=t.length;if(e<=1)return[t];for(var n,r,i=[],o=0;o<e;o++){var s=Vl(t[o]);0!==s&&(void 0===r&&(r=s<0),r===s<0?(n&&i.push(n),n=[t[o]]):n.push(t[o]))}return n&&i.push(n),i}(l),r=0;r<l.length;r++)for(i=0;i<l[r].length;i++)c(l[r][i])}1===l.length?l=l[0]:u="Multi"+u;var p={type:"Feature",geometry:{type:u,coordinates:l},properties:this.properties};return"id"in this&&(p.id=this.id),p};var Gl=Zl;function Zl(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(ql,this,e),this.length=this._features.length}function ql(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){for(var e=null,n=t.readVarint()+t.pos;t.pos<n;){var r=t.readVarint()>>3;e=1===r?t.readString():2===r?t.readFloat():3===r?t.readDouble():4===r?t.readVarint64():5===r?t.readVarint():6===r?t.readSVarint():7===r?t.readBoolean():null}return e}(n))}function Wl(t,e,n){if(3===t){var r=new Gl(n,n.readVarint()+n.pos);r.length&&(e[r.name]=r)}}Zl.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new zl(this._pbf,e,this.extent,this._keys,this._values)};var Hl={VectorTile:function(t,e){this.layers=t.readFields(Wl,{},e)},VectorTileFeature:zl,VectorTileLayer:Gl};const Xl=Hl.VectorTileFeature.types,$l=Math.pow(2,13);function Yl(t,e,n,r,i,o,s,a){t.emplaceBack((e<<1)+s,(n<<1)+o,(Math.floor(r*$l)<<1)+i,Math.round(a))}class Ql{constructor(){this.acc=new i(0,0),this.polyCount=[]}startRing(t){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new i(t.x,t.y),this.max=new i(t.x,t.y))}append(t,e){this.currentPolyCount.edges++,this.acc._add(t);let n=!!this.borders;const r=this.min,i=this.max;t.x<r.x?(r.x=t.x,n=!0):t.x>i.x&&(i.x=t.x,n=!0),t.y<r.y?(r.y=t.y,n=!0):t.y>i.y&&(i.y=t.y,n=!0),((0===t.x||t.x===Gs)&&t.x===e.x)!=((0===t.y||t.y===Gs)&&t.y===e.y)&&this.processBorderOverlap(t,e),n&&this.checkBorderIntersection(t,e)}checkBorderIntersection(t,e){e.x<0!=t.x<0&&this.addBorderIntersection(0,nn(e.y,t.y,(0-e.x)/(t.x-e.x))),e.x>Gs!=t.x>Gs&&this.addBorderIntersection(1,nn(e.y,t.y,(Gs-e.x)/(t.x-e.x))),e.y<0!=t.y<0&&this.addBorderIntersection(2,nn(e.x,t.x,(0-e.y)/(t.y-e.y))),e.y>Gs!=t.y>Gs&&this.addBorderIntersection(3,nn(e.x,t.x,(Gs-e.y)/(t.y-e.y)))}addBorderIntersection(t,e){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const n=this.borders[t];e<n[0]&&(n[0]=e),e>n[1]&&(n[1]=e)}processBorderOverlap(t,e){if(t.x===e.x){if(t.y===e.y)return;const n=0===t.x?0:1;this.addBorderIntersection(n,e.y),this.addBorderIntersection(n,t.y)}else{const n=0===t.y?2:3;this.addBorderIntersection(n,e.x),this.addBorderIntersection(n,t.x)}}centroid(){const t=this.polyCount.reduce(((t,e)=>t+e.edges),0);return 0!==t?this.acc.div(t)._round():new i(0,0)}span(){return new i(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce(((t,e)=>t+ +(e[0]!==Number.MAX_VALUE)),0)}}class Kl{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Co,this.centroidVertexArray=new ls,this.indexArray=new jo,this.programConfigurations=new Rs(t.layers,t.zoom),this.segments=new Vs,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id)),this.enableTerrain=t.enableTerrain}populate(t,e,n){this.features=[],this.hasPattern=Ol("fill-extrusion",this.layers,e),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDone=[!1,!1,!1,!1],this.tileToMeter=function(t){const e=Math.exp(Math.PI*(1-t.y/(1<<t.z)*2));return 80150034*e/(e*e+1)/Gs/(1<<t.z)}(n);for(const{feature:r,id:i,index:o,sourceLayerIndex:s}of t){const t=this.layers[0]._featureFilter.needGeometry,a=Hs(r,t);if(!this.layers[0]._featureFilter.filter(new so(this.zoom),a,n))continue;const l={id:i,sourceLayerIndex:s,index:o,geometry:t?a.geometry:Ws(r),properties:r.properties,type:r.type,patterns:{}},u=this.layoutVertexArray.length;this.hasPattern?this.features.push(Rl("fill-extrusion",this.layers,l,this.zoom,e)):this.addFeature(l,l.geometry,o,n,{}),e.featureIndex.insert(r,l.geometry,o,s,this.index,u)}this.sortBorders()}addFeatures(t,e,n){for(const t of this.features){const{geometry:r}=t;this.addFeature(t,r,t.index,e,n)}this.sortBorders()}update(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Bl),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,Fl.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,e,n,r,i){const o=this.enableTerrain?new Ql:null;for(const n of Cl(e,500)){let e=0,r=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);if(0===n.length||(s=n[0]).every((t=>t.x<=0))||s.every((t=>t.x>=Gs))||s.every((t=>t.y<=0))||s.every((t=>t.y>=Gs)))continue;for(let t=0;t<n.length;t++){const i=n[t];if(0===i.length)continue;e+=i.length;let s=0;o&&o.startRing(i[0]);for(let t=0;t<i.length;t++){const e=i[t];if(t>=1){const n=i[t-1];if(!Jl(e,n)){o&&o.append(e,n),r.vertexLength+4>Vs.MAX_VERTEX_ARRAY_LENGTH&&(r=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const t=e.sub(n)._perp(),i=t.x/(Math.abs(t.x)+Math.abs(t.y)),a=t.y>0?1:0,l=n.dist(e);s+l>32768&&(s=0),Yl(this.layoutVertexArray,e.x,e.y,i,a,0,0,s),Yl(this.layoutVertexArray,e.x,e.y,i,a,0,1,s),s+=l,Yl(this.layoutVertexArray,n.x,n.y,i,a,0,0,s),Yl(this.layoutVertexArray,n.x,n.y,i,a,0,1,s);const u=r.vertexLength;this.indexArray.emplaceBack(u,u+2,u+1),this.indexArray.emplaceBack(u+1,u+2,u+3),r.vertexLength+=4,r.primitiveLength+=2}}}}if(r.vertexLength+e>Vs.MAX_VERTEX_ARRAY_LENGTH&&(r=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray)),"Polygon"!==Xl[t.type])continue;const i=[],a=[],l=r.vertexLength;for(let t=0;t<n.length;t++){const e=n[t];if(0!==e.length){e!==n[0]&&a.push(i.length/2);for(let t=0;t<e.length;t++){const n=e[t];Yl(this.layoutVertexArray,n.x,n.y,0,0,1,1,0),i.push(n.x),i.push(n.y),o&&o.currentPolyCount.top++}}}const u=Qa(i,a);for(let t=0;t<u.length;t+=3)this.indexArray.emplaceBack(l+u[t],l+u[t+2],l+u[t+1]);r.primitiveLength+=u.length/3,r.vertexLength+=e}var s;if(o&&o.polyCount.length>0){if(o.borders){o.vertexArrayOffset=this.centroidVertexArray.length;const t=o.borders,e=this.featuresOnBorder.push(o)-1;for(let n=0;n<4;n++)t[n][0]!==Number.MAX_VALUE&&this.borders[n].push(e)}this.encodeCentroid(o.borders?void 0:o.centroid(),o)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,i,r)}sortBorders(){for(let t=0;t<4;t++)this.borders[t].sort(((e,n)=>this.featuresOnBorder[e].borders[t][0]-this.featuresOnBorder[n].borders[t][0]))}encodeCentroid(t,e,n=!0){let r,i;if(t)if(0!==t.y){const n=e.span()._mult(this.tileToMeter);r=(Math.max(t.x,1)<<3)+Math.min(7,Math.round(n.x/10)),i=(Math.max(t.y,1)<<3)+Math.min(7,Math.round(n.y/10))}else r=Math.ceil(7*(t.x+450)),i=0;else r=0,i=+n;let o=n?this.centroidVertexArray.length:e.vertexArrayOffset;for(const t of e.polyCount){n&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*t.edges+t.top);for(let e=0;e<2*t.edges;e++)this.centroidVertexArray.emplace(o++,0,i),this.centroidVertexArray.emplace(o++,r,i);for(let e=0;e<t.top;e++)this.centroidVertexArray.emplace(o++,r,i)}}}function Jl(t,e){return t.x===e.x&&(t.x<0||t.x>Gs)||t.y===e.y&&(t.y<0||t.y>Gs)}ai("FillExtrusionBucket",Kl,{omit:["layers","features"]}),ai("PartMetadata",Ql);var tu={paint:new bo({"fill-extrusion-opacity":new mo(Bt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ao(Bt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new mo(Bt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new mo(Bt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new yo(Bt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ao(Bt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ao(Bt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new mo(Bt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function eu(t,e){return t.x*e.x+t.y*e.y}function nu(t,e){if(1===t.length){let n=0;const r=e[n++];let i;for(;!i||r.equals(i);)if(i=e[n++],!i)return 1/0;for(;n<e.length;n++){const o=e[n],s=t[0],a=i.sub(r),l=o.sub(r),u=s.sub(r),c=eu(a,a),h=eu(a,l),p=eu(l,l),f=eu(u,a),d=eu(u,l),g=c*p-h*h,m=(p*f-h*d)/g,A=(c*d-h*f)/g,y=r.z*(1-m-A)+i.z*m+o.z*A;if(isFinite(y))return y}return 1/0}{let t=1/0;for(const n of e)t=Math.min(t,n.z);return t}}function ru(t){const e=new i(t[0],t[1]);return e.z=t[2],e}function iu(t,e,n,r,i,o,s,a){const l=s*i.getElevationAt(t,e,!0,!0),u=0!==o[0],c=u?0===o[1]?s*(o[0]/7-450):s*function(t,e,n){const r=Math.floor(e[0]/8),i=Math.floor(e[1]/8),o=10*(e[0]-8*r),s=10*(e[1]-8*i),a=t.getElevationAt(r,i,!0,!0),l=t.getMeterToDEM(n),u=Math.floor(.5*(o*l-1)),c=Math.floor(.5*(s*l-1)),h=t.tileCoordToPixel(r,i),p=2*u+1,f=2*c+1,d=function(t,e,n,r,i){return[t.getElevationAtPixel(e,n,!0),t.getElevationAtPixel(e+i,n,!0),t.getElevationAtPixel(e,n+i,!0),t.getElevationAtPixel(e+r,n+i,!0)]}(t,h.x-u,h.y-c,p,f),g=Math.abs(d[0]-d[1]),m=Math.abs(d[2]-d[3]),A=Math.abs(d[0]-d[2])+Math.abs(d[1]-d[3]),y=Math.min(.25,.5*l*(g+m)/p),_=Math.min(.25,.5*l*A/f);return a+Math.max(y*o,_*s)}(i,o,a):l;return{base:l+(0===n)?-1:n,top:u?Math.max(c+r,l+n+2):l+r}}const ou=To([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:su}=ou,au=To([{name:"a_packed",components:3,type:"Float32"}]),{members:lu}=au,uu=Hl.VectorTileFeature.types,cu=Math.cos(Math.PI/180*37.5);class hu{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((t=>{this.gradients[t.id]={}})),this.layoutVertexArray=new Io,this.layoutVertexArray2=new Oo,this.indexArray=new jo,this.programConfigurations=new Rs(t.layers,t.zoom),this.segments=new Vs,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,n){this.hasPattern=Ol("line",this.layers,e);const r=this.layers[0].layout.get("line-sort-key"),i=[];for(const{feature:e,id:o,index:s,sourceLayerIndex:a}of t){const t=this.layers[0]._featureFilter.needGeometry,l=Hs(e,t);if(!this.layers[0]._featureFilter.filter(new so(this.zoom),l,n))continue;const u=r?r.evaluate(l,{},n):void 0,c={id:o,properties:e.properties,type:e.type,sourceLayerIndex:a,index:s,geometry:t?l.geometry:Ws(e),patterns:{},sortKey:u};i.push(c)}r&&i.sort(((t,e)=>t.sortKey-e.sortKey));const{lineAtlas:o,featureIndex:s}=e,a=this.addConstantDashes(o);for(const r of i){const{geometry:i,index:l,sourceLayerIndex:u}=r;if(a&&this.addFeatureDashes(r,o),this.hasPattern){const t=Rl("line",this.layers,r,this.zoom,e);this.patternFeatures.push(t)}else this.addFeature(r,i,l,n,o.positions);s.insert(t[l].feature,i,l,u,this.index)}}addConstantDashes(t){let e=!1;for(const n of this.layers){const r=n.paint.get("line-dasharray").value,i=n.layout.get("line-cap").value;if("constant"!==r.kind||"constant"!==i.kind)e=!0;else{const e=i.value,n=r.value;if(!n)continue;t.addDash(n.from,e),t.addDash(n.to,e),n.other&&t.addDash(n.other,e)}}return e}addFeatureDashes(t,e){const n=this.zoom;for(const r of this.layers){const i=r.paint.get("line-dasharray").value,o=r.layout.get("line-cap").value;if("constant"===i.kind&&"constant"===o.kind)continue;let s,a,l,u,c,h;if("constant"===i.kind){const t=i.value;if(!t)continue;s=t.other||t.to,a=t.to,l=t.from}else s=i.evaluate({zoom:n-1},t),a=i.evaluate({zoom:n},t),l=i.evaluate({zoom:n+1},t);"constant"===o.kind?u=c=h=o.value:(u=o.evaluate({zoom:n-1},t),c=o.evaluate({zoom:n},t),h=o.evaluate({zoom:n+1},t)),e.addDash(s,u),e.addDash(a,c),e.addDash(l,h);const p=e.getKey(s,u),f=e.getKey(a,c),d=e.getKey(l,h);t.patterns[r.id]={min:p,mid:f,max:d}}}update(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)}addFeatures(t,e,n){for(const t of this.patternFeatures)this.addFeature(t,t.geometry,t.index,e,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,lu)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,su),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,e,n,r,i){const o=this.layers[0].layout,s=o.get("line-join").evaluate(t,{}),a=o.get("line-cap").evaluate(t,{}),l=o.get("line-miter-limit"),u=o.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const n of e)this.addLine(n,t,s,a,l,u);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,i,r)}addLine(t,e,n,r,i,o){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let e=0;e<t.length-1;e++)this.totalDistance+=t[e].dist(t[e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const s="Polygon"===uu[e.type];let a=t.length;for(;a>=2&&t[a-1].equals(t[a-2]);)a--;let l=0;for(;l<a-1&&t[l].equals(t[l+1]);)l++;if(a<(s?3:2))return;"bevel"===n&&(i=1.05);const u=this.overscaling<=16?122880/(512*this.overscaling):0,c=this.segments.prepareSegment(10*a,this.layoutVertexArray,this.indexArray);let h,p,f,d,g;this.e1=this.e2=-1,s&&(h=t[a-2],g=t[l].sub(h)._unit()._perp());for(let e=l;e<a;e++){if(f=e===a-1?s?t[l+1]:void 0:t[e+1],f&&t[e].equals(f))continue;g&&(d=g),h&&(p=h),h=t[e],g=f?f.sub(h)._unit()._perp():d,d=d||g;let m=d.add(g);0===m.x&&0===m.y||m._unit();const A=d.x*g.x+d.y*g.y,y=m.x*g.x+m.y*g.y,_=0!==y?1/y:1/0,v=2*Math.sqrt(2-2*y),b=y<cu&&p&&f,x=d.x*g.y-d.y*g.x>0;if(b&&e>l){const t=h.dist(p);if(t>2*u){const e=h.sub(h.sub(p)._mult(u/t)._round());this.updateDistance(p,e),this.addCurrentVertex(e,d,0,0,c),p=e}}const w=p&&f;let E=w?n:s?"butt":r;if(w&&"round"===E&&(_<o?E="miter":_<=2&&(E="fakeround")),"miter"===E&&_>i&&(E="bevel"),"bevel"===E&&(_>2&&(E="flipbevel"),_<i&&(E="miter")),p&&this.updateDistance(p,h),"miter"===E)m._mult(_),this.addCurrentVertex(h,m,0,0,c);else if("flipbevel"===E){if(_>100)m=g.mult(-1);else{const t=_*d.add(g).mag()/d.sub(g).mag();m._perp()._mult(t*(x?-1:1))}this.addCurrentVertex(h,m,0,0,c),this.addCurrentVertex(h,m.mult(-1),0,0,c)}else if("bevel"===E||"fakeround"===E){const t=-Math.sqrt(_*_-1),e=x?t:0,n=x?0:t;if(p&&this.addCurrentVertex(h,d,e,n,c),"fakeround"===E){const t=Math.round(180*v/Math.PI/20);for(let e=1;e<t;e++){let n=e/t;if(.5!==n){const t=n-.5;n+=n*t*(n-1)*((1.0904+A*(A*(3.55645-1.43519*A)-3.2452))*t*t+(.848013+A*(.215638*A-1.06021)))}const r=g.sub(d)._mult(n)._add(d)._unit()._mult(x?-1:1);this.addHalfVertex(h,r.x,r.y,!1,x,0,c)}}f&&this.addCurrentVertex(h,g,-e,-n,c)}else if("butt"===E)this.addCurrentVertex(h,m,0,0,c);else if("square"===E){const t=p?1:-1;p||this.addCurrentVertex(h,m,t,t,c),this.addCurrentVertex(h,m,0,0,c),p&&this.addCurrentVertex(h,m,t,t,c)}else"round"===E&&(p&&(this.addCurrentVertex(h,d,0,0,c),this.addCurrentVertex(h,d,1,1,c,!0)),f&&(this.addCurrentVertex(h,g,-1,-1,c,!0),this.addCurrentVertex(h,g,0,0,c)));if(b&&e<a-1){const t=h.dist(f);if(t>2*u){const e=h.add(f.sub(h)._mult(u/t)._round());this.updateDistance(h,e),this.addCurrentVertex(e,g,0,0,c),h=e}}}}addCurrentVertex(t,e,n,r,i,o=!1){const s=e.y*r-e.x,a=-e.y-e.x*r;this.addHalfVertex(t,e.x+e.y*n,e.y-e.x*n,o,!1,n,i),this.addHalfVertex(t,s,a,o,!0,-r,i)}addHalfVertex({x:t,y:e},n,r,i,o,s,a){this.layoutVertexArray.emplaceBack((t<<1)+(i?1:0),(e<<1)+(o?1:0),Math.round(63*n)+128,Math.round(63*r)+128,1+(0===s?0:s<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineSoFar);const l=a.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,l),a.primitiveLength++),o?this.e2=l:this.e1=l}updateScaledDistance(){if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(t,e){this.distance+=t.dist(e),this.updateScaledDistance()}}ai("LineBucket",hu,{omit:["layers","patternFeatures"]});const pu=new bo({"line-cap":new Ao(Bt.layout_line["line-cap"]),"line-join":new Ao(Bt.layout_line["line-join"]),"line-miter-limit":new mo(Bt.layout_line["line-miter-limit"]),"line-round-limit":new mo(Bt.layout_line["line-round-limit"]),"line-sort-key":new Ao(Bt.layout_line["line-sort-key"])});var fu={paint:new bo({"line-opacity":new Ao(Bt.paint_line["line-opacity"]),"line-color":new Ao(Bt.paint_line["line-color"]),"line-translate":new mo(Bt.paint_line["line-translate"]),"line-translate-anchor":new mo(Bt.paint_line["line-translate-anchor"]),"line-width":new Ao(Bt.paint_line["line-width"]),"line-gap-width":new Ao(Bt.paint_line["line-gap-width"]),"line-offset":new Ao(Bt.paint_line["line-offset"]),"line-blur":new Ao(Bt.paint_line["line-blur"]),"line-dasharray":new yo(Bt.paint_line["line-dasharray"]),"line-pattern":new yo(Bt.paint_line["line-pattern"]),"line-gradient":new vo(Bt.paint_line["line-gradient"])}),layout:pu};const du=new class extends Ao{possiblyEvaluate(t,e){return e=new so(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,n,r){return e=_({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,n,r)}}(fu.paint.properties["line-width"].specification);function gu(t,e){return e>0?e+2*t:t}du.useIntegerZoom=!0;const mu=To([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"},{name:"a_z_tile_anchor",components:4,type:"Int16"}],4),Au=To([{name:"a_projected_pos",components:3,type:"Float32"}],4);To([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const yu=To([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),_u=To([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);To([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const vu=To([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),bu=To([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);To([{name:"triangle",components:3,type:"Uint16"}]),To([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),To([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),To([{type:"Float32",name:"offsetX"}]),To([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var xu=24;const wu=128;function Eu(t,e){const{expression:n}=e;if("constant"===n.kind)return{kind:"constant",layoutSize:n.evaluate(new so(t+1))};if("source"===n.kind)return{kind:"source"};{const{zoomStops:e,interpolationType:r}=n;let i=0;for(;i<e.length&&e[i]<=t;)i++;i=Math.max(0,i-1);let o=i;for(;o<e.length&&e[o]<t+1;)o++;o=Math.min(e.length-1,o);const s=e[i],a=e[o];return"composite"===n.kind?{kind:"composite",minZoom:s,maxZoom:a,interpolationType:r}:{kind:"camera",minZoom:s,maxZoom:a,minSize:n.evaluate(new so(s)),maxSize:n.evaluate(new so(a)),interpolationType:r}}}function Su(t,{uSize:e,uSizeT:n},{lowerSize:r,upperSize:i}){return"source"===t.kind?r/wu:"composite"===t.kind?nn(r/wu,i/wu,n):e}function Tu(t,e){let n=0,r=0;if("constant"===t.kind)r=t.layoutSize;else if("source"!==t.kind){const{interpolationType:i,minZoom:o,maxZoom:s}=t,a=i?g(xn.interpolationFactor(i,e,o,s),0,1):0;"camera"===t.kind?r=nn(t.minSize,t.maxSize,a):n=a}return{uSizeT:n,uSize:r}}var Pu=Object.freeze({__proto__:null,getSizeData:Eu,evaluateSizeForFeature:Su,evaluateSizeForZoom:Tu,SIZE_PACK_FACTOR:wu});function Mu(t,e,n){return t.sections.forEach((t=>{t.text=function(t,e,n){const r=e.layout.get("text-transform").evaluate(n,{});return"uppercase"===r?t=t.toLocaleUpperCase():"lowercase"===r&&(t=t.toLocaleLowerCase()),oo.applyArabicShaping&&(t=oo.applyArabicShaping(t)),t}(t.text,e,n)})),t}const Cu={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function Iu(t){return""===t||""===t||""===t||""===t||""===t||""===t||""===t||""===t||""===t||""===t||""===t||""===t||""===t||""===t||""===t||""===t||""===t}function Ou(t){return""===t||""===t||""===t||""===t||""===t||""===t||""===t||""===t||""===t||""===t}var Ru=function(t,e,n,r,i){var o,s,a=8*i-r-1,l=(1<<a)-1,u=l>>1,c=-7,h=n?i-1:0,p=n?-1:1,f=t[e+h];for(h+=p,o=f&(1<<-c)-1,f>>=-c,c+=a;c>0;o=256*o+t[e+h],h+=p,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=r;c>0;s=256*s+t[e+h],h+=p,c-=8);if(0===o)o=1-u;else{if(o===l)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,r),o-=u}return(f?-1:1)*s*Math.pow(2,o-r)},Lu=function(t,e,n,r,i,o){var s,a,l,u=8*o-i-1,c=(1<<u)-1,h=c>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,d=r?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),(e+=s+h>=1?p/l:p*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=c?(a=0,s=c):s+h>=1?(a=(e*l-1)*Math.pow(2,i),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;t[n+f]=255&a,f+=d,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;t[n+f]=255&s,f+=d,s/=256,u-=8);t[n+f-d]|=128*g},ku=Du;function Du(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Du.Varint=0,Du.Fixed64=1,Du.Bytes=2,Du.Fixed32=5;var Nu=4294967296,Fu=1/Nu,Bu="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function zu(t){return t.type===Du.Bytes?t.readVarint()+t.pos:t.pos+1}function ju(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function Uu(t,e,n){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(r);for(var i=n.pos-1;i>=t;i--)n.buf[i+r]=n.buf[i]}function Vu(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function Gu(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function Zu(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function qu(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function Wu(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function Hu(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function Xu(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function $u(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function Yu(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function Qu(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function Ku(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function Ju(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function tc(t,e,n){e.glyphs=[],1===t&&n.readMessage(ec,e)}function ec(t,e,n){if(3===t){const{id:t,bitmap:r,width:i,height:o,left:s,top:a,advance:l}=n.readMessage(nc,{});e.glyphs.push({id:t,bitmap:new Za({width:i+6,height:o+6},r),metrics:{width:i,height:o,left:s,top:a,advance:l}})}else 4===t?e.ascender=n.readSVarint():5===t&&(e.descender=n.readSVarint())}function nc(t,e,n){1===t?e.id=n.readVarint():2===t?e.bitmap=n.readBytes():3===t?e.width=n.readVarint():4===t?e.height=n.readVarint():5===t?e.left=n.readSVarint():6===t?e.top=n.readSVarint():7===t&&(e.advance=n.readVarint())}function rc(t){let e=0,n=0;for(const r of t)e+=r.w*r.h,n=Math.max(n,r.w);t.sort(((t,e)=>e.h-t.h));const r=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let i=0,o=0;for(const e of t)for(let t=r.length-1;t>=0;t--){const n=r[t];if(!(e.w>n.w||e.h>n.h)){if(e.x=n.x,e.y=n.y,o=Math.max(o,e.y+e.h),i=Math.max(i,e.x+e.w),e.w===n.w&&e.h===n.h){const e=r.pop();t<r.length&&(r[t]=e)}else e.h===n.h?(n.x+=e.w,n.w-=e.w):e.w===n.w?(n.y+=e.h,n.h-=e.h):(r.push({x:n.x+e.w,y:n.y,w:n.w-e.w,h:e.h}),n.y+=e.h,n.h-=e.h);break}}return{w:i,h:o,fill:e/(i*o)||0}}Du.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),i=r>>3,o=this.pos;this.type=7&r,t(i,e,this),this.pos===o&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Qu(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=Ju(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Qu(this.buf,this.pos)+Qu(this.buf,this.pos+4)*Nu;return this.pos+=8,t},readSFixed64:function(){var t=Qu(this.buf,this.pos)+Ju(this.buf,this.pos+4)*Nu;return this.pos+=8,t},readFloat:function(){var t=Ru(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Ru(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,r=this.buf;return e=127&(n=r[this.pos++]),n<128?e:(e|=(127&(n=r[this.pos++]))<<7,n<128?e:(e|=(127&(n=r[this.pos++]))<<14,n<128?e:(e|=(127&(n=r[this.pos++]))<<21,n<128?e:function(t,e,n){var r,i,o=n.buf;if(r=(112&(i=o[n.pos++]))>>4,i<128)return ju(t,r,e);if(r|=(127&(i=o[n.pos++]))<<3,i<128)return ju(t,r,e);if(r|=(127&(i=o[n.pos++]))<<10,i<128)return ju(t,r,e);if(r|=(127&(i=o[n.pos++]))<<17,i<128)return ju(t,r,e);if(r|=(127&(i=o[n.pos++]))<<24,i<128)return ju(t,r,e);if(r|=(1&(i=o[n.pos++]))<<31,i<128)return ju(t,r,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=r[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&Bu?function(t,e,n){return Bu.decode(t.subarray(e,n))}(this.buf,e,t):function(t,e,n){for(var r="",i=e;i<n;){var o,s,a,l=t[i],u=null,c=l>239?4:l>223?3:l>191?2:1;if(i+c>n)break;1===c?l<128&&(u=l):2===c?128==(192&(o=t[i+1]))&&(u=(31&l)<<6|63&o)<=127&&(u=null):3===c?(s=t[i+2],128==(192&(o=t[i+1]))&&128==(192&s)&&((u=(15&l)<<12|(63&o)<<6|63&s)<=2047||u>=55296&&u<=57343)&&(u=null)):4===c&&(s=t[i+2],a=t[i+3],128==(192&(o=t[i+1]))&&128==(192&s)&&128==(192&a)&&((u=(15&l)<<18|(63&o)<<12|(63&s)<<6|63&a)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,c=1):u>65535&&(u-=65536,r+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),r+=String.fromCharCode(u),i+=c}return r}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Du.Bytes)return t.push(this.readVarint(e));var n=zu(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Du.Bytes)return t.push(this.readSVarint());var e=zu(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Du.Bytes)return t.push(this.readBoolean());var e=zu(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Du.Bytes)return t.push(this.readFloat());var e=zu(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Du.Bytes)return t.push(this.readDouble());var e=zu(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Du.Bytes)return t.push(this.readFixed32());var e=zu(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Du.Bytes)return t.push(this.readSFixed32());var e=zu(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Du.Bytes)return t.push(this.readFixed64());var e=zu(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Du.Bytes)return t.push(this.readSFixed64());var e=zu(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Du.Varint)for(;this.buf[this.pos++]>127;);else if(e===Du.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Du.Fixed32)this.pos+=4;else{if(e!==Du.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Ku(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Ku(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Ku(this.buf,-1&t,this.pos),Ku(this.buf,Math.floor(t*Fu),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Ku(this.buf,-1&t,this.pos),Ku(this.buf,Math.floor(t*Fu),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,r;if(t>=0?(n=t%4294967296|0,r=t/4294967296|0):(r=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,r=r+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,n.buf[n.pos]=127&(t>>>=7)}(n,0,e),function(t,e){var n=(7&t)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(r,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var r,i,o=0;o<e.length;o++){if((r=e.charCodeAt(o))>55295&&r<57344){if(!i){r>56319||o+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):i=r;continue}if(r<56320){t[n++]=239,t[n++]=191,t[n++]=189,i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&(t[n++]=239,t[n++]=191,t[n++]=189,i=null);r<128?t[n++]=r:(r<2048?t[n++]=r>>6|192:(r<65536?t[n++]=r>>12|224:(t[n++]=r>>18|240,t[n++]=r>>12&63|128),t[n++]=r>>6&63|128),t[n++]=63&r|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&Uu(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),Lu(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Lu(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var r=this.pos-n;r>=128&&Uu(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,n){this.writeTag(t,Du.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,Vu,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,Gu,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,Wu,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,Zu,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,qu,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,Hu,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,Xu,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,$u,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,Yu,e)},writeBytesField:function(t,e){this.writeTag(t,Du.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Du.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Du.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Du.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Du.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Du.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Du.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Du.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Du.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Du.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};class ic{constructor(t,{pixelRatio:e,version:n,stretchX:r,stretchY:i,content:o}){this.paddedRect=t,this.pixelRatio=e,this.stretchX=r,this.stretchY=i,this.content=o,this.version=n}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class oc{constructor(t,e){const n={},r={};this.haveRenderCallbacks=[];const i=[];this.addImages(t,n,i),this.addImages(e,r,i);const{w:o,h:s}=rc(i),a=new qa({width:o||1,height:s||1});for(const e in t){const r=t[e],i=n[e].paddedRect;qa.copy(r.data,a,{x:0,y:0},{x:i.x+1,y:i.y+1},r.data)}for(const t in e){const n=e[t],i=r[t].paddedRect,o=i.x+1,s=i.y+1,l=n.data.width,u=n.data.height;qa.copy(n.data,a,{x:0,y:0},{x:o,y:s},n.data),qa.copy(n.data,a,{x:0,y:u-1},{x:o,y:s-1},{width:l,height:1}),qa.copy(n.data,a,{x:0,y:0},{x:o,y:s+u},{width:l,height:1}),qa.copy(n.data,a,{x:l-1,y:0},{x:o-1,y:s},{width:1,height:u}),qa.copy(n.data,a,{x:0,y:0},{x:o+l,y:s},{width:1,height:u})}this.image=a,this.iconPositions=n,this.patternPositions=r}addImages(t,e,n){for(const r in t){const i=t[r],o={x:0,y:0,w:i.data.width+2,h:i.data.height+2};n.push(o),e[r]=new ic(o,i),i.hasRenderCallback&&this.haveRenderCallbacks.push(r)}}patchUpdatedImages(t,e){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const n in t.updatedImages)this.patchUpdatedImage(this.iconPositions[n],t.getImage(n),e),this.patchUpdatedImage(this.patternPositions[n],t.getImage(n),e)}patchUpdatedImage(t,e,n){if(!t||!e)return;if(t.version===e.version)return;t.version=e.version;const[r,i]=t.tl;n.update(e.data,void 0,{x:r,y:i})}}ai("ImagePosition",ic),ai("ImageAtlas",oc);const sc={horizontal:1,vertical:2,horizontalOnly:3};class ac{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,e){const n=new ac;return n.scale=t||1,n.fontStack=e,n}static forImage(t){const e=new ac;return e.imageName=t,e}}class lc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,e){const n=new lc;for(let r=0;r<t.sections.length;r++){const i=t.sections[r];i.image?n.addImageSection(i):n.addTextSection(i,e)}return n}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(t){this.text=function(t,e){let n="";for(let r=0;r<t.length;r++){const i=t.charCodeAt(r+1)||null,o=t.charCodeAt(r-1)||null;n+=!e&&(i&&Zi(i)&&!Cu[t[r+1]]||o&&Zi(o)&&!Cu[t[r-1]])||!Cu[t[r]]?t[r]:Cu[t[r]]}return n}(this.text,t)}trim(){let t=0;for(let e=0;e<this.text.length&&cc[this.text.charCodeAt(e)];e++)t++;let e=this.text.length;for(let n=this.text.length-1;n>=0&&n>=t&&cc[this.text.charCodeAt(n)];n--)e--;this.text=this.text.substring(t,e),this.sectionIndex=this.sectionIndex.slice(t,e)}substring(t,e){const n=new lc;return n.text=this.text.substring(t,e),n.sectionIndex=this.sectionIndex.slice(t,e),n.sections=this.sections,n}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((t,e)=>Math.max(t,this.sections[e].scale)),0)}addTextSection(t,e){this.text+=t.text,this.sections.push(ac.forText(t.scale,t.fontStack||e));const n=this.sections.length-1;for(let e=0;e<t.text.length;++e)this.sectionIndex.push(n)}addImageSection(t){const e=t.image?t.image.name:"";if(0===e.length)return void O("Can't add FormattedSection with an empty image.");const n=this.getNextImageSectionCharCode();n?(this.text+=String.fromCharCode(n),this.sections.push(ac.forImage(e)),this.sectionIndex.push(this.sections.length-1)):O("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function uc(t,e,n,r,i,o,s,a,l,u,c,h,p,f,d,g){const m=lc.fromFeature(t,i);let A;h===sc.vertical&&m.verticalizePunctuation(p);const{processBidirectionalText:y,processStyledBidirectionalText:_}=oo;if(y&&1===m.sections.length){A=[];const t=y(m.toString(),Ac(m,u,o,e,r,f,d));for(const e of t){const t=new lc;t.text=e,t.sections=m.sections;for(let n=0;n<e.length;n++)t.sectionIndex.push(0);A.push(t)}}else if(_){A=[];const t=_(m.text,m.sectionIndex,Ac(m,u,o,e,r,f,d));for(const e of t){const t=new lc;t.text=e[0],t.sectionIndex=e[1],t.sections=m.sections,A.push(t)}}else A=function(t,e){const n=[],r=t.text;let i=0;for(const r of e)n.push(t.substring(i,r)),i=r;return i<r.length&&n.push(t.substring(i,r.length)),n}(m,Ac(m,u,o,e,r,f,d));const v=[],b={positionedLines:v,text:m.toString(),top:c[1],bottom:c[1],left:c[0],right:c[0],writingMode:h,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(t,e,n,r,i,o,s,a,l,u,c,h){let p=0,f=0,d=0;const g="right"===a?1:"left"===a?0:.5;let m=!1;for(const t of i){const n=t.getSections();for(const t of n){if(t.imageName)continue;const n=e[t.fontStack];if(n&&(m=void 0!==n.ascender&&void 0!==n.descender,!m))break}if(!m)break}let A=0;for(const s of i){s.trim();const i=s.getMaxScale(),a=(i-1)*xu,_={positionedGlyphs:[],lineOffset:0};t.positionedLines[A]=_;const v=_.positionedGlyphs;let b=0;if(!s.length()){f+=o,++A;continue}let x=0,w=0;for(let o=0;o<s.length();o++){const a=s.getSection(o),d=s.getSectionIndex(o),g=s.getCharCode(o);let A=a.scale,_=null,E=null,S=null,T=xu,P=0;const M=!(l===sc.horizontal||!c&&!Gi(g)||c&&(cc[g]||(y=g,fi(y)||di(y)||gi(y)||ki(y)||Bi(y))));if(a.imageName){const e=r[a.imageName];if(!e)continue;S=a.imageName,t.iconsInText=t.iconsInText||!0,E=e.paddedRect;const n=e.displaySize;A=A*xu/h,_={width:n[0],height:n[1],left:1,top:-3,advance:M?n[1]:n[0],localGlyph:!1},P=m?-_.height*A:i*xu-17-n[1]*A,T=_.advance;const o=(M?n[0]:n[1])*A-xu*i;o>0&&o>b&&(b=o)}else{const t=n[a.fontStack];if(!t)continue;t[g]&&(E=t[g]);const r=e[a.fontStack];if(!r)continue;const o=r.glyphs[g];if(!o)continue;if(_=o.metrics,T=8203!==g?xu:0,m){const t=void 0!==r.ascender?Math.abs(r.ascender):0,e=void 0!==r.descender?Math.abs(r.descender):0,n=(t+e)*A;x<n&&(x=n,w=(t-e)/2*A),P=-t*A}else P=(i-A)*xu-17}M?(t.verticalizable=!0,v.push({glyph:g,imageName:S,x:p,y:f+P,vertical:M,scale:A,localGlyph:_.localGlyph,fontStack:a.fontStack,sectionIndex:d,metrics:_,rect:E}),p+=T*A+u):(v.push({glyph:g,imageName:S,x:p,y:f+P,vertical:M,scale:A,localGlyph:_.localGlyph,fontStack:a.fontStack,sectionIndex:d,metrics:_,rect:E}),p+=_.advance*A+u)}0!==v.length&&(d=Math.max(p-u,d),m?_c(v,g,b,w,o*i/2):_c(v,g,b,0,o/2)),p=0;const E=o*i+b;_.lineOffset=Math.max(b,a),f+=E,++A}var y;const _=f,{horizontalAlign:v,verticalAlign:b}=yc(s);(function(t,e,n,r,i,o){const s=(e-n)*i,a=-o*r;for(const e of t)for(const t of e.positionedGlyphs)t.x+=s,t.y+=a})(t.positionedLines,g,v,b,d,_),t.top+=-b*_,t.bottom=t.top+_,t.left+=-v*d,t.right=t.left+d,t.hasBaseline=m}(b,e,n,r,A,s,a,l,h,u,p,g),!function(t){for(const e of t)if(0!==e.positionedGlyphs.length)return!1;return!0}(v)&&b}const cc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},hc={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function pc(t,e,n,r,i,o){if(e.imageName){const t=r[e.imageName];return t?t.displaySize[0]*e.scale*xu/o+i:0}{const r=n[e.fontStack],o=r&&r.glyphs[t];return o?o.metrics.advance*e.scale+i:0}}function fc(t,e,n,r){const i=Math.pow(t-e,2);return r?t<e?i/2:2*i:i+Math.abs(n)*n}function dc(t,e,n){let r=0;return 10===t&&(r-=1e4),n&&(r+=150),40!==t&&65288!==t||(r+=50),41!==e&&65289!==e||(r+=50),r}function gc(t,e,n,r,i,o){let s=null,a=fc(e,n,i,o);for(const t of r){const r=fc(e-t.x,n,i,o)+t.badness;r<=a&&(s=t,a=r)}return{index:t,x:e,priorBreak:s,badness:a}}function mc(t){return t?mc(t.priorBreak).concat(t.index):[]}function Ac(t,e,n,r,i,o,s){if("point"!==o)return[];if(!t)return[];const a=[],l=function(t,e,n,r,i,o){let s=0;for(let n=0;n<t.length();n++){const a=t.getSection(n);s+=pc(t.getCharCode(n),a,r,i,e,o)}return s/Math.max(1,Math.ceil(s/n))}(t,e,n,r,i,s),u=t.text.indexOf("")>=0;let c=0;for(let n=0;n<t.length();n++){const o=t.getSection(n),p=t.getCharCode(n);if(cc[p]||(c+=pc(p,o,r,i,e,s)),n<t.length()-1){const e=!((h=p)<11904||!(wi(h)||xi(h)||Ni(h)||Li(h)||Pi(h)||mi(h)||Ei(h)||_i(h)||Mi(h)||Ci(h)||Ti(h)||zi(h)||vi(h)||yi(h)||Ai(h)||Si(h)||bi(h)||Di(h)||Oi(h)||Ii(h)));(hc[p]||e||o.imageName)&&a.push(gc(n+1,c,l,a,dc(p,t.getCharCode(n+1),e&&u),!1))}}var h;return mc(gc(t.length(),c,l,a,0,!0))}function yc(t){let e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function _c(t,e,n,r,i){if(!(e||n||r||i))return;const o=t.length-1,s=t[o],a=(s.x+s.metrics.advance*s.scale)*e;for(let e=0;e<=o;e++)t[e].x-=a,t[e].y+=n+r+i}function vc(t,e,n){const{horizontalAlign:r,verticalAlign:i}=yc(n),o=e[0]-t.displaySize[0]*r,s=e[1]-t.displaySize[1]*i;return{image:t,top:s,bottom:s+t.displaySize[1],left:o,right:o+t.displaySize[0]}}function bc(t,e,n,r,i,o){const s=t.image;let a;if(s.content){const t=s.content,e=s.pixelRatio||1;a=[t[0]/e,t[1]/e,s.displaySize[0]-t[2]/e,s.displaySize[1]-t[3]/e]}const l=e.left*o,u=e.right*o;let c,h,p,f;"width"===n||"both"===n?(f=i[0]+l-r[3],h=i[0]+u+r[1]):(f=i[0]+(l+u-s.displaySize[0])/2,h=f+s.displaySize[0]);const d=e.top*o,g=e.bottom*o;return"height"===n||"both"===n?(c=i[1]+d-r[0],p=i[1]+g+r[2]):(c=i[1]+(d+g-s.displaySize[1])/2,p=c+s.displaySize[1]),{image:s,top:c,right:h,bottom:p,left:f,collisionPadding:a}}class xc extends i{constructor(t,e,n,r,i){super(t,e),this.angle=r,this.z=n,void 0!==i&&(this.segment=i)}clone(){return new xc(this.x,this.y,this.z,this.angle,this.segment)}}function wc(t,e,n,r,i){if(void 0===e.segment)return!0;let o=e,s=e.segment+1,a=0;for(;a>-n/2;){if(s--,s<0)return!1;a-=t[s].dist(o),o=t[s]}a+=t[s].dist(t[s+1]),s++;const l=[];let u=0;for(;a<n/2;){const e=t[s],n=t[s+1];if(!n)return!1;let o=t[s-1].angleTo(e)-e.angleTo(n);for(o=Math.abs((o+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:a,angleDelta:o}),u+=o;a-l[0].distance>r;)u-=l.shift().angleDelta;if(u>i)return!1;s++,a+=e.dist(n)}return!0}function Ec(t){let e=0;for(let n=0;n<t.length-1;n++)e+=t[n].dist(t[n+1]);return e}function Sc(t,e,n){return t?.6*e*n:0}function Tc(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function Pc(t,e,n,r,i,o){const s=Sc(n,i,o),a=Tc(n,r)*o;let l=0;const u=Ec(t)/2;for(let n=0;n<t.length-1;n++){const r=t[n],i=t[n+1],o=r.dist(i);if(l+o>u){const c=(u-l)/o,h=nn(r.x,i.x,c),p=nn(r.y,i.y,c),f=new xc(h,p,0,i.angleTo(r),n);return!s||wc(t,f,a,s,e)?f:void 0}l+=o}}function Mc(t,e,n,r,i,o,s,a,l){const u=Sc(r,o,s),c=Tc(r,i),h=c*s,p=0===t[0].x||t[0].x===l||0===t[0].y||t[0].y===l;return e-h<e/4&&(e=h+e/4),Cc(t,p?e/2*a%e:(c/2+2*o)*s*a%e,e,u,n,h,p,!1,l)}function Cc(t,e,n,r,i,o,s,a,l){const u=o/2,c=Ec(t);let h=0,p=e-n,f=[];for(let e=0;e<t.length-1;e++){const s=t[e],a=t[e+1],d=s.dist(a),g=a.angleTo(s);for(;p+n<h+d;){p+=n;const m=(p-h)/d,A=nn(s.x,a.x,m),y=nn(s.y,a.y,m);if(A>=0&&A<l&&y>=0&&y<l&&p-u>=0&&p+u<=c){const n=new xc(A,y,0,g,e);n._round(),r&&!wc(t,n,o,r,i)||f.push(n)}}h+=d}return a||f.length||s||(f=Cc(t,h/2,n,r,i,o,s,!0,l)),f}function Ic(t,e,n,r,o){const s=[];for(let a=0;a<t.length;a++){const l=t[a];let u;for(let t=0;t<l.length-1;t++){let a=l[t],c=l[t+1];a.x<e&&c.x<e||(a.x<e?a=new i(e,a.y+(e-a.x)/(c.x-a.x)*(c.y-a.y))._round():c.x<e&&(c=new i(e,a.y+(e-a.x)/(c.x-a.x)*(c.y-a.y))._round()),a.y<n&&c.y<n||(a.y<n?a=new i(a.x+(n-a.y)/(c.y-a.y)*(c.x-a.x),n)._round():c.y<n&&(c=new i(a.x+(n-a.y)/(c.y-a.y)*(c.x-a.x),n)._round()),a.x>=r&&c.x>=r||(a.x>=r?a=new i(r,a.y+(r-a.x)/(c.x-a.x)*(c.y-a.y))._round():c.x>=r&&(c=new i(r,a.y+(r-a.x)/(c.x-a.x)*(c.y-a.y))._round()),a.y>=o&&c.y>=o||(a.y>=o?a=new i(a.x+(o-a.y)/(c.y-a.y)*(c.x-a.x),o)._round():c.y>=o&&(c=new i(a.x+(o-a.y)/(c.y-a.y)*(c.x-a.x),o)._round()),u&&a.equals(u[u.length-1])||(u=[a],s.push(u)),u.push(c)))))}}return s}ai("Anchor",xc);const Oc=1e20;function Rc(t,e,n,r,i,o,s,a,l){for(let u=e;u<e+r;u++)Lc(t,n*o+u,o,i,s,a,l);for(let u=n;u<n+i;u++)Lc(t,u*o+e,1,r,s,a,l)}function Lc(t,e,n,r,i,o,s){o[0]=0,s[0]=-Oc,s[1]=Oc,i[0]=t[e];for(let a=1,l=0,u=0;a<r;a++){i[a]=t[e+a*n];const r=a*a;do{const t=o[l];u=(i[a]-i[t]+r-t*t)/(a-t)/2}while(u<=s[l]&&--l>-1);l++,o[l]=a,s[l]=u,s[l+1]=Oc}for(let a=0,l=0;a<r;a++){for(;s[l+1]<a;)l++;const r=o[l],u=a-r;t[e+a*n]=i[r]+u*u}}const kc={none:0,ideographs:1,all:2};class Dc{constructor(t,e,n){this.requestManager=t,this.localGlyphMode=e,this.localFontFamily=n,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t){this.url=t}getGlyphs(t,e){const n=[];for(const e in t)for(const r of t[e])n.push({stack:e,id:r});A(n,(({stack:t,id:e},n)=>{let r=this.entries[t];r||(r=this.entries[t]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let i=r.glyphs[e];if(void 0!==i)return void n(null,{stack:t,id:e,glyph:i});if(i=this._tinySDF(r,t,e),i)return r.glyphs[e]=i,void n(null,{stack:t,id:e,glyph:i});const o=Math.floor(e/256);if(256*o>65535)return void n(new Error("glyphs > 65535 not supported"));if(r.ranges[o])return void n(null,{stack:t,id:e,glyph:i});let s=r.requests[o];s||(s=r.requests[o]=[],Dc.loadGlyphRange(t,o,this.url,this.requestManager,((t,e)=>{if(e){r.ascender=e.ascender,r.descender=e.descender;for(const t in e.glyphs)this._doesCharSupportLocalGlyph(+t)||(r.glyphs[+t]=e.glyphs[+t]);r.ranges[o]=!0}for(const n of s)n(t,e);delete r.requests[o]}))),s.push(((r,i)=>{r?n(r):i&&n(null,{stack:t,id:e,glyph:i.glyphs[e]||null})}))}),((t,n)=>{if(t)e(t);else if(n){const t={};for(const{stack:e,id:r,glyph:i}of n)void 0===t[e]&&(t[e]={}),void 0===t[e].glyphs&&(t[e].glyphs={}),t[e].glyphs[r]=i&&{id:i.id,bitmap:i.bitmap.clone(),metrics:i.metrics},t[e].ascender=this.entries[e].ascender,t[e].descender=this.entries[e].descender;e(null,t)}}))}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==kc.none&&(this.localGlyphMode===kc.all?!!this.localFontFamily:!!this.localFontFamily&&(Ci(t)||Ri(t)||vi(t)||bi(t))||_i(t))}_tinySDF(t,e,n){const r=this.localFontFamily;if(!r||!this._doesCharSupportLocalGlyph(n))return;let i=t.tinySDF;if(!i){let n="400";/bold/i.test(e)?n="900":/medium/i.test(e)?n="500":/light/i.test(e)&&(n="200"),i=t.tinySDF=new Dc.TinySDF({fontFamily:r,fontWeight:n,fontSize:48,buffer:6,radius:16}),i.fontWeight=n}if(this.localGlyphs[i.fontWeight][n])return this.localGlyphs[i.fontWeight][n];const o=String.fromCharCode(n),{data:s,width:a,height:l,glyphWidth:u,glyphHeight:c,glyphLeft:h,glyphTop:p,glyphAdvance:f}=i.draw(o);return this.localGlyphs[i.fontWeight][n]={id:n,bitmap:new Za({width:a,height:l},s),metrics:{width:u/2,height:c/2,left:h/2,top:p/2-27,advance:f/2,localGlyph:!0}}}}function Nc(t,e,n,r){const o=[],s=t.image,a=s.pixelRatio,l=s.paddedRect.w-2,u=s.paddedRect.h-2,c=t.right-t.left,h=t.bottom-t.top,p=s.stretchX||[[0,l]],f=s.stretchY||[[0,u]],d=(t,e)=>t+e[1]-e[0],g=p.reduce(d,0),m=f.reduce(d,0),A=l-g,y=u-m;let _=0,v=g,b=0,x=m,w=0,E=A,S=0,T=y;if(s.content&&r){const t=s.content;_=Fc(p,0,t[0]),b=Fc(f,0,t[1]),v=Fc(p,t[0],t[2]),x=Fc(f,t[1],t[3]),w=t[0]-_,S=t[1]-b,E=t[2]-t[0]-v,T=t[3]-t[1]-x}const P=(r,o,l,u)=>{const p=zc(r.stretch-_,v,c,t.left),f=jc(r.fixed-w,E,r.stretch,g),d=zc(o.stretch-b,x,h,t.top),A=jc(o.fixed-S,T,o.stretch,m),y=zc(l.stretch-_,v,c,t.left),P=jc(l.fixed-w,E,l.stretch,g),M=zc(u.stretch-b,x,h,t.top),C=jc(u.fixed-S,T,u.stretch,m),I=new i(p,d),O=new i(y,d),R=new i(y,M),L=new i(p,M),k=new i(f/a,A/a),D=new i(P/a,C/a),N=e*Math.PI/180;if(N){const t=Math.sin(N),e=Math.cos(N),n=[e,-t,t,e];I._matMult(n),O._matMult(n),L._matMult(n),R._matMult(n)}const F=r.stretch+r.fixed,B=o.stretch+o.fixed;return{tl:I,tr:O,bl:L,br:R,tex:{x:s.paddedRect.x+1+F,y:s.paddedRect.y+1+B,w:l.stretch+l.fixed-F,h:u.stretch+u.fixed-B},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:k,pixelOffsetBR:D,minFontScaleX:E/a/c,minFontScaleY:T/a/h,isSDF:n}};if(r&&(s.stretchX||s.stretchY)){const t=Bc(p,A,g),e=Bc(f,y,m);for(let n=0;n<t.length-1;n++){const r=t[n],i=t[n+1];for(let t=0;t<e.length-1;t++)o.push(P(r,e[t],i,e[t+1]))}}else o.push(P({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:l+1},{fixed:0,stretch:u+1}));return o}function Fc(t,e,n){let r=0;for(const i of t)r+=Math.max(e,Math.min(n,i[1]))-Math.max(e,Math.min(n,i[0]));return r}function Bc(t,e,n){const r=[{fixed:-1,stretch:0}];for(const[e,n]of t){const t=r[r.length-1];r.push({fixed:e-t.stretch,stretch:t.stretch}),r.push({fixed:e-t.stretch,stretch:t.stretch+(n-e)})}return r.push({fixed:e+1,stretch:n}),r}function zc(t,e,n,r){return t/e*n+r}function jc(t,e,n,r){return t-e*n/r}function Uc(t,e,n,r){const i=e+t.positionedLines[r].lineOffset;return 0===r?n+i/2:n+(i+(e+t.positionedLines[r-1].lineOffset))/2}Dc.loadGlyphRange=function(t,e,n,r,i){const o=256*e,s=o+255,a=r.transformRequest(r.normalizeGlyphsURL(n).replace("{fontstack}",t).replace("{range}",`${o}-${s}`),bt.Glyphs);St(a,((t,e)=>{if(t)i(t);else if(e){const t={},n=function(t){return new ku(t).readFields(tc,{})}(e);for(const e of n.glyphs)t[e.id]=e;i(null,{glyphs:t,ascender:n.ascender,descender:n.descender})}}))},Dc.TinySDF=class{constructor({fontSize:t=24,buffer:e=3,radius:n=8,cutoff:r=.25,fontFamily:i="sans-serif",fontWeight:o="normal",fontStyle:s="normal"}){this.buffer=e,this.cutoff=r,this.radius=n;const a=this.size=t+4*e,l=this._createCanvas(a),u=this.ctx=l.getContext("2d",{willReadFrequently:!0});u.font=`${s} ${o} ${t}px ${i}`,u.textBaseline="alphabetic",u.textAlign="left",u.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Uint16Array(a)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:r,actualBoundingBoxLeft:i,actualBoundingBoxRight:o}=this.ctx.measureText(t),s=Math.floor(n),a=Math.min(this.size-this.buffer,Math.ceil(o-i)),l=Math.min(this.size-this.buffer,Math.ceil(n)+Math.ceil(r)),u=a+2*this.buffer,c=l+2*this.buffer,h=u*c,p=new Uint8ClampedArray(h),f={data:p,width:u,height:c,glyphWidth:a,glyphHeight:l,glyphTop:s,glyphLeft:0,glyphAdvance:e};if(0===a||0===l)return f;const{ctx:d,buffer:g,gridInner:m,gridOuter:A}=this;d.clearRect(g,g,a,l),d.fillText(t,g,g+s+1);const y=d.getImageData(g,g,a,l);A.fill(Oc,0,h),m.fill(0,0,h);for(let t=0;t<l;t++)for(let e=0;e<a;e++){const n=y.data[4*(t*a+e)+3]/255;if(0===n)continue;const r=(t+g)*u+e+g;if(1===n)A[r]=0,m[r]=Oc;else{const t=.5-n;A[r]=t>0?t*t:0,m[r]=t<0?t*t:0}}Rc(A,0,0,u,c,u,this.f,this.v,this.z),Rc(m,g,g,a,l,u,this.f,this.v,this.z);for(let t=0;t<h;t++){const e=Math.sqrt(A[t])-Math.sqrt(m[t]);p[t]=Math.round(255-255*(e/this.radius+this.cutoff))}return f}};class Vc{constructor(t=[],e=Gc){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let t=(this.length>>1)-1;t>=0;t--)this._down(t)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:n}=this,r=e[t];for(;t>0;){const i=t-1>>1,o=e[i];if(n(r,o)>=0)break;e[t]=o,t=i}e[t]=r}_down(t){const{data:e,compare:n}=this,r=this.length>>1,i=e[t];for(;t<r;){let r=1+(t<<1),o=e[r];const s=r+1;if(s<this.length&&n(e[s],o)<0&&(r=s,o=e[s]),n(o,i)>=0)break;e[t]=o,t=r}e[t]=i}}function Gc(t,e){return t<e?-1:t>e?1:0}function Zc(t,e=1,n=!1){let r=1/0,o=1/0,s=-1/0,a=-1/0;const l=t[0];for(let t=0;t<l.length;t++){const e=l[t];(!t||e.x<r)&&(r=e.x),(!t||e.y<o)&&(o=e.y),(!t||e.x>s)&&(s=e.x),(!t||e.y>a)&&(a=e.y)}const u=Math.min(s-r,a-o);let c=u/2;const h=new Vc([],qc);if(0===u)return new i(r,o);for(let e=r;e<s;e+=u)for(let n=o;n<a;n+=u)h.push(new Wc(e+c,n+c,c,t));let p=function(t){let e=0,n=0,r=0;const i=t[0];for(let t=0,o=i.length,s=o-1;t<o;s=t++){const o=i[t],a=i[s],l=o.x*a.y-a.x*o.y;n+=(o.x+a.x)*l,r+=(o.y+a.y)*l,e+=3*l}return new Wc(n/e,r/e,0,t)}(t),f=h.length;for(;h.length;){const r=h.pop();(r.d>p.d||!p.d)&&(p=r,n&&console.log("found best %d after %d probes",Math.round(1e4*r.d)/1e4,f)),r.max-p.d<=e||(c=r.h/2,h.push(new Wc(r.p.x-c,r.p.y-c,c,t)),h.push(new Wc(r.p.x+c,r.p.y-c,c,t)),h.push(new Wc(r.p.x-c,r.p.y+c,c,t)),h.push(new Wc(r.p.x+c,r.p.y+c,c,t)),f+=4)}return n&&(console.log(`num probes: ${f}`),console.log(`best distance: ${p.d}`)),p.p}function qc(t,e){return e.max-t.max}function Wc(t,e,n,r){this.p=new i(t,e),this.h=n,this.d=function(t,e){let n=!1,r=1/0;for(let i=0;i<e.length;i++){const o=e[i];for(let e=0,i=o.length,s=i-1;e<i;s=e++){const i=o[e],a=o[s];i.y>t.y!=a.y>t.y&&t.x<(a.x-i.x)*(t.y-i.y)/(a.y-i.y)+i.x&&(n=!n),r=Math.min(r,ra(t,i,a))}}return(n?1:-1)*Math.sqrt(r)}(this.p,r),this.max=this.d+this.h*Math.SQRT2}const Hc=Number.POSITIVE_INFINITY,Xc=Math.sqrt(2);function $c(t,e){return e[1]!==Hc?function(t,e,n){let r=0,i=0;switch(e=Math.abs(e),n=Math.abs(n),t){case"top-right":case"top-left":case"top":i=n-7;break;case"bottom-right":case"bottom-left":case"bottom":i=7-n}switch(t){case"top-right":case"bottom-right":case"right":r=-e;break;case"top-left":case"bottom-left":case"left":r=e}return[r,i]}(t,e[0],e[1]):function(t,e){let n=0,r=0;e<0&&(e=0);const i=e/Xc;switch(t){case"top-right":case"top-left":r=i-7;break;case"bottom-right":case"bottom-left":r=7-i;break;case"bottom":r=7-e;break;case"top":r=e-7}switch(t){case"top-right":case"bottom-right":n=-i;break;case"top-left":case"bottom-left":n=i;break;case"left":n=e;break;case"right":n=-e}return[n,r]}(t,e[0])}function Yc(t,e,n,r,i,o,s,a){t.createArrays(),t.tilePixelRatio=Gs/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;const l=t.layers[0].layout,u=t.layers[0]._unevaluatedLayout._values,c={};if("composite"===t.textSizeData.kind){const{minZoom:e,maxZoom:n}=t.textSizeData;c.compositeTextSizes=[u["text-size"].possiblyEvaluate(new so(e),s),u["text-size"].possiblyEvaluate(new so(n),s)]}if("composite"===t.iconSizeData.kind){const{minZoom:e,maxZoom:n}=t.iconSizeData;c.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new so(e),s),u["icon-size"].possiblyEvaluate(new so(n),s)]}c.layoutTextSize=u["text-size"].possiblyEvaluate(new so(a+1),s),c.layoutIconSize=u["icon-size"].possiblyEvaluate(new so(a+1),s),c.textMaxSize=u["text-size"].possiblyEvaluate(new so(18),s);const h="map"===l.get("text-rotation-alignment")&&"point"!==l.get("symbol-placement"),p=l.get("text-size");for(const o of t.features){const a=l.get("text-font").evaluate(o,{},s).join(","),u=p.evaluate(o,{},s),f=c.layoutTextSize.evaluate(o,{},s),d=(c.layoutIconSize.evaluate(o,{},s),{horizontal:{},vertical:void 0}),g=o.text;let m,A=[0,0];if(g){const r=g.toString(),c=l.get("text-letter-spacing").evaluate(o,{},s)*xu,p=l.get("text-line-height").evaluate(o,{},s)*xu,m=Ui(r)?c:0,y=l.get("text-anchor").evaluate(o,{},s),_=l.get("text-variable-anchor");if(!_){const t=l.get("text-radial-offset").evaluate(o,{},s);A=t?$c(y,[t*xu,Hc]):l.get("text-offset").evaluate(o,{},s).map((t=>t*xu))}let v=h?"center":l.get("text-justify").evaluate(o,{},s);const b=l.get("symbol-placement"),x="point"===b,w="point"===b?l.get("text-max-width").evaluate(o,{},s)*xu:0,E=o=>{t.allowVerticalPlacement&&ji(r)&&(d.vertical=uc(g,e,n,i,a,w,p,y,o,m,A,sc.vertical,!0,b,f,u))};if(!h&&_){const t="auto"===v?_.map((t=>Qc(t))):[v];let r=!1;for(let o=0;o<t.length;o++){const s=t[o];if(!d.horizontal[s])if(r)d.horizontal[s]=d.horizontal[0];else{const t=uc(g,e,n,i,a,w,p,"center",s,m,A,sc.horizontal,!1,b,f,u);t&&(d.horizontal[s]=t,r=1===t.positionedLines.length)}}E("left")}else{if("auto"===v&&(v=Qc(y)),x||l.get("text-writing-mode").indexOf("horizontal")>=0||!ji(r)){const t=uc(g,e,n,i,a,w,p,y,v,m,A,sc.horizontal,!1,b,f,u);t&&(d.horizontal[v]=t)}E("point"===b?"left":v)}}let y=!1;if(o.icon&&o.icon.name){const e=r[o.icon.name];e&&(m=vc(i[o.icon.name],l.get("icon-offset").evaluate(o,{},s),l.get("icon-anchor").evaluate(o,{},s)),y=e.sdf,void 0===t.sdfIcons?t.sdfIcons=e.sdf:t.sdfIcons!==e.sdf&&O("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(e.pixelRatio!==t.pixelRatio||0!==l.get("icon-rotate").constantOr(1))&&(t.iconsNeedLinear=!0))}const _=eh(d.horizontal)||d.vertical;t.iconsInText||(t.iconsInText=!!_&&_.iconsInText),(_||m)&&Kc(t,o,d,m,r,c,f,0,A,y,s)}o&&t.generateCollisionDebugBuffers(a,t.collisionBoxArray)}function Qc(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Kc(t,e,n,r,i,o,s,a,l,u,h){let p=o.textMaxSize.evaluate(e,{},h);void 0===p&&(p=s);const f=t.layers[0].layout,d=f.get("icon-offset").evaluate(e,{},h),g=eh(n.horizontal)||n.vertical,m=s/24,A=t.tilePixelRatio*p/24,y=t.tilePixelRatio*f.get("symbol-spacing"),_=f.get("text-padding")*t.tilePixelRatio,v=f.get("icon-padding")*t.tilePixelRatio,b=c(f.get("text-max-angle")),x="map"===f.get("text-rotation-alignment")&&"point"!==f.get("symbol-placement"),w="map"===f.get("icon-rotation-alignment")&&"point"!==f.get("symbol-placement"),E=f.get("symbol-placement"),S=y/2,T=f.get("icon-text-fit");let P;r&&"none"!==T&&(t.allowVerticalPlacement&&n.vertical&&(P=bc(r,n.vertical,T,f.get("icon-text-fit-padding"),d,m)),g&&(r=bc(r,g,T,f.get("icon-text-fit-padding"),d,m)));const M=(s,a)=>{a.x<0||a.x>=Gs||a.y<0||a.y>=Gs||function(t,e,n,r,i,o,s,a,l,u,c,h,p,f,d,g,m,A,y,_,v,b,x,w){const E=t.addToLineVertexArray(e,r);let S,T,P,M,C,I,R,L=0,k=0,D=0,N=0,F=-1,B=-1;const z={};let j=fs(""),U=0,V=0;if(void 0===l._unevaluatedLayout.getValue("text-radial-offset")?[U,V]=l.layout.get("text-offset").evaluate(v,{},w).map((t=>t*xu)):(U=l.layout.get("text-radial-offset").evaluate(v,{},w)*xu,V=Hc),t.allowVerticalPlacement&&i.vertical){const t=i.vertical;if(d)I=rh(t),a&&(R=rh(a));else{const r=l.layout.get("text-rotate").evaluate(v,{},w)+90;P=nh(u,n,e,c,h,p,t,f,r,g),a&&(M=nh(u,n,e,c,h,p,a,A,r))}}if(o){const r=l.layout.get("icon-rotate").evaluate(v,{},w),i="none"!==l.layout.get("icon-text-fit"),s=Nc(o,r,x,i),f=a?Nc(a,r,x,i):void 0;T=nh(u,n,e,c,h,p,o,A,r),L=4*s.length;const d=t.iconSizeData;let g=null;"source"===d.kind?(g=[wu*l.layout.get("icon-size").evaluate(v,{},w)],g[0]>Jc&&O(`${t.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===d.kind&&(g=[wu*b.compositeIconSizes[0].evaluate(v,{},w),wu*b.compositeIconSizes[1].evaluate(v,{},w)],(g[0]>Jc||g[1]>Jc)&&O(`${t.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),t.addSymbols(t.icon,s,g,_,y,v,!1,n,e,E.lineStartIndex,E.lineLength,-1,w),F=t.icon.placedSymbolArray.length-1,f&&(k=4*f.length,t.addSymbols(t.icon,f,g,_,y,v,sc.vertical,n,e,E.lineStartIndex,E.lineLength,-1,w),B=t.icon.placedSymbolArray.length-1)}for(const r in i.horizontal){const o=i.horizontal[r];S||(j=fs(o.text),d?C=rh(o):S=nh(u,n,e,c,h,p,o,f,l.layout.get("text-rotate").evaluate(v,{},w),g));const a=1===o.positionedLines.length;if(D+=th(t,n,e,o,s,l,d,v,g,E,i.vertical?sc.horizontal:sc.horizontalOnly,a?Object.keys(i.horizontal):[r],z,F,b,w),a)break}i.vertical&&(N+=th(t,n,e,i.vertical,s,l,d,v,g,E,sc.vertical,["vertical"],z,B,b,w));let G=-1;const Z=(t,e)=>t?Math.max(t,e):e;G=Z(C,G),G=Z(I,G),G=Z(R,G);const q=G>-1?1:0;t.glyphOffsetArray.length>=ph.MAX_GLYPHS&&O("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==v.sortKey&&t.addToSortKeyRanges(t.symbolInstances.length,v.sortKey),t.symbolInstances.emplaceBack(n.x,n.y,n.z,e.x,e.y,z.right>=0?z.right:-1,z.center>=0?z.center:-1,z.left>=0?z.left:-1,z.vertical>=0?z.vertical:-1,F,B,j,void 0!==S?S:t.collisionBoxArray.length,void 0!==S?S+1:t.collisionBoxArray.length,void 0!==P?P:t.collisionBoxArray.length,void 0!==P?P+1:t.collisionBoxArray.length,void 0!==T?T:t.collisionBoxArray.length,void 0!==T?T+1:t.collisionBoxArray.length,M||t.collisionBoxArray.length,M?M+1:t.collisionBoxArray.length,c,D,N,L,k,q,0,U,V,G)}(t,a,a,s,n,r,i,P,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,_,x,l,0,v,w,d,e,o,u,h)};if("line"===E)for(const i of Ic(e.geometry,0,0,Gs,Gs)){const e=Mc(i,y,b,n.vertical||g,r,24,A,t.overscaling,Gs);for(const n of e){const e=g;e&&ih(t,e.text,S,n)||M(i,n)}}else if("line-center"===E){for(const t of e.geometry)if(t.length>1){const e=Pc(t,b,n.vertical||g,r,24,A);e&&M(t,e)}}else if("Polygon"===e.type)for(const t of Cl(e.geometry,0)){const e=Zc(t,16);M(t[0],new xc(e.x,e.y,0,0,void 0))}else if("LineString"===e.type)for(const t of e.geometry)M(t,new xc(t[0].x,t[0].y,0,0,void 0));else if("Point"===e.type)for(const t of e.geometry)for(const e of t)M([e],new xc(e.x,e.y,0,0,void 0))}const Jc=32640;function th(t,e,n,r,o,s,a,l,u,c,h,p,f,d,g,m){const A=function(t,e,n,r,o,s,a,l){const u=[];if(0===e.positionedLines.length)return u;const c=r.layout.get("text-rotate").evaluate(s,{})*Math.PI/180,h=function(t){const e=t[0],n=t[1],r=e*n;return r>0?[e,-n]:r<0?[-e,n]:0===e?[n,e]:[n,-e]}(n);let p=Math.abs(e.top-e.bottom);for(const t of e.positionedLines)p-=t.lineOffset;const f=e.positionedLines.length,d=p/f;let g=e.top-n[1];for(let t=0;t<f;++t){const r=e.positionedLines[t];g=Uc(e,d,g,t);for(const t of r.positionedGlyphs){if(!t.rect)continue;const r=t.rect||{};let s=4,p=!0,f=1,d=0;if(t.imageName){const e=a[t.imageName];if(!e)continue;if(e.sdf){O("SDF images are not supported in formatted text and will be ignored.");continue}p=!1,f=e.pixelRatio,s=1/f}const m=(o||l)&&t.vertical,A=t.metrics.advance*t.scale/2,y=t.metrics,_=t.rect;if(null===_)continue;l&&e.verticalizable&&(d=t.imageName?A-t.metrics.width*t.scale/2:0);const v=o?[t.x+A,t.y]:[0,0];let b=[0,0],x=[0,0],w=!1;o||(m?(x=[t.x+A+h[0],t.y+h[1]-d],w=!0):b=[t.x+A+n[0],t.y+n[1]-d]);const E=_.w*t.scale/(f*(t.localGlyph?2:1)),S=_.h*t.scale/(f*(t.localGlyph?2:1));let T,P,M,C;if(m){const e=t.y-g,n=new i(-A,A-e),r=-Math.PI/2,o=new i(...x);T=new i(-A+b[0],b[1]),T._rotateAround(r,n)._add(o),T.x+=-e+A,T.y-=(y.left-s)*t.scale;const a=t.imageName?y.advance*t.scale:xu*t.scale,l=String.fromCharCode(t.glyph);Iu(l)?T.x+=(1-s)*t.scale:Ou(l)?T.x+=a-y.height*t.scale+(-s-1)*t.scale:T.x+=t.imageName||y.width+2*s===_.w&&y.height+2*s===_.h?(a-S)/2:(a-(y.height+2*s)*t.scale)/2,P=new i(T.x,T.y-E),M=new i(T.x+S,T.y),C=new i(T.x+S,T.y-E)}else{const e=(y.left-s)*t.scale-A+b[0],n=(-y.top-s)*t.scale+b[1],r=e+E,o=n+S;T=new i(e,n),P=new i(r,n),M=new i(e,o),C=new i(r,o)}if(c){let t;t=o?new i(0,0):w?new i(h[0],h[1]):new i(n[0],n[1]),T._rotateAround(c,t),P._rotateAround(c,t),M._rotateAround(c,t),C._rotateAround(c,t)}const I=new i(0,0),R=new i(0,0);u.push({tl:T,tr:P,bl:M,br:C,tex:r,writingMode:e.writingMode,glyphOffset:v,sectionIndex:t.sectionIndex,isSDF:p,pixelOffsetTL:I,pixelOffsetBR:R,minFontScaleX:0,minFontScaleY:0})}}return u}(0,r,u,s,a,l,o,t.allowVerticalPlacement),y=t.textSizeData;let _=null;"source"===y.kind?(_=[wu*s.layout.get("text-size").evaluate(l,{},m)],_[0]>Jc&&O(`${t.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===y.kind&&(_=[wu*g.compositeTextSizes[0].evaluate(l,{},m),wu*g.compositeTextSizes[1].evaluate(l,{},m)],(_[0]>Jc||_[1]>Jc)&&O(`${t.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),t.addSymbols(t.text,A,_,u,a,l,h,e,n,c.lineStartIndex,c.lineLength,d,m);for(const e of p)f[e]=t.text.placedSymbolArray.length-1;return 4*A.length}function eh(t){for(const e in t)return t[e];return null}function nh(t,e,n,r,o,s,a,l,u,h){let p=a.top,f=a.bottom,d=a.left,g=a.right;const m=a.collisionPadding;if(m&&(d-=m[0],p-=m[1],g+=m[2],f+=m[3]),u){const t=new i(d,p),e=new i(g,p),n=new i(d,f),r=new i(g,f),o=c(u);let s=new i(0,0);h&&(s=new i(h[0],h[1])),t._rotateAround(o,s),e._rotateAround(o,s),n._rotateAround(o,s),r._rotateAround(o,s),d=Math.min(t.x,e.x,n.x,r.x),g=Math.max(t.x,e.x,n.x,r.x),p=Math.min(t.y,e.y,n.y,r.y),f=Math.max(t.y,e.y,n.y,r.y)}return t.emplaceBack(e.x,e.y,e.z,n.x,n.y,d,p,g,f,l,r,o,s),t.length-1}function rh(t){t.collisionPadding&&(t.top-=t.collisionPadding[1],t.bottom+=t.collisionPadding[3]);const e=t.bottom-t.top;return e>0?Math.max(10,e):null}function ih(t,e,n,r){const i=t.compareText;if(e in i){const t=i[e];for(let e=t.length-1;e>=0;e--)if(r.dist(t[e])<n)return!0}else i[e]=[];return i[e].push(r),!1}const oh=Hl.VectorTileFeature.types,sh=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ah(t,e,n,r,i,o,s,a,l,u,c,h,p,f,d,g){const m=c?Math.min(Jc,Math.round(c[0])):0,A=c?Math.min(Jc,Math.round(c[1])):0;t.emplaceBack(e,n,Math.round(32*s),Math.round(32*a),l,u,(m<<1)+(h?1:0),A,16*p,16*f,256*d,256*g,r,i,o,0)}function lh(t,e,n){t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n)}function uh(t){for(const e of t.sections)if(Hi(e.text))return!0;return!1}class ch{constructor(t){this.layoutVertexArray=new ko,this.indexArray=new jo,this.programConfigurations=t,this.segments=new Vs,this.dynamicLayoutVertexArray=new Oo,this.opacityVertexArray=new Do,this.placedSymbolArray=new ts}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(t,e,n,r){this.isEmpty()||(n&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,mu.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Au.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,sh,!0),this.opacityVertexBuffer.itemSize=1),(n||r)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}ai("SymbolBuffers",ch);class hh{constructor(t,e,n){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new n,this.segments=new Vs,this.collisionVertexArray=new zo,this.collisionVertexArrayExt=new Oo}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,yu.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,_u.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}ai("CollisionBuffers",hh);class ph{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ma([]),this.placementViewportMatrix=ma([]);const e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Eu(this.zoom,e["text-size"]),this.iconSizeData=Eu(this.zoom,e["icon-size"]);const n=this.layers[0].layout,r=n.get("symbol-sort-key"),i=n.get("symbol-z-order");this.canOverlap=n.get("text-allow-overlap")||n.get("icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==i&&void 0!==r.constantOr(1),this.sortFeaturesByY=("viewport-y"===i||"auto"===i&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=n.get("text-writing-mode").map((t=>sc[t])),this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id)),this.sourceID=t.sourceID}createArrays(){this.text=new ch(new Rs(this.layers,this.zoom,(t=>/^text/.test(t)))),this.icon=new ch(new Rs(this.layers,this.zoom,(t=>/^icon/.test(t)))),this.glyphOffsetArray=new rs,this.lineVertexArray=new is,this.symbolInstances=new ns}calculateGlyphDependencies(t,e,n,r,i){for(let n=0;n<t.length;n++)if(e[t.charCodeAt(n)]=!0,r&&i){const r=Cu[t.charAt(n)];r&&(e[r.charCodeAt(0)]=!0)}}populate(t,e,n){const r=this.layers[0],i=r.layout,o=i.get("text-font"),s=i.get("text-field"),a=i.get("icon-image"),l=("constant"!==s.value.kind||s.value.value instanceof fe&&!s.value.value.isEmpty()||s.value.value.toString().length>0)&&("constant"!==o.value.kind||o.value.value.length>0),u="constant"!==a.value.kind||!!a.value.value||Object.keys(a.parameters).length>0,c=i.get("symbol-sort-key");if(this.features=[],!l&&!u)return;const h=e.iconDependencies,p=e.glyphDependencies,f=e.availableImages,d=new so(this.zoom);for(const{feature:e,id:s,index:a,sourceLayerIndex:g}of t){const t=r._featureFilter.needGeometry,m=Hs(e,t);if(!r._featureFilter.filter(d,m,n))continue;let A,y;if(t||(m.geometry=Ws(e)),l){const t=r.getValueAndResolveTokens("text-field",m,n,f),e=fe.factory(t);uh(e)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===ro()||this.hasRTLText&&oo.isParsed())&&(A=Mu(e,r,m))}if(u){const t=r.getValueAndResolveTokens("icon-image",m,n,f);y=t instanceof de?t:de.fromString(t)}if(!A&&!y)continue;const _=this.sortFeaturesByKey?c.evaluate(m,{},n):void 0;if(this.features.push({id:s,text:A,icon:y,index:a,sourceLayerIndex:g,geometry:m.geometry,properties:e.properties,type:oh[e.type],sortKey:_}),y&&(h[y.name]=!0),A){const t=o.evaluate(m,{},n).join(","),e="map"===i.get("text-rotation-alignment")&&"point"!==i.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(sc.vertical)>=0;for(const n of A.sections)if(n.image)h[n.image.name]=!0;else{const r=ji(A.toString()),i=n.fontStack||t,o=p[i]=p[i]||{};this.calculateGlyphDependencies(n.text,o,e,this.allowVerticalPlacement,r)}}}"line"===i.get("symbol-placement")&&(this.features=function(t){const e={},n={},r=[];let i=0;function o(e){r.push(t[e]),i++}function s(t,e,i){const o=n[t];return delete n[t],n[e]=o,r[o].geometry[0].pop(),r[o].geometry[0]=r[o].geometry[0].concat(i[0]),o}function a(t,n,i){const o=e[n];return delete e[n],e[t]=o,r[o].geometry[0].shift(),r[o].geometry[0]=i[0].concat(r[o].geometry[0]),o}function l(t,e,n){const r=n?e[0][e[0].length-1]:e[0][0];return`${t}:${r.x}:${r.y}`}for(let u=0;u<t.length;u++){const c=t[u],h=c.geometry,p=c.text?c.text.toString():null;if(!p){o(u);continue}const f=l(p,h),d=l(p,h,!0);if(f in n&&d in e&&n[f]!==e[d]){const t=a(f,d,h),i=s(f,d,r[t].geometry);delete e[f],delete n[d],n[l(p,r[i].geometry,!0)]=i,r[t].geometry=null}else f in n?s(f,d,h):d in e?a(f,d,h):(o(u),e[f]=i-1,n[d]=i-1)}return r.filter((t=>t.geometry))}(this.features)),this.sortFeaturesByKey&&this.features.sort(((t,e)=>t.sortKey-e.sortKey))}update(t,e,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,n),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,n))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,e){const n=this.lineVertexArray.length;if(void 0!==t.segment){let n=t.dist(e[t.segment+1]),r=t.dist(e[t.segment]);const i={};for(let r=t.segment+1;r<e.length;r++)i[r]={x:e[r].x,y:e[r].y,tileUnitDistanceFromAnchor:n},r<e.length-1&&(n+=e[r+1].dist(e[r]));for(let n=t.segment||0;n>=0;n--)i[n]={x:e[n].x,y:e[n].y,tileUnitDistanceFromAnchor:r},n>0&&(r+=e[n-1].dist(e[n]));for(let t=0;t<e.length;t++){const e=i[t];this.lineVertexArray.emplaceBack(e.x,e.y,e.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}}addSymbols(t,e,n,r,i,o,s,a,l,u,c,h,p){const f=t.indexArray,d=t.layoutVertexArray,g=t.segments.prepareSegment(4*e.length,d,f,this.canOverlap?o.sortKey:void 0),m=this.glyphOffsetArray.length,A=g.vertexLength,y=this.allowVerticalPlacement&&s===sc.vertical?Math.PI/2:0,_=o.text&&o.text.sections;for(let r=0;r<e.length;r++){const{tl:i,tr:s,bl:u,br:c,tex:h,pixelOffsetTL:m,pixelOffsetBR:A,minFontScaleX:v,minFontScaleY:b,glyphOffset:x,isSDF:w,sectionIndex:E}=e[r],S=g.vertexLength,T=x[1];ah(d,a.x,a.y,a.z,l.x,l.y,i.x,T+i.y,h.x,h.y,n,w,m.x,m.y,v,b),ah(d,a.x,a.y,a.z,l.x,l.y,s.x,T+s.y,h.x+h.w,h.y,n,w,A.x,m.y,v,b),ah(d,a.x,a.y,a.z,l.x,l.y,u.x,T+u.y,h.x,h.y+h.h,n,w,m.x,A.y,v,b),ah(d,a.x,a.y,a.z,l.x,l.y,c.x,T+c.y,h.x+h.w,h.y+h.h,n,w,A.x,A.y,v,b),lh(t.dynamicLayoutVertexArray,a,y),f.emplaceBack(S,S+1,S+2),f.emplaceBack(S+1,S+2,S+3),g.vertexLength+=4,g.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(x[0]),r!==e.length-1&&E===e[r+1].sectionIndex||t.programConfigurations.populatePaintArrays(d.length,o,o.index,{},p,_&&_[E])}t.placedSymbolArray.emplaceBack(a.x,a.y,a.z,l.x,l.y,m,this.glyphOffsetArray.length-m,A,u,c,l.segment,n?n[0]:0,n?n[1]:0,r[0],r[1],s,0,!1,0,h,0)}_commitLayoutVertex(t,e,n,r,i,o,s){t.emplaceBack(e,n,r,i,o,Math.round(s.x),Math.round(s.y))}_addCollisionDebugVertices(t,e,n,r,o,s,a){const l=n.segments.prepareSegment(4,n.layoutVertexArray,n.indexArray),u=l.vertexLength,c=a.tileAnchorX,h=a.tileAnchorY;for(let t=0;t<4;t++)n.collisionVertexArray.emplaceBack(0,0,0,0);n.collisionVertexArrayExt.emplaceBack(e,-t.padding,-t.padding),n.collisionVertexArrayExt.emplaceBack(e,t.padding,-t.padding),n.collisionVertexArrayExt.emplaceBack(e,t.padding,t.padding),n.collisionVertexArrayExt.emplaceBack(e,-t.padding,t.padding),this._commitLayoutVertex(n.layoutVertexArray,r,o,s,c,h,new i(t.x1,t.y1)),this._commitLayoutVertex(n.layoutVertexArray,r,o,s,c,h,new i(t.x2,t.y1)),this._commitLayoutVertex(n.layoutVertexArray,r,o,s,c,h,new i(t.x2,t.y2)),this._commitLayoutVertex(n.layoutVertexArray,r,o,s,c,h,new i(t.x1,t.y2)),l.vertexLength+=4;const p=n.indexArray;p.emplaceBack(u,u+1),p.emplaceBack(u+1,u+2),p.emplaceBack(u+2,u+3),p.emplaceBack(u+3,u),l.primitiveLength+=4}_addTextDebugCollisionBoxes(t,e,n,r,i,o){for(let s=r;s<i;s++){const r=n.get(s),i=this.getSymbolInstanceTextSize(t,o,e,s);this._addCollisionDebugVertices(r,i,this.textCollisionBox,r.projectedAnchorX,r.projectedAnchorY,r.projectedAnchorZ,o)}}_addIconDebugCollisionBoxes(t,e,n,r,i,o){for(let s=r;s<i;s++){const r=n.get(s),i=this.getSymbolInstanceIconSize(t,e,s);this._addCollisionDebugVertices(r,i,this.iconCollisionBox,r.projectedAnchorX,r.projectedAnchorY,r.projectedAnchorZ,o)}}generateCollisionDebugBuffers(t,e){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new hh(Fo,vu.members,Wo),this.iconCollisionBox=new hh(Fo,vu.members,Wo);const n=Tu(this.iconSizeData,t),r=Tu(this.textSizeData,t);for(let i=0;i<this.symbolInstances.length;i++){const o=this.symbolInstances.get(i);this._addTextDebugCollisionBoxes(r,t,e,o.textBoxStartIndex,o.textBoxEndIndex,o),this._addTextDebugCollisionBoxes(r,t,e,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o),this._addIconDebugCollisionBoxes(n,t,e,o.iconBoxStartIndex,o.iconBoxEndIndex,o),this._addIconDebugCollisionBoxes(n,t,e,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o)}}getSymbolInstanceTextSize(t,e,n,r){const i=this.text.placedSymbolArray.get(e.rightJustifiedTextSymbolIndex>=0?e.rightJustifiedTextSymbolIndex:e.centerJustifiedTextSymbolIndex>=0?e.centerJustifiedTextSymbolIndex:e.leftJustifiedTextSymbolIndex>=0?e.leftJustifiedTextSymbolIndex:e.verticalPlacedTextSymbolIndex>=0?e.verticalPlacedTextSymbolIndex:r),o=Su(this.textSizeData,t,i)/xu;return this.tilePixelRatio*o}getSymbolInstanceIconSize(t,e,n){const r=this.icon.placedSymbolArray.get(n),i=Su(this.iconSizeData,t,r);return this.tilePixelRatio*i}_commitDebugCollisionVertexUpdate(t,e,n){t.emplaceBack(e,-n,-n),t.emplaceBack(e,n,-n),t.emplaceBack(e,n,n),t.emplaceBack(e,-n,n)}_updateTextDebugCollisionBoxes(t,e,n,r,i,o){for(let s=r;s<i;s++){const r=n.get(s),i=this.getSymbolInstanceTextSize(t,o,e,s);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,i,r.padding)}}_updateIconDebugCollisionBoxes(t,e,n,r,i){for(let o=r;o<i;o++){const r=n.get(o),i=this.getSymbolInstanceIconSize(t,e,o);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,i,r.padding)}}updateCollisionDebugBuffers(t,e){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const n=Tu(this.iconSizeData,t),r=Tu(this.textSizeData,t);for(let i=0;i<this.symbolInstances.length;i++){const o=this.symbolInstances.get(i);this._updateTextDebugCollisionBoxes(r,t,e,o.textBoxStartIndex,o.textBoxEndIndex,o),this._updateTextDebugCollisionBoxes(r,t,e,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o),this._updateIconDebugCollisionBoxes(n,t,e,o.iconBoxStartIndex,o.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(n,t,e,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,e,n,r,i,o,s,a,l){const u={};for(let r=e;r<n;r++){const e=t.get(r);u.textBox={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,padding:e.padding,projectedAnchorX:e.projectedAnchorX,projectedAnchorY:e.projectedAnchorY,projectedAnchorZ:e.projectedAnchorZ,tileAnchorX:e.tileAnchorX,tileAnchorY:e.tileAnchorY},u.textFeatureIndex=e.featureIndex;break}for(let e=r;e<i;e++){const n=t.get(e);u.verticalTextBox={x1:n.x1,y1:n.y1,x2:n.x2,y2:n.y2,padding:n.padding,projectedAnchorX:n.projectedAnchorX,projectedAnchorY:n.projectedAnchorY,projectedAnchorZ:n.projectedAnchorZ,tileAnchorX:n.tileAnchorX,tileAnchorY:n.tileAnchorY},u.verticalTextFeatureIndex=n.featureIndex;break}for(let e=o;e<s;e++){const n=t.get(e);u.iconBox={x1:n.x1,y1:n.y1,x2:n.x2,y2:n.y2,padding:n.padding,projectedAnchorX:n.projectedAnchorX,projectedAnchorY:n.projectedAnchorY,projectedAnchorZ:n.projectedAnchorZ,tileAnchorX:n.tileAnchorX,tileAnchorY:n.tileAnchorY},u.iconFeatureIndex=n.featureIndex;break}for(let e=a;e<l;e++){const n=t.get(e);u.verticalIconBox={x1:n.x1,y1:n.y1,x2:n.x2,y2:n.y2,padding:n.padding,projectedAnchorX:n.projectedAnchorX,projectedAnchorY:n.projectedAnchorY,projectedAnchorZ:n.projectedAnchorZ,tileAnchorX:n.tileAnchorX,tileAnchorY:n.tileAnchorY},u.verticalIconFeatureIndex=n.featureIndex;break}return u}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let e=0;e<this.symbolInstances.length;e++){const n=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,e){const n=t.placedSymbolArray.get(e),r=n.vertexStartIndex+4*n.numGlyphs;for(let e=n.vertexStartIndex;e<r;e+=4)t.indexArray.emplaceBack(e,e+1,e+2),t.indexArray.emplaceBack(e+1,e+2,e+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const e=Math.sin(t),n=Math.cos(t),r=[],i=[],o=[];for(let t=0;t<this.symbolInstances.length;++t){o.push(t);const s=this.symbolInstances.get(t);r.push(0|Math.round(e*s.tileAnchorX+n*s.tileAnchorY)),i.push(s.featureIndex)}return o.sort(((t,e)=>r[t]-r[e]||i[e]-i[t])),o}addToSortKeyRanges(t,e){const n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===e?n.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const t of this.symbolInstanceIndexes){const e=this.symbolInstances.get(t);this.featureSortOrder.push(e.featureIndex),[e.rightJustifiedTextSymbolIndex,e.centerJustifiedTextSymbolIndex,e.leftJustifiedTextSymbolIndex].forEach(((t,e,n)=>{t>=0&&n.indexOf(t)===e&&this.addIndicesForPlacedSymbol(this.text,t)})),e.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,e.verticalPlacedTextSymbolIndex),e.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,e.placedIconSymbolIndex),e.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,e.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}ai("SymbolBucket",ph,{omit:["layers","collisionBoxArray","features","compareText"]}),ph.MAX_GLYPHS=65535,ph.addDynamicAttributes=lh;const fh=new bo({"symbol-placement":new mo(Bt.layout_symbol["symbol-placement"]),"symbol-spacing":new mo(Bt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new mo(Bt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ao(Bt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new mo(Bt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new mo(Bt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new mo(Bt.layout_symbol["icon-ignore-placement"]),"icon-optional":new mo(Bt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new mo(Bt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ao(Bt.layout_symbol["icon-size"]),"icon-text-fit":new mo(Bt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new mo(Bt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ao(Bt.layout_symbol["icon-image"]),"icon-rotate":new Ao(Bt.layout_symbol["icon-rotate"]),"icon-padding":new mo(Bt.layout_symbol["icon-padding"]),"icon-keep-upright":new mo(Bt.layout_symbol["icon-keep-upright"]),"icon-offset":new Ao(Bt.layout_symbol["icon-offset"]),"icon-anchor":new Ao(Bt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new mo(Bt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new mo(Bt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new mo(Bt.layout_symbol["text-rotation-alignment"]),"text-field":new Ao(Bt.layout_symbol["text-field"]),"text-font":new Ao(Bt.layout_symbol["text-font"]),"text-size":new Ao(Bt.layout_symbol["text-size"]),"text-max-width":new Ao(Bt.layout_symbol["text-max-width"]),"text-line-height":new Ao(Bt.layout_symbol["text-line-height"]),"text-letter-spacing":new Ao(Bt.layout_symbol["text-letter-spacing"]),"text-justify":new Ao(Bt.layout_symbol["text-justify"]),"text-radial-offset":new Ao(Bt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new mo(Bt.layout_symbol["text-variable-anchor"]),"text-anchor":new Ao(Bt.layout_symbol["text-anchor"]),"text-max-angle":new mo(Bt.layout_symbol["text-max-angle"]),"text-writing-mode":new mo(Bt.layout_symbol["text-writing-mode"]),"text-rotate":new Ao(Bt.layout_symbol["text-rotate"]),"text-padding":new mo(Bt.layout_symbol["text-padding"]),"text-keep-upright":new mo(Bt.layout_symbol["text-keep-upright"]),"text-transform":new Ao(Bt.layout_symbol["text-transform"]),"text-offset":new Ao(Bt.layout_symbol["text-offset"]),"text-allow-overlap":new mo(Bt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new mo(Bt.layout_symbol["text-ignore-placement"]),"text-optional":new mo(Bt.layout_symbol["text-optional"])});var dh={paint:new bo({"icon-opacity":new Ao(Bt.paint_symbol["icon-opacity"]),"icon-color":new Ao(Bt.paint_symbol["icon-color"]),"icon-halo-color":new Ao(Bt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ao(Bt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ao(Bt.paint_symbol["icon-halo-blur"]),"icon-translate":new mo(Bt.paint_symbol["icon-translate"]),"icon-translate-anchor":new mo(Bt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ao(Bt.paint_symbol["text-opacity"]),"text-color":new Ao(Bt.paint_symbol["text-color"],{runtimeType:Yt,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new Ao(Bt.paint_symbol["text-halo-color"]),"text-halo-width":new Ao(Bt.paint_symbol["text-halo-width"]),"text-halo-blur":new Ao(Bt.paint_symbol["text-halo-blur"]),"text-translate":new mo(Bt.paint_symbol["text-translate"]),"text-translate-anchor":new mo(Bt.paint_symbol["text-translate-anchor"])}),layout:fh};class gh{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Wt,this.defaultValue=t}evaluate(t){if(t.formattedSection){const e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}ai("FormatSectionOverride",gh,{omit:["defaultValue"]});class mh extends zs{constructor(t){super(t,dh)}recalculate(t,e){super.recalculate(t,e),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const n=this.layout.get("text-writing-mode");if(n){const t=[];for(const e of n)t.indexOf(e)<0&&t.push(e);this.layout._values["text-writing-mode"]=t}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(t,e,n,r){const i=this.layout.get(t).evaluate(e,{},n,r),o=this._unevaluatedLayout._values[t];return o.isDataDriven()||ur(o.value)||!i?i:function(t,e){return e.replace(/{([^{}]+)}/g,((e,n)=>n in t?String(t[n]):""))}(e.properties,i)}createBucket(t){return new ph(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of dh.paint.overridableProperties){if(!mh.hasPaintOverride(this.layout,t))continue;const e=this.paint.get(t),n=new gh(e),r=new lr(n,e.property.specification);let i=null;i="constant"===e.value.kind||"source"===e.value.kind?new hr("source",r):new pr("composite",r,e.value.zoomStops,e.value._interpolationType),this.paint._values[t]=new fo(e.property,i,e.parameters)}}_handleOverridablePaintPropertyUpdate(t,e,n){return!(!this.layout||e.isDataDriven()||n.isDataDriven())&&mh.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,e){const n=t.get("text-field"),r=dh.paint.properties[e];let i=!1;const o=t=>{for(const e of t)if(r.overrides&&r.overrides.hasOverride(e))return void(i=!0)};if("constant"===n.value.kind&&n.value.value instanceof fe)o(n.value.value.sections);else if("source"===n.value.kind){const t=e=>{i||(e instanceof _e&&Ae(e.value)===te?o(e.value.sections):e instanceof we?o(e.sections):e.eachChild(t))},e=n.value;e._styleExpression&&t(e._styleExpression.expression)}return i}getProgramConfiguration(t){return new Os(this,t)}}var Ah={paint:new bo({"background-color":new mo(Bt.paint_background["background-color"]),"background-pattern":new _o(Bt.paint_background["background-pattern"]),"background-opacity":new mo(Bt.paint_background["background-opacity"])})},yh={paint:new bo({"raster-opacity":new mo(Bt.paint_raster["raster-opacity"]),"raster-hue-rotate":new mo(Bt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new mo(Bt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new mo(Bt.paint_raster["raster-brightness-max"]),"raster-saturation":new mo(Bt.paint_raster["raster-saturation"]),"raster-contrast":new mo(Bt.paint_raster["raster-contrast"]),"raster-resampling":new mo(Bt.paint_raster["raster-resampling"]),"raster-fade-duration":new mo(Bt.paint_raster["raster-fade-duration"])})};class _h extends zs{constructor(t){super(t,{}),this.implementation=t}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}var vh={paint:new bo({"sky-type":new mo(Bt.paint_sky["sky-type"]),"sky-atmosphere-sun":new mo(Bt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new mo(Bt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new mo(Bt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new mo(Bt.paint_sky["sky-gradient-radius"]),"sky-gradient":new vo(Bt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new mo(Bt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new mo(Bt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new mo(Bt.paint_sky["sky-opacity"])})};function bh(t,e,n){const r=ba(0,0,1),i=La(Ra());return function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);t[0]=r*l-o*a,t[1]=i*l+s*a,t[2]=o*l+r*a,t[3]=s*l-i*a}(i,i,n?-c(t)+Math.PI:c(t)),ka(i,i,-c(e)),Ta(r,r,i),Sa(r,r)}const xh={circle:class extends zs{constructor(t){super(t,fa)}createBucket(t){return new $s(t)}queryRadius(t){const e=t;return la("circle-radius",this,e)+la("circle-stroke-width",this,e)+ua(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,n,r,i,o,s,a){const l=ha(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,t.pixelToTileUnitsFactor),u=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n);return Da(t,r,o,s,a,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),l,u)}getProgramIds(){return["circle"]}getProgramConfiguration(t){return new Os(this,t)}},heatmap:class extends zs{createBucket(t){return new ja(t)}constructor(t){super(t,Wa),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"heatmap-color"===t&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Ha({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(t){return la("heatmap-radius",this,t)}queryIntersectsFeature(t,e,n,r,o,s,a,l){const u=this.paint.get("heatmap-radius").evaluate(e,n);return Da(t,r,s,a,l,!0,!0,new i(0,0),u)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(t){return new Os(this,t)}},hillshade:class extends zs{constructor(t){super(t,Xa)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}getProgramConfiguration(t){return new Os(this,t)}},fill:class extends zs{constructor(t){super(t,Dl)}getProgramIds(){const t=this.paint.get("fill-pattern"),e=t&&t.constantOr(1),n=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&n.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),n}getProgramConfiguration(t){return new Os(this,t)}recalculate(t,e){super.recalculate(t,e);const n=this.paint._values["fill-outline-color"];"constant"===n.value.kind&&void 0===n.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Ll(t)}queryRadius(){return ua(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,n,r,i,o){return!t.queryGeometry.isAboveHorizon&&Ks(ca(t.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,t.pixelToTileUnitsFactor),r)}isTileClipped(){return!0}},"fill-extrusion":class extends zs{constructor(t){super(t,tu)}createBucket(t){return new Kl(t)}queryRadius(){return ua(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(t){return new Os(this,t)}queryIntersectsFeature(t,e,n,r,o,s,a,l,u){const c=ha(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),s.angle,t.pixelToTileUnitsFactor),h=this.paint.get("fill-extrusion-height").evaluate(e,n),p=this.paint.get("fill-extrusion-base").evaluate(e,n),f=[0,0],d=l&&s.elevation,g=s.elevation?s.elevation.exaggeration():1;if(d){const e=t.tile.getBucket(this).centroidVertexArray,n=u+1;if(n<e.length){const t=e.get(n);f[0]=t.a_centroid_pos0,f[1]=t.a_centroid_pos1}}if(0===f[0]&&1===f[1])return!1;const m=function(t,e,n,r,o,s,a,l,u){return s?function(t,e,n,r,i,o,s,a,l){const u=[],c=[],h=[0,0,0,1];for(const p of t){const t=[],f=[];for(const u of p){const c=u.x+r.x,p=u.y+r.y,d=iu(c,p,e,n,o,s,a,l);h[0]=c,h[1]=p,h[2]=d.base,h[3]=1,Oa(h,h,i),h[3]=Math.max(h[3],1e-5);const g=ru([h[0]/h[3],h[1]/h[3],h[2]/h[3]]);h[0]=c,h[1]=p,h[2]=d.top,h[3]=1,Oa(h,h,i),h[3]=Math.max(h[3],1e-5);const m=ru([h[0]/h[3],h[1]/h[3],h[2]/h[3]]);t.push(g),f.push(m)}u.push(t),c.push(f)}return[u,c]}(t,e,n,r,o,s,a,l,u):function(t,e,n,r,o){const s=[],a=[],l=o[8]*e,u=o[9]*e,c=o[10]*e,h=o[11]*e,p=o[8]*n,f=o[9]*n,d=o[10]*n,g=o[11]*n;for(const e of t){const t=[],n=[];for(const s of e){const e=s.x+r.x,a=s.y+r.y,m=o[0]*e+o[4]*a+o[12],A=o[1]*e+o[5]*a+o[13],y=o[2]*e+o[6]*a+o[14],_=o[3]*e+o[7]*a+o[15],v=m+l,b=A+u,x=y+c,w=Math.max(_+h,1e-5),E=m+p,S=A+f,T=y+d,P=Math.max(_+g,1e-5),M=new i(v/w,b/w);M.z=x/w,t.push(M);const C=new i(E/P,S/P);C.z=T/P,n.push(C)}s.push(t),a.push(n)}return[s,a]}(t,e,n,r,o)}(r,p,h,c,a,d?l:null,f,g,s.center.lat),A=t.queryGeometry;return function(t,e,n){let r=1/0;Ks(n,e)&&(r=nu(n,e[0]));for(let i=0;i<e.length;i++){const o=e[i],s=t[i];for(let t=0;t<o.length-1;t++){const e=o[t],i=[e,o[t+1],s[t+1],s[t],e];Ys(n,i)&&(r=Math.min(r,nu(n,i)))}}return r!==1/0&&r}(m[0],m[1],A.isPointQuery()?A.screenBounds:A.screenGeometry)}},line:class extends zs{constructor(t){super(t,fu),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(t){if("line-gradient"===t){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof en,this.gradientVersion=(this.gradientVersion+1)%a}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=du.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new hu(t)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(t){return new Os(this,t)}queryRadius(t){const e=t,n=gu(la("line-width",this,e),la("line-gap-width",this,e)),r=la("line-offset",this,e);return n/2+Math.abs(r)+ua(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,n,r,o,s){if(t.queryGeometry.isAboveHorizon)return!1;const a=ca(t.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),s.angle,t.pixelToTileUnitsFactor),l=t.pixelToTileUnitsFactor/2*gu(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),u=this.paint.get("line-offset").evaluate(e,n);return u&&(r=function(t,e){const n=[],r=new i(0,0);for(let i=0;i<t.length;i++){const o=t[i],s=[];for(let t=0;t<o.length;t++){const n=o[t-1],i=o[t],a=o[t+1],l=0===t?r:i.sub(n)._unit()._perp(),u=t===o.length-1?r:a.sub(i)._unit()._perp(),c=l._add(u)._unit();c._mult(1/(c.x*u.x+c.y*u.y)),s.push(c._mult(e)._add(i))}n.push(s)}return n}(r,u*t.pixelToTileUnitsFactor)),function(t,e,n){for(let r=0;r<e.length;r++){const i=e[r];if(t.length>=3)for(let e=0;e<i.length;e++)if(oa(t,i[e]))return!0;if(Js(t,i,n))return!0}return!1}(a,r,l)}isTileClipped(){return!0}},symbol:mh,background:class extends zs{constructor(t){super(t,Ah)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends zs{constructor(t){super(t,yh)}getProgramIds(){return["raster"]}},sky:class extends zs{constructor(t){super(t,vh),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"sky-gradient"===t?this._updateColorRamp():"sky-atmosphere-sun"!==t&&"sky-atmosphere-halo-color"!==t&&"sky-atmosphere-color"!==t&&"sky-atmosphere-sun-intensity"!==t||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Ha({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(t){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=t.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}}getCenter(t,e){const n=this.paint.get("sky-type");if("atmosphere"===n){const n=this.paint.get("sky-atmosphere-sun"),r=!n,i=t.style.light,o=i.properties.get("position");return r&&"viewport"===i.properties.get("anchor")&&O("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),r?bh(o.azimuthal,90-o.polar,e):bh(n[0],90-n[1],e)}if("gradient"===n){const t=this.paint.get("sky-gradient-center");return bh(t[0],90-t[1],e)}}is3D(){return!1}isSky(){return!0}markSkyboxValid(t){this._skyboxInvalidated=!1,this._lightPosition=t.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const t=this.paint.get("sky-type");return"atmosphere"===t?["skyboxCapture","skybox"]:"gradient"===t?["skyboxGradient"]:null}}},{HTMLImageElement:wh,HTMLCanvasElement:Eh,HTMLVideoElement:Sh,ImageData:Th,ImageBitmap:Ph}=s;class Mh{constructor(t,e,n,r){this.context=t,this.format=n,this.texture=t.gl.createTexture(),this.update(e,r)}update(t,e,n){const{width:r,height:i}=t,o=!(this.size&&this.size[0]===r&&this.size[1]===i||n),{context:s}=this,{gl:a}=s;if(this.useMipmap=Boolean(e&&e.useMipmap),a.bindTexture(a.TEXTURE_2D,this.texture),s.pixelStoreUnpackFlipY.set(!1),s.pixelStoreUnpack.set(1),s.pixelStoreUnpackPremultiplyAlpha.set(this.format===a.RGBA&&(!e||!1!==e.premultiply)),o)this.size=[r,i],t instanceof wh||t instanceof Eh||t instanceof Sh||t instanceof Th||Ph&&t instanceof Ph?a.texImage2D(a.TEXTURE_2D,0,this.format,this.format,a.UNSIGNED_BYTE,t):a.texImage2D(a.TEXTURE_2D,0,this.format,r,i,0,this.format,a.UNSIGNED_BYTE,t.data);else{const{x:e,y:o}=n||{x:0,y:0};t instanceof wh||t instanceof Eh||t instanceof Sh||t instanceof Th||Ph&&t instanceof Ph?a.texSubImage2D(a.TEXTURE_2D,0,e,o,a.RGBA,a.UNSIGNED_BYTE,t):a.texSubImage2D(a.TEXTURE_2D,0,e,o,r,i,a.RGBA,a.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&a.generateMipmap(a.TEXTURE_2D)}bind(t,e,n){const{context:r}=this,{gl:i}=r;i.bindTexture(i.TEXTURE_2D,this.texture),n!==i.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(n=i.LINEAR),t!==this.filter&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,n||t),this.filter=t),e!==this.wrap&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,e),this.wrap=e)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class Ch{constructor(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof Oh?new Oh(t.lng,t.lat):Oh.convert(t),this}setSouthWest(t){return this._sw=t instanceof Oh?new Oh(t.lng,t.lat):Oh.convert(t),this}extend(t){const e=this._sw,n=this._ne;let r,i;if(t instanceof Oh)r=t,i=t;else{if(!(t instanceof Ch))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(Ch.convert(t)):this.extend(Oh.convert(t)):this;if(r=t._sw,i=t._ne,!r||!i)return this}return e||n?(e.lng=Math.min(r.lng,e.lng),e.lat=Math.min(r.lat,e.lat),n.lng=Math.max(i.lng,n.lng),n.lat=Math.max(i.lat,n.lat)):(this._sw=new Oh(r.lng,r.lat),this._ne=new Oh(i.lng,i.lat)),this}getCenter(){return new Oh((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Oh(this.getWest(),this.getNorth())}getSouthEast(){return new Oh(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:e,lat:n}=Oh.convert(t);let r=this._sw.lng<=e&&e<=this._ne.lng;return this._sw.lng>this._ne.lng&&(r=this._sw.lng>=e&&e>=this._ne.lng),this._sw.lat<=n&&n<=this._ne.lat&&r}static convert(t){return!t||t instanceof Ch?t:new Ch(t)}}const Ih=6371008.8;class Oh{constructor(t,e){if(isNaN(t)||isNaN(e))throw new Error(`Invalid LngLat object: (${t}, ${e})`);if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Oh(m(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const e=Math.PI/180,n=this.lat*e,r=t.lat*e,i=Math.sin(n)*Math.sin(r)+Math.cos(n)*Math.cos(r)*Math.cos((t.lng-this.lng)*e);return Ih*Math.acos(Math.min(i,1))}toBounds(t=0){const e=360*t/40075017,n=e/Math.cos(Math.PI/180*this.lat);return new Ch(new Oh(this.lng-n,this.lat-e),new Oh(this.lng+n,this.lat+e))}static convert(t){if(t instanceof Oh)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new Oh(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new Oh(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Rh=2*Math.PI*Ih;function Lh(t){return Rh*Math.cos(t*Math.PI/180)}function kh(t){return(180+t)/360}function Dh(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Nh(t,e){return t/Lh(e)}function Fh(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function Bh(t,e){return t*Lh(Fh(e))}class zh{constructor(t,e,n=0){this.x=+t,this.y=+e,this.z=+n}static fromLngLat(t,e=0){const n=Oh.convert(t);return new zh(kh(n.lng),Dh(n.lat),Nh(e,n.lat))}toLngLat(){return new Oh(360*this.x-180,Fh(this.y))}toAltitude(){return Bh(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Rh*(t=Fh(this.y),1/Math.cos(t*Math.PI/180));var t}}class jh{constructor(t,e){this.width=t,this.height=e,this.nextRow=0,this.image=new Za({width:t,height:e}),this.positions={},this.uploaded=!1}getDash(t,e){const n=this.getKey(t,e);return this.positions[n]}trim(){const t=this.width,e=this.height=w(this.nextRow);this.image.resize({width:t,height:e})}getKey(t,e){return t.join(",")+e}getDashRanges(t,e,n){const r=[];let i=t.length%2==1?-t[t.length-1]*n:0,o=t[0]*n,s=!0;r.push({left:i,right:o,isDash:s,zeroLength:0===t[0]});let a=t[0];for(let e=1;e<t.length;e++){s=!s;const l=t[e];i=a*n,a+=l,o=a*n,r.push({left:i,right:o,isDash:s,zeroLength:0===l})}return r}addRoundDash(t,e,n){const r=e/2;for(let e=-n;e<=n;e++){const i=this.width*(this.nextRow+n+e);let o=0,s=t[o];for(let a=0;a<this.width;a++){a/s.right>1&&(s=t[++o]);const l=Math.abs(a-s.left),u=Math.abs(a-s.right),c=Math.min(l,u);let h;const p=e/n*(r+1);if(s.isDash){const t=r-Math.abs(p);h=Math.sqrt(c*c+t*t)}else h=r-Math.sqrt(c*c+p*p);this.image.data[i+a]=Math.max(0,Math.min(255,h+128))}}}addRegularDash(t,e){for(let e=t.length-1;e>=0;--e){const n=t[e],r=t[e+1];n.zeroLength?t.splice(e,1):r&&r.isDash===n.isDash&&(r.left=n.left,t.splice(e,1))}const n=t[0],r=t[t.length-1];n.isDash===r.isDash&&(n.left=r.left-this.width,r.right=n.right+this.width);const i=this.width*this.nextRow;let o=0,s=t[o];for(let n=0;n<this.width;n++){n/s.right>1&&(s=t[++o]);const r=Math.abs(n-s.left),a=Math.abs(n-s.right),l=Math.min(r,a);this.image.data[i+n]=Math.max(0,Math.min(255,(s.isDash?l:-l)+e+128))}}addDash(t,e){const n=this.getKey(t,e);if(this.positions[n])return this.positions[n];const r="round"===e,i=r?7:0,o=2*i+1;if(this.nextRow+o>this.height)return O("LineAtlas out of space"),null;0===t.length&&t.push(1);let s=0;for(let e=0;e<t.length;e++)t[e]<0&&(O("Negative value is found in line dasharray, replacing values with 0"),t[e]=0),s+=t[e];if(0!==s){const n=this.width/s,o=this.getDashRanges(t,this.width,n);r?this.addRoundDash(o,n,i):this.addRegularDash(o,"square"===e?.5*n:0)}const a=this.nextRow+i;this.nextRow+=o;const l={tl:[a,i],br:[s,0]};return this.positions[n]=l,l}}ai("LineAtlas",jh);class Uh{constructor(t){this._callback=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback()}),0))}remove(){delete this._channel,this._callback=()=>{}}}const Vh=s.performance;function Gh(t){const e=t?t.url.toString():void 0;return Vh.getEntriesByName(e)}class Zh{constructor(){this.tasks={},this.taskQueue=[],S(["process"],this),this.invoker=new Uh(this.process),this.nextId=0}add(t,e){const n=this.nextId++,r=function({type:t,isSymbolTile:e,zoom:n}){return n=n||0,"message"===t?0:"maybePrepare"!==t||e?"parseTile"!==t||e?"parseTile"===t&&e?300-n:"maybePrepare"===t&&e?400-n:500:200-n:100-n}(e);if(0===r){k();try{t()}finally{}return{cancel:()=>{}}}return this.tasks[n]={fn:t,metadata:e,priority:r,id:n},this.taskQueue.push(n),this.invoker.trigger(),{cancel:()=>{delete this.tasks[n]}}}process(){k();try{if(this.taskQueue=this.taskQueue.filter((t=>!!this.tasks[t])),!this.taskQueue.length)return;const t=this.pick();if(null===t)return;const e=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!e)return;e.fn()}finally{}}pick(){let t=null,e=1/0;for(let n=0;n<this.taskQueue.length;n++){const r=this.tasks[this.taskQueue[n]];r.priority<e&&(e=r.priority,t=n)}if(null===t)return null;const n=this.taskQueue[t];return this.taskQueue.splice(t,1),n}remove(){this.invoker.remove()}}function qh(t,e,n){var r=2*Math.PI*6378137/256/Math.pow(2,n);return[t*r-2*Math.PI*6378137/2,e*r-2*Math.PI*6378137/2]}class Wh{constructor(t,e,n){this.z=t,this.x=e,this.y=n,this.key=$h(0,t,t,e,n)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,e){const n=(i=this.y,o=this.z,s=qh(256*(r=this.x),256*(i=Math.pow(2,o)-i-1),o),a=qh(256*(r+1),256*(i+1),o),s[0]+","+s[1]+","+a[0]+","+a[1]);var r,i,o,s,a;const l=function(t,e,n){let r,i="";for(let o=t;o>0;o--)r=1<<o-1,i+=(e&r?1:0)+(n&r?2:0);return i}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===e?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",l).replace("{bbox-epsg-3857}",n)}getTilePoint(t){const e=Math.pow(2,this.z);return new i((t.x*e-this.x)*Gs,(t.y*e-this.y)*Gs)}getTileVec3(t){const e=Math.pow(2,this.z);return ba((t.x*e-this.x)*Gs,(t.y*e-this.y)*Gs,Bh(t.z,t.y))}toString(){return`${this.z}/${this.x}/${this.y}`}}class Hh{constructor(t,e){this.wrap=t,this.canonical=e,this.key=$h(t,e.z,e.z,e.x,e.y)}}class Xh{constructor(t,e,n,r,i){this.overscaledZ=t,this.wrap=e,this.canonical=new Wh(n,+r,+i),this.key=0===e&&t===n?this.canonical.key:$h(e,t,n,r,i)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const e=this.canonical.z-t;return t>this.canonical.z?new Xh(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Xh(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)}calculateScaledKey(t,e=!0){if(this.overscaledZ===t&&e)return this.key;if(t>this.canonical.z)return $h(this.wrap*+e,t,this.canonical.z,this.canonical.x,this.canonical.y);{const n=this.canonical.z-t;return $h(this.wrap*+e,t,t,this.canonical.x>>n,this.canonical.y>>n)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e}children(t){if(this.overscaledZ>=t)return[new Xh(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const e=this.canonical.z+1,n=2*this.canonical.x,r=2*this.canonical.y;return[new Xh(e,this.wrap,e,n,r),new Xh(e,this.wrap,e,n+1,r),new Xh(e,this.wrap,e,n,r+1),new Xh(e,this.wrap,e,n+1,r+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Xh(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Xh(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Hh(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new zh(t.x-this.wrap,t.y))}getTileVec3(t){return this.canonical.getTileVec3(new zh(t.x-this.wrap,t.y,t.z))}}function $h(t,e,n,r,i){const o=1<<Math.min(n,22);let s=o*(i%o)+r%o;return t&&n<22&&(s+=o*o*((t<0?-2*t-1:2*t)%(1<<2*(22-n)))),16*(32*s+n)+(e-n)}ai("CanonicalTileID",Wh),ai("OverscaledTileID",Xh,{omit:["projMatrix"]});class Yh{constructor(t){this._stringToNumber={},this._numberToString=[];for(let e=0;e<t.length;e++){const n=t[e];this._stringToNumber[n]=e,this._numberToString[e]=n}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}class Qh{constructor(t,e,n,r,i){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=n,t._y=r,this.properties=t.properties,this.id=i}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t}}var Kh=To([{name:"a_pos",type:"Int16",components:2}]);class Jh{constructor(t,e,n){this.tileID=t,this.uid=b(),this.uses=0,this.tileSize=e,this.tileZoom=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const e=t+this.timeAdded;e<V.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}loadVectorData(t,e,n){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(t,e){const n={};if(!e)return n;for(const r of t){const t=r.layerIds.map((t=>e.getLayer(t))).filter(Boolean);if(0!==t.length){r.layers=t,r.stateDependentLayerIds&&(r.stateDependentLayers=r.stateDependentLayerIds.map((e=>t.filter((t=>t.id===e))[0])));for(const e of t)n[e.id]=r}}return n}(t.buckets,e.style),this.hasSymbolBuckets=!1;for(const t in this.buckets){const e=this.buckets[t];if(e instanceof ph){if(this.hasSymbolBuckets=!0,!n)break;e.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const t in this.buckets){const e=this.buckets[t];if(e instanceof ph&&e.hasRTLText){this.hasRTLText=!0,oo.isLoading()||oo.isLoaded()||"deferred"!==ro()||io();break}}this.queryPadding=0;for(const t in this.buckets){const n=this.buckets[t];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(t).queryRadius(n))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas)}else this.collisionBoxArray=new Ko}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const e in this.buckets){const n=this.buckets[e];n.uploadPending()&&n.upload(t)}const e=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Mh(t,this.imageAtlas.image,e.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Mh(t,this.glyphAtlasImage,e.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Mh(t,this.lineAtlas.image,e.ALPHA),this.lineAtlas.uploaded=!0)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,e,n,r,i,o,s,a){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:r,pixelPosMatrix:s,transform:o,params:i},t,e,n):{}}querySourceFeatures(t,e){const n=this.latestFeatureIndex;if(!n||!n.rawTileData)return;const r=n.loadVTLayers(),i=e?e.sourceLayer:"",o=r._geojsonTileLayer||r[i];if(!o)return;const s=Er(e&&e.filter),{z:a,x:l,y:u}=this.tileID.canonical,c={z:a,x:l,y:u};for(let e=0;e<o.length;e++){const r=o.feature(e);if(s.needGeometry){const t=Hs(r,!0);if(!s.filter(new so(this.tileID.overscaledZ),t,this.tileID.canonical))continue}else if(!s.filter(new so(this.tileID.overscaledZ),r))continue;const h=n.getId(r,i),p=new Qh(r,a,l,u,h);p.tile=c,t.push(p)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const e=this.expirationTime;if(t.cacheControl){const e=D(t.cacheControl);e["max-age"]&&(this.expirationTime=Date.now()+1e3*e["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const t=Date.now();let n=!1;if(this.expirationTime>t)n=!1;else if(e)if(this.expirationTime<e)n=!0;else{const r=this.expirationTime-e;r?this.expirationTime=t+Math.max(r,3e4):n=!0}else n=!0;n?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(t,e){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(t).length)return;const n=this.latestFeatureIndex.loadVTLayers();for(const r in this.buckets){if(!e.style.hasLayer(r))continue;const i=this.buckets[r],o=i.layers[0].sourceLayer||"_geojsonTileLayer",s=n[o],a=t[o];if(!s||!a||0===Object.keys(a).length)continue;i.update(a,s,this.imageAtlas&&this.imageAtlas.patternPositions||{});const l=e&&e.style&&e.style.getLayer(r);l&&(this.queryPadding=Math.max(this.queryPadding,l.queryRadius(i)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<V.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=V.now()+t}setDependencies(t,e){const n={};for(const t of e)n[t]=!0;this.dependencies[t]=n}hasDependency(t,e){for(const n of t){const t=this.dependencies[n];if(t)for(const n of e)if(t[n])return!0}return!1}clearQueryDebugViz(){}}class tp{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,e,n){const r=String(e);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][r]=this.stateChanges[t][r]||{},_(this.stateChanges[t][r],n),null===this.deletedStates[t]){this.deletedStates[t]={};for(const e in this.state[t])e!==r&&(this.deletedStates[t][e]=null)}else if(this.deletedStates[t]&&null===this.deletedStates[t][r]){this.deletedStates[t][r]={};for(const e in this.state[t][r])n[e]||(this.deletedStates[t][r][e]=null)}else for(const e in n)this.deletedStates[t]&&this.deletedStates[t][r]&&null===this.deletedStates[t][r][e]&&delete this.deletedStates[t][r][e]}removeFeatureState(t,e,n){if(null===this.deletedStates[t])return;const r=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},n&&void 0!==e)null!==this.deletedStates[t][r]&&(this.deletedStates[t][r]=this.deletedStates[t][r]||{},this.deletedStates[t][r][n]=null);else if(void 0!==e)if(this.stateChanges[t]&&this.stateChanges[t][r])for(n in this.deletedStates[t][r]={},this.stateChanges[t][r])this.deletedStates[t][r][n]=null;else this.deletedStates[t][r]=null;else this.deletedStates[t]=null}getState(t,e){const n=String(e),r=_({},(this.state[t]||{})[n],(this.stateChanges[t]||{})[n]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){const n=this.deletedStates[t][e];if(null===n)return{};for(const t in n)delete r[t]}return r}initializeTileState(t,e){t.setFeatureState(this.state,e)}coalesceChanges(t,e){const n={};for(const t in this.stateChanges){this.state[t]=this.state[t]||{};const e={};for(const n in this.stateChanges[t])this.state[t][n]||(this.state[t][n]={}),_(this.state[t][n],this.stateChanges[t][n]),e[n]=this.state[t][n];n[t]=e}for(const t in this.deletedStates){this.state[t]=this.state[t]||{};const e={};if(null===this.deletedStates[t])for(const n in this.state[t])e[n]={},this.state[t][n]={};else for(const n in this.deletedStates[t]){if(null===this.deletedStates[t][n])this.state[t][n]={};else for(const e of Object.keys(this.deletedStates[t][n]))delete this.state[t][n][e];e[n]=this.state[t][n]}n[t]=n[t]||{},_(n[t],e)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(n).length)for(const r in t)t[r].setFeatureState(n,e)}}class ep{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,e){const n=this.toIdx(t,e);return{min:this.minimums[n],max:this.maximums[n]}}isLeaf(t,e){return this.leaves[this.toIdx(t,e)]}toIdx(t,e){return e*this.size+t}}function np(t,e,n,r){let i=0,o=Number.MAX_VALUE;for(let s=0;s<3;s++)if(Math.abs(r[s])<1e-15){if(n[s]<t[s]||n[s]>e[s])return null}else{const a=1/r[s];let l=(t[s]-n[s])*a,u=(e[s]-n[s])*a;if(l>u){const t=l;l=u,u=t}if(l>i&&(i=l),u<o&&(o=u),i>o)return null}return i}function rp(t,e,n,r,i,o,s,a,l,u,c){const h=r-t,p=i-e,f=o-n,d=s-t,g=a-e,m=l-n,A=c[1]*m-c[2]*g,y=c[2]*d-c[0]*m,_=c[0]*g-c[1]*d,v=h*A+p*y+f*_;if(Math.abs(v)<1e-15)return null;const b=1/v,x=u[0]-t,w=u[1]-e,E=u[2]-n,S=(x*A+w*y+E*_)*b;if(S<0||S>1)return null;const T=w*f-E*p,P=E*h-x*f,M=x*p-w*h,C=(c[0]*T+c[1]*P+c[2]*M)*b;return C<0||S+C>1?null:(d*T+g*P+m*M)*b}function ip(t,e,n){return(t-e)/(n-e)}function op(t,e,n,r,i,o,s,a,l){const u=1<<n,c=o-r,h=s-i,p=(t+1)/u*c+r,f=(e+0)/u*h+i,d=(e+1)/u*h+i;a[0]=(t+0)/u*c+r,a[1]=f,l[0]=p,l[1]=d}class sp{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const e=function(t){const e=Math.ceil(Math.log2(t.dim/8)),n=[];let r=Math.ceil(Math.pow(2,e));const i=1/r,o=(t,e,n,r,i)=>{const o=r?1:0,s=(t+1)*n-o,a=e*n,l=(e+1)*n-o;i[0]=t*n,i[1]=a,i[2]=s,i[3]=l};let s=new ep(r);const a=[];for(let e=0;e<r*r;e++){o(e%r,Math.floor(e/r),i,!1,a);const n=lp(a[0],a[1],t),l=lp(a[2],a[1],t),u=lp(a[2],a[3],t),c=lp(a[0],a[3],t);s.minimums.push(Math.min(n,l,u,c)),s.maximums.push(Math.max(n,l,u,c)),s.leaves.push(1)}for(n.push(s),r/=2;r>=1;r/=2){const t=n[n.length-1];s=new ep(r);for(let e=0;e<r*r;e++){o(e%r,Math.floor(e/r),2,!0,a);const n=t.getElevation(a[0],a[1]),i=t.getElevation(a[2],a[1]),l=t.getElevation(a[2],a[3]),u=t.getElevation(a[0],a[3]),c=t.isLeaf(a[0],a[1]),h=t.isLeaf(a[2],a[1]),p=t.isLeaf(a[2],a[3]),f=t.isLeaf(a[0],a[3]),d=Math.min(n.min,i.min,l.min,u.min),g=Math.max(n.max,i.max,l.max,u.max),m=c&&h&&p&&f;s.maximums.push(g),s.minimums.push(d),s.leaves.push(g-d<=5&&m?1:0)}n.push(s)}return n}(this.dem),n=e.length-1,r=e[n];this._addNode(r.minimums[0],r.maximums[0],r.leaves[0]),this._construct(e,0,0,n,0)}raycastRoot(t,e,n,r,i,o,s=1){return np([t,e,-100],[n,r,this.maximums[0]*s],i,o)}raycast(t,e,n,r,i,o,s=1){if(!this.nodeCount)return null;const a=this.raycastRoot(t,e,n,r,i,o,s);if(null==a)return null;const l=[],u=[],c=[],h=[],p=[{idx:0,t:a,nodex:0,nodey:0,depth:0}];for(;p.length>0;){const{idx:a,t:f,nodex:d,nodey:g,depth:m}=p.pop();if(this.leaves[a]){op(d,g,m,t,e,n,r,c,h);const a=1<<m,l=(d+0)/a,u=(d+1)/a,p=(g+0)/a,A=(g+1)/a,y=lp(l,p,this.dem)*s,_=lp(u,p,this.dem)*s,v=lp(u,A,this.dem)*s,b=lp(l,A,this.dem)*s,x=rp(c[0],c[1],y,h[0],c[1],_,h[0],h[1],v,i,o),w=rp(h[0],h[1],v,c[0],h[1],b,c[0],c[1],y,i,o),E=Math.min(null!==x?x:Number.MAX_VALUE,null!==w?w:Number.MAX_VALUE);if(E!==Number.MAX_VALUE)return E;{const t=Ea([],i,o,f);if(ap(y,_,b,v,ip(t[0],c[0],h[0]),ip(t[1],c[1],h[1]))>=t[2])return f}continue}let A=0;for(let p=0;p<this._siblingOffset.length;p++){op((d<<1)+this._siblingOffset[p][0],(g<<1)+this._siblingOffset[p][1],m+1,t,e,n,r,c,h),c[2]=-100,h[2]=this.maximums[this.childOffsets[a]+p]*s;const f=np(c,h,i,o);if(null!=f){const t=f;l[p]=t;let e=!1;for(let n=0;n<A&&!e;n++)t>=l[u[n]]&&(u.splice(n,0,p),e=!0);e||(u[A]=p),A++}}for(let t=0;t<A;t++){const e=u[t];p.push({idx:this.childOffsets[a]+e,t:l[e],nodex:(d<<1)+this._siblingOffset[e][0],nodey:(g<<1)+this._siblingOffset[e][1],depth:m+1})}}return null}_addNode(t,e,n){return this.minimums.push(t),this.maximums.push(e),this.leaves.push(n),this.childOffsets.push(0),this.nodeCount++}_construct(t,e,n,r,i){if(1===t[r].isLeaf(e,n))return;this.childOffsets[i]||(this.childOffsets[i]=this.nodeCount);const o=r-1,s=t[o];let a,l=0;for(let t=0;t<this._siblingOffset.length;t++){const r=2*e+this._siblingOffset[t][0],i=2*n+this._siblingOffset[t][1],o=s.getElevation(r,i),u=s.isLeaf(r,i),c=this._addNode(o.min,o.max,u);u&&(l|=1<<t),a||(a=c)}for(let r=0;r<this._siblingOffset.length;r++)l&1<<r||this._construct(t,2*e+this._siblingOffset[r][0],2*n+this._siblingOffset[r][1],o,a+r)}}function ap(t,e,n,r,i,o){return nn(nn(t,n,o),nn(e,r,o),i)}function lp(t,e,n){const r=n.dim,i=g(t*r-.5,0,r-1),o=g(e*r-.5,0,r-1),s=Math.floor(i),a=Math.floor(o),l=Math.min(s+1,r-1),u=Math.min(a+1,r-1);return ap(n.get(s,a),n.get(l,a),n.get(s,u),n.get(l,u),i-s,o-a)}const up={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class cp{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,e,n,r=!1,i=!1){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(n&&"mapbox"!==n&&"terrarium"!==n)return O(`"${n}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=e.height;const o=this.dim=e.height-2;if(this.data=new Uint32Array(e.data.buffer),this.encoding=n||"mapbox",this.borderReady=r,!r){for(let t=0;t<o;t++)this.data[this._idx(-1,t)]=this.data[this._idx(0,t)],this.data[this._idx(o,t)]=this.data[this._idx(o-1,t)],this.data[this._idx(t,-1)]=this.data[this._idx(t,0)],this.data[this._idx(t,o)]=this.data[this._idx(t,o-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(o,-1)]=this.data[this._idx(o-1,0)],this.data[this._idx(-1,o)]=this.data[this._idx(0,o-1)],this.data[this._idx(o,o)]=this.data[this._idx(o-1,o-1)],i&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new sp(this)}get(t,e,n=!1){const r=new Uint8Array(this.data.buffer);n&&(t=g(t,-1,this.dim),e=g(e,-1,this.dim));const i=4*this._idx(t,e);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(r[i],r[i+1],r[i+2])}static getUnpackVector(t){return up[t]}get unpackVector(){return up[this.encoding]}_idx(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)}_unpackMapbox(t,e,n){return(256*t*256+256*e+n)/10-1e4}_unpackTerrarium(t,e,n){return 256*t+e+n/256-32768}static pack(t,e){const n=[0,0,0,0],r=cp.getUnpackVector(e);let i=Math.floor((t+r[3])/r[2]);return n[2]=i%256,i=Math.floor(i/256),n[1]=i%256,i=Math.floor(i/256),n[0]=i,n}getPixels(){return new qa({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,e,n){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let r=e*this.dim,i=e*this.dim+this.dim,o=n*this.dim,s=n*this.dim+this.dim;switch(e){case-1:r=i-1;break;case 1:i=r+1}switch(n){case-1:o=s-1;break;case 1:s=o+1}const a=-e*this.dim,l=-n*this.dim;for(let e=o;e<s;e++)for(let n=r;n<i;n++)this.data[this._idx(n,e)]=t.data[this._idx(n+a,e+l)]}onDeserialize(){this._tree&&(this._tree.dem=this)}}ai("DEMData",cp),ai("DemMinMaxQuadTree",sp,{omit:["dem"]});class hp{constructor(t,e){this.max=t,this.onRemove=e,this.reset()}reset(){for(const t in this.data)for(const e of this.data[t])e.timeout&&clearTimeout(e.timeout),this.onRemove(e.value);return this.data={},this.order=[],this}add(t,e,n){const r=t.wrapped().key;void 0===this.data[r]&&(this.data[r]=[]);const i={value:e,timeout:void 0};if(void 0!==n&&(i.timeout=setTimeout((()=>{this.remove(t,i)}),n)),this.data[r].push(i),this.order.push(r),this.order.length>this.max){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value}getByKey(t){const e=this.data[t];return e?e[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,e){if(!this.has(t))return this;const n=t.wrapped().key,r=void 0===e?0:this.data[n].indexOf(e),i=this.data[n][r];return this.data[n].splice(r,1),i.timeout&&clearTimeout(i.timeout),0===this.data[n].length&&delete this.data[n],this.onRemove(i.value),this.order.splice(this.order.indexOf(n),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}filter(t){const e=[];for(const n in this.data)for(const r of this.data[n])t(r.value)||e.push(r);for(const t of e)this.remove(t.value.tileID,t)}}class pp{constructor(t,e,n){this.func=t,this.mask=e,this.range=n}}pp.ReadOnly=!1,pp.ReadWrite=!0,pp.disabled=new pp(519,pp.ReadOnly,[0,1]);const fp=7680;class dp{constructor(t,e,n,r,i,o){this.test=t,this.ref=e,this.mask=n,this.fail=r,this.depthFail=i,this.pass=o}}dp.disabled=new dp({func:519,mask:0},0,0,fp,fp,fp);class gp{constructor(t,e,n){this.blendFunction=t,this.blendColor=e,this.mask=n}}gp.Replace=[1,0],gp.disabled=new gp(gp.Replace,ce.transparent,[!1,!1,!1,!1]),gp.unblended=new gp(gp.Replace,ce.transparent,[!0,!0,!0,!0]),gp.alphaBlended=new gp([1,771],ce.transparent,[!0,!0,!0,!0]);const mp=1029,Ap=2305;class yp{constructor(t,e,n){this.enable=t,this.mode=e,this.frontFace=n}}yp.disabled=new yp(!1,mp,Ap),yp.backCCW=new yp(!0,mp,Ap),yp.backCW=new yp(!0,mp,2304),yp.frontCW=new yp(!0,1028,2304),yp.frontCCW=new yp(!0,1028,Ap);class _p extends Ft{constructor(t,e,n){super(),this.id=t,this._onlySymbols=n,e.on("data",(t=>{"source"===t.dataType&&"metadata"===t.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))})),e.on("error",(()=>{this._sourceErrored=!0})),this._source=e,this._tiles={},this._cache=new hp(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new tp}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(const t in this._tiles){const e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(t,e){return t.isSymbolTile=this._onlySymbols,this._source.loadTile(t,e)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,(()=>{}))}_abortTile(t){if(this._source.abortTile)return this._source.abortTile(t,(()=>{}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const e in this._tiles){const n=this._tiles[e];n.upload(t),n.prepare(this.map.style.imageManager)}}getIds(){return y(this._tiles).map((t=>t.tileID)).sort(vp).map((t=>t.key))}getRenderableIds(t){const e=[];for(const n in this._tiles)this._isIdRenderable(+n,t)&&e.push(this._tiles[n]);return t?e.sort(((t,e)=>{const n=t.tileID,r=e.tileID,o=new i(n.canonical.x,n.canonical.y)._rotate(this.transform.angle),s=new i(r.canonical.x,r.canonical.y)._rotate(this.transform.angle);return n.overscaledZ-r.overscaledZ||s.y-o.y||s.x-o.x})).map((t=>t.tileID.key)):e.map((t=>t.tileID)).sort(vp).map((t=>t.key))}hasRenderableParent(t){const e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)}_isIdRenderable(t,e){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(+t,"reloading")}}_reloadTile(t,e){const n=this._tiles[t];n&&("loading"!==n.state&&(n.state=e),this._loadTile(n,this._tileLoaded.bind(this,n,t,e)))}_tileLoaded(t,e,n,r){if(r)return t.state="errored",void(404!==r.status?this._source.fire(new Nt(r,{tile:t})):this.update(this.transform));t.timeAdded=V.now(),"expired"===n&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(e,t),"raster-dem"===this.getSource().type&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new Dt("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(t){const e=this.getRenderableIds();for(let r=0;r<e.length;r++){const i=e[r];if(t.neighboringTiles&&t.neighboringTiles[i]){const e=this.getTileByID(i);n(t,e),n(e,t)}}function n(t,e){if(!t.dem||t.dem.borderReady)return;t.needsHillshadePrepare=!0,t.needsDEMTextureUpload=!0;let n=e.tileID.canonical.x-t.tileID.canonical.x;const r=e.tileID.canonical.y-t.tileID.canonical.y,i=Math.pow(2,t.tileID.canonical.z),o=e.tileID.key;0===n&&0===r||Math.abs(r)>1||(Math.abs(n)>1&&(1===Math.abs(n+i)?n+=i:1===Math.abs(n-i)&&(n-=i)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,n,r),t.neighboringTiles&&t.neighboringTiles[o]&&(t.neighboringTiles[o].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,e,n,r){for(const i in this._tiles){let o=this._tiles[i];if(r[i]||!o.hasData()||o.tileID.overscaledZ<=e||o.tileID.overscaledZ>n)continue;let s=o.tileID;for(;o&&o.tileID.overscaledZ>e+1;){const t=o.tileID.scaledTo(o.tileID.overscaledZ-1);o=this._tiles[t.key],o&&o.hasData()&&(s=t)}let a=s;for(;a.overscaledZ>e;)if(a=a.scaledTo(a.overscaledZ-1),t[a.key]){r[s.key]=s;break}}}findLoadedParent(t,e){if(t.key in this._loadedParentTiles){const n=this._loadedParentTiles[t.key];return n&&n.tileID.overscaledZ>=e?n:null}for(let n=t.overscaledZ-1;n>=e;n--){const e=t.scaledTo(n),r=this._getLoadedTile(e);if(r)return r}}_getLoadedTile(t){const e=this._tiles[t.key];return e&&e.hasData()?e:this._cache.getByKey(this._source.reparseOverscaled?t.wrapped().key:t.canonical.key)}updateCacheSize(t,e){e=e||this._source.tileSize;const n=Math.ceil(t.width/e)+1,r=Math.ceil(t.height/e)+1,i=Math.floor(n*r*5),o="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,i):i;this._cache.setMaxSize(o)}handleWrapJump(t){const e=Math.round((t-(void 0===this._prevLng?t:this._prevLng))/360);if(this._prevLng=t,e){const t={};for(const n in this._tiles){const r=this._tiles[n];r.tileID=r.tileID.unwrapTo(r.tileID.wrap+e),t[r.tileID.key]=r}this._tiles=t;for(const t in this._timers)clearTimeout(this._timers[t]),delete this._timers[t];for(const t in this._tiles)this._setTileReloadTimer(+t,this._tiles[t])}}update(t,e,n){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage)return;if(this.usedForTerrain&&!n)return;let r;this.updateCacheSize(t,e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?r=t.getVisibleUnwrappedCoordinates(this._source.tileID).map((t=>new Xh(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y))):(r=t.coveringTiles({tileSize:e||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!n,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(r=r.filter((t=>this._source.hasTile(t))))):r=[];const i=this._updateRetainedTiles(r);if(bp(this._source.type)&&0!==r.length){const t={},e={},n=Object.keys(i);for(const r of n){const n=i[r],o=this._tiles[r];if(!o||o.fadeEndTime&&o.fadeEndTime<=V.now())continue;const s=this.findLoadedParent(n,Math.max(n.overscaledZ-_p.maxOverzooming,this._source.minzoom));s&&(this._addTile(s.tileID),t[s.tileID.key]=s.tileID),e[r]=n}const o=r[r.length-1].overscaledZ;for(const t in this._tiles){const n=this._tiles[t];if(i[t]||!n.hasData())continue;let r=n.tileID;for(;r.overscaledZ>o;){r=r.scaledTo(r.overscaledZ-1);const o=this._tiles[r.key];if(o&&o.hasData()&&e[r.key]){i[t]=n.tileID;break}}}for(const e in t)i[e]||(this._coveredTiles[e]=!0,i[e]=t[e])}for(const t in i)this._tiles[t].clearFadeHold();const o=function(t,e){const n=[];for(const r in t)r in e||n.push(r);return n}(this._tiles,i);for(const t of o){const e=this._tiles[t];e.hasSymbolBuckets&&!e.holdingForFade()?e.setHoldDuration(this.map._fadeDuration):e.hasSymbolBuckets&&!e.symbolFadeFinished()||this._removeTile(+t)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(+t)}_updateRetainedTiles(t){const e={};if(0===t.length)return e;const n={},r=t[t.length-1].overscaledZ,i=t[0].overscaledZ,o=Math.max(i-_p.maxOverzooming,this._source.minzoom),s=Math.max(i+_p.maxUnderzooming,this._source.minzoom),a={};for(const n of t){const t=this._addTile(n);e[n.key]=n,t.hasData()||r<this._source.maxzoom&&(a[n.key]=n)}this._retainLoadedChildren(a,r,s,e);for(const r of t){let t=this._tiles[r.key];if(t.hasData())continue;if(r.canonical.z>=this._source.maxzoom){const t=r.children(this._source.maxzoom)[0],n=this.getTile(t);if(n&&n.hasData()){e[t.key]=t;continue}}else{const t=r.children(this._source.maxzoom);if(e[t[0].key]&&e[t[1].key]&&e[t[2].key]&&e[t[3].key])continue}let i=t.wasRequested();for(let s=r.overscaledZ-1;s>=o;--s){const o=r.scaledTo(s);if(n[o.key])break;if(n[o.key]=!0,t=this.getTile(o),!t&&i&&(t=this._addTile(o)),t&&(e[o.key]=o,i=t.wasRequested(),t.hasData()))break}}return e}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const e=[];let n,r=this._tiles[t].tileID;for(;r.overscaledZ>0;){if(r.key in this._loadedParentTiles){n=this._loadedParentTiles[r.key];break}e.push(r.key);const t=r.scaledTo(r.overscaledZ-1);if(n=this._getLoadedTile(t),n)break;r=t}for(const t of e)this._loadedParentTiles[t]=n}}_addTile(t){let e=this._tiles[t.key];if(e)return e;e=this._cache.getAndRemove(t),e&&(this._setTileReloadTimer(t.key,e),e.tileID=t,this._state.initializeTileState(e,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,e)));const n=Boolean(e);return n||(e=new Jh(t,this._source.tileSize*t.overscaleFactor(),this.transform.tileZoom),this._loadTile(e,this._tileLoaded.bind(this,e,t.key,e.state))),e?(e.uses++,this._tiles[t.key]=e,n||this._source.fire(new Dt("dataloading",{tile:e,coord:e.tileID,dataType:"source"})),e):null}_setTileReloadTimer(t,e){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const n=e.getExpiryTimeout();n&&(this._timers[t]=setTimeout((()=>{this._reloadTile(t,"expired"),delete this._timers[t]}),n))}_removeTile(t){const e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()&&"reloading"!==e.state?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(+t);this._cache.reset()}tilesIn(t,e,n){const r=[],i=this.transform;if(!i)return r;for(const o in this._tiles){const s=this._tiles[o];if(n&&s.clearQueryDebugViz(),s.holdingForFade())continue;const a=t.containsTile(s,i,e);a&&r.push(a)}return r}getVisibleCoordinates(t){const e=this.getRenderableIds(t).map((t=>this._tiles[t].tileID));for(const t of e)t.projMatrix=this.transform.calculateProjMatrix(t.toUnwrapped());return e}hasTransition(){if(this._source.hasTransition())return!0;if(bp(this._source.type))for(const t in this._tiles){const e=this._tiles[t];if(void 0!==e.fadeEndTime&&e.fadeEndTime>=V.now())return!0}return!1}setFeatureState(t,e,n){this._state.updateState(t=t||"_geojsonTileLayer",e,n)}removeFeatureState(t,e,n){this._state.removeFeatureState(t=t||"_geojsonTileLayer",e,n)}getFeatureState(t,e){return this._state.getState(t=t||"_geojsonTileLayer",e)}setDependencies(t,e,n){const r=this._tiles[t];r&&r.setDependencies(e,n)}reloadTilesForDependencies(t,e){for(const n in this._tiles)this._tiles[n].hasDependency(t,e)&&this._reloadTile(+n,"reloading");this._cache.filter((n=>!n.hasDependency(t,e)))}}function vp(t,e){const n=Math.abs(2*t.wrap)-+(t.wrap<0),r=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||r-n||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function bp(t){return"raster"===t||"image"===t||"video"===t}_p.maxOverzooming=10,_p.maxUnderzooming=3;class xp{constructor(t,e,n){this._demTile=t,this._dem=this._demTile.dem,this._scale=e,this._offset=n}static create(t,e,n){const r=n||t.findDEMTileFor(e);if(!r||!r.dem)return;const i=r.dem,o=r.tileID,s=1<<e.canonical.z-o.canonical.z;return new xp(r,r.tileSize/Gs/s,[(e.canonical.x/s-o.canonical.x)*i.dim,(e.canonical.y/s-o.canonical.y)*i.dim])}tileCoordToPixel(t,e){const n=e*this._scale+this._offset[1],r=Math.floor(t*this._scale+this._offset[0]),o=Math.floor(n);return new i(r,o)}getElevationAt(t,e,n,r){const i=t*this._scale+this._offset[0],o=e*this._scale+this._offset[1],s=Math.floor(i),a=Math.floor(o),l=this._dem;return r=!!r,n?nn(nn(l.get(s,a,r),l.get(s,a+1,r),o-a),nn(l.get(s+1,a,r),l.get(s+1,a+1,r),o-a),i-s):l.get(s,a,r)}getElevationAtPixel(t,e,n){return this._dem.get(t,e,!!n)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*Nh(1,t)*this._dem.stride}}class wp{constructor(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new ni(Gs,16,0),this.featureIndexArray=new ss,this.promoteId=e}insert(t,e,n,r,i,o=0){const s=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,r,i,o);const a=this.grid;for(let t=0;t<e.length;t++){const n=e[t],r=[1/0,1/0,-1/0,-1/0];for(let t=0;t<n.length;t++){const e=n[t];r[0]=Math.min(r[0],e.x),r[1]=Math.min(r[1],e.y),r[2]=Math.max(r[2],e.x),r[3]=Math.max(r[3],e.y)}r[0]<Gs&&r[1]<Gs&&r[2]>=0&&r[3]>=0&&a.insert(s,r[0],r[1],r[2],r[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Hl.VectorTile(new ku(this.rawTileData)).layers,this.sourceLayerCoder=new Yh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,e,n,r){this.loadVTLayers();const i=t.params||{},o=Er(i.filter),s=t.tileResult,a=t.transform,l=s.bufferedTilespaceBounds,u=this.grid.query(l.min.x,l.min.y,l.max.x,l.max.y,((t,e,n,r)=>sa(s.bufferedTilespaceGeometry,t,e,n,r)));u.sort(Sp);let c=null;a.elevation&&u.length>0&&(c=xp.create(a.elevation,this.tileID));const h={};let p;for(let a=0;a<u.length;a++){const l=u[a];if(l===p)continue;p=l;const f=this.featureIndexArray.get(l);let d=null;this.loadMatchingFeature(h,f,o,i.layers,i.availableImages,e,n,r,((e,n,r,i=0)=>(d||(d=Ws(e)),n.queryIntersectsFeature(s,e,r,d,this.z,t.transform,t.pixelPosMatrix,c,i))))}return h}loadMatchingFeature(t,e,n,r,i,o,s,a,l){const{featureIndex:u,bucketIndex:c,sourceLayerIndex:h,layoutVertexArrayOffset:p}=e,f=this.bucketLayerIDs[c];if(r&&!function(t,e){for(let n=0;n<t.length;n++)if(e.indexOf(t[n])>=0)return!0;return!1}(r,f))return;const d=this.sourceLayerCoder.decode(h),g=this.vtLayers[d].feature(u);if(n.needGeometry){const t=Hs(g,!0);if(!n.filter(new so(this.tileID.overscaledZ),t,this.tileID.canonical))return}else if(!n.filter(new so(this.tileID.overscaledZ),g))return;const m=this.getId(g,d);for(let e=0;e<f.length;e++){const n=f[e];if(r&&r.indexOf(n)<0)continue;const c=o[n];if(!c)continue;let h={};void 0!==m&&a&&(h=a.getState(c.sourceLayer||"_geojsonTileLayer",m));const d=_({},s[n]);d.paint=Ep(d.paint,c.paint,g,h,i),d.layout=Ep(d.layout,c.layout,g,h,i);const A=!l||l(g,c,h,p);if(!A)continue;const y=new Qh(g,this.z,this.x,this.y,m);y.layer=d;let v=t[n];void 0===v&&(v=t[n]=[]),v.push({featureIndex:u,feature:y,intersectionZ:A})}}lookupSymbolFeatures(t,e,n,r,i,o,s,a){const l={};this.loadVTLayers();const u=Er(i);for(const i of t)this.loadMatchingFeature(l,{bucketIndex:n,sourceLayerIndex:r,featureIndex:i,layoutVertexArrayOffset:0},u,o,s,a,e);return l}hasLayer(t){for(const e of this.bucketLayerIDs)for(const n of e)if(t===n)return!0;return!1}getId(t,e){let n=t.id;return this.promoteId&&(n=t.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[e]],"boolean"==typeof n&&(n=Number(n))),n}}function Ep(t,e,n,r,i){return P(t,((t,o)=>{const s=e instanceof go?e.get(o):null;return s&&s.evaluate?s.evaluate(n,r,i):s}))}function Sp(t,e){return e-t}ai("FeatureIndex",wp,{omit:["rawTileData","sourceLayerCoder"]});class Tp{constructor(t){const e={},n=[];for(const r in t){const i=t[r],o=e[r]={};for(const t in i.glyphs){const e=i.glyphs[+t];if(!e||0===e.bitmap.width||0===e.bitmap.height)continue;const r=e.metrics.localGlyph?2:1,s={x:0,y:0,w:e.bitmap.width+2*r,h:e.bitmap.height+2*r};n.push(s),o[t]=s}}const{w:r,h:i}=rc(n),o=new Za({width:r||1,height:i||1});for(const n in t){const r=t[n];for(const t in r.glyphs){const i=r.glyphs[+t];if(!i||0===i.bitmap.width||0===i.bitmap.height)continue;const s=e[n][t],a=i.metrics.localGlyph?2:1;Za.copy(i.bitmap,o,{x:0,y:0},{x:s.x+a,y:s.y+a},i.bitmap)}}this.image=o,this.positions=e}}ai("GlyphAtlas",Tp);class Pp{constructor(t){this.tileID=new Xh(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId,this.enableTerrain=!!t.enableTerrain,this.isSymbolTile=t.isSymbolTile}parse(t,e,n,r,i){this.status="parsing",this.data=t,this.collisionBoxArray=new Ko;const o=new Yh(Object.keys(t.layers).sort()),s=new wp(this.tileID,this.promoteId);s.bucketLayerIDs=[];const a={},l=new jh(256,256),u={featureIndex:s,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:l,availableImages:n},c=e.familiesBySource[this.source];for(const e in c){const r=t.layers[e];if(!r)continue;let i=!1,l=!1;for(const t of c[e])"symbol"===t[0].type?i=!0:l=!0;if(!0===this.isSymbolTile&&!i)continue;if(!1===this.isSymbolTile&&!l)continue;1===r.version&&O(`Vector tile source "${this.source}" layer "${e}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const h=o.encode(e),p=[];for(let t=0;t<r.length;t++){const n=r.feature(t),i=s.getId(n,e);p.push({feature:n,id:i,index:t,sourceLayerIndex:h})}for(const t of c[e]){const e=t[0];void 0!==this.isSymbolTile&&"symbol"===e.type!==this.isSymbolTile||e.minzoom&&this.zoom<Math.floor(e.minzoom)||e.maxzoom&&this.zoom>=e.maxzoom||"none"!==e.visibility&&(Mp(t,this.zoom,n),(a[e.id]=e.createBucket({index:s.bucketLayerIDs.length,layers:t,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:h,sourceID:this.source,enableTerrain:this.enableTerrain})).populate(p,u,this.tileID.canonical),s.bucketLayerIDs.push(t.map((t=>t.id))))}}let h,p,f,d;l.trim();const g={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},m=P(u.glyphDependencies,(t=>Object.keys(t).map(Number)));Object.keys(m).length?r.send("getGlyphs",{uid:this.uid,stacks:m},((t,e)=>{h||(h=t,p=e,v.call(this))}),void 0,!1,g):p={};const A=Object.keys(u.iconDependencies);A.length?r.send("getImages",{icons:A,source:this.source,tileID:this.tileID,type:"icons"},((t,e)=>{h||(h=t,f=e,v.call(this))}),void 0,!1,g):f={};const _=Object.keys(u.patternDependencies);function v(){if(h)return i(h);if(p&&f&&d){const t=new Tp(p),e=new oc(f,d);for(const r in a){const i=a[r];i instanceof ph?(Mp(i.layers,this.zoom,n),Yc(i,p,t.positions,f,e.iconPositions,this.showCollisionBoxes,this.tileID.canonical,this.tileZoom)):i.hasPattern&&(i instanceof hu||i instanceof Ll||i instanceof Kl)&&(Mp(i.layers,this.zoom,n),i.addFeatures(u,this.tileID.canonical,e.patternPositions))}this.status="done",i(null,{buckets:y(a).filter((t=>!t.isEmpty())),featureIndex:s,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:t.image,lineAtlas:l,imageAtlas:e,glyphMap:this.returnDependencies?p:null,iconMap:this.returnDependencies?f:null,glyphPositions:this.returnDependencies?t.positions:null})}}_.length?r.send("getImages",{icons:_,source:this.source,tileID:this.tileID,type:"patterns"},((t,e)=>{h||(h=t,d=e,v.call(this))}),void 0,!1,g):d={},v.call(this)}}function Mp(t,e,n){const r=new so(e);for(const e of t)e.recalculate(r,n)}class Cp{constructor(t){this.entries={},this.scheduler=t}request(t,e,n,r){const i=this.entries[t]=this.entries[t]||{callbacks:[]};if(i.result){const[t,n]=i.result;return this.scheduler?this.scheduler.add((()=>{r(t,n)}),e):r(t,n),()=>{}}return i.callbacks.push(r),i.cancel||(i.cancel=n(((n,r)=>{i.result=[n,r];for(const t of i.callbacks)this.scheduler?this.scheduler.add((()=>{t(n,r)}),e):t(n,r);setTimeout((()=>delete this.entries[t]),3e3)}))),()=>{i.result||(i.callbacks=i.callbacks.filter((t=>t!==r)),i.callbacks.length||(i.cancel(),delete this.entries[t]))}}}function Ip(t,e,n){const r=JSON.stringify(t.request);return t.data&&(this.deduped.entries[r]={result:[null,t.data]}),this.deduped.request(r,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom},(e=>{const r=St(t.request,((t,r,i,o)=>{t?e(t):r&&e(null,{vectorTile:n?void 0:new Hl.VectorTile(new ku(r)),rawData:r,cacheControl:i,expires:o})}));return()=>{r.cancel(),e()}}),e)}t.ARRAY_TYPE=da,t.AUTH_ERR_MSG=K,t.Actor=class{constructor(t,e,n){this.target=t,this.parent=e,this.mapId=n,this.callbacks={},this.cancelCallbacks={},S(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=k()?t:s,this.scheduler=new Zh}send(t,e,n,r,i=!1,o){const s=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(n.metadata=o,this.callbacks[s]=n);const a=j(this.globalScope)?void 0:[];return this.target.postMessage({id:s,type:t,hasCallback:!!n,targetMapId:r,mustQueue:i,sourceMapId:this.mapId,data:ci(e,a)},a),{cancel:()=>{n&&delete this.callbacks[s],this.target.postMessage({id:s,type:"<cancel>",targetMapId:r,sourceMapId:this.mapId})}}}receive(t){const e=t.data,n=e.id;if(n&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){const t=this.cancelCallbacks[n];delete this.cancelCallbacks[n],t&&t.cancel()}else if(e.mustQueue||k()){const t=this.callbacks[n];this.cancelCallbacks[n]=this.scheduler.add((()=>this.processTask(n,e)),t&&t.metadata||{type:"message"})}else this.processTask(n,e)}processTask(t,e){if("<response>"===e.type){const n=this.callbacks[t];delete this.callbacks[t],n&&(e.error?n(hi(e.error)):n(null,hi(e.data)))}else{const n=j(this.globalScope)?void 0:[],r=e.hasCallback?(e,r)=>{delete this.cancelCallbacks[t],this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:e?ci(e):null,data:ci(r,n)},n)}:t=>{},i=hi(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,i,r);else if(this.parent.getWorkerSource){const t=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,t[0],i.source)[t[1]](i,r)}else r(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},t.CanonicalTileID=Wh,t.Color=ce,t.ColorMode=gp,t.CullFaceMode=yp,t.DEMData=cp,t.DataConstantProperty=mo,t.DedupedRequest=Cp,t.DepthMode=pp,t.EXTENT=Gs,t.Elevation=class{getAtPointOrZero(t,e=0){return this.getAtPoint(t,e)||0}getAtPoint(t,e,n=!0){null==e&&(e=null);const r=this._source();if(!r)return e;if(t.y<0||t.y>1)return e;const i=r.getSource().maxzoom,o=1<<i,s=Math.floor(t.x),a=t.x-s,l=new Xh(i,s,i,Math.floor(a*o),Math.floor(t.y*o)),u=this.findDEMTileFor(l);if(!u||!u.dem)return e;const c=u.dem,h=1<<u.tileID.canonical.z,p=(a*h-u.tileID.canonical.x)*c.dim,f=(t.y*h-u.tileID.canonical.y)*c.dim,d=Math.floor(p),g=Math.floor(f);return(n?this.exaggeration():1)*nn(nn(c.get(d,g),c.get(d,g+1),f-g),nn(c.get(d+1,g),c.get(d+1,g+1),f-g),p-d)}getAtTileOffset(t,e,n){const r=1<<t.canonical.z;return this.getAtPointOrZero(new zh(t.wrap+(t.canonical.x+e/Gs)/r,(t.canonical.y+n/Gs)/r))}getForTilePoints(t,e,n,r){const i=xp.create(this,t,r);return!!i&&(e.forEach((t=>{t[2]=this.exaggeration()*i.getElevationAt(t[0],t[1],n)})),!0)}getMinMaxForTile(t){const e=this.findDEMTileFor(t);if(!e||!e.dem)return null;const n=e.dem.tree,r=e.tileID,i=1<<t.canonical.z-r.canonical.z;let o=t.canonical.x/i-r.canonical.x,s=t.canonical.y/i-r.canonical.y,a=0;for(let e=0;e<t.canonical.z-r.canonical.z&&!n.leaves[a];e++){o*=2,s*=2;const t=2*Math.floor(s)+Math.floor(o);a=n.childOffsets[a]+t,o%=1,s%=1}return{min:this.exaggeration()*n.minimums[a],max:this.exaggeration()*n.maximums[a]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,e,n){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},t.ErrorEvent=Nt,t.EvaluationParameters=so,t.Event=Dt,t.Evented=Ft,t.GlyphManager=Dc,t.ImagePosition=ic,t.LineAtlas=jh,t.LngLat=Oh,t.LngLatBounds=Ch,t.LocalGlyphMode=kc,t.MAX_SAFE_INTEGER=a,t.MercatorCoordinate=zh,t.ONE_EM=xu,t.OverscaledTileID=Xh,t.Properties=bo,t.RGBAImage=qa,t.RequestManager=class{constructor(t,e,n){this._transformRequestFn=t,this._customAccessToken=e,this._silenceAuthErrors=!!n,this._createSkuToken()}_createSkuToken(){const t=function(){let t="";for(let e=0;e<10;e++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Q,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}normalizeStyleURL(t,e){if(!J(t))return t;const n=nt(t);return n.path=`/styles/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeGlyphsURL(t,e){if(!J(t))return t;const n=nt(t);return n.path=`/fonts/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeSourceURL(t,e){if(!J(t))return t;const n=nt(t);return n.path=`/v4/${n.authority}.json`,n.params.push("secure"),this._makeAPIURL(n,this._customAccessToken||e)}normalizeSpriteURL(t,e,n,r){const i=nt(t);return J(t)?(i.path=`/styles/v1${i.path}/sprite${e}${n}`,this._makeAPIURL(i,this._customAccessToken||r)):(i.path+=`${e}${n}`,rt(i))}normalizeTileURL(t,e,n){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!J(t))return t;const r=nt(t);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||n&&"raster"!==r.authority&&512===n?"@2x":""}${q.supported?".webp":"$1"}`),"raster"===r.authority?r.path=`/${Z.RASTER_URL_PREFIX}${r.path}`:(r.path=r.path.replace(/^.+\/v4\//,"/"),r.path=`/${Z.TILE_URL_VERSION}${r.path}`);const i=this._customAccessToken||function(t){for(const e of t){const t=e.match(/^access_token=(.*)$/);if(t)return t[1]}return null}(r.params)||Z.ACCESS_TOKEN;return Z.REQUIRE_ACCESS_TOKEN&&i&&this._skuToken&&r.params.push(`sku=${this._skuToken}`),this._makeAPIURL(r,i)}canonicalizeTileURL(t,e){const n=nt(t);if(!n.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!n.path.match(/\.[\w]+$/))return t;let r="mapbox://";n.path.match(/^\/raster\/v1\//)?r+=`raster/${n.path.replace(`/${Z.RASTER_URL_PREFIX}/`,"")}`:r+=`tiles/${n.path.replace(`/${Z.TILE_URL_VERSION}/`,"")}`;let i=n.params;return e&&(i=i.filter((t=>!t.match(/^access_token=/)))),i.length&&(r+=`?${i.join("&")}`),r}canonicalizeTileset(t,e){const n=!!e&&J(e),r=[];for(const e of t.tiles||[])tt(e)?r.push(this.canonicalizeTileURL(e,n)):r.push(e);return r}_makeAPIURL(t,e){const n="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",r=nt(Z.API_URL);if(t.protocol=r.protocol,t.authority=r.authority,"http"===t.protocol){const e=t.params.indexOf("secure");e>=0&&t.params.splice(e,1)}if("/"!==r.path&&(t.path=`${r.path}${t.path}`),!Z.REQUIRE_ACCESS_TOKEN)return rt(t);if(e=e||Z.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${n}`);if("s"===e[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${n}`)}return t.params=t.params.filter((t=>-1===t.indexOf("access_token"))),t.params.push(`access_token=${e||""}`),rt(t)}},t.ResourceType=bt,t.SegmentVector=Vs,t.SourceCache=_p,t.StencilMode=dp,t.StructArrayLayout1ui2=Ho,t.StructArrayLayout2f1f2i16=Bo,t.StructArrayLayout2i4=Mo,t.StructArrayLayout2ui4=Wo,t.StructArrayLayout3f12=Oo,t.StructArrayLayout3ui6=jo,t.StructArrayLayout4i8=Co,t.Texture=Mh,t.Tile=Jh,t.Transitionable=uo,t.Uniform1f=vs,t.Uniform1i=class extends _s{constructor(t,e){super(t,e),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))}},t.Uniform2f=class extends _s{constructor(t,e){super(t,e),this.current=[0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))}},t.Uniform3f=class extends _s{constructor(t,e){super(t,e),this.current=[0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))}},t.Uniform4f=bs,t.UniformColor=xs,t.UniformMatrix3f=class extends _s{constructor(t,e){super(t,e),this.current=Es}set(t){for(let e=0;e<9;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix3fv(this.location,!1,t);break}}},t.UniformMatrix4f=class extends _s{constructor(t,e){super(t,e),this.current=ws}set(t){if(t[12]!==this.current[12]||t[0]!==this.current[0])return this.current=t,void this.gl.uniformMatrix4fv(this.location,!1,t);for(let e=1;e<16;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix4fv(this.location,!1,t);break}}},t.UnwrappedTileID=Hh,t.ValidationError=zt,t.VectorTileWorkerSource=class extends Ft{constructor(t,e,n,r,i){super(),this.actor=t,this.layerIndex=e,this.availableImages=n,this.loadVectorData=i||Ip,this.loading={},this.loaded={},this.deduped=new Cp(t.scheduler),this.isSpriteLoaded=r,this.scheduler=t.scheduler}loadTile(t,e){const n=t.uid,r=t&&t.request,i=r&&r.collectResourceTiming,o=this.loading[n]=new Pp(t);o.abort=this.loadVectorData(t,((s,a)=>{const l=!this.loading[n];if(delete this.loading[n],l||s||!a)return o.status="done",l||(this.loaded[n]=o),e(s);const u=a.rawData,c={};a.expires&&(c.expires=a.expires),a.cacheControl&&(c.cacheControl=a.cacheControl),o.vectorTile=a.vectorTile||new Hl.VectorTile(new ku(u));const h=()=>{o.parse(o.vectorTile,this.layerIndex,this.availableImages,this.actor,((t,n)=>{if(t||!n)return e(t);const o={};if(i){const t=Gh(r);t.length>0&&(o.resourceTiming=JSON.parse(JSON.stringify(t)))}e(null,_({rawTileData:u.slice(0)},n,c,o))}))};this.isSpriteLoaded?h():this.once("isSpriteLoaded",(()=>{this.scheduler?this.scheduler.add(h,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom}):h()})),this.loaded=this.loaded||{},this.loaded[n]=o}))}reloadTile(t,e){const n=this.loaded,r=t.uid,i=this;if(n&&n[r]){const o=n[r];o.showCollisionBoxes=t.showCollisionBoxes,o.enableTerrain=!!t.enableTerrain;const s=(t,n)=>{const r=o.reloadCallback;r&&(delete o.reloadCallback,o.parse(o.vectorTile,i.layerIndex,this.availableImages,i.actor,r)),e(t,n)};"parsing"===o.status?o.reloadCallback=s:"done"===o.status&&(o.vectorTile?o.parse(o.vectorTile,this.layerIndex,this.availableImages,this.actor,s):s())}}abortTile(t,e){const n=t.uid,r=this.loading[n];r&&(r.abort&&r.abort(),delete this.loading[n]),e()}removeTile(t,e){const n=this.loaded,r=t.uid;n&&n[r]&&delete n[r],e()}},t.WritingMode=sc,t.ZoomHistory=pi,t.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},t.addDynamicAttributes=lh,t.altitudeFromMercatorZ=Bh,t.asyncAll=A,t.bezier=f,t.bindAll=S,t.bufferConvexPolygon=function(t,e){const n=[];for(let r=0;r<t.length;r++){const i=m(r-1,-1,t.length-1),o=m(r+1,-1,t.length-1),s=t[r],a=t[o],l=t[i].sub(s).unit(),u=a.sub(s).unit(),c=u.angleWithSep(l.x,l.y),h=l.add(u).unit().mult(-1*e/Math.sin(c/2));n.push(s.add(h))}return n},t.cacheEntryPossiblyAdded=function(t){vt++,vt>At&&(t.getActor().send("enforceCacheSizeLimit",mt),vt=0)},t.clamp=g,t.clearTileCache=function(t){const e=s.caches.delete(ft);t&&e.catch(t).then((()=>t()))},t.clipLine=Ic,t.clone=function(t){var e=new da(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},t.clone$1=function(t){var e=new da(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.clone$2=C,t.collisionCircleLayout=bu,t.config=Z,t.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},t.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},t.create=_a,t.create$1=function(){var t=new da(16);return da!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},t.create$2=ga,t.createExpression=cr,t.createFilter=Er,t.createLayout=To,t.createStyleLayer=function(t){return"custom"===t.type?new _h(t):new xh[t.type](t)},t.cross=function(t,e,n){var r=e[0],i=e[1],o=e[2],s=n[0],a=n[1],l=n[2];return t[0]=i*l-o*a,t[1]=o*s-r*l,t[2]=r*a-i*s,t},t.degToRad=c,t.div=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},t.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},t.dot$1=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},t.ease=d,t.easeCubicInOut=p,t.emitValidationErrors=ei,t.endsWith=T,t.enforceCacheSizeLimit=function(t){yt(),dt&&dt.then((e=>{e.keys().then((n=>{for(let r=0;r<n.length-t;r++)e.delete(n[r])}))}))},t.evaluateSizeForFeature=Su,t.evaluateSizeForZoom=Tu,t.evaluateVariableOffset=$c,t.evented=no,t.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},t.exactEquals$1=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},t.exported=V,t.exported$1=q,t.extend=_,t.filterObject=M,t.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},t.fromQuat=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n+n,a=r+r,l=i+i,u=n*s,c=r*s,h=r*a,p=i*s,f=i*a,d=i*l,g=o*s,m=o*a,A=o*l;return t[0]=1-h-d,t[1]=c+A,t[2]=p-m,t[3]=0,t[4]=c-A,t[5]=1-u-d,t[6]=f+g,t[7]=0,t[8]=p+m,t[9]=f-g,t[10]=1-u-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},t.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.furthestTileCorner=function(t){const e=Math.round((t+45+360)%360/90)%4;return h[e]},t.getAABBPointSquareDist=function(t,e,n){let r=0;for(let i=0;i<2;++i){const o=n?n[i]:0;t[i]>o&&(r+=(t[i]-o)*(t[i]-o)),e[i]<o&&(r+=(o-e[i])*(o-e[i]))}return r},t.getAnchorAlignment=yc,t.getAnchorJustification=Qc,t.getBounds=function(t){let e=1/0,n=1/0,r=-1/0,o=-1/0;for(const i of t)e=Math.min(e,i.x),n=Math.min(n,i.y),r=Math.max(r,i.x),o=Math.max(o,i.y);return{min:new i(e,n),max:new i(r,o)}},t.getImage=Rt,t.getJSON=function(t,e){return Et(_(t,{type:"json"}),e)},t.getMapSessionAPI=ht,t.getPerformanceMeasurement=Gh,t.getRTLTextPluginStatus=ro,t.getReferrer=wt,t.getVideo=function(t,e){const n=s.document.createElement("video");n.muted=!0,n.onloadstart=function(){e(null,n)};for(let e=0;e<t.length;e++){const r=s.document.createElement("source");Mt(t[e])||(n.crossOrigin="Anonymous"),r.src=t[e],n.appendChild(r)}return{cancel:()=>{}}},t.identity=ma,t.identity$1=La,t.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],p=e[10],f=e[11],d=e[12],g=e[13],m=e[14],A=e[15],y=n*a-r*s,_=n*l-i*s,v=n*u-o*s,b=r*l-i*a,x=r*u-o*a,w=i*u-o*l,E=c*g-h*d,S=c*m-p*d,T=c*A-f*d,P=h*m-p*g,M=h*A-f*g,C=p*A-f*m,I=y*C-_*M+v*P+b*T-x*S+w*E;return I?(t[0]=(a*C-l*M+u*P)*(I=1/I),t[1]=(i*M-r*C-o*P)*I,t[2]=(g*w-m*x+A*b)*I,t[3]=(p*x-h*w-f*b)*I,t[4]=(l*T-s*C-u*S)*I,t[5]=(n*C-i*T+o*S)*I,t[6]=(m*v-d*w-A*_)*I,t[7]=(c*w-p*v+f*_)*I,t[8]=(s*M-a*T+u*E)*I,t[9]=(r*T-n*M-o*E)*I,t[10]=(d*x-g*v+A*y)*I,t[11]=(h*v-c*x-f*y)*I,t[12]=(a*S-s*P-l*E)*I,t[13]=(n*P-r*S+i*E)*I,t[14]=(g*_-d*b-m*y)*I,t[15]=(c*b-h*_+p*y)*I,t):null},t.isMapAuthenticated=function(t){return pt.has(t)},t.isMapboxURL=J,t.latFromMercatorY=Fh,t.len=Ia,t.length=va,t.length$1=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},t.loadVectorTile=Ip,t.makeRequest=Et,t.mercatorXfromLng=kh,t.mercatorYfromLat=Dh,t.mercatorZfromAltitude=Nh,t.mul=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t},t.mul$1=ya,t.mul$2=Ca,t.multiply=Aa,t.multiply$1=wa,t.nextPowerOfTwo=w,t.normalize=Sa,t.normalize$1=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n*n+r*r+i*i+o*o;return s>0&&(s=1/Math.sqrt(s)),t[0]=n*s,t[1]=r*s,t[2]=i*s,t[3]=o*s,t},t.number=nn,t.ortho=function(t,e,n,r,i,o,s){var a=1/(e-n),l=1/(r-i),u=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*l,t[14]=(s+o)*u,t[15]=1,t},t.pbf=ku,t.perspective=function(t,e,n,r,i){var o,s=1/Math.tan(e/2);return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(t[10]=(i+r)*(o=1/(r-i)),t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t},t.pick=function(t,e){const n={};for(let r=0;r<e.length;r++){const i=e[r];i in t&&(n[i]=t[i])}return n},t.plugin=oo,t.pointGeometry=i,t.polygonIntersectsBox=sa,t.polygonIntersectsPolygon=Ys,t.polygonizeBounds=function(t,e,n=0,r=!0){const o=new i(n,n),s=t.sub(o),a=e.add(o),l=[s,new i(a.x,s.y),a,new i(s.x,a.y)];return r&&l.push(s),l},t.posAttributes=Kh,t.postMapLoadEvent=ut,t.postTurnstileEvent=at,t.potpack=rc,t.prevPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},t.radToDeg=function(t){return t*u},t.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.registerForPluginStateChange=function(t){return t({pluginStatus:Ki,pluginURL:Ji}),no.on("pluginStateChange",t),t},t.removeAuthState=function(t){pt.delete(t)},t.renderColorRamp=Ha,t.rotateX=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],s=e[5],a=e[6],l=e[7],u=e[8],c=e[9],h=e[10],p=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+u*r,t[5]=s*i+c*r,t[6]=a*i+h*r,t[7]=l*i+p*r,t[8]=u*i-o*r,t[9]=c*i-s*r,t[10]=h*i-a*r,t[11]=p*i-l*r,t},t.rotateX$1=ka,t.rotateY=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],s=e[1],a=e[2],l=e[3],u=e[8],c=e[9],h=e[10],p=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-u*r,t[1]=s*i-c*r,t[2]=a*i-h*r,t[3]=l*i-p*r,t[8]=o*r+u*i,t[9]=s*r+c*i,t[10]=a*r+h*i,t[11]=l*r+p*i,t},t.rotateZ=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],s=e[1],a=e[2],l=e[3],u=e[4],c=e[5],h=e[6],p=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+u*r,t[1]=s*i+c*r,t[2]=a*i+h*r,t[3]=l*i+p*r,t[4]=u*i-o*r,t[5]=c*i-s*r,t[6]=h*i-a*r,t[7]=p*i-l*r,t},t.rotateZ$1=function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=r*l+i*a,t[1]=i*l-r*a,t[2]=o*l+s*a,t[3]=s*l-o*a,t},t.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},t.scale$1=function(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.scale$2=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},t.scaleAndAdd=Ea,t.setCacheLimits=function(t,e){mt=t,At=e},t.setRTLTextPlugin=function(t,e,n=!1){if(Ki===Xi||Ki===$i||Ki===Yi)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ji=V.resolveURL(t),Ki=Xi,Qi=e,eo(),n||io()},t.smoothstep=function(t,e,n){return(n=g((n-t)/(e-t),0,1))*n*(3-2*n)},t.spec=Bt,t.storeAuthState=function(t,e){e?pt.add(t):pt.delete(t)},t.sub=Ma,t.subtract=xa,t.symbolSize=Pu,t.transformMat3=function(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t},t.transformMat4=Oa,t.transformMat4$1=function(t,e,n){var r=e[0],i=e[1],o=e[2],s=n[3]*r+n[7]*i+n[11]*o+n[15];return t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/(s=s||1),t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/s,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/s,t},t.transformQuat=Ta,t.translate=function(t,e,n){var r,i,o,s,a,l,u,c,h,p,f,d,g=n[0],m=n[1],A=n[2];return e===t?(t[12]=e[0]*g+e[4]*m+e[8]*A+e[12],t[13]=e[1]*g+e[5]*m+e[9]*A+e[13],t[14]=e[2]*g+e[6]*m+e[10]*A+e[14],t[15]=e[3]*g+e[7]*m+e[11]*A+e[15]):(i=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=e[9],f=e[10],d=e[11],t[0]=r=e[0],t[1]=i,t[2]=o,t[3]=s,t[4]=a,t[5]=l,t[6]=u,t[7]=c,t[8]=h,t[9]=p,t[10]=f,t[11]=d,t[12]=r*g+a*m+h*A+e[12],t[13]=i*g+l*m+p*A+e[13],t[14]=o*g+u*m+f*A+e[14],t[15]=s*g+c*m+d*A+e[15]),t},t.triggerPluginCompletionEvent=to,t.uniqueId=b,t.validateCustomStyleLayer=function(t){const e=[],n=t.id;return void 0===n&&e.push({message:`layers.${n}: missing required property "id"`}),void 0===t.render&&e.push({message:`layers.${n}: missing required method "render"`}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),e},t.validateFog=Kr,t.validateLight=Qr,t.validateStyle=Yr,t.values=y,t.vectorTile=Hl,t.version=e,t.warnOnce=O,t.window=s,t.wrap=m})),r(0,(function(t){function e(t){const n=typeof t;if("number"===n||"boolean"===n||"string"===n||null==t)return JSON.stringify(t);if(Array.isArray(t)){let n="[";for(const r of t)n+=`${e(r)},`;return`${n}]`}const r=Object.keys(t).sort();let i="{";for(let n=0;n<r.length;n++)i+=`${JSON.stringify(r[n])}:${e(t[r[n]])},`;return`${i}}`}function n(n){let r="";for(const i of t.refProperties)r+=`/${e(n[i])}`;return r}class r{constructor(t){this.keyCache={},t&&this.replace(t)}replace(t){this._layerConfigs={},this._layers={},this.update(t,[])}update(e,r){for(const n of e){this._layerConfigs[n.id]=n;const e=this._layers[n.id]=t.createStyleLayer(n);e._featureFilter=t.createFilter(e.filter),this.keyCache[n.id]&&delete this.keyCache[n.id]}for(const t of r)delete this.keyCache[t],delete this._layerConfigs[t],delete this._layers[t];this.familiesBySource={};const i=function(t,e){const r={};for(let i=0;i<t.length;i++){const o=e&&e[t[i].id]||n(t[i]);e&&(e[t[i].id]=o);let s=r[o];s||(s=r[o]=[]),s.push(t[i])}const i=[];for(const t in r)i.push(r[t]);return i}(t.values(this._layerConfigs),this.keyCache);for(const t of i){const e=t.map((t=>this._layers[t.id])),n=e[0];if("none"===n.visibility)continue;const r=n.source||"";let i=this.familiesBySource[r];i||(i=this.familiesBySource[r]={});const o=n.sourceLayer||"_geojsonTileLayer";let s=i[o];s||(s=i[o]=[]),s.push(e)}}}const{ImageBitmap:i}=t.window;class o{loadTile(e,n){const{uid:r,encoding:o,rawImageData:s,padding:a,buildQuadTree:l}=e,u=i&&s instanceof i?this.getImageData(s,a):s;n(null,new t.DEMData(r,u,o,a<1,l))}getImageData(e,n){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(e.width,e.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=e.width,this.offscreenCanvas.height=e.height,this.offscreenCanvasContext.drawImage(e,0,0,e.width,e.height);const r=this.offscreenCanvasContext.getImageData(-n,-n,e.width+2*n,e.height+2*n);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new t.RGBAImage({width:r.width,height:r.height},r.data)}}var s=function t(e,n){var r,i=e&&e.type;if("FeatureCollection"===i)for(r=0;r<e.features.length;r++)t(e.features[r],n);else if("GeometryCollection"===i)for(r=0;r<e.geometries.length;r++)t(e.geometries[r],n);else if("Feature"===i)t(e.geometry,n);else if("Polygon"===i)a(e.coordinates,n);else if("MultiPolygon"===i)for(r=0;r<e.coordinates.length;r++)a(e.coordinates[r],n);return e};function a(t,e){if(0!==t.length){l(t[0],e);for(var n=1;n<t.length;n++)l(t[n],!e)}}function l(t,e){for(var n=0,r=0,i=t.length,o=i-1;r<i;o=r++)n+=(t[r][0]-t[o][0])*(t[o][1]+t[r][1]);n>=0!=!!e&&t.reverse()}const u=t.vectorTile.VectorTileFeature.prototype.toGeoJSON;class c{constructor(e){this._feature=e,this.extent=t.EXTENT,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))}loadGeometry(){if(1===this._feature.type){const e=[];for(const n of this._feature.geometry)e.push([new t.pointGeometry(n[0],n[1])]);return e}{const e=[];for(const n of this._feature.geometry){const r=[];for(const e of n)r.push(new t.pointGeometry(e[0],e[1]));e.push(r)}return e}}toGeoJSON(t,e,n){return u.call(this,t,e,n)}}class h{constructor(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.EXTENT,this.length=e.length,this._features=e}feature(t){return new c(this._features[t])}}var p=t.vectorTile.VectorTileFeature,f=d;function d(t,e){this.options=e||{},this.features=t,this.length=t.length}function g(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}d.prototype.feature=function(t){return new g(this.features[t],this.options.extent)},g.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var n=0;n<e.length;n++){for(var r=e[n],i=[],o=0;o<r.length;o++)i.push(new t.pointGeometry(r[o][0],r[o][1]));this.geometry.push(i)}return this.geometry},g.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,n=-1/0,r=1/0,i=-1/0,o=0;o<t.length;o++)for(var s=t[o],a=0;a<s.length;a++){var l=s[a];e=Math.min(e,l.x),n=Math.max(n,l.x),r=Math.min(r,l.y),i=Math.max(i,l.y)}return[e,r,n,i]},g.prototype.toGeoJSON=p.prototype.toGeoJSON;var m=y,A=f;function y(e){var n=new t.pbf;return function(t,e){for(var n in t.layers)e.writeMessage(3,_,t.layers[n])}(e,n),n.finish()}function _(t,e){var n;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var r={keys:[],values:[],keycache:{},valuecache:{}};for(n=0;n<t.length;n++)r.feature=t.feature(n),e.writeMessage(2,v,r);var i=r.keys;for(n=0;n<i.length;n++)e.writeStringField(3,i[n]);var o=r.values;for(n=0;n<o.length;n++)e.writeMessage(4,S,o[n])}function v(t,e){var n=t.feature;void 0!==n.id&&e.writeVarintField(1,n.id),e.writeMessage(2,b,t),e.writeVarintField(3,n.type),e.writeMessage(4,E,n)}function b(t,e){var n=t.feature,r=t.keys,i=t.values,o=t.keycache,s=t.valuecache;for(var a in n.properties){var l=o[a];void 0===l&&(r.push(a),o[a]=l=r.length-1),e.writeVarint(l);var u=n.properties[a],c=typeof u;"string"!==c&&"boolean"!==c&&"number"!==c&&(u=JSON.stringify(u));var h=c+":"+u,p=s[h];void 0===p&&(i.push(u),s[h]=p=i.length-1),e.writeVarint(p)}}function x(t,e){return(e<<3)+(7&t)}function w(t){return t<<1^t>>31}function E(t,e){for(var n=t.loadGeometry(),r=t.type,i=0,o=0,s=n.length,a=0;a<s;a++){var l=n[a],u=1;1===r&&(u=l.length),e.writeVarint(x(1,u));for(var c=3===r?l.length-1:l.length,h=0;h<c;h++){1===h&&1!==r&&e.writeVarint(x(2,c-1));var p=l[h].x-i,f=l[h].y-o;e.writeVarint(w(p)),e.writeVarint(w(f)),i+=p,o+=f}3===r&&e.writeVarint(x(7,1))}}function S(t,e){var n=typeof t;"string"===n?e.writeStringField(1,t):"boolean"===n?e.writeBooleanField(7,t):"number"===n&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}function T(t,e,n,r,i,o){if(i-r<=n)return;const s=r+i>>1;P(t,e,s,r,i,o%2),T(t,e,n,r,s-1,o+1),T(t,e,n,s+1,i,o+1)}function P(t,e,n,r,i,o){for(;i>r;){if(i-r>600){const s=i-r+1,a=n-r+1,l=Math.log(s),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(s-u)/s)*(a-s/2<0?-1:1);P(t,e,n,Math.max(r,Math.floor(n-a*u/s+c)),Math.min(i,Math.floor(n+(s-a)*u/s+c)),o)}const s=e[2*n+o];let a=r,l=i;for(M(t,e,r,n),e[2*i+o]>s&&M(t,e,r,i);a<l;){for(M(t,e,a,l),a++,l--;e[2*a+o]<s;)a++;for(;e[2*l+o]>s;)l--}e[2*r+o]===s?M(t,e,r,l):(l++,M(t,e,l,i)),l<=n&&(r=l+1),n<=l&&(i=l-1)}}function M(t,e,n,r){C(t,n,r),C(e,2*n,2*r),C(e,2*n+1,2*r+1)}function C(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function I(t,e,n,r){const i=t-n,o=e-r;return i*i+o*o}m.fromVectorTileJs=y,m.fromGeojsonVt=function(t,e){e=e||{};var n={};for(var r in t)n[r]=new f(t[r].features,e),n[r].name=r,n[r].version=e.version,n[r].extent=e.extent;return y({layers:n})},m.GeoJSONWrapper=A;const O=t=>t[0],R=t=>t[1];class L{constructor(t,e=O,n=R,r=64,i=Float64Array){this.nodeSize=r,this.points=t;const o=t.length<65536?Uint16Array:Uint32Array,s=this.ids=new o(t.length),a=this.coords=new i(2*t.length);for(let r=0;r<t.length;r++)s[r]=r,a[2*r]=e(t[r]),a[2*r+1]=n(t[r]);T(s,a,r,0,s.length-1,0)}range(t,e,n,r){return function(t,e,n,r,i,o,s){const a=[0,t.length-1,0],l=[];let u,c;for(;a.length;){const h=a.pop(),p=a.pop(),f=a.pop();if(p-f<=s){for(let s=f;s<=p;s++)u=e[2*s],c=e[2*s+1],u>=n&&u<=i&&c>=r&&c<=o&&l.push(t[s]);continue}const d=Math.floor((f+p)/2);u=e[2*d],c=e[2*d+1],u>=n&&u<=i&&c>=r&&c<=o&&l.push(t[d]);const g=(h+1)%2;(0===h?n<=u:r<=c)&&(a.push(f),a.push(d-1),a.push(g)),(0===h?i>=u:o>=c)&&(a.push(d+1),a.push(p),a.push(g))}return l}(this.ids,this.coords,t,e,n,r,this.nodeSize)}within(t,e,n){return function(t,e,n,r,i,o){const s=[0,t.length-1,0],a=[],l=i*i;for(;s.length;){const u=s.pop(),c=s.pop(),h=s.pop();if(c-h<=o){for(let i=h;i<=c;i++)I(e[2*i],e[2*i+1],n,r)<=l&&a.push(t[i]);continue}const p=Math.floor((h+c)/2),f=e[2*p],d=e[2*p+1];I(f,d,n,r)<=l&&a.push(t[p]);const g=(u+1)%2;(0===u?n-i<=f:r-i<=d)&&(s.push(h),s.push(p-1),s.push(g)),(0===u?n+i>=f:r+i>=d)&&(s.push(p+1),s.push(c),s.push(g))}return a}(this.ids,this.coords,t,e,n,this.nodeSize)}}const k={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},D=Math.fround||(N=new Float32Array(1),t=>(N[0]=+t,N[0]));var N;class F{constructor(t){this.options=q(Object.create(k),t),this.trees=new Array(this.options.maxZoom+1)}load(t){const{log:e,minZoom:n,maxZoom:r,nodeSize:i}=this.options;e&&console.time("total time");const o=`prepare ${t.length} points`;e&&console.time(o),this.points=t;let s=[];for(let e=0;e<t.length;e++)t[e].geometry&&s.push(z(t[e],e));this.trees[r+1]=new L(s,W,H,i,Float32Array),e&&console.timeEnd(o);for(let t=r;t>=n;t--){const n=+Date.now();s=this._cluster(s,t),this.trees[t]=new L(s,W,H,i,Float32Array),e&&console.log("z%d: %d clusters in %dms",t,s.length,+Date.now()-n)}return e&&console.timeEnd("total time"),this}getClusters(t,e){let n=((t[0]+180)%360+360)%360-180;const r=Math.max(-90,Math.min(90,t[1]));let i=180===t[2]?180:((t[2]+180)%360+360)%360-180;const o=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,i=180;else if(n>i){const t=this.getClusters([n,r,180,o],e),s=this.getClusters([-180,r,i,o],e);return t.concat(s)}const s=this.trees[this._limitZoom(e)],a=s.range(V(n),G(o),V(i),G(r)),l=[];for(const t of a){const e=s.points[t];l.push(e.numPoints?j(e):this.points[e.index])}return l}getChildren(t){const e=this._getOriginId(t),n=this._getOriginZoom(t),r="No cluster with the specified id.",i=this.trees[n];if(!i)throw new Error(r);const o=i.points[e];if(!o)throw new Error(r);const s=this.options.radius/(this.options.extent*Math.pow(2,n-1)),a=i.within(o.x,o.y,s),l=[];for(const e of a){const n=i.points[e];n.parentId===t&&l.push(n.numPoints?j(n):this.points[n.index])}if(0===l.length)throw new Error(r);return l}getLeaves(t,e,n){const r=[];return this._appendLeaves(r,t,e=e||10,n=n||0,0),r}getTile(t,e,n){const r=this.trees[this._limitZoom(t)],i=Math.pow(2,t),{extent:o,radius:s}=this.options,a=s/o,l=(n-a)/i,u=(n+1+a)/i,c={features:[]};return this._addTileFeatures(r.range((e-a)/i,l,(e+1+a)/i,u),r.points,e,n,i,c),0===e&&this._addTileFeatures(r.range(1-a/i,l,1,u),r.points,i,n,i,c),e===i-1&&this._addTileFeatures(r.range(0,l,a/i,u),r.points,-1,n,i,c),c.features.length?c:null}getClusterExpansionZoom(t){let e=this._getOriginZoom(t)-1;for(;e<=this.options.maxZoom;){const n=this.getChildren(t);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e}_appendLeaves(t,e,n,r,i){const o=this.getChildren(e);for(const e of o){const o=e.properties;if(o&&o.cluster?i+o.point_count<=r?i+=o.point_count:i=this._appendLeaves(t,o.cluster_id,n,r,i):i<r?i++:t.push(e),t.length===n)break}return i}_addTileFeatures(t,e,n,r,i,o){for(const s of t){const t=e[s],a=t.numPoints;let l,u,c;if(a)l=U(t),u=t.x,c=t.y;else{const e=this.points[t.index];l=e.properties,u=V(e.geometry.coordinates[0]),c=G(e.geometry.coordinates[1])}const h={type:1,geometry:[[Math.round(this.options.extent*(u*i-n)),Math.round(this.options.extent*(c*i-r))]],tags:l};let p;a?p=t.id:this.options.generateId?p=t.index:this.points[t.index].id&&(p=this.points[t.index].id),void 0!==p&&(h.id=p),o.features.push(h)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(+t,this.options.maxZoom+1))}_cluster(t,e){const n=[],{radius:r,extent:i,reduce:o,minPoints:s}=this.options,a=r/(i*Math.pow(2,e));for(let r=0;r<t.length;r++){const i=t[r];if(i.zoom<=e)continue;i.zoom=e;const l=this.trees[e+1],u=l.within(i.x,i.y,a),c=i.numPoints||1;let h=c;for(const t of u){const n=l.points[t];n.zoom>e&&(h+=n.numPoints||1)}if(h>=s){let t=i.x*c,s=i.y*c,a=o&&c>1?this._map(i,!0):null;const p=(r<<5)+(e+1)+this.points.length;for(const n of u){const r=l.points[n];if(r.zoom<=e)continue;r.zoom=e;const u=r.numPoints||1;t+=r.x*u,s+=r.y*u,r.parentId=p,o&&(a||(a=this._map(i,!0)),o(a,this._map(r)))}i.parentId=p,n.push(B(t/h,s/h,p,h,a))}else if(n.push(i),h>1)for(const t of u){const r=l.points[t];r.zoom<=e||(r.zoom=e,n.push(r))}}return n}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,e){if(t.numPoints)return e?q({},t.properties):t.properties;const n=this.points[t.index].properties,r=this.options.map(n);return e&&r===n?q({},r):r}}function B(t,e,n,r,i){return{x:D(t),y:D(e),zoom:1/0,id:n,parentId:-1,numPoints:r,properties:i}}function z(t,e){const[n,r]=t.geometry.coordinates;return{x:D(V(n)),y:D(G(r)),zoom:1/0,index:e,parentId:-1}}function j(t){return{type:"Feature",id:t.id,properties:U(t),geometry:{type:"Point",coordinates:[(e=t.x,360*(e-.5)),Z(t.y)]}};var e}function U(t){const e=t.numPoints,n=e>=1e4?`${Math.round(e/1e3)}k`:e>=1e3?Math.round(e/100)/10+"k":e;return q(q({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:n})}function V(t){return t/360+.5}function G(t){const e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function Z(t){const e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function q(t,e){for(const n in e)t[n]=e[n];return t}function W(t){return t.x}function H(t){return t.y}function X(t,e,n,r){for(var i,o=r,s=n-e>>1,a=n-e,l=t[e],u=t[e+1],c=t[n],h=t[n+1],p=e+3;p<n;p+=3){var f=$(t[p],t[p+1],l,u,c,h);if(f>o)i=p,o=f;else if(f===o){var d=Math.abs(p-s);d<a&&(i=p,a=d)}}o>r&&(i-e>3&&X(t,e,i,r),t[i+2]=o,n-i>3&&X(t,i,n,r))}function $(t,e,n,r,i,o){var s=i-n,a=o-r;if(0!==s||0!==a){var l=((t-n)*s+(e-r)*a)/(s*s+a*a);l>1?(n=i,r=o):l>0&&(n+=s*l,r+=a*l)}return(s=t-n)*s+(a=e-r)*a}function Y(t,e,n,r){var i={id:void 0===t?null:t,type:e,geometry:n,tags:r,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,n=t.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)Q(t,e);else if("Polygon"===n||"MultiLineString"===n)for(var r=0;r<e.length;r++)Q(t,e[r]);else if("MultiPolygon"===n)for(r=0;r<e.length;r++)for(var i=0;i<e[r].length;i++)Q(t,e[r][i])}(i),i}function Q(t,e){for(var n=0;n<e.length;n+=3)t.minX=Math.min(t.minX,e[n]),t.minY=Math.min(t.minY,e[n+1]),t.maxX=Math.max(t.maxX,e[n]),t.maxY=Math.max(t.maxY,e[n+1])}function K(t,e,n,r){if(e.geometry){var i=e.geometry.coordinates,o=e.geometry.type,s=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),a=[],l=e.id;if(n.promoteId?l=e.properties[n.promoteId]:n.generateId&&(l=r||0),"Point"===o)J(i,a);else if("MultiPoint"===o)for(var u=0;u<i.length;u++)J(i[u],a);else if("LineString"===o)tt(i,a,s,!1);else if("MultiLineString"===o){if(n.lineMetrics){for(u=0;u<i.length;u++)tt(i[u],a=[],s,!1),t.push(Y(l,"LineString",a,e.properties));return}et(i,a,s,!1)}else if("Polygon"===o)et(i,a,s,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"===o){for(u=0;u<e.geometry.geometries.length;u++)K(t,{id:l,geometry:e.geometry.geometries[u],properties:e.properties},n,r);return}throw new Error("Input data is not a valid GeoJSON object.")}for(u=0;u<i.length;u++){var c=[];et(i[u],c,s,!0),a.push(c)}}t.push(Y(l,o,a,e.properties))}}function J(t,e){e.push(nt(t[0])),e.push(rt(t[1])),e.push(0)}function tt(t,e,n,r){for(var i,o,s=0,a=0;a<t.length;a++){var l=nt(t[a][0]),u=rt(t[a][1]);e.push(l),e.push(u),e.push(0),a>0&&(s+=r?(i*u-l*o)/2:Math.sqrt(Math.pow(l-i,2)+Math.pow(u-o,2))),i=l,o=u}var c=e.length-3;e[2]=1,X(e,0,c,n),e[c+2]=1,e.size=Math.abs(s),e.start=0,e.end=e.size}function et(t,e,n,r){for(var i=0;i<t.length;i++){var o=[];tt(t[i],o,n,r),e.push(o)}}function nt(t){return t/360+.5}function rt(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function it(t,e,n,r,i,o,s,a){if(r/=e,o>=(n/=e)&&s<r)return t;if(s<n||o>=r)return null;for(var l=[],u=0;u<t.length;u++){var c=t[u],h=c.geometry,p=c.type,f=0===i?c.minX:c.minY,d=0===i?c.maxX:c.maxY;if(f>=n&&d<r)l.push(c);else if(!(d<n||f>=r)){var g=[];if("Point"===p||"MultiPoint"===p)ot(h,g,n,r,i);else if("LineString"===p)st(h,g,n,r,i,!1,a.lineMetrics);else if("MultiLineString"===p)lt(h,g,n,r,i,!1);else if("Polygon"===p)lt(h,g,n,r,i,!0);else if("MultiPolygon"===p)for(var m=0;m<h.length;m++){var A=[];lt(h[m],A,n,r,i,!0),A.length&&g.push(A)}if(g.length){if(a.lineMetrics&&"LineString"===p){for(m=0;m<g.length;m++)l.push(Y(c.id,p,g[m],c.tags));continue}"LineString"!==p&&"MultiLineString"!==p||(1===g.length?(p="LineString",g=g[0]):p="MultiLineString"),"Point"!==p&&"MultiPoint"!==p||(p=3===g.length?"Point":"MultiPoint"),l.push(Y(c.id,p,g,c.tags))}}}return l.length?l:null}function ot(t,e,n,r,i){for(var o=0;o<t.length;o+=3){var s=t[o+i];s>=n&&s<=r&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}function st(t,e,n,r,i,o,s){for(var a,l,u=at(t),c=0===i?ct:ht,h=t.start,p=0;p<t.length-3;p+=3){var f=t[p],d=t[p+1],g=t[p+2],m=t[p+3],A=t[p+4],y=0===i?f:d,_=0===i?m:A,v=!1;s&&(a=Math.sqrt(Math.pow(f-m,2)+Math.pow(d-A,2))),y<n?_>n&&(l=c(u,f,d,m,A,n),s&&(u.start=h+a*l)):y>r?_<r&&(l=c(u,f,d,m,A,r),s&&(u.start=h+a*l)):ut(u,f,d,g),_<n&&y>=n&&(l=c(u,f,d,m,A,n),v=!0),_>r&&y<=r&&(l=c(u,f,d,m,A,r),v=!0),!o&&v&&(s&&(u.end=h+a*l),e.push(u),u=at(t)),s&&(h+=a)}var b=t.length-3;f=t[b],d=t[b+1],g=t[b+2],(y=0===i?f:d)>=n&&y<=r&&ut(u,f,d,g),b=u.length-3,o&&b>=3&&(u[b]!==u[0]||u[b+1]!==u[1])&&ut(u,u[0],u[1],u[2]),u.length&&e.push(u)}function at(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function lt(t,e,n,r,i,o){for(var s=0;s<t.length;s++)st(t[s],e,n,r,i,o,!1)}function ut(t,e,n,r){t.push(e),t.push(n),t.push(r)}function ct(t,e,n,r,i,o){var s=(o-e)/(r-e);return t.push(o),t.push(n+(i-n)*s),t.push(1),s}function ht(t,e,n,r,i,o){var s=(o-n)/(i-n);return t.push(e+(r-e)*s),t.push(o),t.push(1),s}function pt(t,e){for(var n=[],r=0;r<t.length;r++){var i,o=t[r],s=o.type;if("Point"===s||"MultiPoint"===s||"LineString"===s)i=ft(o.geometry,e);else if("MultiLineString"===s||"Polygon"===s){i=[];for(var a=0;a<o.geometry.length;a++)i.push(ft(o.geometry[a],e))}else if("MultiPolygon"===s)for(i=[],a=0;a<o.geometry.length;a++){for(var l=[],u=0;u<o.geometry[a].length;u++)l.push(ft(o.geometry[a][u],e));i.push(l)}n.push(Y(o.id,s,i,o.tags))}return n}function ft(t,e){var n=[];n.size=t.size,void 0!==t.start&&(n.start=t.start,n.end=t.end);for(var r=0;r<t.length;r+=3)n.push(t[r]+e,t[r+1],t[r+2]);return n}function dt(t,e){if(t.transformed)return t;var n,r,i,o=1<<t.z,s=t.x,a=t.y;for(n=0;n<t.features.length;n++){var l=t.features[n],u=l.geometry,c=l.type;if(l.geometry=[],1===c)for(r=0;r<u.length;r+=2)l.geometry.push(gt(u[r],u[r+1],e,o,s,a));else for(r=0;r<u.length;r++){var h=[];for(i=0;i<u[r].length;i+=2)h.push(gt(u[r][i],u[r][i+1],e,o,s,a));l.geometry.push(h)}}return t.transformed=!0,t}function gt(t,e,n,r,i,o){return[Math.round(n*(t*r-i)),Math.round(n*(e*r-o))]}function mt(t,e,n,r,i){for(var o=e===i.maxZoom?0:i.tolerance/((1<<e)*i.extent),s={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:r,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},a=0;a<t.length;a++){s.numFeatures++,At(s,t[a],o,i);var l=t[a].minX,u=t[a].minY,c=t[a].maxX,h=t[a].maxY;l<s.minX&&(s.minX=l),u<s.minY&&(s.minY=u),c>s.maxX&&(s.maxX=c),h>s.maxY&&(s.maxY=h)}return s}function At(t,e,n,r){var i=e.geometry,o=e.type,s=[];if("Point"===o||"MultiPoint"===o)for(var a=0;a<i.length;a+=3)s.push(i[a]),s.push(i[a+1]),t.numPoints++,t.numSimplified++;else if("LineString"===o)yt(s,i,t,n,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(a=0;a<i.length;a++)yt(s,i[a],t,n,"Polygon"===o,0===a);else if("MultiPolygon"===o)for(var l=0;l<i.length;l++){var u=i[l];for(a=0;a<u.length;a++)yt(s,u[a],t,n,!0,0===a)}if(s.length){var c=e.tags||null;if("LineString"===o&&r.lineMetrics){for(var h in c={},e.tags)c[h]=e.tags[h];c.mapbox_clip_start=i.start/i.size,c.mapbox_clip_end=i.end/i.size}var p={geometry:s,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:c};null!==e.id&&(p.id=e.id),t.features.push(p)}}function yt(t,e,n,r,i,o){var s=r*r;if(r>0&&e.size<(i?s:r))n.numPoints+=e.length/3;else{for(var a=[],l=0;l<e.length;l+=3)(0===r||e[l+2]>s)&&(n.numSimplified++,a.push(e[l]),a.push(e[l+1])),n.numPoints++;i&&function(t,e){for(var n=0,r=0,i=t.length,o=i-2;r<i;o=r,r+=2)n+=(t[r]-t[o])*(t[r+1]+t[o+1]);if(n>0===e)for(r=0,i=t.length;r<i/2;r+=2){var s=t[r],a=t[r+1];t[r]=t[i-2-r],t[r+1]=t[i-1-r],t[i-2-r]=s,t[i-1-r]=a}}(a,o),t.push(a)}}function _t(t,e){var n=(e=this.options=function(t,e){for(var n in e)t[n]=e[n];return t}(Object.create(this.options),e)).debug;if(n&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var r=function(t,e){var n=[];if("FeatureCollection"===t.type)for(var r=0;r<t.features.length;r++)K(n,t.features[r],e,r);else K(n,"Feature"===t.type?t:{geometry:t},e);return n}(t,e);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(r=function(t,e){var n=e.buffer/e.extent,r=t,i=it(t,1,-1-n,n,0,-1,2,e),o=it(t,1,1-n,2+n,0,-1,2,e);return(i||o)&&(r=it(t,1,-n,1+n,0,-1,2,e)||[],i&&(r=pt(i,1).concat(r)),o&&(r=r.concat(pt(o,-1)))),r}(r,e)).length&&this.splitTile(r,0,0,0),n&&(r.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function vt(t,e,n){return 32*((1<<t)*n+e)+t}function bt(t,e){const n=t.tileID.canonical;if(!this._geoJSONIndex)return e(null,null);const r=this._geoJSONIndex.getTile(n.z,n.x,n.y);if(!r)return e(null,null);const i=new h(r.features);let o=m(i);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),e(null,{vectorTile:i,rawData:o.buffer})}_t.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},_t.prototype.splitTile=function(t,e,n,r,i,o,s){for(var a=[t,e,n,r],l=this.options,u=l.debug;a.length;){r=a.pop(),n=a.pop(),e=a.pop(),t=a.pop();var c=1<<e,h=vt(e,n,r),p=this.tiles[h];if(!p&&(u>1&&console.time("creation"),p=this.tiles[h]=mt(t,e,n,r,l),this.tileCoords.push({z:e,x:n,y:r}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,n,r,p.numFeatures,p.numPoints,p.numSimplified),console.timeEnd("creation"));var f="z"+e;this.stats[f]=(this.stats[f]||0)+1,this.total++}if(p.source=t,i){if(e===l.maxZoom||e===i)continue;var d=1<<i-e;if(n!==Math.floor(o/d)||r!==Math.floor(s/d))continue}else if(e===l.indexMaxZoom||p.numPoints<=l.indexMaxPoints)continue;if(p.source=null,0!==t.length){u>1&&console.time("clipping");var g,m,A,y,_,v,b=.5*l.buffer/l.extent,x=.5-b,w=.5+b,E=1+b;g=m=A=y=null,_=it(t,c,n-b,n+w,0,p.minX,p.maxX,l),v=it(t,c,n+x,n+E,0,p.minX,p.maxX,l),t=null,_&&(g=it(_,c,r-b,r+w,1,p.minY,p.maxY,l),m=it(_,c,r+x,r+E,1,p.minY,p.maxY,l),_=null),v&&(A=it(v,c,r-b,r+w,1,p.minY,p.maxY,l),y=it(v,c,r+x,r+E,1,p.minY,p.maxY,l),v=null),u>1&&console.timeEnd("clipping"),a.push(g||[],e+1,2*n,2*r),a.push(m||[],e+1,2*n,2*r+1),a.push(A||[],e+1,2*n+1,2*r),a.push(y||[],e+1,2*n+1,2*r+1)}}},_t.prototype.getTile=function(t,e,n){var r=this.options,i=r.extent,o=r.debug;if(t<0||t>24)return null;var s=1<<t,a=vt(t,e=(e%s+s)%s,n);if(this.tiles[a])return dt(this.tiles[a],i);o>1&&console.log("drilling down to z%d-%d-%d",t,e,n);for(var l,u=t,c=e,h=n;!l&&u>0;)u--,c=Math.floor(c/2),h=Math.floor(h/2),l=this.tiles[vt(u,c,h)];return l&&l.source?(o>1&&console.log("found parent tile z%d-%d-%d",u,c,h),o>1&&console.time("drilling down"),this.splitTile(l.source,u,c,h,t,e,n),o>1&&console.timeEnd("drilling down"),this.tiles[a]?dt(this.tiles[a],i):null):null};class xt extends t.VectorTileWorkerSource{constructor(t,e,n,r,i){super(t,e,n,r,bt),i&&(this.loadGeoJSON=i)}loadData(e,n){const r=e&&e.request,i=r&&r.collectResourceTiming;this.loadGeoJSON(e,((o,a)=>{if(o||!a)return n(o);if("object"!=typeof a)return n(new Error(`Input data given to '${e.source}' is not a valid GeoJSON object.`));{s(a,!0);try{if(e.filter){const n=t.createExpression(e.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===n.result)throw new Error(n.value.map((t=>`${t.key}: ${t.message}`)).join(", "));const r=a.features.filter((t=>n.value.evaluate({zoom:0},t)));a={type:"FeatureCollection",features:r}}this._geoJSONIndex=e.cluster?new F(function({superclusterOptions:e,clusterProperties:n}){if(!n||!e)return e;const r={},i={},o={accumulated:null,zoom:0},s={properties:null},a=Object.keys(n);for(const e of a){const[o,s]=n[e],a=t.createExpression(s),l=t.createExpression("string"==typeof o?[o,["accumulated"],["get",e]]:o);r[e]=a.value,i[e]=l.value}return e.map=t=>{s.properties=t;const e={};for(const t of a)e[t]=r[t].evaluate(o,s);return e},e.reduce=(t,e)=>{s.properties=e;for(const e of a)o.accumulated=t[e],t[e]=i[e].evaluate(o,s)},e}(e)).load(a.features):function(t,e){return new _t(t,e)}(a,e.geojsonVtOptions)}catch(o){return n(o)}this.loaded={};const l={};if(i){const n=t.getPerformanceMeasurement(r);n&&(l.resourceTiming={},l.resourceTiming[e.source]=JSON.parse(JSON.stringify(n)))}n(null,l)}}))}reloadTile(t,e){const n=this.loaded;return n&&n[t.uid]?super.reloadTile(t,e):this.loadTile(t,e)}loadGeoJSON(e,n){if(e.request)t.getJSON(e.request,n);else{if("string"!=typeof e.data)return n(new Error(`Input data given to '${e.source}' is not a valid GeoJSON object.`));try{return n(null,JSON.parse(e.data))}catch(t){return n(new Error(`Input data given to '${e.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(t,e){try{e(null,this._geoJSONIndex.getClusterExpansionZoom(t.clusterId))}catch(t){e(t)}}getClusterChildren(t,e){try{e(null,this._geoJSONIndex.getChildren(t.clusterId))}catch(t){e(t)}}getClusterLeaves(t,e){try{e(null,this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset))}catch(t){e(t)}}}class wt{constructor(e){this.self=e,this.actor=new t.Actor(e,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded=!1,this.workerSourceTypes={vector:t.VectorTileWorkerSource,geojson:xt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(t,e)=>{if(this.workerSourceTypes[t])throw new Error(`Worker source with name "${t}" already registered.`);this.workerSourceTypes[t]=e},this.self.registerRTLTextPlugin=e=>{if(t.plugin.isParsed())throw new Error("RTL text plugin already registered.");t.plugin.applyArabicShaping=e.applyArabicShaping,t.plugin.processBidirectionalText=e.processBidirectionalText,t.plugin.processStyledBidirectionalText=e.processStyledBidirectionalText}}checkIfReady(t,e,n){n()}setReferrer(t,e){this.referrer=e}spriteLoaded(e,n){this.isSpriteLoaded=n;for(const r in this.workerSources[e]){const i=this.workerSources[e][r];for(const e in i)i[e]instanceof t.VectorTileWorkerSource&&(i[e].isSpriteLoaded=n,i[e].fire(new t.Event("isSpriteLoaded")))}}setImages(t,e,n){this.availableImages[t]=e;for(const n in this.workerSources[t]){const r=this.workerSources[t][n];for(const t in r)r[t].availableImages=e}n()}enableTerrain(t,e,n){this.terrain=e,n()}setLayers(t,e,n){this.getLayerIndex(t).replace(e),n()}updateLayers(t,e,n){this.getLayerIndex(t).update(e.layers,e.removedIds),n()}loadTile(e,n,r){const i=this.enableTerrain?t.extend({enableTerrain:this.terrain},n):n;this.getWorkerSource(e,n.type,n.source).loadTile(i,r)}loadDEMTile(e,n,r){const i=this.enableTerrain?t.extend({buildQuadTree:this.terrain},n):n;this.getDEMWorkerSource(e,n.source).loadTile(i,r)}reloadTile(e,n,r){const i=this.enableTerrain?t.extend({enableTerrain:this.terrain},n):n;this.getWorkerSource(e,n.type,n.source).reloadTile(i,r)}abortTile(t,e,n){this.getWorkerSource(t,e.type,e.source).abortTile(e,n)}removeTile(t,e,n){this.getWorkerSource(t,e.type,e.source).removeTile(e,n)}removeSource(t,e,n){if(!this.workerSources[t]||!this.workerSources[t][e.type]||!this.workerSources[t][e.type][e.source])return;const r=this.workerSources[t][e.type][e.source];delete this.workerSources[t][e.type][e.source],void 0!==r.removeSource?r.removeSource(e,n):n()}loadWorkerSource(t,e,n){try{this.self.importScripts(e.url),n()}catch(t){n(t.toString())}}syncRTLPluginState(e,n,r){try{t.plugin.setState(n);const e=t.plugin.getPluginURL();if(t.plugin.isLoaded()&&!t.plugin.isParsed()&&null!=e){this.self.importScripts(e);const n=t.plugin.isParsed();r(n?void 0:new Error(`RTL Text Plugin failed to import scripts from ${e}`),n)}}catch(t){r(t.toString())}}getAvailableImages(t){let e=this.availableImages[t];return e||(e=[]),e}getLayerIndex(t){let e=this.layerIndexes[t];return e||(e=this.layerIndexes[t]=new r),e}getWorkerSource(t,e,n){return this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][e]||(this.workerSources[t][e]={}),this.workerSources[t][e][n]||(this.workerSources[t][e][n]=new this.workerSourceTypes[e]({send:(e,n,r,i,o,s)=>{this.actor.send(e,n,r,t,o,s)},scheduler:this.actor.scheduler},this.getLayerIndex(t),this.getAvailableImages(t),this.isSpriteLoaded)),this.workerSources[t][e][n]}getDEMWorkerSource(t,e){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][e]||(this.demWorkerSources[t][e]=new o),this.demWorkerSources[t][e]}enforceCacheSizeLimit(e,n){t.enforceCacheSizeLimit(n)}getWorkerPerformanceMetrics(t,e,n){n(void 0,void 0)}}return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new wt(self)),wt})),r(0,(function(t){var e=n;function n(t){return!function(t){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var t,e,n=new Blob([""],{type:"text/javascript"}),r=URL.createObjectURL(n);try{e=new Worker(r),t=!0}catch(e){t=!1}return e&&e.terminate(),URL.revokeObjectURL(r),t}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var t=document.createElement("canvas");t.width=t.height=1;var e=t.getContext("2d");if(!e)return!1;var n=e.getImageData(0,0,1,1);return n&&n.width===t.width}()?(void 0===r[e=t&&t.failIfMajorPerformanceCaveat]&&(r[e]=function(t){var e,r=function(t){var e=document.createElement("canvas"),r=Object.create(n.webGLContextAttributes);return r.failIfMajorPerformanceCaveat=t,e.getContext("webgl",r)||e.getContext("experimental-webgl",r)}(t);if(!r)return!1;try{e=r.createShader(r.VERTEX_SHADER)}catch(t){return!1}return!(!e||r.isContextLost())&&(r.shaderSource(e,"void main() {}"),r.compileShader(e),!0===r.getShaderParameter(e,r.COMPILE_STATUS))}(e)),r[e]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var e}(t)}var r={};function i(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!i(t[n],e[n]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==e){if("object"!=typeof e)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!i(t[n],e[n]))return!1;return!0}return t===e}n.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const o={create:function(e,n,r){const i=t.window.document.createElement(e);return void 0!==n&&(i.className=n),r&&r.appendChild(i),i},createNS:function(e,n){return t.window.document.createElementNS(e,n)}},s=t.window.document&&t.window.document.documentElement.style,a=s&&void 0!==s.userSelect?"userSelect":"WebkitUserSelect";let l;o.disableDrag=function(){s&&a&&(l=s[a],s[a]="none")},o.enableDrag=function(){s&&a&&(s[a]=l)},o.setTransform=function(t,e){t.style.transform=e};let u=!1;try{const e=Object.defineProperty({},"passive",{get(){u=!0}});t.window.addEventListener("test",e,e),t.window.removeEventListener("test",e,e)}catch(t){u=!1}o.addEventListener=function(t,e,n,r={}){t.addEventListener(e,n,"passive"in r&&u?r:r.capture)},o.removeEventListener=function(t,e,n,r={}){t.removeEventListener(e,n,"passive"in r&&u?r:r.capture)};const c=function(e){e.preventDefault(),e.stopPropagation(),t.window.removeEventListener("click",c,!0)};function h(e,n,r){const i=e.offsetWidth===n.width?1:e.offsetWidth/n.width;return new t.pointGeometry((r.clientX-n.left)*i,(r.clientY-n.top)*i)}o.suppressClick=function(){t.window.addEventListener("click",c,!0),t.window.setTimeout((()=>{t.window.removeEventListener("click",c,!0)}),0)},o.mousePos=function(t,e){const n=t.getBoundingClientRect();return h(t,n,e)},o.touchPos=function(t,e){const n=t.getBoundingClientRect(),r=[];for(let i=0;i<e.length;i++)r.push(h(t,n,e[i]));return r},o.mouseButton=function(e){return void 0!==t.window.InstallTrigger&&2===e.button&&e.ctrlKey&&t.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:e.button},o.remove=function(t){t.parentNode&&t.parentNode.removeChild(t)};class p{constructor(t,e){this.pos=t,this.dir=e}intersectsPlane(e,n,r){const i=t.dot(n,this.dir);if(Math.abs(i)<1e-6)return!1;const o=t.dot(t.sub(t.create(),e,this.pos),n)/i,s=t.scaleAndAdd(t.create(),this.pos,this.dir,o);return t.copy(r,s),!0}}class f{constructor(t,e){this.points=t,this.planes=e}static fromInvProjectionMatrix(e,n,r){const i=Math.pow(2,r),o=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((r=>{const o=t.transformMat4([],r,e),s=1/o[3]/n*i;return t.mul(o,o,[s,s,1/o[3],s])})),s=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((e=>{const n=t.sub([],o[e[0]],o[e[1]]),r=t.sub([],o[e[2]],o[e[1]]),i=t.normalize([],t.cross([],n,r)),s=-t.dot(i,o[e[1]]);return i.concat(s)}));return new f(o,s)}}class d{constructor(e,n){this.min=e,this.max=n,this.center=t.scale([],t.add([],this.min,this.max),.5)}quadrant(e){const n=[e%2==0,e<2],r=t.clone(this.min),i=t.clone(this.max);for(let t=0;t<n.length;t++)r[t]=n[t]?this.min[t]:this.center[t],i[t]=n[t]?this.center[t]:this.max[t];return i[2]=this.max[2],new d(r,i)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}intersects(e){const n=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let r=!0;for(let i=0;i<e.planes.length;i++){const o=e.planes[i];let s=0;for(let e=0;e<n.length;e++)s+=t.dot$1(o,n[e])>=0;if(0===s)return 0;s!==n.length&&(r=!1)}if(r)return 2;for(let t=0;t<3;t++){let n=Number.MAX_VALUE,r=-Number.MAX_VALUE;for(let i=0;i<e.points.length;i++){const o=e.points[i][t]-this.min[t];n=Math.min(n,o),r=Math.max(r,o)}if(r<0||n>this.max[t]-this.min[t])return 0}return 1}}function g(t){const{userImage:e}=t;return!!(e&&e.render&&e.render())&&(t.data.replace(new Uint8Array(e.data.buffer)),!0)}class m extends t.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:t,callback:e}of this.requestors)this._notify(t,e);this.requestors=[]}}getImage(t){return this.images[t]}addImage(t,e){this._validate(t,e)&&(this.images[t]=e)}_validate(e,n){let r=!0;return this._validateStretch(n.stretchX,n.data&&n.data.width)||(this.fire(new t.ErrorEvent(new Error(`Image "${e}" has invalid "stretchX" value`))),r=!1),this._validateStretch(n.stretchY,n.data&&n.data.height)||(this.fire(new t.ErrorEvent(new Error(`Image "${e}" has invalid "stretchY" value`))),r=!1),this._validateContent(n.content,n)||(this.fire(new t.ErrorEvent(new Error(`Image "${e}" has invalid "content" value`))),r=!1),r}_validateStretch(t,e){if(!t)return!0;let n=0;for(const r of t){if(r[0]<n||r[1]<r[0]||e<r[1])return!1;n=r[1]}return!0}_validateContent(t,e){return!(t&&(4!==t.length||t[0]<0||e.data.width<t[0]||t[1]<0||e.data.height<t[1]||t[2]<0||e.data.width<t[2]||t[3]<0||e.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))}updateImage(t,e){e.version=this.images[t].version+1,this.images[t]=e,this.updatedImages[t]=!0}removeImage(t){const e=this.images[t];delete this.images[t],delete this.patterns[t],e.userImage&&e.userImage.onRemove&&e.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t,e){let n=!0;if(!this.isLoaded())for(const e of t)this.images[e]||(n=!1);this.isLoaded()||n?this._notify(t,e):this.requestors.push({ids:t,callback:e})}_notify(e,n){const r={};for(const n of e){this.images[n]||this.fire(new t.Event("styleimagemissing",{id:n}));const e=this.images[n];e?r[n]={data:e.data.clone(),pixelRatio:e.pixelRatio,sdf:e.sdf,version:e.version,stretchX:e.stretchX,stretchY:e.stretchY,content:e.content,hasRenderCallback:Boolean(e.userImage&&e.userImage.render)}:t.warnOnce(`Image "${n}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}n(null,r)}getPixelSize(){const{width:t,height:e}=this.atlasImage;return{width:t,height:e}}getPattern(e){const n=this.patterns[e],r=this.getImage(e);if(!r)return null;if(n&&n.position.version===r.version)return n.position;if(n)n.position.version=r.version;else{const n={w:r.data.width+2,h:r.data.height+2,x:0,y:0},i=new t.ImagePosition(n,r);this.patterns[e]={bin:n,position:i}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const n=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new t.Texture(e,this.atlasImage,n.RGBA),this.atlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const t in this.patterns)e.push(this.patterns[t].bin);const{w:n,h:r}=t.potpack(e),i=this.atlasImage;i.resize({width:n||1,height:r||1});for(const e in this.patterns){const{bin:n}=this.patterns[e],r=n.x+1,o=n.y+1,s=this.images[e].data,a=s.width,l=s.height;t.RGBAImage.copy(s,i,{x:0,y:0},{x:r,y:o},{width:a,height:l}),t.RGBAImage.copy(s,i,{x:0,y:l-1},{x:r,y:o-1},{width:a,height:1}),t.RGBAImage.copy(s,i,{x:0,y:0},{x:r,y:o+l},{width:a,height:1}),t.RGBAImage.copy(s,i,{x:a-1,y:0},{x:r-1,y:o},{width:1,height:l}),t.RGBAImage.copy(s,i,{x:0,y:0},{x:r+a,y:o},{width:1,height:l})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const e of t){if(this.callbackDispatchedThisFrame[e])continue;this.callbackDispatchedThisFrame[e]=!0;const t=this.images[e];g(t)&&this.updateImage(e,t)}}}const A=new t.Properties({anchor:new t.DataConstantProperty(t.spec.light.anchor),position:new class{constructor(){this.specification=t.spec.light.position}possiblyEvaluate(e,n){return function([e,n,r]){const i=t.degToRad(n+90),o=t.degToRad(r);return{x:e*Math.cos(i)*Math.sin(o),y:e*Math.sin(i)*Math.sin(o),z:e*Math.cos(o),azimuthal:n,polar:r}}(e.expression.evaluate(n))}interpolate(e,n,r){return{x:t.number(e.x,n.x,r),y:t.number(e.y,n.y,r),z:t.number(e.z,n.z,r),azimuthal:t.number(e.azimuthal,n.azimuthal,r),polar:t.number(e.polar,n.polar,r)}}},color:new t.DataConstantProperty(t.spec.light.color),intensity:new t.DataConstantProperty(t.spec.light.intensity)}),y="-transition";class _ extends t.Evented{constructor(e){super(),this._transitionable=new t.Transitionable(A),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,n={}){if(!this._validate(t.validateLight,e,n))for(const n in e){const r=e[n];t.endsWith(n,y)?this._transitionable.setTransition(n.slice(0,-y.length),r):this._transitionable.setValue(n,r)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(e,n,r){return(!r||!1!==r.validate)&&t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:n,style:{glyphs:!0,sprite:!0},styleSpec:t.spec})))}}const v=new t.Properties({source:new t.DataConstantProperty(t.spec.terrain.source),exaggeration:new t.DataConstantProperty(t.spec.terrain.exaggeration)}),b="-transition";class x extends t.Evented{constructor(e){super(),this._transitionable=new t.Transitionable(v),this.set(e),this._transitioning=this._transitionable.untransitioned()}get(){return this._transitionable.serialize()}set(e){for(const n in e){const r=e[n];t.endsWith(n,b)?this._transitionable.setTransition(n.slice(0,-b.length),r):this._transitionable.setValue(n,r)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}}function w(e,n,r,i){const o=t.smoothstep(45,65,r),[s,a]=E(e,i),l=t.length(n);let u=1-Math.min(1,Math.exp((l-s)/(a-s)*-6));return u*=u*u,u=Math.min(1,1.00747*u),u*o*e.alpha}function E(t,e){const n=.5/Math.tan(.5*e);return[t.range[0]+n,t.range[1]+n]}const S=new t.Properties({range:new t.DataConstantProperty(t.spec.fog.range),color:new t.DataConstantProperty(t.spec.fog.color),"horizon-blend":new t.DataConstantProperty(t.spec.fog["horizon-blend"])}),T="-transition";class P extends t.Evented{constructor(e){super(),this._transitionable=new t.Transitionable(S),this.set(e),this._transitioning=this._transitionable.untransitioned()}get state(){return{range:this.properties.get("range"),horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(e,n={}){if(!this._validate(t.validateFog,e,n))for(const n in e){const r=e[n];t.endsWith(n,T)?this._transitionable.setTransition(n.slice(0,-T.length),r):this._transitionable.setValue(n,r)}}getOpacity(e){const n=this.properties&&this.properties.get("color")||1;return t.smoothstep(45,65,e)*n.a}getOpacityAtLatLng(e,n){return function(e,n,r){const i=t.MercatorCoordinate.fromLngLat(n),o=r.elevation?r.elevation.getAtPointOrZero(i):0,s=[i.x,i.y,o];return t.transformMat4$1(s,s,r.mercatorFogMatrix),w(e,s,r.pitch,r._fov)}(this.state,e,n)}getFovAdjustedRange(t){return E(this.state,t)}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(e,n,r){return(!r||!1!==r.validate)&&t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:n,style:{glyphs:!0,sprite:!0},styleSpec:t.spec})))}}class M{constructor(e,n){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=t.uniqueId();const r=this.workerPool.acquire(this.id);for(let t=0;t<r.length;t++){const e=new M.Actor(r[t],n,this.id);e.name=`Worker ${t}`,this.actors.push(e)}this.ready=!1,this.broadcast("checkIfReady",null,(()=>{this.ready=!0}))}broadcast(e,n,r){t.asyncAll(this.actors,((t,r)=>{t.send(e,n,r)}),r=r||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach((t=>{t.remove()})),this.actors=[],this.workerPool.release(this.id)}}function C(e,n,r){return n*(t.EXTENT/(e.tileSize*Math.pow(2,r-e.tileID.overscaledZ)))}M.Actor=t.Actor;class I{constructor(t,e,n,r){this.screenBounds=t,this.cameraPoint=e,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=n,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this.screenGeometry.map((t=>r.pointCoordinate3D(t))),this.cameraGeometry=this.bufferedCameraGeometry(0)}static createFromScreenPoints(e,n){let r,i;if(e instanceof t.pointGeometry||"number"==typeof e[0]){const o=t.pointGeometry.convert(e);r=[t.pointGeometry.convert(e)],i=n.isPointAboveHorizon(o)}else{const o=t.pointGeometry.convert(e[0]),s=t.pointGeometry.convert(e[1]);r=[o,s],i=t.polygonizeBounds(o,s).every((t=>n.isPointAboveHorizon(t)))}return new I(r,n.getCameraPoint(),i,n)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(e){return t.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],e)}bufferedCameraGeometry(e){const n=this.screenBounds[0],r=1===this.screenBounds.length?this.screenBounds[0].add(new t.pointGeometry(1,1)):this.screenBounds[1],i=t.polygonizeBounds(n,r,0,!1);return this.cameraPoint.y>r.y&&(this.cameraPoint.x>n.x&&this.cameraPoint.x<r.x?i.splice(3,0,this.cameraPoint):this.cameraPoint.x>=r.x?i[2]=this.cameraPoint:this.cameraPoint.x<=n.x&&(i[3]=this.cameraPoint)),t.bufferConvexPolygon(i,e)}containsTile(e,n,r){const i=e.queryPadding+1,o=r?this._bufferedCameraMercator(i,n).map((t=>e.tileID.getTilePoint(t))):this._bufferedScreenMercator(i,n).map((t=>e.tileID.getTilePoint(t))),s=this.screenGeometryMercator.map((t=>e.tileID.getTileVec3(t))),a=s.map((e=>new t.pointGeometry(e[0],e[1]))),l=n.getFreeCameraOptions().position||new t.MercatorCoordinate(0,0,0),u=e.tileID.getTileVec3(l),c=s.map((e=>{const n=t.sub(e,e,u);return t.normalize(n,n),new p(u,n)})),h=C(e,1,n.zoom);if(t.polygonIntersectsBox(o,0,0,t.EXTENT,t.EXTENT))return{queryGeometry:this,tilespaceGeometry:a,tilespaceRays:c,bufferedTilespaceGeometry:o,bufferedTilespaceBounds:(f=t.getBounds(o),f.min.x=t.clamp(f.min.x,0,t.EXTENT),f.min.y=t.clamp(f.min.y,0,t.EXTENT),f.max.x=t.clamp(f.max.x,0,t.EXTENT),f.max.y=t.clamp(f.max.y,0,t.EXTENT),f),tile:e,tileID:e.tileID,pixelToTileUnitsFactor:h};var f}_bufferedScreenMercator(t,e){const n=O(t);if(this._screenRaycastCache[n])return this._screenRaycastCache[n];{const r=this.bufferedScreenGeometry(t).map((t=>e.pointCoordinate3D(t)));return this._screenRaycastCache[n]=r,r}}_bufferedCameraMercator(t,e){const n=O(t);if(this._cameraRaycastCache[n])return this._cameraRaycastCache[n];{const r=this.bufferedCameraGeometry(t).map((t=>e.pointCoordinate3D(t)));return this._cameraRaycastCache[n]=r,r}}}function O(t){return 100*t|0}function R(e,n,r){const i=function(i,o){if(i)return r(i);if(o){const i=t.pick(t.extend(o,e),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);o.vector_layers&&(i.vectorLayers=o.vector_layers,i.vectorLayerIds=i.vectorLayers.map((t=>t.id))),i.tiles=n.canonicalizeTileset(i,e.url),r(null,i)}};return e.url?t.getJSON(n.transformRequest(n.normalizeSourceURL(e.url),t.ResourceType.Source),i):t.exported.frame((()=>i(null,e)))}class L{constructor(e,n,r){this.bounds=t.LngLatBounds.convert(this.validateBounds(e)),this.minzoom=n||0,this.maxzoom=r||24}validateBounds(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(e){const n=Math.pow(2,e.z),r=Math.floor(t.mercatorXfromLng(this.bounds.getWest())*n),i=Math.floor(t.mercatorYfromLat(this.bounds.getNorth())*n),o=Math.ceil(t.mercatorXfromLng(this.bounds.getEast())*n),s=Math.ceil(t.mercatorYfromLat(this.bounds.getSouth())*n);return e.x>=r&&e.x<o&&e.y>=i&&e.y<s}}class k{constructor(t,e,n){this.context=t;const r=t.gl;this.buffer=r.createBuffer(),this.dynamicDraw=Boolean(n),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const e=this.context.gl;this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const D={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class N{constructor(t,e,n,r){this.length=e.length,this.attributes=n,this.itemSize=e.bytesPerElement,this.dynamicDraw=r,this.context=t;const i=t.gl;this.buffer=i.createBuffer(),t.bindVertexBuffer.set(this.buffer),i.bufferData(i.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){const e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,e){for(let n=0;n<this.attributes.length;n++){const r=e.attributes[this.attributes[n].name];void 0!==r&&t.enableVertexAttribArray(r)}}setVertexAttribPointers(t,e,n){for(let r=0;r<this.attributes.length;r++){const i=this.attributes[r],o=e.attributes[i.name];void 0!==o&&t.vertexAttribPointer(o,i.components,t[D[i.type]],!1,this.itemSize,i.offset+this.itemSize*(n||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class F{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class B extends F{getDefault(){return t.Color.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class z extends F{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class j extends F{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class U extends F{getDefault(){return[!0,!0,!0,!0]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class V extends F{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class G extends F{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class Z extends F{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const e=this.current;(t.func!==e.func||t.ref!==e.ref||t.mask!==e.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class q extends F{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class W extends F{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}}class H extends F{getDefault(){return[0,1]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class X extends F{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}}class $ extends F{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Y extends F{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}}class Q extends F{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class K extends F{getDefault(){return t.Color.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class J extends F{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class tt extends F{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1}}class et extends F{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class nt extends F{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class rt extends F{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class it extends F{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class ot extends F{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class st extends F{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class at extends F{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class lt extends F{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class ut extends F{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class ct extends F{getDefault(){return null}set(t){const e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class ht extends F{constructor(t){super(t),this.vao=t.extVertexArrayObject}getDefault(){return null}set(t){this.vao&&(t!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(t),this.current=t,this.dirty=!1)}}class pt extends F{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class ft extends F{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class dt extends F{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class gt extends F{constructor(t,e){super(t),this.context=t,this.parent=e}getDefault(){return null}}class mt extends gt{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class At extends gt{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,this.attachment(),e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class yt extends At{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class _t{constructor(t,e,n,r){this.context=t,this.width=e,this.height=n;const i=this.framebuffer=t.gl.createFramebuffer();this.colorAttachment=new mt(t,i),r&&(this.depthAttachment=new At(t,i))}destroy(){const t=this.context.gl,e=this.colorAttachment.get();if(e&&t.deleteTexture(e),this.depthAttachment){const e=this.depthAttachment.get();e&&t.deleteRenderbuffer(e)}t.deleteFramebuffer(this.framebuffer)}}class vt{constructor(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new B(this),this.clearDepth=new z(this),this.clearStencil=new j(this),this.colorMask=new U(this),this.depthMask=new V(this),this.stencilMask=new G(this),this.stencilFunc=new Z(this),this.stencilOp=new q(this),this.stencilTest=new W(this),this.depthRange=new H(this),this.depthTest=new X(this),this.depthFunc=new $(this),this.blend=new Y(this),this.blendFunc=new Q(this),this.blendColor=new K(this),this.blendEquation=new J(this),this.cullFace=new tt(this),this.cullFaceSide=new et(this),this.frontFace=new nt(this),this.program=new rt(this),this.activeTexture=new it(this),this.viewport=new ot(this),this.bindFramebuffer=new st(this),this.bindRenderbuffer=new at(this),this.bindTexture=new lt(this),this.bindVertexBuffer=new ut(this),this.bindElementBuffer=new ct(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ht(this),this.pixelStoreUnpack=new pt(this),this.pixelStoreUnpackPremultiplyAlpha=new ft(this),this.pixelStoreUnpackFlipY=new dt(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(t.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,e){return new k(this,t,e)}createVertexBuffer(t,e,n){return new N(this,t,e,n)}createRenderbuffer(t,e,n){const r=this.gl,i=r.createRenderbuffer();return this.bindRenderbuffer.set(i),r.renderbufferStorage(r.RENDERBUFFER,t,e,n),this.bindRenderbuffer.set(null),i}createFramebuffer(t,e,n){return new _t(this,t,e,n)}clear({color:t,depth:e,stencil:n}){const r=this.gl;let i=0;t&&(i|=r.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==e&&(i|=r.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(e),this.depthMask.set(!0)),void 0!==n&&(i|=r.STENCIL_BUFFER_BIT,this.clearStencil.set(n),this.stencilMask.set(255)),r.clear(i)}setCullFace(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(e){i(e.blendFunction,t.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class bt extends t.Evented{constructor(e,n,r,i){super(),this.id=e,this.dispatcher=r,this.setEventedParent(i),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.extend({type:"raster"},n),t.extend(this,t.pick(n,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=R(this._options,this.map._requestManager,((e,n)=>{this._tileJSONRequest=null,this._loaded=!0,e?this.fire(new t.ErrorEvent(e)):n&&(t.extend(this,n),n.bounds&&(this.tileBounds=new L(n.bounds,this.minzoom,this.maxzoom)),t.postTurnstileEvent(n.tiles),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))}))}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return t.extend({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(e,n){const r=t.exported.devicePixelRatio>=2,i=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),r,this.tileSize);e.request=t.getImage(this.map._requestManager.transformRequest(i,t.ResourceType.Tile),((r,i,o,s)=>{if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(r)e.state="errored",n(r);else if(i){this.map._refreshExpiredTiles&&e.setExpiryData({cacheControl:o,expires:s});const r=this.map.painter.context,a=r.gl;e.texture=this.map.painter.getTileTexture(i.width),e.texture?e.texture.update(i,{useMipmap:!0}):(e.texture=new t.Texture(r,i,a.RGBA,{useMipmap:!0}),e.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),r.extTextureFilterAnisotropic&&a.texParameterf(a.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax)),e.state="loaded",t.cacheEntryPossiblyAdded(this.dispatcher),n(null)}}))}abortTile(t,e){t.request&&(t.request.cancel(),delete t.request),e()}unloadTile(t,e){t.texture&&this.map.painter.saveTileTexture(t.texture),e()}hasTransition(){return!1}}let xt;var wt=t.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Et extends t.Evented{constructor(t,e,n,r){super(),this.id=t,this.dispatcher=n,this.coordinates=e.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(r),this.options=e}load(e,n){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this.url=this.options.url,t.getImage(this.map._requestManager.transformRequest(this.url,t.ResourceType.Image),((r,i)=>{this._loaded=!0,r?this.fire(new t.ErrorEvent(r)):i&&(this.image=t.exported.getImageData(i),e&&(this.coordinates=e),n&&n(),this._finishLoading())}))}loaded(){return this._loaded}updateImage(t){return this.image&&t.url?(this.options.url=t.url,this.load(t.coordinates,(()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}setCoordinates(e){this.coordinates=e;const n=e.map(t.MercatorCoordinate.fromLngLat);this.tileID=function(e){let n=1/0,r=1/0,i=-1/0,o=-1/0;for(const t of e)n=Math.min(n,t.x),r=Math.min(r,t.y),i=Math.max(i,t.x),o=Math.max(o,t.y);const s=Math.max(i-n,o-r),a=Math.max(0,Math.floor(-Math.log(s)/Math.LN2)),l=Math.pow(2,a);return new t.CanonicalTileID(a,Math.floor((n+i)/2*l),Math.floor((r+o)/2*l))}(n),this.minzoom=this.maxzoom=this.tileID.z;const r=n.map((t=>this.tileID.getTilePoint(t)._round()));return this._boundsArray=new t.StructArrayLayout4i8,this._boundsArray.emplaceBack(r[0].x,r[0].y,0,0),this._boundsArray.emplaceBack(r[1].x,r[1].y,t.EXTENT,0),this._boundsArray.emplaceBack(r[3].x,r[3].y,0,t.EXTENT),this._boundsArray.emplaceBack(r[2].x,r[2].y,t.EXTENT,t.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const e=this.map.painter.context,n=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,wt.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new t.Texture(e,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture)}}loadTile(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},e(null)):(t.state="errored",e(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const St={vector:class extends t.Evented{constructor(e,n,r,i){if(super(),this.id=e,this.dispatcher=r,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,t.extend(this,t.pick(n,["url","scheme","tileSize","promoteId"])),this._options=t.extend({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(i),this._tileWorkers={},this._deduped=new t.DedupedRequest}load(){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=R(this._options,this.map._requestManager,((e,n)=>{this._tileJSONRequest=null,this._loaded=!0,e?this.fire(new t.ErrorEvent(e)):n&&(t.extend(this,n),n.bounds&&(this.tileBounds=new L(n.bounds,this.minzoom,this.maxzoom)),t.postTurnstileEvent(n.tiles,this.map._requestManager._customAccessToken),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))}))}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.cancel(),t();const e=this.map.style._getSourceCaches(this.id);for(const t of e)t.clearTiles();this.load()}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return t.extend({},this._options)}loadTile(e,n){const r=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme)),i={request:this.map._requestManager.transformRequest(r,t.ResourceType.Tile),data:void 0,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:t.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:e.isSymbolTile};if(i.request.collectResourceTiming=this._collectResourceTiming,e.actor&&"expired"!==e.state)"loading"===e.state?e.reloadCallback=n:e.request=e.actor.send("reloadTile",i,o.bind(this));else if(e.actor=this._tileWorkers[r]=this._tileWorkers[r]||this.dispatcher.getActor(),this.dispatcher.ready)e.request=e.actor.send("loadTile",i,o.bind(this),void 0,!0);else{const n=t.loadVectorTile.call({deduped:this._deduped},i,((t,n)=>{t||!n?o.call(this,t):(i.data={cacheControl:n.cacheControl,expires:n.expires,rawData:n.rawData.slice(0)},e.actor&&e.actor.send("loadTile",i,o.bind(this),void 0,!0))}),!0);e.request={cancel:n}}function o(r,i){return delete e.request,e.aborted?n(null):r&&404!==r.status?n(r):(i&&i.resourceTiming&&(e.resourceTiming=i.resourceTiming),this.map._refreshExpiredTiles&&i&&e.setExpiryData(i),e.loadVectorData(i,this.map.painter),t.cacheEntryPossiblyAdded(this.dispatcher),n(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id})}unloadTile(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:bt,"raster-dem":class extends bt{constructor(e,n,r,i){super(e,n,r,i),this.type="raster-dem",this.maxzoom=22,this._options=t.extend({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox"}loadTile(e,n){const r=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function i(t,r){t&&(e.state="errored",n(t)),r&&(e.dem=r,e.dem.onDeserialize(),e.needsHillshadePrepare=!0,e.needsDEMTextureUpload=!0,e.state="loaded",n(null))}e.request=t.getImage(this.map._requestManager.transformRequest(r,t.ResourceType.Tile),function(r,o,s,a){if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(r)e.state="errored",n(r);else if(o){this.map._refreshExpiredTiles&&e.setExpiryData({cacheControl:s,expires:a});const n=t.window.ImageBitmap&&o instanceof t.window.ImageBitmap&&(null==xt&&(xt=t.window.OffscreenCanvas&&new t.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof t.window.createImageBitmap),xt),r=1-(o.width-t.prevPowerOfTwo(o.width))/2;r<1||e.neighboringTiles||(e.neighboringTiles=this._getNeighboringTiles(e.tileID));const l=n?o:t.exported.getImageData(o,r),u={uid:e.uid,coord:e.tileID,source:this.id,rawImageData:l,encoding:this.encoding,padding:r};e.actor&&"expired"!==e.state||(e.actor=this.dispatcher.getActor(),e.actor.send("loadDEMTile",u,i.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(e){const n=e.canonical,r=Math.pow(2,n.z),i=(n.x-1+r)%r,o=0===n.x?e.wrap-1:e.wrap,s=(n.x+1+r)%r,a=n.x+1===r?e.wrap+1:e.wrap,l={};return l[new t.OverscaledTileID(e.overscaledZ,o,n.z,i,n.y).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,a,n.z,s,n.y).key]={backfilled:!1},n.y>0&&(l[new t.OverscaledTileID(e.overscaledZ,o,n.z,i,n.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,a,n.z,s,n.y-1).key]={backfilled:!1}),n.y+1<r&&(l[new t.OverscaledTileID(e.overscaledZ,o,n.z,i,n.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,a,n.z,s,n.y+1).key]={backfilled:!1}),l}unloadTile(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded"}},geojson:class extends t.Evented{constructor(e,n,r,i){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=r.getActor(),this.setEventedParent(i),this._data=n.data,this._options=t.extend({},n),this._collectResourceTiming=n.collectResourceTiming,void 0!==n.maxzoom&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;const o=t.EXTENT/this.tileSize;this.workerOptions=t.extend({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(void 0!==n.buffer?n.buffer:128)*o,tolerance:(void 0!==n.tolerance?n.tolerance:.375)*o,extent:t.EXTENT,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:void 0!==n.clusterMaxZoom?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:t.EXTENT,radius:(void 0!==n.clusterRadius?n.clusterRadius:50)*o,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions)}onAdd(t){this.map=t,this.setData(this._data)}setData(t){return this._data=t,this._updateWorkerData(),this}getClusterExpansionZoom(t,e){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},e),this}getClusterChildren(t,e){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},e),this}getClusterLeaves(t,e,n,r){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:e,offset:n},r),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new t.Event("dataloading",{dataType:"source"})),this._loaded=!1;const e=t.extend({},this.workerOptions),n=this._data;"string"==typeof n?(e.request=this.map._requestManager.transformRequest(t.exported.resolveURL(n),t.ResourceType.Source),e.request.collectResourceTiming=this._collectResourceTiming):e.data=JSON.stringify(n),this._pendingLoad=this.actor.send(`${this.type}.loadData`,e,((e,n)=>{if(this._loaded=!0,this._pendingLoad=null,e)this.fire(new t.ErrorEvent(e));else{const e={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&n&&n.resourceTiming&&n.resourceTiming[this.id]&&(e.resourceTiming=n.resourceTiming[this.id]),this.fire(new t.Event("data",e)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)}))}loaded(){return this._loaded}loadTile(e,n){const r=e.actor?"reloadTile":"loadTile";e.actor=this.actor,e.request=this.actor.send(r,{type:this.type,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:t.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},((t,i)=>(delete e.request,e.unloadVectorData(),e.aborted?n(null):t?n(t):(e.loadVectorData(i,this.map.painter,"reloadTile"===r),n(null)))),void 0,"loadTile"===r)}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0}unloadTile(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return t.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Et{constructor(t,e,n,r){super(t,e,n,r),this.roundZoom=!0,this.type="video",this.options=e}load(){this._loaded=!1;const e=this.options;this.urls=[];for(const n of e.urls)this.urls.push(this.map._requestManager.transformRequest(n,t.ResourceType.Source).url);t.getVideo(this.urls,((e,n)=>{this._loaded=!0,e?this.fire(new t.ErrorEvent(e)):n&&(this.video=n,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading())}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const n=this.video.seekable;e<n.start(0)||e>n.end(0)?this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const e=this.map.painter.context,n=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,wt.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new t.Texture(e,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Et,canvas:class extends Et{constructor(e,n,r,i){super(e,n,r,i),n.coordinates?Array.isArray(n.coordinates)&&4===n.coordinates.length&&!n.coordinates.some((t=>!Array.isArray(t)||2!==t.length||t.some((t=>"number"!=typeof t))))||this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e}`,null,'missing required property "coordinates"'))),n.animate&&"boolean"!=typeof n.animate&&this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),n.canvas?"string"==typeof n.canvas||n.canvas instanceof t.window.HTMLCanvasElement||this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e}`,null,'missing required property "canvas"'))),this.options=n,this.animate=void 0===n.animate||n.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof t.window.HTMLCanvasElement?this.options.canvas:t.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const n=this.map.painter.context,r=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,wt.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new t.Texture(n,this.canvas,r.RGBA,{premultiply:!0});for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}},Tt=function(e,n,r,i){const o=new St[n.type](e,n,r,i);if(o.id!==e)throw new Error(`Expected Source id to be ${e} instead of ${o.id}`);return t.bindAll(["load","abort","unload","serialize","prepare"],o),o};function Pt(e,n){const r=t.identity([]);return t.scale$1(r,r,[.5*e.width,.5*-e.height,1]),t.translate(r,r,[1,-1,0]),t.multiply(r,r,e.calculateProjMatrix(n.toUnwrapped()))}function Mt(t,e,n,r,i,o,s,a=!1){const l=t.tilesIn(r,s,a);l.sort(It);const u=[];for(const r of l)u.push({wrappedTileID:r.tile.tileID.wrapped().key,queryResults:r.tile.queryRenderedFeatures(e,n,t._state,r,i,o,Pt(t.transform,r.tile.tileID),a)});const c=function(t){const e={},n={};for(const r of t){const t=r.queryResults,i=r.wrappedTileID,o=n[i]=n[i]||{};for(const n in t){const r=t[n],i=o[n]=o[n]||{},s=e[n]=e[n]||[];for(const t of r)i[t.featureIndex]||(i[t.featureIndex]=!0,s.push(t))}}return e}(u);for(const e in c)c[e].forEach((e=>{const n=e.feature,r=t.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=r}));return c}function Ct(t,e){const n=t.getRenderableIds().map((e=>t.getTileByID(e))),r=[],i={};for(let t=0;t<n.length;t++){const o=n[t],s=o.tileID.canonical.key;i[s]||(i[s]=!0,o.querySourceFeatures(r,e))}return r}function It(t,e){const n=t.tileID,r=e.tileID;return n.overscaledZ-r.overscaledZ||n.canonical.y-r.canonical.y||n.wrap-r.wrap||n.canonical.x-r.canonical.x}function Ot(){return null!=Wi.workerClass?new Wi.workerClass:new t.window.Worker(Wi.workerUrl)}const Rt="mapboxgl_preloaded_worker_pool";class Lt{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<Lt.workerCount;)this.workers.push(new Ot);return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],0===this.numActive()&&(this.workers.forEach((t=>{t.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[Rt]}numActive(){return Object.keys(this.active).length}}let kt;function Dt(){return kt||(kt=new Lt),kt}function Nt(e,n){const r={};for(const t in e)"ref"!==t&&(r[t]=e[t]);return t.refProperties.forEach((t=>{t in n&&(r[t]=n[t])})),r}function Ft(t){t=t.slice();const e=Object.create(null);for(let n=0;n<t.length;n++)e[t[n].id]=t[n];for(let n=0;n<t.length;n++)"ref"in t[n]&&(t[n]=Nt(t[n],e[t[n].ref]));return t}Lt.workerCount=2;const Bt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog"};function zt(t,e,n){n.push({command:Bt.addSource,args:[t,e[t]]})}function jt(t,e,n){e.push({command:Bt.removeSource,args:[t]}),n[t]=!0}function Ut(t,e,n,r){jt(t,n,r),zt(t,e,n)}function Vt(t,e,n){let r;for(r in t[n])if(t[n].hasOwnProperty(r)&&"data"!==r&&!i(t[n][r],e[n][r]))return!1;for(r in e[n])if(e[n].hasOwnProperty(r)&&"data"!==r&&!i(t[n][r],e[n][r]))return!1;return!0}function Gt(t,e,n,r,o,s){let a;for(a in e=e||{},t=t||{})t.hasOwnProperty(a)&&(i(t[a],e[a])||n.push({command:s,args:[r,a,e[a],o]}));for(a in e)e.hasOwnProperty(a)&&!t.hasOwnProperty(a)&&(i(t[a],e[a])||n.push({command:s,args:[r,a,e[a],o]}))}function Zt(t){return t.id}function qt(t,e){return t[e.id]=e,t}class Wt{constructor(t,e){this.reset(t,e)}reset(t,e){this.points=t||[],this._distances=[0];for(let t=1;t<this.points.length;t++)this._distances[t]=this._distances[t-1]+this.points[t].dist(this.points[t-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(e||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(1===this.points.length)return this.points[0];e=t.clamp(e,0,1);let n=1,r=this._distances[n];const i=e*this.paddedLength+this.padding;for(;r<i&&n<this._distances.length;)r=this._distances[++n];const o=n-1,s=this._distances[o],a=r-s,l=a>0?(i-s)/a:0;return this.points[o].mult(1-l).add(this.points[n].mult(l))}}class Ht{constructor(t,e,n){const r=this.boxCells=[],i=this.circleCells=[];this.xCellCount=Math.ceil(t/n),this.yCellCount=Math.ceil(e/n);for(let t=0;t<this.xCellCount*this.yCellCount;t++)r.push([]),i.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,e,n,r,i){this._forEachCell(e,n,r,i,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(i)}insertCircle(t,e,n,r){this._forEachCell(e-r,n-r,e+r,n+r,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(n),this.circles.push(r)}_insertBoxCell(t,e,n,r,i,o){this.boxCells[i].push(o)}_insertCircleCell(t,e,n,r,i,o){this.circleCells[i].push(o)}_query(t,e,n,r,i,o){if(n<0||t>this.width||r<0||e>this.height)return!i&&[];const s=[];if(t<=0&&e<=0&&this.width<=n&&this.height<=r){if(i)return!0;for(let t=0;t<this.boxKeys.length;t++)s.push({key:this.boxKeys[t],x1:this.bboxes[4*t],y1:this.bboxes[4*t+1],x2:this.bboxes[4*t+2],y2:this.bboxes[4*t+3]});for(let t=0;t<this.circleKeys.length;t++){const e=this.circles[3*t],n=this.circles[3*t+1],r=this.circles[3*t+2];s.push({key:this.circleKeys[t],x1:e-r,y1:n-r,x2:e+r,y2:n+r})}return o?s.filter(o):s}return this._forEachCell(t,e,n,r,this._queryCell,s,{hitTest:i,seenUids:{box:{},circle:{}}},o),i?s.length>0:s}_queryCircle(t,e,n,r,i){const o=t-n,s=t+n,a=e-n,l=e+n;if(s<0||o>this.width||l<0||a>this.height)return!r&&[];const u=[];return this._forEachCell(o,a,s,l,this._queryCellCircle,u,{hitTest:r,circle:{x:t,y:e,radius:n},seenUids:{box:{},circle:{}}},i),r?u.length>0:u}query(t,e,n,r,i){return this._query(t,e,n,r,!1,i)}hitTest(t,e,n,r,i){return this._query(t,e,n,r,!0,i)}hitTestCircle(t,e,n,r){return this._queryCircle(t,e,n,!0,r)}_queryCell(t,e,n,r,i,o,s,a){const l=s.seenUids,u=this.boxCells[i];if(null!==u){const i=this.bboxes;for(const c of u)if(!l.box[c]){l.box[c]=!0;const u=4*c;if(t<=i[u+2]&&e<=i[u+3]&&n>=i[u+0]&&r>=i[u+1]&&(!a||a(this.boxKeys[c]))){if(s.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[c],x1:i[u],y1:i[u+1],x2:i[u+2],y2:i[u+3]})}}}const c=this.circleCells[i];if(null!==c){const i=this.circles;for(const u of c)if(!l.circle[u]){l.circle[u]=!0;const c=3*u;if(this._circleAndRectCollide(i[c],i[c+1],i[c+2],t,e,n,r)&&(!a||a(this.circleKeys[u]))){if(s.hitTest)return o.push(!0),!0;{const t=i[c],e=i[c+1],n=i[c+2];o.push({key:this.circleKeys[u],x1:t-n,y1:e-n,x2:t+n,y2:e+n})}}}}}_queryCellCircle(t,e,n,r,i,o,s,a){const l=s.circle,u=s.seenUids,c=this.boxCells[i];if(null!==c){const t=this.bboxes;for(const e of c)if(!u.box[e]){u.box[e]=!0;const n=4*e;if(this._circleAndRectCollide(l.x,l.y,l.radius,t[n+0],t[n+1],t[n+2],t[n+3])&&(!a||a(this.boxKeys[e])))return o.push(!0),!0}}const h=this.circleCells[i];if(null!==h){const t=this.circles;for(const e of h)if(!u.circle[e]){u.circle[e]=!0;const n=3*e;if(this._circlesCollide(t[n],t[n+1],t[n+2],l.x,l.y,l.radius)&&(!a||a(this.circleKeys[e])))return o.push(!0),!0}}}_forEachCell(t,e,n,r,i,o,s,a){const l=this._convertToXCellCoord(t),u=this._convertToYCellCoord(e),c=this._convertToXCellCoord(n),h=this._convertToYCellCoord(r);for(let p=l;p<=c;p++)for(let l=u;l<=h;l++)if(i.call(this,t,e,n,r,this.xCellCount*l+p,o,s,a))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,e,n,r,i,o){const s=r-t,a=i-e,l=n+o;return l*l>s*s+a*a}_circleAndRectCollide(t,e,n,r,i,o,s){const a=(o-r)/2,l=Math.abs(t-(r+a));if(l>a+n)return!1;const u=(s-i)/2,c=Math.abs(e-(i+u));if(c>u+n)return!1;if(l<=a||c<=u)return!0;const h=l-a,p=c-u;return h*h+p*p<=n*n}}const Xt=Math.tan(85*Math.PI/180);function $t(e,n,r,i,o){const s=t.create$1();return n?(t.scale$1(s,s,[1/o,1/o,1]),r||t.rotateZ(s,s,i.angle)):t.multiply(s,i.labelPlaneMatrix,e),s}function Yt(e,n,r,i,o){if(n){const n=t.clone$1(e);return t.scale$1(n,n,[o,o,1]),r||t.rotateZ(n,n,-i.angle),n}return i.glCoordMatrix}function Qt(e,n,r=0){const i=[e.x,e.y,r,1];r?t.transformMat4(i,i,n):ue(i,i,n);const o=i[3];return{point:new t.pointGeometry(i[0]/o,i[1]/o),signedDistanceFromCamera:o}}function Kt(t,e){return Math.min(.5+t/e*.5,1.5)}function Jt(t,e){const n=t[0]/t[3],r=t[1]/t[3];return n>=-e[0]&&n<=e[0]&&r>=-e[1]&&r<=e[1]}function te(e,n,r,i,o,s,a,l,u){const c=i?e.textSizeData:e.iconSizeData,h=t.evaluateSizeForZoom(c,r.transform.zoom),p=[256/r.width*2+1,256/r.height*2+1],f=i?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;f.clear();const d=e.lineVertexArray,g=i?e.text.placedSymbolArray:e.icon.placedSymbolArray,m=r.transform.width/r.transform.height;let A=!1;for(let i=0;i<g.length;i++){const y=g.get(i);if(y.writingMode!==t.WritingMode.vertical||A||0!==i&&g.get(i-1).writingMode===t.WritingMode.horizontal||(A=!0),y.hidden||y.writingMode===t.WritingMode.vertical&&!A){le(y.numGlyphs,f);continue}A=!1;const _=new t.pointGeometry(y.tileAnchorX,y.tileAnchorY),v=u?u(_):0,b=[_.x,_.y,v],x=[...b,1];if(t.transformMat4(x,x,n),!Jt(x,p)){le(y.numGlyphs,f);continue}const w=Kt(r.transform.cameraToCenterDistance,x[3]),E=t.evaluateSizeForFeature(c,h,y),S=a?E/w:E*w,T=Qt(new t.pointGeometry(b[0],b[1]),o,b[2]);if(T.signedDistanceFromCamera<=0){le(y.numGlyphs,f);continue}let P={};const M=a?null:u,C=re(y,S,!1,l,n,o,s,e.glyphOffsetArray,d,f,T.point,_,P,m,M);A=C.useVertical,M&&C.needsFlipping&&(P={}),(C.notEnoughRoom||A||C.needsFlipping&&re(y,S,!0,l,n,o,s,e.glyphOffsetArray,d,f,T.point,_,P,m,M).notEnoughRoom)&&le(y.numGlyphs,f)}i?e.text.dynamicLayoutVertexBuffer.updateData(f):e.icon.dynamicLayoutVertexBuffer.updateData(f)}function ee(t,e,n,r,i,o,s,a,l,u,c,h,p){const f=a.glyphStartIndex+a.numGlyphs,d=a.lineStartIndex,g=a.lineStartIndex+a.lineLength,m=e.getoffsetX(a.glyphStartIndex),A=e.getoffsetX(f-1),y=se(t*m,n,r,i,o,s,a.segment,d,g,l,u,c,h,p,!0);if(!y)return null;const _=se(t*A,n,r,i,o,s,a.segment,d,g,l,u,c,h,p,!0);return _?{first:y,last:_}:null}function ne(e,n,r,i){return e.writingMode===t.WritingMode.horizontal&&Math.abs(r.y-n.y)>Math.abs(r.x-n.x)*i?{useVertical:!0}:e.writingMode===t.WritingMode.vertical?n.y<r.y?{needsFlipping:!0}:null:0!==e.flipState&&function(t,e,n){const r=(e.x-t.x)*n;return 0===r||Math.abs((e.y-t.y)/r)>Xt}(n,r,i)?1===e.flipState?{needsFlipping:!0}:null:n.x>r.x?{needsFlipping:!0}:null}function re(e,n,r,i,o,s,a,l,u,c,h,p,f,d,g){const m=n/24,A=e.lineOffsetX*m,y=e.lineOffsetY*m;let _;if(e.numGlyphs>1){const t=e.glyphStartIndex+e.numGlyphs,n=e.lineStartIndex,o=e.lineStartIndex+e.lineLength,c=ee(m,l,A,y,r,h,p,e,u,s,f,g,!1);if(!c)return{notEnoughRoom:!0};const v=Qt(c.first.point,a).point,b=Qt(c.last.point,a).point;if(i&&!r){const t=ne(e,v,b,d);if(e.flipState=t&&t.needsFlipping?1:2,t)return t}_=[c.first];for(let i=e.glyphStartIndex+1;i<t-1;i++)_.push(se(m*l.getoffsetX(i),A,y,r,h,p,e.segment,n,o,u,s,f,g,!1,!1));_.push(c.last)}else{if(i&&!r){const n=Qt(p,o).point,r=e.lineStartIndex+e.segment+1,i=new t.pointGeometry(u.getx(r),u.gety(r)),s=Qt(i,o),a=ne(e,n,s.signedDistanceFromCamera>0?s.point:oe(p,i,n,1,o,void 0),d);if(e.flipState=a&&a.needsFlipping?1:2,a)return a}const n=se(m*l.getoffsetX(e.glyphStartIndex),A,y,r,h,p,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,u,s,f,g,!1,!1);if(!n)return{notEnoughRoom:!0};_=[n]}for(const e of _)t.addDynamicAttributes(c,e.point,e.angle);return{}}function ie(e,n,r){const i={x:e.x,y:e.y,z:0};if(!r)return Qt(i,n,i.z);const o=r(e);return Qt(new t.pointGeometry(i.x,i.y),n,i.z+o)}function oe(t,e,n,r,i,o){const s=ie(t.add(t.sub(e)._unit()),i,o).point,a=n.sub(s);return n.add(a._mult(r/a.mag()))}function se(e,n,r,i,o,s,a,l,u,c,h,p,f,d,g){const m=i?e-n:e+n;let A=m>0?1:-1,y=0;i&&(A*=-1,y=Math.PI),A<0&&(y+=Math.PI);let _=A>0?l+a:l+a+1,v=o,b=o,x=0,w=0;const E=Math.abs(m),S=[],T=[];let P=s;const M=()=>{const e=_-A;return 0===x?s:new t.pointGeometry(c.getx(e),c.gety(e))},C=()=>oe(M(),P,b,E-x+1,h,f);for(;x+w<=E;){if(_+=A,_<l||_>=u)return null;if(b=v,S.push(v),d&&T.push(P||M()),v=p[_],void 0===v){P=new t.pointGeometry(c.getx(_),c.gety(_));const e=ie(P,h,f);v=e.signedDistanceFromCamera>0?p[_]=e.point:C()}else P=null;x+=w,w=b.dist(v)}g&&f&&(P=P||new t.pointGeometry(c.getx(_),c.gety(_)),p[_]=v=void 0===p[_]?v:C(),w=b.dist(v));const I=(E-x)/w,O=v.sub(b),R=O.mult(I)._add(b);r&&R._add(O._unit()._perp()._mult(r*A));const L=y+Math.atan2(v.y-b.y,v.x-b.x);return S.push(R),d&&(P=P||new t.pointGeometry(c.getx(_),c.gety(_)),T.push(function(e,n,r){const i=1-r;return new t.pointGeometry(e.x*i+n.x*r,e.y*i+n.y*r)}(T.length>0?T[T.length-1]:P,P,I))),{point:R,angle:L,path:S,tilePath:T}}const ae=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function le(t,e){for(let n=0;n<t;n++){const t=e.length;e.resize(t+4),e.float32.set(ae,3*t)}}function ue(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t[3]=n[3]*r+n[7]*i+n[15],t}const ce=100;class he{constructor(t,e,n=new Ht(t.width+200,t.height+200,25),r=new Ht(t.width+200,t.height+200,25)){this.transform=t,this.grid=n,this.ignoredGrid=r,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+ce,this.screenBottomBoundary=t.height+ce,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.fogState=e}placeCollisionBox(t,e,n,r,i,o,s){let a=e.projectedAnchorZ;e.elevation&&(a+=e.elevation);const l=this.projectAndGetPerspectiveRatio(o,e.projectedAnchorX,e.projectedAnchorY,a,e.tileID),u=i*l.perspectiveRatio,c=(e.x1*t+n.x-e.padding)*u+l.point.x,h=(e.y1*t+n.y-e.padding)*u+l.point.y,p=(e.x2*t+n.x+e.padding)*u+l.point.x,f=(e.y2*t+n.y+e.padding)*u+l.point.y,d=l.perspectiveRatio<=.55||l.aboveHorizon;return!this.isInsideGrid(c,h,p,f)||!r&&this.grid.hitTest(c,h,p,f,s)||d?{box:[],offscreen:!1}:{box:[c,h,p,f],offscreen:this.isOffscreen(c,h,p,f)}}placeCollisionCircles(e,n,r,i,o,s,a,l,u,c,h,p,f,d){const g=[],m=this.transform.elevation,A=m?t=>m.getAtTileOffset(d,t.x,t.y):t=>0,y=new t.pointGeometry(n.tileAnchorX,n.tileAnchorY),_=A(y),v=this.projectAndGetPerspectiveRatio(s,y.x,y.y,_,d),{perspectiveRatio:b}=v,x=(c?o/b:o*b)/t.ONE_EM,w=Qt(y,a,_).point,E=v.signedDistanceFromCamera>0?ee(x,i,n.lineOffsetX*x,n.lineOffsetY*x,!1,w,y,n,r,a,{},m&&!c?A:null,c&&!!m):null;let S=!1,T=!1,P=!0;if(E&&!v.aboveHorizon){const n=.5*p*b+f,r=new t.pointGeometry(-100,-100),i=new t.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),o=new Wt,s=E.first,a=E.last;let c=[];for(let t=s.path.length-1;t>=1;t--)c.push(s.path[t]);for(let t=1;t<a.path.length;t++)c.push(a.path[t]);const d=2.5*n;if(l){const t=c.map(m?(t,e)=>{const n=A(e<s.path.length-1?s.tilePath[s.path.length-1-e]:a.tilePath[e-s.path.length+2]);return Qt(t,l,n)}:t=>Qt(t,l));c=t.some((t=>t.signedDistanceFromCamera<=0))?[]:t.map((t=>t.point))}let y=[];if(c.length>0){const e=c[0].clone(),n=c[0].clone();for(let t=1;t<c.length;t++)e.x=Math.min(e.x,c[t].x),e.y=Math.min(e.y,c[t].y),n.x=Math.max(n.x,c[t].x),n.y=Math.max(n.y,c[t].y);y=e.x>=r.x&&n.x<=i.x&&e.y>=r.y&&n.y<=i.y?[c]:n.x<r.x||e.x>i.x||n.y<r.y||e.y>i.y?[]:t.clipLine([c],r.x,r.y,i.x,i.y)}for(const t of y){o.reset(t,.25*n);let r=0;r=o.length<=.5*n?1:Math.ceil(o.paddedLength/d)+1;for(let t=0;t<r;t++){const i=t/Math.max(r-1,1),s=o.lerp(i),a=s.x+ce,l=s.y+ce;g.push(a,l,n,0);const c=a-n,p=l-n,f=a+n,d=l+n;if(P=P&&this.isOffscreen(c,p,f,d),T=T||this.isInsideGrid(c,p,f,d),!e&&this.grid.hitTestCircle(a,l,n,h)&&(S=!0,!u))return{circles:[],offscreen:!1,collisionDetected:S}}}}return{circles:!u&&S||!T?[]:g,offscreen:P,collisionDetected:S}}queryRenderedSymbols(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const n=[];let r=1/0,i=1/0,o=-1/0,s=-1/0;for(const a of e){const e=new t.pointGeometry(a.x+ce,a.y+ce);r=Math.min(r,e.x),i=Math.min(i,e.y),o=Math.max(o,e.x),s=Math.max(s,e.y),n.push(e)}const a=this.grid.query(r,i,o,s).concat(this.ignoredGrid.query(r,i,o,s)),l={},u={};for(const e of a){const r=e.key;if(void 0===l[r.bucketInstanceId]&&(l[r.bucketInstanceId]={}),l[r.bucketInstanceId][r.featureIndex])continue;const i=[new t.pointGeometry(e.x1,e.y1),new t.pointGeometry(e.x2,e.y1),new t.pointGeometry(e.x2,e.y2),new t.pointGeometry(e.x1,e.y2)];t.polygonIntersectsPolygon(n,i)&&(l[r.bucketInstanceId][r.featureIndex]=!0,void 0===u[r.bucketInstanceId]&&(u[r.bucketInstanceId]=[]),u[r.bucketInstanceId].push(r.featureIndex))}return u}insertCollisionBox(t,e,n,r,i){(e?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:r,collisionGroupID:i},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,e,n,r,i){const o=e?this.ignoredGrid:this.grid,s={bucketInstanceId:n,featureIndex:r,collisionGroupID:i};for(let e=0;e<t.length;e+=4)o.insertCircle(s,t[e],t[e+1],t[e+2])}projectAndGetPerspectiveRatio(e,n,r,i,o){const s=[n,r,i||0,1];let a=!1;if(i||this.transform.pitch>0){t.transformMat4(s,s,e);let l=!1;this.fogState&&o&&(l=function(e,n,r,i,o,s){const a=s.calculateFogTileMatrix(o),l=[n,r,i];return t.transformMat4$1(l,l,a),w(e,l,s.pitch,s._fov)}(this.fogState,n,r,i||0,o.toUnwrapped(),this.transform)>.9),a=s[2]>s[3]||l}else ue(s,s,e);return{point:new t.pointGeometry((s[0]/s[3]+1)/2*this.transform.width+ce,(-s[1]/s[3]+1)/2*this.transform.height+ce),perspectiveRatio:Math.min(.5+this.transform.cameraToCenterDistance/s[3]*.5,1.5),signedDistanceFromCamera:s[3],aboveHorizon:a}}isOffscreen(t,e,n,r){return n<ce||t>=this.screenRightBoundary||r<ce||e>this.screenBottomBoundary}isInsideGrid(t,e,n,r){return n>=0&&t<this.gridRightBoundary&&r>=0&&e<this.gridBottomBoundary}getViewportMatrix(){const e=t.identity([]);return t.translate(e,e,[-100,-100,0]),e}}class pe{constructor(t,e,n,r){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):r&&n?1:0,this.placed=n}isHidden(){return 0===this.opacity&&!this.placed}}class fe{constructor(t,e,n,r,i){this.text=new pe(t?t.text:null,e,n,i),this.icon=new pe(t?t.icon:null,e,r,i)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class de{constructor(t,e,n){this.text=t,this.icon=e,this.skipFade=n}}class ge{constructor(){this.invProjMatrix=t.create$1(),this.viewportMatrix=t.create$1(),this.circles=[]}}class me{constructor(t,e,n,r,i){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=n,this.bucketIndex=r,this.tileID=i}}class Ae{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:t=>t.collisionGroupID===e}}return this.collisionGroups[t]}}function ye(e,n,r,i,o){const{horizontalAlign:s,verticalAlign:a}=t.getAnchorAlignment(e),l=-(s-.5)*n,u=-(a-.5)*r,c=t.evaluateVariableOffset(e,i);return new t.pointGeometry(l+c[0]*o,u+c[1]*o)}function _e(e,n,r,i,o){const s=new t.pointGeometry(e,n);return r&&s._rotate(i?o:-o),s}class ve{constructor(t,e,n,r,i){this.transform=t.clone(),this.collisionIndex=new he(this.transform,i),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=e,this.retainedQueryData={},this.collisionGroups=new Ae(n),this.collisionCircleArrays={},this.prevPlacement=r,r&&(r.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(e,n,r,i){const o=r.getBucket(n),s=r.latestFeatureIndex;if(!o||!s||n.id!==o.layerIds[0])return;const a=r.collisionBoxArray,l=o.layers[0].layout,u=Math.pow(2,this.transform.zoom-r.tileID.overscaledZ),c=r.tileSize/t.EXTENT,h=this.transform.calculateProjMatrix(r.tileID.toUnwrapped()),p="map"===l.get("text-pitch-alignment"),f="map"===l.get("text-rotation-alignment"),d=C(r,1,this.transform.zoom),g=$t(h,p,f,this.transform,d);let m=null;if(p){const e=Yt(h,p,f,this.transform,d);m=t.multiply([],this.transform.labelPlaneMatrix,e)}this.retainedQueryData[o.bucketInstanceId]=new me(o.bucketInstanceId,s,o.sourceLayerIndex,o.index,r.tileID);const A={bucket:o,layout:l,posMatrix:h,textLabelPlaneMatrix:g,labelToScreenMatrix:m,scale:u,textPixelRatio:c,holdingForFade:r.holdingForFade(),collisionBoxArray:a,partiallyEvaluatedTextSize:t.evaluateSizeForZoom(o.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:t.evaluateSizeForZoom(o.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(o.sourceID)};if(i)for(const t of o.sortKeyRanges){const{sortKey:n,symbolInstanceStart:r,symbolInstanceEnd:i}=t;e.push({sortKey:n,symbolInstanceStart:r,symbolInstanceEnd:i,parameters:A})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:o.symbolInstances.length,parameters:A})}attemptAnchorPlacement(t,e,n,r,i,o,s,a,l,u,c,h,p,f,d,g,m,A){const y=[h.textOffset0,h.textOffset1],_=ye(t,n,r,y,i),v=this.collisionIndex.placeCollisionBox(i,e,_e(_.x,_.y,o,s,this.transform.angle),c,a,l,u.predicate);if((!g||0!==this.collisionIndex.placeCollisionBox(f.getSymbolInstanceIconSize(A,this.transform.zoom,p),g,_e(_.x,_.y,o,s,this.transform.angle),c,a,l,u.predicate).box.length)&&v.box.length>0){let e;return this.prevPlacement&&this.prevPlacement.variableOffsets[h.crossTileID]&&this.prevPlacement.placements[h.crossTileID]&&this.prevPlacement.placements[h.crossTileID].text&&(e=this.prevPlacement.variableOffsets[h.crossTileID].anchor),this.variableOffsets[h.crossTileID]={textOffset:y,width:n,height:r,anchor:t,textScale:i,prevAnchor:e},this.markUsedJustification(f,t,h,d),f.allowVerticalPlacement&&(this.markUsedOrientation(f,d,h),this.placedOrientations[h.crossTileID]=d),{shift:_,placedGlyphBoxes:v}}}placeLayerBucketPart(e,n,r,i){const{bucket:o,layout:s,posMatrix:a,textLabelPlaneMatrix:l,labelToScreenMatrix:u,textPixelRatio:c,holdingForFade:h,collisionBoxArray:p,partiallyEvaluatedTextSize:f,partiallyEvaluatedIconSize:d,collisionGroup:g}=e.parameters,m=s.get("text-optional"),A=s.get("icon-optional"),y=s.get("text-allow-overlap"),_=s.get("icon-allow-overlap"),v="map"===s.get("text-rotation-alignment"),b="map"===s.get("text-pitch-alignment"),x="none"!==s.get("icon-text-fit"),w="viewport-y"===s.get("symbol-z-order"),E=y&&(_||!o.hasIconData()||A),S=_&&(y||!o.hasTextData()||m);!o.collisionArrays&&p&&o.deserializeCollisionBoxes(p),r&&i&&o.updateCollisionDebugBuffers(this.transform.zoom,p);const T=(e,i,p)=>{if(n[e.crossTileID])return;if(h)return void(this.placements[e.crossTileID]=new de(!1,!1,!1));let w=!1,T=!1,P=!0,M=null,C={box:null,offscreen:null},I={box:null,offscreen:null},O=null,R=null,L=null,k=0,D=0,N=0;p.textFeatureIndex?k=p.textFeatureIndex:e.useRuntimeCollisionCircles&&(k=e.featureIndex),p.verticalTextFeatureIndex&&(D=p.verticalTextFeatureIndex);const F=t=>{t.tileID=this.retainedQueryData[o.bucketInstanceId].tileID,(this.transform.elevation||t.elevation)&&(t.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[o.bucketInstanceId].tileID,t.tileAnchorX,t.tileAnchorY):0)},B=p.textBox;if(B){F(B);const n=n=>{let r=t.WritingMode.horizontal;if(o.allowVerticalPlacement&&!n&&this.prevPlacement){const t=this.prevPlacement.placedOrientations[e.crossTileID];t&&(this.placedOrientations[e.crossTileID]=t,r=t,this.markUsedOrientation(o,r,e))}return r},r=(n,r)=>{if(o.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&p.verticalTextBox){for(const e of o.writingModes)if(e===t.WritingMode.vertical?(C=r(),I=C):C=n(),C&&C.box&&C.box.length)break}else C=n()};if(s.get("text-variable-anchor")){let l=s.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[e.crossTileID]){const t=this.prevPlacement.variableOffsets[e.crossTileID];l.indexOf(t.anchor)>0&&(l=l.filter((e=>e!==t.anchor)),l.unshift(t.anchor))}const u=(t,n,r)=>{const s=o.getSymbolInstanceTextSize(f,e,this.transform.zoom,i),u=(t.x2-t.x1)*s+2*t.padding,h=(t.y2-t.y1)*s+2*t.padding,p=x&&!_?n:null;p&&F(p);let m={box:[],offscreen:!1};const A=y?2*l.length:l.length;for(let n=0;n<A;++n){const A=this.attemptAnchorPlacement(l[n%l.length],t,u,h,s,v,b,c,a,g,n>=l.length,e,i,o,r,p,f,d);if(A&&(m=A.placedGlyphBoxes,m&&m.box&&m.box.length)){w=!0,M=A.shift;break}}return m};r((()=>u(B,p.iconBox,t.WritingMode.horizontal)),(()=>{const n=p.verticalTextBox;return n&&F(n),o.allowVerticalPlacement&&!(C&&C.box&&C.box.length)&&e.numVerticalGlyphVertices>0&&n?u(n,p.verticalIconBox,t.WritingMode.vertical):{box:null,offscreen:null}})),C&&(w=C.box,P=C.offscreen);const h=n(C&&C.box);if(!w&&this.prevPlacement){const t=this.prevPlacement.variableOffsets[e.crossTileID];t&&(this.variableOffsets[e.crossTileID]=t,this.markUsedJustification(o,t.anchor,e,h))}}else{const s=(n,r)=>{const s=o.getSymbolInstanceTextSize(f,e,this.transform.zoom,i),l=this.collisionIndex.placeCollisionBox(s,n,new t.pointGeometry(0,0),y,c,a,g.predicate);return l&&l.box&&l.box.length&&(this.markUsedOrientation(o,r,e),this.placedOrientations[e.crossTileID]=r),l};r((()=>s(B,t.WritingMode.horizontal)),(()=>{const n=p.verticalTextBox;return o.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&n?(F(n),s(n,t.WritingMode.vertical)):{box:null,offscreen:null}})),n(C&&C.box&&C.box.length)}}if(O=C,w=O&&O.box&&O.box.length>0,P=O&&O.offscreen,e.useRuntimeCollisionCircles){const n=o.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex>=0?e.centerJustifiedTextSymbolIndex:e.verticalPlacedTextSymbolIndex),i=t.evaluateSizeForFeature(o.textSizeData,f,n),c=s.get("text-padding");R=this.collisionIndex.placeCollisionCircles(y,n,o.lineVertexArray,o.glyphOffsetArray,i,a,l,u,r,b,g.predicate,e.collisionCircleDiameter*i/t.ONE_EM,c,this.retainedQueryData[o.bucketInstanceId].tileID),w=y||R.circles.length>0&&!R.collisionDetected,P=P&&R.offscreen}if(p.iconFeatureIndex&&(N=p.iconFeatureIndex),p.iconBox){const e=e=>{F(e);const n=x&&M?_e(M.x,M.y,v,b,this.transform.angle):new t.pointGeometry(0,0),r=o.getSymbolInstanceIconSize(d,this.transform.zoom,i);return this.collisionIndex.placeCollisionBox(r,e,n,_,c,a,g.predicate)};I&&I.box&&I.box.length&&p.verticalIconBox?(L=e(p.verticalIconBox),T=L.box.length>0):(L=e(p.iconBox),T=L.box.length>0),P=P&&L.offscreen}const z=m||0===e.numHorizontalGlyphVertices&&0===e.numVerticalGlyphVertices,j=A||0===e.numIconVertices;if(z||j?j?z||(T=T&&w):w=T&&w:T=w=T&&w,w&&O&&O.box&&this.collisionIndex.insertCollisionBox(O.box,s.get("text-ignore-placement"),o.bucketInstanceId,I&&I.box&&D?D:k,g.ID),T&&L&&this.collisionIndex.insertCollisionBox(L.box,s.get("icon-ignore-placement"),o.bucketInstanceId,N,g.ID),R&&(w&&this.collisionIndex.insertCollisionCircles(R.circles,s.get("text-ignore-placement"),o.bucketInstanceId,k,g.ID),r)){const t=o.bucketInstanceId;let e=this.collisionCircleArrays[t];void 0===e&&(e=this.collisionCircleArrays[t]=new ge);for(let t=0;t<R.circles.length;t+=4)e.circles.push(R.circles[t+0]),e.circles.push(R.circles[t+1]),e.circles.push(R.circles[t+2]),e.circles.push(R.collisionDetected?1:0)}this.placements[e.crossTileID]=new de(w||E,T||S,P||o.justReloaded),n[e.crossTileID]=!0};if(w){const t=o.getSortedSymbolIndexes(this.transform.angle);for(let e=t.length-1;e>=0;--e){const n=t[e];T(o.symbolInstances.get(n),n,o.collisionArrays[n])}}else for(let t=e.symbolInstanceStart;t<e.symbolInstanceEnd;t++)T(o.symbolInstances.get(t),t,o.collisionArrays[t]);if(r&&o.bucketInstanceId in this.collisionCircleArrays){const e=this.collisionCircleArrays[o.bucketInstanceId];t.invert(e.invProjMatrix,a),e.viewportMatrix=this.collisionIndex.getViewportMatrix()}o.justReloaded=!1}markUsedJustification(e,n,r,i){let o;o=i===t.WritingMode.vertical?r.verticalPlacedTextSymbolIndex:{left:r.leftJustifiedTextSymbolIndex,center:r.centerJustifiedTextSymbolIndex,right:r.rightJustifiedTextSymbolIndex}[t.getAnchorJustification(n)];const s=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex,r.verticalPlacedTextSymbolIndex];for(const t of s)t>=0&&(e.text.placedSymbolArray.get(t).crossTileID=o>=0&&t!==o?0:r.crossTileID)}markUsedOrientation(e,n,r){const i=n===t.WritingMode.horizontal||n===t.WritingMode.horizontalOnly?n:0,o=n===t.WritingMode.vertical?n:0,s=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex];for(const t of s)e.text.placedSymbolArray.get(t).placedOrientation=i;r.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(r.verticalPlacedTextSymbolIndex).placedOrientation=o)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const e=this.prevPlacement;let n=!1;this.prevZoomAdjustment=e?e.zoomAdjustment(this.transform.zoom):0;const r=e?e.symbolFadeChange(t):1,i=e?e.opacities:{},o=e?e.variableOffsets:{},s=e?e.placedOrientations:{};for(const t in this.placements){const e=this.placements[t],o=i[t];o?(this.opacities[t]=new fe(o,r,e.text,e.icon),n=n||e.text!==o.text.placed||e.icon!==o.icon.placed):(this.opacities[t]=new fe(null,r,e.text,e.icon,e.skipFade),n=n||e.text||e.icon)}for(const t in i){const e=i[t];if(!this.opacities[t]){const i=new fe(e,r,!1,!1);i.isHidden()||(this.opacities[t]=i,n=n||e.text.placed||e.icon.placed)}}for(const t in o)this.variableOffsets[t]||!this.opacities[t]||this.opacities[t].isHidden()||(this.variableOffsets[t]=o[t]);for(const t in s)this.placedOrientations[t]||!this.opacities[t]||this.opacities[t].isHidden()||(this.placedOrientations[t]=s[t]);n?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=e?e.lastPlacementChangeTime:t)}updateLayerOpacities(t,e){const n={};for(const r of e){const e=r.getBucket(t);e&&r.latestFeatureIndex&&t.id===e.layerIds[0]&&this.updateBucketOpacities(e,n,r.collisionBoxArray)}}updateBucketOpacities(e,n,r){e.hasTextData()&&e.text.opacityVertexArray.clear(),e.hasIconData()&&e.icon.opacityVertexArray.clear(),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const i=e.layers[0].layout,o=new fe(null,0,!1,!1,!0),s=i.get("text-allow-overlap"),a=i.get("icon-allow-overlap"),l=i.get("text-variable-anchor"),u="map"===i.get("text-rotation-alignment"),c="map"===i.get("text-pitch-alignment"),h="none"!==i.get("icon-text-fit"),p=new fe(null,0,s&&(a||!e.hasIconData()||i.get("icon-optional")),a&&(s||!e.hasTextData()||i.get("text-optional")),!0);!e.collisionArrays&&r&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(r);const f=(t,e,n)=>{for(let r=0;r<e/4;r++)t.opacityVertexArray.emplaceBack(n)};for(let r=0;r<e.symbolInstances.length;r++){const i=e.symbolInstances.get(r),{numHorizontalGlyphVertices:s,numVerticalGlyphVertices:a,crossTileID:d}=i;let g=this.opacities[d];n[d]?g=o:g||(g=p,this.opacities[d]=g),n[d]=!0;const m=i.numIconVertices>0,A=this.placedOrientations[i.crossTileID],y=A===t.WritingMode.vertical,_=A===t.WritingMode.horizontal||A===t.WritingMode.horizontalOnly;if(s>0||a>0){const t=Ce(g.text);f(e.text,s,y?Ie:t),f(e.text,a,_?Ie:t);const n=g.text.isHidden();[i.rightJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.leftJustifiedTextSymbolIndex].forEach((t=>{t>=0&&(e.text.placedSymbolArray.get(t).hidden=n||y?1:0)})),i.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).hidden=n||_?1:0);const r=this.variableOffsets[i.crossTileID];r&&this.markUsedJustification(e,r.anchor,i,A);const o=this.placedOrientations[i.crossTileID];o&&(this.markUsedJustification(e,"left",i,o),this.markUsedOrientation(e,o,i))}if(m){const t=Ce(g.icon);i.placedIconSymbolIndex>=0&&(f(e.icon,i.numIconVertices,y?Ie:t),e.icon.placedSymbolArray.get(i.placedIconSymbolIndex).hidden=g.icon.isHidden()),i.verticalPlacedIconSymbolIndex>=0&&(f(e.icon,i.numVerticalIconVertices,_?Ie:t),e.icon.placedSymbolArray.get(i.verticalPlacedIconSymbolIndex).hidden=g.icon.isHidden())}if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const n=e.collisionArrays[r];if(n){let r=new t.pointGeometry(0,0);if(n.textBox||n.verticalTextBox){let t=!0;if(l){const e=this.variableOffsets[d];e?(r=ye(e.anchor,e.width,e.height,e.textOffset,e.textScale),u&&r._rotate(c?this.transform.angle:-this.transform.angle)):t=!1}n.textBox&&be(e.textCollisionBox.collisionVertexArray,g.text.placed,!t||y,r.x,r.y),n.verticalTextBox&&be(e.textCollisionBox.collisionVertexArray,g.text.placed,!t||_,r.x,r.y)}const i=Boolean(!_&&n.verticalIconBox);n.iconBox&&be(e.iconCollisionBox.collisionVertexArray,g.icon.placed,i,h?r.x:0,h?r.y:0),n.verticalIconBox&&be(e.iconCollisionBox.collisionVertexArray,g.icon.placed,!i,h?r.x:0,h?r.y:0)}}}if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.bucketInstanceId in this.collisionCircleArrays){const t=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=t.invProjMatrix,e.placementViewportMatrix=t.viewportMatrix,e.collisionCircleArray=t.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,e){const n=this.zoomAtLastRecencyCheck===e?1-this.zoomAdjustment(e):1;return this.zoomAtLastRecencyCheck=e,this.commitTime+this.fadeDuration*n>t}setStale(){this.stale=!0}}function be(t,e,n,r,i){t.emplaceBack(e?1:0,n?1:0,r||0,i||0),t.emplaceBack(e?1:0,n?1:0,r||0,i||0),t.emplaceBack(e?1:0,n?1:0,r||0,i||0),t.emplaceBack(e?1:0,n?1:0,r||0,i||0)}const xe=Math.pow(2,25),we=Math.pow(2,24),Ee=Math.pow(2,17),Se=Math.pow(2,16),Te=Math.pow(2,9),Pe=Math.pow(2,8),Me=Math.pow(2,1);function Ce(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;const e=t.placed?1:0,n=Math.floor(127*t.opacity);return n*xe+e*we+n*Ee+e*Se+n*Te+e*Pe+n*Me+e}const Ie=0;class Oe{constructor(t){this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&void 0!==t.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,e,n,r,i){const o=this._bucketParts;for(;this._currentTileIndex<t.length;)if(e.getBucketParts(o,r,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,i())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,o.sort(((t,e)=>t.sortKey-e.sortKey)));this._currentPartIndex<o.length;){const t=o[this._currentPartIndex];if(e.placeLayerBucketPart(t,this._seenCrossTileIDs,n,0===t.symbolInstanceStart),this._currentPartIndex++,i())return!0}return!1}}class Re{constructor(t,e,n,r,i,o,s,a){this.placement=new ve(t,i,o,s,a),this._currentPlacementIndex=e.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=r,this._done=!1}isDone(){return this._done}continuePlacement(e,n,r){const i=t.exported.now(),o=()=>{const e=t.exported.now()-i;return!this._forceFullPlacement&&e>2};for(;this._currentPlacementIndex>=0;){const t=n[e[this._currentPlacementIndex]],i=this.placement.collisionIndex.transform.zoom;if("symbol"===t.type&&(!t.minzoom||t.minzoom<=i)&&(!t.maxzoom||t.maxzoom>i)){if(this._inProgressLayer||(this._inProgressLayer=new Oe(t)),this._inProgressLayer.continuePlacement(r[t.source],this.placement,this._showCollisionBoxes,t,o))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const Le=512/t.EXTENT/2;class ke{constructor(t,e,n){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=n;for(let n=0;n<e.length;n++){const r=e.get(n),i=r.key;this.indexedSymbolInstances[i]||(this.indexedSymbolInstances[i]=[]),this.indexedSymbolInstances[i].push({crossTileID:r.crossTileID,coord:this.getScaledCoordinates(r,t)})}}getScaledCoordinates(e,n){const r=Le/Math.pow(2,n.canonical.z-this.tileID.canonical.z);return{x:Math.floor((n.canonical.x*t.EXTENT+e.tileAnchorX)*r),y:Math.floor((n.canonical.y*t.EXTENT+e.tileAnchorY)*r)}}findMatches(t,e,n){const r=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z);for(let i=0;i<t.length;i++){const o=t.get(i);if(o.crossTileID)continue;const s=this.indexedSymbolInstances[o.key];if(!s)continue;const a=this.getScaledCoordinates(o,e);for(const t of s)if(Math.abs(t.coord.x-a.x)<=r&&Math.abs(t.coord.y-a.y)<=r&&!n[t.crossTileID]){n[t.crossTileID]=!0,o.crossTileID=t.crossTileID;break}}}}class De{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ne{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const e=Math.round((t-this.lng)/360);if(0!==e)for(const t in this.indexes){const n=this.indexes[t],r={};for(const t in n){const i=n[t];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+e),r[i.tileID.key]=i}this.indexes[t]=r}this.lng=t}addBucket(t,e,n){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let t=0;t<e.symbolInstances.length;t++)e.symbolInstances.get(t).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const r=this.usedCrossTileIDs[t.overscaledZ];for(const n in this.indexes){const i=this.indexes[n];if(Number(n)>t.overscaledZ)for(const n in i){const o=i[n];o.tileID.isChildOf(t)&&o.findMatches(e.symbolInstances,t,r)}else{const o=i[t.scaledTo(Number(n)).key];o&&o.findMatches(e.symbolInstances,t,r)}}for(let t=0;t<e.symbolInstances.length;t++){const i=e.symbolInstances.get(t);i.crossTileID||(i.crossTileID=n.generate(),r[i.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new ke(t,e.symbolInstances,e.bucketInstanceId),!0}removeBucketCrossTileIDs(t,e){for(const n in e.indexedSymbolInstances)for(const r of e.indexedSymbolInstances[n])delete this.usedCrossTileIDs[t][r.crossTileID]}removeStaleBuckets(t){let e=!1;for(const n in this.indexes){const r=this.indexes[n];for(const i in r)t[r[i].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,r[i]),delete r[i],e=!0)}return e}}class Fe{constructor(){this.layerIndexes={},this.crossTileIDs=new De,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,e,n){let r=this.layerIndexes[t.id];void 0===r&&(r=this.layerIndexes[t.id]=new Ne);let i=!1;const o={};r.handleWrapJump(n);for(const n of e){const e=n.getBucket(t);e&&t.id===e.layerIds[0]&&(e.bucketInstanceId||(e.bucketInstanceId=++this.maxBucketInstanceId),r.addBucket(n.tileID,e,this.crossTileIDs)&&(i=!0),o[e.bucketInstanceId]=!0)}return r.removeStaleBuckets(o)&&(i=!0),i}pruneUnusedLayers(t){const e={};t.forEach((t=>{e[t]=!0}));for(const t in this.layerIndexes)e[t]||delete this.layerIndexes[t]}}const Be=(e,n)=>t.emitValidationErrors(e,n&&n.filter((t=>"source.canvas"!==t.identifier))),ze=t.pick(Bt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog"]),je=t.pick(Bt,["setCenter","setZoom","setBearing","setPitch"]),Ue=function(){const e={},n=t.spec.$version;for(const r in t.spec.$root){const i=t.spec.$root[r];if(i.required){let t=null;t="version"===r?n:"array"===i.type?[]:{},null!=t&&(e[r]=t)}}return e}(),Ve={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Ge extends t.Evented{constructor(e,n={}){super(),this.map=e,this.dispatcher=new M(Dt(),this),this.imageManager=new m,this.imageManager.setEventedParent(this),this.glyphManager=new t.GlyphManager(e._requestManager,n.localFontFamily?t.LocalGlyphMode.all:n.localIdeographFontFamily?t.LocalGlyphMode.ideographs:t.LocalGlyphMode.none,n.localFontFamily||n.localIdeographFontFamily),this.lineAtlas=new t.LineAtlas(256,512),this.crossTileSymbolIndex=new Fe,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new t.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",t.getReferrer());const r=this;this._rtlTextPluginCallback=Ge.registerForPluginStateChange((e=>{r.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:e.pluginStatus,pluginURL:e.pluginURL},((e,n)=>{if(t.triggerPluginCompletionEvent(e),n&&n.every((t=>t)))for(const t in r._sourceCaches){const e=r._sourceCaches[t],n=e.getSource().type;"vector"!==n&&"geojson"!==n||e.reload()}}))})),this.on("data",(t=>{if("source"!==t.dataType||"metadata"!==t.sourceDataType)return;const e=this.getSource(t.sourceId);if(e&&e.vectorLayerIds)for(const t in this._layers){const n=this._layers[t];n.source===e.id&&this._validateLayer(n)}}))}loadURL(e,n={}){this.fire(new t.Event("dataloading",{dataType:"style"}));const r="boolean"==typeof n.validate?n.validate:!t.isMapboxURL(e);e=this.map._requestManager.normalizeStyleURL(e,n.accessToken);const i=this.map._requestManager.transformRequest(e,t.ResourceType.Style);this._request=t.getJSON(i,((e,n)=>{this._request=null,e?this.fire(new t.ErrorEvent(e)):n&&this._load(n,r)}))}loadJSON(e,n={}){this.fire(new t.Event("dataloading",{dataType:"style"})),this._request=t.exported.frame((()=>{this._request=null,this._load(e,!1!==n.validate)}))}loadEmpty(){this.fire(new t.Event("dataloading",{dataType:"style"})),this._load(Ue,!1)}_updateLayerCount(t,e){const n=e?1:-1;t.is3D()&&(this._num3DLayers+=n),"circle"===t.type&&(this._numCircleLayers+=n),"symbol"===t.type&&(this._numSymbolLayers+=n)}_load(e,n){if(n&&Be(this,t.validateStyle(e)))return;this._loaded=!0,this.stylesheet=e;for(const t in e.sources)this.addSource(t,e.sources[t],{validate:!1});this._changed=!1,e.sprite?this._loadSprite(e.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(e.glyphs);const r=Ft(this.stylesheet.layers);this._order=r.map((t=>t.id)),this._layers={},this._serializedLayers={};for(let e of r)e=t.createStyleLayer(e),e.setEventedParent(this,{layer:{id:e.id}}),this._layers[e.id]=e,this._serializedLayers[e.id]=e.serialize(),this._updateLayerCount(e,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new _(this.stylesheet.light),this.stylesheet.terrain&&this._createTerrain(this.stylesheet.terrain),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new t.Event("data",{dataType:"style"})),this.fire(new t.Event("style.load"))}_loadSprite(e){this._spriteRequest=function(e,n,r){let i,o,s;const a=t.exported.devicePixelRatio>1?"@2x":"";let l=t.getJSON(n.transformRequest(n.normalizeSpriteURL(e,a,".json"),t.ResourceType.SpriteJSON),((t,e)=>{l=null,s||(s=t,i=e,c())})),u=t.getImage(n.transformRequest(n.normalizeSpriteURL(e,a,".png"),t.ResourceType.SpriteImage),((t,e)=>{u=null,s||(s=t,o=e,c())}));function c(){if(s)r(s);else if(i&&o){const e=t.exported.getImageData(o),n={};for(const r in i){const{width:o,height:s,x:a,y:l,sdf:u,pixelRatio:c,stretchX:h,stretchY:p,content:f}=i[r],d=new t.RGBAImage({width:o,height:s});t.RGBAImage.copy(e,d,{x:a,y:l},{x:0,y:0},{width:o,height:s}),n[r]={data:d,pixelRatio:c,sdf:u,stretchX:h,stretchY:p,content:f}}r(null,n)}}return{cancel(){l&&(l.cancel(),l=null),u&&(u.cancel(),u=null)}}}(e,this.map._requestManager,((e,n)=>{if(this._spriteRequest=null,e)this.fire(new t.ErrorEvent(e));else if(n)for(const t in n)this.imageManager.addImage(t,n[t]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new t.Event("data",{dataType:"style"}))}))}_validateLayer(e){const n=this.getSource(e.source);if(!n)return;const r=e.sourceLayer;r&&("geojson"===n.type||n.vectorLayerIds&&-1===n.vectorLayerIds.indexOf(r))&&this.fire(new t.ErrorEvent(new Error(`Source layer "${r}" does not exist on source "${n.id}" as specified by style layer "${e.id}"`)))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(const t in this._sourceCaches)if(!this._sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(t){const e=[];for(const n of t){const t=this._layers[n];"custom"!==t.type&&e.push(t.serialize())}return e}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;if(this.fog&&this.fog.hasTransition())return!0;for(const t in this._sourceCaches)if(this._sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(t){return!!this.terrain&&Ve[t.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(e){if(!this._loaded)return;const n=this._changed;if(this._changed){const t=Object.keys(this._updatedLayers),n=Object.keys(this._removedLayers);(t.length||n.length)&&this._updateWorkerLayers(t,n);for(const t in this._updatedSources){const e=this._updatedSources[t];"reload"===e?this._reloadSource(t):"clear"===e&&this._clearSource(t)}this._updateTilesForChangedImages();for(const t in this._updatedPaintProps)this._layers[t].updateTransitions(e);this.light.updateTransitions(e),this.fog&&this.fog.updateTransitions(e),this._resetUpdates()}const r={};for(const t in this._sourceCaches){const e=this._sourceCaches[t];r[t]=e.used,e.used=!1}for(const t of this._order){const n=this._layers[t];if(n.recalculate(e,this._availableImages),!n.isHidden(e.zoom)){const t=this._getLayerSourceCache(n);t&&(t.used=!0)}const r=this.map.painter;if(r){const t=n.getProgramIds();if(!t)continue;const i=n.getProgramConfiguration(e.zoom);for(const e of t)r.useProgram(e,i)}}for(const e in r){const n=this._sourceCaches[e];r[e]!==n.used&&n.getSource().fire(new t.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:n.getSource().id}))}this.light.recalculate(e),this.terrain&&this.terrain.recalculate(e),this.fog&&this.fog.recalculate(e),this.z=e.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),n&&this.fire(new t.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const e in this._sourceCaches)this._sourceCaches[e].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateWorkerLayers(t,e){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:e})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(e){if(this._checkLoaded(),Be(this,t.validateStyle(e)))return!1;(e=t.clone$2(e)).layers=Ft(e.layers);const n=function(t,e){if(!t)return[{command:Bt.setStyle,args:[e]}];let n=[];try{if(!i(t.version,e.version))return[{command:Bt.setStyle,args:[e]}];i(t.center,e.center)||n.push({command:Bt.setCenter,args:[e.center]}),i(t.zoom,e.zoom)||n.push({command:Bt.setZoom,args:[e.zoom]}),i(t.bearing,e.bearing)||n.push({command:Bt.setBearing,args:[e.bearing]}),i(t.pitch,e.pitch)||n.push({command:Bt.setPitch,args:[e.pitch]}),i(t.sprite,e.sprite)||n.push({command:Bt.setSprite,args:[e.sprite]}),i(t.glyphs,e.glyphs)||n.push({command:Bt.setGlyphs,args:[e.glyphs]}),i(t.transition,e.transition)||n.push({command:Bt.setTransition,args:[e.transition]}),i(t.light,e.light)||n.push({command:Bt.setLight,args:[e.light]}),i(t.fog,e.fog)||n.push({command:Bt.setFog,args:[e.fog]});const r={},o=[];!function(t,e,n,r){let o;for(o in e=e||{},t=t||{})t.hasOwnProperty(o)&&(e.hasOwnProperty(o)||jt(o,n,r));for(o in e)e.hasOwnProperty(o)&&(t.hasOwnProperty(o)?i(t[o],e[o])||("geojson"===t[o].type&&"geojson"===e[o].type&&Vt(t,e,o)?n.push({command:Bt.setGeoJSONSourceData,args:[o,e[o].data]}):Ut(o,e,n,r)):zt(o,e,n))}(t.sources,e.sources,o,r);const s=[];t.layers&&t.layers.forEach((t=>{r[t.source]?n.push({command:Bt.removeLayer,args:[t.id]}):s.push(t)}));let a=t.terrain;a&&r[a.source]&&(n.push({command:Bt.setTerrain,args:[void 0]}),a=void 0),n=n.concat(o),i(a,e.terrain)||n.push({command:Bt.setTerrain,args:[e.terrain]}),function(t,e,n){e=e||[];const r=(t=t||[]).map(Zt),o=e.map(Zt),s=t.reduce(qt,{}),a=e.reduce(qt,{}),l=r.slice(),u=Object.create(null);let c,h,p,f,d,g,m;for(c=0,h=0;c<r.length;c++)p=r[c],a.hasOwnProperty(p)?h++:(n.push({command:Bt.removeLayer,args:[p]}),l.splice(l.indexOf(p,h),1));for(c=0,h=0;c<o.length;c++)p=o[o.length-1-c],l[l.length-1-c]!==p&&(s.hasOwnProperty(p)?(n.push({command:Bt.removeLayer,args:[p]}),l.splice(l.lastIndexOf(p,l.length-h),1)):h++,g=l[l.length-c],n.push({command:Bt.addLayer,args:[a[p],g]}),l.splice(l.length-c,0,p),u[p]=!0);for(c=0;c<o.length;c++)if(p=o[c],f=s[p],d=a[p],!u[p]&&!i(f,d))if(i(f.source,d.source)&&i(f["source-layer"],d["source-layer"])&&i(f.type,d.type)){for(m in Gt(f.layout,d.layout,n,p,null,Bt.setLayoutProperty),Gt(f.paint,d.paint,n,p,null,Bt.setPaintProperty),i(f.filter,d.filter)||n.push({command:Bt.setFilter,args:[p,d.filter]}),i(f.minzoom,d.minzoom)&&i(f.maxzoom,d.maxzoom)||n.push({command:Bt.setLayerZoomRange,args:[p,d.minzoom,d.maxzoom]}),f)f.hasOwnProperty(m)&&"layout"!==m&&"paint"!==m&&"filter"!==m&&"metadata"!==m&&"minzoom"!==m&&"maxzoom"!==m&&(0===m.indexOf("paint.")?Gt(f[m],d[m],n,p,m.slice(6),Bt.setPaintProperty):i(f[m],d[m])||n.push({command:Bt.setLayerProperty,args:[p,m,d[m]]}));for(m in d)d.hasOwnProperty(m)&&!f.hasOwnProperty(m)&&"layout"!==m&&"paint"!==m&&"filter"!==m&&"metadata"!==m&&"minzoom"!==m&&"maxzoom"!==m&&(0===m.indexOf("paint.")?Gt(f[m],d[m],n,p,m.slice(6),Bt.setPaintProperty):i(f[m],d[m])||n.push({command:Bt.setLayerProperty,args:[p,m,d[m]]}))}else n.push({command:Bt.removeLayer,args:[p]}),g=l[l.lastIndexOf(p)+1],n.push({command:Bt.addLayer,args:[d,g]})}(s,e.layers,n)}catch(t){console.warn("Unable to compute style diff:",t),n=[{command:Bt.setStyle,args:[e]}]}return n}(this.serialize(),e).filter((t=>!(t.command in je)));if(0===n.length)return!1;const r=n.filter((t=>!(t.command in ze)));if(r.length>0)throw new Error(`Unimplemented: ${r.map((t=>t.command)).join(", ")}.`);return n.forEach((t=>{"setTransition"!==t.command&&this[t.command].apply(this,t.args)})),this.stylesheet=e,!0}addImage(e,n){if(this.getImage(e))return this.fire(new t.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(e,n),this._afterImageUpdated(e)}updateImage(t,e){this.imageManager.updateImage(t,e)}getImage(t){return this.imageManager.getImage(t)}removeImage(e){if(!this.getImage(e))return this.fire(new t.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new t.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,n,r={}){if(this._checkLoaded(),void 0!==this.getSource(e))throw new Error("There is already a source with this ID");if(!n.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(n).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(t.validateStyle.source,`sources.${e}`,n,null,r))return;this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);const i=Tt(e,n,this.dispatcher,this);i.setEventedParent(this,(()=>({isSourceLoaded:this.loaded(),source:i.serialize(),sourceId:e})));const o=n=>{const r=(n?"symbol:":"other:")+e,o=this._sourceCaches[r]=new t.SourceCache(r,i,n);(n?this._symbolSourceCaches:this._otherSourceCaches)[e]=o,o.style=this,o.onAdd(this.map)};o(!1),"vector"!==n.type&&"geojson"!==n.type||o(!0),i.onAdd&&i.onAdd(this.map),this._changed=!0}removeSource(e){this._checkLoaded();const n=this.getSource(e);if(void 0===n)throw new Error("There is no source with this ID");for(const n in this._layers)if(this._layers[n].source===e)return this.fire(new t.ErrorEvent(new Error(`Source "${e}" cannot be removed while layer "${n}" is using it.`)));if(this.terrain&&this.terrain.get().source===e)return this.fire(new t.ErrorEvent(new Error(`Source "${e}" cannot be removed while terrain is using it.`)));const r=this._getSourceCaches(e);for(const e of r)delete this._sourceCaches[e.id],delete this._updatedSources[e.id],e.fire(new t.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:e.getSource().id})),e.setEventedParent(null),e.clearTiles();delete this._otherSourceCaches[e],delete this._symbolSourceCaches[e],n.setEventedParent(null),n.onRemove&&n.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,e){this._checkLoaded(),this.getSource(t).setData(e),this._changed=!0}getSource(t){const e=this._getSourceCache(t);return e&&e.getSource()}addLayer(e,n,r={}){this._checkLoaded();const i=e.id;if(this.getLayer(i))return void this.fire(new t.ErrorEvent(new Error(`Layer with id "${i}" already exists on this map`)));let o;if("custom"===e.type){if(Be(this,t.validateCustomStyleLayer(e)))return;o=t.createStyleLayer(e)}else{if("object"==typeof e.source&&(this.addSource(i,e.source),e=t.clone$2(e),e=t.extend(e,{source:i})),this._validate(t.validateStyle.layer,`layers.${i}`,e,{arrayIndex:-1},r))return;o=t.createStyleLayer(e),this._validateLayer(o),o.setEventedParent(this,{layer:{id:i}}),this._serializedLayers[o.id]=o.serialize(),this._updateLayerCount(o,!0)}const s=n?this._order.indexOf(n):this._order.length;if(n&&-1===s)return void this.fire(new t.ErrorEvent(new Error(`Layer with id "${n}" does not exist on this map.`)));this._order.splice(s,0,i),this._layerOrderChanged=!0,this._layers[i]=o;const a=this._getLayerSourceCache(o);if(this._removedLayers[i]&&o.source&&a&&"custom"!==o.type){const t=this._removedLayers[i];delete this._removedLayers[i],t.type!==o.type?this._updatedSources[o.source]="clear":(this._updatedSources[o.source]="reload",a.pause())}this._updateLayer(o),o.onAdd&&o.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(e,n){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===n)return;const r=this._order.indexOf(e);this._order.splice(r,1);const i=n?this._order.indexOf(n):this._order.length;n&&-1===i?this.fire(new t.ErrorEvent(new Error(`Layer with id "${n}" does not exist on this map.`))):(this._order.splice(i,0,e),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(e){this._checkLoaded();const n=this._layers[e];if(!n)return void this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot be removed.`)));n.setEventedParent(null),this._updateLayerCount(n,!1);const r=this._order.indexOf(e);this._order.splice(r,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=n,delete this._layers[e],delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],n.onRemove&&n.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(t){return this._layers[t]}hasLayer(t){return t in this._layers}hasLayerType(t){for(const e in this._layers)if(this._layers[e].type===t)return!0;return!1}setLayerZoomRange(e,n,r){this._checkLoaded();const i=this.getLayer(e);i?i.minzoom===n&&i.maxzoom===r||(null!=n&&(i.minzoom=n),null!=r&&(i.maxzoom=r),this._updateLayer(i)):this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(e,n,r={}){this._checkLoaded();const o=this.getLayer(e);if(o){if(!i(o.filter,n))return null==n?(o.filter=void 0,void this._updateLayer(o)):void(this._validate(t.validateStyle.filter,`layers.${o.id}.filter`,n,null,r)||(o.filter=t.clone$2(n),this._updateLayer(o)))}else this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot be filtered.`)))}getFilter(e){return t.clone$2(this.getLayer(e).filter)}setLayoutProperty(e,n,r,o={}){this._checkLoaded();const s=this.getLayer(e);s?i(s.getLayoutProperty(n),r)||(s.setLayoutProperty(n,r,o),this._updateLayer(s)):this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(e,n){const r=this.getLayer(e);if(r)return r.getLayoutProperty(n);this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style.`)))}setPaintProperty(e,n,r,o={}){this._checkLoaded();const s=this.getLayer(e);s?i(s.getPaintProperty(n),r)||(s.setPaintProperty(n,r,o)&&this._updateLayer(s),this._changed=!0,this._updatedPaintProps[e]=!0):this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(t,e){return this.getLayer(t).getPaintProperty(e)}setFeatureState(e,n){this._checkLoaded();const r=e.source,i=e.sourceLayer,o=this.getSource(r);if(void 0===o)return void this.fire(new t.ErrorEvent(new Error(`The source '${r}' does not exist in the map's style.`)));const s=o.type;if("geojson"===s&&i)return void this.fire(new t.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===s&&!i)return void this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided.")));const a=this._getSourceCaches(r);for(const t of a)t.setFeatureState(i,e.id,n)}removeFeatureState(e,n){this._checkLoaded();const r=e.source,i=this.getSource(r);if(void 0===i)return void this.fire(new t.ErrorEvent(new Error(`The source '${r}' does not exist in the map's style.`)));const o=i.type,s="vector"===o?e.sourceLayer:void 0;if("vector"===o&&!s)return void this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(n&&"string"!=typeof e.id&&"number"!=typeof e.id)return void this.fire(new t.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const a=this._getSourceCaches(r);for(const t of a)t.removeFeatureState(s,e.id,n)}getFeatureState(e){this._checkLoaded();const n=e.source,r=e.sourceLayer,i=this.getSource(n);if(void 0!==i){if("vector"!==i.type||r)return void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(n)[0].getFeatureState(r,e.id);this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error(`The source '${n}' does not exist in the map's style.`)))}getTransition(){return t.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const e={};for(const t in this._sourceCaches){const n=this._sourceCaches[t].getSource();e[n.id]||(e[n.id]=n.serialize())}return t.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e,layers:this._serializeLayers(this._order)},(t=>void 0!==t))}_updateLayer(t){this._updatedLayers[t.id]=!0;const e=this._getLayerSourceCache(t);t.source&&!this._updatedSources[t.source]&&e&&"raster"!==e.getSource().type&&(this._updatedSources[t.source]="reload",e.pause()),this._changed=!0}_flattenAndSortRenderedFeatures(t){const e=t=>"fill-extrusion"===this._layers[t].type,n={},r=[];for(let i=this._order.length-1;i>=0;i--){const o=this._order[i];if(e(o)){n[o]=i;for(const e of t){const t=e[o];if(t)for(const e of t)r.push(e)}}}r.sort(((t,e)=>e.intersectionZ-t.intersectionZ));const i=[];for(let o=this._order.length-1;o>=0;o--){const s=this._order[o];if(e(s))for(let t=r.length-1;t>=0;t--){const e=r[t].feature;if(n[e.layer.id]<o)break;i.push(e),r.pop()}else for(const e of t){const t=e[s];if(t)for(const e of t)i.push(e.feature)}}return i}queryRenderedFeatures(e,n,r){n&&n.filter&&this._validate(t.validateStyle.filter,"queryRenderedFeatures.filter",n.filter,null,n);const i={};if(n&&n.layers){if(!Array.isArray(n.layers))return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const e of n.layers){const n=this._layers[e];if(!n)return this.fire(new t.ErrorEvent(new Error(`The layer '${e}' does not exist in the map's style and cannot be queried for features.`))),[];i[n.source]=!0}}const o=[];n.availableImages=this._availableImages;const s=n&&n.layers?n.layers.some((t=>{const e=this.getLayer(t);return e&&e.is3D()})):this.has3DLayers(),a=I.createFromScreenPoints(e,r);for(const t in this._sourceCaches){const e=this._sourceCaches[t].getSource().id;n.layers&&!i[e]||o.push(Mt(this._sourceCaches[t],this._layers,this._serializedLayers,a,n,r,s,!!this.map._showQueryGeometry))}return this.placement&&o.push(function(t,e,n,r,i,o,s){const a={},l=o.queryRenderedSymbols(r),u=[];for(const t of Object.keys(l).map(Number))u.push(s[t]);u.sort(It);for(const n of u){const r=n.featureIndex.lookupSymbolFeatures(l[n.bucketInstanceId],e,n.bucketIndex,n.sourceLayerIndex,i.filter,i.layers,i.availableImages,t);for(const t in r){const e=a[t]=a[t]||[],i=r[t];i.sort(((t,e)=>{const r=n.featureSortOrder;if(r){const n=r.indexOf(t.featureIndex);return r.indexOf(e.featureIndex)-n}return e.featureIndex-t.featureIndex}));for(const t of i)e.push(t)}}for(const e in a)a[e].forEach((r=>{const i=r.feature,o=n(t[e]).getFeatureState(i.layer["source-layer"],i.id);i.source=i.layer.source,i.layer["source-layer"]&&(i.sourceLayer=i.layer["source-layer"]),i.state=o}));return a}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),a.screenGeometry,n,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(o)}querySourceFeatures(e,n){n&&n.filter&&this._validate(t.validateStyle.filter,"querySourceFeatures.filter",n.filter,null,n);const r=this._getSourceCaches(e);let i=[];for(const t of r)i=i.concat(Ct(t,n));return i}addSourceType(t,e,n){return Ge.getSourceType(t)?n(new Error(`A source type called "${t}" already exists.`)):(Ge.setSourceType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},n):n(null,null))}getLight(){return this.light.getLight()}setLight(e,n={}){this._checkLoaded();const r=this.light.getLight();let o=!1;for(const t in e)if(!i(e[t],r[t])){o=!0;break}if(!o)return;const s={now:t.exported.now(),transition:t.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,n),this.light.updateTransitions(s)}getTerrain(){return this.terrain?this.terrain.get():null}setTerrain(e){if(this._checkLoaded(),!e)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if("object"==typeof e.source){const n="terrain-dem-src";this.addSource(n,e.source),e=t.clone$2(e),e=t.extend(e,{source:n})}if(!this._validate(t.validateStyle.terrain,"terrain",e)){if(this.terrain){const n=this.terrain,r=n.get();for(const o in e)if(!i(e[o],r[o])){n.set(e),this.stylesheet.terrain=e;const r={now:t.exported.now(),transition:t.extend({duration:0},this.stylesheet.transition)};n.updateTransitions(r);break}}else this._createTerrain(e);this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}}_createFog(e){const n=this.fog=new P(e);this.stylesheet.fog=e;const r={now:t.exported.now(),transition:t.extend({duration:0},this.stylesheet.transition)};n.updateTransitions(r)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask((()=>{for(const t of this.map._markers)t._evaluateOpacity()}))}getFog(){return this.fog?this.fog.get():null}setFog(e){if(this._checkLoaded(),!e)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const n=this.fog,r=n.get();for(const o in e)if(!i(e[o],r[o])){n.set(e),this.stylesheet.fog=e;const r={now:t.exported.now(),transition:t.extend({duration:0},this.stylesheet.transition)};n.updateTransitions(r);break}}else this._createFog(e);this._markersNeedUpdate=!0}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const t=this._order.filter((t=>this.isLayerDraped(this._layers[t]))),e=this._order.filter((t=>!this.isLayerDraped(this._layers[t])));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...t),this._drapedFirstOrder.push(...e)}_createTerrain(e){const n=this.terrain=new x(e);this.stylesheet.terrain=e,this.dispatcher.broadcast("enableTerrain",!0),this._force3DLayerUpdate();const r={now:t.exported.now(),transition:t.extend({duration:0},this.stylesheet.transition)};n.updateTransitions(r)}_force3DLayerUpdate(){for(const t in this._layers){const e=this._layers[t];"fill-extrusion"===e.type&&this._updateLayer(e)}}_validate(e,n,r,i,o={}){return(!o||!1!==o.validate)&&Be(this,e.call(t.validateStyle,t.extend({key:n,style:this.serialize(),value:r,styleSpec:t.spec},i)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),t.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this._sourceCaches)this._sourceCaches[t].clearTiles(),this._sourceCaches[t].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(t){const e=this._getSourceCaches(t);for(const t of e)t.clearTiles()}_reloadSource(t){const e=this._getSourceCaches(t);for(const t of e)t.resume(),t.reload()}_updateSources(t){for(const e in this._sourceCaches)this._sourceCaches[e].update(t)}_generateCollisionBoxes(){for(const t in this._sourceCaches){const e=this._sourceCaches[t];e.resume(),e.reload()}}_updatePlacement(e,n,r,i,o=!1){let s=!1,a=!1;const l={};for(const t of this._order){const n=this._layers[t];if("symbol"!==n.type)continue;if(!l[n.source]){const t=this._getLayerSourceCache(n);if(!t)continue;l[n.source]=t.getRenderableIds(!0).map((e=>t.getTileByID(e))).sort(((t,e)=>e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1)))}const r=this.crossTileSymbolIndex.addLayer(n,l[n.source],e.center.lng);s=s||r}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),o=o||this._layerOrderChanged||0===r,this._layerOrderChanged&&this.fire(new t.Event("neworder")),(o||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(t.exported.now(),e.zoom))&&(this.pauseablePlacement=new Re(e,this._order,o,n,r,i,this.placement,this.fog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(t.exported.now()),a=!0),s&&this.pauseablePlacement.placement.setStale()),a||s)for(const t of this._order){const e=this._layers[t];"symbol"===e.type&&this.placement.updateLayerOpacities(e,l[e.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(t.exported.now())}_releaseSymbolFadeTiles(){for(const t in this._sourceCaches)this._sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,e,n){this.imageManager.getImages(e.icons,n),this._updateTilesForChangedImages();const r=t=>{t&&t.setDependencies(e.tileID.key,e.type,e.icons)};r(this._otherSourceCaches[e.source]),r(this._symbolSourceCaches[e.source])}getGlyphs(t,e,n){this.glyphManager.getGlyphs(e.stacks,n)}getResource(e,n,r){return t.makeRequest(n,r)}_getSourceCache(t){return this._otherSourceCaches[t]}_getLayerSourceCache(t){return"symbol"===t.type?this._symbolSourceCaches[t.source]:this._otherSourceCaches[t.source]}_getSourceCaches(t){const e=[];return this._otherSourceCaches[t]&&e.push(this._otherSourceCaches[t]),this._symbolSourceCaches[t]&&e.push(this._symbolSourceCaches[t]),e}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}}Ge.getSourceType=function(t){return St[t]},Ge.setSourceType=function(t,e){St[t]=e},Ge.registerForPluginStateChange=t.registerForPluginStateChange;var Ze="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}\n#endif",qe="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}";let We={},He={};We=Qe("","\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec3 elevationVector(vec2 pos) {vec2 uv=pos/8192.0;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {return currentElevation(apos);}\n#endif\nfloat unpack_depth(vec4 rgba_depth)\n{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif",!0),He=Qe("#ifdef FOG\nuniform float u_fog_temporal_offset;float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif","#ifdef FOG\nuniform mat4 u_fog_matrix;vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",!0);const Xe=Qe("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}\n#ifdef TERRAIN\nhighp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),$e=Ze;var Ye={background:Qe("uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:Qe("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:Qe("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);vec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nvec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:Qe("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Qe("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\ngl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec3 pos=vec3(floor(a_pos*0.5)+extrude,elevation(floor(a_pos*0.5)));gl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:Qe("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Qe("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Qe("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Qe("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);}"),fill:Qe("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:Qe("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:Qe("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:Qe("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:Qe("varying vec4 v_color;void main() {vec4 color=v_color;\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);\n#else\nvec3 pos=vec3(pos_nx.xy,t > 0.0 ? height : base);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:Qe("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);\n#else\nvec3 p=vec3(pos_nx.xy,z);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:Qe("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Qe("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:Qe("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;varying highp vec2 v_uv;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash_from\n#pragma mapbox: initialize lowp vec4 dash_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\n#ifdef RENDER_LINE_GRADIENT\nvec4 out_color=texture2D(u_gradient_image,v_uv);\n#else\nvec4 out_color=color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#ifdef RENDER_LINE_GRADIENT\nattribute vec3 a_packed;\n#else\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;varying highp vec2 v_uv;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash_from\n#pragma mapbox: initialize lowp vec4 dash_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];float a_linesofar=a_packed[2];highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);\n#endif\n#ifdef RENDER_LINE_DASH\nfloat tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:Qe("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:Qe("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:Qe("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec4 projectedPoint=u_matrix*vec4(vec3(a_pos,anchorZ)+h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}\n#ifdef PROJECTED_POS_ON_VIEWPORT\nvec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(vec3(a_projected_pos.xy,anchorZ)+h,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));}"),symbolSDF:Qe("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec4 projectedPoint=u_matrix*vec4(vec3(a_pos,anchorZ)+h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}\n#ifdef PROJECTED_POS_ON_VIEWPORT\nvec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(vec3(a_projected_pos.xy,anchorZ)+h,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:Qe("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec4 projectedPoint=u_matrix*vec4(vec3(a_pos,anchorZ)+h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}\n#ifdef PROJECTED_POS_ON_VIEWPORT\nvec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(vec3(a_projected_pos.xy,anchorZ)+h,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrainRaster:Qe("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef FOG\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\nconst float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=u_skirt_height*u_skirt_height*wireframeOffset;\n#endif\nvec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n}"),terrainDepth:Qe("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Qe("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",qe),skyboxGradient:Qe("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",qe),skyboxCapture:Qe("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Qe("uniform sampler2D u_image0;varying vec2 v_pos0;void main() {vec4 color=texture2D(u_image0,v_pos0);gl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_globe_matrix;attribute vec3 a_globe_pos;attribute vec2 a_uv;varying vec2 v_pos0;void main() {v_pos0=a_uv;gl_Position=u_globe_matrix*vec4(a_globe_pos+elevationVector(a_uv*8192.0)*elevation(a_uv*8192.0),1.0);}"),globeAtmosphere:Qe("uniform vec2 u_center;uniform float u_radius;uniform vec2 u_screen_size;uniform float u_opacity;uniform float u_fadeout_range;uniform vec3 u_start_color;uniform vec3 u_end_color;uniform float u_pixel_ratio;void main() {vec2 fragCoord=gl_FragCoord.xy/u_pixel_ratio;fragCoord.y=u_screen_size.y-fragCoord.y;float distFromCenter=length(fragCoord-u_center);float normDistFromCenter=length(fragCoord-u_center)/u_radius;if (normDistFromCenter < 1.0)\ndiscard;float t=clamp(1.0-sqrt(normDistFromCenter-1.0)/u_fadeout_range,0.0,1.0);vec3 color=mix(u_start_color,u_end_color,1.0-t);gl_FragColor=vec4(color*t*u_opacity,u_opacity);}","attribute vec3 a_pos;void main() {gl_Position=vec4(a_pos,1.0);}"),globeDepth:Qe("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_globe_matrix;attribute vec3 a_globe_pos;attribute vec2 a_uv;varying float v_depth;void main() {gl_Position=u_globe_matrix*vec4(a_globe_pos+elevationVector(a_uv*8192.0)*elevation(a_uv*8192.0),1.0);v_depth=gl_Position.z/gl_Position.w;}")};function Qe(t,e,n){const r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,i=/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g,o=e.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),s=t.match(i),a=e.match(i),l=Ze.match(i);let u=a?a.concat(s):s;n||(We.staticUniforms&&(u=We.staticUniforms.concat(u)),He.staticUniforms&&(u=He.staticUniforms.concat(u))),u&&(u=u.concat(l));const c={};return{fragmentSource:t=t.replace(r,((t,e,n,r,i)=>(c[i]=!0,"define"===e?`\n#ifndef HAS_UNIFORM_u_${i}\nvarying ${n} ${r} ${i};\n#else\nuniform ${n} ${r} u_${i};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${i}\n    ${n} ${r} ${i} = u_${i};\n#endif\n`))),vertexSource:e=e.replace(r,((t,e,n,r,i)=>{const o="float"===r?"vec2":"vec4",s=i.match(/color/)?"color":o;return c[i]?"define"===e?`\n#ifndef HAS_UNIFORM_u_${i}\nuniform lowp float u_${i}_t;\nattribute ${n} ${o} a_${i};\nvarying ${n} ${r} ${i};\n#else\nuniform ${n} ${r} u_${i};\n#endif\n`:"vec4"===s?`\n#ifndef HAS_UNIFORM_u_${i}\n    ${i} = a_${i};\n#else\n    ${n} ${r} ${i} = u_${i};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${i}\n    ${i} = unpack_mix_${s}(a_${i}, u_${i}_t);\n#else\n    ${n} ${r} ${i} = u_${i};\n#endif\n`:"define"===e?`\n#ifndef HAS_UNIFORM_u_${i}\nuniform lowp float u_${i}_t;\nattribute ${n} ${o} a_${i};\n#else\nuniform ${n} ${r} u_${i};\n#endif\n`:"vec4"===s?`\n#ifndef HAS_UNIFORM_u_${i}\n    ${n} ${r} ${i} = a_${i};\n#else\n    ${n} ${r} ${i} = u_${i};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${i}\n    ${n} ${r} ${i} = unpack_mix_${s}(a_${i}, u_${i}_t);\n#else\n    ${n} ${r} ${i} = u_${i};\n#endif\n`})),staticAttributes:o,staticUniforms:u}}class Ke{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,e,n,r,i,o,s,a){this.context=t;let l=this.boundPaintVertexBuffers.length!==r.length;for(let t=0;!l&&t<r.length;t++)this.boundPaintVertexBuffers[t]!==r[t]&&(l=!0);t.extVertexArrayObject&&this.vao&&this.boundProgram===e&&this.boundLayoutVertexBuffer===n&&!l&&this.boundIndexBuffer===i&&this.boundVertexOffset===o&&this.boundDynamicVertexBuffer===s&&this.boundDynamicVertexBuffer2===a?(t.bindVertexArrayOES.set(this.vao),s&&s.bind(),i&&i.dynamicDraw&&i.bind(),a&&a.bind()):this.freshBind(e,n,r,i,o,s,a)}freshBind(t,e,n,r,i,o,s){let a;const l=t.numAttributes,u=this.context,c=u.gl;if(u.extVertexArrayObject)this.vao&&this.destroy(),this.vao=u.extVertexArrayObject.createVertexArrayOES(),u.bindVertexArrayOES.set(this.vao),a=0,this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=r,this.boundVertexOffset=i,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=s;else{a=u.currentNumAttributes||0;for(let t=l;t<a;t++)c.disableVertexAttribArray(t)}e.enableAttributes(c,t);for(const e of n)e.enableAttributes(c,t);o&&o.enableAttributes(c,t),s&&s.enableAttributes(c,t),e.bind(),e.setVertexAttribPointers(c,t,i);for(const e of n)e.bind(),e.setVertexAttribPointers(c,t,i);o&&(o.bind(),o.setVertexAttribPointers(c,t,i)),r&&r.bind(),s&&(s.bind(),s.setVertexAttribPointers(c,t,i)),u.currentNumAttributes=l}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Je(e,n){const r=Math.pow(2,n.canonical.z),i=n.canonical.y;return[new t.MercatorCoordinate(0,i/r).toLngLat().lat,new t.MercatorCoordinate(0,(i+1)/r).toLngLat().lat]}function tn(e,n,r,i,o,s,a){const l=e.context,u=l.gl,c=r.fbo;if(!c)return;e.prepareDrawTile(n);const h=e.useProgram("hillshade");l.activeTexture.set(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,c.colorAttachment.get());const p=((t,e,n,r)=>{const i=n.paint.get("hillshade-shadow-color"),o=n.paint.get("hillshade-highlight-color"),s=n.paint.get("hillshade-accent-color");let a=n.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===n.paint.get("hillshade-illumination-anchor")&&(a-=t.transform.angle);const l=!t.options.moving;return{u_matrix:r||t.transform.calculateProjMatrix(e.tileID.toUnwrapped(),l),u_image:0,u_latrange:Je(0,e.tileID),u_light:[n.paint.get("hillshade-exaggeration"),a],u_shadow:i,u_highlight:o,u_accent:s}})(e,r,i,e.terrain?n.projMatrix:null);e.prepareDrawProgram(l,h,n.toUnwrapped()),h.draw(l,u.TRIANGLES,o,s,a,t.CullFaceMode.disabled,p,i.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}function en(e,n,r){if(!n.needsDEMTextureUpload)return;const i=e.context,o=i.gl;i.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||e.getTileTexture(r.stride);const s=r.getPixels();n.demTexture?n.demTexture.update(s,{premultiply:!1}):n.demTexture=new t.Texture(i,s,o.RGBA,{premultiply:!1}),n.needsDEMTextureUpload=!1}function nn(e,n,r,i,o,s){const a=e.context,l=a.gl;if(!n.dem)return;const u=n.dem;if(a.activeTexture.set(l.TEXTURE1),en(e,n,u),!n.demTexture)return;n.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);const c=u.dim;a.activeTexture.set(l.TEXTURE0);let h=n.fbo;if(!h){const e=new t.Texture(a,{width:c,height:c,data:null},l.RGBA);e.bind(l.LINEAR,l.CLAMP_TO_EDGE),h=n.fbo=a.createFramebuffer(c,c,!0),h.colorAttachment.set(e.texture)}a.bindFramebuffer.set(h.framebuffer),a.viewport.set([0,0,c,c]),e.useProgram("hillshadePrepare").draw(a,l.TRIANGLES,i,o,s,t.CullFaceMode.disabled,((e,n)=>{const r=n.stride,i=t.create$1();return t.ortho(i,0,t.EXTENT,-t.EXTENT,0,0,1),t.translate(i,i,[0,-t.EXTENT,0]),{u_matrix:i,u_image:1,u_dimension:[r,r],u_zoom:e.overscaledZ,u_unpack:n.unpackVector}})(n.tileID,u),r.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments),n.needsHillshadePrepare=!1}const rn=(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image0:new t.Uniform1i(e,n.u_image0),u_skirt_height:new t.Uniform1f(e,n.u_skirt_height)}),on=(t,e)=>({u_matrix:t,u_image0:0,u_skirt_height:e}),sn=new class{constructor(){this.operations={}}newMorphing(t,e,n,r,i){if(t in this.operations){const e=this.operations[t];e.to.tileID.key!==n.tileID.key&&(e.queued=n)}else this.operations[t]={startTime:r,phase:0,duration:i,from:e,to:n,queued:null}}getMorphValuesForProxy(t){if(!(t in this.operations))return null;const e=this.operations[t];return{from:e.from,to:e.to,phase:e.phase}}update(t){for(const e in this.operations){const n=this.operations[e];for(n.phase=(t-n.startTime)/n.duration;n.phase>=1||!this._validOp(n);)if(!this._nextOp(n,t)){delete this.operations[e];break}}}_nextOp(t,e){return!!t.queued&&(t.from=t.to,t.to=t.queued,t.queued=null,t.phase=0,t.startTime=e,!0)}_validOp(t){return t.from.hasData()&&t.to.hasData()}},an={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function ln(t,e){const n=1<<t.z;return!e&&(0===t.x||t.x===n-1)||0===t.y||t.y===n-1}const un=t=>({u_matrix:t});function cn(e,n,r,i,o){if(o>0){const s=t.exported.now(),a=(s-e.timeAdded)/o,l=n?(s-n.timeAdded)/o:-1,u=r.getSource(),c=i.coveringZoomLevel({tileSize:u.tileSize,roundZoom:u.roundZoom}),h=!n||Math.abs(n.tileID.overscaledZ-c)>Math.abs(e.tileID.overscaledZ-c),p=h&&e.refreshedUponExpiration?1:t.clamp(h?a:1-l,0,1);return e.refreshedUponExpiration&&a>=1&&(e.refreshedUponExpiration=!1),n?{opacity:1,mix:1-p}:{opacity:p,mix:0}}return{opacity:1,mix:0}}class hn extends t.SourceCache{constructor(t){const e=Tt("proxy",{type:"geojson",maxzoom:t.transform.maxZoom},new M(Dt(),null),t.style);super("proxy",e,!1),e.setEventedParent(this),this.map=this.getSource().map=t,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(e,n,r){if(e.freezeTileCoverage)return;this.transform=e;const i=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce(((n,r)=>{if(n[r.key]="",!this._tiles[r.key]){const n=new t.Tile(r,this._source.tileSize*r.overscaleFactor(),e.tileZoom);n.state="loaded",this._tiles[r.key]=n}return n}),{});for(const t in this._tiles)t in i||(this.freeFBO(t),this._tiles[t].unloadVectorData(),delete this._tiles[t])}freeFBO(t){const e=this.proxyCachedFBO[t];if(void 0!==e){const n=Object.values(e);this.renderCachePool.push(...n),delete this.proxyCachedFBO[t]}}deallocRenderCache(){this.renderCache.forEach((t=>t.fb.destroy())),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class pn extends t.OverscaledTileID{constructor(t,e,n){super(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y),this.proxyTileKey=e,this.projMatrix=n}}class fn extends t.Elevation{constructor(e,n){super(),this.painter=e,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[r,i,o]=function(e){const n=new t.StructArrayLayout4i8,r=new t.StructArrayLayout3ui6,i=131;n.reserve(17161),r.reserve(33800);const o=t.EXTENT/128,s=t.EXTENT+o/2,a=s+o;for(let e=-o;e<a;e+=o)for(let r=-o;r<a;r+=o){const i=r<0||r>s||e<0||e>s?24575:0,o=t.clamp(Math.round(r),0,t.EXTENT),a=t.clamp(Math.round(e),0,t.EXTENT);n.emplaceBack(o+i,a,o,a)}const l=(t,e)=>{const n=e*i+t;r.emplaceBack(n+1,n,n+i),r.emplaceBack(n+i,n+i+1,n+1)};for(let t=1;t<129;t++)for(let e=1;e<129;e++)l(e,t);return[0,129].forEach((t=>{for(let e=0;e<130;e++)l(e,t),l(t,e)})),[n,r,32768]}(),s=e.context;this.gridBuffer=s.createVertexBuffer(r,wt.members),this.gridIndexBuffer=s.createIndexBuffer(i),this.gridSegments=t.SegmentVector.simpleSegment(0,0,r.length,i.length),this.gridNoSkirtSegments=t.SegmentVector.simpleSegment(0,0,r.length,o),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new hn(n.map),this.orthoMatrix=t.create$1(),t.ortho(this.orthoMatrix,0,t.EXTENT,0,t.EXTENT,0,1);const a=s.gl;this._overlapStencilMode=new t.StencilMode({func:a.GEQUAL,mask:255},0,255,a.KEEP,a.KEEP,a.REPLACE),this._previousZoom=e.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=n,this._useVertexMorphing=!0,this._exaggeration=1}set style(t){t.on("data",this._onStyleDataEvent.bind(this)),t.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=t,this._checkRenderCacheEfficiency()}update(e,n,r){if(e&&e.terrain){this._style!==e&&(this.style=e),this.enabled=!0;const i=e.terrain.properties;this.sourceCache=e._getSourceCache(i.get("source")),this._exaggeration=i.get("exaggeration");const o=()=>{this.sourceCache.used&&t.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const e=this.sourceCache.getSource().tileSize/128,r=this.proxySourceCache.getSource().tileSize;this.sourceCache.update(n,e*r,!0),this._findCoveringTileCache[this.sourceCache.id]={}};this.sourceCache.usedForTerrain||(this._findCoveringTileCache[this.sourceCache.id]={},this.sourceCache.usedForTerrain=!0,o(),this._initializing=!0),o(),n.updateElevation(!r),this._findCoveringTileCache[this.proxySourceCache.id]={},this.proxySourceCache.update(n),this._emptyDEMTextureDirty=!0}else this._disable()}_checkRenderCacheEfficiency(){const e=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==e.efficiency&&t.warnOnce(`Terrain render cache efficiency is not optimal (${e.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${e.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(t){t.coord&&"source"===t.dataType?this._clearRenderCacheForTile(t.sourceCacheId,t.coord):"style"===t.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const t in this._style._sourceCaches)this._style._sourceCaches[t].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach((t=>t.fb.destroy())),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const t=2*this.proxySourceCache.getSource().tileSize;return[t,t]}set useVertexMorphing(t){this._useVertexMorphing=t}updateTileBinding(e){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const n=this.proxySourceCache,r=this.painter.transform;this._initializing&&(this._initializing=0===r._centerAltitude&&-1===this.getAtPointOrZero(t.MercatorCoordinate.fromLngLat(r.center),-1),this._emptyDEMTextureDirty=!this._initializing);const i=this.proxyCoords=n.getIds().map((t=>{const e=n.getTileByID(t).tileID;return e.projMatrix=r.calculateProjMatrix(e.toUnwrapped()),e}));!function(e,n){const r=n.transform.pointCoordinate(n.transform.getCameraPoint()),i=new t.pointGeometry(r.x,r.y);e.sort(((e,n)=>{if(n.overscaledZ-e.overscaledZ)return n.overscaledZ-e.overscaledZ;const r=new t.pointGeometry(e.canonical.x+(1<<e.canonical.z)*e.wrap,e.canonical.y),o=new t.pointGeometry(n.canonical.x+(1<<n.canonical.z)*n.wrap,n.canonical.y),s=i.mult(1<<e.canonical.z);return s.x-=.5,s.y-=.5,s.distSqr(r)-s.distSqr(o)}))}(i,this.painter),this._previousZoom=r.zoom;const o=this.proxyToSource||{};this.proxyToSource={},i.forEach((t=>{this.proxyToSource[t.key]={}})),this.terrainTileForTile={};const s=this._style._sourceCaches;for(const t in s){const n=s[t];if(!n.used)continue;if(n!==this.sourceCache&&(this._findCoveringTileCache[n.id]={}),this._setupProxiedCoordsForOrtho(n,e[t],o),n.usedForTerrain)continue;const r=e[t];n.getSource().reparseOverscaled&&this._assignTerrainTiles(r)}this.proxiedCoords[n.id]=i.map((t=>new pn(t,t.key,this.orthoMatrix))),this._assignTerrainTiles(i),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(o),this.renderingToTexture=!1,this._updateTimestamp=t.exported.now();const a={};this._visibleDemTiles=[];for(const t of this.proxyCoords){const e=this.terrainTileForTile[t.key];if(!e)continue;const n=e.tileID.key;n in a||(this._visibleDemTiles.push(e),a[n]=n)}}_assignTerrainTiles(t){this._initializing||t.forEach((t=>{if(this.terrainTileForTile[t.key])return;const e=this._findTileCoveringTileID(t,this.sourceCache);e&&(this.terrainTileForTile[t.key]=e)}))}_prepareDEMTextures(){const t=this.painter.context,e=t.gl;for(const n in this.terrainTileForTile){const r=this.terrainTileForTile[n],i=r.dem;!i||r.demTexture&&!r.needsDEMTextureUpload||(t.activeTexture.set(e.TEXTURE1),en(this.painter,r,i))}}_prepareDemTileUniforms(t,e,n,r){if(!e||null==e.demTexture)return!1;const i=t.tileID.canonical,o=Math.pow(2,e.tileID.canonical.z-i.z),s=r||"";return n[`u_dem_tl${s}`]=[i.x*o%1,i.y*o%1],n[`u_dem_scale${s}`]=o,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){let t=0;const e=this._visibleDemTiles.reduce(((e,n)=>{if(!n.dem)return e;const r=n.dem.tree.minimums[0];return r>0&&t++,e+r}),0);return t?e/t:0}_updateEmptyDEMTexture(){const e=this.painter.context,n=e.gl;e.activeTexture.set(n.TEXTURE2);const r=this._getLoadedAreaMinimum(),i={width:1,height:1,data:new Uint8Array(t.DEMData.pack(r,this.sourceCache.getSource().encoding))};this._emptyDEMTextureDirty=!1;let o=this._emptyDEMTexture;return o?o.update(i,{premultiply:!1}):o=this._emptyDEMTexture=new t.Texture(e,i,n.RGBA,{premultiply:!1}),o}setupElevationDraw(e,n,r){const i=this.painter.context,o=i.gl,s=(a=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:t.DEMData.getUnpackVector(a),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0,u_tile_tl_up:[0,0,1],u_tile_tr_up:[0,0,1],u_tile_br_up:[0,0,1],u_tile_bl_up:[0,0,1],u_tile_up_scale:1});var a;s.u_dem_size=this.sourceCache.getSource().tileSize,s.u_exaggeration=this.exaggeration();let l=null,u=null,c=1;if(r&&r.morphing&&this._useVertexMorphing){const t=r.morphing.srcDemTile,n=r.morphing.dstDemTile;c=r.morphing.phase,t&&n&&(this._prepareDemTileUniforms(e,t,s,"_prev")&&(u=t),this._prepareDemTileUniforms(e,n,s)&&(l=n))}if(u&&l?(i.activeTexture.set(o.TEXTURE2),l.demTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE,o.NEAREST),i.activeTexture.set(o.TEXTURE4),u.demTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE,o.NEAREST),s.u_dem_lerp=c):(l=this.terrainTileForTile[e.tileID.key],i.activeTexture.set(o.TEXTURE2),(this._prepareDemTileUniforms(e,l,s)?l.demTexture:this.emptyDEMTexture).bind(o.NEAREST,o.CLAMP_TO_EDGE,o.NEAREST)),r&&r.useDepthForOcclusion&&(i.activeTexture.set(o.TEXTURE3),this._depthTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE,o.NEAREST),s.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height]),r&&r.useMeterToDem&&l){const e=(1<<l.tileID.canonical.z)*t.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;s.u_meter_to_dem=e}r&&r.labelPlaneMatrixInv&&(s.u_label_plane_matrix_inv=r.labelPlaneMatrixInv),n.setTerrainUniformValues(i,s)}renderToBackBuffer(e){const n=this.painter,r=this.painter.context;0!==e.length&&(r.bindFramebuffer.set(null),r.viewport.set([0,0,n.width,n.height]),this.renderingToTexture=!1,function(e,n,r,i,o){const s=e.context,a=s.gl;let l,u;const c=e.options.showTerrainWireframe?2:0,h=(t,n)=>{if(u===t)return;const r=[an[t]];n&&r.push(an[c]),l=e.useProgram("terrainRaster",null,r),u=t},p=e.colorModeForRenderPass(),f=new t.DepthMode(a.LEQUAL,t.DepthMode.ReadWrite,e.depthRangeFor3D);sn.update(o);const d=e.transform,g=6*Math.pow(1.5,22-d.zoom)*n.exaggeration();(c?[!1,!0]:[!1]).forEach((c=>{u=-1;const m=c?a.LINES:a.TRIANGLES,[A,y]=c?n.getWirefameBuffer():[n.gridIndexBuffer,n.gridSegments];for(const u of i){const i=r.getTile(u),b=t.StencilMode.disabled,x=n.prevTerrainTileForTile[u.key],w=n.terrainTileForTile[u.key];v=w,null!=(_=x)&&null!=v&&_.hasData()&&v.hasData()&&null!=_.demTexture&&null!=v.demTexture&&_.tileID.key!==v.tileID.key&&sn.newMorphing(u.key,x,w,o,250),s.activeTexture.set(a.TEXTURE0),i.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST);const E=sn.getMorphValuesForProxy(u.key),S=E?1:0;let T;E&&(T={morphing:{srcDemTile:E.from,dstDemTile:E.to,phase:t.easeCubicInOut(E.phase)}});const P=on(u.projMatrix,ln(u.canonical,d.renderWorldCopies)?g/10:g);h(S,c),n.setupElevationDraw(i,l,T),e.prepareDrawProgram(s,l,u.toUnwrapped()),l.draw(s,m,f,b,p,t.CullFaceMode.backCCW,P,"terrain_raster",n.gridBuffer,A,y)}var _,v}))}(n,this,this.proxySourceCache,e,this._updateTimestamp),this.renderingToTexture=!0,e.splice(0,e.length))}renderBatch(e){if(0===this._drapedRenderBatches.length)return e+1;this.renderingToTexture=!0;const n=this.painter,r=this.painter.context,i=this.proxySourceCache,o=this.proxiedCoords[i.id],s=this._drapedRenderBatches.shift(),a=[],l=n.style.order;let u=0;for(const c of o){const o=i.getTileByID(c.proxyTileKey),h=i.proxyCachedFBO[c.key]?i.proxyCachedFBO[c.key][e]:void 0,p=void 0!==h?i.renderCache[h]:this.pool[u++],f=void 0!==h;if(o.texture=p.tex,f&&!p.dirty){a.push(o.tileID);continue}let d;r.bindFramebuffer.set(p.fb.framebuffer),this.renderedToTile=!1,p.dirty&&(r.clear({color:t.Color.transparent}),p.dirty=!1);for(let t=s.start;t<=s.end;++t){const e=n.style._layers[l[t]];if(e.isHidden(n.transform.zoom))continue;const i=n.style._getLayerSourceCache(e),o=i?this.proxyToSource[c.key][i.id]:[c];if(!o)continue;const s=o;r.viewport.set([0,0,p.fb.width,p.fb.height]),d!==(i?i.id:null)&&(this._setupStencil(p,o,e,i),d=i?i.id:null),n.renderLayer(n,i,e,s)}this.renderedToTile?(p.dirty=!0,a.push(o.tileID)):f||--u,5===u&&(u=0,this.renderToBackBuffer(a))}return this.renderToBackBuffer(a),this.renderingToTexture=!1,r.bindFramebuffer.set(null),r.viewport.set([0,0,n.width,n.height]),s.end+1}postRender(){}renderCacheEfficiency(t){const e=t.order.length;if(0===e)return{efficiency:100};let n,r=0,i=0,o=!1;for(let s=0;s<e;++s){const e=t._layers[t.order[s]];this._style.isLayerDraped(e)?(o&&++r,++i):o||(o=!0,n=e.id)}return 0===i?{efficiency:100}:{efficiency:100*(1-r/i),firstUndrapedLayer:n}}getMinElevationBelowMSL(){let t=0;return this._visibleDemTiles.filter((t=>t.dem)).forEach((e=>{t=Math.min(t,e.dem.tree.minimums[0])})),0===t?t:(t-30)*this._exaggeration}raycast(t,e,n){if(!this._visibleDemTiles)return null;const r=this._visibleDemTiles.filter((t=>t.dem)).map((r=>{const i=r.tileID,o=Math.pow(2,i.overscaledZ),{x:s,y:a}=i.canonical,l=s/o,u=(s+1)/o,c=a/o,h=(a+1)/o;return{minx:l,miny:c,maxx:u,maxy:h,t:r.dem.tree.raycastRoot(l,c,u,h,t,e,n),tile:r}}));r.sort(((t,e)=>(null!==t.t?t.t:Number.MAX_VALUE)-(null!==e.t?e.t:Number.MAX_VALUE)));for(const i of r){if(null==i.t)return null;const r=i.tile.dem.tree.raycast(i.minx,i.miny,i.maxx,i.maxy,t,e,n);if(null!=r)return r}return null}_createFBO(){const e=this.painter.context,n=e.gl,r=this.drapeBufferSize;e.activeTexture.set(n.TEXTURE0);const i=new t.Texture(e,{width:r[0],height:r[1],data:null},n.RGBA);i.bind(n.LINEAR,n.CLAMP_TO_EDGE);const o=e.createFramebuffer(r[0],r[1],!1);return o.colorAttachment.set(i.texture),o.depthAttachment=new yt(e,o.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=e.createRenderbuffer(e.gl.DEPTH_STENCIL,r[0],r[1]),this._stencilRef=0,o.depthAttachment.set(this._sharedDepthStencil),e.clear({stencil:0})):o.depthAttachment.set(this._sharedDepthStencil),e.extTextureFilterAnisotropic&&!e.extTextureFilterAnisotropicForceOff&&n.texParameterf(n.TEXTURE_2D,e.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.extTextureFilterAnisotropicMax),{fb:o,tex:i,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const t in this._style._sourceCaches)if(this._style._sourceCaches[t].hasTransition())return!0;return this._style.order.some((t=>{const e=this._style._layers[t],n=e.isHidden(this.painter.transform.zoom),r=e.getCrossfadeParameters(),i=!!r&&1!==r.t,o=e.hasTransition();return"custom"!==e.type&&!n&&(i||o)}))}_clearRasterFadeFromRenderCache(){let t=!1;for(const e in this._style._sourceCaches)if(this._style._sourceCaches[e]._source instanceof bt){t=!0;break}if(t)for(let t=0;t<this._style.order.length;++t){const e=this._style._layers[this._style.order[t]],n=e.isHidden(this.painter.transform.zoom),r=this._style._getLayerSourceCache(e);if("raster"!==e.type||n||!r)continue;const i=e.paint.get("raster-fade-duration");for(const t of this.proxyCoords){const e=this.proxyToSource[t.key][r.id];if(e)for(const t of e){const e=cn(r.getTile(t),r.findLoadedParent(t,0),r,this.painter.transform,i);(1!==e.opacity||0!==e.mix)&&this._clearRenderCacheForTile(r.id,t)}}}}_setupDrapedRenderBatches(){const t=this._style.order,e=t.length;if(0===e)return;const n=[];let r,i=0,o=this._style._layers[t[i]];for(;!this._style.isLayerDraped(o)&&o.isHidden(this.painter.transform.zoom)&&++i<e;)o=this._style._layers[t[i]];for(;i<e;++i){const e=this._style._layers[t[i]];e.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(e)?void 0===r&&(r=i):void 0!==r&&(n.push({start:r,end:i-1}),r=void 0))}void 0!==r&&n.push({start:r,end:i-1}),this._drapedRenderBatches=n}_setupRenderCache(t){const e=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,e.renderCache.length>e.renderCachePool.length){const t=Object.values(e.proxyCachedFBO);e.proxyCachedFBO={};for(let n=0;n<t.length;++n){const r=Object.values(t[n]);e.renderCachePool.push(...r)}}return}this._clearRasterFadeFromRenderCache();const n=this.proxyCoords,r=this._tilesDirty;for(let i=n.length-1;i>=0;i--){const o=n[i];if(e.getTileByID(o.key),void 0!==e.proxyCachedFBO[o.key]){const n=t[o.key],i=this.proxyToSource[o.key];let s=0;for(const t in i){const e=i[t],o=n[t];if(!o||o.length!==e.length||e.some(((e,n)=>e!==o[n]||r[t]&&r[t].hasOwnProperty(e.key)))){s=-1;break}++s}for(const t in e.proxyCachedFBO[o.key])e.renderCache[e.proxyCachedFBO[o.key][t]].dirty=s<0||s!==Object.values(n).length}}const i=[...this._drapedRenderBatches];i.sort(((t,e)=>e.end-e.start-(t.end-t.start)));for(const t of i)for(const r of n){if(e.proxyCachedFBO[r.key])continue;let n=e.renderCachePool.pop();void 0===n&&e.renderCache.length<50&&(n=e.renderCache.length,e.renderCache.push(this._createFBO())),void 0!==n&&(e.proxyCachedFBO[r.key]={},e.proxyCachedFBO[r.key][t.start]=n,e.renderCache[n].dirty=!0)}this._tilesDirty={}}_setupStencil(t,e,n,r){if(!r||!this._sourceTilesOverlap[r.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const i=this.painter.context,o=i.gl;if(e.length<=1)return void(this._overlapStencilType=!1);let s;if(n.isTileClipped())s=e.length,this._overlapStencilMode.test={func:o.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(e[0].overscaledZ>e[e.length-1].overscaledZ))return void(this._overlapStencilType=!1);s=1,this._overlapStencilMode.test={func:o.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+s>255&&(i.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=s,this._overlapStencilMode.ref=this._stencilRef,n.isTileClipped()&&this._renderTileClippingMasks(e,this._overlapStencilMode.ref)}stencilModeForRTTOverlap(e){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[e.key]),this._overlapStencilMode):t.StencilMode.disabled}_renderTileClippingMasks(e,n){const r=this.painter,i=this.painter.context,o=i.gl;r._tileClippingMaskIDs={},i.setColorMode(t.ColorMode.disabled),i.setDepthMode(t.DepthMode.disabled);const s=r.useProgram("clippingMask");for(const a of e){const e=r._tileClippingMaskIDs[a.key]=--n;s.draw(i,o.TRIANGLES,t.DepthMode.disabled,new t.StencilMode({func:o.ALWAYS,mask:0},e,255,o.KEEP,o.KEEP,o.REPLACE),t.ColorMode.disabled,t.CullFaceMode.disabled,un(a.projMatrix),"$clipping",r.tileExtentBuffer,r.quadTriangleIndexBuffer,r.tileExtentSegments)}}pointCoordinate(e){const n=this.painter.transform;if(e.x<0||e.x>n.width||e.y<0||e.y>n.height)return null;const r=[e.x,e.y,1,1];t.transformMat4(r,r,n.pixelMatrixInverse),t.scale$2(r,r,1/r[3]),r[0]/=n.worldSize,r[1]/=n.worldSize;const i=n._camera.position,o=t.mercatorZfromAltitude(1,n.center.lat),s=[i[0],i[1],i[2]/o,0],a=t.subtract([],r.slice(0,3),s);t.normalize(a,a);const l=this.raycast(s,a,this._exaggeration);return null!==l&&l?(t.scaleAndAdd(s,s,a,l),s[3]=s[2],s[2]*=o,s):null}drawDepth(){const e=this.painter,n=e.context,r=this.proxySourceCache,i=Math.ceil(e.width),o=Math.ceil(e.height);if(!this._depthFBO||this._depthFBO.width===i&&this._depthFBO.height===o||(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture),!this._depthFBO){const e=n.gl,r=n.createFramebuffer(i,o,!0);n.activeTexture.set(e.TEXTURE0);const s=new t.Texture(n,{width:i,height:o,data:null},e.RGBA);s.bind(e.NEAREST,e.CLAMP_TO_EDGE),r.colorAttachment.set(s.texture);const a=n.createRenderbuffer(n.gl.DEPTH_COMPONENT16,i,o);r.depthAttachment.set(a),this._depthFBO=r,this._depthTexture=s}n.bindFramebuffer.set(this._depthFBO.framebuffer),n.viewport.set([0,0,i,o]),function(e,n,r,i){const o=e.context,s=o.gl;o.clear({depth:1});const a=e.useProgram("terrainDepth"),l=new t.DepthMode(s.LESS,t.DepthMode.ReadWrite,e.depthRangeFor3D);for(const e of i){const i=r.getTile(e),u=on(e.projMatrix,0);n.setupElevationDraw(i,a),a.draw(o,s.TRIANGLES,l,t.StencilMode.disabled,t.ColorMode.unblended,t.CullFaceMode.backCCW,u,"terrain_depth",n.gridBuffer,n.gridIndexBuffer,n.gridNoSkirtSegments)}}(e,this,r,this.proxyCoords)}_setupProxiedCoordsForOrtho(t,e,n){if(t.getSource()instanceof Et)return this._setupProxiedCoordsForImageSource(t,e,n);this._findCoveringTileCache[t.id]=this._findCoveringTileCache[t.id]||{};const r=this.proxiedCoords[t.id]=[],i=this.proxyCoords;for(let e=0;e<i.length;e++){const o=i[e],s=this._findTileCoveringTileID(o,t);if(s){const e=this._createProxiedId(o,s,n[o.key]&&n[o.key][t.id]);r.push(e),this.proxyToSource[o.key][t.id]=[e]}}let o=!1;for(let i=0;i<e.length;i++){const s=t.getTile(e[i]);if(!s||!s.hasData())continue;const a=this._findTileCoveringTileID(s.tileID,this.proxySourceCache);if(a&&a.tileID.canonical.z!==s.tileID.canonical.z){const e=this.proxyToSource[a.tileID.key][t.id],i=this._createProxiedId(a.tileID,s,n[a.tileID.key]&&n[a.tileID.key][t.id]);e?e.splice(e.length-1,0,i):this.proxyToSource[a.tileID.key][t.id]=[i],r.push(i),o=!0}}this._sourceTilesOverlap[t.id]=o}_setupProxiedCoordsForImageSource(e,n,r){if(!e.getSource().loaded())return;const i=this.proxiedCoords[e.id]=[],o=this.proxyCoords,s=e.getSource(),a=new t.pointGeometry(s.tileID.x,s.tileID.y)._div(1<<s.tileID.z),l=s.coordinates.map(t.MercatorCoordinate.fromLngLat).reduce(((t,e)=>(t.min.x=Math.min(t.min.x,e.x-a.x),t.min.y=Math.min(t.min.y,e.y-a.y),t.max.x=Math.max(t.max.x,e.x-a.x),t.max.y=Math.max(t.max.y,e.y-a.y),t)),{min:new t.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new t.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),u=(e,n)=>{const r=e.wrap+e.canonical.x/(1<<e.canonical.z),i=e.canonical.y/(1<<e.canonical.z),o=t.EXTENT/(1<<e.canonical.z),s=n.wrap+n.canonical.x/(1<<n.canonical.z),a=n.canonical.y/(1<<n.canonical.z);return r+o<s+l.min.x||r>s+l.max.x||i+o<a+l.min.y||i>a+l.max.y};for(let t=0;t<o.length;t++){const s=o[t];for(let t=0;t<n.length;t++){const o=e.getTile(n[t]);if(!o||!o.hasData())continue;if(u(s,o.tileID))continue;const a=this._createProxiedId(s,o,r[s.key]&&r[s.key][e.id]),l=this.proxyToSource[s.key][e.id];l?l.push(a):this.proxyToSource[s.key][e.id]=[a],i.push(a)}}}_createProxiedId(e,n,r){let i=this.orthoMatrix;if(r){const t=r.find((t=>t.key===n.tileID.key));if(t)return t}if(n.tileID.key!==e.key){const r=e.canonical.z-n.tileID.canonical.z;let o,s,a;i=t.create$1();const l=n.tileID.wrap-e.wrap<<e.overscaledZ;r>0?(o=t.EXTENT>>r,s=o*((n.tileID.canonical.x<<r)-e.canonical.x+l),a=o*((n.tileID.canonical.y<<r)-e.canonical.y)):(o=t.EXTENT<<-r,s=t.EXTENT*(n.tileID.canonical.x-(e.canonical.x+l<<-r)),a=t.EXTENT*(n.tileID.canonical.y-(e.canonical.y<<-r))),t.ortho(i,0,o,0,o,0,1),t.translate(i,i,[s,a,0])}return new pn(n.tileID,e.key,i)}_findTileCoveringTileID(e,n){let r=n.getTile(e);if(r&&r.hasData())return r;const i=this._findCoveringTileCache[n.id],o=i[e.key];if(r=o?n.getTileByID(o):null,r&&r.hasData()||null===o)return r;let s=r?r.tileID:e,a=s.overscaledZ;const l=n.getSource().minzoom,u=[];if(!o){const i=n.getSource().maxzoom;if(e.canonical.z>=i){const r=e.canonical.z-i;n.getSource().reparseOverscaled?(a=Math.max(e.canonical.z+2,n.transform.tileZoom),s=new t.OverscaledTileID(a,e.wrap,i,e.canonical.x>>r,e.canonical.y>>r)):0!==r&&(a=i,s=new t.OverscaledTileID(a,e.wrap,i,e.canonical.x>>r,e.canonical.y>>r))}s.key!==e.key&&(u.push(s.key),r=n.getTile(s))}const c=t=>{u.forEach((e=>{i[e]=t})),u.length=0};for(a-=1;a>=l&&(!r||!r.hasData());a--){r&&c(r.tileID.key);const t=s.calculateScaledKey(a);if(r=n.getTileByID(t),r&&r.hasData())break;const e=i[t];if(null===e)break;void 0===e?u.push(t):r=n.getTileByID(e)}return c(r?r.tileID.key:null),r&&r.hasData()?r:null}findDEMTileFor(t){return this.enabled?this._findTileCoveringTileID(t,this.sourceCache):null}prepareDrawTile(t){this.renderedToTile=!0}_clearRenderCacheForTile(t,e){let n=this._tilesDirty[t];n||(n=this._tilesDirty[t]={}),n[e.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const e=function(e){let n,r,i;const o=new t.StructArrayLayout2ui4,s=131;for(r=1;r<129;r++){for(n=1;n<129;n++)i=r*s+n,o.emplaceBack(i,i+1),o.emplaceBack(i,i+s),o.emplaceBack(i+1,i+s),128===r&&o.emplaceBack(i+s,i+s+1);o.emplaceBack(i+1,i+1+s)}return o}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(e),this.wireframeSegments=t.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,e.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}function dn(t){const e=[];for(let n=0;n<t.length;n++){if(null===t[n])continue;const r=t[n].split(" ");e.push(r.pop())}return e}class gn{static cacheKey(t,e,n){let r=`${t}${n?n.cacheKey:""}`;for(const t of e)r+=`/${t}`;return r}constructor(e,n,r,i,o,s){const a=e.gl;this.program=a.createProgram();const l=dn(r.staticAttributes),u=i?i.getBinderAttributes():[],c=l.concat(u),h=r.staticUniforms?dn(r.staticUniforms):[],p=i?i.getBinderUniforms():[],f=h.concat(p),d=[];for(const t of f)d.indexOf(t)<0&&d.push(t);let g=i?i.defines():[];g=g.concat(s.map((t=>`#define ${t}`)));const m=g.concat(Xe.fragmentSource,$e,He.fragmentSource,r.fragmentSource).join("\n"),A=g.concat(Xe.vertexSource,$e,He.vertexSource,We.vertexSource,r.vertexSource).join("\n"),y=a.createShader(a.FRAGMENT_SHADER);if(a.isContextLost())return void(this.failedToCreate=!0);a.shaderSource(y,m),a.compileShader(y),a.attachShader(this.program,y);const _=a.createShader(a.VERTEX_SHADER);if(a.isContextLost())return void(this.failedToCreate=!0);a.shaderSource(_,A),a.compileShader(_),a.attachShader(this.program,_),this.attributes={};const v={};this.numAttributes=c.length;for(let t=0;t<this.numAttributes;t++)c[t]&&(a.bindAttribLocation(this.program,t,c[t]),this.attributes[c[t]]=t);a.linkProgram(this.program),a.deleteShader(_),a.deleteShader(y);for(let t=0;t<d.length;t++){const e=d[t];if(e&&!v[e]){const t=a.getUniformLocation(this.program,e);t&&(v[e]=t)}}this.fixedUniforms=o(e,v),this.binderUniforms=i?i.getUniforms(e,v):[],-1!==s.indexOf("TERRAIN")&&(this.terrainUniforms=((e,n)=>({u_dem:new t.Uniform1i(e,n.u_dem),u_dem_prev:new t.Uniform1i(e,n.u_dem_prev),u_dem_unpack:new t.Uniform4f(e,n.u_dem_unpack),u_dem_tl:new t.Uniform2f(e,n.u_dem_tl),u_dem_scale:new t.Uniform1f(e,n.u_dem_scale),u_dem_tl_prev:new t.Uniform2f(e,n.u_dem_tl_prev),u_dem_scale_prev:new t.Uniform1f(e,n.u_dem_scale_prev),u_dem_size:new t.Uniform1f(e,n.u_dem_size),u_dem_lerp:new t.Uniform1f(e,n.u_dem_lerp),u_exaggeration:new t.Uniform1f(e,n.u_exaggeration),u_depth:new t.Uniform1i(e,n.u_depth),u_depth_size_inv:new t.Uniform2f(e,n.u_depth_size_inv),u_meter_to_dem:new t.Uniform1f(e,n.u_meter_to_dem),u_label_plane_matrix_inv:new t.UniformMatrix4f(e,n.u_label_plane_matrix_inv),u_tile_tl_up:new t.Uniform3f(e,n.u_tile_tl_up),u_tile_tr_up:new t.Uniform3f(e,n.u_tile_tr_up),u_tile_br_up:new t.Uniform3f(e,n.u_tile_br_up),u_tile_bl_up:new t.Uniform3f(e,n.u_tile_bl_up),u_tile_up_scale:new t.Uniform1f(e,n.u_tile_up_scale)}))(e,v)),-1!==s.indexOf("FOG")&&(this.fogUniforms=((e,n)=>({u_fog_matrix:new t.UniformMatrix4f(e,n.u_fog_matrix),u_fog_range:new t.Uniform2f(e,n.u_fog_range),u_fog_color:new t.Uniform4f(e,n.u_fog_color),u_fog_horizon_blend:new t.Uniform1f(e,n.u_fog_horizon_blend),u_fog_temporal_offset:new t.Uniform1f(e,n.u_fog_temporal_offset)}))(e,v))}setTerrainUniformValues(t,e){if(!this.terrainUniforms)return;const n=this.terrainUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const t in e)n[t].set(e[t])}}setFogUniformValues(t,e){if(!this.fogUniforms)return;const n=this.fogUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const t in e)n[t].location&&n[t].set(e[t])}}draw(t,e,n,r,i,o,s,a,l,u,c,h,p,f,d,g){const m=t.gl;if(this.failedToCreate)return;t.program.set(this.program),t.setDepthMode(n),t.setStencilMode(r),t.setColorMode(i),t.setCullFace(o);for(const t in this.fixedUniforms)this.fixedUniforms[t].set(s[t]);f&&f.setUniforms(t,this.binderUniforms,h,{zoom:p});const A={[m.LINES]:2,[m.TRIANGLES]:3,[m.LINE_STRIP]:1}[e];for(const n of c.get()){const r=n.vaos||(n.vaos={});(r[a]||(r[a]=new Ke)).bind(t,this,l,f?f.getPaintVertexBuffers():[],u,n.vertexOffset,d,g),m.drawElements(e,n.primitiveLength*A,m.UNSIGNED_SHORT,n.primitiveOffset*A*2)}}}function mn(t,e,n){const r=1/C(n,1,e.transform.tileZoom),i=Math.pow(2,n.tileID.overscaledZ),o=n.tileSize*Math.pow(2,e.transform.tileZoom)/i,s=o*(n.tileID.canonical.x+n.tileID.wrap*i),a=o*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[r,t.fromScale,t.toScale],u_fade:t.t,u_pixel_coord_upper:[s>>16,a>>16],u_pixel_coord_lower:[65535&s,65535&a]}}const An=(e,n,r,i)=>{const o=n.style.light,s=o.properties.get("position"),a=[s.x,s.y,s.z],l=t.create$2();"viewport"===o.properties.get("anchor")&&(t.fromRotation(l,-n.transform.angle),t.transformMat3(a,a,l));const u=o.properties.get("color");return{u_matrix:e,u_lightpos:a,u_lightintensity:o.properties.get("intensity"),u_lightcolor:[u.r,u.g,u.b],u_vertical_gradient:+r,u_opacity:i}},yn=(e,n,r,i,o,s,a)=>t.extend(An(e,n,r,i),mn(s,n,a),{u_height_factor:-Math.pow(2,o.overscaledZ)/a.tileSize/8}),_n=t=>({u_matrix:t}),vn=(e,n,r,i)=>t.extend(_n(e),mn(r,n,i)),bn=(t,e)=>({u_matrix:t,u_world:e}),xn=(e,n,r,i,o)=>t.extend(vn(e,n,r,i),{u_world:o}),wn=(e,n,r,i)=>{const o=e.transform;let s;if("map"===i.paint.get("circle-pitch-alignment")){const t=C(r,1,o.zoom);s=[t,t]}else s=o.pixelsToGLUnits;return{u_camera_to_center_distance:o.cameraToCenterDistance,u_matrix:e.translatePosMatrix(n.projMatrix,r,i.paint.get("circle-translate"),i.paint.get("circle-translate-anchor")),u_device_pixel_ratio:t.exported.devicePixelRatio,u_extrude_scale:s}},En=t=>{const e=[];return"map"===t.paint.get("circle-pitch-alignment")&&e.push("PITCH_WITH_MAP"),"map"===t.paint.get("circle-pitch-scale")&&e.push("SCALE_WITH_MAP"),e},Sn=(e,n,r)=>{const i=t.EXTENT/r.tileSize;return{u_matrix:e,u_camera_to_center_distance:n.cameraToCenterDistance,u_extrude_scale:[n.pixelsToGLUnits[0]/i,n.pixelsToGLUnits[1]/i]}},Tn=(t,e,n=1)=>({u_matrix:t,u_color:e,u_overlay:0,u_overlay_scale:n}),Pn=(t,e,n,r)=>({u_matrix:t,u_extrude_scale:C(e,1,n),u_intensity:r}),Mn=(e,n,r,i,o,s)=>{const a=e.transform,l={u_matrix:On(e,n,r,o),u_ratio:1/C(n,1,a.zoom),u_device_pixel_ratio:t.exported.devicePixelRatio,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:s,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0};if(Ln(r)){const t=In(n,e.transform);l.u_texsize=n.lineAtlasTexture.size,l.u_scale=[t,i.fromScale,i.toScale],l.u_mix=i.t}return l},Cn=(e,n,r,i,o)=>{const s=e.transform,a=In(n,s);return{u_matrix:On(e,n,r,o),u_texsize:n.imageAtlasTexture.size,u_ratio:1/C(n,1,s.zoom),u_device_pixel_ratio:t.exported.devicePixelRatio,u_image:0,u_scale:[a,i.fromScale,i.toScale],u_fade:i.t,u_units_to_pixels:[1/s.pixelsToGLUnits[0],1/s.pixelsToGLUnits[1]]}};function In(t,e){return 1/C(t,1,e.tileZoom)}function On(t,e,n,r){return t.translatePosMatrix(r||e.tileID.projMatrix,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}const Rn=t=>{const e=[];return Ln(t)&&e.push("RENDER_LINE_DASH"),t.paint.get("line-gradient")&&e.push("RENDER_LINE_GRADIENT"),e};function Ln(t){const e=t.paint.get("line-dasharray").value;return e.value||"constant"!==e.kind}const kn=(t,e,n,r,i)=>{return{u_matrix:t,u_tl_parent:e,u_scale_parent:n,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*i.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:i.paint.get("raster-brightness-min"),u_brightness_high:i.paint.get("raster-brightness-max"),u_saturation_factor:(s=i.paint.get("raster-saturation"),s>0?1-1/(1.001-s):-s),u_contrast_factor:(o=i.paint.get("raster-contrast"),o>0?1/(1-o):1+o),u_spin_weights:Dn(i.paint.get("raster-hue-rotate"))};var o,s};function Dn(t){t*=Math.PI/180;const e=Math.sin(t),n=Math.cos(t);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}const Nn=(t,e,n,r,i,o,s,a,l,u)=>{const c=i.transform;return{u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:c.cameraToCenterDistance,u_pitch:c.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:c.width/c.height,u_fade_change:i.options.fadeDuration?i.symbolFadeChange:1,u_matrix:o,u_label_plane_matrix:s,u_coord_matrix:a,u_is_text:+l,u_pitch_with_map:+r,u_texsize:u,u_texture:0}},Fn=(e,n,r,i,o,s,a,l,u,c,h)=>{const{cameraToCenterDistance:p,_pitch:f}=o.transform;return t.extend(Nn(e,n,r,i,o,s,a,l,u,c),{u_gamma_scale:i?p*Math.cos(o.terrain?0:f):1,u_device_pixel_ratio:t.exported.devicePixelRatio,u_is_halo:+h})},Bn=(e,n,r,i,o,s,a,l,u,c)=>t.extend(Fn(e,n,r,i,o,s,a,l,!0,u,!0),{u_texsize_icon:c,u_texture_icon:1}),zn=(t,e,n)=>({u_matrix:t,u_opacity:e,u_color:n}),jn=(e,n,r,i,o,s)=>t.extend(function(t,e,n,r){const i=n.imageManager.getPattern(t.from.toString()),o=n.imageManager.getPattern(t.to.toString()),{width:s,height:a}=n.imageManager.getPixelSize(),l=Math.pow(2,r.tileID.overscaledZ),u=r.tileSize*Math.pow(2,n.transform.tileZoom)/l,c=u*(r.tileID.canonical.x+r.tileID.wrap*l),h=u*r.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:i.tl,u_pattern_br_a:i.br,u_pattern_tl_b:o.tl,u_pattern_br_b:o.br,u_texsize:[s,a],u_mix:e.t,u_pattern_size_a:i.displaySize,u_pattern_size_b:o.displaySize,u_scale_a:e.fromScale,u_scale_b:e.toScale,u_tile_units_to_pixels:1/C(r,1,n.transform.tileZoom),u_pixel_coord_upper:[c>>16,h>>16],u_pixel_coord_lower:[65535&c,65535&h]}}(i,s,r,o),{u_matrix:e,u_opacity:n}),Un={fillExtrusion:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_lightpos:new t.Uniform3f(e,n.u_lightpos),u_lightintensity:new t.Uniform1f(e,n.u_lightintensity),u_lightcolor:new t.Uniform3f(e,n.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,n.u_vertical_gradient),u_opacity:new t.Uniform1f(e,n.u_opacity)}),fillExtrusionPattern:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_lightpos:new t.Uniform3f(e,n.u_lightpos),u_lightintensity:new t.Uniform1f(e,n.u_lightintensity),u_lightcolor:new t.Uniform3f(e,n.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,n.u_vertical_gradient),u_height_factor:new t.Uniform1f(e,n.u_height_factor),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade),u_opacity:new t.Uniform1f(e,n.u_opacity)}),fill:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}),fillPattern:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}),fillOutline:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world)}),fillOutlinePattern:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}),circle:(e,n)=>({u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_extrude_scale:new t.Uniform2f(e,n.u_extrude_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}),collisionBox:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_extrude_scale:new t.Uniform2f(e,n.u_extrude_scale)}),collisionCircle:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_inv_matrix:new t.UniformMatrix4f(e,n.u_inv_matrix),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_viewport_size:new t.Uniform2f(e,n.u_viewport_size)}),debug:(e,n)=>({u_color:new t.UniformColor(e,n.u_color),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_overlay:new t.Uniform1i(e,n.u_overlay),u_overlay_scale:new t.Uniform1f(e,n.u_overlay_scale)}),clippingMask:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}),heatmap:(e,n)=>({u_extrude_scale:new t.Uniform1f(e,n.u_extrude_scale),u_intensity:new t.Uniform1f(e,n.u_intensity),u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}),heatmapTexture:(e,n)=>({u_image:new t.Uniform1i(e,n.u_image),u_color_ramp:new t.Uniform1i(e,n.u_color_ramp),u_opacity:new t.Uniform1f(e,n.u_opacity)}),hillshade:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_latrange:new t.Uniform2f(e,n.u_latrange),u_light:new t.Uniform2f(e,n.u_light),u_shadow:new t.UniformColor(e,n.u_shadow),u_highlight:new t.UniformColor(e,n.u_highlight),u_accent:new t.UniformColor(e,n.u_accent)}),hillshadePrepare:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_dimension:new t.Uniform2f(e,n.u_dimension),u_zoom:new t.Uniform1f(e,n.u_zoom),u_unpack:new t.Uniform4f(e,n.u_unpack)}),line:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_dash_image:new t.Uniform1i(e,n.u_dash_image),u_gradient_image:new t.Uniform1i(e,n.u_gradient_image),u_image_height:new t.Uniform1f(e,n.u_image_height),u_texsize:new t.Uniform2f(e,n.u_texsize),u_scale:new t.Uniform3f(e,n.u_scale),u_mix:new t.Uniform1f(e,n.u_mix)}),linePattern:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_texsize:new t.Uniform2f(e,n.u_texsize),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_image:new t.Uniform1i(e,n.u_image),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}),raster:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_tl_parent:new t.Uniform2f(e,n.u_tl_parent),u_scale_parent:new t.Uniform1f(e,n.u_scale_parent),u_buffer_scale:new t.Uniform1f(e,n.u_buffer_scale),u_fade_t:new t.Uniform1f(e,n.u_fade_t),u_opacity:new t.Uniform1f(e,n.u_opacity),u_image0:new t.Uniform1i(e,n.u_image0),u_image1:new t.Uniform1i(e,n.u_image1),u_brightness_low:new t.Uniform1f(e,n.u_brightness_low),u_brightness_high:new t.Uniform1f(e,n.u_brightness_high),u_saturation_factor:new t.Uniform1f(e,n.u_saturation_factor),u_contrast_factor:new t.Uniform1f(e,n.u_contrast_factor),u_spin_weights:new t.Uniform3f(e,n.u_spin_weights)}),symbolIcon:(e,n)=>({u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1i(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texture:new t.Uniform1i(e,n.u_texture)}),symbolSDF:(e,n)=>({u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1i(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texture:new t.Uniform1i(e,n.u_texture),u_gamma_scale:new t.Uniform1f(e,n.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(e,n.u_is_halo)}),symbolTextAndIcon:(e,n)=>({u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1i(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texsize_icon:new t.Uniform2f(e,n.u_texsize_icon),u_texture:new t.Uniform1i(e,n.u_texture),u_texture_icon:new t.Uniform1i(e,n.u_texture_icon),u_gamma_scale:new t.Uniform1f(e,n.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(e,n.u_is_halo)}),background:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_opacity:new t.Uniform1f(e,n.u_opacity),u_color:new t.UniformColor(e,n.u_color)}),backgroundPattern:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_opacity:new t.Uniform1f(e,n.u_opacity),u_image:new t.Uniform1i(e,n.u_image),u_pattern_tl_a:new t.Uniform2f(e,n.u_pattern_tl_a),u_pattern_br_a:new t.Uniform2f(e,n.u_pattern_br_a),u_pattern_tl_b:new t.Uniform2f(e,n.u_pattern_tl_b),u_pattern_br_b:new t.Uniform2f(e,n.u_pattern_br_b),u_texsize:new t.Uniform2f(e,n.u_texsize),u_mix:new t.Uniform1f(e,n.u_mix),u_pattern_size_a:new t.Uniform2f(e,n.u_pattern_size_a),u_pattern_size_b:new t.Uniform2f(e,n.u_pattern_size_b),u_scale_a:new t.Uniform1f(e,n.u_scale_a),u_scale_b:new t.Uniform1f(e,n.u_scale_b),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_tile_units_to_pixels:new t.Uniform1f(e,n.u_tile_units_to_pixels)}),terrainRaster:rn,terrainDepth:rn,skybox:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_sun_direction:new t.Uniform3f(e,n.u_sun_direction),u_cubemap:new t.Uniform1i(e,n.u_cubemap),u_opacity:new t.Uniform1f(e,n.u_opacity),u_temporal_offset:new t.Uniform1f(e,n.u_temporal_offset)}),skyboxGradient:(e,n)=>({u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_color_ramp:new t.Uniform1i(e,n.u_color_ramp),u_center_direction:new t.Uniform3f(e,n.u_center_direction),u_radius:new t.Uniform1f(e,n.u_radius),u_opacity:new t.Uniform1f(e,n.u_opacity),u_temporal_offset:new t.Uniform1f(e,n.u_temporal_offset)}),skyboxCapture:(e,n)=>({u_matrix_3f:new t.UniformMatrix3f(e,n.u_matrix_3f),u_sun_direction:new t.Uniform3f(e,n.u_sun_direction),u_sun_intensity:new t.Uniform1f(e,n.u_sun_intensity),u_color_tint_r:new t.Uniform4f(e,n.u_color_tint_r),u_color_tint_m:new t.Uniform4f(e,n.u_color_tint_m),u_luminance:new t.Uniform1f(e,n.u_luminance)})};let Vn;function Gn(e,n,r,i,o,s,a){const l=e.context,u=l.gl,c=e.useProgram("collisionBox"),h=[];let p=0,f=0;for(let d=0;d<i.length;d++){const g=i[d],m=n.getTile(g),A=m.getBucket(r);if(!A)continue;let y=g.projMatrix;0===o[0]&&0===o[1]||(y=e.translatePosMatrix(g.projMatrix,m,o,s));const _=a?A.textCollisionBox:A.iconCollisionBox,v=A.collisionCircleArray;if(v.length>0){const n=t.create$1(),r=y;t.mul$1(n,A.placementInvProjMatrix,e.transform.glCoordMatrix),t.mul$1(n,n,A.placementViewportMatrix),h.push({circleArray:v,circleOffset:f,transform:r,invTransform:n}),p+=v.length/4,f=p}_&&(e.terrain&&e.terrain.setupElevationDraw(m,c),c.draw(l,u.LINES,t.DepthMode.disabled,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.disabled,Sn(y,e.transform,m),r.id,_.layoutVertexBuffer,_.indexBuffer,_.segments,null,e.transform.zoom,null,_.collisionVertexBuffer,_.collisionVertexBufferExt))}if(!a||!h.length)return;const d=e.useProgram("collisionCircle"),g=new t.StructArrayLayout2f1f2i16;g.resize(4*p),g._trim();let m=0;for(const t of h)for(let e=0;e<t.circleArray.length/4;e++){const n=4*e,r=t.circleArray[n+0],i=t.circleArray[n+1],o=t.circleArray[n+2],s=t.circleArray[n+3];g.emplace(m++,r,i,o,s,0),g.emplace(m++,r,i,o,s,1),g.emplace(m++,r,i,o,s,2),g.emplace(m++,r,i,o,s,3)}(!Vn||Vn.length<2*p)&&(Vn=function(e){const n=2*e,r=new t.StructArrayLayout3ui6;r.resize(n),r._trim();for(let t=0;t<n;t++){const e=6*t;r.uint16[e+0]=4*t+0,r.uint16[e+1]=4*t+1,r.uint16[e+2]=4*t+2,r.uint16[e+3]=4*t+2,r.uint16[e+4]=4*t+3,r.uint16[e+5]=4*t+0}return r}(p));const A=l.createIndexBuffer(Vn,!0),y=l.createVertexBuffer(g,t.collisionCircleLayout.members,!0);for(const n of h){const i={u_matrix:n.transform,u_inv_matrix:n.invTransform,u_camera_to_center_distance:(_=e.transform).cameraToCenterDistance,u_viewport_size:[_.width,_.height]};d.draw(l,u.TRIANGLES,t.DepthMode.disabled,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.disabled,i,r.id,y,A,t.SegmentVector.simpleSegment(0,2*n.circleOffset,n.circleArray.length,n.circleArray.length/2),null,e.transform.zoom,null,null,null)}var _;y.destroy(),A.destroy()}const Zn=t.identity(new Float32Array(16));function qn(e,n,r,i,o,s){const{horizontalAlign:a,verticalAlign:l}=t.getAnchorAlignment(e),u=-(a-.5)*n,c=-(l-.5)*r,h=t.evaluateVariableOffset(e,i);return new t.pointGeometry((u/o+h[0])*s,(c/o+h[1])*s)}function Wn(e,n,r,i,o,s,a,l,u,c,h,p){const f=e.text.placedSymbolArray,d=e.text.dynamicLayoutVertexArray,g=e.icon.dynamicLayoutVertexArray,m={};d.clear();for(let g=0;g<f.length;g++){const A=f.get(g),y=e.allowVerticalPlacement&&!A.placedOrientation,_=A.hidden||!A.crossTileID||y?null:i[A.crossTileID];if(_){const i=new t.pointGeometry(A.tileAnchorX,A.tileAnchorY),f=p(i),g=Qt(i,r?l:a,f),y=Kt(s.cameraToCenterDistance,g.signedDistanceFromCamera);let v=o.evaluateSizeForFeature(e.textSizeData,c,A)*y/t.ONE_EM;r&&(v*=e.tilePixelRatio/u);const{width:b,height:x,anchor:w,textOffset:E,textScale:S}=_,T=qn(w,b,x,E,S,v),P=r?Qt(i.add(T),a,f).point:g.point.add(n?T.rotate(-s.angle):T),M=e.allowVerticalPlacement&&A.placedOrientation===t.WritingMode.vertical?Math.PI/2:0;for(let e=0;e<A.numGlyphs;e++)t.addDynamicAttributes(d,P,M);h&&A.associatedIconIndex>=0&&(m[A.associatedIconIndex]={shiftedAnchor:P,angle:M})}else le(A.numGlyphs,d)}if(h){g.clear();const n=e.icon.placedSymbolArray;for(let e=0;e<n.length;e++){const r=n.get(e);if(r.hidden)le(r.numGlyphs,g);else{const n=m[e];if(n)for(let e=0;e<r.numGlyphs;e++)t.addDynamicAttributes(g,n.shiftedAnchor,n.angle);else le(r.numGlyphs,g)}}e.icon.dynamicLayoutVertexBuffer.updateData(g)}e.text.dynamicLayoutVertexBuffer.updateData(d)}function Hn(t,e,n){return n.iconsInText&&e?"symbolTextAndIcon":t?"symbolSDF":"symbolIcon"}function Xn(e,n,r,i,o,s,a,l,u,c,h,p){const f=e.context,d=f.gl,g=e.transform,m="map"===l,A="map"===u,y=m&&"point"!==r.layout.get("symbol-placement"),_=m&&!A&&!y,v=void 0!==r.layout.get("symbol-sort-key").constantOr(1);let b=!1;const x=e.depthModeForSublayer(0,t.DepthMode.ReadOnly),w=r.layout.get("text-variable-anchor"),E=[],S=e.terrain&&A?["PITCH_WITH_MAP_TERRAIN"]:null;for(const l of i){const i=n.getTile(l),u=i.getBucket(r);if(!u)continue;const h=o?u.text:u.icon;if(!h||!h.segments.get().length)continue;const p=h.programConfigurations.get(r.id),f=o||u.sdfIcons,x=o?u.textSizeData:u.iconSizeData,T=A||0!==g.pitch,P=e.useProgram(Hn(f,o,u),p,S),M=t.evaluateSizeForZoom(x,g.zoom);let I,O,R,L,k=[0,0],D=null;if(o){if(O=i.glyphAtlasTexture,R=d.LINEAR,I=i.glyphAtlasTexture.size,u.iconsInText){k=i.imageAtlasTexture.size,D=i.imageAtlasTexture;const t="composite"===x.kind||"camera"===x.kind;L=T||e.options.rotating||e.options.zooming||t?d.LINEAR:d.NEAREST}}else{const t=1!==r.layout.get("icon-size").constantOr(0)||u.iconsNeedLinear;O=i.imageAtlasTexture,R=f||e.options.rotating||e.options.zooming||t||T?d.LINEAR:d.NEAREST,I=i.imageAtlasTexture.size}const N=C(i,1,e.transform.zoom),F=$t(l.projMatrix,A,m,e.transform,N),B=e.terrain&&A&&y?t.invert(new Float32Array(16),F):Zn,z=Yt(l.projMatrix,A,m,e.transform,N),j=w&&u.hasTextData(),U="none"!==r.layout.get("icon-text-fit")&&j&&u.hasIconData();if(y){const t=g.elevation;te(u,l.projMatrix,e,o,F,z,A,c,t?e=>t.getAtTileOffset(l,e.x,e.y):null)}const V=e.translatePosMatrix(l.projMatrix,i,s,a),G=y||o&&w||U?Zn:F,Z=e.translatePosMatrix(z,i,s,a,!0),q=f&&0!==r.paint.get(o?"text-halo-width":"icon-halo-width").constantOr(1);let W;W=f?u.iconsInText?Bn(x.kind,M,_,A,e,V,G,Z,I,k):Fn(x.kind,M,_,A,e,V,G,Z,o,I,!0):Nn(x.kind,M,_,A,e,V,G,Z,o,I);const H={program:P,buffers:h,uniformValues:W,atlasTexture:O,atlasTextureIcon:D,atlasInterpolation:R,atlasInterpolationIcon:L,isSDF:f,hasHalo:q,tile:i,labelPlaneMatrixInv:B};if(v&&u.canOverlap){b=!0;const e=h.segments.get();for(const n of e)E.push({segments:new t.SegmentVector([n]),sortKey:n.sortKey,state:H})}else E.push({segments:h.segments,sortKey:0,state:H})}b&&E.sort(((t,e)=>t.sortKey-e.sortKey));for(const t of E){const n=t.state;if(e.terrain&&e.terrain.setupElevationDraw(n.tile,n.program,{useDepthForOcclusion:!0,labelPlaneMatrixInv:n.labelPlaneMatrixInv}),f.activeTexture.set(d.TEXTURE0),n.atlasTexture.bind(n.atlasInterpolation,d.CLAMP_TO_EDGE),n.atlasTextureIcon&&(f.activeTexture.set(d.TEXTURE1),n.atlasTextureIcon&&n.atlasTextureIcon.bind(n.atlasInterpolationIcon,d.CLAMP_TO_EDGE)),n.isSDF){const i=n.uniformValues;n.hasHalo&&(i.u_is_halo=1,$n(n.buffers,t.segments,r,e,n.program,x,h,p,i)),i.u_is_halo=0}$n(n.buffers,t.segments,r,e,n.program,x,h,p,n.uniformValues)}}function $n(e,n,r,i,o,s,a,l,u){const c=i.context;o.draw(c,c.gl.TRIANGLES,s,a,l,t.CullFaceMode.disabled,u,r.id,e.layoutVertexBuffer,e.indexBuffer,n,r.paint,i.transform.zoom,e.programConfigurations.get(r.id),e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer)}function Yn(e,n,r,i,o,s,a){const l=e.context.gl,u=r.paint.get("fill-pattern"),c=u&&u.constantOr(1),h=r.getCrossfadeParameters();let p,f,d,g,m;a?(f=c&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",p=l.LINES):(f=c?"fillPattern":"fill",p=l.TRIANGLES);for(const A of i){const i=n.getTile(A);if(c&&!i.patternsLoaded())continue;const y=i.getBucket(r);if(!y)continue;e.prepareDrawTile(A);const _=y.programConfigurations.get(r.id),v=e.useProgram(f,_);c&&(e.context.activeTexture.set(l.TEXTURE0),i.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),_.updatePaintBuffers(h));const b=u.constantOr(null);if(b&&i.imageAtlas){const t=i.imageAtlas,e=t.patternPositions[b.to.toString()],n=t.patternPositions[b.from.toString()];e&&n&&_.setConstantPatternPositions(e,n)}const x=e.translatePosMatrix(A.projMatrix,i,r.paint.get("fill-translate"),r.paint.get("fill-translate-anchor"));if(a){g=y.indexBuffer2,m=y.segments2;const t=e.terrain&&e.terrain.renderingToTexture?e.terrain.drapeBufferSize:[l.drawingBufferWidth,l.drawingBufferHeight];d="fillOutlinePattern"===f&&c?xn(x,e,h,i,t):bn(x,t)}else g=y.indexBuffer,m=y.segments,d=c?vn(x,e,h,i):_n(x);e.prepareDrawProgram(e.context,v,A.toUnwrapped()),v.draw(e.context,p,o,e.stencilModeForClipping(A),s,t.CullFaceMode.disabled,d,r.id,y.layoutVertexBuffer,g,m,r.paint,e.transform.zoom,_)}}function Qn(e,n,r,i,o,s,a){const l=e.context,u=l.gl,c=r.paint.get("fill-extrusion-pattern"),h=c.constantOr(1),p=r.getCrossfadeParameters(),f=r.paint.get("fill-extrusion-opacity");for(const d of i){const i=n.getTile(d),g=i.getBucket(r);if(!g)continue;const m=g.programConfigurations.get(r.id),A=e.useProgram(h?"fillExtrusionPattern":"fillExtrusion",m);if(e.terrain){const t=e.terrain;if(!g.enableTerrain)continue;if(t.setupElevationDraw(i,A,{useMeterToDem:!0}),Kn(l,n,d,g,r,t),!g.centroidVertexBuffer){const t=A.attributes.a_centroid_pos;void 0!==t&&u.vertexAttrib2f(t,0,0)}}h&&(e.context.activeTexture.set(u.TEXTURE0),i.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),m.updatePaintBuffers(p));const y=c.constantOr(null);if(y&&i.imageAtlas){const t=i.imageAtlas,e=t.patternPositions[y.to.toString()],n=t.patternPositions[y.from.toString()];e&&n&&m.setConstantPatternPositions(e,n)}const _=e.translatePosMatrix(d.projMatrix,i,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),v=r.paint.get("fill-extrusion-vertical-gradient"),b=h?yn(_,e,v,f,d,p,i):An(_,e,v,f);e.prepareDrawProgram(l,A,d.toUnwrapped()),A.draw(l,l.gl.TRIANGLES,o,s,a,t.CullFaceMode.backCCW,b,r.id,g.layoutVertexBuffer,g.indexBuffer,g.segments,r.paint,e.transform.zoom,m,e.terrain?g.centroidVertexBuffer:null)}}function Kn(e,n,r,i,o,s){const a=[e=>{let n=e.canonical.x-1,r=e.wrap;return n<0&&(n=(1<<e.canonical.z)-1,r--),new t.OverscaledTileID(e.overscaledZ,r,e.canonical.z,n,e.canonical.y)},e=>{let n=e.canonical.x+1,r=e.wrap;return n===1<<e.canonical.z&&(n=0,r++),new t.OverscaledTileID(e.overscaledZ,r,e.canonical.z,n,e.canonical.y)},e=>new t.OverscaledTileID(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,(0===e.canonical.y?1<<e.canonical.z:e.canonical.y)-1),e=>new t.OverscaledTileID(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y===(1<<e.canonical.z)-1?0:e.canonical.y+1)],l=t=>{const e=n.getSource().maxzoom,r=t=>{const e=n.getTileByID(t);if(e&&e.hasData())return e.getBucket(o)};let i,s,a;return(t.overscaledZ===t.canonical.z||t.overscaledZ>=e)&&(i=r(t.key)),t.overscaledZ>=e&&(s=r(t.calculateScaledKey(t.overscaledZ+1))),t.overscaledZ>e&&(a=r(t.calculateScaledKey(t.overscaledZ-1))),i||s||a},u=[0,0,0],c=(e,n)=>(u[0]=Math.min(e.min.y,n.min.y),u[1]=Math.max(e.max.y,n.max.y),u[2]=t.EXTENT-n.min.x>e.max.x?n.min.x-t.EXTENT:e.max.x,u),h=(e,n)=>(u[0]=Math.min(e.min.x,n.min.x),u[1]=Math.max(e.max.x,n.max.x),u[2]=t.EXTENT-n.min.y>e.max.y?n.min.y-t.EXTENT:e.max.y,u),p=[(t,e)=>c(t,e),(t,e)=>c(e,t),(t,e)=>h(t,e),(t,e)=>h(e,t)],f=new t.pointGeometry(0,0);let d,g,m;const A=(e,n,i,o,a)=>{const l=[[o?i:e,o?e:i,0],[o?i:n,o?n:i,0]],u=a<0?t.EXTENT+a:a,c=[o?u:(e+n)/2,o?(e+n)/2:u,0];return 0===i&&a<0||0!==i&&a>0?s.getForTilePoints(m,[c],!0,g):l.push(c),s.getForTilePoints(r,l,!0,d),Math.max(l[0][2],l[1][2],c[2])/s.exaggeration()};for(let e=0;e<4;e++){const n=i.borders[e];if(0===n.length&&(i.borderDone[e]=!0),i.borderDone[e])continue;const o=m=a[e](r),u=l(o);if(!u||!u.enableTerrain)continue;if(g=s.findDEMTileFor(o),!g||!g.dem)continue;if(!d){const t=s.findDEMTileFor(r);if(!t||!t.dem)return;d=t}const c=(e<2?1:5)-e,h=u.borders[c];let y=0;for(let r=0;r<n.length;r++){const o=i.featuresOnBorder[n[r]],s=o.borders[e];let a;for(;y<h.length&&(a=u.featuresOnBorder[h[y]],!(a.borders[c][1]>s[0]+3));)u.borderDone[c]||u.encodeCentroid(void 0,a,!1),y++;if(a&&y<h.length){const n=y;let r=0;for(;!(a.borders[c][0]>s[1]-3)&&(r++,++y!==h.length);)a=u.featuresOnBorder[h[y]];if(a=u.featuresOnBorder[h[n]],o.intersectsCount()>1||a.intersectsCount()>1||1!==r){1!==r&&(y=n),i.encodeCentroid(void 0,o,!1),u.borderDone[c]||u.encodeCentroid(void 0,a,!1);continue}const l=p[e](o,a),d=e%2?t.EXTENT-1:0;f.x=A(l[0],Math.min(t.EXTENT-1,l[1]),d,e<2,l[2]),f.y=0,i.encodeCentroid(f,o,!1),u.borderDone[c]||u.encodeCentroid(f,a,!1)}else i.encodeCentroid(void 0,o,!1)}i.borderDone[e]=i.needsCentroidUpdate=!0,u.borderDone[c]||(u.borderDone[c]=u.needsCentroidUpdate=!0)}(i.needsCentroidUpdate||!i.centroidVertexBuffer&&0!==i.centroidVertexArray.length)&&i.uploadCentroid(e)}const Jn=new t.Color(1,0,0,1),tr=new t.Color(0,1,0,1),er=new t.Color(0,0,1,1),nr=new t.Color(1,0,1,1),rr=new t.Color(0,1,1,1);function ir(t,e,n,r){sr(t,0,e+n/2,t.transform.width,n,r)}function or(t,e,n,r){sr(t,e-n/2,0,n,t.transform.height,r)}function sr(e,n,r,i,o,s){const a=e.context,l=a.gl;l.enable(l.SCISSOR_TEST),l.scissor(n*t.exported.devicePixelRatio,r*t.exported.devicePixelRatio,i*t.exported.devicePixelRatio,o*t.exported.devicePixelRatio),a.clear({color:s}),l.disable(l.SCISSOR_TEST)}function ar(e,n,r){const i=e.context,o=i.gl,s=r.projMatrix,a=e.useProgram("debug"),l=n.getTileByID(r.key);e.terrain&&e.terrain.setupElevationDraw(l,a);const u=t.DepthMode.disabled,c=t.StencilMode.disabled,h=e.colorModeForRenderPass(),p="$debug";i.activeTexture.set(o.TEXTURE0),e.emptyTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE),a.draw(i,o.LINE_STRIP,u,c,h,t.CullFaceMode.disabled,Tn(s,t.Color.red),p,e.debugBuffer,e.tileBorderIndexBuffer,e.debugSegments);const f=l.latestRawTileData,d=Math.floor((f&&f.byteLength||0)/1024),g=n.getTile(r).tileSize,m=512/Math.min(g,512)*(r.overscaledZ/e.transform.zoom)*.5;let A=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(A+=` => ${r.overscaledZ}`),function(t,e){t.initDebugOverlayCanvas();const n=t.debugOverlayCanvas,r=t.context.gl,i=t.debugOverlayCanvas.getContext("2d");i.clearRect(0,0,n.width,n.height),i.shadowColor="white",i.shadowBlur=2,i.lineWidth=1.5,i.strokeStyle="white",i.textBaseline="top",i.font="bold 36px Open Sans, sans-serif",i.fillText(e,5,5),i.strokeText(e,5,5),t.debugOverlayTexture.update(n),t.debugOverlayTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}(e,`${A} ${d}kb`),a.draw(i,o.TRIANGLES,u,c,t.ColorMode.alphaBlended,t.CullFaceMode.disabled,Tn(s,t.Color.transparent,m),p,e.debugBuffer,e.quadTriangleIndexBuffer,e.debugSegments)}const lr=t.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:ur}=lr;function cr(t,e,n,r){t.emplaceBack(e,n,r)}class hr{constructor(e){this.vertexArray=new t.StructArrayLayout3f12,this.indices=new t.StructArrayLayout3ui6,cr(this.vertexArray,-1,-1,1),cr(this.vertexArray,1,-1,1),cr(this.vertexArray,-1,1,1),cr(this.vertexArray,1,1,1),cr(this.vertexArray,-1,-1,-1),cr(this.vertexArray,1,-1,-1),cr(this.vertexArray,-1,1,-1),cr(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=e.createVertexBuffer(this.vertexArray,ur),this.indexBuffer=e.createIndexBuffer(this.indices),this.segment=t.SegmentVector.simpleSegment(0,0,36,12)}}function pr(e,n,r,i,o,s){const a=e.gl,l=n.paint.get("sky-atmosphere-color"),u=n.paint.get("sky-atmosphere-halo-color"),c=n.paint.get("sky-atmosphere-sun-intensity"),h=((t,e,n,r,i)=>({u_matrix_3f:t,u_sun_direction:e,u_sun_intensity:n,u_color_tint_r:[r.r,r.g,r.b,r.a],u_color_tint_m:[i.r,i.g,i.b,i.a],u_luminance:5e-5}))(t.fromMat4([],i),o,c,l,u);a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+s,n.skyboxTexture,0),r.draw(e,a.TRIANGLES,t.DepthMode.disabled,t.StencilMode.disabled,t.ColorMode.unblended,t.CullFaceMode.frontCW,h,"skyboxCapture",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}const fr={symbol:function(e,n,r,i,o){if("translucent"!==e.renderPass)return;const s=t.StencilMode.disabled,a=e.colorModeForRenderPass();r.layout.get("text-variable-anchor")&&function(e,n,r,i,o,s,a){const l=n.transform,u="map"===o,c="map"===s;for(const o of e){const e=i.getTile(o),s=e.getBucket(r);if(!s||!s.text||!s.text.segments.get().length)continue;const h=t.evaluateSizeForZoom(s.textSizeData,l.zoom),p=C(e,1,n.transform.zoom),f=$t(o.projMatrix,c,u,n.transform,p),d="none"!==r.layout.get("icon-text-fit")&&s.hasIconData();if(h){const n=Math.pow(2,l.zoom-e.tileID.overscaledZ),r=l.elevation;Wn(s,u,c,a,t.symbolSize,l,f,o.projMatrix,n,h,d,r?t=>r.getAtTileOffset(o,t.x,t.y):t=>0)}}}(i,e,r,n,r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),o),0!==r.paint.get("icon-opacity").constantOr(1)&&Xn(e,n,r,i,!1,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),r.layout.get("icon-rotation-alignment"),r.layout.get("icon-pitch-alignment"),r.layout.get("icon-keep-upright"),s,a),0!==r.paint.get("text-opacity").constantOr(1)&&Xn(e,n,r,i,!0,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.layout.get("text-keep-upright"),s,a),n.map.showCollisionBoxes&&(Gn(e,n,r,i,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),!0),Gn(e,n,r,i,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),!1))},circle:function(e,n,r,i){if("translucent"!==e.renderPass)return;const o=r.paint.get("circle-opacity"),s=r.paint.get("circle-stroke-width"),a=r.paint.get("circle-stroke-opacity"),l=void 0!==r.layout.get("circle-sort-key").constantOr(1);if(0===o.constantOr(1)&&(0===s.constantOr(1)||0===a.constantOr(1)))return;const u=e.context,c=u.gl,h=e.depthModeForSublayer(0,t.DepthMode.ReadOnly),p=t.StencilMode.disabled,f=e.colorModeForRenderPass(),d=[];for(let o=0;o<i.length;o++){const s=i[o],a=n.getTile(s),u=a.getBucket(r);if(!u)continue;const c=u.programConfigurations.get(r.id),h=En(r),p={programConfiguration:c,program:e.useProgram("circle",c,h),layoutVertexBuffer:u.layoutVertexBuffer,indexBuffer:u.indexBuffer,uniformValues:wn(e,s,a,r),tile:a};if(l){const e=u.segments.get();for(const n of e)d.push({segments:new t.SegmentVector([n]),sortKey:n.sortKey,state:p})}else d.push({segments:u.segments,sortKey:0,state:p})}l&&d.sort(((t,e)=>t.sortKey-e.sortKey));for(const n of d){const{programConfiguration:i,program:o,layoutVertexBuffer:s,indexBuffer:a,uniformValues:l,tile:d}=n.state,g=n.segments;e.terrain&&e.terrain.setupElevationDraw(d,o,{useDepthForOcclusion:!0}),e.prepareDrawProgram(u,o,d.tileID.toUnwrapped()),o.draw(u,c.TRIANGLES,h,p,f,t.CullFaceMode.disabled,l,r.id,s,a,g,r.paint,e.transform.zoom,i)}},heatmap:function(e,n,r,i){if(0!==r.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){const o=e.context,s=o.gl,a=t.StencilMode.disabled,l=new t.ColorMode([s.ONE,s.ONE],t.Color.transparent,[!0,!0,!0,!0]);!function(t,e,n){const r=t.gl;t.activeTexture.set(r.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);let i=n.heatmapFbo;if(i)r.bindTexture(r.TEXTURE_2D,i.colorAttachment.get()),t.bindFramebuffer.set(i.framebuffer);else{const o=r.createTexture();r.bindTexture(r.TEXTURE_2D,o),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),i=n.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4,!1),function(t,e,n,r){const i=t.gl;i.texImage2D(i.TEXTURE_2D,0,i.RGBA,e.width/4,e.height/4,0,i.RGBA,t.extRenderToTextureHalfFloat?t.extTextureHalfFloat.HALF_FLOAT_OES:i.UNSIGNED_BYTE,null),r.colorAttachment.set(n)}(t,e,o,i)}}(o,e,r),o.clear({color:t.Color.transparent});for(let u=0;u<i.length;u++){const c=i[u];if(n.hasRenderableParent(c))continue;const h=n.getTile(c),p=h.getBucket(r);if(!p)continue;const f=p.programConfigurations.get(r.id),d=e.useProgram("heatmap",f),{zoom:g}=e.transform;e.terrain&&e.terrain.setupElevationDraw(h,d),e.prepareDrawProgram(o,d,c.toUnwrapped()),d.draw(o,s.TRIANGLES,t.DepthMode.disabled,a,l,t.CullFaceMode.disabled,Pn(c.projMatrix,h,g,r.paint.get("heatmap-intensity")),r.id,p.layoutVertexBuffer,p.indexBuffer,p.segments,r.paint,e.transform.zoom,f)}o.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(e,n){const r=e.context,i=r.gl,o=n.heatmapFbo;if(!o)return;r.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,o.colorAttachment.get()),r.activeTexture.set(i.TEXTURE1);let s=n.colorRampTexture;s||(s=n.colorRampTexture=new t.Texture(r,n.colorRamp,i.RGBA)),s.bind(i.LINEAR,i.CLAMP_TO_EDGE),e.useProgram("heatmapTexture").draw(r,i.TRIANGLES,t.DepthMode.disabled,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.disabled,((t,e,n,r)=>({u_image:0,u_color_ramp:1,u_opacity:e.paint.get("heatmap-opacity")}))(0,n),n.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,n.paint,e.transform.zoom)}(e,r))},line:function(e,n,r,i){if("translucent"!==e.renderPass)return;const o=r.paint.get("line-opacity"),s=r.paint.get("line-width");if(0===o.constantOr(1)||0===s.constantOr(1))return;const a=e.depthModeForSublayer(0,t.DepthMode.ReadOnly),l=e.colorModeForRenderPass(),u=r.paint.get("line-dasharray"),c=u.constantOr(1),h=r.layout.get("line-cap"),p=r.paint.get("line-pattern"),f=p.constantOr(1),d=r.paint.get("line-gradient"),g=r.getCrossfadeParameters(),m=f?"linePattern":"line",A=e.context,y=A.gl;for(const o of i){const i=n.getTile(o);if(f&&!i.patternsLoaded())continue;const s=i.getBucket(r);if(!s)continue;e.prepareDrawTile(o);const _=s.programConfigurations.get(r.id),v=Rn(r),b=e.useProgram(m,_,v),x=p.constantOr(null);if(x&&i.imageAtlas){const t=i.imageAtlas,e=t.patternPositions[x.to.toString()],n=t.patternPositions[x.from.toString()];e&&n&&_.setConstantPatternPositions(e,n)}const w=u.constantOr(null),E=h.constantOr(null);if(!f&&w&&E&&i.lineAtlas){const t=i.lineAtlas,e=t.getDash(w.to,E),n=t.getDash(w.from,E);e&&n&&_.setConstantPatternPositions(e,n)}const S=e.terrain?o.projMatrix:null,T=f?Cn(e,i,r,g,S):Mn(e,i,r,g,S,s.lineClipsArray.length);if(d){const i=s.gradients[r.id];let a=i.texture;if(r.gradientVersion!==i.version){let l=256;if(r.stepInterpolant){const r=n.getSource().maxzoom,i=o.canonical.z===r?Math.ceil(1<<e.transform.maxZoom-o.canonical.z):1;l=t.clamp(t.nextPowerOfTwo(s.maxLineLength/t.EXTENT*1024*i),256,A.maxTextureSize)}i.gradient=t.renderColorRamp({expression:r.gradientExpression(),evaluationKey:"lineProgress",resolution:l,image:i.gradient||void 0,clips:s.lineClipsArray}),i.texture?i.texture.update(i.gradient):i.texture=new t.Texture(A,i.gradient,y.RGBA),i.version=r.gradientVersion,a=i.texture}A.activeTexture.set(y.TEXTURE1),a.bind(r.stepInterpolant?y.NEAREST:y.LINEAR,y.CLAMP_TO_EDGE)}c&&(A.activeTexture.set(y.TEXTURE0),i.lineAtlasTexture.bind(y.LINEAR,y.REPEAT),_.updatePaintBuffers(g)),f&&(A.activeTexture.set(y.TEXTURE0),i.imageAtlasTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE),_.updatePaintBuffers(g)),e.prepareDrawProgram(A,b,o.toUnwrapped()),b.draw(A,y.TRIANGLES,a,e.stencilModeForClipping(o),l,t.CullFaceMode.disabled,T,r.id,s.layoutVertexBuffer,s.indexBuffer,s.segments,r.paint,e.transform.zoom,_,s.layoutVertexBuffer2)}},fill:function(e,n,r,i){const o=r.paint.get("fill-color"),s=r.paint.get("fill-opacity");if(0===s.constantOr(1))return;const a=e.colorModeForRenderPass(),l=r.paint.get("fill-pattern"),u=e.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===o.constantOr(t.Color.transparent).a&&1===s.constantOr(0)?"opaque":"translucent";if(e.renderPass===u){const o=e.depthModeForSublayer(1,"opaque"===e.renderPass?t.DepthMode.ReadWrite:t.DepthMode.ReadOnly);Yn(e,n,r,i,o,a,!1)}if("translucent"===e.renderPass&&r.paint.get("fill-antialias")){const o=e.depthModeForSublayer(r.getPaintProperty("fill-outline-color")?2:0,t.DepthMode.ReadOnly);Yn(e,n,r,i,o,a,!0)}},"fill-extrusion":function(e,n,r,i){const o=r.paint.get("fill-extrusion-opacity");if(0!==o&&"translucent"===e.renderPass){const s=new t.DepthMode(e.context.gl.LEQUAL,t.DepthMode.ReadWrite,e.depthRangeFor3D);if(1!==o||r.paint.get("fill-extrusion-pattern").constantOr(1))Qn(e,n,r,i,s,t.StencilMode.disabled,t.ColorMode.disabled),Qn(e,n,r,i,s,e.stencilModeFor3D(),e.colorModeForRenderPass());else{const o=e.colorModeForRenderPass();Qn(e,n,r,i,s,t.StencilMode.disabled,o)}}},hillshade:function(e,n,r,i){if("offscreen"!==e.renderPass&&"translucent"!==e.renderPass)return;const o=e.context,s=e.depthModeForSublayer(0,t.DepthMode.ReadOnly),a=e.colorModeForRenderPass(),l=e.terrain&&e.terrain.renderingToTexture,[u,c]="translucent"!==e.renderPass||l?[{},i]:e.stencilConfigForOverlap(i);for(const i of c){const o=n.getTile(i);if(o.needsHillshadePrepare&&"offscreen"===e.renderPass)nn(e,o,r,s,t.StencilMode.disabled,a);else if("translucent"===e.renderPass){const t=l&&e.terrain?e.terrain.stencilModeForRTTOverlap(i):u[i.overscaledZ];tn(e,i,o,r,s,t,a)}}o.viewport.set([0,0,e.width,e.height])},raster:function(e,n,r,i,o,s){if("translucent"!==e.renderPass)return;if(0===r.paint.get("raster-opacity"))return;if(!i.length)return;const a=e.context,l=a.gl,u=n.getSource(),c=e.useProgram("raster"),h=e.colorModeForRenderPass(),p=e.terrain&&e.terrain.renderingToTexture,[f,d]=u instanceof Et||p?[{},i]:e.stencilConfigForOverlap(i),g=d[d.length-1].overscaledZ,m=!e.options.moving;for(const i of d){const o=p?t.DepthMode.disabled:e.depthModeForSublayer(i.overscaledZ-g,1===r.paint.get("raster-opacity")?t.DepthMode.ReadWrite:t.DepthMode.ReadOnly,l.LESS),d=i.toUnwrapped(),A=n.getTile(i);if(p&&(!A||!A.hasData()))continue;const y=p?i.projMatrix:e.transform.calculateProjMatrix(d,m),_=e.terrain&&p?e.terrain.stencilModeForRTTOverlap(i):f[i.overscaledZ],v=s?0:r.paint.get("raster-fade-duration");A.registerFadeDuration(v);const b=n.findLoadedParent(i,0),x=cn(A,b,n,e.transform,v);let w,E;e.terrain&&e.terrain.prepareDrawTile(i);const S="nearest"===r.paint.get("raster-resampling")?l.NEAREST:l.LINEAR;a.activeTexture.set(l.TEXTURE0),A.texture.bind(S,l.CLAMP_TO_EDGE,l.LINEAR_MIPMAP_NEAREST),a.activeTexture.set(l.TEXTURE1),b?(b.texture.bind(S,l.CLAMP_TO_EDGE,l.LINEAR_MIPMAP_NEAREST),w=Math.pow(2,b.tileID.overscaledZ-A.tileID.overscaledZ),E=[A.tileID.canonical.x*w%1,A.tileID.canonical.y*w%1]):A.texture.bind(S,l.CLAMP_TO_EDGE,l.LINEAR_MIPMAP_NEAREST);const T=kn(y,E||[0,0],w||1,x,r);e.prepareDrawProgram(a,c,d),u instanceof Et?c.draw(a,l.TRIANGLES,o,t.StencilMode.disabled,h,t.CullFaceMode.disabled,T,r.id,u.boundsBuffer,e.quadTriangleIndexBuffer,u.boundsSegments):c.draw(a,l.TRIANGLES,o,_,h,t.CullFaceMode.disabled,T,r.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}},background:function(e,n,r,i){const o=r.paint.get("background-color"),s=r.paint.get("background-opacity");if(0===s)return;const a=e.context,l=a.gl,u=e.transform,c=u.tileSize,h=r.paint.get("background-pattern");if(e.isPatternMissing(h))return;const p=!h&&1===o.a&&1===s&&e.opaquePassEnabledForLayer()?"opaque":"translucent";if(e.renderPass!==p)return;const f=t.StencilMode.disabled,d=e.depthModeForSublayer(0,"opaque"===p?t.DepthMode.ReadWrite:t.DepthMode.ReadOnly),g=e.colorModeForRenderPass(),m=e.useProgram(h?"backgroundPattern":"background"),A=i||u.coveringTiles({tileSize:c});h&&(a.activeTexture.set(l.TEXTURE0),e.imageManager.bind(e.context));const y=r.getCrossfadeParameters();for(const n of A){const u=n.toUnwrapped(),p=i?n.projMatrix:e.transform.calculateProjMatrix(u);e.prepareDrawTile(n);const A=h?jn(p,s,e,h,{tileID:n,tileSize:c},y):zn(p,s,o);e.prepareDrawProgram(a,m,u),m.draw(a,l.TRIANGLES,d,f,g,t.CullFaceMode.disabled,A,r.id,e.tileExtentBuffer,e.quadTriangleIndexBuffer,e.tileExtentSegments)}},sky:function(e,n,r){const i=r.paint.get("sky-opacity");if(0===i)return;const o=e.context,s=r.paint.get("sky-type"),a=new t.DepthMode(o.gl.LEQUAL,t.DepthMode.ReadOnly,[0,1]),l=e.frameCounter/1e3%1;"atmosphere"===s?"offscreen"===e.renderPass?r.needsSkyboxCapture(e)&&(function(e,n,r,i){const o=e.context,s=o.gl;let a=n.skyboxFbo;if(!a){a=n.skyboxFbo=o.createFramebuffer(32,32,!1),n.skyboxGeometry=new hr(o),n.skyboxTexture=o.gl.createTexture(),s.bindTexture(s.TEXTURE_CUBE_MAP,n.skyboxTexture),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_MAG_FILTER,s.LINEAR);for(let t=0;t<6;++t)s.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,s.RGBA,32,32,0,s.RGBA,s.UNSIGNED_BYTE,null)}o.bindFramebuffer.set(a.framebuffer),o.viewport.set([0,0,32,32]);const l=n.getCenter(e,!0),u=e.useProgram("skyboxCapture"),c=new Float64Array(16);t.identity(c),t.rotateY(c,c,.5*-Math.PI),pr(o,n,u,c,l,0),t.identity(c),t.rotateY(c,c,.5*Math.PI),pr(o,n,u,c,l,1),t.identity(c),t.rotateX(c,c,.5*-Math.PI),pr(o,n,u,c,l,2),t.identity(c),t.rotateX(c,c,.5*Math.PI),pr(o,n,u,c,l,3),t.identity(c),pr(o,n,u,c,l,4),t.identity(c),t.rotateY(c,c,Math.PI),pr(o,n,u,c,l,5),o.viewport.set([0,0,e.width,e.height])}(e,r),r.markSkyboxValid(e)):"sky"===e.renderPass&&function(e,n,r,i,o){const s=e.context,a=s.gl,l=e.transform,u=e.useProgram("skybox");s.activeTexture.set(a.TEXTURE0),a.bindTexture(a.TEXTURE_CUBE_MAP,n.skyboxTexture);const c=((t,e,n,r,i)=>({u_matrix:t,u_sun_direction:e,u_cubemap:0,u_opacity:r,u_temporal_offset:i}))(l.skyboxMatrix,n.getCenter(e,!1),0,i,o);e.prepareDrawProgram(s,u),u.draw(s,a.TRIANGLES,r,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.backCW,c,"skybox",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}(e,r,a,i,l):"gradient"===s&&"sky"===e.renderPass&&function(e,n,r,i,o){const s=e.context,a=s.gl,l=e.transform,u=e.useProgram("skyboxGradient");n.skyboxGeometry||(n.skyboxGeometry=new hr(s)),s.activeTexture.set(a.TEXTURE0);let c=n.colorRampTexture;c||(c=n.colorRampTexture=new t.Texture(s,n.colorRamp,a.RGBA)),c.bind(a.LINEAR,a.CLAMP_TO_EDGE);const h=((e,n,r,i,o)=>({u_matrix:e,u_color_ramp:0,u_center_direction:n,u_radius:t.degToRad(r),u_opacity:i,u_temporal_offset:o}))(l.skyboxMatrix,n.getCenter(e,!1),n.paint.get("sky-gradient-radius"),i,o);e.prepareDrawProgram(s,u),u.draw(s,a.TRIANGLES,r,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.backCW,h,"skyboxGradient",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}(e,r,a,i,l)},debug:function(t,e,n){for(let r=0;r<n.length;r++)ar(t,e,n[r])},custom:function(e,n,r){const i=e.context,o=r.implementation;if("offscreen"===e.renderPass){const t=o.prerender;t&&(e.setCustomLayerDefaults(),i.setColorMode(e.colorModeForRenderPass()),t.call(o,i.gl,e.transform.customLayerMatrix()),i.setDirty(),e.setBaseState())}else if("translucent"===e.renderPass){e.setCustomLayerDefaults(),i.setColorMode(e.colorModeForRenderPass()),i.setStencilMode(t.StencilMode.disabled);const n="3d"===o.renderingMode?new t.DepthMode(e.context.gl.LEQUAL,t.DepthMode.ReadWrite,e.depthRangeFor3D):e.depthModeForSublayer(0,t.DepthMode.ReadOnly);i.setDepthMode(n),o.render(i.gl,e.transform.customLayerMatrix()),i.setDirty(),e.setBaseState(),i.bindFramebuffer.set(null)}}};class dr{constructor(e,n){this.context=new vt(e),this.transform=n,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=t.SourceCache.maxUnderzooming+t.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Fe,this.gpuTimers={},this.frameCounter=0}updateTerrain(t,e){const n=!!t&&!!t.terrain;if(!(n||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new fn(this,t));const r=this._terrain;this.transform.elevation=n?r:null,r.update(t,this.transform,e)}_updateFog(t){const e=t.fog;if(!e||e.getOpacity(this.transform.pitch)<1||e.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[n,r]=e.getFovAdjustedRange(this.transform._fov);if(n>r)return void(this.transform.fogCullDistSq=null);const i=n+.78*(r-n);this.transform.fogCullDistSq=i*i}get terrain(){return this._terrain&&this._terrain.enabled?this._terrain:null}resize(e,n){if(this.width=e*t.exported.devicePixelRatio,this.height=n*t.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const t of this.style.order)this.style._layers[t].resize()}setup(){const e=this.context,n=new t.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(t.EXTENT,0),n.emplaceBack(0,t.EXTENT),n.emplaceBack(t.EXTENT,t.EXTENT),this.tileExtentBuffer=e.createVertexBuffer(n,t.posAttributes.members),this.tileExtentSegments=t.SegmentVector.simpleSegment(0,0,4,2);const r=new t.StructArrayLayout2i4;r.emplaceBack(0,0),r.emplaceBack(t.EXTENT,0),r.emplaceBack(0,t.EXTENT),r.emplaceBack(t.EXTENT,t.EXTENT),this.debugBuffer=e.createVertexBuffer(r,t.posAttributes.members),this.debugSegments=t.SegmentVector.simpleSegment(0,0,4,5);const i=new t.StructArrayLayout4i8;i.emplaceBack(0,0,0,0),i.emplaceBack(t.EXTENT,0,t.EXTENT,0),i.emplaceBack(0,t.EXTENT,0,t.EXTENT),i.emplaceBack(t.EXTENT,t.EXTENT,t.EXTENT,t.EXTENT),this.rasterBoundsBuffer=e.createVertexBuffer(i,wt.members),this.rasterBoundsSegments=t.SegmentVector.simpleSegment(0,0,4,2);const o=new t.StructArrayLayout2i4;o.emplaceBack(-1,-1),o.emplaceBack(1,-1),o.emplaceBack(-1,1),o.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(o,t.posAttributes.members),this.viewportSegments=t.SegmentVector.simpleSegment(0,0,4,2);const s=new t.StructArrayLayout1ui2;s.emplaceBack(0),s.emplaceBack(1),s.emplaceBack(3),s.emplaceBack(2),s.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(s);const a=new t.StructArrayLayout3ui6;a.emplaceBack(0,1,2),a.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(a),this.emptyTexture=new t.Texture(e,{width:1,height:1,data:new Uint8Array([0,0,0,0])},e.gl.RGBA),this.identityMat=t.create$1();const l=this.context.gl;this.stencilClearMode=new t.StencilMode({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO),this.loadTimeStamps.push(t.window.performance.now())}clearStencil(){const e=this.context,n=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this.useProgram("clippingMask").draw(e,n.TRIANGLES,t.DepthMode.disabled,this.stencilClearMode,t.ColorMode.disabled,t.CullFaceMode.disabled,un(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,n,r){if(!(n&&this.currentStencilSource!==n.id&&e.isTileClipped()&&r&&r.length))return;this.currentStencilSource=n.id;const i=this.context,o=i.gl;this.nextStencilID+r.length>256&&this.clearStencil(),i.setColorMode(t.ColorMode.disabled),i.setDepthMode(t.DepthMode.disabled);const s=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const e of r){const n=this._tileClippingMaskIDs[e.key]=this.nextStencilID++;s.draw(i,o.TRIANGLES,t.DepthMode.disabled,new t.StencilMode({func:o.ALWAYS,mask:0},n,255,o.KEEP,o.KEEP,o.REPLACE),t.ColorMode.disabled,t.CullFaceMode.disabled,un(e.projMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,n=this.context.gl;return new t.StencilMode({func:n.NOTEQUAL,mask:255},e,255,n.KEEP,n.KEEP,n.REPLACE)}stencilModeForClipping(e){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(e);const n=this.context.gl;return new t.StencilMode({func:n.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,n.KEEP,n.KEEP,n.REPLACE)}stencilConfigForOverlap(e){const n=this.context.gl,r=e.sort(((t,e)=>e.overscaledZ-t.overscaledZ)),i=r[r.length-1].overscaledZ,o=r[0].overscaledZ-i+1;if(o>1){this.currentStencilSource=void 0,this.nextStencilID+o>256&&this.clearStencil();const e={};for(let r=0;r<o;r++)e[r+i]=new t.StencilMode({func:n.GEQUAL,mask:255},r+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=o,[e,r]}return[{[i]:t.StencilMode.disabled},r]}colorModeForRenderPass(){const e=this.context.gl;if(this._showOverdrawInspector){const n=1/8;return new t.ColorMode([e.CONSTANT_COLOR,e.ONE],new t.Color(n,n,n,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?t.ColorMode.unblended:t.ColorMode.alphaBlended}depthModeForSublayer(e,n,r){if(!this.opaquePassEnabledForLayer())return t.DepthMode.disabled;const i=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new t.DepthMode(r||this.context.gl.LEQUAL,n,[i,i])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,n){this.style=e,this.options=n,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(t.exported.now()),this.imageManager.beginFrame();const r=this.style.order,i=this.style._sourceCaches;for(const t in i){const e=i[t];e.used&&e.prepare(this.context)}const o={},s={},a={};for(const t in i){const e=i[t];o[t]=e.getVisibleCoordinates(),s[t]=o[t].slice().reverse(),a[t]=e.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let t=0;t<r.length;t++)if(this.style._layers[r[t]].is3D()){this.opaquePassCutoff=t;break}if(this.terrain&&(this.terrain.updateTileBinding(a),this.opaquePassCutoff=0),!t.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const t of r){const n=this.style._layers[t],r=e._getLayerSourceCache(n);if(!n.hasOffscreenPass()||n.isHidden(this.transform.zoom))continue;const i=r?s[r.id]:void 0;("custom"===n.type||n.isSky()||i&&i.length)&&this.renderLayer(this,r,n,i)}this.depthRangeFor3D=[0,1-(e.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);let l=t.Color.transparent;if(this.style.fog&&(l=this.style.fog.properties.get("color")),this.context.clear({color:n.showOverdrawInspector?t.Color.black:l,depth:1}),this.clearStencil(),this._showOverdrawInspector=n.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=r.length-1;this.currentLayer>=0;this.currentLayer--){const t=this.style._layers[r[this.currentLayer]],n=e._getLayerSourceCache(t);if(t.isSky())continue;const i=n?s[n.id]:void 0;this._renderTileClippingMasks(t,n,i),this.renderLayer(this,n,t,i)}if(this.renderPass="sky",this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<r.length;this.currentLayer++){const t=this.style._layers[r[this.currentLayer]],n=e._getLayerSourceCache(t);t.isSky()&&this.renderLayer(this,n,t,n?s[n.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<r.length;){const t=this.style._layers[r[this.currentLayer]],n=e._getLayerSourceCache(t);if(t.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(t)){if(t.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const i=n?("symbol"===t.type?a:s)[n.id]:void 0;this._renderTileClippingMasks(t,n,n?o[n.id]:void 0),this.renderLayer(this,n,t,i),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let n=null;t.values(this.style._layers).forEach((t=>{const r=e._getLayerSourceCache(t);r&&!t.isHidden(this.transform.zoom)&&(!n||n.getSource().maxzoom<r.getSource().maxzoom)&&(n=r)})),n&&this.options.showTileBoundaries&&fr.debug(this,n,n.getVisibleCoordinates())}this.options.showPadding&&function(t){const e=t.transform.padding;ir(t,t.transform.height-(e.top||0),3,Jn),ir(t,e.bottom||0,3,tr),or(t,e.left||0,3,er),or(t,t.transform.width-(e.right||0),3,nr);const n=t.transform.centerPoint;!function(t,e,n,r){sr(t,e-1,n-10,2,20,r),sr(t,e-10,n-1,20,2,r)}(t,n.x,t.transform.height-n.y,rr)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%t.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(t.window.performance.now()),this.saveCanvasCopy())}renderLayer(t,e,n,r){n.isHidden(this.transform.zoom)||("background"===n.type||"sky"===n.type||"custom"===n.type||r&&r.length)&&(this.id=n.id,this.gpuTimingStart(n),fr[n.type](t,e,n,r,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(t){if(!this.options.gpuTiming)return;const e=this.context.extTimerQuery;let n=this.gpuTimers[t.id];n||(n=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:e.createQueryEXT()}),n.calls++,e.beginQueryEXT(e.TIME_ELAPSED_EXT,n.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}queryGpuTimers(t){const e={};for(const n in t){const r=t[n],i=this.context.extTimerQuery,o=i.getQueryObjectEXT(r.query,i.QUERY_RESULT_EXT)/1e6;i.deleteQueryEXT(r.query),e[n]=o}return e}translatePosMatrix(e,n,r,i,o){if(!r[0]&&!r[1])return e;const s=o?"map"===i?this.transform.angle:0:"viewport"===i?-this.transform.angle:0;if(s){const t=Math.sin(s),e=Math.cos(s);r=[r[0]*e-r[1]*t,r[0]*t+r[1]*e]}const a=[o?r[0]:C(n,r[0],this.transform.zoom),o?r[1]:C(n,r[1],this.transform.zoom),0],l=new Float32Array(16);return t.translate(l,e,a),l}saveTileTexture(t){const e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const e=this._tileTextures[t];return e&&e.length>0?e.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const e=this.imageManager.getPattern(t.from.toString()),n=this.imageManager.getPattern(t.to.toString());return!e||!n}currentGlobalDefines(){const t=this.terrain&&this.terrain.renderingToTexture,e=this.style&&this.style.fog,n=[];return this.terrain&&!this.terrain.renderingToTexture&&n.push("TERRAIN"),e&&!t&&0!==e.getOpacity(this.transform.pitch)&&n.push("FOG"),t&&n.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&n.push("OVERDRAW_INSPECTOR"),n}useProgram(t,e,n){this.cache=this.cache||{};const r=n||[],i=this.currentGlobalDefines().concat(r),o=gn.cacheKey(t,i,e);return this.cache[o]||(this.cache[o]=new gn(this.context,t,Ye[t],e,Un[t],i)),this.cache[o]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=t.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new t.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}prepareDrawTile(t){this.terrain&&this.terrain.prepareDrawTile(t)}prepareDrawProgram(t,e,n){if(this.terrain&&this.terrain.renderingToTexture)return;const r=this.style.fog;if(r){const i=r.getOpacity(this.transform.pitch);0!==i&&e.setFogUniformValues(t,((t,e,n,r)=>{const i=e.properties.get("color"),o=t.frameCounter/1e3%1,s=[i.r/i.a,i.g/i.a,i.b/i.a,r];return{u_fog_matrix:n?t.transform.calculateFogTileMatrix(n):t.identityMat,u_fog_range:e.getFovAdjustedRange(t.transform._fov),u_fog_color:s,u_fog_horizon_blend:e.properties.get("horizon-blend"),u_fog_temporal_offset:o}})(this,r,n,i))}}setTileLoadedFlag(t){this.tileLoaded=t}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const t=this.context.gl,e=t.createTexture();return t.bindTexture(t.TEXTURE_2D,e),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,0,0,t.drawingBufferWidth,t.drawingBufferHeight,0),e}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const t=this.style&&this.style.fog;return!!t&&0!==t.getOpacity(this.transform.pitch)}}class gr{constructor(t=0,e=0,n=0,r=0){if(isNaN(t)||t<0||isNaN(e)||e<0||isNaN(n)||n<0||isNaN(r)||r<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=e,this.left=n,this.right=r}interpolate(e,n,r){return null!=n.top&&null!=e.top&&(this.top=t.number(e.top,n.top,r)),null!=n.bottom&&null!=e.bottom&&(this.bottom=t.number(e.bottom,n.bottom,r)),null!=n.left&&null!=e.left&&(this.left=t.number(e.left,n.left,r)),null!=n.right&&null!=e.right&&(this.right=t.number(e.right,n.right,r)),this}getCenter(e,n){const r=t.clamp((this.left+e-this.right)/2,0,e),i=t.clamp((this.top+n-this.bottom)/2,0,n);return new t.pointGeometry(r,i)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new gr(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function mr(t,e){return[t[4*e],t[4*e+1],t[4*e+2],t[4*e+3]]}function Ar(t,e,n){t[4*e+0]=n[0],t[4*e+1]=n[1],t[4*e+2]=n[2],t[4*e+3]=n[3]}function yr(e,n){const r=mr(e,3);t.fromQuat(e,n),Ar(e,3,r)}function _r(t,e){Ar(t,3,[e[0],e[1],e[2],1])}function vr(e,n){const r=t.identity$1([]);return t.rotateZ$1(r,r,-n),t.rotateX$1(r,r,-e),r}function br(e,n){const r=[e[0],e[1],0],i=[n[0],n[1],0];if(t.length(r)>=1e-15){const e=t.normalize([],r);t.scale(i,e,t.dot(i,e)),n[0]=i[0],n[1]=i[1]}const o=t.cross([],n,e);if(t.len(o)<1e-15)return null;const s=Math.atan2(-o[1],o[0]);return vr(Math.atan2(Math.sqrt(e[0]*e[0]+e[1]*e[1]),-e[2]),s)}class xr{constructor(t,e){this.position=t,this.orientation=e}get position(){return this._position}set position(e){this._position=this._renderWorldCopies?function(e){if(!e)return;const n=Array.isArray(e)?new t.MercatorCoordinate(e[0],e[1],e[2]):e;return n.x=t.wrap(n.x,0,1),n}(e):e}lookAtPoint(e,n){if(this.orientation=null,!this.position)return;const r=this._elevation?this._elevation.getAtPointOrZero(t.MercatorCoordinate.fromLngLat(e)):0,i=this.position,o=t.MercatorCoordinate.fromLngLat(e,r),s=[o.x-i.x,o.y-i.y,o.z-i.z];n||(n=[0,0,1]),n[2]=Math.abs(n[2]),this.orientation=br(s,n)}setPitchBearing(e,n){this.orientation=vr(t.degToRad(e),t.degToRad(-n))}}class wr{constructor(e,n){this._transform=t.identity([]),this._orientation=t.identity$1([]),n&&(this._orientation=n,yr(this._transform,this._orientation)),e&&_r(this._transform,e)}get mercatorPosition(){const e=this.position;return new t.MercatorCoordinate(e[0],e[1],e[2])}get position(){const t=mr(this._transform,3);return[t[0],t[1],t[2]]}set position(t){_r(this._transform,t)}get orientation(){return this._orientation}set orientation(t){this._orientation=t,yr(this._transform,this._orientation)}getPitchBearing(){const t=this.forward(),e=this.right();return{bearing:Math.atan2(-e[1],e[0]),pitch:Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2])}}setPitchBearing(t,e){this._orientation=vr(t,e),yr(this._transform,this._orientation)}forward(){const t=mr(this._transform,2);return[-t[0],-t[1],-t[2]]}up(){const t=mr(this._transform,1);return[-t[0],-t[1],-t[2]]}right(){const t=mr(this._transform,0);return[t[0],t[1],t[2]]}getCameraToWorld(e,n){const r=new Float64Array(16);return t.invert(r,this.getWorldToCamera(e,n)),r}getWorldToCameraPosition(e,n,r){const i=this.position;t.scale(i,i,-e);const o=new Float64Array(16);return t.fromScaling(o,[r,r,r]),t.translate(o,o,i),o[10]*=n,o}getWorldToCamera(e,n){const r=new Float64Array(16),i=new Float64Array(4),o=this.position;return t.conjugate(i,this._orientation),t.scale(o,o,-e),t.fromQuat(r,i),t.translate(r,r,o),r[1]*=-1,r[5]*=-1,r[9]*=-1,r[13]*=-1,r[8]*=n,r[9]*=n,r[10]*=n,r[11]*=n,r}getCameraToClipPerspective(e,n,r,i){const o=new Float64Array(16);return t.perspective(o,e,n,r,i),o}getDistanceToElevation(e){const n=0===e?0:t.mercatorZfromAltitude(e,this.position[1]),r=this.forward();return(n-this.position[2])/r[2]}clone(){return new wr([...this.position],[...this.orientation])}}class Er{constructor(e,n,r,i,o){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===o||o,this._minZoom=e||0,this._maxZoom=n||22,this._minPitch=null==r?0:r,this._maxPitch=null==i?60:i,this.setMaxBounds(),this.width=0,this.height=0,this._center=new t.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new gr,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._camera=new wr,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._horizonShift=.1}clone(){const t=new Er(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t._elevation=this._elevation,t._centerAltitude=this._centerAltitude,t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t.cameraElevationReference=this.cameraElevationReference,t._center=this._center,t._setZoom(this.zoom),t._cameraZoom=this._cameraZoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._averageElevation=this._averageElevation,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._camera=this._camera.clone(),t._calcMatrices(),t.freezeTileCoverage=this.freezeTileCoverage,t}get elevation(){return this._elevation}set elevation(t){this._elevation!==t&&(this._elevation=t,t?this._updateCenterElevation()&&this._updateCameraOnTerrain():(this._cameraZoom=null,this._centerAltitude=0),this._calcMatrices())}updateElevation(t){this._terrainEnabled()&&null==this._cameraZoom&&this._updateCenterElevation()&&this._updateCameraOnTerrain(),t&&this._constrainCameraAltitude(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get pixelsPerMeter(){return t.mercatorZfromAltitude(1,this.center.lat)*this.worldSize}get cameraPixelsPerMeter(){return t.mercatorZfromAltitude(1,this.center.lat)*this.cameraWorldSize}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new t.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(e){const n=-t.wrap(e,-180,180)*Math.PI/180;var r;this.angle!==n&&(this._unmodified=!1,this.angle=n,this._calcMatrices(),this.rotationMatrix=(r=new t.ARRAY_TYPE(4),t.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0),r[0]=1,r[3]=1,r),function(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);t[0]=r*l+o*a,t[1]=i*l+s*a,t[2]=r*-a+o*l,t[3]=i*-a+s*l}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){const n=t.clamp(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==n&&(this._unmodified=!1,this._pitch=n,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(t){this._averageElevation=t,this._calcFogMatrices()}get zoom(){return this._zoom}set zoom(t){const e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._setZoom(e),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._constrain(),this._calcMatrices())}_setZoom(t){this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom}_updateCenterElevation(){if(!this._elevation)return!1;const e=this._elevation.getAtPointOrZero(t.MercatorCoordinate.fromLngLat(this.center),-1);return-1===e?(this._cameraZoom=null,!1):(this._centerAltitude=e,!0)}_updateCameraOnTerrain(){const e=this.cameraToCenterDistance/this.worldSize,n=t.mercatorZfromAltitude(this._centerAltitude,this.center.lat);this._cameraZoom=this._zoomFromMercatorZ(n+e)}sampleAverageElevation(){if(!this._elevation)return 0;const e=this._elevation,n=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],r=this.horizonLineFromTop();let i=0,o=0;for(let s=0;s<n.length;s++){const a=new t.pointGeometry(n[s][0]*this.width,r+n[s][1]*(this.height-r)),l=e.pointCoordinate(a);if(!l)continue;const u=1/Math.hypot(l[0]-this._camera.position[0],l[1]-this._camera.position[1]);i+=l[3]*u,o+=u}return 0===o?NaN:i/o}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCenterElevation()?this._updateCameraOnTerrain():this._cameraZoom=null:this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._cameraZoom||!this._elevation)return;const e=this._cameraZoom,n=this._elevation.getAtPointOrZero(t.MercatorCoordinate.fromLngLat(this.center)),r=t.mercatorZfromAltitude(n,this.center.lat),i=this._mercatorZfromZoom(e),o=this._mercatorZfromZoom(this._maxZoom),s=Math.max(i-r,o);this._setZoom(this._zoomFromMercatorZ(s))}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}computeZoomRelativeTo(e){const n=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,e.toAltitude()));let r;r=e.z<this._camera.position[2]?[n.x,n.y,n.z]:[e.x,e.y,e.z];const i=t.length(t.sub([],this._camera.position,r));return t.clamp(this._zoomFromMercatorZ(i),this._minZoom,this._maxZoom)}setFreeCameraOptions(e){if(!this.height)return;if(!e.position&&!e.orientation)return;this._updateCameraState();let n=!1;if(e.orientation&&!t.exactEquals(e.orientation,this._camera.orientation)&&(n=this._setCameraOrientation(e.orientation)),e.position){const r=[e.position.x,e.position.y,e.position.z];t.exactEquals$1(r,this._camera.position)||(this._setCameraPosition(r),n=!0)}n&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const e=this._camera.position,n=new xr;return n.position=new t.MercatorCoordinate(e[0],e[1],e[2]),n.orientation=this._camera.orientation,n._elevation=this.elevation,n._renderWorldCopies=this._renderWorldCopies,n}_setCameraOrientation(e){if(!t.length$1(e))return!1;t.normalize$1(e,e);const n=t.transformQuat([],[0,0,-1],e),r=t.transformQuat([],[0,-1,0],e);if(r[2]<0)return!1;const i=br(n,r);return!!i&&(this._camera.orientation=i,!0)}_setCameraPosition(e){const n=this.zoomScale(this.minZoom)*this.tileSize,r=this.zoomScale(this.maxZoom)*this.tileSize,i=this.cameraToCenterDistance;e[2]=t.clamp(e[2],i/r,i/n),this._camera.position=e}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,e,n){this._unmodified=!1,this._edgeInsets.interpolate(t,e,n),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const e=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,e)}getVisibleUnwrappedCoordinates(e){const n=[new t.UnwrappedTileID(0,e)];if(this._renderWorldCopies){const r=this.pointCoordinate(new t.pointGeometry(0,0)),i=this.pointCoordinate(new t.pointGeometry(this.width,0)),o=this.pointCoordinate(new t.pointGeometry(this.width,this.height)),s=this.pointCoordinate(new t.pointGeometry(0,this.height)),a=Math.floor(Math.min(r.x,i.x,o.x,s.x)),l=Math.floor(Math.max(r.x,i.x,o.x,s.x)),u=1;for(let r=a-u;r<=l+u;r++)0!==r&&n.push(new t.UnwrappedTileID(r,e))}return n}coveringTiles(e){let n=this.coveringZoomLevel(e);const r=n,i=this.elevation&&!e.isTerrainDEM;if(void 0!==e.minzoom&&n<e.minzoom)return[];void 0!==e.maxzoom&&n>e.maxzoom&&(n=e.maxzoom);const o=t.MercatorCoordinate.fromLngLat(this.center),s=1<<n,a=[s*o.x,s*o.y,0],l=f.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n),u=this.pointCoordinate(this.getCameraPoint()),c=s*t.mercatorZfromAltitude(1,this.center.lat),h=this._camera.position[2]/t.mercatorZfromAltitude(1,this.center.lat),p=[s*u.x,s*u.y,h],g=this.cameraToCenterDistance/e.tileSize*(e.roundZoom?1:.502),m=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation?n:0,A=e.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,y=e.isTerrainDEM?-A:this._elevation?this._elevation.getMinElevationBelowMSL():0,_=t=>({aabb:new d([t*s,0,y],[(t+1)*s,s,A]),zoom:0,x:0,y:0,wrap:t,fullyVisible:!1}),v=[];let b=[];const x=n,w=e.reparseOverscaled?r:n,E=t=>{if(!this._elevation||!t.tileID)return;const e=this._elevation.getMinMaxForTile(t.tileID),n=t.aabb;e?(n.min[2]=e.min,n.max[2]=e.max,n.center[2]=(n.min[2]+n.max[2])/2):(t.shouldSplit=P(t),t.shouldSplit||(n.min[2]=n.max[2]=n.center[2]=this._centerAltitude))},S=t=>t*t,T=S((h-this._centerAltitude)*c),P=t=>{if(t.zoom<m)return!0;if(t.zoom===x)return!1;if(null!=t.shouldSplit)return t.shouldSplit;const e=t.aabb.distanceX(p),n=t.aabb.distanceY(p);let r=T;i&&(r=S(t.aabb.distanceZ(p)*c));const o=e*e+n*n+r;return o<S((1<<x-t.zoom)*g*((t,e)=>{if(e*S(.707)<t)return 1;const n=Math.sqrt(e/t);return n/(1.4144271570014144+(Math.pow(1.1,n-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(r,T),o))};if(this._renderWorldCopies)for(let t=1;t<=3;t++)v.push(_(-t)),v.push(_(t));for(v.push(_(0));v.length>0;){const r=v.pop(),o=r.x,s=r.y;let u=r.fullyVisible;if(!u){const t=r.aabb.intersects(l);if(0===t)continue;u=2===t}if(r.zoom!==x&&P(r))for(let e=0;e<4;e++){const n=(o<<1)+e%2,a=(s<<1)+(e>>1),l={aabb:r.aabb.quadrant(e),zoom:r.zoom+1,x:n,y:a,wrap:r.wrap,fullyVisible:u,tileID:void 0,shouldSplit:void 0};i&&(l.tileID=new t.OverscaledTileID(r.zoom+1===x?w:r.zoom+1,r.wrap,r.zoom+1,n,a),E(l)),v.push(l)}else{const i=r.zoom===x?w:r.zoom;if(e.minzoom&&e.minzoom>i)continue;const l=a[0]-(.5+o+(r.wrap<<r.zoom))*(1<<n-r.zoom),u=a[1]-.5-s,c=r.tileID?r.tileID:new t.OverscaledTileID(i,r.wrap,r.zoom,o,s);b.push({tileID:c,distanceSq:l*l+u*u})}}if(this.fogCullDistSq){const n=this.fogCullDistSq,r=this.horizonLineFromTop();b=b.filter((i=>{const o=[0,0,0,1],s=[t.EXTENT,t.EXTENT,0,1],a=this.calculateFogTileMatrix(i.tileID.toUnwrapped());t.transformMat4(o,o,a),t.transformMat4(s,s,a);const l=t.getAABBPointSquareDist(o,s);if(0===l)return!0;let u=!1;const c=this._elevation;if(c&&l>n&&0!==r){const n=this.calculateProjMatrix(i.tileID.toUnwrapped());let o;e.isTerrainDEM||(o=c.getMinMaxForTile(i.tileID)),o||(o={min:y,max:A});const s=t.furthestTileCorner(this.bearing),a=[s[0]*t.EXTENT,s[1]*t.EXTENT,o.max];t.transformMat4$1(a,a,n),u=(1-a[1])*this.height*.5<r}return l<n||u}))}return b.sort(((t,e)=>t.distanceSq-e.distanceSq)).map((t=>t.tileID))}resize(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(e){const n=t.clamp(e.lat,-this.maxValidLatitude,this.maxValidLatitude);return new t.pointGeometry(t.mercatorXfromLng(e.lng)*this.worldSize,t.mercatorYfromLat(n)*this.worldSize)}unproject(e){return new t.MercatorCoordinate(e.x/this.worldSize,e.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}setLocationAtPoint(e,n){const r=this.pointCoordinate(n),i=this.pointCoordinate(this.centerPoint),o=this.locationCoordinate(e),s=new t.MercatorCoordinate(o.x-(r.x-i.x),o.y-(r.y-i.y));this.center=this.coordinateLocation(s),this._renderWorldCopies&&(this.center=this.center.wrap())}setLocation(t){this.center=this.coordinateLocation(t),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(t){return this._coordinatePoint(this.locationCoordinate(t),!1)}locationPoint3D(t){return this._coordinatePoint(this.locationCoordinate(t),!0)}pointLocation(t){return this.coordinateLocation(this.pointCoordinate(t))}pointLocation3D(t){return this.coordinateLocation(this.pointCoordinate3D(t))}locationCoordinate(e){return t.MercatorCoordinate.fromLngLat(e)}coordinateLocation(t){return t.toLngLat()}pointRayIntersection(e,n){const r=null!=n?n:this._centerAltitude,i=[e.x,e.y,0,1],o=[e.x,e.y,1,1];t.transformMat4(i,i,this.pixelMatrixInverse),t.transformMat4(o,o,this.pixelMatrixInverse);const s=o[3];t.scale$2(i,i,1/i[3]),t.scale$2(o,o,1/s);const a=i[2],l=o[2];return{p0:i,p1:o,t:a===l?0:(r-a)/(l-a)}}screenPointToMercatorRay(e){const n=[e.x,e.y,0,1],r=[e.x,e.y,1,1];return t.transformMat4(n,n,this.pixelMatrixInverse),t.transformMat4(r,r,this.pixelMatrixInverse),t.scale$2(n,n,1/n[3]),t.scale$2(r,r,1/r[3]),n[2]=t.mercatorZfromAltitude(n[2],this._center.lat)*this.worldSize,r[2]=t.mercatorZfromAltitude(r[2],this._center.lat)*this.worldSize,t.scale$2(n,n,1/this.worldSize),t.scale$2(r,r,1/this.worldSize),new p([n[0],n[1],n[2]],t.normalize([],t.sub([],r,n)))}rayIntersectionCoordinate(e){const{p0:n,p1:r,t:i}=e,o=t.mercatorZfromAltitude(n[2],this._center.lat),s=t.mercatorZfromAltitude(r[2],this._center.lat);return new t.MercatorCoordinate(t.number(n[0],r[0],i)/this.worldSize,t.number(n[1],r[1],i)/this.worldSize,t.number(o,s,i))}pointCoordinate(e,n=this._centerAltitude){const r=this.horizonLineFromTop(!1),i=new t.pointGeometry(e.x,Math.max(r,e.y));return this.rayIntersectionCoordinate(this.pointRayIntersection(i,n))}pointCoordinate3D(e){if(!this.elevation)return this.pointCoordinate(e);const n=this.elevation;let r=this.elevation.pointCoordinate(e);if(r)return new t.MercatorCoordinate(r[0],r[1],r[2]);let i=0,o=this.horizonLineFromTop();if(e.y>o)return this.pointCoordinate(e);const s=.02*o,a=e.clone();for(let e=0;e<10&&o-i>s;e++){a.y=t.number(i,o,.66);const e=n.pointCoordinate(a);e?(o=a.y,r=e):i=a.y}return r?new t.MercatorCoordinate(r[0],r[1],r[2]):this.pointCoordinate(e)}isPointAboveHorizon(t){if(this.elevation)return!this.elevation.pointCoordinate(t);{const e=this.horizonLineFromTop();return t.y<e}}_coordinatePoint(e,n){const r=n&&this.elevation?this.elevation.getAtPointOrZero(e,this._centerAltitude):this._centerAltitude,i=[e.x*this.worldSize,e.y*this.worldSize,r+e.toAltitude(),1];return t.transformMat4(i,i,this.pixelMatrix),i[3]>0?new t.pointGeometry(i[0]/i[3],i[1]/i[3]):new t.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBounds(e,n){const r=new t.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),i=new t.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),o=new t.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),s=new t.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let a=this.pointCoordinate(r,e),l=this.pointCoordinate(i,e);const u=this.pointCoordinate(o,n),c=this.pointCoordinate(s,n),h=(t,e)=>(e.y-t.y)/(e.x-t.x);return a.y>1&&l.y>=0?a=new t.MercatorCoordinate((1-c.y)/h(c,a)+c.x,1):a.y<0&&l.y<=1&&(a=new t.MercatorCoordinate(-c.y/h(c,a)+c.x,0)),l.y>1&&a.y>=0?l=new t.MercatorCoordinate((1-u.y)/h(u,l)+u.x,1):l.y<0&&a.y<=1&&(l=new t.MercatorCoordinate(-u.y/h(u,l)+u.x,0)),(new t.LngLatBounds).extend(this.coordinateLocation(a)).extend(this.coordinateLocation(l)).extend(this.coordinateLocation(c)).extend(this.coordinateLocation(u))}_getBounds3D(){const t=this.elevation,e=t.visibleDemTiles.reduce(((t,e)=>{if(e.dem){const n=e.dem.tree;t.min=Math.min(t.min,n.minimums[0]),t.max=Math.max(t.max,n.maximums[0])}return t}),{min:Number.MAX_VALUE,max:0});return this._getBounds(e.min*t.exaggeration(),e.max*t.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(t=!0){const e=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,n=this.height/2-e*(1-this._horizonShift);return t?Math.max(0,n):n}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new t.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}setMaxBounds(t){if(t){const e=t.getEast(),n=t.getWest();this.lngRange=[n,e>n?e:e+360],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()}else this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude]}calculatePosMatrix(e,n){const r=e.canonical,i=n/this.zoomScale(r.z),o=r.x+Math.pow(2,r.z)*e.wrap,s=t.identity(new Float64Array(16));return t.translate(s,s,[o*i,r.y*i,0]),t.scale$1(s,s,[i/t.EXTENT,i/t.EXTENT,1]),s}calculateFogTileMatrix(e){const n=e.key,r=this._fogTileMatrixCache;if(r[n])return r[n];const i=this.calculatePosMatrix(e,this.cameraWorldSize);return t.multiply(i,this.worldToFogMatrix,i),r[n]=new Float32Array(i),r[n]}calculateProjMatrix(e,n=!1){const r=e.key,i=n?this._alignedProjMatrixCache:this._projMatrixCache;if(i[r])return i[r];const o=this.calculatePosMatrix(e,this.worldSize);return t.multiply(o,n?this.alignedProjMatrix:this.projMatrix,o),i[r]=new Float32Array(o),i[r]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation)return;const e=this._elevation;this._updateCameraState();const n=this._camera.position,r=this._camera.forward();if(n[2]<=0||r[2]>=0)return;const i=t.mercatorZfromAltitude(1,this._center.lat);n[2]/=i,r[2]/=i,t.normalize(r,r);const o=e.raycast(n,r,e.exaggeration());if(o){const e=t.scaleAndAdd([],n,r,o),i=new t.MercatorCoordinate(e[0],e[1],t.mercatorZfromAltitude(e[2],t.latFromMercatorY(e[1]))),s=this._camera.position,a=i.z+t.length([i.x-s[0],i.y-s[1],i.z-s[2]]);this._cameraZoom=this._zoomFromMercatorZ(a),this._centerAltitude=i.toAltitude(),this._center=i.toLngLat(),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const e=this._elevation;this._updateCameraState();const n=e.getAtPointOrZero(this._camera.mercatorPosition),r=this._minimumHeightOverTerrain()*Math.cos(t.degToRad(this._maxPitch)),i=t.mercatorZfromAltitude(n,this._center.lat),o=this._camera.position[2]-i;if(o<r){const e=t.MercatorCoordinate.fromLngLat(this._center,this._centerAltitude),n=this._camera.mercatorPosition,i=[e.x-n.x,e.y-n.y,e.z-n.z],s=t.length(i);i[2]-=r-o;const a=t.length(i);if(0===a)return;t.scale(i,i,s/a),this._camera.position=[e.x-i[0],e.y-i[1],e.z-i[2]],this._camera.orientation=br(i,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let e,n,r,i,o,s=1/0,a=-1/0;const l=this.size,u=this._unmodified;if(this.latRange){const e=this.latRange;s=t.mercatorYfromLat(e[1])*this.worldSize,a=t.mercatorYfromLat(e[0])*this.worldSize,r=a-s<l.y?l.y/(a-s):0}if(this.lngRange){const r=this.lngRange;e=t.mercatorXfromLng(r[0])*this.worldSize,n=t.mercatorXfromLng(r[1])*this.worldSize,i=n-e<l.x?l.x/(n-e):0}const c=this.point,h=Math.max(i||0,r||0);if(h)return this.center=this.unproject(new t.pointGeometry(i?(n+e)/2:c.x,r?(a+s)/2:c.y)),this.zoom+=this.scaleZoom(h),this._unmodified=u,void(this._constraining=!1);if(this.latRange){const t=c.y,e=l.y/2;t-e<s&&(o=s+e),t+e>a&&(o=a-e)}let p=c.x;if(this.lngRange){const t=this.worldSize/2-(e+n)/2;p=(p+t+this.worldSize)%this.worldSize,e+=t,n+=t;const r=l.x/2;p-r<e&&(p=e+r),p+r>n&&(p=n-r),p-=t}p===c.x&&void 0===o||(this.center=this.unproject(new t.pointGeometry(p,void 0!==o?o:c.y))),this._constrainCameraAltitude(),this._unmodified=u,this._constraining=!1}_minZoomForBounds(){const e=(t,e)=>Math.log2(t/(this.tileSize*Math.abs(e[1]-e[0])));let n=0;if(this.latRange){const r=this.latRange;n=e(this.height,[t.mercatorYfromLat(r[0]),t.mercatorYfromLat(r[1])])}let r=0;if(this.lngRange){const n=this.lngRange;r=e(this.width,[t.mercatorXfromLng(n[0]),t.mercatorXfromLng(n[1])])}return Math.max(n,r)}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const e=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;const n=this.pixelsPerMeter;this._updateCameraState();const r=Math.PI/2+this._pitch,i=this.fovAboveCenter,o=this.elevation?this.elevation.getMinElevationBelowMSL()*n:0,s=(this._camera.position[2]*this.worldSize-o)/Math.cos(this._pitch),a=Math.sin(i)*s/Math.sin(t.clamp(Math.PI-r-i,.01,Math.PI-.01)),l=this.point,u=l.x,c=l.y,h=Math.cos(Math.PI/2-this._pitch)*a+s,p=Math.min(1.01*h,s*(1/this._horizonShift)),f=this.height/50,d=this._camera.getWorldToCamera(this.worldSize,n),g=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,f,p);g[8]=2*-e.x/this.width,g[9]=2*e.y/this.height;let m=t.mul$1([],g,d);this.mercatorMatrix=t.scale$1([],m,[this.worldSize,this.worldSize,this.worldSize/n]),this.projMatrix=m,this.invProjMatrix=t.invert(new Float64Array(16),this.projMatrix);const A=new Float32Array(16);t.identity(A),t.scale$1(A,A,[1,-1,1]),t.rotateX(A,A,this._pitch),t.rotateZ(A,A,this.angle);const y=t.perspective(new Float32Array(16),this._fov,this.width/this.height,f,p),_=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;y[8]=2*-e.x/this.width,y[9]=2*(e.y+_)/this.height,this.skyboxMatrix=t.multiply(A,y,A);const v=this.width%2/2,b=this.height%2/2,x=Math.cos(this.angle),w=Math.sin(this.angle),E=u-Math.round(u)+x*v+w*b,S=c-Math.round(c)+x*b+w*v,T=new Float64Array(m);if(t.translate(T,T,[E>.5?E-1:E,S>.5?S-1:S,0]),this.alignedProjMatrix=T,m=t.create$1(),t.scale$1(m,m,[this.width/2,-this.height/2,1]),t.translate(m,m,[1,-1,0]),this.labelPlaneMatrix=m,m=t.create$1(),t.scale$1(m,m,[1,-1,1]),t.translate(m,m,[-1,-1,0]),t.scale$1(m,m,[2/this.width,2/this.height,1]),this.glCoordMatrix=m,this.pixelMatrix=t.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),m=t.invert(new Float64Array(16),this.pixelMatrix),!m)throw new Error("failed to invert matrix");this.pixelMatrixInverse=m,this._projMatrixCache={},this._alignedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const e=this.cameraWorldSize,n=this.cameraPixelsPerMeter,r=this._camera.position,i=1/this.height,o=[e,e,n];t.scale(o,o,i),t.scale(r,r,-1),t.multiply$1(r,r,o);const s=t.create$1();t.translate(s,s,r),t.scale$1(s,s,o),this.mercatorFogMatrix=s,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(e,n,i)}_updateCameraState(){if(!this.height)return;this._camera.setPitchBearing(this._pitch,this.angle);const e=this._camera.forward(),n=this.cameraToCenterDistance,r=this.point,i=this._mercatorZfromZoom(this._cameraZoom?this._cameraZoom:this._zoom)-t.mercatorZfromAltitude(this._centerAltitude,this.center.lat),o=this.cameraToCenterDistance/i;this._camera.position=[r.x/this.worldSize-e[0]*n/o,r.y/this.worldSize-e[1]*n/o,t.mercatorZfromAltitude(this._centerAltitude,this._center.lat)+-e[2]*n/o]}_translateCameraConstrained(e){const n=this._maxCameraBoundsDistance()*Math.cos(this._pitch),r=e[2];let i=1;r>0&&(i=Math.min((n-this._camera.position[2])/r,1)),this._camera.position=t.scaleAndAdd([],this._camera.position,e,i),this._updateStateFromCamera()}_updateStateFromCamera(){const e=this._camera.position,n=this._camera.forward(),{pitch:r,bearing:i}=this._camera.getPitchBearing(),o=t.mercatorZfromAltitude(this._centerAltitude,this.center.lat),s=this._mercatorZfromZoom(this._maxZoom)*Math.cos(t.degToRad(this._maxPitch)),a=Math.max((e[2]-o)/Math.cos(r),s),l=this._zoomFromMercatorZ(a);t.scaleAndAdd(e,e,n,a),this._pitch=t.clamp(r,t.degToRad(this.minPitch),t.degToRad(this.maxPitch)),this.angle=t.wrap(i,-Math.PI,Math.PI),this._setZoom(t.clamp(l,this._minZoom,this._maxZoom)),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._center=new t.MercatorCoordinate(e[0],e[1],e[2]).toLngLat(),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(t){return Math.pow(2,t)*this.tileSize}_mercatorZfromZoom(t){return this.cameraToCenterDistance/this._worldSizeFromZoom(t)}_minimumHeightOverTerrain(){const t=Math.min((null!=this._cameraZoom?this._cameraZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(t)}_zoomFromMercatorZ(t){return this.scaleZoom(this.cameraToCenterDistance/(t*this.tileSize))}_terrainEnabled(){return!!this._elevation}isCornerOffEdge(e,n){const r=Math.min(e.x,n.x),i=Math.max(e.x,n.x),o=Math.min(e.y,n.y),s=Math.max(e.y,n.y);if(o<this.horizonLineFromTop(!1))return!0;const a=[new t.pointGeometry(r,o),new t.pointGeometry(i,s),new t.pointGeometry(r,s),new t.pointGeometry(i,o)],l=this._renderWorldCopies?-3:0,u=this._renderWorldCopies?4:1;for(const t of a){const e=this.pointRayIntersection(t);if(e.t<0)return!0;const n=this.rayIntersectionCoordinate(e);if(n.x<l||n.y<0||n.x>u||n.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+t.radToDeg(this.fovAboveCenter)>88||this.isCornerOffEdge(new t.pointGeometry(0,0),new t.pointGeometry(this.width,this.height))}zoomDeltaToMovement(e,n){const r=t.length(t.sub([],this._camera.position,e)),i=this._zoomFromMercatorZ(r)+n;return r-this._mercatorZfromZoom(i)}getCameraPoint(){const e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.pointGeometry(0,e))}}function Sr(t,e){let n=!1,r=null;const i=()=>{r=null,n&&(t(),r=setTimeout(i,e),n=!1)};return()=>(n=!0,r||i(),r)}class Tr{constructor(e){this._hashName=e&&encodeURIComponent(e),t.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Sr(this._updateHashUnthrottled.bind(this),300)}addTo(e){return this._map=e,t.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return t.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(e){const n=this._map.getCenter(),r=Math.round(100*this._map.getZoom())/100,i=Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10),o=Math.pow(10,i),s=Math.round(n.lng*o)/o,a=Math.round(n.lat*o)/o,l=this._map.getBearing(),u=this._map.getPitch();let c="";if(c+=e?`/${s}/${a}/${r}`:`${r}/${a}/${s}`,(l||u)&&(c+="/"+Math.round(10*l)/10),u&&(c+=`/${Math.round(u)}`),this._hashName){const e=this._hashName;let n=!1;const r=t.window.location.hash.slice(1).split("&").map((t=>{const r=t.split("=")[0];return r===e?(n=!0,`${r}=${c}`):t})).filter((t=>t));return n||r.push(`${e}=${c}`),`#${r.join("&")}`}return`#${c}`}_getCurrentHash(){const e=t.window.location.hash.replace("#","");if(this._hashName){let t;return e.split("&").map((t=>t.split("="))).forEach((e=>{e[0]===this._hashName&&(t=e)})),(t&&t[1]||"").split("/")}return e.split("/")}_onHashChange(){const t=this._getCurrentHash();if(t.length>=3&&!t.some((t=>isNaN(t)))){const e=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:e,pitch:+(t[4]||0)}),!0}return!1}_updateHashUnthrottled(){const e=t.window.location.href.replace(/(#.+)?$/,this.getHashString());t.window.history.replaceState(t.window.history.state,null,e)}}const Pr={linearity:.3,easing:t.bezier(0,0,.3,1)},Mr=t.extend({deceleration:2500,maxSpeed:1400},Pr),Cr=t.extend({deceleration:20,maxSpeed:1400},Pr),Ir=t.extend({deceleration:1e3,maxSpeed:360},Pr),Or=t.extend({deceleration:1e3,maxSpeed:90},Pr);class Rr{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:t.exported.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,n=t.exported.now();for(;e.length>0&&n-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const n={zoom:0,bearing:0,pitch:0,pan:new t.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:t}of this._inertiaBuffer)n.zoom+=t.zoomDelta||0,n.bearing+=t.bearingDelta||0,n.pitch+=t.pitchDelta||0,t.panDelta&&n.pan._add(t.panDelta),t.around&&(n.around=t.around),t.pinchAround&&(n.pinchAround=t.pinchAround);const r=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,i={};if(n.pan.mag()){const o=kr(n.pan.mag(),r,t.extend({},Mr,e||{}));i.offset=n.pan.mult(o.amount/n.pan.mag()),i.center=this._map.transform.center,Lr(i,o)}if(n.zoom){const t=kr(n.zoom,r,Cr);i.zoom=this._map.transform.zoom+t.amount,Lr(i,t)}if(n.bearing){const e=kr(n.bearing,r,Ir);i.bearing=this._map.transform.bearing+t.clamp(e.amount,-179,179),Lr(i,e)}if(n.pitch){const t=kr(n.pitch,r,Or);i.pitch=this._map.transform.pitch+t.amount,Lr(i,t)}if(i.zoom||i.bearing){const t=void 0===n.pinchAround?n.around:n.pinchAround;i.around=t?this._map.unproject(t):this._map.getCenter()}return this.clear(),t.extend(i,{noMoveStart:!0})}}function Lr(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing)}function kr(e,n,r){const{maxSpeed:i,linearity:o,deceleration:s}=r,a=t.clamp(e*o/(n/1e3),-i,i),l=Math.abs(a)/(s*o);return{easing:r.easing,duration:1e3*l,amount:a*(l/2)}}class Dr extends t.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,r,i={}){const s=o.mousePos(n.getCanvasContainer(),r),a=n.unproject(s);super(e,t.extend({point:s,lngLat:a,originalEvent:r},i)),this._defaultPrevented=!1,this.target=n}}class Nr extends t.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,r){const i="touchend"===e?r.changedTouches:r.touches,s=o.touchPos(n.getCanvasContainer(),i),a=s.map((t=>n.unproject(t))),l=s.reduce(((t,e,n,r)=>t.add(e.div(r.length))),new t.pointGeometry(0,0));super(e,{points:s,point:l,lngLats:a,lngLat:n.unproject(l),originalEvent:r}),this._defaultPrevented=!1}}class Fr extends t.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,e,n){super(t,{originalEvent:n}),this._defaultPrevented=!1}}class Br{constructor(t,e){this._map=t,this._clickTolerance=e.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new Fr(t.type,this._map,t))}mousedown(t,e){return this._mousedownPos=e,this._firePreventable(new Dr(t.type,this._map,t))}mouseup(t){this._map.fire(new Dr(t.type,this._map,t))}preclick(e){const n=t.extend({},e);n.type="preclick",this._map.fire(new Dr(n.type,this._map,n))}click(t,e){this._mousedownPos&&this._mousedownPos.dist(e)>=this._clickTolerance||(this.preclick(t),this._map.fire(new Dr(t.type,this._map,t)))}dblclick(t){return this._firePreventable(new Dr(t.type,this._map,t))}mouseover(t){this._map.fire(new Dr(t.type,this._map,t))}mouseout(t){this._map.fire(new Dr(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Nr(t.type,this._map,t))}touchmove(t){this._map.fire(new Nr(t.type,this._map,t))}touchend(t){this._map.fire(new Nr(t.type,this._map,t))}touchcancel(t){this._map.fire(new Nr(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class zr{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,delete this._contextMenuEvent}mousemove(t){this._map.fire(new Dr(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Dr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new Dr(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class jr{constructor(t,e){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=e.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,e){this.isEnabled()&&t.shiftKey&&0===t.button&&(o.disableDrag(),this._startPos=this._lastPos=e,this._active=!0)}mousemoveWindow(t,e){if(!this._active)return;const n=e;if(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)return;const r=this._startPos;this._lastPos=n,this._box||(this._box=o.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const i=Math.min(r.x,n.x),s=Math.max(r.x,n.x),a=Math.min(r.y,n.y),l=Math.max(r.y,n.y);this._map._requestDomTask((()=>{this._box&&(o.setTransform(this._box,`translate(${i}px,${a}px)`),this._box.style.width=s-i+"px",this._box.style.height=l-a+"px")}))}mouseupWindow(e,n){if(!this._active)return;if(0!==e.button)return;const r=this._startPos,i=n;if(this.reset(),o.suppressClick(),r.x!==i.x||r.y!==i.y)return this._map.fire(new t.Event("boxzoomend",{originalEvent:e})),{cameraAnimation:t=>t.fitScreenCoordinates(r,i,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",e)}keydown(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(o.remove(this._box),this._box=null),o.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,n){return this._map.fire(new t.Event(e,{originalEvent:n}))}}function Ur(t,e){const n={};for(let r=0;r<t.length;r++)n[t[r].identifier]=e[r];return n}class Vr{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,n,r){(this.centroid||r.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=e.timeStamp),r.length===this.numTouches&&(this.centroid=function(e){const n=new t.pointGeometry(0,0);for(const t of e)n._add(t);return n.div(e.length)}(n),this.touches=Ur(r,n)))}touchmove(t,e,n){if(this.aborted||!this.centroid)return;const r=Ur(n,e);for(const t in this.touches){const e=this.touches[t],n=r[t];(!n||n.dist(e)>30)&&(this.aborted=!0)}}touchend(t,e,n){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),0===n.length){const t=!this.aborted&&this.centroid;if(this.reset(),t)return t}}}class Gr{constructor(t){this.singleTap=new Vr(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,e,n){this.singleTap.touchstart(t,e,n)}touchmove(t,e,n){this.singleTap.touchmove(t,e,n)}touchend(t,e,n){const r=this.singleTap.touchend(t,e,n);if(r){const e=t.timeStamp-this.lastTime<500,n=!this.lastTap||this.lastTap.dist(r)<30;if(e&&n||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=r,this.count===this.numTaps)return this.reset(),r}}}class Zr{constructor(){this._zoomIn=new Gr({numTouches:1,numTaps:2}),this._zoomOut=new Gr({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,e,n){this._zoomIn.touchstart(t,e,n),this._zoomOut.touchstart(t,e,n)}touchmove(t,e,n){this._zoomIn.touchmove(t,e,n),this._zoomOut.touchmove(t,e,n)}touchend(t,e,n){const r=this._zoomIn.touchend(t,e,n),i=this._zoomOut.touchend(t,e,n);return r?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:e.getZoom()+1,around:e.unproject(r)},{originalEvent:t})}):i?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:e.getZoom()-1,around:e.unproject(i)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const qr={0:1,2:2};class Wr{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(t,e){return!1}_move(t,e){return{}}mousedown(t,e){if(this._lastPoint)return;const n=o.mouseButton(t);this._correctButton(t,n)&&(this._lastPoint=e,this._eventButton=n)}mousemoveWindow(t,e){const n=this._lastPoint;if(n)if(t.preventDefault(),function(t,e){const n=qr[e];return void 0===t.buttons||(t.buttons&n)!==n}(t,this._eventButton))this.reset();else if(this._moved||!(e.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=e,this._move(n,e)}mouseupWindow(t){this._lastPoint&&o.mouseButton(t)===this._eventButton&&(this._moved&&o.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Hr extends Wr{mousedown(t,e){super.mousedown(t,e),this._lastPoint&&(this._active=!0)}_correctButton(t,e){return 0===e&&!t.ctrlKey}_move(t,e){return{around:e,panDelta:e.sub(t)}}}class Xr extends Wr{_correctButton(t,e){return 0===e&&t.ctrlKey||2===e}_move(t,e){const n=.8*(e.x-t.x);if(n)return this._active=!0,{bearingDelta:n}}contextmenu(t){t.preventDefault()}}class $r extends Wr{_correctButton(t,e){return 0===e&&t.ctrlKey||2===e}_move(t,e){const n=-.5*(e.y-t.y);if(n)return this._active=!0,{pitchDelta:n}}contextmenu(t){t.preventDefault()}}class Yr{constructor(t){this._minTouches=1,this._clickTolerance=t.clickTolerance||1,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new t.pointGeometry(0,0)}touchstart(t,e,n){return this._calculateTransform(t,e,n)}touchmove(t,e,n){if(this._active&&!(n.length<this._minTouches))return t.preventDefault(),this._calculateTransform(t,e,n)}touchend(t,e,n){this._calculateTransform(t,e,n),this._active&&n.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,n,r){r.length>0&&(this._active=!0);const i=Ur(r,n),o=new t.pointGeometry(0,0),s=new t.pointGeometry(0,0);let a=0;for(const t in i){const e=i[t],n=this._touches[t];n&&(o._add(e),s._add(e.sub(n)),a++,i[t]=e)}if(this._touches=i,a<this._minTouches||!s.mag())return;const l=s.div(a);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:o.div(a),panDelta:l}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Qr{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(t){}_move(t,e,n){return{}}touchstart(t,e,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([e[0],e[1]]))}touchmove(t,e,n){if(!this._firstTwoTouches)return;t.preventDefault();const[r,i]=this._firstTwoTouches,o=Kr(n,e,r),s=Kr(n,e,i);if(!o||!s)return;const a=this._aroundCenter?null:o.add(s).div(2);return this._move([o,s],a,t)}touchend(t,e,n){if(!this._firstTwoTouches)return;const[r,i]=this._firstTwoTouches,s=Kr(n,e,r),a=Kr(n,e,i);s&&a||(this._active&&o.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Kr(t,e,n){for(let r=0;r<t.length;r++)if(t[r].identifier===n)return e[r]}function Jr(t,e){return Math.log(t/e)/Math.LN2}class ti extends Qr{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,e){const n=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Jr(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Jr(this._distance,n),pinchAround:e}}}function ei(t,e){return 180*t.angleWith(e)/Math.PI}class ni extends Qr{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,e){const n=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:ei(this._vector,n),pinchAround:e}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const e=25/(Math.PI*this._minDiameter)*360,n=ei(t,this._startVector);return Math.abs(n)<e}}function ri(t){return Math.abs(t.y)>Math.abs(t.x)}class ii extends Qr{reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}_start(t){this._lastPoints=t,ri(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,e,n){const r=t[0].sub(this._lastPoints[0]),i=t[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(r,i,n.timeStamp),this._valid)return this._lastPoints=t,this._active=!0,{pitchDelta:(r.y+i.y)/2*-.5}}gestureBeginsVertically(t,e,n){if(void 0!==this._valid)return this._valid;const r=t.mag()>=2,i=e.mag()>=2;if(!r&&!i)return;if(!r||!i)return void 0===this._firstMove&&(this._firstMove=n),n-this._firstMove<100&&void 0;const o=t.y>0==e.y>0;return ri(t)&&ri(e)&&o}}const oi={panStep:100,bearingStep:15,pitchStep:10};class si{constructor(){const t=oi;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let e=0,n=0,r=0,i=0,o=0;switch(t.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:t.shiftKey?n=-1:(t.preventDefault(),i=-1);break;case 39:t.shiftKey?n=1:(t.preventDefault(),i=1);break;case 38:t.shiftKey?r=1:(t.preventDefault(),o=-1);break;case 40:t.shiftKey?r=-1:(t.preventDefault(),o=1);break;default:return}return this._rotationDisabled&&(n=0,r=0),{cameraAnimation:s=>{const a=s.getZoom();s.easeTo({duration:300,easeId:"keyboardHandler",easing:ai,zoom:e?Math.round(a)+e*(t.shiftKey?2:1):a,bearing:s.getBearing()+n*this._bearingStep,pitch:s.getPitch()+r*this._pitchStep,offset:[-i*this._panStep,-o*this._panStep],center:s.getCenter()},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ai(t){return t*(2-t)}const li=4.000244140625;class ui{constructor(e,n){this._map=e,this._el=e.getCanvasContainer(),this._handler=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,t.bindAll(["_onTimeout"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=t&&"center"===t.around)}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(e){if(!this.isEnabled())return;let n=e.deltaMode===t.window.WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const r=t.exported.now(),i=r-(this._lastWheelEventTime||0);this._lastWheelEventTime=r,0!==n&&n%li==0?this._type="wheel":0!==n&&Math.abs(n)<4?this._type="trackpad":i>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(i*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),e.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=e,this._delta-=n,this._active||this._start(e)),e.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const e=o.mousePos(this._el,t);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:e,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const e=this._map.transform,n=()=>e._terrainEnabled()?e.computeZoomRelativeTo(this._aroundCoord):e.zoom;if(0!==this._delta){const t="wheel"===this._type&&Math.abs(this._delta)>li?this._wheelZoomRate:this._defaultZoomRate;let r=2/(1+Math.exp(-Math.abs(this._delta*t)));this._delta<0&&0!==r&&(r=1/r);const i=n(),o=Math.pow(2,i),s="number"==typeof this._targetZoom?e.zoomScale(this._targetZoom):o;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(s*r))),"wheel"===this._type&&(this._startZoom=n(),this._easing=this._smoothOutEasing(200)),this._delta=0}const r="number"==typeof this._targetZoom?this._targetZoom:n(),i=this._startZoom,o=this._easing;let s,a=!1;if("wheel"===this._type&&i&&o){const e=Math.min((t.exported.now()-this._lastWheelEventTime)/200,1),n=o(e);s=t.number(i,r,n),e<1?this._frameId||(this._frameId=!0):a=!0}else s=r,a=!0;return this._active=!0,a&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!a,zoomDelta:s-n(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let n=t.ease;if(this._prevEase){const e=this._prevEase,r=(t.exported.now()-e.start)/e.duration,i=e.easing(r+.01)-e.easing(r),o=.27/Math.sqrt(i*i+1e-4)*.01,s=Math.sqrt(.0729-o*o);n=t.bezier(o,s,.25,1)}return this._prevEase={start:t.exported.now(),duration:e,easing:n},n}blur(){this.reset()}reset(){this._active=!1}}class ci{constructor(t,e){this._clickZoom=t,this._tapZoom=e}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class hi{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(t,e){return t.preventDefault(),{cameraAnimation:n=>{n.easeTo({duration:300,zoom:n.getZoom()+(t.shiftKey?-1:1),around:n.unproject(e)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pi{constructor(){this._tap=new Gr({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(t,e,n){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=e[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(t,e,n))}touchmove(t,e,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;const r=e[0],i=r.y-this._swipePoint.y;return this._swipePoint=r,t.preventDefault(),this._active=!0,{zoomDelta:i/128}}}else this._tap.touchmove(t,e,n)}touchend(t,e,n){this._tapTime?this._swipePoint&&0===n.length&&this.reset():this._tap.touchend(t,e,n)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fi{constructor(t,e,n){this._el=t,this._mousePan=e,this._touchPan=n}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class di{constructor(t,e,n){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=e,this._mousePitch=n}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class gi{constructor(t,e,n,r){this._el=t,this._touchZoom=e,this._touchRotate=n,this._tapDragZoom=r,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const mi=t=>t.zoom||t.drag||t.pitch||t.rotate;class Ai extends t.Event{}class yi{constructor(){this.constants=[1,1,.01],this.radius=0}setup(e,n){const r=t.sub([],n,e);this.radius=t.length(r[2]<0?t.div([],r,this.constants):[r[0],r[1],0])}projectRay(e){t.div(e,e,this.constants),t.normalize(e,e),t.mul$2(e,e,this.constants);const n=t.scale([],e,this.radius);if(n[2]>0){const e=t.scale([],[0,0,1],t.dot(n,[0,0,1])),r=t.scale([],t.normalize([],[n[0],n[1],0]),this.radius),i=t.add([],n,t.scale([],t.sub([],t.add([],r,e),n),2));n[0]=i[0],n[1]=i[1]}return n}}function _i(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta}class vi{constructor(e,n){this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Rr(e),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new yi,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(n),t.bindAll(["handleEvent","handleWindowEvent"],this);const r=this._el;this._listeners=[[r,"touchstart",{passive:!0}],[r,"touchmove",{passive:!1}],[r,"touchend",void 0],[r,"touchcancel",void 0],[r,"mousedown",void 0],[r,"mousemove",void 0],[r,"mouseup",void 0],[t.window.document,"mousemove",{capture:!0}],[t.window.document,"mouseup",void 0],[r,"mouseover",void 0],[r,"mouseout",void 0],[r,"dblclick",void 0],[r,"click",void 0],[r,"keydown",{capture:!1}],[r,"keyup",void 0],[r,"wheel",{passive:!1}],[r,"contextmenu",void 0],[t.window,"blur",void 0]];for(const[e,n,r]of this._listeners)o.addEventListener(e,n,e===t.window.document?this.handleWindowEvent:this.handleEvent,r)}destroy(){for(const[e,n,r]of this._listeners)o.removeEventListener(e,n,e===t.window.document?this.handleWindowEvent:this.handleEvent,r)}_addDefaultHandlers(t){const e=this._map,n=e.getCanvasContainer();this._add("mapEvent",new Br(e,t));const r=e.boxZoom=new jr(e,t);this._add("boxZoom",r);const i=new Zr,o=new hi;e.doubleClickZoom=new ci(o,i),this._add("tapZoom",i),this._add("clickZoom",o);const s=new pi;this._add("tapDragZoom",s);const a=e.touchPitch=new ii;this._add("touchPitch",a);const l=new Xr(t),u=new $r(t);e.dragRotate=new di(t,l,u),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",u,["mouseRotate"]);const c=new Hr(t),h=new Yr(t);e.dragPan=new fi(n,c,h),this._add("mousePan",c),this._add("touchPan",h,["touchZoom","touchRotate"]);const p=new ni,f=new ti;e.touchZoomRotate=new gi(n,f,p,s),this._add("touchRotate",p,["touchPan","touchZoom"]),this._add("touchZoom",f,["touchPan","touchRotate"]),this._add("blockableMapEvent",new zr(e));const d=e.scrollZoom=new ui(e,this);this._add("scrollZoom",d,["mousePan"]);const g=e.keyboard=new si;this._add("keyboard",g);for(const n of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[n]&&e[n].enable(t[n])}_add(t,e,n){this._handlers.push({handlerName:t,handler:e,allowed:n}),this._handlersById[t]=e}stop(t){if(!this._updatingCamera){for(const{handler:t}of this._handlers)t.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(mi(this._eventsInProgress))||this.isZooming()}_blockedByActive(t,e,n){for(const r in t)if(r!==n&&(!e||e.indexOf(r)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,`${t.type}Window`)}_getMapTouches(t){const e=[];for(const n of t)this._el.contains(n.target)&&e.push(n);return e}handleEvent(t,e){this._updatingCamera=!0;const n="renderFrame"===t.type,r=n?void 0:t,i={needsRenderFrame:!1},s={},a={},l=t.touches?this._getMapTouches(t.touches):void 0,u=l?o.touchPos(this._el,l):n?void 0:o.mousePos(this._el,t);for(const{handlerName:n,handler:o,allowed:c}of this._handlers){if(!o.isEnabled())continue;let h;this._blockedByActive(a,c,n)?o.reset():o[e||t.type]&&(h=o[e||t.type](t,u,l),this.mergeHandlerResult(i,s,h,n,r),h&&h.needsRenderFrame&&this._triggerRenderFrame()),(h||o.isActive())&&(a[n]=o)}const c={};for(const t in this._previousActiveHandlers)a[t]||(c[t]=r);this._previousActiveHandlers=a,(Object.keys(c).length||_i(i))&&(this._changes.push([i,s,c]),this._triggerRenderFrame()),(Object.keys(a).length||_i(i))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:h}=i;h&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],h(this._map))}mergeHandlerResult(e,n,r,i,o){if(!r)return;t.extend(e,r);const s={handlerName:i,originalEvent:r.originalEvent||o};void 0!==r.zoomDelta&&(n.zoom=s),void 0!==r.panDelta&&(n.drag=s),void 0!==r.pitchDelta&&(n.pitch=s),void 0!==r.bearingDelta&&(n.rotate=s)}_applyChanges(){const e={},n={},r={};for(const[i,o,s]of this._changes)i.panDelta&&(e.panDelta=(e.panDelta||new t.pointGeometry(0,0))._add(i.panDelta)),i.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+i.zoomDelta),i.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+i.bearingDelta),i.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+i.pitchDelta),void 0!==i.around&&(e.around=i.around),void 0!==i.aroundCoord&&(e.aroundCoord=i.aroundCoord),void 0!==i.pinchAround&&(e.pinchAround=i.pinchAround),i.noInertia&&(e.noInertia=i.noInertia),t.extend(n,o),t.extend(r,s);this._updateMapTransform(e,n,r),this._changes=[]}_updateMapTransform(e,n,r){const i=this._map,o=i.transform,s=t=>[t.x,t.y,t.z];if((t=>{const e=this._eventsInProgress.drag;return e&&!this._handlersById[e.handlerName].isActive()})()&&!_i(e)){const t=o.zoom;o.cameraElevationReference="sea",o.recenterOnTerrain(),o.cameraElevationReference="ground",t!==o.zoom&&this._map._update(!0)}if(!_i(e))return this._fireEvents(n,r,!0);let{panDelta:a,zoomDelta:l,bearingDelta:u,pitchDelta:c,around:h,aroundCoord:p,pinchAround:f}=e;void 0!==f&&(h=f),(t=>n.drag&&!this._eventsInProgress.drag)()&&h&&(this._dragOrigin=s(o.pointCoordinate3D(h)),this._trackingEllipsoid.setup(o._camera.position,this._dragOrigin)),o.cameraElevationReference="sea",i._stop(!0),h=h||i.transform.centerPoint,u&&(o.bearing+=u),c&&(o.pitch+=c),o._updateCameraState();const d=[0,0,0];if(a){const t=o.screenPointToMercatorRay(h),e=o.screenPointToMercatorRay(h.sub(a)),n=this._trackingEllipsoid.projectRay(t.dir),r=this._trackingEllipsoid.projectRay(e.dir);d[0]=r[0]-n[0],d[1]=r[1]-n[1]}const g=o.zoom,m=[0,0,0];if(l){const e=s(p||o.pointCoordinate3D(h)),n={dir:t.normalize([],t.sub([],e,o._camera.position))},r=o.screenPointToMercatorRay(o.centerPoint);if(n.dir[2]<0){const i=t.altitudeFromMercatorZ(e[2],e[1]),a=o.rayIntersectionCoordinate(o.pointRayIntersection(o.centerPoint,i)),u=o.zoomDeltaToMovement(s(a),l)*(r.dir[2]/n.dir[2]);t.scale(m,n.dir,u)}else if(o._terrainEnabled()){const r=o.zoomDeltaToMovement(e,l);t.scale(m,n.dir,r)}}const A=t.add(d,d,m);o._translateCameraConstrained(A),l&&Math.abs(o.zoom-g)>1e-4&&o.recenterOnTerrain(),o.cameraElevationReference="ground",this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(n,r,!0)}_fireEvents(e,n,r){const i=mi(this._eventsInProgress),o=mi(e),s={};for(const t in e){const{originalEvent:n}=e[t];this._eventsInProgress[t]||(s[`${t}start`]=n),this._eventsInProgress[t]=e[t]}!i&&o&&this._fireEvent("movestart",o.originalEvent);for(const t in s)this._fireEvent(t,s[t]);o&&this._fireEvent("move",o.originalEvent);for(const t in e){const{originalEvent:n}=e[t];this._fireEvent(t,n)}const a={};let l;for(const t in this._eventsInProgress){const{handlerName:e,originalEvent:r}=this._eventsInProgress[t];this._handlersById[e].isActive()||(delete this._eventsInProgress[t],l=n[e]||r,a[`${t}end`]=l)}for(const t in a)this._fireEvent(t,a[t]);const u=mi(this._eventsInProgress);if(r&&(i||o)&&!u){this._updatingCamera=!0;const e=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),n=t=>0!==t&&-this._bearingSnap<t&&t<this._bearingSnap;e?(n(e.bearing||this._map.getBearing())&&(e.bearing=0),this._map.easeTo(e,{originalEvent:l})):(this._map.fire(new t.Event("moveend",{originalEvent:l})),n(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(e,n){this._map.fire(new t.Event(e,n?{originalEvent:n}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((t=>{delete this._frameId,this.handleEvent(new Ai("renderFrame",{timeStamp:t})),this._applyChanges()}))}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}class bi extends t.Evented{constructor(e,n){super(),this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=n.bearingSnap,t.bindAll(["_renderFrameCallback"],this)}getCenter(){return new t.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(t,e){return this.jumpTo({center:t},e)}panBy(e,n,r){return e=t.pointGeometry.convert(e).mult(-1),this.panTo(this.transform.center,t.extend({offset:e},n),r)}panTo(e,n,r){return this.easeTo(t.extend({center:e},n),r)}getZoom(){return this.transform.zoom}setZoom(t,e){return this.jumpTo({zoom:t},e),this}zoomTo(e,n,r){return this.easeTo(t.extend({zoom:e},n),r)}zoomIn(t,e){return this.zoomTo(this.getZoom()+1,t,e),this}zoomOut(t,e){return this.zoomTo(this.getZoom()-1,t,e),this}getBearing(){return this.transform.bearing}setBearing(t,e){return this.jumpTo({bearing:t},e),this}getPadding(){return this.transform.padding}setPadding(t,e){return this.jumpTo({padding:t},e),this}rotateTo(e,n,r){return this.easeTo(t.extend({bearing:e},n),r)}resetNorth(e,n){return this.rotateTo(0,t.extend({duration:1e3},e),n),this}resetNorthPitch(e,n){return this.easeTo(t.extend({bearing:0,pitch:0,duration:1e3},e),n),this}snapToNorth(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this}getPitch(){return this.transform.pitch}setPitch(t,e){return this.jumpTo({pitch:t},e),this}cameraForBounds(e,n){e=t.LngLatBounds.convert(e);const r=n&&n.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),r,n)}_extendCameraOptions(e){const n={top:0,bottom:0,right:0,left:0};if("number"==typeof(e=t.extend({padding:n,offset:[0,0],maxZoom:this.transform.maxZoom},e)).padding){const t=e.padding;e.padding={top:t,bottom:t,right:t,left:t}}return e.padding=t.extend(n,e.padding),e}_cameraForBoxAndBearing(e,n,r,i){const o=this._extendCameraOptions(i),s=this.transform,a=s.padding,l=s.project(t.LngLat.convert(e)),u=s.project(t.LngLat.convert(n)),c=l.rotate(-t.degToRad(r)),h=u.rotate(-t.degToRad(r)),p=new t.pointGeometry(Math.max(c.x,h.x),Math.max(c.y,h.y)),f=new t.pointGeometry(Math.min(c.x,h.x),Math.min(c.y,h.y)),d=p.sub(f),g=(s.width-(a.left+a.right+o.padding.left+o.padding.right))/d.x,m=(s.height-(a.top+a.bottom+o.padding.top+o.padding.bottom))/d.y;if(m<0||g<0)return void t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const A=Math.min(s.scaleZoom(s.scale*Math.min(g,m)),o.maxZoom),y="number"==typeof o.offset.x?new t.pointGeometry(o.offset.x,o.offset.y):t.pointGeometry.convert(o.offset),_=new t.pointGeometry((o.padding.left-o.padding.right)/2,(o.padding.top-o.padding.bottom)/2).rotate(r*Math.PI/180),v=y.add(_).mult(s.scale/s.zoomScale(A));return{center:s.unproject(l.add(u).div(2).sub(v)),zoom:A,bearing:r}}_cameraForBox(e,n,r,i,o){const s=this._extendCameraOptions(o);r=r||0,i=i||0,e=t.LngLat.convert(e),n=t.LngLat.convert(n);const a=this.transform.clone();a.padding=s.padding;const l=this.getFreeCameraOptions(),u=new t.LngLat(.5*(e.lng+n.lng),.5*(e.lat+n.lat)),c=.5*(r+i);if(a._camera.position[2]<t.mercatorZfromAltitude(c,u.lat))return void t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");l.lookAtPoint(u),a.setFreeCameraOptions(l);const h=t.MercatorCoordinate.fromLngLat(e),p=t.MercatorCoordinate.fromLngLat(n),g=a.pointRayIntersection(a.centerPoint,c),m=[(A=a.rayIntersectionCoordinate(g)).x,A.y,A.z];var A;const y=a.screenPointToMercatorRay(a.centerPoint);let _,v=0;do{const n=Math.floor(a.zoom),o=1<<n,s=Math.min(o*h.x,o*p.x),l=Math.min(o*h.y,o*p.y),u=Math.max(o*h.x,o*p.x),c=Math.max(o*h.y,o*p.y),g=new d([s,l,r],[u,c,i]),A=f.fromInvProjectionMatrix(a.invProjMatrix,a.worldSize,n);if(2!==g.intersects(A)){_&&(a._camera.position=t.scaleAndAdd([],a._camera.position,y.dir,-_),a._updateStateFromCamera());break}const v=t.sub([],a._camera.position,m);_=.5*t.length(v),a._camera.position=t.scaleAndAdd([],a._camera.position,y.dir,_);try{a._updateStateFromCamera()}catch(e){return void t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++v<10);return{center:a.center,zoom:a.zoom,bearing:a.bearing,pitch:a.pitch}}fitBounds(t,e,n){return this._fitInternal(this.cameraForBounds(t,e),e,n)}_raycastElevationBox(e,n){const r=this.transform.elevation;if(!r)return;const i=new t.pointGeometry(e.x,n.y),o=new t.pointGeometry(n.x,e.y),s=r.pointCoordinate(e);if(!s)return;const a=r.pointCoordinate(n);if(!a)return;const l=r.pointCoordinate(i);if(!l)return;const u=r.pointCoordinate(o);if(!u)return;const c=new t.MercatorCoordinate(s[0],s[1]).toLngLat(),h=new t.MercatorCoordinate(a[0],a[1]).toLngLat(),p=new t.MercatorCoordinate(l[0],l[1]).toLngLat(),f=new t.MercatorCoordinate(u[0],u[1]).toLngLat(),d=Math.min(c.lng,Math.min(h.lng,Math.min(p.lng,f.lng))),g=Math.min(c.lat,Math.min(h.lat,Math.min(p.lat,f.lat))),m=Math.max(c.lng,Math.max(h.lng,Math.max(p.lng,f.lng))),A=Math.max(c.lat,Math.max(h.lat,Math.max(p.lat,f.lat))),y=Math.min(s[3],Math.min(a[3],Math.min(l[3],u[3]))),_=Math.max(s[3],Math.max(a[3],Math.max(l[3],u[3])));return{minLngLat:new t.LngLat(d,g),maxLngLat:new t.LngLat(m,A),minAltitude:y,maxAltitude:_}}fitScreenCoordinates(e,n,r,i,o){let s,a,l,u;const c=t.pointGeometry.convert(e),h=t.pointGeometry.convert(n),p=this._raycastElevationBox(c,h);if(p)s=p.minLngLat,a=p.maxLngLat,l=p.minAltitude,u=p.maxAltitude;else{if(this.transform.isCornerOffEdge(c,h))return this;s=this.transform.pointLocation(c),a=this.transform.pointLocation(h)}return this._fitInternal(0===this.transform.pitch?this._cameraForBoxAndBearing(this.transform.pointLocation(t.pointGeometry.convert(e)),this.transform.pointLocation(t.pointGeometry.convert(n)),r,i):this._cameraForBox(s,a,l,u,i),i,o)}_fitInternal(e,n,r){return e?(delete(n=t.extend(e,n)).padding,n.linear?this.easeTo(n,r):this.flyTo(n,r)):this}jumpTo(e,n){this.stop();const r=this.transform;let i=!1,o=!1,s=!1;return"zoom"in e&&r.zoom!==+e.zoom&&(i=!0,r.zoom=+e.zoom),void 0!==e.center&&(r.center=t.LngLat.convert(e.center)),"bearing"in e&&r.bearing!==+e.bearing&&(o=!0,r.bearing=+e.bearing),"pitch"in e&&r.pitch!==+e.pitch&&(s=!0,r.pitch=+e.pitch),null==e.padding||r.isPaddingEqual(e.padding)||(r.padding=e.padding),this.fire(new t.Event("movestart",n)).fire(new t.Event("move",n)),i&&this.fire(new t.Event("zoomstart",n)).fire(new t.Event("zoom",n)).fire(new t.Event("zoomend",n)),o&&this.fire(new t.Event("rotatestart",n)).fire(new t.Event("rotate",n)).fire(new t.Event("rotateend",n)),s&&this.fire(new t.Event("pitchstart",n)).fire(new t.Event("pitch",n)).fire(new t.Event("pitchend",n)),this.fire(new t.Event("moveend",n))}getFreeCameraOptions(){return this.transform.getFreeCameraOptions()}setFreeCameraOptions(e,n){this.stop();const r=this.transform,i=r.zoom,o=r.pitch,s=r.bearing;r.setFreeCameraOptions(e);const a=i!==r.zoom,l=o!==r.pitch,u=s!==r.bearing;return this.fire(new t.Event("movestart",n)).fire(new t.Event("move",n)),a&&this.fire(new t.Event("zoomstart",n)).fire(new t.Event("zoom",n)).fire(new t.Event("zoomend",n)),u&&this.fire(new t.Event("rotatestart",n)).fire(new t.Event("rotate",n)).fire(new t.Event("rotateend",n)),l&&this.fire(new t.Event("pitchstart",n)).fire(new t.Event("pitch",n)).fire(new t.Event("pitchend",n)),this.fire(new t.Event("moveend",n)),this}easeTo(e,n){this._stop(!1,e.easeId),(!1===(e=t.extend({offset:[0,0],duration:500,easing:t.ease},e)).animate||!e.essential&&t.exported.prefersReducedMotion)&&(e.duration=0);const r=this.transform,i=this.getZoom(),o=this.getBearing(),s=this.getPitch(),a=this.getPadding(),l="zoom"in e?+e.zoom:i,u="bearing"in e?this._normalizeBearing(e.bearing,o):o,c="pitch"in e?+e.pitch:s,h="padding"in e?e.padding:r.padding,p=t.pointGeometry.convert(e.offset);let f=r.centerPoint.add(p);const d=r.pointLocation(f),g=t.LngLat.convert(e.center||d);this._normalizeCenter(g);const m=r.project(d),A=r.project(g).sub(m),y=r.zoomScale(l-i);let _,v;e.around&&(_=t.LngLat.convert(e.around),v=r.locationPoint(_));const b={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||l!==i,this._rotating=this._rotating||o!==u,this._pitching=this._pitching||c!==s,this._padding=!r.isPaddingEqual(h),this._easeId=e.easeId,this._prepareEase(n,e.noMoveStart,b),this._ease((e=>{if(this._zooming&&(r.zoom=t.number(i,l,e)),this._rotating&&(r.bearing=t.number(o,u,e)),this._pitching&&(r.pitch=t.number(s,c,e)),this._padding&&(r.interpolatePadding(a,h,e),f=r.centerPoint.add(p)),_)r.setLocationAtPoint(_,v);else{const t=r.zoomScale(r.zoom-i),n=l>i?Math.min(2,y):Math.max(.5,y),o=Math.pow(n,1-e),s=r.unproject(m.add(A.mult(e*o)).mult(t));r.setLocationAtPoint(r.renderWorldCopies?s.wrap():s,f)}this._fireMoveEvents(n)}),(t=>{r.recenterOnTerrain(),this._afterEase(n,t)}),e),this}_prepareEase(e,n,r={}){this._moving=!0,this.transform.cameraElevationReference="sea",n||r.moving||this.fire(new t.Event("movestart",e)),this._zooming&&!r.zooming&&this.fire(new t.Event("zoomstart",e)),this._rotating&&!r.rotating&&this.fire(new t.Event("rotatestart",e)),this._pitching&&!r.pitching&&this.fire(new t.Event("pitchstart",e))}_fireMoveEvents(e){this.fire(new t.Event("move",e)),this._zooming&&this.fire(new t.Event("zoom",e)),this._rotating&&this.fire(new t.Event("rotate",e)),this._pitching&&this.fire(new t.Event("pitch",e))}_afterEase(e,n){if(this._easeId&&n&&this._easeId===n)return;delete this._easeId,this.transform.cameraElevationReference="ground";const r=this._zooming,i=this._rotating,o=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,r&&this.fire(new t.Event("zoomend",e)),i&&this.fire(new t.Event("rotateend",e)),o&&this.fire(new t.Event("pitchend",e)),this.fire(new t.Event("moveend",e))}flyTo(e,n){if(!e.essential&&t.exported.prefersReducedMotion){const r=t.pick(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(r,n)}this.stop(),e=t.extend({offset:[0,0],speed:1.2,curve:1.42,easing:t.ease},e);const r=this.transform,i=this.getZoom(),o=this.getBearing(),s=this.getPitch(),a=this.getPadding(),l="zoom"in e?t.clamp(+e.zoom,r.minZoom,r.maxZoom):i,u="bearing"in e?this._normalizeBearing(e.bearing,o):o,c="pitch"in e?+e.pitch:s,h="padding"in e?e.padding:r.padding,p=r.zoomScale(l-i),f=t.pointGeometry.convert(e.offset);let d=r.centerPoint.add(f);const g=r.pointLocation(d),m=t.LngLat.convert(e.center||g);this._normalizeCenter(m);const A=r.project(g),y=r.project(m).sub(A);let _=e.curve;const v=Math.max(r.width,r.height),b=v/p,x=y.mag();if("minZoom"in e){const n=t.clamp(Math.min(e.minZoom,i,l),r.minZoom,r.maxZoom),o=v/r.zoomScale(n-i);_=Math.sqrt(o/x*2)}const w=_*_;function E(t){const e=(b*b-v*v+(t?-1:1)*w*w*x*x)/(2*(t?b:v)*w*x);return Math.log(Math.sqrt(e*e+1)-e)}function S(t){return(Math.exp(t)-Math.exp(-t))/2}function T(t){return(Math.exp(t)+Math.exp(-t))/2}const P=E(0);let M=function(t){return T(P)/T(P+_*t)},C=function(t){return v*((T(P)*(S(e=P+_*t)/T(e))-S(P))/w)/x;var e},I=(E(1)-P)/_;if(Math.abs(x)<1e-6||!isFinite(I)){if(Math.abs(v-b)<1e-6)return this.easeTo(e,n);const t=b<v?-1:1;I=Math.abs(Math.log(b/v))/_,C=function(){return 0},M=function(e){return Math.exp(t*_*e)}}return e.duration="duration"in e?+e.duration:1e3*I/("screenSpeed"in e?+e.screenSpeed/_:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=o!==u,this._pitching=c!==s,this._padding=!r.isPaddingEqual(h),this._prepareEase(n,!1),this._ease((e=>{const p=e*I,g=1/M(p);r.zoom=1===e?l:i+r.scaleZoom(g),this._rotating&&(r.bearing=t.number(o,u,e)),this._pitching&&(r.pitch=t.number(s,c,e)),this._padding&&(r.interpolatePadding(a,h,e),d=r.centerPoint.add(f));const _=1===e?m:r.unproject(A.add(y.mult(C(p))).mult(g));r.setLocationAtPoint(r.renderWorldCopies?_.wrap():_,d),r._updateCenterElevation(),this._fireMoveEvents(n)}),(()=>this._afterEase(n)),e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,e){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const t=this._onEaseEnd;delete this._onEaseEnd,t.call(this,e)}if(!t){const t=this.handlers;t&&t.stop(!1)}return this}_ease(e,n,r){!1===r.animate||0===r.duration?(e(1),n()):(this._easeStart=t.exported.now(),this._easeOptions=r,this._onEaseFrame=e,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const e=Math.min((t.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(e,n){e=t.wrap(e,-180,180);const r=Math.abs(e-n);return Math.abs(e-360-n)<r&&(e-=360),Math.abs(e+360-n)<r&&(e+=360),e}_normalizeCenter(t){const e=this.transform;if(!e.renderWorldCopies||e.lngRange)return;const n=t.lng-e.center.lng;t.lng+=n>180?-360:n<-180?360:0}}class xi{constructor(e={}){this.options=e,t.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){const e=this.options&&this.options.compact;return this._map=t,this._container=o.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=o.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=o.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),e&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===e&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){o.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(t,e){const n=this._map._getUIString(`AttributionControl.${e}`);t.title=n,t.setAttribute("aria-label",n)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))}_updateEditLink(){let e=this._editLink;e||(e=this._editLink=this._container.querySelector(".mapbox-improve-map"));const n=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||t.config.ACCESS_TOKEN}];if(e){const r=n.reduce(((t,e,r)=>(e.value&&(t+=`${e.key}=${e.value}${r<n.length-1?"&":""}`),t)),"?");e.href=`${t.config.FEEDBACK_URL}/${r}${this._map._hash?this._map._hash.getHashString(!0):""}`,e.rel="noopener nofollow",this._setElementTitle(e,"MapFeedback")}}_updateData(t){!t||"metadata"!==t.sourceDataType&&"visibility"!==t.sourceDataType&&"style"!==t.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map((t=>"string"!=typeof t?"":t))):"string"==typeof this.options.customAttribution&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const t=this._map.style.stylesheet;this.styleOwner=t.owner,this.styleId=t.id}const e=this._map.style._sourceCaches;for(const n in e){const r=e[n];if(r.used){const e=r.getSource();e.attribution&&t.indexOf(e.attribution)<0&&t.push(e.attribution)}}t.sort(((t,e)=>t.length-e.length)),t=t.filter(((e,n)=>{for(let r=n+1;r<t.length;r++)if(t[r].indexOf(e)>=0)return!1;return!0}));const n=t.join(" | ");n!==this._attribHTML&&(this._attribHTML=n,t.length?(this._innerContainer.innerHTML=n,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class wi{constructor(){t.bindAll(["_updateLogo"],this),t.bindAll(["_updateCompact"],this)}onAdd(t){this._map=t,this._container=o.create("div","mapboxgl-ctrl");const e=o.create("a","mapboxgl-ctrl-logo");return e.target="_blank",e.rel="noopener nofollow",e.href="https://www.mapbox.com/",e.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),e.setAttribute("rel","noopener nofollow"),this._container.appendChild(e),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){o.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const t=this._map.style._sourceCaches;if(0===Object.entries(t).length)return!0;for(const e in t){const n=t[e].getSource();if(n.hasOwnProperty("mapbox_logo")&&!n.mapbox_logo)return!1}return!0}_updateCompact(){const t=this._container.children;if(t.length){const e=t[0];this._map.getCanvasContainer().offsetWidth<250?e.classList.add("mapboxgl-compact"):e.classList.remove("mapboxgl-compact")}}}class Ei{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e}remove(t){const e=this._currentlyRunning,n=e?this._queue.concat(e):this._queue;for(const e of n)if(e.id===t)return void(e.cancelled=!0)}run(t=0){const e=this._currentlyRunning=this._queue;this._queue=[];for(const n of e)if(!n.cancelled&&(n.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Si(e,n,r){if(e=new t.LngLat(e.lng,e.lat),n){const i=new t.LngLat(e.lng-360,e.lat),o=new t.LngLat(e.lng+360,e.lat),s=360*Math.ceil(Math.abs(e.lng-r.center.lng)/360),a=r.locationPoint(e).distSqr(n),l=n.x<0||n.y<0||n.x>r.width||n.y>r.height;r.locationPoint(i).distSqr(n)<a&&(l||Math.abs(i.lng-r.center.lng)<s)?e=i:r.locationPoint(o).distSqr(n)<a&&(l||Math.abs(o.lng-r.center.lng)<s)&&(e=o)}for(;Math.abs(e.lng-r.center.lng)>180;){const t=r.locationPoint(e);if(t.x>=0&&t.y>=0&&t.x<=r.width&&t.y<=r.height)break;e.lng>r.center.lng?e.lng-=360:e.lng+=360}return e}const Ti={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Pi extends t.Evented{constructor(e,n){if(super(),(e instanceof t.window.HTMLElement||n)&&(e=t.extend({element:e},n)),t.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&"auto"!==e.pitchAlignment?e.pitchAlignment:this._rotationAlignment,e&&e.element)this._element=e.element,this._offset=t.pointGeometry.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=o.create("div"),this._element.setAttribute("aria-label","Map marker");const n=o.createNS("http://www.w3.org/2000/svg","svg"),r=41,i=27;n.setAttributeNS(null,"display","block"),n.setAttributeNS(null,"height",`${r}px`),n.setAttributeNS(null,"width",`${i}px`),n.setAttributeNS(null,"viewBox",`0 0 ${i} ${r}`);const s=o.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"stroke","none"),s.setAttributeNS(null,"stroke-width","1"),s.setAttributeNS(null,"fill","none"),s.setAttributeNS(null,"fill-rule","evenodd");const a=o.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"fill-rule","nonzero");const l=o.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"transform","translate(3.0, 29.0)"),l.setAttributeNS(null,"fill","#000000");const u=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const t of u){const e=o.createNS("http://www.w3.org/2000/svg","ellipse");e.setAttributeNS(null,"opacity","0.04"),e.setAttributeNS(null,"cx","10.5"),e.setAttributeNS(null,"cy","5.80029008"),e.setAttributeNS(null,"rx",t.rx),e.setAttributeNS(null,"ry",t.ry),l.appendChild(e)}const c=o.createNS("http://www.w3.org/2000/svg","g");c.setAttributeNS(null,"fill",this._color);const h=o.createNS("http://www.w3.org/2000/svg","path");h.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),c.appendChild(h);const p=o.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"opacity","0.25"),p.setAttributeNS(null,"fill","#000000");const f=o.createNS("http://www.w3.org/2000/svg","path");f.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),p.appendChild(f);const d=o.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"transform","translate(6.0, 7.0)"),d.setAttributeNS(null,"fill","#FFFFFF");const g=o.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"transform","translate(8.0, 8.0)");const m=o.createNS("http://www.w3.org/2000/svg","circle");m.setAttributeNS(null,"fill","#000000"),m.setAttributeNS(null,"opacity","0.25"),m.setAttributeNS(null,"cx","5.5"),m.setAttributeNS(null,"cy","5.5"),m.setAttributeNS(null,"r","5.4999962");const A=o.createNS("http://www.w3.org/2000/svg","circle");A.setAttributeNS(null,"fill","#FFFFFF"),A.setAttributeNS(null,"cx","5.5"),A.setAttributeNS(null,"cy","5.5"),A.setAttributeNS(null,"r","5.4999962"),g.appendChild(m),g.appendChild(A),a.appendChild(l),a.appendChild(c),a.appendChild(p),a.appendChild(d),a.appendChild(g),n.appendChild(a),n.setAttributeNS(null,"height",r*this._scale+"px"),n.setAttributeNS(null,"width",i*this._scale+"px"),this._element.appendChild(n),this._offset=t.pointGeometry.convert(e&&e.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(t=>{t.preventDefault()})),this._element.addEventListener("mousedown",(t=>{t.preventDefault()}));const r=this._element.classList;for(const t in Ti)r.remove(`mapboxgl-marker-anchor-${t}`);r.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("remove",this._clearFadeTimer),t._addMarker(this),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._map.off("remove",this._clearFadeTimer),this._map._removeMarker(this),delete this._map),this._clearFadeTimer(),o.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const e=38.1,n=13.5,r=Math.sqrt(Math.pow(n,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-e],"bottom-left":[r,-1*(e-n+r)],"bottom-right":[-r,-1*(e-n+r)],left:[n,-1*(e-n)],right:[-n,-1*(e-n)]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(t){const e=t.code,n=t.charCode||t.keyCode;"Space"!==e&&"Enter"!==e&&32!==n&&13!==n||this.togglePopup()}_onMapClick(t){const e=t.originalEvent.target,n=this._element;this._popup&&(e===n||n.contains(e))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this}_evaluateOpacity(){const t=this._pos?this._pos.sub(this._transformedOffset()):null;if(!this._withinScreenBounds(t))return void this._clearFadeTimer();const e=this._map.unproject(t);let n=!1;if(this._map.getTerrain()){const t=this._map.getFreeCameraOptions();if(t.position){const r=t.position.toLngLat();n=r.distanceTo(e)<.9*r.distanceTo(this._lngLat)}}const r=(1-this._map._queryFogOpacity(e))*(n?.2:1);this._element.style.opacity=`${r}`,this._popup&&this._popup._setOpacity(`${r}`),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_withinScreenBounds(t){const e=this._map.transform;return!!t&&t.x>=0&&t.x<e.width&&t.y>=0&&t.y<e.height}_update(t){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Si(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._transformedOffset());let e="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?e=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(e=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let n="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?n="rotateX(0deg)":"map"===this._pitchAlignment&&(n=`rotateX(${this._map.getPitch()}deg)`),t&&"moveend"!==t.type||(this._pos=this._pos.round()),this._map._requestDomTask((()=>{this._map&&(this._element&&this._pos&&this._anchor&&o.setTransform(this._element,`${Ti[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${n} ${e}`),!this._map.getTerrain()&&!this._map.getFog()||this._fadeTimer||(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}_transformedOffset(){if(!this._defaultMarker)return this._offset;const t=this._map.transform,e=this._offset.mult(this._scale);return"map"===this._rotationAlignment&&e._rotate(t.angle),"map"===this._pitchAlignment&&(e.y*=Math.cos(t._pitch)),e}getOffset(){return this._offset}setOffset(e){return this._offset=t.pointGeometry.convert(e),this._update(),this}_onMove(e){if(!this._isDragging){const t=this._clickTolerance||this._map._clickTolerance;this._isDragging=e.point.dist(this._pointerdownPos)>=t}this._isDragging&&(this._pos=e.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.Event("dragstart"))),this.fire(new t.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new t.Event("dragend")),this._state="inactive"}_addDragHandler(t){this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._transformedOffset()),this._pointerdownPos=t.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&"auto"!==t?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}class Mi{constructor(t){this.jumpTo(t)}getValue(e){if(e<=this._startTime)return this._start;if(e>=this._endTime)return this._end;const n=t.easeCubicInOut((e-this._startTime)/(this._endTime-this._startTime));return this._start*(1-n)+this._end*n}isEasing(t){return t>=this._startTime&&t<=this._endTime}jumpTo(t){this._startTime=-1/0,this._endTime=-1/0,this._start=t,this._end=t}easeTo(t,e,n){this._start=this.getValue(e),this._end=t,this._startTime=e,this._endTime=e+n}}const Ci={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},{HTMLImageElement:Ii,HTMLElement:Oi,ImageBitmap:Ri}=t.window,Li={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function ki(t){t.parentNode&&t.parentNode.removeChild(t)}const Di={showCompass:!0,showZoom:!0,visualizePitch:!1};class Ni{constructor(e,n,r=!1){this._clickTolerance=10,this.element=n,this.mouseRotate=new Xr({clickTolerance:e.dragRotate._mouseRotate._clickTolerance}),this.map=e,r&&(this.mousePitch=new $r({clickTolerance:e.dragRotate._mousePitch._clickTolerance})),t.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),o.addEventListener(n,"mousedown",this.mousedown),o.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),o.addEventListener(n,"touchmove",this.touchmove),o.addEventListener(n,"touchend",this.touchend),o.addEventListener(n,"touchcancel",this.reset)}down(t,e){this.mouseRotate.mousedown(t,e),this.mousePitch&&this.mousePitch.mousedown(t,e),o.disableDrag()}move(t,e){const n=this.map,r=this.mouseRotate.mousemoveWindow(t,e);if(r&&r.bearingDelta&&n.setBearing(n.getBearing()+r.bearingDelta),this.mousePitch){const r=this.mousePitch.mousemoveWindow(t,e);r&&r.pitchDelta&&n.setPitch(n.getPitch()+r.pitchDelta)}}off(){const t=this.element;o.removeEventListener(t,"mousedown",this.mousedown),o.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),o.removeEventListener(t,"touchmove",this.touchmove),o.removeEventListener(t,"touchend",this.touchend),o.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){o.enableDrag(),o.removeEventListener(t.window,"mousemove",this.mousemove),o.removeEventListener(t.window,"mouseup",this.mouseup)}mousedown(e){this.down(t.extend({},e,{ctrlKey:!0,preventDefault:()=>e.preventDefault()}),o.mousePos(this.element,e)),o.addEventListener(t.window,"mousemove",this.mousemove),o.addEventListener(t.window,"mouseup",this.mouseup)}mousemove(t){this.move(t,o.mousePos(this.element,t))}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}touchstart(t){1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=o.touchPos(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos))}touchmove(t){1!==t.targetTouches.length?this.reset():(this._lastPos=o.touchPos(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos))}touchend(t){0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Fi={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1};let Bi,zi=0,ji=!1;const Ui={maxWidth:100,unit:"metric"};function Vi(t,e,n){const r=n&&n.maxWidth||100,i=t._container.getBoundingClientRect().height/2,o=t.unproject([0,i]),s=t.unproject([r,i]),a=o.distanceTo(s);if(n&&"imperial"===n.unit){const n=3.2808*a;n>5280?Gi(e,r,n/5280,t._getUIString("ScaleControl.Miles"),t):Gi(e,r,n,t._getUIString("ScaleControl.Feet"),t)}else n&&"nautical"===n.unit?Gi(e,r,a/1852,t._getUIString("ScaleControl.NauticalMiles"),t):a>=1e3?Gi(e,r,a/1e3,t._getUIString("ScaleControl.Kilometers"),t):Gi(e,r,a,t._getUIString("ScaleControl.Meters"),t)}function Gi(t,e,n,r,i){const o=function(t){const e=Math.pow(10,`${Math.floor(t)}`.length-1);let n=t/e;return n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:n>=1?1:function(t){const e=Math.pow(10,Math.ceil(-Math.log(t)/Math.LN10));return Math.round(t*e)/e}(n),e*n}(n),s=o/n;i._requestDomTask((()=>{t.style.width=e*s+"px",t.innerHTML=`${o}&nbsp;${r}`}))}const Zi={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},qi=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Wi={version:t.version,supported:e,setRTLTextPlugin:t.setRTLTextPlugin,getRTLTextPluginStatus:t.getRTLTextPluginStatus,Map:class extends bi{constructor(e){if(null!=(e=t.extend({},Li,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=e.minPitch&&null!=e.maxPitch&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=e.minPitch&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=e.maxPitch&&e.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Er(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies),e),this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._antialias=e.antialias,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=e.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=e.collectResourceTiming,this._optimizeForTerrain=e.optimizeForTerrain,this._renderTaskQueue=new Ei,this._domRenderTaskQueue=new Ei,this._controls=[],this._markers=[],this._mapId=t.uniqueId(),this._locale=t.extend({},Ci,e.locale),this._clickTolerance=e.clickTolerance,this._averageElevationLastSampledAt=-1/0,this._averageElevation=new Mi(0),this._requestManager=new t.RequestManager(e.transformRequest,e.accessToken,e.testMode),this._silenceAuthErrors=!!e.testMode,"string"==typeof e.container){if(this._container=t.window.document.getElementById(e.container),!this._container)throw new Error(`Container '${e.container}' not found.`)}else{if(!(e.container instanceof Oi))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(e.maxBounds&&this.setMaxBounds(e.maxBounds),t.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),void 0!==t.window&&(t.window.addEventListener("online",this._onWindowOnline,!1),t.window.addEventListener("resize",this._onWindowResize,!1),t.window.addEventListener("orientationchange",this._onWindowResize,!1),t.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1)),this.handlers=new vi(this,e),this._hash=e.hash&&new Tr("string"==typeof e.hash&&e.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,t.extend({},e.fitBoundsOptions,{duration:0})))),this.resize(),this._localFontFamily=e.localFontFamily,this._localIdeographFontFamily=e.localIdeographFontFamily,e.style&&this.setStyle(e.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),e.attributionControl&&this.addControl(new xi({customAttribution:e.customAttribution})),this._logoControl=new wi,this.addControl(this._logoControl,e.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)})),this.on("data",(e=>{this._update("style"===e.dataType),this.fire(new t.Event(`${e.dataType}data`,e))})),this.on("dataloading",(e=>{this.fire(new t.Event(`${e.dataType}dataloading`,e))}))}_getMapId(){return this._mapId}addControl(e,n){if(void 0===n&&(n=e.getDefaultPosition?e.getDefaultPosition():"top-right"),!e||!e.onAdd)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const r=e.onAdd(this);this._controls.push(e);const i=this._controlPositions[n];return-1!==n.indexOf("bottom")?i.insertBefore(r,i.firstChild):i.appendChild(r),this}removeControl(e){if(!e||!e.onRemove)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(e);return n>-1&&this._controls.splice(n,1),e.onRemove(this),this}hasControl(t){return this._controls.indexOf(t)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(e){const[n,r]=this._containerDimensions();if(n===this.transform.width&&r===this.transform.height)return this;this._resizeCanvas(n,r),this.transform.resize(n,r),this.painter.resize(Math.ceil(n),Math.ceil(r));const i=!this._moving;return i&&this.fire(new t.Event("movestart",e)).fire(new t.Event("move",e)),this.fire(new t.Event("resize",e)),i&&this.fire(new t.Event("moveend",e)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(e){return this.transform.setMaxBounds(t.LngLatBounds.convert(e)),this._update()}setMinZoom(t){if((t=null==t?-2:t)>=-2&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(t){if((t=null==t?0:t)<0)throw new Error("minPitch must be greater than or equal to 0");if(t>=0&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t&&this.setPitch(t),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(t){if((t=null==t?85:t)>85)throw new Error("maxPitch must be less than or equal to 85");if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t&&this.setPitch(t),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(t){return this.transform.renderWorldCopies=t,this._update()}project(e){return this.transform.locationPoint3D(t.LngLat.convert(e))}unproject(e){return this.transform.pointLocation3D(t.pointGeometry.convert(e))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()}_createDelegatedListener(t,e,n){if("mouseenter"===t||"mouseover"===t){let r=!1;const i=i=>{const o=this.getLayer(e)?this.queryRenderedFeatures(i.point,{layers:[e]}):[];o.length?r||(r=!0,n.call(this,new Dr(t,this,i.originalEvent,{features:o}))):r=!1};return{layer:e,listener:n,delegates:{mousemove:i,mouseout:()=>{r=!1}}}}if("mouseleave"===t||"mouseout"===t){let r=!1;const i=i=>{(this.getLayer(e)?this.queryRenderedFeatures(i.point,{layers:[e]}):[]).length?r=!0:r&&(r=!1,n.call(this,new Dr(t,this,i.originalEvent)))},o=e=>{r&&(r=!1,n.call(this,new Dr(t,this,e.originalEvent)))};return{layer:e,listener:n,delegates:{mousemove:i,mouseout:o}}}{const r=t=>{const r=this.getLayer(e)?this.queryRenderedFeatures(t.point,{layers:[e]}):[];r.length&&(t.features=r,n.call(this,t),delete t.features)};return{layer:e,listener:n,delegates:{[t]:r}}}}on(t,e,n){if(void 0===n)return super.on(t,e);const r=this._createDelegatedListener(t,e,n);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(r);for(const t in r.delegates)this.on(t,r.delegates[t]);return this}once(t,e,n){if(void 0===n)return super.once(t,e);const r=this._createDelegatedListener(t,e,n);for(const t in r.delegates)this.once(t,r.delegates[t]);return this}off(t,e,n){return void 0===n?super.off(t,e):(this._delegatedListeners&&this._delegatedListeners[t]&&(r=>{const i=this._delegatedListeners[t];for(let t=0;t<i.length;t++){const r=i[t];if(r.layer===e&&r.listener===n){for(const t in r.delegates)this.off(t,r.delegates[t]);return i.splice(t,1),this}}})(),this)}queryRenderedFeatures(e,n){return this.style?(void 0!==n||void 0===e||e instanceof t.pointGeometry||Array.isArray(e)||(n=e,e=void 0),this.style.queryRenderedFeatures(e=e||[[0,0],[this.transform.width,this.transform.height]],n=n||{},this.transform)):[]}querySourceFeatures(t,e){return this.style.querySourceFeatures(t,e)}queryTerrainElevation(e,n){const r=this.transform.elevation;return r?(n=t.extend({},{exaggerated:!0},n),r.getAtPoint(t.MercatorCoordinate.fromLngLat(e),null,n.exaggerated)):null}setStyle(e,n){return!1!==(n=t.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},n)).diff&&n.localIdeographFontFamily===this._localIdeographFontFamily&&n.localFontFamily===this._localFontFamily&&this.style&&e?(this._diffStyle(e,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._localFontFamily=n.localFontFamily,this._updateStyle(e,n))}_getUIString(t){const e=this._locale[t];if(null==e)throw new Error(`Missing UI string '${t}'`);return e}_updateStyle(t,e){return this.style&&(this.style.setEventedParent(null),this.style._remove(),delete this.style),t&&(this.style=new Ge(this,e||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof t?this.style.loadURL(t):this.style.loadJSON(t)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Ge(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(e,n){if("string"==typeof e){const r=this._requestManager.normalizeStyleURL(e),i=this._requestManager.transformRequest(r,t.ResourceType.Style);t.getJSON(i,((e,r)=>{e?this.fire(new t.ErrorEvent(e)):r&&this._updateDiff(r,n)}))}else"object"==typeof e&&this._updateDiff(e,n)}_updateDiff(e,n){try{this.style.setState(e)&&this._update(!0)}catch(r){t.warnOnce(`Unable to perform style diff: ${r.message||r.error||r}.  Rebuilding the style from scratch.`),this._updateStyle(e,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():t.warnOnce("There is no style added to the map.")}addSource(t,e){return this._lazyInitEmptyStyle(),this.style.addSource(t,e),this._update(!0)}isSourceLoaded(e){const n=this.style&&this.style._getSourceCaches(e);if(0!==n.length)return n.every((t=>t.loaded()));this.fire(new t.ErrorEvent(new Error(`There is no source with ID '${e}'`)))}areTilesLoaded(){const t=this.style&&this.style._sourceCaches;for(const e in t){const n=t[e]._tiles;for(const t in n){const e=n[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}}return!0}addSourceType(t,e,n){return this._lazyInitEmptyStyle(),this.style.addSourceType(t,e,n)}removeSource(t){return this.style.removeSource(t),this._updateTerrain(),this._update(!0)}getSource(t){return this.style.getSource(t)}addImage(e,n,{pixelRatio:r=1,sdf:i=!1,stretchX:o,stretchY:s,content:a}={}){if(this._lazyInitEmptyStyle(),n instanceof Ii||Ri&&n instanceof Ri){const{width:l,height:u,data:c}=t.exported.getImageData(n);this.style.addImage(e,{data:new t.RGBAImage({width:l,height:u},c),pixelRatio:r,stretchX:o,stretchY:s,content:a,sdf:i,version:0})}else{if(void 0===n.width||void 0===n.height)return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:l,height:u,data:c}=n,h=n;this.style.addImage(e,{data:new t.RGBAImage({width:l,height:u},new Uint8Array(c)),pixelRatio:r,stretchX:o,stretchY:s,content:a,sdf:i,version:0,userImage:h}),h.onAdd&&h.onAdd(this,e)}}}updateImage(e,n){const r=this.style.getImage(e);if(!r)return this.fire(new t.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const i=n instanceof Ii||Ri&&n instanceof Ri?t.exported.getImageData(n):n,{width:o,height:s,data:a}=i;return void 0===o||void 0===s?this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):o!==r.data.width||s!==r.data.height?this.fire(new t.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(r.data.replace(a,!(n instanceof Ii||Ri&&n instanceof Ri)),void this.style.updateImage(e,r))}hasImage(e){return e?!!this.style.getImage(e):(this.fire(new t.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(t){this.style.removeImage(t)}loadImage(e,n){t.getImage(this._requestManager.transformRequest(e,t.ResourceType.Image),((e,r)=>{n(e,r instanceof Ii?t.exported.getImageData(r):r)}))}listImages(){return this.style.listImages()}addLayer(t,e){return this._lazyInitEmptyStyle(),this.style.addLayer(t,e),this._update(!0)}moveLayer(t,e){return this.style.moveLayer(t,e),this._update(!0)}removeLayer(t){return this.style.removeLayer(t),this._update(!0)}getLayer(t){return this.style.getLayer(t)}setLayerZoomRange(t,e,n){return this.style.setLayerZoomRange(t,e,n),this._update(!0)}setFilter(t,e,n={}){return this.style.setFilter(t,e,n),this._update(!0)}getFilter(t){return this.style.getFilter(t)}setPaintProperty(t,e,n,r={}){return this.style.setPaintProperty(t,e,n,r),this._update(!0)}getPaintProperty(t,e){return this.style.getPaintProperty(t,e)}setLayoutProperty(t,e,n,r={}){return this.style.setLayoutProperty(t,e,n,r),this._update(!0)}getLayoutProperty(t,e){return this.style.getLayoutProperty(t,e)}setLight(t,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(t,e),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(t){return this._lazyInitEmptyStyle(),this.style.setTerrain(t),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(t){return this._lazyInitEmptyStyle(),this.style.setFog(t),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(e){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(t.LngLat.convert(e),this.transform):0}setFeatureState(t,e){return this.style.setFeatureState(t,e),this._update()}removeFeatureState(t,e){return this.style.removeFeatureState(t,e),this._update()}getFeatureState(t){return this.style.getFeatureState(t)}_containerDimensions(){let t=0,e=0;return this._container&&(t=this._container.getBoundingClientRect().width||400,e=this._container.getBoundingClientRect().height||300),[t,e]}_detectMissingCSS(){"rgb(250, 128, 114)"!==t.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&t.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const t=this._container;t.classList.add("mapboxgl-map"),(this._missingCSSCanary=o.create("div","mapboxgl-canary",t)).style.visibility="hidden",this._detectMissingCSS();const e=this._canvasContainer=o.create("div","mapboxgl-canvas-container",t);this._interactive&&e.classList.add("mapboxgl-interactive"),this._canvas=o.create("canvas","mapboxgl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const n=this._containerDimensions();this._resizeCanvas(n[0],n[1]);const r=this._controlContainer=o.create("div","mapboxgl-control-container",t),i=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((t=>{i[t]=o.create("div",`mapboxgl-ctrl-${t}`,r)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(e,n){const r=t.exported.devicePixelRatio||1;this._canvas.width=r*Math.ceil(e),this._canvas.height=r*Math.ceil(n),this._canvas.style.width=`${e}px`,this._canvas.style.height=`${n}px`}_addMarker(t){this._markers.push(t)}_removeMarker(t){const e=this._markers.indexOf(t);-1!==e&&this._markers.splice(e,1)}_setupPainter(){const n=t.extend({},e.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl",n)||this._canvas.getContext("experimental-webgl",n);r?(t.storeAuthState(r,!0),this.painter=new dr(r,this.transform),this.on("data",(t=>{"source"===t.dataType&&this.painter.setTileLoadedFlag(!0)})),t.exported$1.testSupport(r)):this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(e){e.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new t.Event("webglcontextlost",{originalEvent:e}))}_contextRestored(e){this._setupPainter(),this.resize(),this._update(),this.fire(new t.Event("webglcontextrestored",{originalEvent:e}))}_onMapScroll(t){if(t.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(t){return this._update(),this._renderTaskQueue.add(t)}_cancelRenderFrame(t){this._renderTaskQueue.remove(t)}_requestDomTask(t){!this.isMoving()&&this.loaded()?t():this._domRenderTaskQueue.add(t)}_render(e){let n;const r=this.painter.context.extTimerQuery,i=t.exported.now();this.listens("gpu-timing-frame")&&(n=r.createQueryEXT(),r.beginQueryEXT(r.TIME_ELAPSED_EXT,n));let o=this._updateAverageElevation(i);if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(e),this._domRenderTaskQueue.run(e),this._removed)return;let s=!1;const a=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const e=this.transform.zoom,n=t.exported.now();this.style.zoomHistory.update(e,n);const r=new t.EvaluationParameters(e,{now:n,fadeDuration:a,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),i=r.crossFadingFactor();1===i&&i===this._crossFadingFactor||(s=!0,this._crossFadingFactor=i),this.style.update(r)}if(this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0),this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),this.style._updateSources(this.transform),this._forceMarkerUpdate()),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,a,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:a,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),speedIndexTiming:this.speedIndexTiming}),this.fire(new t.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new t.Event("load"))),this.style&&(this.style.hasTransitions()||s)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const e=t.exported.now()-i;r.endQueryEXT(r.TIME_ELAPSED_EXT,n),setTimeout((()=>{const i=r.getQueryObjectEXT(n,r.QUERY_RESULT_EXT)/1e6;r.deleteQueryEXT(n),this.fire(new t.Event("gpu-timing-frame",{cpuTime:e,gpuTime:i}))}),50)}if(this.listens("gpu-timing-layer")){const e=this.painter.collectGpuTimers();setTimeout((()=>{const n=this.painter.queryGpuTimers(e);this.fire(new t.Event("gpu-timing-layer",{layerTimes:n}))}),50)}const l=this._sourcesDirty||this._styleDirty||this._placementDirty||o;if(l||this._repaint)this.triggerRepaint();else{const e=!this.isMoving()&&this.loaded();if(e&&(o=this._updateAverageElevation(i,!0)),o)this.triggerRepaint();else if(this._triggerFrame(!1),e&&(this.fire(new t.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const e=this._calculateSpeedIndex();this.fire(new t.Event("speedindexcompleted",{speedIndex:e})),this.speedIndexTiming=!1}}return!this._loaded||this._fullyLoaded||l||(this._fullyLoaded=!0,this._authenticate()),this}_forceMarkerUpdate(){for(const t of this._markers)t._update()}_updateAverageElevation(t,e=!1){const n=t=>(this.transform.averageElevation=t,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&n(0);if((e||t-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(t)){const e=this.transform.averageElevation;let r=this.transform.sampleAverageElevation();isNaN(r)?r=0:this._averageElevationLastSampledAt=t;const i=Math.abs(e-r);if(i>1){if(this._isInitialLoad)return this._averageElevation.jumpTo(r),n(r);this._averageElevation.easeTo(r,t,300)}else if(i>1e-4)return this._averageElevation.jumpTo(r),n(r)}return!!this._averageElevation.isEasing(t)&&n(this._averageElevation.getValue(t))}_authenticate(){t.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(e=>{if(e&&(e.message===t.AUTH_ERR_MSG||401===e.status)){const e=this.painter.context.gl;t.storeAuthState(e,!1),this._logoControl instanceof wi&&this._logoControl._updateLogo(),e&&e.clear(e.DEPTH_BUFFER_BIT|e.COLOR_BUFFER_BIT|e.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new t.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}})),t.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(()=>{}))}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const t=this.painter.canvasCopy(),e=this.painter.getCanvasCopiesAndTimestamps();e.timeStamps.push(performance.now());const n=this.painter.context.gl,r=n.createFramebuffer();function i(t){n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0);const e=new Uint8Array(n.drawingBufferWidth*n.drawingBufferHeight*4);return n.readPixels(0,0,n.drawingBufferWidth,n.drawingBufferHeight,n.RGBA,n.UNSIGNED_BYTE,e),e}return n.bindFramebuffer(n.FRAMEBUFFER,r),this._canvasPixelComparison(i(t),e.canvasCopies.map(i),e.timeStamps)}_canvasPixelComparison(t,e,n){let r=n[1]-n[0];const i=t.length/4;for(let o=0;o<e.length;o++){const s=e[o];let a=0;for(let e=0;e<s.length;e+=4)s[e]===t[e]&&s[e+1]===t[e+1]&&s[e+2]===t[e+2]&&s[e+3]===t[e+3]&&(a+=1);r+=(n[o+2]-n[o+1])*(1-a/i)}return r}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==t.window&&(t.window.removeEventListener("resize",this._onWindowResize,!1),t.window.removeEventListener("orientationchange",this._onWindowResize,!1),t.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),t.window.removeEventListener("online",this._onWindowOnline,!1));const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e&&e.loseContext(),ki(this._canvasContainer),ki(this._controlContainer),ki(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),t.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new t.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(e){this._renderNextFrame=this._renderNextFrame||e,this.style&&!this._frame&&(this._frame=t.exported.frame((t=>{const e=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,e&&this._render(t)})))}_onWindowOnline(){this._update()}_onWindowResize(t){this._trackResize&&this.resize({originalEvent:t})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(t){this._showTerrainWireframe!==t&&(this._showTerrainWireframe=t,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(t){this._speedIndexTiming!==t&&(this._speedIndexTiming=t,this._update())}get showPadding(){return!!this._showPadding}set showPadding(t){this._showPadding!==t&&(this._showPadding=t,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())}get repaint(){return!!this._repaint}set repaint(t){this._repaint!==t&&(this._repaint=t,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(t){this._vertices=t,this._update()}_setCacheLimits(e,n){t.setCacheLimits(e,n)}get version(){return t.version}},NavigationControl:class{constructor(e){this.options=t.extend({},Di,e),this._container=o.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this.options.showZoom&&(t.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(t=>this._map.zoomIn({},{originalEvent:t}))),o.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(t=>this._map.zoomOut({},{originalEvent:t}))),o.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(t.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})})),this._compassIcon=o.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))}_updateZoomButtons(){const t=this._map.getZoom(),e=t===this._map.getMaxZoom(),n=t===this._map.getMinZoom();this._zoomInButton.disabled=e,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",e.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())}_rotateCompassArrow(){const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._map._requestDomTask((()=>{this._compassIcon&&(this._compassIcon.style.transform=t)}))}onAdd(t){return this._map=t,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ni(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){o.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(t,e){const n=o.create("button",t,this._container);return n.type="button",n.addEventListener("click",e),n}_setButtonTitle(t,e){const n=this._map._getUIString(`NavigationControl.${e}`);t.title=n,t.setAttribute("aria-label",n)}},GeolocateControl:class extends t.Evented{constructor(e){super(),this.options=t.extend({},Fi,e),t.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation"],this),this._onDeviceOrientationListener=this._onDeviceOrientation.bind(this),this._updateMarkerRotationThrottled=Sr(this._updateMarkerRotation,20)}onAdd(e){var n;return this._map=e,this._container=o.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),n=this._setupUI,void 0!==Bi?n(Bi):void 0!==t.window.navigator.permissions?t.window.navigator.permissions.query({name:"geolocation"}).then((t=>{Bi="denied"!==t.state,n(Bi)})):(Bi=!!t.window.navigator.geolocation,n(Bi)),this._container}onRemove(){void 0!==this._geolocationWatchID&&(t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),o.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,zi=0,ji=!1}_isOutOfMapMaxBounds(t){const e=this._map.getMaxBounds(),n=t.coords;return e&&(n.longitude<e.getWest()||n.longitude>e.getEast()||n.latitude<e.getSouth()||n.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(e){if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new t.Event("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("geolocate",e)),this._finish()}}_updateCamera(e){const n=new t.LngLat(e.coords.longitude,e.coords.latitude),r=e.coords.accuracy,i=this._map.getBearing(),o=t.extend({bearing:i},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(r),o,{geolocateSource:!0})}_updateMarker(e){if(e){const n=new t.LngLat(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const t=this._map._container.getBoundingClientRect().height/2,e=this._map.unproject([0,t]),n=this._map.unproject([100,t]),r=e.distanceTo(n)/100,i=Math.ceil(2*this._accuracy/r);this._circleElement.style.width=`${i}px`,this._circleElement.style.height=`${i}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(e){if(this._map){if(this.options.trackUserLocation)if(1===e.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===e.code&&ji)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("error",e)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(e){if(this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this._geolocateButton=o.create("button","mapboxgl-ctrl-geolocate",this._container),o.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===e){t.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=o.create("div","mapboxgl-user-location"),this._dotElement.appendChild(o.create("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(o.create("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Pi({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=o.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Pi({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(e=>{e.geolocateSource||"ACTIVE_LOCK"!==this._watchState||e.originalEvent&&"resize"===e.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new t.Event("trackuserlocationend")))}))}_onDeviceOrientation(t){this._userLocationDotMarker&&(t.webkitCompassHeading?this._heading=t.webkitCompassHeading:!0===t.absolute&&(this._heading=-1*t.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return t.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":zi--,ji=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new t.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let e;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),zi++,zi>1?(e={maximumAge:6e5,timeout:0},ji=!0):(e=this.options.positionOptions,ji=!1),this._geolocationWatchID=t.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,e),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else t.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const e=()=>{t.window.addEventListener("ondeviceorientationabsolute"in t.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientationListener)};void 0!==t.window.DeviceMotionEvent&&"function"==typeof t.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then((t=>{"granted"===t&&e()})).catch(console.error):e()}_clearWatch(){t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),t.window.removeEventListener("deviceorientation",this._onDeviceOrientationListener),t.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientationListener),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:xi,ScaleControl:class{constructor(e){this.options=t.extend({},Ui,e),t.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){Vi(this._map,this._container,this.options)}onAdd(t){return this._map=t,this._container=o.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){o.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(t){this.options.unit=t,Vi(this._map,this._container,this.options)}},FullscreenControl:class{constructor(e){this._fullscreen=!1,e&&e.container&&(e.container instanceof t.window.HTMLElement?this._container=e.container:t.warnOnce("Full screen control 'container' must be a DOM element.")),t.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in t.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in t.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=o.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",t.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){o.remove(this._controlContainer),this._map=null,t.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!t.window.document.fullscreenEnabled&&!t.window.document.webkitFullscreenEnabled)}_setupUI(){const e=this._fullscreenButton=o.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);o.create("span","mapboxgl-ctrl-icon",e).setAttribute("aria-hidden",!0),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),t.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const t=this._getTitle();this._fullscreenButton.setAttribute("aria-label",t),this._fullscreenButton.title=t}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(t.window.document.fullscreenElement||t.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?t.window.document.exitFullscreen?t.window.document.exitFullscreen():t.window.document.webkitCancelFullScreen&&t.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends t.Evented{constructor(e){super(),this.options=t.extend(Object.create(Zi),e),t.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this),this._classList=new Set(e&&e.className?e.className.trim().split(/\s+/):[])}addTo(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&this._map.on("preclick",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new t.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&o.remove(this._content),this._container&&(o.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new t.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(e){return this.setDOMContent(t.window.document.createTextNode(e))}setHTML(e){const n=t.window.document.createDocumentFragment(),r=t.window.document.createElement("body");let i;for(r.innerHTML=e;i=r.firstChild,i;)n.appendChild(i);return this.setDOMContent(n)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(t){return this.options.maxWidth=t,this._update(),this}setDOMContent(t){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=o.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(t),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(t){return this._classList.add(t),this._container&&this._updateClassList(),this}removeClassName(t){return this._classList.delete(t),this._container&&this._updateClassList(),this}setOffset(t){return this.options.offset=t,this._update(),this}toggleClassName(t){let e;return this._classList.delete(t)?e=!1:(this._classList.add(t),e=!0),this._container&&this._updateClassList(),e}_createCloseButton(){this.options.closeButton&&(this._closeButton=o.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(t){this._update(t.point)}_onMouseMove(t){this._update(t.point)}_onDrag(t){this._update(t.point)}_getAnchor(t){if(this.options.anchor)return this.options.anchor;const e=this._pos,n=this._container.offsetWidth,r=this._container.offsetHeight;let i;return i=e.y+t.bottom.y<r?["top"]:e.y>this._map.transform.height-r?["bottom"]:[],e.x<n/2?i.push("left"):e.x>this._map.transform.width-n/2&&i.push("right"),0===i.length?"bottom":i.join("-")}_updateClassList(){const t=[...this._classList];t.push("mapboxgl-popup"),this._anchor&&t.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&t.push("mapboxgl-popup-track-pointer"),this._container.className=t.join(" ")}_update(e){if(this._map&&(this._lngLat||this._trackPointer)&&this._content){if(this._container||(this._container=o.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=o.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content)),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Si(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||e){const n=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat),r=function(e){if(e||(e=new t.pointGeometry(0,0)),"number"==typeof e){const n=Math.round(Math.sqrt(.5*Math.pow(e,2)));return{center:new t.pointGeometry(0,0),top:new t.pointGeometry(0,e),"top-left":new t.pointGeometry(n,n),"top-right":new t.pointGeometry(-n,n),bottom:new t.pointGeometry(0,-e),"bottom-left":new t.pointGeometry(n,-n),"bottom-right":new t.pointGeometry(-n,-n),left:new t.pointGeometry(e,0),right:new t.pointGeometry(-e,0)}}if(e instanceof t.pointGeometry||Array.isArray(e)){const n=t.pointGeometry.convert(e);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:t.pointGeometry.convert(e.center||[0,0]),top:t.pointGeometry.convert(e.top||[0,0]),"top-left":t.pointGeometry.convert(e["top-left"]||[0,0]),"top-right":t.pointGeometry.convert(e["top-right"]||[0,0]),bottom:t.pointGeometry.convert(e.bottom||[0,0]),"bottom-left":t.pointGeometry.convert(e["bottom-left"]||[0,0]),"bottom-right":t.pointGeometry.convert(e["bottom-right"]||[0,0]),left:t.pointGeometry.convert(e.left||[0,0]),right:t.pointGeometry.convert(e.right||[0,0])}}(this.options.offset),i=this._anchor=this._getAnchor(r),s=n.add(r[i]).round();this._map._requestDomTask((()=>{this._container&&i&&o.setTransform(this._container,`${Ti[i]} translate(${s.x}px,${s.y}px)`)}))}this._updateClassList()}}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const t=this._container.querySelector(qi);t&&t.focus()}_onClose(){this.remove()}_setOpacity(t){this._content&&(this._content.style.opacity=t),this._tip&&(this._tip.style.opacity=t)}},Marker:Pi,Style:Ge,LngLat:t.LngLat,LngLatBounds:t.LngLatBounds,Point:t.pointGeometry,MercatorCoordinate:t.MercatorCoordinate,FreeCameraOptions:xr,Evented:t.Evented,config:t.config,prewarm:function(){Dt().acquire(Rt)},clearPrewarmedResources:function(){const t=kt;t&&(t.isPreloaded()&&1===t.numActive()?(t.release(Rt),kt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return t.config.ACCESS_TOKEN},set accessToken(e){t.config.ACCESS_TOKEN=e},get baseApiUrl(){return t.config.API_URL},set baseApiUrl(e){t.config.API_URL=e},get workerCount(){return Lt.workerCount},set workerCount(t){Lt.workerCount=t},get maxParallelImageRequests(){return t.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(e){t.config.MAX_PARALLEL_IMAGE_REQUESTS=e},clearStorage(e){t.clearTileCache(e)},workerUrl:"",workerClass:null,setNow:t.exported.setNow,restoreNow:t.exported.restoreNow};return Wi})),n}()},9811:(t,e,n)=>{"use strict";n.r(e),n.d(e,{Euler:()=>v,Matrix3:()=>p.Z,Matrix4:()=>f.Z,Pose:()=>b,Quaternion:()=>d.Z,SphericalCoordinates:()=>m.Z,Vector2:()=>i.Z,Vector3:()=>o.Z,Vector4:()=>h,_Euler:()=>v,_MathUtils:()=>g.Z,_Pose:()=>b,_SphericalCoordinates:()=>m.Z,acos:()=>r.Kh,asin:()=>r.ZR,assert:()=>x.Z,atan:()=>r.z4,checkNumber:()=>a.u5,clamp:()=>r.uZ,clone:()=>r.d9,config:()=>r.vc,configure:()=>r.jQ,cos:()=>r.mC,degrees:()=>r.RW,equals:()=>r.fS,exactEquals:()=>r.I6,formatValue:()=>r.Bw,isArray:()=>r.kJ,lerp:()=>r.t7,radians:()=>r.uR,sin:()=>r.O$,tan:()=>r.OR,toDegrees:()=>r.Ux,toRadians:()=>r.Yr,withEpsilon:()=>r.BJ});var r=n(4034),i=n(7069),o=n(3855),s=n(2678),a=n(6281),l=n(7964),u=n(1031);const c={};class h extends s.Z{static get ZERO(){return c.ZERO=c.ZERO||Object.freeze(new h(0,0,0,0))}constructor(t=0,e=0,n=0,i=0){super(-0,-0,-0,-0),(0,r.kJ)(t)&&1===arguments.length?this.copy(t):(r.vc.debug&&((0,a.u5)(t),(0,a.u5)(e),(0,a.u5)(n),(0,a.u5)(i)),this[0]=t,this[1]=e,this[2]=n,this[3]=i)}set(t,e,n,r){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}fromObject(t){return r.vc.debug&&((0,a.u5)(t.x),(0,a.u5)(t.y),(0,a.u5)(t.z),(0,a.u5)(t.w)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t.w=this[3],t}get ELEMENTS(){return 4}get z(){return this[2]}set z(t){this[2]=(0,a.u5)(t)}get w(){return this[3]}set w(t){this[3]=(0,a.u5)(t)}transform(t){return l.fF(this,this,t),this.check()}transformByMatrix3(t){return(0,u._x)(this,this,t),this.check()}transformByMatrix2(t){return(0,u.G7)(this,this,t),this.check()}transformByQuaternion(t){return l.VC(this,this,t),this.check()}applyMatrix4(t){return t.transform(this,this),this}}var p=n(540),f=n(3467),d=n(7696),g=n(9057),m=n(7858),A=n(6357);const y="Unknown Euler angle order",_=.99999;class v extends A.Z{static get ZYX(){return 0}static get YXZ(){return 1}static get XZY(){return 2}static get ZXY(){return 3}static get YZX(){return 4}static get XYZ(){return 5}static get RollPitchYaw(){return 0}static get DefaultOrder(){return v.ZYX}static get RotationOrders(){return["ZYX","YXZ","XZY","ZXY","YZX","XYZ"]}static rotationOrder(t){return v.RotationOrders[t]}get ELEMENTS(){return 4}constructor(t=0,e=0,n=0,r=v.DefaultOrder){super(-0,-0,-0,-0),arguments.length>0&&Array.isArray(arguments[0])?this.fromVector3(...arguments):this.set(t,e,n,r)}fromQuaternion(t){const[e,n,r,i]=t,o=n*n,s=-2*(o+r*r)+1,a=2*(e*n+i*r);let l=-2*(e*r-i*n);const u=2*(n*r+i*e),c=-2*(e*e+o)+1;l=l>1?1:l,l=l<-1?-1:l;const h=Math.atan2(u,c),p=Math.asin(l),f=Math.atan2(a,s);return new v(h,p,f,v.RollPitchYaw)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=Number.isFinite(t[3])||this.order,this.check()}set(t=0,e=0,n=0,r){return this[0]=t,this[1]=e,this[2]=n,this[3]=Number.isFinite(r)?r:this[3],this.check()}validate(){return(t=this[3])>=0&&t<6&&Number.isFinite(this[0])&&Number.isFinite(this[1])&&Number.isFinite(this[2]);var t}toArray(t=[],e=0){return t[e]=this[0],t[e+1]=this[1],t[e+2]=this[2],t}toArray4(t=[],e=0){return t[e]=this[0],t[e+1]=this[1],t[e+2]=this[2],t[e+3]=this[3],t}toVector3(t=[-0,-0,-0]){return t[0]=this[0],t[1]=this[1],t[2]=this[2],t}get x(){return this[0]}set x(t){this[0]=(0,a.u5)(t)}get y(){return this[1]}set y(t){this[1]=(0,a.u5)(t)}get z(){return this[2]}set z(t){this[2]=(0,a.u5)(t)}get alpha(){return this[0]}set alpha(t){this[0]=(0,a.u5)(t)}get beta(){return this[1]}set beta(t){this[1]=(0,a.u5)(t)}get gamma(){return this[2]}set gamma(t){this[2]=(0,a.u5)(t)}get phi(){return this[0]}set phi(t){this[0]=(0,a.u5)(t)}get theta(){return this[1]}set theta(t){this[1]=(0,a.u5)(t)}get psi(){return this[2]}set psi(t){this[2]=(0,a.u5)(t)}get roll(){return this[0]}set roll(t){this[0]=(0,a.u5)(t)}get pitch(){return this[1]}set pitch(t){this[1]=(0,a.u5)(t)}get yaw(){return this[2]}set yaw(t){this[2]=(0,a.u5)(t)}get order(){return this[3]}set order(t){this[3]=function(t){if(t<0&&t>=6)throw new Error(y);return t}(t)}fromVector3(t,e){return this.set(t[0],t[1],t[2],Number.isFinite(e)?e:this[3])}fromArray(t,e=0){return this[0]=t[0+e],this[1]=t[1+e],this[2]=t[2+e],void 0!==t[3]&&(this[3]=t[3]),this.check()}fromRollPitchYaw(t,e,n){return this.set(t,e,n,v.ZYX)}fromRotationMatrix(t,e=v.DefaultOrder){return this._fromRotationMatrix(t,e),this.check()}getRotationMatrix(t){return this._getRotationMatrix(t)}getQuaternion(){const t=new d.Z;switch(this[3]){case v.XYZ:return t.rotateX(this[0]).rotateY(this[1]).rotateZ(this[2]);case v.YXZ:return t.rotateY(this[0]).rotateX(this[1]).rotateZ(this[2]);case v.ZXY:return t.rotateZ(this[0]).rotateX(this[1]).rotateY(this[2]);case v.ZYX:return t.rotateZ(this[0]).rotateY(this[1]).rotateX(this[2]);case v.YZX:return t.rotateY(this[0]).rotateZ(this[1]).rotateX(this[2]);case v.XZY:return t.rotateX(this[0]).rotateZ(this[1]).rotateY(this[2]);default:throw new Error(y)}}_fromRotationMatrix(t,e=v.DefaultOrder){const n=t.elements,i=n[0],o=n[4],s=n[8],a=n[1],l=n[5],u=n[9],c=n[2],h=n[6],p=n[10];switch(e=e||this[3]){case v.XYZ:this[1]=Math.asin((0,r.uZ)(s,-1,1)),Math.abs(s)<_?(this[0]=Math.atan2(-u,p),this[2]=Math.atan2(-o,i)):(this[0]=Math.atan2(h,l),this[2]=0);break;case v.YXZ:this[0]=Math.asin(-(0,r.uZ)(u,-1,1)),Math.abs(u)<_?(this[1]=Math.atan2(s,p),this[2]=Math.atan2(a,l)):(this[1]=Math.atan2(-c,i),this[2]=0);break;case v.ZXY:this[0]=Math.asin((0,r.uZ)(h,-1,1)),Math.abs(h)<_?(this[1]=Math.atan2(-c,p),this[2]=Math.atan2(-o,l)):(this[1]=0,this[2]=Math.atan2(a,i));break;case v.ZYX:this[1]=Math.asin(-(0,r.uZ)(c,-1,1)),Math.abs(c)<_?(this[0]=Math.atan2(h,p),this[2]=Math.atan2(a,i)):(this[0]=0,this[2]=Math.atan2(-o,l));break;case v.YZX:this[2]=Math.asin((0,r.uZ)(a,-1,1)),Math.abs(a)<_?(this[0]=Math.atan2(-u,l),this[1]=Math.atan2(-c,i)):(this[0]=0,this[1]=Math.atan2(s,p));break;case v.XZY:this[2]=Math.asin(-(0,r.uZ)(o,-1,1)),Math.abs(o)<_?(this[0]=Math.atan2(h,l),this[1]=Math.atan2(s,i)):(this[0]=Math.atan2(-u,p),this[1]=0);break;default:throw new Error(y)}return this[3]=e,this}_getRotationMatrix(t){const e=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=this.x,r=this.y,i=this.z,o=Math.cos(n),s=Math.cos(r),a=Math.cos(i),l=Math.sin(n),u=Math.sin(r),c=Math.sin(i);switch(this[3]){case v.XYZ:{const t=o*a,n=o*c,r=l*a,i=l*c;e[0]=s*a,e[4]=-s*c,e[8]=u,e[1]=n+r*u,e[5]=t-i*u,e[9]=-l*s,e[2]=i-t*u,e[6]=r+n*u,e[10]=o*s;break}case v.YXZ:{const t=s*a,n=s*c,r=u*a,i=u*c;e[0]=t+i*l,e[4]=r*l-n,e[8]=o*u,e[1]=o*c,e[5]=o*a,e[9]=-l,e[2]=n*l-r,e[6]=i+t*l,e[10]=o*s;break}case v.ZXY:{const t=s*a,n=s*c,r=u*a,i=u*c;e[0]=t-i*l,e[4]=-o*c,e[8]=r+n*l,e[1]=n+r*l,e[5]=o*a,e[9]=i-t*l,e[2]=-o*u,e[6]=l,e[10]=o*s;break}case v.ZYX:{const t=o*a,n=o*c,r=l*a,i=l*c;e[0]=s*a,e[4]=r*u-n,e[8]=t*u+i,e[1]=s*c,e[5]=i*u+t,e[9]=n*u-r,e[2]=-u,e[6]=l*s,e[10]=o*s;break}case v.YZX:{const t=o*s,n=o*u,r=l*s,i=l*u;e[0]=s*a,e[4]=i-t*c,e[8]=r*c+n,e[1]=c,e[5]=o*a,e[9]=-l*a,e[2]=-u*a,e[6]=n*c+r,e[10]=t-i*c;break}case v.XZY:{const t=o*s,n=o*u,r=l*s,i=l*u;e[0]=s*a,e[4]=-c,e[8]=u*a,e[1]=t*c+i,e[5]=o*a,e[9]=n*c-r,e[2]=r*c-n,e[6]=l*a,e[10]=i*c+t;break}default:throw new Error(y)}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}toQuaternion(){const t=Math.cos(.5*this.yaw),e=Math.sin(.5*this.yaw),n=Math.cos(.5*this.roll),r=Math.sin(.5*this.roll),i=Math.cos(.5*this.pitch),o=Math.sin(.5*this.pitch),s=t*n*i+e*r*o,a=t*r*i-e*n*o,l=t*n*o+e*r*i,u=e*n*i-t*r*o;return new d.Z(a,l,u,s)}}class b{constructor({x:t=0,y:e=0,z:n=0,roll:r=0,pitch:i=0,yaw:s=0,position:a,orientation:l}={}){Array.isArray(a)&&3===a.length?this.position=new o.Z(a):this.position=new o.Z(t,e,n),Array.isArray(l)&&4===l.length?this.orientation=new v(l,l[3]):this.orientation=new v(r,i,s,v.RollPitchYaw)}get x(){return this.position.x}set x(t){this.position.x=t}get y(){return this.position.y}set y(t){this.position.y=t}get z(){return this.position.z}set z(t){this.position.z=t}get roll(){return this.orientation.roll}set roll(t){this.orientation.roll=t}get pitch(){return this.orientation.pitch}set pitch(t){this.orientation.pitch=t}get yaw(){return this.orientation.yaw}set yaw(t){this.orientation.yaw=t}getPosition(){return this.position}getOrientation(){return this.orientation}equals(t){return!!t&&this.position.equals(t.position)&&this.orientation.equals(t.orientation)}exactEquals(t){return!!t&&this.position.exactEquals(t.position)&&this.orientation.exactEquals(t.orientation)}getTransformationMatrix(){const t=Math.sin(this.roll),e=Math.sin(this.pitch),n=Math.sin(this.yaw),r=Math.cos(this.roll),i=Math.cos(this.pitch),o=Math.cos(this.yaw);return(new f.Z).setRowMajor(o*i,-n*r+o*e*t,n*t+o*e*r,this.x,n*i,o*r+n*e*t,-o*t+n*e*r,this.y,-e,i*t,i*r,this.z,0,0,0,1)}getTransformationMatrixFromPose(t){return(new f.Z).multiplyRight(this.getTransformationMatrix()).multiplyRight(t.getTransformationMatrix().invert())}getTransformationMatrixToPose(t){return(new f.Z).multiplyRight(t.getTransformationMatrix()).multiplyRight(this.getTransformationMatrix().invert())}}var x=n(394);const w="undefined"!=typeof self&&self,E="undefined"!=typeof window&&window;(void 0!==n.g&&n.g||w||E).mathgl={config:r.vc}},2317:(t,e,n)=>{"use strict";n.d(e,{Q:()=>z});var r=n(840),i=n.n(r);const o={mousedown:1,mousemove:2,mouseup:4};!function(t){const e=t.prototype.handler;t.prototype.handler=function(t){const n=this.store;t.button>0&&"pointerdown"===t.type&&(function(e,n){for(let n=0;n<e.length;n++)if(e[n].pointerId===t.pointerId)return!0;return!1}(n)||n.push(t)),e.call(this,t)}}(i().PointerEventInput),i().MouseInput.prototype.handler=function(t){let e=o[t.type];1&e&&t.button>=0&&(this.pressed=!0),2&e&&0===t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))};const s=i().Manager,a=i(),l=a?[[a.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[a.Rotate,{enable:!1}],[a.Pinch,{enable:!1}],[a.Swipe,{enable:!1}],[a.Pan,{threshold:0,enable:!1}],[a.Press,{enable:!1}],[a.Tap,{event:"doubletap",taps:2,enable:!1}],[a.Tap,{event:"anytap",enable:!1}],[a.Tap,{enable:!1}]]:null,u={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},c={doubletap:["tap"]},h={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},p={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},f={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},d={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},g="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",m="undefined"!=typeof window?window:n.g;void 0!==n.g?n.g:window,"undefined"!=typeof document&&document;let A=!1;try{const t={get passive(){return A=!0,!0}};m.addEventListener("test",t,t),m.removeEventListener("test",t,t)}catch(t){}const y=-1!==g.indexOf("firefox"),{WHEEL_EVENTS:_}=p,v="wheel",b=4.000244140625;class x{constructor(t,e,n={}){this.element=t,this.callback=e,this.options=Object.assign({enable:!0},n),this.events=_.concat(n.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach((e=>t.addEventListener(e,this.handleEvent,!!A&&{passive:!1})))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===v&&(this.options.enable=e)}handleEvent(t){if(!this.options.enable)return;let e=t.deltaY;m.WheelEvent&&(y&&t.deltaMode===m.WheelEvent.DOM_DELTA_PIXEL&&(e/=m.devicePixelRatio),t.deltaMode===m.WheelEvent.DOM_DELTA_LINE&&(e*=40));const n={x:t.clientX,y:t.clientY};0!==e&&e%b==0&&(e=Math.floor(e/b)),t.shiftKey&&e&&(e*=.25),this._onWheel(t,-e,n)}_onWheel(t,e,n){this.callback({type:v,center:n,delta:e,srcEvent:t,pointerType:"mouse",target:t.target})}}const{MOUSE_EVENTS:w}=p,E="pointermove",S="pointerover",T="pointerout",P="pointerleave";class M{constructor(t,e,n={}){this.element=t,this.callback=e,this.pressed=!1,this.options=Object.assign({enable:!0},n),this.enableMoveEvent=this.options.enable,this.enableLeaveEvent=this.options.enable,this.enableOutEvent=this.options.enable,this.enableOverEvent=this.options.enable,this.events=w.concat(n.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach((e=>t.addEventListener(e,this.handleEvent)))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===E&&(this.enableMoveEvent=e),t===S&&(this.enableOverEvent=e),t===T&&(this.enableOutEvent=e),t===P&&(this.enableLeaveEvent=e)}handleEvent(t){this.handleOverEvent(t),this.handleOutEvent(t),this.handleLeaveEvent(t),this.handleMoveEvent(t)}handleOverEvent(t){this.enableOverEvent&&"mouseover"===t.type&&this.callback({type:S,srcEvent:t,pointerType:"mouse",target:t.target})}handleOutEvent(t){this.enableOutEvent&&"mouseout"===t.type&&this.callback({type:T,srcEvent:t,pointerType:"mouse",target:t.target})}handleLeaveEvent(t){this.enableLeaveEvent&&"mouseleave"===t.type&&this.callback({type:P,srcEvent:t,pointerType:"mouse",target:t.target})}handleMoveEvent(t){if(this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":0===t.which&&(this.pressed=!1),this.pressed||this.callback({type:E,srcEvent:t,pointerType:"mouse",target:t.target});break;case"mouseup":this.pressed=!1}}}const{KEY_EVENTS:C}=p,I="keydown",O="keyup";class R{constructor(t,e,n={}){this.element=t,this.callback=e,this.options=Object.assign({enable:!0},n),this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=C.concat(n.events||[]),this.handleEvent=this.handleEvent.bind(this),t.tabIndex=n.tabIndex||0,t.style.outline="none",this.events.forEach((e=>t.addEventListener(e,this.handleEvent)))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===I&&(this.enableDownEvent=e),t===O&&(this.enableUpEvent=e)}handleEvent(t){const e=t.target||t.srcElement;"INPUT"===e.tagName&&"text"===e.type||"TEXTAREA"===e.tagName||(this.enableDownEvent&&"keydown"===t.type&&this.callback({type:I,srcEvent:t,key:t.key,target:t.target}),this.enableUpEvent&&"keyup"===t.type&&this.callback({type:O,srcEvent:t,key:t.key,target:t.target}))}}const L="contextmenu";class k{constructor(t,e,n={}){this.element=t,this.callback=e,this.options=Object.assign({enable:!0},n),this.handleEvent=this.handleEvent.bind(this),t.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(t,e){t===L&&(this.options.enable=e)}handleEvent(t){this.options.enable&&this.callback({type:L,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}const D={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4},N={srcElement:"root",priority:0};class F{constructor(t){this.eventManager=t,this.handlers=[],this.handlersByElement=new Map,this.handleEvent=this.handleEvent.bind(this),this._active=!1}isEmpty(){return!this._active}add(t,e,n,r=!1,i=!1){const{handlers:o,handlersByElement:s}=this;n&&("object"!=typeof n||n.addEventListener)&&(n={srcElement:n}),n=n?Object.assign({},N,n):N;let a=s.get(n.srcElement);a||(a=[],s.set(n.srcElement,a));const l={type:t,handler:e,srcElement:n.srcElement,priority:n.priority};r&&(l.once=!0),i&&(l.passive=!0),o.push(l),this._active=this._active||!l.passive;let u=a.length-1;for(;u>=0&&!(a[u].priority>=l.priority);)u--;a.splice(u+1,0,l)}remove(t,e){const{handlers:n,handlersByElement:r}=this;for(let i=n.length-1;i>=0;i--){const o=n[i];if(o.type===t&&o.handler===e){n.splice(i,1);const t=r.get(o.srcElement);t.splice(t.indexOf(o),1),0===t.length&&r.delete(o.srcElement)}}this._active=n.some((t=>!t.passive))}handleEvent(t){if(this.isEmpty())return;const e=this._normalizeEvent(t);let n=t.srcEvent.target;for(;n&&n!==e.rootElement;){if(this._emit(e,n),e.handled)return;n=n.parentNode}this._emit(e,"root")}_emit(t,e){const n=this.handlersByElement.get(e);if(n){let e=!1;const r=()=>{t.handled=!0},i=()=>{t.handled=!0,e=!0},o=[];for(let s=0;s<n.length;s++){const{type:a,handler:l,once:u}=n[s];if(l(Object.assign({},t,{type:a,stopPropagation:r,stopImmediatePropagation:i})),u&&o.push(n[s]),e)break}for(let t=0;t<o.length;t++){const{type:e,handler:n}=o[t];this.remove(e,n)}}}_normalizeEvent(t){const e=this.eventManager.element;return Object.assign({},t,function(t){const e=D[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r,which:i}=t.srcEvent;let o=!1,s=!1,a=!1;return 4===e||2===e&&!Number.isFinite(n)?(o=1===i,s=2===i,a=3===i):2===e?(o=Boolean(1&n),s=Boolean(4&n),a=Boolean(2&n)):1===e&&(o=0===r,s=1===r,a=2===r),{leftButton:o,middleButton:s,rightButton:a}}(t),function(t,e){const{srcEvent:n}=t;if(!t.center&&!Number.isFinite(n.clientX))return null;const r=t.center||{x:n.clientX,y:n.clientY},i=e.getBoundingClientRect(),o=i.width/e.offsetWidth||1,s=i.height/e.offsetHeight||1;return{center:r,offsetCenter:{x:(r.x-i.left-e.clientLeft)/o,y:(r.y-i.top-e.clientTop)/s}}}(t,e),{handled:!1,rootElement:e})}}const B={events:null,recognizers:null,recognizerOptions:{},Manager:s,touchAction:"none",tabIndex:0};class z{constructor(t=null,e={}){this.options=Object.assign({},B,e),this.events=new Map,this._onBasicInput=this._onBasicInput.bind(this),this._onOtherEvent=this._onOtherEvent.bind(this),this.setElement(t);const{events:n}=e;n&&this.on(n)}setElement(t){if(this.element&&this.destroy(),this.element=t,!t)return;const{options:e}=this,n=e.Manager;this.manager=new n(t,{touchAction:e.touchAction,recognizers:e.recognizers||l}).on("hammer.input",this._onBasicInput),e.recognizers||Object.keys(u).forEach((t=>{const e=this.manager.get(t);e&&u[t].forEach((t=>{e.recognizeWith(t)}))}));for(const t in e.recognizerOptions){const n=this.manager.get(t);if(n){const r=e.recognizerOptions[t];delete r.enable,n.set(r)}}this.wheelInput=new x(t,this._onOtherEvent,{enable:!1}),this.moveInput=new M(t,this._onOtherEvent,{enable:!1}),this.keyInput=new R(t,this._onOtherEvent,{enable:!1,tabIndex:e.tabIndex}),this.contextmenuInput=new k(t,this._onOtherEvent,{enable:!1});for(const[t,e]of this.events)e.isEmpty()||(this._toggleRecognizer(e.recognizerName,!0),this.manager.on(t,e.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(t,e,n){this._addEventHandler(t,e,n,!1)}once(t,e,n){this._addEventHandler(t,e,n,!0)}watch(t,e,n){this._addEventHandler(t,e,n,!1,!0)}off(t,e){this._removeEventHandler(t,e)}_toggleRecognizer(t,e){const{manager:n}=this;if(!n)return;const r=n.get(t);if(r&&r.options.enable!==e){r.set({enable:e});const i=c[t];i&&!this.options.recognizers&&i.forEach((i=>{const o=n.get(i);e?(o.requireFailure(t),r.dropRequireFailure(i)):o.dropRequireFailure(t)}))}this.wheelInput.enableEventType(t,e),this.moveInput.enableEventType(t,e),this.keyInput.enableEventType(t,e),this.contextmenuInput.enableEventType(t,e)}_addEventHandler(t,e,n,r,i){if("string"!=typeof t){n=e;for(const e in t)this._addEventHandler(e,t[e],n,r,i);return}const{manager:o,events:s}=this,a=d[t]||t;let l=s.get(a);l||(l=new F(this),s.set(a,l),l.recognizerName=f[a]||a,o&&o.on(a,l.handleEvent)),l.add(t,e,n,r,i),l.isEmpty()||this._toggleRecognizer(l.recognizerName,!0)}_removeEventHandler(t,e){if("string"!=typeof t){for(const e in t)this._removeEventHandler(e,t[e]);return}const{events:n}=this,r=d[t]||t,i=n.get(r);if(i&&(i.remove(t,e),i.isEmpty())){const{recognizerName:t}=i;let e=!1;for(const r of n.values())if(r.recognizerName===t&&!r.isEmpty()){e=!0;break}e||this._toggleRecognizer(t,!1)}}_onBasicInput(t){const{srcEvent:e}=t,n=h[e.type];n&&this.manager.emit(n,t)}_onOtherEvent(t){this.manager.emit(t.type,t)}}},1688:(t,e,n)=>{"use strict";Object.defineProperty(e,"nk",{enumerable:!0,get:function(){return r.EditableGeoJsonLayer}}),Object.defineProperty(e,"By",{enumerable:!0,get:function(){return i.DrawRectangleMode}});n(9068),n(3283),o(n(8806)),o(n(8853)),o(n(8290)),o(n(188)),o(n(5264)),o(n(7262)),o(n(2060)),n(3147);var r=n(6914),i=n(9199);function o(t){return t&&t.__esModule?t:{default:t}}},8722:(t,e)=>{"use strict";function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r(this,"objects",void 0),r(this,"originals",void 0),r(this,"updateTrigger",void 0),r(this,"_idToPosition",void 0),r(this,"_getData",void 0),r(this,"_convert",void 0),this.objects=[],this.originals=[],this.updateTrigger=0,this._idToPosition=new Map,this._getData=e,this._convert=n}var e,i;return e=t,(i=[{key:"updateAllDeckObjects",value:function(){var t=this;this._getData&&this._convert&&(this.originals.length=0,this.objects.length=0,this._idToPosition.clear(),this._getData().forEach((function(e){t._idToPosition.set(e.id,t.objects.length),t.originals.push(e),t.objects.push(t._convert(e))})),this.triggerUpdate())}},{key:"updateDeckObjectsByIds",value:function(t){var e=this;this._getData&&this._convert&&(t.forEach((function(t){var n=e._idToPosition.get(t);void 0!==n&&(e.objects[n]=e._convert(e.originals[n]))})),this.triggerUpdate())}},{key:"triggerUpdate",value:function(){this.updateTrigger++}},{key:"getDeckObjectById",value:function(t){var e=this._idToPosition.get(t);return void 0!==e?this.objects[e]:null}},{key:"getOriginalById",value:function(t){var e=this._idToPosition.get(t);return void 0!==e?this.originals[e]:null}}])&&n(e.prototype,i),t}();e.default=i},3283:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.SELECTION_TYPE=void 0;var r=n(9119),i=n(4102),o=c(n(9705)),s=c(n(3652)),a=c(n(5950)),l=c(n(8727)),u=c(n(1013));function c(t){return t&&t.__esModule?t:{default:t}}function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function p(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(t,e)||d(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t){return function(t){if(Array.isArray(t))return g(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||d(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){if(t){if("string"==typeof t)return g(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(t,e):void 0}}function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function m(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function A(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var y=[0,255,0,255],_=[255,255,255,90],v=[20,20],b="DeckDrawerPick",x={NONE:null,RECTANGLE:"rectangle",POLYGON:"polygon"};e.SELECTION_TYPE=x;var w=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),A(this,"nebula",void 0),A(this,"usePolygon",void 0),A(this,"validPolygon",void 0),A(this,"landPoints",void 0),A(this,"mousePoints",void 0),this.nebula=e,this.usePolygon=!1,this.landPoints=[],this.mousePoints=[]}var e,n;return e=t,n=[{key:"_getLayerIds",value:function(){return this.nebula.deckgl.props.layers.filter((function(t){return t&&t.props&&t.props.nebulaLayer&&t.props.nebulaLayer.enableSelection})).map((function(t){return t.id}))}},{key:"_selectFromPickingInfos",value:function(t){var e=t.map((function(t){var e=t.layer,n=t.index;return t.object.original||e.props.nebulaLayer.deckCache.originals[n]}));this.nebula.props.onSelection(e)}},{key:"_getBoundingBox",value:function(){var t=this.mousePoints,e=t.map((function(t){return t[0]})),n=t.map((function(t){return t[1]})),r=Math.min.apply(Math,f(e)),i=Math.min.apply(Math,f(n));return{x:r,y:i,width:Math.max.apply(Math,f(e))-r,height:Math.max.apply(Math,f(n))-i}}},{key:"_selectRectangleObjects",value:function(){if(2===this.landPoints.length){var t=p(this.mousePoints[0],2),e=t[0],n=t[1],r=p(this.mousePoints[1],2),i=r[0],o=r[1],s=this.nebula.deckgl.pickObjects({x:Math.min(e,i),y:Math.min(n,o),width:Math.abs(i-e),height:Math.abs(o-n),layerIds:this._getLayerIds()});this._selectFromPickingInfos(s)}}},{key:"_selectPolygonObjects",value:function(){var t=this.nebula.deckgl.pickObjects(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){A(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},this._getBoundingBox(),{layerIds:[b].concat(f(this._getLayerIds()))}));this._selectFromPickingInfos(t.filter((function(t){return t.layer.id!==b})))}},{key:"_getMousePosFromEvent",value:function(t){return[t.offsetX,t.offsetY]}},{key:"handleEvent",value:function(t,e,n){"mouseup"!==t.type&&t.stopPropagation(),this.usePolygon=n===x.POLYGON;var r=!1,i=!1,o=this.usePolygon,s=this.landPoints,a=this.mousePoints;if("mousedown"===t.type){if(o&&s.length)(this.landPoints.length<3||this.validPolygon)&&(s.push(e),a.push(this._getMousePosFromEvent(t)));else{this.landPoints=[e,e];var l=this._getMousePosFromEvent(t);this.mousePoints=[l,l]}r=!0}else"mousemove"===t.type&&s.length?(s[s.length-1]=e,a[a.length-1]=this._getMousePosFromEvent(t),r=!0):"mouseup"===t.type&&(o?s.length>4&&(0,u.default)(s[0],s[s.length-1])<.01&&this.validPolygon&&(this._selectPolygonObjects(),this.reset(),r=!0,i=!0):(this._selectRectangleObjects(),this.reset(),r=!0,i=!0));return{redraw:r,deactivate:i}}},{key:"reset",value:function(){this.landPoints=[],this.mousePoints=[]}},{key:"_makeStartPointHighlight",value:function(t){var e=(0,a.default)((0,i.point)(t),.0025);return(0,s.default)((0,o.default)(e)).geometry.coordinates}},{key:"render",value:function(){var t=this,e=[],n=[];if(this.usePolygon||2!==this.landPoints.length){if(this.usePolygon&&this.landPoints.length&&(e.push({polygon:this.landPoints,lineColor:y,fillColor:_}),this.landPoints.length>=3)){var o,s=(0,i.polygon)([[].concat(f(this.landPoints),[this.landPoints[0]])]),u=(0,a.default)((0,i.point)(this.landPoints[0]),10);try{o=(0,l.default)(u,s),n.push({polygon:o.geometry.coordinates,fillColor:[0,0,0,1]}),this.validPolygon=!0}catch(t){this.validPolygon=!1}}}else{var c=p(this.mousePoints,2),h=p(c[0],2),d=h[0],g=h[1],m=p(c[1],2),A=m[0],x=m[1],w=[[d,g],[d,x],[A,x],[A,g],[d,g]].map((function(e){return t.nebula.unprojectMousePosition(e)}));e.push({polygon:w,lineColor:y,fillColor:_})}return this.landPoints.length&&e.push({polygon:this._makeStartPointHighlight(this.landPoints[0]),lineColor:[0,0,0,0],fillColor:y}),e.push({polygon:[[0,0]]}),n.push({polygon:[[0,0]]}),[new r.PolygonLayer({id:"DeckDrawerView",data:e,fp64:!1,opacity:1,pickable:!1,lineWidthMinPixels:2,lineWidthMaxPixels:2,lineDashJustified:!0,getLineDashArray:function(t){return v},getLineColor:function(t){return t.lineColor||[0,0,0,255]},getFillColor:function(t){return t.fillColor||[0,0,0,255]},getPolygon:function(t){return t.polygon}}),new r.PolygonLayer({id:b,data:n,getLineColor:function(t){return t.lineColor||[0,0,0,255]},getFillColor:function(t){return t.fillColor||[0,0,0,255]},fp64:!1,opacity:1,stroked:!1,pickable:!0,getPolygon:function(t){return t.polygon}})]}}],n&&m(e.prototype,n),t}();e.default=w},8806:(t,e)=>{"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=function(){function t(e,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};n(this,t),i(this,"geoJson",void 0),i(this,"style",void 0),i(this,"original",void 0),i(this,"metadata",void 0),this.geoJson=e,this.style=r,this.original=o,this.metadata=s}var e,o;return e=t,(o=[{key:"getCoords",value:function(){return this.geoJson.geometry.coordinates}}])&&r(e.prototype,o),t}();e.default=o},8853:(t,e)=>{"use strict";function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(){function t(e,n){var i=n.data,o=n.groundPoint,s=n.nebula,a=n.metadata;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r(this,"canceled",void 0),r(this,"data",void 0),r(this,"metadata",void 0),r(this,"groundPoint",void 0),r(this,"nativeEvent",void 0),r(this,"nebula",void 0),this.nativeEvent=e,this.data=i,this.groundPoint=o,this.nebula=s,this.metadata=a}var e,i;return e=t,(i=[{key:"stopPropagation",value:function(){this.nativeEvent.stopPropagation(),this.canceled=!0}}])&&n(e.prototype,i),t}();e.default=i},188:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(6914),i=a(n(8290)),o=n(3147),s=a(n(8722));function a(t){return t&&t.__esModule?t:{default:t}}function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?h(t):e}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function d(t,e){return d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},d(t,e)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(l,t);var e,n,i,a=(e=l,function(){var t,n=f(e);if(p()){var r=f(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return c(this,t)});function l(t){var e,n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),i=void 0,(r="deckCache")in(n=h(e=a.call(this,t)))?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,e.deckCache=new s.default(t.getData,(function(e){return t.toNebulaFeature(e)})),e.enablePicking=!0,e}return n=l,(i=[{key:"render",value:function(t){t.nebula;var e=[0,0,0,255],n=this.deckCache,i=n.objects,s=n.updateTrigger;return new r.JunctionScatterplotLayer({id:"junctions-".concat(this.id),data:i,opacity:1,fp64:!1,pickable:!0,getPosition:function(t){return t.geoJson.geometry.coordinates},getFillColor:function(t){return(0,o.toDeckColor)(t.style.fillColor)||e},getStrokeColor:function(t){return(0,o.toDeckColor)(t.style.outlineColor)||(0,o.toDeckColor)(t.style.fillColor)||e},getRadius:function(t){return t.style.pointRadiusMeters+t.style.outlineRadiusMeters||1},getInnerRadius:function(t){return t.style.pointRadiusMeters||.5},parameters:{depthTest:!1,blend:!1},updateTriggers:{all:s},nebulaLayer:this})}}])&&u(n.prototype,i),l}(i.default);e.default=g},7262:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=n(6914),o=n(9757),s=n(9068),a=c(n(8290)),l=n(3147),u=c(n(8722));function c(t){return t&&t.__esModule?t:{default:t}}function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e){return!e||"object"!==h(e)&&"function"!=typeof e?d(t):e}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function m(t){return m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},m(t)}function A(t,e){return A=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},A(t,e)}function y(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var _=(y(r={},s.ArrowStyles.NONE,{forward:!1,backward:!1}),y(r,s.ArrowStyles.FORWARD,{forward:!0,backward:!1}),y(r,s.ArrowStyles.BACKWARD,{forward:!1,backward:!0}),y(r,s.ArrowStyles.BOTH,{forward:!0,backward:!0}),r),v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&A(t,e)}(c,t);var e,n,r,a=(e=c,function(){var t,n=m(e);if(g()){var r=m(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return f(this,t)});function c(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),y(d(e=a.call(this,t)),"deckCache",void 0),y(d(e),"noBlend",void 0),y(d(e),"highlightColor",void 0),y(d(e),"arrowSize",void 0),y(d(e),"rounded",void 0),y(d(e),"dashed",void 0),y(d(e),"markerLayerProps",void 0),e.deckCache=new u.default(t.getData,(function(e){return t.toNebulaFeature(e)})),e.enableSelection=!0;var n=t.enablePicking,r=void 0===n||n,i=t.noBlend,o=void 0!==i&&i,s=t.rounded,l=void 0===s||s,h=t.dashed,p=void 0!==h&&h,f=t.markerLayerProps,g=void 0===f?null:f;return Object.assign(d(e),{enablePicking:r,noBlend:o,rounded:l,dashed:p,markerLayerProps:g}),e}return n=c,(r=[{key:"getMouseOverSegment",value:function(){return null}},{key:"_calcMarkerPercentages",value:function(t){return t.style.arrowPercentages||((t.style.arrowStyle||s.DEFAULT_STYLE.arrowStyle)===s.ArrowStyles.NONE?[]:[[.5],[.33,.66],[.25,.5,.75]][Math.min(t.style.arrowCount||s.DEFAULT_STYLE.arrowCount,s.MAX_ARROWS)-1])}},{key:"_getHighlightedObjectIndex",value:function(t){var e=t.nebula.deckglMouseOverInfo;if(e){var n=e.originalLayer,r=e.index;if(n===this)return r}return-1}},{key:"render",value:function(t){var e=t.nebula,n=[0,0,0,255],r=this.deckCache,s=r.objects,a=r.updateTrigger;return new i.PathMarkerLayer({id:"segments-".concat(this.id),data:s,opacity:1,fp64:!1,rounded:this.rounded,pickable:!0,sizeScale:this.arrowSize||6,parameters:{depthTest:!1,blend:!this.noBlend,blendEquation:o.GL.MAX},getPath:function(t){return t.geoJson.geometry.coordinates},getColor:function(t){return(0,l.toDeckColor)(t.style.lineColor,n)},getWidth:function(t){return t.style.lineWidthMeters||1},getZLevel:function(t){return 255*t.style.zLevel},getDirection:function(t){return _[t.style.arrowStyle]},getMarkerColor:function(t){return(0,l.toDeckColor)(t.style.arrowColor,n)},getMarkerPercentages:this._calcMarkerPercentages,updateTriggers:{all:a},highlightedObjectIndex:this._getHighlightedObjectIndex({nebula:e}),highlightColor:(0,l.toDeckColor)(this.highlightColor),dashJustified:this.dashed,getDashArray:this.dashed?function(t){return t.style.dashArray}:null,markerLayerProps:this.markerLayerProps||i.PathMarkerLayer.defaultProps.markerLayerProps,nebulaLayer:this})}}])&&p(n.prototype,r),c}(a.default);e.default=v},5264:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(9119),i=a(n(8290)),o=n(3147),s=a(n(8722));function a(t){return t&&t.__esModule?t:{default:t}}function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?h(t):e}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function d(t,e){return d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},d(t,e)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(l,t);var e,n,i,a=(e=l,function(){var t,n=f(e);if(p()){var r=f(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return c(this,t)});function l(t){var e,n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),i=void 0,(r="deckCache")in(n=h(e=a.call(this,t)))?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,e.deckCache=new s.default(t.getData,(function(e){return t.toNebulaFeature(e)})),e}return n=l,(i=[{key:"render",value:function(t){var e=t.nebula,n=[0,0,0,255],i=this.deckCache,s=i.objects,a=i.updateTrigger,l=e.props.viewport.zoom;return new r.TextLayer({id:"texts-".concat(this.id),data:s,opacity:1,fp64:!1,pickable:!1,getText:function(t){return t.style.text},getPosition:function(t){return t.geoJson.geometry.coordinates},getColor:function(t){return(0,o.toDeckColor)(t.style.fillColor)||n},sizeScale:1/Math.pow(2,20-l),updateTriggers:{all:a},nebulaLayer:this})}}])&&u(n.prototype,i),l}(i.default);e.default=g},8290:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=o(n(7187)),i=o(n(701));function o(t){return t&&t.__esModule?t:{default:t}}function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?u(t):e}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}function p(t,e){return p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},p(t,e)}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(s,t);var e,n,r,o=(e=s,function(){var t,n=h(e);if(c()){var r=h(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return l(this,t)});function s(t){var e,n=t.getData,r=t.on,a=t.toNebulaFeature;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),f(u(e=o.call(this)),"getData",void 0),f(u(e),"toNebulaFeature",void 0),f(u(e),"id",void 0),f(u(e),"helperLayers",void 0),f(u(e),"usesMapEvents",!1),f(u(e),"enablePicking",!1),f(u(e),"enableSelection",!1),e.id=i.default.v4(),e.getData=n,e.toNebulaFeature=a,e.helperLayers=[],r&&Object.keys(r).forEach((function(t){return e.on(t,r[t])})),e}return n=s,(r=[{key:"render",value:function(t){return null}}])&&a(n.prototype,r),s}(r.default.EventEmitter);e.default=d},2060:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(7187),i=u(n(9144)),o=n(3764),s=u(n(3283)),a=u(n(8853)),l=u(n(8290));function u(t){return t&&t.__esModule?t:{default:t}}function c(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var d=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),f(this,"props",void 0),f(this,"deckgl",void 0),f(this,"mainContainer",void 0),f(this,"deckglMouseOverInfo",void 0),f(this,"_deckDrawer",void 0),f(this,"_mouseWasDown",void 0),f(this,"wmViewport",void 0),f(this,"queryObjectEvents",new r.EventEmitter),f(this,"forceUpdate",void 0),f(this,"inited",void 0),f(this,"_onMouseEvent",(function(t){if(e._isNebulaEvent(t)){"mousedown"===t.type&&(e._mouseWasDown=!0);var n=e.mainContainer?e.mainContainer.getBoundingClientRect():{},r=n.top,i=void 0===r?0:r,o=n.left,s=void 0===o?0:o,a=new Proxy(t,{get:function(t,e){if("offsetX"===e)return t.pageX-s;if("offsetY"===e)return t.pageY-i;if("type"===e)return t.type.replace("pointer","mouse");var n=t[e];return"function"==typeof n?n.bind(t):n}});e._handleDeckGLEvent(a)}}))}var e,n;return e=t,(n=[{key:"init",value:function(t){var e=this;this.props=t,this.wmViewport=new o.WebMercatorViewport(this.props.viewport),["click","mousemove","mouseup","mousedown"].forEach((function(t){return i.default.addEventListener(t,e._onMouseEvent,!0)}))}},{key:"detach",value:function(){var t=this;["click","mousemove","mouseup","mousedown"].forEach((function(e){return i.default.removeEventListener(e,t._onMouseEvent,!0)}))}},{key:"updateProps",value:function(t){this.props=t;var e=this.props.viewport;this.wmViewport=new o.WebMercatorViewport(e)}},{key:"log",value:function(t){var e=this.props.logger;e&&e.info&&e.info("Nebula: "+t)}},{key:"updateAllDeckObjects",value:function(){this.getAllLayers().forEach((function(t){t&&t.deckCache&&t.deckCache.updateAllDeckObjects()})),this.forceUpdate()}},{key:"updateDeckObjectsByIds",value:function(t){this.getAllLayers().forEach((function(e){e&&e.deckCache&&e.deckCache.updateDeckObjectsByIds(t)})),this.forceUpdate()}},{key:"rerenderLayers",value:function(){this.updateAllDeckObjects()}},{key:"_isNebulaEvent",value:function(t){var e=t.buttons,n=t.target,r=t.type,i=this.props.viewport;if(this._mouseWasDown&&"mouseup"===r)return this._mouseWasDown=!1,!0;if("mousemove"===r&&e>0)return!0;if(!n.getBoundingClientRect)return!1;var o=n.getBoundingClientRect();return Math.round(o.width)===Math.round(i.width)&&Math.round(o.height)===Math.round(i.height)}},{key:"getMouseGroundPosition",value:function(t){return this.wmViewport.unproject([t.offsetX,t.offsetY])}},{key:"unprojectMousePosition",value:function(t){return this.wmViewport.unproject(t)}},{key:"_handleDeckGLEvent",value:function(t){var e=this.deckgl,n=this.props,r=n.onMapMouseEvent,o=n.selectionType,l=n.eventFilter,u=!0,c="auto";if(t&&e&&o){this._deckDrawer||(this._deckDrawer=new s.default(this));var h=this.getMouseGroundPosition(t);if(l&&!l(h,t))return;this._deckDrawer.handleEvent(t,h,o).redraw&&this.forceUpdate()}else{if(t&&e&&(!t.buttons||"mousemove"!==t.type)){var p=e.props.layers.filter((function(t){return t&&t.props&&t.props.nebulaLayer&&t.props.nebulaLayer.enablePicking})).map((function(t){return t.id})),f=e.pickObject({x:t.offsetX,y:t.offsetY,radius:5,layerIds:p});if(this.queryObjectEvents.emit("pick",{event:t,pickingInfo:f}),f){u=!1;var d=f.index,g=f.lngLat;if(l&&!l(g,t))return;var m=f.layer,A=f.object;m&&m.props&&m.props.nebulaLayer&&m.props.nebulaLayer.eventHandler&&m.props.nebulaLayer.eventHandler(t,f);var y=A.original||m.props.nebulaLayer&&m.props.nebulaLayer.deckCache&&m.props.nebulaLayer.deckCache.originals[d];if(y){this.deckglMouseOverInfo={originalLayer:m.props.nebulaLayer,index:d};var _=new a.default(t,{data:y,metadata:A.metadata,groundPoint:g,nebula:this});m.props.nebulaLayer.emit(t.type,_),this.forceUpdate()}c="pointer"}}if(i.default.documentElement&&(i.default.documentElement.style.cursor=c),u){this.deckglMouseOverInfo=null;var v=this.getMouseGroundPosition(t);if(l&&!l(v,t))return;var b=new a.default(t,{groundPoint:v,nebula:this});this.getAllLayers().filter((function(t){return t&&t.usesMapEvents})).forEach((function(t){return t.emit("mapMouseEvent",b)})),this.getAllLayers().filter((function(t){return t&&t.props&&t.props.nebulaLayer&&t.props.nebulaLayer.mapMouseEvent})).forEach((function(t){return t.props.nebulaLayer.mapMouseEvent(b,t)})),r&&r(t,v)}}}},{key:"getExtraDeckLayers",value:function(){var t=[];return this._deckDrawer&&t.push.apply(t,c(this._deckDrawer.render())),t}},{key:"renderDeckLayers",value:function(){var t=this;return this.getAllLayers().map((function(e){return e instanceof l.default?e.render({nebula:t}):e})).filter(Boolean)}},{key:"getAllLayers",value:function(){var t=[];return this.props.layers.filter(Boolean).forEach((function(e){t.push(e),e instanceof l.default&&t.push.apply(t,c(e.helperLayers))})),t.filter(Boolean)}},{key:"getRenderedLayers",value:function(){return[].concat(c(this.renderDeckLayers()),c(this.getExtraDeckLayers()))}},{key:"updateAndGetRenderedLayers",value:function(t,e,n){return this.inited?(this.updateProps({layers:t,viewport:e}),this.forceUpdate=function(){return n.forceUpdate()}):(this.inited=!0,this.init({layers:t,viewport:e}),this.forceUpdate=function(){return n.forceUpdate()},this.updateAllDeckObjects()),this.getRenderedLayers()}},{key:"setDeck",value:function(t){t&&(this.deckgl=t)}},{key:"setMainContainer",value:function(t){t&&(this.mainContainer=t)}}])&&p(e.prototype,n),t}();e.default=d},9068:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_STYLE=e.MAX_ARROWS=e.DEFAULT_ARROWS=e.ArrowStyles=void 0;var n={NONE:0,FORWARD:1,BACKWARD:2,BOTH:3};e.ArrowStyles=n,e.DEFAULT_ARROWS=1,e.MAX_ARROWS=3;var r={arrowColor:[0,0,0,1],arrowCount:1,arrowStyle:n.NONE,fillColor:[0,0,0,1],lineColor:[0,0,0,1],lineWidthMeters:5,outlineRadiusMeters:0,opacity:1,zLevel:0};e.DEFAULT_STYLE=r},3147:(t,e)=>{"use strict";function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}Object.defineProperty(e,"__esModule",{value:!0}),e.toDeckColor=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[255,0,0,255];return Array.isArray(t)?[255*t[0],255*t[1],255*t[2],255*t[3]]:e},e.recursivelyTraverseNestedArrays=function t(e,r,i){if(!Array.isArray(e[0]))return!0;for(var o=0;o<e.length;o++)if(t(e[o],[].concat(function(t){if(Array.isArray(t))return n(t)}(s=r)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(s)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(s)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[o]),i)){i(e,r);break}var s;return!1}},9199:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"GeoJsonEditMode",{enumerable:!0,get:function(){return o.GeoJsonEditMode}}),Object.defineProperty(e,"ModifyMode",{enumerable:!0,get:function(){return s.ModifyMode}}),Object.defineProperty(e,"ResizeCircleMode",{enumerable:!0,get:function(){return a.ResizeCircleMode}}),Object.defineProperty(e,"TranslateMode",{enumerable:!0,get:function(){return l.TranslateMode}}),Object.defineProperty(e,"ScaleMode",{enumerable:!0,get:function(){return u.ScaleMode}}),Object.defineProperty(e,"RotateMode",{enumerable:!0,get:function(){return c.RotateMode}}),Object.defineProperty(e,"DuplicateMode",{enumerable:!0,get:function(){return h.DuplicateMode}}),Object.defineProperty(e,"ExtendLineStringMode",{enumerable:!0,get:function(){return p.ExtendLineStringMode}}),Object.defineProperty(e,"SplitPolygonMode",{enumerable:!0,get:function(){return f.SplitPolygonMode}}),Object.defineProperty(e,"ExtrudeMode",{enumerable:!0,get:function(){return d.ExtrudeMode}}),Object.defineProperty(e,"ElevationMode",{enumerable:!0,get:function(){return g.ElevationMode}}),Object.defineProperty(e,"TransformMode",{enumerable:!0,get:function(){return m.TransformMode}}),Object.defineProperty(e,"DrawPointMode",{enumerable:!0,get:function(){return A.DrawPointMode}}),Object.defineProperty(e,"DrawLineStringMode",{enumerable:!0,get:function(){return y.DrawLineStringMode}}),Object.defineProperty(e,"DrawPolygonMode",{enumerable:!0,get:function(){return _.DrawPolygonMode}}),Object.defineProperty(e,"DrawRectangleMode",{enumerable:!0,get:function(){return v.DrawRectangleMode}}),Object.defineProperty(e,"DrawSquareFromCenterMode",{enumerable:!0,get:function(){return b.DrawSquareFromCenterMode}}),Object.defineProperty(e,"DrawCircleByDiameterMode",{enumerable:!0,get:function(){return x.DrawCircleByDiameterMode}}),Object.defineProperty(e,"DrawCircleFromCenterMode",{enumerable:!0,get:function(){return w.DrawCircleFromCenterMode}}),Object.defineProperty(e,"DrawEllipseByBoundingBoxMode",{enumerable:!0,get:function(){return E.DrawEllipseByBoundingBoxMode}}),Object.defineProperty(e,"DrawEllipseUsingThreePointsMode",{enumerable:!0,get:function(){return S.DrawEllipseUsingThreePointsMode}}),Object.defineProperty(e,"DrawRectangleUsingThreePointsMode",{enumerable:!0,get:function(){return T.DrawRectangleUsingThreePointsMode}}),Object.defineProperty(e,"Draw90DegreePolygonMode",{enumerable:!0,get:function(){return P.Draw90DegreePolygonMode}}),Object.defineProperty(e,"DrawPolygonByDraggingMode",{enumerable:!0,get:function(){return M.DrawPolygonByDraggingMode}}),Object.defineProperty(e,"ImmutableFeatureCollection",{enumerable:!0,get:function(){return C.ImmutableFeatureCollection}}),Object.defineProperty(e,"ViewMode",{enumerable:!0,get:function(){return I.ViewMode}}),Object.defineProperty(e,"MeasureDistanceMode",{enumerable:!0,get:function(){return O.MeasureDistanceMode}}),Object.defineProperty(e,"MeasureAreaMode",{enumerable:!0,get:function(){return R.MeasureAreaMode}}),Object.defineProperty(e,"MeasureAngleMode",{enumerable:!0,get:function(){return L.MeasureAngleMode}}),Object.defineProperty(e,"CompositeMode",{enumerable:!0,get:function(){return k.CompositeMode}}),Object.defineProperty(e,"SnappableMode",{enumerable:!0,get:function(){return D.SnappableMode}}),Object.defineProperty(e,"_memoize",{enumerable:!0,get:function(){return N.default}}),e.utils=void 0;var i,o=n(6403),s=n(4165),a=n(4907),l=n(2636),u=n(1864),c=n(7572),h=n(1652),p=n(6414),f=n(5367),d=n(9167),g=n(1277),m=n(1601),A=n(4744),y=n(813),_=n(6190),v=n(9981),b=n(7765),x=n(4387),w=n(7298),E=n(2639),S=n(105),T=n(5759),P=n(5464),M=n(5731),C=n(4638),I=n(3105),O=n(2108),R=n(2265),L=n(7359),k=n(1807),D=n(9658),N=(i=n(6499))&&i.__esModule?i:{default:i},F=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==r(t)&&"function"!=typeof t)return{default:t};var e=B();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var s=i?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=t[o]}return n.default=t,e&&e.set(t,n),n}(n(2843));function B(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return B=function(){return t},t}e.utils=F},1807:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function i(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?l(t):e}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}function h(t,e){return h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},h(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.CompositeMode=void 0;var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(f,t);var e,n,r,p=(e=f,function(){var t,n=c(e);if(u()){var r=c(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return a(this,t)});function f(t){var e,n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),i=void 0,(r="_modes")in(n=l(e=p.call(this)))?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,e._modes=t,e}return n=f,r=[{key:"_coalesce",value:function(t){for(var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=0;r<this._modes.length&&(e=t(this._modes[r]),!(n?n(e):e));r++);return e}},{key:"handleClick",value:function(t,e){this._coalesce((function(n){return n.handleClick(t,e)}))}},{key:"handlePointerMove",value:function(t,e){return this._coalesce((function(n){return n.handlePointerMove(t,e)}))}},{key:"handleStartDragging",value:function(t,e){return this._coalesce((function(n){return n.handleStartDragging(t,e)}))}},{key:"handleStopDragging",value:function(t,e){return this._coalesce((function(n){return n.handleStopDragging(t,e)}))}},{key:"handleDragging",value:function(t,e){return this._coalesce((function(n){return n.handleDragging(t,e)}))}},{key:"getGuides",value:function(t){var e,n,r=[],s=function(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=i(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,s=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}(this._modes);try{for(s.s();!(e=s.n()).done;){var a=e.value;r.push.apply(r,function(t){if(Array.isArray(t))return o(t)}(n=a.getGuides(t).features)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(n)||i(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}}catch(t){s.e(t)}finally{s.f()}return{type:"FeatureCollection",features:r}}}],r&&s(n.prototype,r),f}(n(6403).GeoJsonEditMode);e.CompositeMode=p},5464:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Draw90DegreePolygonMode=void 0;var r=u(n(3737)),i=u(n(1208)),o=u(n(3663)),s=u(n(1013)),a=n(4102),l=n(2843);function u(t){return t&&t.__esModule?t:{default:t}}function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function h(t){return function(t){if(Array.isArray(t))return f(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||p(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t,e){if(t){if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function m(t,e,n){return m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}},m(t,e,n||t)}function A(t,e){return!e||"object"!==c(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function y(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function _(t){return _=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},_(t)}function v(t,e){return v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},v(t,e)}var b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(f,t);var e,n,u,c=(e=f,function(){var t,n=_(e);if(y()){var r=_(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return A(this,t)});function f(){return d(this,f),c.apply(this,arguments)}return n=f,(u=[{key:"createTentativeFeature",value:function(t){var e,n,r,i=this.getClickSequence(),o=t.lastPointerMoveEvent.mapCoords;if(1===i.length)e=o;else{var s=i[i.length-2],a=i[i.length-1];e=(n=(0,l.generatePointsParallelToLinePoints)(s,a,o),r=1,function(t){if(Array.isArray(t))return t}(n)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(n,r)||p(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0]}return i.length<3?{type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[].concat(h(i),[e])}}:{type:"Feature",properties:{guideType:"tentative"},geometry:{type:"Polygon",coordinates:[[].concat(h(i),[e,i[0]])]}}}},{key:"getGuides",value:function(t){var e={type:"FeatureCollection",features:[]};if(0===this.getClickSequence().length||!t.lastPointerMoveEvent)return e;var n=this.createTentativeFeature(t);return e.features.push(n),e.features=e.features.concat((0,l.getEditHandlesForGeometry)(n.geometry,-1)),e.features=e.features.slice(0,-1),e}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell"),m(_(f.prototype),"handlePointerMove",this).call(this,t,e)}},{key:"handleClick",value:function(t,e){var n=t.picks,r=this.getTentativeGuide(e);this.addClickSequence(t);var i=this.getClickSequence();if(r){if(3===i.length&&"LineString"===r.geometry.type){var o=r.geometry;i[i.length-1]=o.coordinates[o.coordinates.length-1]}else if(i.length>3&&"Polygon"===r.geometry.type){var s=r.geometry;i[i.length-1]=s.coordinates[0][s.coordinates[0].length-2];var a=(0,l.getPickedEditHandle)(n);if(a&&Array.isArray(a.properties.positionIndexes)&&(0===a.properties.positionIndexes[1]||a.properties.positionIndexes[1]===s.coordinates[0].length-3)){var u={type:"Polygon",coordinates:this.finalizedCoordinates(h(s.coordinates[0]))};this.resetClickSequence();var c=this.getAddFeatureOrBooleanPolygonAction(u,e);c&&e.onEdit(c)}}var p={screenCoords:[-1,-1],mapCoords:t.mapCoords,picks:[],pointerDownPicks:null,pointerDownScreenCoords:null,pointerDownMapCoords:null,cancelPan:function(){},sourceEvent:null};this.handlePointerMove(p,e)}}},{key:"finalizedCoordinates",value:function(t){var e=[[].concat(h(t.slice(0,-2)),[t[0]])],n=this.getIntermediatePoint(h(t));if(n)e=[[].concat(h(t.slice(0,-2)),[n,t[0]])];else{var r=h(t);r.splice(-3,1),(n=this.getIntermediatePoint(h(r)))&&(e=[[].concat(h(t.slice(0,-3)),[n,t[0]])])}return e}},{key:"getIntermediatePoint",value:function(t){var e;if(t.length>4){var n=h(t),l=n[0],u=n[1],c=(0,i.default)(l,u),p=t[t.length-3],f=t[t.length-4],d=(0,i.default)(p,f),g={first:[],second:[]};[1,2,3].forEach((function(t){var e=c+90*t;g.first.push(e>180?e-360:e);var n=d+90*t;g.second.push(n>180?n-360:n)}));var m=(0,s.default)((0,a.point)(l),(0,a.point)(p));[0,1,2].forEach((function(t){var n=(0,a.lineString)([l,(0,r.default)(l,m,g.first[t]).geometry.coordinates]);[0,1,2].forEach((function(t){var i=(0,a.lineString)([p,(0,r.default)(p,m,g.second[t]).geometry.coordinates]),s=(0,o.default)(n,i);s&&s.features.length&&(e=s.features[0].geometry.coordinates)}))}))}return e}}])&&g(n.prototype,u),f}(n(6403).GeoJsonEditMode);e.Draw90DegreePolygonMode=b},4387:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawCircleByDiameterMode=void 0;var r=s(n(265)),i=s(n(1013)),o=n(6403);function s(t){return t&&t.__esModule?t:{default:t}}function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(d,t);var e,n,s,a=(e=d,function(){var t,n=p(e);if(h()){var r=p(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return c(this,t)});function d(){return l(this,d),a.apply(this,arguments)}return n=d,(s=[{key:"getTwoClickPolygon",value:function(t,e,n){var s=(n||{}).steps,a=void 0===s?64:s,l={steps:a};a<4&&(console.warn("Minimum steps to draw a circle is 4 "),l.steps=4);var u=(0,o.getIntermediatePosition)(t,e),c=Math.max((0,i.default)(t,u),.001),h=(0,r.default)(u,c,l);return h.properties=h.properties||{},h.properties.shape="Circle",h}}])&&u(n.prototype,s),d}(n(3804).TwoClickPolygonMode);e.DrawCircleByDiameterMode=d},7298:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawCircleFromCenterMode=void 0;var r=o(n(265)),i=o(n(1013));function o(t){return t&&t.__esModule?t:{default:t}}function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}function p(t,e){return p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},p(t,e)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(f,t);var e,n,o,s=(e=f,function(){var t,n=h(e);if(c()){var r=h(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return u(this,t)});function f(){return a(this,f),s.apply(this,arguments)}return n=f,(o=[{key:"getTwoClickPolygon",value:function(t,e,n){var o=(n||{}).steps,s=void 0===o?64:o,a={steps:s};s<4&&(console.warn("Minimum steps to draw a circle is 4 "),a.steps=4);var l=Math.max((0,i.default)(t,e),.001),u=(0,r.default)(t,l,a);return u.properties=u.properties||{},u.properties.shape="Circle",u}}])&&l(n.prototype,o),f}(n(3804).TwoClickPolygonMode);e.DrawCircleFromCenterMode=f},2639:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawEllipseByBoundingBoxMode=void 0;var r=l(n(3652)),i=l(n(1013)),o=l(n(1211)),s=n(4102),a=n(6403);function l(t){return t&&t.__esModule?t:{default:t}}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function g(t,e){return g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},g(t,e)}var m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}(m,t);var e,n,l,u=(e=m,function(){var t,n=d(e);if(f()){var r=d(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return p(this,t)});function m(){return c(this,m),u.apply(this,arguments)}return n=m,(l=[{key:"getTwoClickPolygon",value:function(t,e,n){var l=Math.min(t[0],e[0]),u=Math.min(t[1],e[1]),c=Math.max(t[0],e[0]),h=Math.max(t[1],e[1]),p=(0,r.default)([l,u,c,h]).geometry.coordinates[0],f=(0,a.getIntermediatePosition)(t,e),d=Math.max((0,i.default)((0,s.point)(p[0]),(0,s.point)(p[1])),.001),g=Math.max((0,i.default)((0,s.point)(p[0]),(0,s.point)(p[3])),.001);return(0,o.default)(f,d,g)}}])&&h(n.prototype,l),m}(n(3804).TwoClickPolygonMode);e.DrawEllipseByBoundingBoxMode=m},105:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawEllipseUsingThreePointsMode=void 0;var r=l(n(1013)),i=l(n(1211)),o=l(n(1208)),s=n(4102),a=n(6403);function l(t){return t&&t.__esModule?t:{default:t}}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function g(t,e){return g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},g(t,e)}var m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}(m,t);var e,n,l,u=(e=m,function(){var t,n=d(e);if(f()){var r=d(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return p(this,t)});function m(){return c(this,m),u.apply(this,arguments)}return n=m,(l=[{key:"getThreeClickPolygon",value:function(t,e,n,l){var u=(0,a.getIntermediatePosition)(t,e),c=Math.max((0,r.default)(u,(0,s.point)(n)),.001),h=Math.max((0,r.default)(t,e),.001)/2,p={angle:(0,o.default)(t,e)};return(0,i.default)(u,c,h,p)}}])&&h(n.prototype,l),m}(n(2266).ThreeClickPolygonMode);e.DrawEllipseUsingThreePointsMode=m},813:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawLineStringMode=void 0;var r=n(2843);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function o(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}function p(t,e){return p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},p(t,e)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(f,t);var e,n,i,s=(e=f,function(){var t,n=h(e);if(c()){var r=h(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return u(this,t)});function f(){return a(this,f),s.apply(this,arguments)}return n=f,(i=[{key:"handleClick",value:function(t,e){var n=t.picks,i=(0,r.getPickedEditHandle)(n),s=!1;i||(this.addClickSequence(t),s=!0);var a=this.getClickSequence();if(a.length>1&&i&&Array.isArray(i.properties.positionIndexes)&&i.properties.positionIndexes[0]===a.length-1){var l={type:"LineString",coordinates:o(a)};this.resetClickSequence();var u=this.getAddFeatureAction(l,e.data);u&&e.onEdit(u)}else s&&e.onEdit({updatedData:e.data,editType:"addTentativePosition",editContext:{position:t.mapCoords}})}},{key:"handleKeyUp",value:function(t,e){if("Enter"===t.key){var n=this.getClickSequence();if(n.length>1){var r={type:"LineString",coordinates:o(n)};this.resetClickSequence();var i=this.getAddFeatureAction(r,e.data);i&&e.onEdit(i)}}}},{key:"getGuides",value:function(t){var e,n,r=t.lastPointerMoveEvent,i=this.getClickSequence(),s=r?[r.mapCoords]:[],a={type:"FeatureCollection",features:[]};i.length>0&&(n={type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[].concat(o(i),s)}}),n&&a.features.push(n);var l=i.map((function(t,e){return{type:"Feature",properties:{guideType:"editHandle",editHandleType:"existing",featureIndex:-1,positionIndexes:[e]},geometry:{type:"Point",coordinates:t}}}));return(e=a.features).push.apply(e,o(l)),a}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell")}}])&&l(n.prototype,i),f}(n(6403).GeoJsonEditMode);e.DrawLineStringMode=f},4744:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e,n){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}},s(t,e,n||t)}function a(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function c(t,e){return c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},c(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.DrawPointMode=void 0;var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(p,t);var e,n,r,h=(e=p,function(){var t,n=u(e);if(l()){var r=u(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return a(this,t)});function p(){return i(this,p),h.apply(this,arguments)}return n=p,(r=[{key:"createTentativeFeature",value:function(t){var e=t.lastPointerMoveEvent;return{type:"Feature",properties:{guideType:"tentative"},geometry:{type:"Point",coordinates:(e?[e.mapCoords]:[])[0]}}}},{key:"handleClick",value:function(t,e){var n={type:"Point",coordinates:t.mapCoords};e.onEdit(this.getAddFeatureAction(n,e.data))}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell"),s(u(p.prototype),"handlePointerMove",this).call(this,t,e)}}])&&o(n.prototype,r),p}(n(6403).GeoJsonEditMode);e.DrawPointMode=h},5731:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawPolygonByDraggingMode=void 0;var r,i=(r=n(3096))&&r.__esModule?r:{default:r},o=n(2843);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?h(t):e}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function d(t,e){return d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},d(t,e)}function g(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(m,t);var e,n,r,s=(e=m,function(){var t,n=f(e);if(p()){var r=f(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return c(this,t)});function m(){var t;l(this,m);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return g(h(t=s.call.apply(s,[this].concat(n))),"handleDraggingThrottled",null),t}return n=m,(r=[{key:"handleClick",value:function(t,e){}},{key:"handleStartDragging",value:function(t,e){t.cancelPan(),e.modeConfig&&e.modeConfig.throttleMs?this.handleDraggingThrottled=(0,i.default)(this.handleDraggingAux,e.modeConfig.throttleMs):this.handleDraggingThrottled=this.handleDraggingAux}},{key:"handleStopDragging",value:function(t,e){this.addClickSequence(t);var n,r=this.getClickSequence();if(this.handleDraggingThrottled&&this.handleDraggingThrottled.cancel&&this.handleDraggingThrottled.cancel(),r.length>2){var i={type:"Polygon",coordinates:[[].concat((n=r,function(t){if(Array.isArray(t))return a(t)}(n)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(n)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[r[0]])]};this.resetClickSequence();var o=this.getAddFeatureOrBooleanPolygonAction(i,e);o&&e.onEdit(o)}}},{key:"handleDraggingAux",value:function(t,e){var n=t.picks;(0,o.getPickedEditHandle)(n)||this.addClickSequence(t)}},{key:"handleDragging",value:function(t,e){this.handleDraggingThrottled&&this.handleDraggingThrottled(t,e)}}])&&u(n.prototype,r),m}(n(6190).DrawPolygonMode);e.DrawPolygonByDraggingMode=m},6190:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawPolygonMode=void 0;var r=n(2843);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function o(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}},u(t,e,n||t)}function c(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(d,t);var e,n,i,s=(e=d,function(){var t,n=p(e);if(h()){var r=p(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return c(this,t)});function d(){return a(this,d),s.apply(this,arguments)}return n=d,(i=[{key:"createTentativeFeature",value:function(t){var e,n=t.lastPointerMoveEvent,r=this.getClickSequence(),i=n?[n.mapCoords]:[];return 1===r.length||2===r.length?e={type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[].concat(o(r),i)}}:r.length>2&&(e={type:"Feature",properties:{guideType:"tentative"},geometry:{type:"Polygon",coordinates:[[].concat(o(r),i,[r[0]])]}}),e}},{key:"getGuides",value:function(t){var e,n=this.getClickSequence(),r={type:"FeatureCollection",features:[]},i=this.createTentativeFeature(t);i&&r.features.push(i);var s=n.map((function(t,e){return{type:"Feature",properties:{guideType:"editHandle",editHandleType:"existing",featureIndex:-1,positionIndexes:[e]},geometry:{type:"Point",coordinates:t}}}));return(e=r.features).push.apply(e,o(s)),r}},{key:"handleClick",value:function(t,e){var n=t.picks,i=(0,r.getPickedEditHandle)(n),s=!1;i||(this.addClickSequence(t),s=!0);var a=this.getClickSequence();if(a.length>2&&i&&Array.isArray(i.properties.positionIndexes)&&(0===i.properties.positionIndexes[0]||i.properties.positionIndexes[0]===a.length-1)){var l={type:"Polygon",coordinates:[[].concat(o(a),[a[0]])]};this.resetClickSequence();var u=this.getAddFeatureOrBooleanPolygonAction(l,e);u&&e.onEdit(u)}else s&&e.onEdit({updatedData:e.data,editType:"addTentativePosition",editContext:{position:t.mapCoords}})}},{key:"handleKeyUp",value:function(t,e){if("Enter"===t.key){var n=this.getClickSequence();if(n.length>2){var r={type:"Polygon",coordinates:[[].concat(o(n),[n[0]])]};this.resetClickSequence();var i=this.getAddFeatureOrBooleanPolygonAction(r,e);i&&e.onEdit(i)}}}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell"),u(p(d.prototype),"handlePointerMove",this).call(this,t,e)}}])&&l(n.prototype,i),d}(n(6403).GeoJsonEditMode);e.DrawPolygonMode=d},9981:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawRectangleMode=void 0;var r,i=(r=n(3652))&&r.__esModule?r:{default:r};function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}function h(t,e){return h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},h(t,e)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(p,t);var e,n,r,o=(e=p,function(){var t,n=c(e);if(u()){var r=c(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return l(this,t)});function p(){return s(this,p),o.apply(this,arguments)}return n=p,(r=[{key:"getTwoClickPolygon",value:function(t,e,n){var r=(0,i.default)([t[0],t[1],e[0],e[1]]);return r.properties=r.properties||{},r.properties.shape="Rectangle",r}}])&&a(n.prototype,r),p}(n(3804).TwoClickPolygonMode);e.DrawRectangleMode=p},5759:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawRectangleUsingThreePointsMode=void 0;var r=n(2843);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}function h(t,e){return h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},h(t,e)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(f,t);var e,n,i,p=(e=f,function(){var t,n=c(e);if(u()){var r=c(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return l(this,t)});function f(){return s(this,f),p.apply(this,arguments)}return n=f,(i=[{key:"getThreeClickPolygon",value:function(t,e,n,i){var s,a,l=(s=(0,r.generatePointsParallelToLinePoints)(t,e,n),a=2,function(t){if(Array.isArray(t))return t}(s)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(s,a)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}(s,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());return{type:"Feature",properties:{shape:"Rectangle"},geometry:{type:"Polygon",coordinates:[[t,e,l[0],l[1],t]]}}}}])&&a(n.prototype,i),f}(n(2266).ThreeClickPolygonMode);e.DrawRectangleUsingThreePointsMode=p},7765:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawSquareFromCenterMode=void 0;var r=a(n(3652)),i=a(n(1013)),o=a(n(5913)),s=n(4102);function a(t){return t&&t.__esModule?t:{default:t}}function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function d(t,e){return d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},d(t,e)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(g,t);var e,n,a,l=(e=g,function(){var t,n=f(e);if(p()){var r=f(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return h(this,t)});function g(){return u(this,g),l.apply(this,arguments)}return n=g,(a=[{key:"getTwoClickPolygon",value:function(t,e,n){var a=[e[0],t[1]],l=[t[0],e[1]],u=(0,i.default)((0,s.point)(a),(0,s.point)(t)),c=(0,i.default)((0,s.point)(l),(0,s.point)(t)),h=u<=c?u:c,p=u<=c?a:l,f=(0,s.lineString)([p,e]),d=(0,o.default)(f,h).geometry.coordinates,g=t[0]>d[0]?t[0]+Math.abs(t[0]-d[0]):t[0]-Math.abs(t[0]-d[0]),m=t[1]>d[1]?t[1]+Math.abs(t[1]-d[1]):t[1]-Math.abs(t[1]-d[1]),A=(0,r.default)([g,m,d[0],d[1]]);return A.properties=A.properties||{},A.properties.shape="Square",A}}])&&c(n.prototype,a),g}(n(3804).TwoClickPolygonMode);e.DrawSquareFromCenterMode=g},1652:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e,n){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}},s(t,e,n||t)}function a(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function c(t,e){return c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},c(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.DuplicateMode=void 0;var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(p,t);var e,n,r,h=(e=p,function(){var t,n=u(e);if(l()){var r=u(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return a(this,t)});function p(){return i(this,p),h.apply(this,arguments)}return n=p,(r=[{key:"handleStartDragging",value:function(t,e){s(u(p.prototype),"handleStartDragging",this).call(this,t,e),this._geometryBeforeTranslate&&e.onEdit(this.getAddManyFeaturesAction(this._geometryBeforeTranslate,e.data))}},{key:"updateCursor",value:function(t){this._isTranslatable?t.onUpdateCursor("copy"):t.onUpdateCursor(null)}}])&&o(n.prototype,r),p}(n(2636).TranslateMode);e.DuplicateMode=h},1277:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ElevationMode=void 0;var r=n(2843);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}},a(t,e,n||t)}function l(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}function h(t,e){return h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},h(t,e)}function p(t){var e=t.pointerDownScreenCoords,n=t.screenCoords;return 10*(e[1]-n[1])}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(g,t);var e,n,i,f,d=(e=g,function(){var t,n=c(e);if(u()){var r=c(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return l(this,t)});function g(){return o(this,g),d.apply(this,arguments)}return n=g,f=[{key:"calculateElevationChangeWithViewport",value:function(t,e){var n=e.pointerDownScreenCoords,r=e.screenCoords;return 156543.03392*Math.cos(t.latitude*Math.PI/180)/Math.pow(2,t.zoom)*(n[1]-r[1])/2}}],(i=[{key:"makeElevatedEvent",value:function(t,e,n){var r=n.modeConfig||{},i=r.minElevation,o=void 0===i?0:i,s=r.maxElevation,a=void 0===s?2e4:s,l=r.calculateElevationChange,u=void 0===l?p:l;if(!t.pointerDownScreenCoords)return t;var c=3===e.length?e[2]:0;return c+=u({pointerDownScreenCoords:t.pointerDownScreenCoords,screenCoords:t.screenCoords}),c=Math.min(c,a),c=Math.max(c,o),Object.assign({},t,{mapCoords:[e[0],e[1],c]})}},{key:"handlePointerMove",value:function(t,e){var n=(0,r.getPickedEditHandle)(t.pointerDownPicks),i=n?n.geometry.coordinates:t.mapCoords;a(c(g.prototype),"handlePointerMove",this).call(this,this.makeElevatedEvent(t,i,e),e)}},{key:"handleStopDragging",value:function(t,e){var n=(0,r.getPickedEditHandle)(t.picks),i=n?n.geometry.coordinates:t.mapCoords;a(c(g.prototype),"handleStopDragging",this).call(this,this.makeElevatedEvent(t,i,e),e)}},{key:"getCursor",value:function(t){var e=a(c(g.prototype),"getCursor",this).call(this,t);return"cell"===e&&(e="ns-resize"),e}}])&&s(n.prototype,i),f&&s(n,f),g}(n(4165).ModifyMode);e.ElevationMode=f},6414:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ExtendLineStringMode=void 0;var r=n(6403),i=n(4638);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}function h(t,e){return h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},h(t,e)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(p,t);var e,n,r,o=(e=p,function(){var t,n=c(e);if(u()){var r=c(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return l(this,t)});function p(){return s(this,p),o.apply(this,arguments)}return n=p,(r=[{key:"getSingleSelectedLineString",value:function(t){var e=this.getSelectedGeometry(t);return e&&"LineString"===e.type?e:null}},{key:"handleClick",value:function(t,e){var n=e.selectedIndexes,r=this.getSingleSelectedLineString(e);if(r){var o=[r.coordinates.length],s=e.modeConfig;s&&s.drawAtFront&&(o=[0]);var a=n[0],l=new i.ImmutableFeatureCollection(e.data).addPosition(a,o,t.mapCoords).getObject();e.onEdit({updatedData:l,editType:"addPosition",editContext:{featureIndexes:[a],positionIndexes:o,position:t.mapCoords}})}else console.warn("ExtendLineStringMode only supported for single LineString selection")}},{key:"getGuides",value:function(t){var e={type:"FeatureCollection",features:[]},n=this.getSingleSelectedLineString(t);if(!n)return e;var r,i=t.lastPointerMoveEvent&&t.lastPointerMoveEvent.mapCoords,o=t.modeConfig;return r=o&&o.drawAtFront?n.coordinates[0]:n.coordinates[n.coordinates.length-1],e.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[r,i]}}),e}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell")}}])&&a(n.prototype,r),p}(r.GeoJsonEditMode);e.ExtendLineStringMode=p},9167:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ExtrudeMode=void 0;var r,i=(r=n(1208))&&r.__esModule?r:{default:r},o=n(2843),s=n(4165),a=n(4638);function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function u(t){return function(t){if(Array.isArray(t))return p(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||h(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(t,e)||h(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){if(t){if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,e):void 0}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function g(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?m(t):e}function m(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function A(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}function _(t,e){return _=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},_(t,e)}function v(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_(t,e)}(l,t);var e,n,r,s=(e=l,function(){var t,n=y(e);if(A()){var r=y(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return g(this,t)});function l(){var t;f(this,l);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return v(m(t=s.call.apply(s,[this].concat(n))),"isPointAdded",!1),t}return n=l,(r=[{key:"handleDragging",value:function(t,e){var n=(0,o.getPickedEditHandle)(t.pointerDownPicks);if(n){var r=n.properties.featureIndex,i=n.properties.positionIndexes,s=this.coordinatesSize(i,r,e.data);i=this.isPointAdded?this.nextPositionIndexes(i,s):i;var l=this.getPointForPositionIndexes(this.prevPositionIndexes(i,s),r,e.data),u=this.getPointForPositionIndexes(i,r,e.data);if(l&&u){var h=c((0,o.generatePointsParallelToLinePoints)(l,u,t.mapCoords),2),p=h[0],f=h[1],d=new a.ImmutableFeatureCollection(e.data).replacePosition(r,this.prevPositionIndexes(i,s),f).replacePosition(r,i,p).getObject();e.onEdit({updatedData:d,editType:"extruding",editContext:{featureIndexes:[r],positionIndexes:this.nextPositionIndexes(i,s),position:p}}),t.cancelPan()}}}},{key:"handleStartDragging",value:function(t,e){var n=e.selectedIndexes,r=(0,o.getPickedIntermediateEditHandle)(t.picks);if(n.length&&r){var i=r.properties,s=i.positionIndexes,l=i.featureIndex,u=this.coordinatesSize(s,l,e.data),c=this.getPointForPositionIndexes(this.prevPositionIndexes(s,u),l,e.data),h=this.getPointForPositionIndexes(s,l,e.data);if(c&&h){var p=new a.ImmutableFeatureCollection(e.data);this.isOrthogonal(s,l,u,e.data)||(p=p.addPosition(l,s,h)),this.isOrthogonal(this.prevPositionIndexes(s,u),l,u,e.data)||(p=p.addPosition(l,s,c),this.isPointAdded=!0),e.onEdit({updatedData:p.getObject(),editType:"startExtruding",editContext:{featureIndexes:[l],positionIndexes:s,position:c}})}}}},{key:"handleStopDragging",value:function(t,e){var n=e.selectedIndexes,r=(0,o.getPickedEditHandle)(t.pointerDownPicks);if(n.length&&r){var i=r.properties.featureIndex,s=r.properties.positionIndexes,l=this.coordinatesSize(s,i,e.data);s=this.isPointAdded?this.nextPositionIndexes(s,l):s;var u=this.getPointForPositionIndexes(this.prevPositionIndexes(s,l),i,e.data),h=this.getPointForPositionIndexes(s,i,e.data);if(u&&h){var p=c((0,o.generatePointsParallelToLinePoints)(u,h,t.mapCoords),2),f=p[0],d=p[1],g=new a.ImmutableFeatureCollection(e.data).replacePosition(i,this.prevPositionIndexes(s,l),d).replacePosition(i,s,f).getObject();e.onEdit({updatedData:g,editType:"extruded",editContext:{featureIndexes:[i],positionIndexes:s,position:f}})}}this.isPointAdded=!1}},{key:"coordinatesSize",value:function(t,e,n){var r=n.features,i=0;if(Array.isArray(t)){var o=r[e].geometry.coordinates;if(3===t.length){var s=c(t,2),a=s[0],l=s[1];o.length&&o[a].length&&(i=o[a][l].length)}else{var u=c(t,1)[0];o.length&&o[u].length&&(i=o[u].length)}}return i}},{key:"getBearing",value:function(t,e){var n=(0,i.default)(t,e);return n<0?Math.floor(360+n):Math.floor(n)}},{key:"isOrthogonal",value:function(t,e,n,r){if(!Array.isArray(t))return!1;t[t.length-1]===n-1&&(t[t.length-1]=0);var i=this.getPointForPositionIndexes(this.prevPositionIndexes(t,n),e,r),o=this.getPointForPositionIndexes(this.nextPositionIndexes(t,n),e,r),s=this.getPointForPositionIndexes(t,e,r),a=this.getBearing(s,i),l=this.getBearing(s,o);return[89,90,91,269,270,271].includes(Math.abs(a-l))}},{key:"nextPositionIndexes",value:function(t,e){if(!Array.isArray(t))return[];var n=u(t);return n.length&&(n[n.length-1]=n[n.length-1]===e-1?0:n[n.length-1]+1),n}},{key:"prevPositionIndexes",value:function(t,e){if(!Array.isArray(t))return[];var n=u(t);return n.length&&(n[n.length-1]=0===n[n.length-1]?e-2:n[n.length-1]-1),n}},{key:"getPointForPositionIndexes",value:function(t,e,n){var r,i=n.features;if(Array.isArray(t)){var o=i[e].geometry.coordinates;if(3===t.length){var s=c(t,3),a=s[0],l=s[1],u=s[2];o.length&&o[a].length&&(r=o[a][l][u])}else{var h=c(t,2),p=h[0],f=h[1];o.length&&o[p].length&&(r=o[p][f])}}return r}}])&&d(n.prototype,r),l}(s.ModifyMode);e.ExtrudeMode=b},6403:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getIntermediatePosition=function(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]},e.GeoJsonEditMode=void 0;var r=u(n(1959)),i=u(n(8727)),o=u(n(4170)),s=u(n(1138)),a=n(2843),l=n(4638);function u(t){return t&&t.__esModule?t:{default:t}}function c(t){return function(t){if(Array.isArray(t))return p(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||h(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){if(t){if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,e):void 0}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var d={type:"FeatureCollection",features:[]},g=[],m=function(){function t(){var e,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n=[],(e="_clickSequence")in this?Object.defineProperty(this,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[e]=n}var e,n;return e=t,(n=[{key:"getGuides",value:function(t){return d}},{key:"getTooltips",value:function(t){return g}},{key:"getSelectedFeature",value:function(t){return 1===t.selectedIndexes.length?t.data.features[t.selectedIndexes[0]]:null}},{key:"getSelectedGeometry",value:function(t){var e=this.getSelectedFeature(t);return e?e.geometry:null}},{key:"getSelectedFeaturesAsFeatureCollection",value:function(t){var e=t.data.features;return{type:"FeatureCollection",features:t.selectedIndexes.map((function(t){return e[t]}))}}},{key:"getClickSequence",value:function(){return this._clickSequence}},{key:"addClickSequence",value:function(t){var e=t.mapCoords;this._clickSequence.push(e)}},{key:"resetClickSequence",value:function(){this._clickSequence=[]}},{key:"getTentativeGuide",value:function(t){return this.getGuides(t).features.find((function(t){return t.properties&&"tentative"===t.properties.guideType}))}},{key:"isSelectionPicked",value:function(t,e){if(!t.length)return!1;var n=(0,a.getNonGuidePicks)(t).map((function(t){return t.index})),r=(0,a.getPickedEditHandles)(t).map((function(t){return t.properties.featureIndex})),i=new Set([].concat(c(n),c(r)));return e.selectedIndexes.some((function(t){return i.has(t)}))}},{key:"rewindPolygon",value:function(t){var e=t.geometry;return"Polygon"===e.type||"MultiPolygon"===e.type?(0,s.default)(t):t}},{key:"getAddFeatureAction",value:function(t,e){var n=t,r="Feature"===n.type?n:{type:"Feature",properties:{},geometry:n},i=this.rewindPolygon(r),o=new l.ImmutableFeatureCollection(e).addFeature(i).getObject();return{updatedData:o,editType:"addFeature",editContext:{featureIndexes:[o.features.length-1]}}}},{key:"getAddManyFeaturesAction",value:function(t,e){var n,r=t.features,i=new l.ImmutableFeatureCollection(e),o=i.getObject().features.length,s=[],a=function(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=h(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}(r);try{for(a.s();!(n=a.n()).done;){var u=n.value,c=u.properties,p=u.geometry;i=i.addFeature({type:"Feature",properties:c,geometry:p}),s.push(o+s.length)}}catch(t){a.e(t)}finally{a.f()}return{updatedData:i.getObject(),editType:"addFeature",editContext:{featureIndexes:s}}}},{key:"getAddFeatureOrBooleanPolygonAction",value:function(t,e){var n=t,s=this.getSelectedFeature(e),a=e.modeConfig;if(a&&a.booleanOperation){if(!s||"Polygon"!==s.geometry.type&&"MultiPolygon"!==s.geometry.type)return console.warn("booleanOperation only supported for single Polygon or MultiPolygon selection"),null;var u,c="Feature"===n.type?n:{type:"Feature",geometry:n};if("union"===a.booleanOperation)u=(0,r.default)(s,c);else if("difference"===a.booleanOperation)u=(0,i.default)(s,c);else{if("intersection"!==a.booleanOperation)return console.warn("Invalid booleanOperation ".concat(a.booleanOperation)),null;u=(0,o.default)(s,c)}if(!u)return console.warn("Canceling edit. Boolean operation erased entire polygon."),null;var h=e.selectedIndexes[0];return{updatedData:new l.ImmutableFeatureCollection(e.data).replaceGeometry(h,u.geometry).getObject(),editType:"unionGeometry",editContext:{featureIndexes:[h]}}}return this.getAddFeatureAction(t,e.data)}},{key:"createTentativeFeature",value:function(t){return null}},{key:"handleClick",value:function(t,e){}},{key:"handlePointerMove",value:function(t,e){var n=this.createTentativeFeature(e);n&&e.onEdit({updatedData:e.data,editType:"updateTentativeFeature",editContext:{feature:n}})}},{key:"handleStartDragging",value:function(t,e){}},{key:"handleStopDragging",value:function(t,e){}},{key:"handleDragging",value:function(t,e){}},{key:"handleKeyUp",value:function(t,e){"Escape"===t.key&&(this.resetClickSequence(),e.onEdit({updatedData:e.data,editType:"cancelFeature",editContext:{}}))}}])&&f(e.prototype,n),t}();e.GeoJsonEditMode=m},4638:(t,e)=>{"use strict";function n(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(e,"__esModule",{value:!0}),e.ImmutableFeatureCollection=void 0;var l=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),a(this,"featureCollection",void 0),this.featureCollection=e}var e,r;return e=t,(r=[{key:"getObject",value:function(){return this.featureCollection}},{key:"replacePosition",value:function(t,e,n){var r=this.featureCollection.features[t].geometry,i="Polygon"===r.type||"MultiPolygon"===r.type,s=o({},r,{coordinates:c(r.coordinates,e,n,i)});return this.replaceGeometry(t,s)}},{key:"removePosition",value:function(t,e){var n=this.featureCollection.features[t].geometry;if("Point"===n.type)throw Error("Can't remove a position from a Point or there'd be nothing left");if("MultiPoint"===n.type&&n.coordinates.length<2)throw Error("Can't remove the last point of a MultiPoint or there'd be nothing left");if("LineString"===n.type&&n.coordinates.length<3)throw Error("Can't remove position. LineString must have at least two positions");if("Polygon"===n.type&&n.coordinates[0].length<5&&Array.isArray(e)&&0===e[0])throw Error("Can't remove position. Polygon's outer ring must have at least four positions");if("MultiLineString"===n.type&&1===n.coordinates.length&&n.coordinates[0].length<3)throw Error("Can't remove position. MultiLineString must have at least two positions");if("MultiPolygon"===n.type&&1===n.coordinates.length&&n.coordinates[0][0].length<5&&Array.isArray(e)&&0===e[0]&&0===e[1])throw Error("Can't remove position. MultiPolygon's outer ring must have at least four positions");var r="Polygon"===n.type||"MultiPolygon"===n.type,i=o({},n,{coordinates:h(n.coordinates,e,r)});return function(t){switch(t.type){case"Polygon":!function(t){for(var e=t.coordinates,n=1;n<e.length;n++)f(e,n)&&n--}(t);break;case"MultiLineString":!function(t){for(var e=0;e<t.coordinates.length;e++)1===t.coordinates[e].length&&(t.coordinates.splice(e,1),e--)}(t);break;case"MultiPolygon":!function(t){for(var e=0;e<t.coordinates.length;e++){var n=t.coordinates[e];n[0].length<=3&&(t.coordinates.splice(e,1),e--);for(var r=1;r<n.length;r++)f(n,r)&&r--}}(t)}}(i),this.replaceGeometry(t,i)}},{key:"addPosition",value:function(t,e,n){var r=this.featureCollection.features[t].geometry;if("Point"===r.type)throw new Error("Unable to add a position to a Point feature");var i="Polygon"===r.type||"MultiPolygon"===r.type,s=o({},r,{coordinates:p(r.coordinates,e,n,i)});return this.replaceGeometry(t,s)}},{key:"replaceGeometry",value:function(e,r){var i=o({},this.featureCollection.features[e],{geometry:r});return new t(o({},this.featureCollection,{features:[].concat(n(this.featureCollection.features.slice(0,e)),[i],n(this.featureCollection.features.slice(e+1)))}))}},{key:"addFeature",value:function(t){return this.addFeatures([t])}},{key:"addFeatures",value:function(e){return new t(o({},this.featureCollection,{features:[].concat(n(this.featureCollection.features),n(e))}))}},{key:"deleteFeature",value:function(t){return this.deleteFeatures([t])}},{key:"deleteFeatures",value:function(e){var r=n(this.featureCollection.features);e.sort();for(var i=e.length-1;i>=0;i--){var s=e[i];s>=0&&s<r.length&&r.splice(s,1)}return new t(o({},this.featureCollection,{features:r}))}}])&&s(e.prototype,r),t}();function u(t,e){if(2===t.length&&3===e.length){var n=e[2];return[t[0],t[1],n]}return t}function c(t,e,r,i){if(!e)return t;if(0===e.length)return u(r,t);if(1===e.length){var o=[].concat(n(t.slice(0,e[0])),[u(r,t[e[0]])],n(t.slice(e[0]+1)));return!i||0!==e[0]&&e[0]!==t.length-1||(o[0]=u(r,t[0]),o[t.length-1]=u(r,t[0])),o}return[].concat(n(t.slice(0,e[0])),[c(t[e[0]],e.slice(1,e.length),r,i)],n(t.slice(e[0]+1)))}function h(t,e,r){if(!e)return t;if(0===e.length)throw Error("Must specify the index of the position to remove");if(1===e.length){var i=[].concat(n(t.slice(0,e[0])),n(t.slice(e[0]+1)));return!r||0!==e[0]&&e[0]!==t.length-1||(0===e[0]?i[i.length-1]=i[0]:e[0]===t.length-1&&(i[0]=i[i.length-1])),i}return[].concat(n(t.slice(0,e[0])),[h(t[e[0]],e.slice(1,e.length),r)],n(t.slice(e[0]+1)))}function p(t,e,r,i){if(!e)return t;if(0===e.length)throw Error("Must specify the index of the position to remove");return 1===e.length?[].concat(n(t.slice(0,e[0])),[r],n(t.slice(e[0]))):[].concat(n(t.slice(0,e[0])),[p(t[e[0]],e.slice(1,e.length),r,i)],n(t.slice(e[0]+1)))}function f(t,e){return t[e].length<=3&&(t.splice(e,1),!0)}e.ImmutableFeatureCollection=l},7359:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MeasureAngleMode=void 0;var r=a(n(1208)),i=a(n(8230)),o=a(n(6499)),s=n(6403);function a(t){return t&&t.__esModule?t:{default:t}}function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?f(t):e}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function g(t){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},g(t)}function m(t,e){return m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},m(t,e)}function A(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var y=[],_=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(l,t);var e,n,s,a=(e=l,function(){var t,n=g(e);if(d()){var r=g(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return p(this,t)});function l(){var t;c(this,l);for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return A(f(t=a.call.apply(a,[this].concat(n))),"_getTooltips",(0,o.default)((function(t){var e=t.modeConfig,n=t.vertex,o=t.point1,s=t.point2,a=y;if(n&&o&&s){var l,u=e||{},c=u.formatTooltip,h=u.measurementCallback,p=(0,r.default)(n,o),f=(0,r.default)(n,s),d=Math.abs(p-f);d>180&&(d=360-d),l=c?c(d):"".concat(parseFloat(d).toFixed(2)," ").concat("deg"),h&&h(d),a=[{position:(0,i.default)({type:"FeatureCollection",features:[o,s].map((function(t){return{type:"Feature",geometry:{type:"Point",coordinates:t}}}))}).geometry.coordinates,text:l}]}return a}))),t}return n=l,(s=[{key:"handleClick",value:function(t,e){this.getClickSequence().length>=3&&this.resetClickSequence(),this.addClickSequence(t)}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell")}},{key:"getPoints",value:function(t){var e,n=this.getClickSequence(),r=function(t){if(Array.isArray(t))return u(t)}(e=n)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(e)||function(t,e){if(t){if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();return n.length<3&&t.lastPointerMoveEvent&&r.push(t.lastPointerMoveEvent.mapCoords),r}},{key:"getGuides",value:function(t){var e={type:"FeatureCollection",features:[]},n=e.features,r=this.getPoints(t);return r.length>2?n.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[r[1],r[0],r[2]]}}):r.length>1&&n.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[r[1],r[0]]}}),e}},{key:"getTooltips",value:function(t){var e=this.getPoints(t);return this._getTooltips({modeConfig:t.modeConfig,vertex:e[0],point1:e[1],point2:e[2]})}}])&&h(n.prototype,s),l}(s.GeoJsonEditMode);e.MeasureAngleMode=_},2265:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MeasureAreaMode=void 0;var r=s(n(1070)),i=s(n(6338)),o=n(6190);function s(t){return t&&t.__esModule?t:{default:t}}function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e,n){return p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}},p(t,e,n||t)}function f(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function g(t){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},g(t)}function m(t,e){return m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},m(t,e)}var A=[],y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(a,t);var e,n,o,s=(e=a,function(){var t,n=g(e);if(d()){var r=g(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return f(this,t)});function a(){return c(this,a),s.apply(this,arguments)}return n=a,o=[{key:"handleClick",value:function(t,e){var n=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},e,{onEdit:function(){}});p(g(a.prototype),"handleClick",this).call(this,t,n)}},{key:"getTooltips",value:function(t){var e=this.getTentativeGuide(t);if(e&&"Polygon"===e.geometry.type){var n,o=t.modeConfig||{},s=o.formatTooltip,a=o.measurementCallback,l=(0,i.default)(e),u=(0,r.default)(e);return n=s?s(u):"".concat(parseFloat(u).toFixed(2)," ").concat("sq. m"),a&&a(u),[{position:l.geometry.coordinates,text:n}]}return A}}],o&&h(n.prototype,o),a}(o.DrawPolygonMode);e.MeasureAreaMode=y},2108:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MeasureDistanceMode=void 0;var r,i=(r=n(1013))&&r.__esModule?r:{default:r},o=n(2843);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?p(t):e}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function g(t,e){return g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},g(t,e)}function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var A=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}(l,t);var e,n,r,s=(e=l,function(){var t,n=d(e);if(f()){var r=d(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return h(this,t)});function l(){var t;u(this,l);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return m(p(t=s.call.apply(s,[this].concat(n))),"_isMeasuringSessionFinished",!1),m(p(t),"_currentTooltips",[]),m(p(t),"_currentDistance",0),m(p(t),"_calculateDistanceForTooltip",(function(t){var e=t.positionA,n=t.positionB,r=t.modeConfig||{},o=r.turfOptions,s=r.measurementCallback,a=(0,i.default)(e,n,o);return s&&s(a),a})),t}return n=l,(r=[{key:"_formatTooltip",value:function(t,e){var n=e||{},r=n.formatTooltip,i=n.turfOptions,o=i&&i.units||"kilometers";return r?r(t):"".concat(parseFloat(t).toFixed(2)," ").concat(o)}},{key:"handleClick",value:function(t,e){var n=e.modeConfig,r=e.data,i=e.onEdit;this._isMeasuringSessionFinished&&(this._isMeasuringSessionFinished=!1,this.resetClickSequence(),this._currentTooltips=[],this._currentDistance=0);var s=t.picks,a=(0,o.getPickedEditHandle)(s),l=!1;a||(this.addClickSequence(t),l=!0);var u=this.getClickSequence();u.length>1&&a&&Array.isArray(a.properties.positionIndexes)&&a.properties.positionIndexes[0]===u.length-1?this._isMeasuringSessionFinished=!0:l&&(u.length>1&&(this._currentDistance+=this._calculateDistanceForTooltip({positionA:u[u.length-2],positionB:u[u.length-1],modeConfig:n}),this._currentTooltips.push({position:t.mapCoords,text:this._formatTooltip(this._currentDistance,n)})),i({updatedData:r,editType:"addTentativePosition",editContext:{position:t.mapCoords}}))}},{key:"handleKeyUp",value:function(t,e){if(!this._isMeasuringSessionFinished){t.stopPropagation();var n=t.key,r=this.getClickSequence().length;switch(n){case"Escape":this._isMeasuringSessionFinished=!0,1===r&&(this.resetClickSequence(),this._currentTooltips=[]),e.onUpdateCursor("cell");break;case"Enter":this.handleClick(e.lastPointerMoveEvent,e),this._isMeasuringSessionFinished=!0}}}},{key:"getGuides",value:function(t){var e,n=t.lastPointerMoveEvent,r=this.getClickSequence(),i=n&&!this._isMeasuringSessionFinished?[n.mapCoords]:[],o={type:"FeatureCollection",features:[]};r.length>0&&o.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[].concat(a(r),i)}});var s=r.map((function(t,e){return{type:"Feature",properties:{guideType:"editHandle",editHandleType:"existing",featureIndex:-1,positionIndexes:[e]},geometry:{type:"Point",coordinates:t}}}));return(e=o.features).push.apply(e,a(s)),o}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell")}},{key:"getTooltips",value:function(t){var e=t.lastPointerMoveEvent,n=t.modeConfig,r=this.getClickSequence();if(r.length>0&&e&&!this._isMeasuringSessionFinished){var i=this._calculateDistanceForTooltip({positionA:r[r.length-1],positionB:e.mapCoords,modeConfig:t.modeConfig});return[].concat(a(this._currentTooltips),[{position:e.mapCoords,text:this._formatTooltip(this._currentDistance+i,n)}])}return this._currentTooltips}}])&&c(n.prototype,r),l}(n(6403).GeoJsonEditMode);e.MeasureDistanceMode=A},4165:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ModifyMode=void 0;var r=n(4102),i=n(2843),o=n(6403),s=n(4638);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function l(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||u(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){if(t){if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(t,e):void 0}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function g(t){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},g(t)}function m(t,e){return m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},m(t,e)}var A=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(c,t);var e,n,o,a=(e=c,function(){var t,n=g(e);if(d()){var r=g(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return f(this,t)});function c(){return h(this,c),a.apply(this,arguments)}return n=c,(o=[{key:"getGuides",value:function(t){var e,n=this,o=[],s=t.data,a=t.lastPointerMoveEvent,c=s.features,h=a&&a.picks,p=a&&a.mapCoords,f=function(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=u(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}(t.selectedIndexes);try{for(f.s();!(e=f.n()).done;){var d=e.value;if(d<c.length){var g=c[d].geometry;o.push.apply(o,l((0,i.getEditHandlesForGeometry)(g,d)))}else console.warn("selectedFeatureIndexes out of range ".concat(d))}}catch(t){f.e(t)}finally{f.f()}if(h&&h.length&&p){var m=!(0,i.getPickedExistingEditHandle)(h)&&h.find((function(t){return!t.isGuide}));if(m&&!m.object.geometry.type.includes("Point")&&t.selectedIndexes.includes(m.index)){var A=null,y=[],_=(0,r.point)(p);if((0,i.recursivelyTraverseNestedArrays)(m.object.geometry.coordinates,[],(function(e,i){var o=(0,r.lineString)(e),s=n.getNearestPoint(o,_,t.modeConfig&&t.modeConfig.viewport);(!A||s.properties.dist<A.properties.dist)&&(A=s,y=i)})),A){var v=A,b=v.geometry.coordinates,x=v.properties.index;o.push({type:"Feature",properties:{guideType:"editHandle",editHandleType:"intermediate",featureIndex:m.index,positionIndexes:[].concat(l(y),[x+1])},geometry:{type:"Point",coordinates:b}})}}}return{type:"FeatureCollection",features:o}}},{key:"getNearestPoint",value:function(t,e,n){if(t.geometry.coordinates.some((function(t){return t.length>2}))){if(n)return(0,i.nearestPointOnProjectedLine)(t,e,n);console.log("Editing 3D point but modeConfig.viewport not provided. Falling back to 2D logic.")}return(0,i.nearestPointOnLine)(t,e,n)}},{key:"handleClick",value:function(t,e){var n=(0,i.getPickedExistingEditHandle)(t.picks),r=(0,i.getPickedIntermediateEditHandle)(t.picks);if(n){var o,a=n.properties,l=a.featureIndex,u=a.positionIndexes;try{o=new s.ImmutableFeatureCollection(e.data).removePosition(l,u).getObject()}catch(t){}o&&e.onEdit({updatedData:o,editType:"removePosition",editContext:{featureIndexes:[l],positionIndexes:u,position:n.geometry.coordinates}})}else if(r){var c=r.properties,h=c.featureIndex,p=c.positionIndexes,f=new s.ImmutableFeatureCollection(e.data).addPosition(h,p,r.geometry.coordinates).getObject();f&&e.onEdit({updatedData:f,editType:"addPosition",editContext:{featureIndexes:[h],positionIndexes:p,position:r.geometry.coordinates}})}}},{key:"handleDragging",value:function(t,e){var n=(0,i.getPickedEditHandle)(t.pointerDownPicks);if(n){t.cancelPan();var r=n.properties,o=new s.ImmutableFeatureCollection(e.data).replacePosition(r.featureIndex,r.positionIndexes,t.mapCoords).getObject();e.onEdit({updatedData:o,editType:"movePosition",editContext:{featureIndexes:[r.featureIndex],positionIndexes:r.positionIndexes,position:t.mapCoords}})}}},{key:"handlePointerMove",value:function(t,e){var n=this.getCursor(t);e.onUpdateCursor(n)}},{key:"handleStartDragging",value:function(t,e){var n=e.selectedIndexes,r=(0,i.getPickedIntermediateEditHandle)(t.picks);if(n.length&&r){var o=r.properties,a=new s.ImmutableFeatureCollection(e.data).addPosition(o.featureIndex,o.positionIndexes,t.mapCoords).getObject();e.onEdit({updatedData:a,editType:"addPosition",editContext:{featureIndexes:[o.featureIndex],positionIndexes:o.positionIndexes,position:t.mapCoords}})}}},{key:"handleStopDragging",value:function(t,e){var n=e.selectedIndexes,r=(0,i.getPickedEditHandle)(t.picks);if(n.length&&r){var o=r.properties,a=new s.ImmutableFeatureCollection(e.data).replacePosition(o.featureIndex,o.positionIndexes,t.mapCoords).getObject();e.onEdit({updatedData:a,editType:"finishMovePosition",editContext:{featureIndexes:[o.featureIndex],positionIndexes:o.positionIndexes,position:t.mapCoords}})}}},{key:"getCursor",value:function(t){var e=t&&t.picks||[];return(0,i.getPickedEditHandles)(e).length?"cell":null}}])&&p(n.prototype,o),c}(o.GeoJsonEditMode);e.ModifyMode=A},4907:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ResizeCircleMode=void 0;var r=h(n(3807)),i=n(4102),o=h(n(265)),s=h(n(1013)),a=h(n(8230)),l=n(2843),u=n(6403),c=n(4638);function h(t){return t&&t.__esModule?t:{default:t}}function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function m(t,e){return!e||"object"!==p(e)&&"function"!=typeof e?A(t):e}function A(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function y(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function _(t){return _=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},_(t)}function v(t,e){return v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},v(t,e)}function b(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var x=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(p,t);var e,n,u,h=(e=p,function(){var t,n=_(e);if(y()){var r=_(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return m(this,t)});function p(){var t;d(this,p);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return b(A(t=h.call.apply(h,[this].concat(n))),"_selectedEditHandle",void 0),b(A(t),"_isResizing",!1),t}return n=p,(u=[{key:"getGuides",value:function(t){var e,n=this,r=[],o=t.selectedIndexes,s=t.lastPointerMoveEvent,a=s&&s.picks,u=s&&s.mapCoords;if(a&&a.length&&u&&1===o.length&&!this._isResizing){var c=a.find((function(t){return!t.isGuide}));if(c&&c.object.properties.shape&&c.object.properties.shape.includes("Circle")&&t.selectedIndexes.includes(c.index)){var h=null,p=[],d=(0,i.point)(u);if((0,l.recursivelyTraverseNestedArrays)(c.object.geometry.coordinates,[],(function(e,r){var o=(0,i.lineString)(e),s=n.getNearestPoint(o,d,t.modeConfig&&t.modeConfig.viewport);(!h||s.properties.dist<h.properties.dist)&&(h=s,p=r)})),h){var g=h,m=g.geometry.coordinates,A=g.properties.index;r.push({type:"Feature",properties:{guideType:"editHandle",editHandleType:"intermediate",featureIndex:c.index,positionIndexes:[].concat((e=p,function(t){if(Array.isArray(t))return f(t)}(e)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(e)||function(t,e){if(t){if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[A+1])},geometry:{type:"Point",coordinates:m}})}}}return{type:"FeatureCollection",features:r}}},{key:"getNearestPoint",value:function(t,e,n){if(t.geometry.coordinates.some((function(t){return t.length>2}))){if(n)return(0,l.nearestPointOnProjectedLine)(t,e,n);console.log("Editing 3D point but modeConfig.viewport not provided. Falling back to 2D logic.")}return(0,r.default)(t,e)}},{key:"handleDragging",value:function(t,e){var n=(0,l.getPickedEditHandle)(t.pointerDownPicks);if(n){t.cancelPan();var r=n.properties,i=this.getSelectedFeature(e),u=(0,a.default)(i).geometry.coordinates,h=Object.entries(i.geometry.coordinates[0]).length-1,p=Math.max((0,s.default)(u,t.mapCoords),.001),f={}.steps,d={steps:void 0===f?h:f},g=(0,o.default)(u,p,d).geometry,m=new c.ImmutableFeatureCollection(e.data).replaceGeometry(r.featureIndex,g).getObject();e.onEdit({updatedData:m,editType:"unionGeometry",editContext:{featureIndexes:[r.featureIndex]}})}}},{key:"handlePointerMove",value:function(t,e){if(!this._isResizing){var n=(0,l.getPickedEditHandle)(t.picks);this._selectedEditHandle=n&&"intermediate"===n.properties.editHandleType?n:null}var r=this.getCursor(t);e.onUpdateCursor(r)}},{key:"handleStartDragging",value:function(t,e){this._selectedEditHandle&&(this._isResizing=!0)}},{key:"handleStopDragging",value:function(t,e){this._isResizing&&(this._selectedEditHandle=null,this._isResizing=!1)}},{key:"getCursor",value:function(t){var e=t&&t.picks||[];return(0,l.getPickedEditHandles)(e).length?"cell":null}}])&&g(n.prototype,u),p}(u.GeoJsonEditMode);e.ResizeCircleMode=x},7572:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RotateMode=void 0;var r=m(n(9705)),i=m(n(6338)),o=m(n(1208)),s=m(n(3652)),a=m(n(1013)),l=n(1540),u=n(611),c=n(4102),h=m(n(7460)),p=m(n(7383)),f=n(2843),d=n(6403),g=n(4638);function m(t){return t&&t.__esModule?t:{default:t}}function A(t){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A(t)}function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function v(t,e){return!e||"object"!==A(e)&&"function"!=typeof e?b(t):e}function b(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function x(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function w(t){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},w(t)}function E(t,e){return E=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},E(t,e)}function S(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var T=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&E(t,e)}(T,t);var e,n,m,A=(e=T,function(){var t,n=w(e);if(x()){var r=w(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return v(this,t)});function T(){var t;y(this,T);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return S(b(t=A.call.apply(A,[this].concat(n))),"_selectedEditHandle",void 0),S(b(t),"_geometryBeingRotated",void 0),S(b(t),"_isRotating",!1),S(b(t),"_isSinglePointGeometrySelected",(function(t){var e=(t||{}).features;return!(!Array.isArray(e)||1!==e.length)&&"Point"===(0,u.getGeom)(e[0]).type})),S(b(t),"getIsRotating",(function(){return t._isRotating})),t}return n=T,(m=[{key:"getGuides",value:function(t){var e=this._geometryBeingRotated||this.getSelectedFeaturesAsFeatureCollection(t);if(this._isSinglePointGeometrySelected(e))return{type:"FeatureCollection",features:[]};if(this._isRotating)return(0,c.featureCollection)([(0,i.default)(e)]);var n=(0,s.default)((0,r.default)(e)),o=null,u=null,h=0;(0,l.coordEach)(n,(function(t){if(o){var e=(0,d.getIntermediatePosition)(t,o);(!u||e[1]>u[1])&&(u=e);var n=(0,a.default)(t,o);h=Math.max(h,n)}o=t}));var f=u&&[u[0],u[1]+h/1e3],g=(0,c.lineString)([u,f]),m=(0,c.point)(f,{guideType:"editHandle",editHandleType:"rotate"});return(0,c.featureCollection)([(0,p.default)(n),m,g])}},{key:"handleDragging",value:function(t,e){if(this._isRotating){var n=this.getRotateAction(t.pointerDownMapCoords,t.mapCoords,"rotating",e);n&&e.onEdit(n),t.cancelPan()}}},{key:"handlePointerMove",value:function(t,e){if(!this._isRotating){var n=(0,f.getPickedEditHandle)(t.picks);this._selectedEditHandle=n&&"rotate"===n.properties.editHandleType?n:null}this.updateCursor(e)}},{key:"handleStartDragging",value:function(t,e){this._selectedEditHandle&&(this._isRotating=!0,this._geometryBeingRotated=this.getSelectedFeaturesAsFeatureCollection(e))}},{key:"handleStopDragging",value:function(t,e){if(this._isRotating){var n=this.getRotateAction(t.pointerDownMapCoords,t.mapCoords,"rotated",e);n&&e.onEdit(n),this._geometryBeingRotated=null,this._selectedEditHandle=null,this._isRotating=!1}}},{key:"updateCursor",value:function(t){this._selectedEditHandle?t.onUpdateCursor("crosshair"):t.onUpdateCursor(null)}},{key:"getRotateAction",value:function(t,e,n,r){if(!this._geometryBeingRotated)return null;for(var s=(0,i.default)(this._geometryBeingRotated),a=function(t,e,n){var r=(0,o.default)(t,e);return(0,o.default)(t,n)-r}(s,t,e),l=(0,h.default)(this._geometryBeingRotated,a,{pivot:s}),u=new g.ImmutableFeatureCollection(r.data),c=r.selectedIndexes,p=0;p<c.length;p++){var f=c[p],d=l.features[p];u=u.replaceGeometry(f,d.geometry)}return{updatedData:u.getObject(),editType:n,editContext:{featureIndexes:c}}}}])&&_(n.prototype,m),T}(d.GeoJsonEditMode);e.RotateMode=T},1864:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ScaleMode=void 0;var r=m(n(9705)),i=m(n(6338)),o=m(n(1208)),s=m(n(3652)),a=n(4102),l=m(n(7383)),u=n(1540),c=m(n(1013)),h=m(n(7517)),p=n(611),f=n(2843),d=n(6403),g=n(4638);function m(t){return t&&t.__esModule?t:{default:t}}function A(t){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A(t)}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function b(t,e){return!e||"object"!==A(e)&&"function"!=typeof e?x(t):e}function x(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function w(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function E(t){return E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},E(t)}function S(t,e){return S=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},S(t,e)}function T(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var P=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&S(t,e)}(m,t);var e,n,c,d=(e=m,function(){var t,n=E(e);if(w()){var r=E(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return b(this,t)});function m(){var t;_(this,m);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return T(x(t=d.call.apply(d,[this].concat(n))),"_geometryBeingScaled",void 0),T(x(t),"_selectedEditHandle",void 0),T(x(t),"_cornerGuidePoints",void 0),T(x(t),"_cursor",void 0),T(x(t),"_isScaling",!1),T(x(t),"_isSinglePointGeometrySelected",(function(t){var e=(t||{}).features;return!(!Array.isArray(e)||1!==e.length)&&"Point"===(0,p.getGeom)(e[0]).type})),T(x(t),"_getOppositeScaleHandle",(function(e){var n=e&&e.properties&&Array.isArray(e.properties.positionIndexes)&&e.properties.positionIndexes[0];if("number"!=typeof n)return null;var r=t._cornerGuidePoints.length,i=(n+r/2)%r;return t._cornerGuidePoints.find((function(t){return!!Array.isArray(t.properties.positionIndexes)&&t.properties.positionIndexes[0]===i}))})),T(x(t),"_getUpdatedData",(function(t,e){for(var n=new g.ImmutableFeatureCollection(t.data),r=t.selectedIndexes,i=0;i<r.length;i++){var o=r[i],s=e.features[i];n=n.replaceGeometry(o,s.geometry)}return n.getObject()})),T(x(t),"isEditHandleSelected",(function(){return Boolean(t._selectedEditHandle)})),T(x(t),"getScaleAction",(function(e,n,r,i){if(!t._selectedEditHandle)return null;var o=t._getOppositeScaleHandle(t._selectedEditHandle),s=(0,p.getCoord)(o),a=M(s,e,n),l=(0,h.default)(t._geometryBeingScaled,a,{origin:s});return{updatedData:t._getUpdatedData(i,l),editType:r,editContext:{featureIndexes:i.selectedIndexes}}})),T(x(t),"updateCursor",(function(e){if(t._selectedEditHandle){t._cursor&&e.onUpdateCursor(t._cursor);var n=t.getSelectedFeaturesAsFeatureCollection(e),r=(0,i.default)(n),s=(0,o.default)(r,t._selectedEditHandle),a=s<0?s+180:s;a>=0&&a<=90||a>=180&&a<=270?(t._cursor="nesw-resize",e.onUpdateCursor("nesw-resize")):(t._cursor="nwse-resize",e.onUpdateCursor("nwse-resize"))}else e.onUpdateCursor(null),t._cursor=null})),t}return n=m,(c=[{key:"handlePointerMove",value:function(t,e){if(!this._isScaling){var n=(0,f.getPickedEditHandle)(t.picks);this._selectedEditHandle=n&&"scale"===n.properties.editHandleType?n:null,n&&this.updateCursor(e)}}},{key:"handleStartDragging",value:function(t,e){this._selectedEditHandle&&(this._isScaling=!0,this._geometryBeingScaled=this.getSelectedFeaturesAsFeatureCollection(e))}},{key:"handleDragging",value:function(t,e){if(this._isScaling){e.onUpdateCursor(this._cursor);var n=this.getScaleAction(t.pointerDownMapCoords,t.mapCoords,"scaling",e);n&&e.onEdit(n),t.cancelPan()}}},{key:"handleStopDragging",value:function(t,e){if(this._isScaling){var n=this.getScaleAction(t.pointerDownMapCoords,t.mapCoords,"scaled",e);n&&e.onEdit(n),e.onUpdateCursor(null),this._geometryBeingScaled=null,this._selectedEditHandle=null,this._cursor=null,this._isScaling=!1}}},{key:"getGuides",value:function(t){this._cornerGuidePoints=[];var e=this.getSelectedFeaturesAsFeatureCollection(t);if(this._isSinglePointGeometrySelected(e))return{type:"FeatureCollection",features:[]};var n=(0,s.default)((0,r.default)(e));n.properties.mode="scale";var i,o=[];return(0,u.coordEach)(n,(function(t,e){if(e<4){var n=(0,a.point)(t,{guideType:"editHandle",editHandleType:"scale",positionIndexes:[e]});o.push(n)}})),this._cornerGuidePoints=o,(0,a.featureCollection)([(0,l.default)(n)].concat(function(t){if(Array.isArray(t))return y(t)}(i=this._cornerGuidePoints)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(i)||function(t,e){if(t){if("string"==typeof t)return y(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(t,e):void 0}}(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))}}])&&v(n.prototype,c),m}(d.GeoJsonEditMode);function M(t,e,n){var r=(0,c.default)(t,e);return(0,c.default)(t,n)/r}e.ScaleMode=P},9658:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SnappableMode=void 0;var r=n(2843);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function o(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||s(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){if(t){if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?h(t):e}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function d(t,e){return d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},d(t,e)}function g(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(m,t);var e,n,i,a=(e=m,function(){var t,n=f(e);if(p()){var r=f(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return c(this,t)});function m(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,m),g(h(e=a.call(this)),"_handler",void 0),e._handler=t,e}return n=m,i=[{key:"_getSnappedMouseEvent",value:function(t,e,n){return Object.assign(t,{mapCoords:n.geometry.coordinates,pointerDownMapCoords:e&&e.geometry.coordinates})}},{key:"_getPickedSnapTarget",value:function(t){return(0,r.getPickedEditHandles)(t).find((function(t){return"snap-target"===t.properties.editHandleType}))}},{key:"_getPickedSnapSource",value:function(t){return(0,r.getPickedSnapSourceEditHandle)(t)}},{key:"_getUpdatedSnapSourceHandle",value:function(t,e){var n=t.properties,r=n.featureIndex,i=n.positionIndexes;if(!Array.isArray(i))return t;var o=e.features[r];return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){g(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},t,{geometry:{type:"Point",coordinates:i.reduce((function(t,e){return t[e]}),o.geometry.coordinates)}})}},{key:"_getSnapTargets",value:function(t){var e=(t.modeConfig||{}).additionalSnapTargets;return e=e||[],[].concat(o(t.data.features),o(e))}},{key:"_getSnapTargetHandles",value:function(t){for(var e=[],n=this._getSnapTargets(t),i=0;i<n.length;i++)if(!t.selectedIndexes.includes(i)){var s=n[i].geometry;e.push.apply(e,o((0,r.getEditHandlesForGeometry)(s,i,"snap-target")))}return e}},{key:"getGuides",value:function(t){var e=t.modeConfig,n=t.lastPointerMoveEvent,i=(e||{}).enableSnapping,a={type:"FeatureCollection",features:o(this._handler.getGuides(t).features)};if(!i)return a;var l,u=n&&this._getPickedSnapSource(n.pointerDownPicks);if(u)return(l=a.features).push.apply(l,o(this._getSnapTargetHandles(t)).concat([this._getUpdatedSnapSourceHandle(u,t.data)])),a;var c,h=t.data.features,p=function(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=s(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){a=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}(t.selectedIndexes);try{for(p.s();!(c=p.n()).done;){var f=c.value;if(f<h.length){var d,g=h[f].geometry;(d=a.features).push.apply(d,o((0,r.getEditHandlesForGeometry)(g,f,"snap-source")))}}}catch(t){p.e(t)}finally{p.f()}return a}},{key:"_getSnapAwareEvent",value:function(t,e){var n=this._getPickedSnapSource(e.lastPointerMoveEvent.pointerDownPicks),r=this._getPickedSnapTarget(t.picks);return n&&r?this._getSnappedMouseEvent(t,n,r):t}},{key:"handleStartDragging",value:function(t,e){this._handler.handleStartDragging(t,e)}},{key:"handleStopDragging",value:function(t,e){this._handler.handleStopDragging(this._getSnapAwareEvent(t,e),e)}},{key:"handleDragging",value:function(t,e){this._handler.handleDragging(this._getSnapAwareEvent(t,e),e)}},{key:"handlePointerMove",value:function(t,e){this._handler.handlePointerMove(this._getSnapAwareEvent(t,e),e)}}],i&&u(n.prototype,i),m}(n(6403).GeoJsonEditMode);e.SnappableMode=m},5367:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SplitPolygonMode=void 0;var r=m(n(8147)),i=m(n(8727)),o=m(n(5950)),s=m(n(3663)),a=n(4102),l=m(n(1208)),u=m(n(1013)),c=m(n(3737)),h=m(n(7383)),p=m(n(3807)),f=n(2843),d=n(6403),g=n(4638);function m(t){return t&&t.__esModule?t:{default:t}}function A(t){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A(t)}function y(t,e){if(t){if("string"==typeof t)return _(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(t,e):void 0}}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function x(t,e){return!e||"object"!==A(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function w(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function E(t){return E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},E(t)}function S(t,e){return S=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},S(t,e)}var T=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&S(t,e)}(A,t);var e,n,d,m=(e=A,function(){var t,n=E(e);if(w()){var r=E(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return x(this,t)});function A(){return v(this,A),m.apply(this,arguments)}return n=A,(d=[{key:"calculateMapCoords",value:function(t,e,n){var r=n.modeConfig;if(!r||!r.lock90Degree||!t.length)return e;if(1===t.length){var i=t[0],o=this.getSelectedGeometry(n),s=(0,h.default)(o),d="FeatureCollection"===s.type?s.features:[s],g=Number.MAX_SAFE_INTEGER,m=null;if(d.forEach((function(t){var e=(0,p.default)(t,i),n=(0,u.default)(e,i);g>n&&(g=n,m=e)})),m){var A=(0,l.default)(i,m),_=(0,u.default)(i,e,{units:"meters"});return(0,c.default)(i,_,A,{units:"meters"}).geometry.coordinates}return e}var v,b,x=t[t.length-1],w=(v=(0,f.generatePointsParallelToLinePoints)(t[t.length-2],x,e),b=1,function(t){if(Array.isArray(t))return t}(v)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(v,b)||y(v,b)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];return(0,p.default)((0,a.lineString)([x,w]),e).geometry.coordinates}},{key:"getGuides",value:function(t){var e=this.getClickSequence(),n={type:"FeatureCollection",features:[]};if(0===e.length||!t.lastPointerMoveEvent)return n;var r,i=t.lastPointerMoveEvent.mapCoords;return n.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[].concat((r=e,function(t){if(Array.isArray(t))return _(t)}(r)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(r)||y(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[this.calculateMapCoords(e,i,t)])}}),n}},{key:"handleClick",value:function(t,e){var n=this.getTentativeGuide(e),i=this.getSelectedGeometry(e);if(i){var o=this.getClickSequence();n&&"LineString"===n.geometry.type?o.push(n.geometry.coordinates[n.geometry.coordinates.length-1]):this.addClickSequence(t);var a={type:"Point",coordinates:o[o.length-1]},l=(0,r.default)(a,i);if(o.length>1&&n&&!l){if(this.resetClickSequence(),0===(0,s.default)(n,i).features.length)return;var u=this.splitPolygon(n,e);u&&e.onEdit(u)}}else console.warn("A polygon must be selected for splitting")}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell")}},{key:"splitPolygon",value:function(t,e){var n=this.getSelectedGeometry(e),r=e.selectedIndexes[0],s=e.modeConfig||{},a=s.gap,l=void 0===a?.1:a,u=s.units,c=void 0===u?"centimeters":u;0===l&&(l=.1,c="centimeters");var h=(0,o.default)(t,l,{units:c}),p=(0,i.default)(n,h);if(!p)return console.warn("Canceling edit. Split Polygon erased"),null;var f,d=p.geometry,m=d.type,A=d.coordinates;return f="Polygon"===m?A.map((function(t){return[t]})):A.reduce((function(t,e){return e.forEach((function(e){t.push([e])})),t}),[]),{updatedData:new g.ImmutableFeatureCollection(e.data).replaceGeometry(r,{type:"MultiPolygon",coordinates:f}).getObject(),editType:"split",editContext:{featureIndexes:[r]}}}}])&&b(n.prototype,d),A}(d.GeoJsonEditMode);e.SplitPolygonMode=T},2266:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e,n){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}},s(t,e,n||t)}function a(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function c(t,e){return c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},c(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.ThreeClickPolygonMode=void 0;var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(p,t);var e,n,r,h=(e=p,function(){var t,n=u(e);if(l()){var r=u(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return a(this,t)});function p(){return i(this,p),h.apply(this,arguments)}return n=p,(r=[{key:"handleClick",value:function(t,e){this.addClickSequence(t);var n=this.getClickSequence(),r=this.getTentativeGuide(e);if(n.length>2&&r&&"Polygon"===r.geometry.type){var i=this.getAddFeatureOrBooleanPolygonAction(r.geometry,e);this.resetClickSequence(),i&&e.onEdit(i)}}},{key:"getGuides",value:function(t){var e=t.lastPointerMoveEvent,n=t.modeConfig,r=this.getClickSequence(),i={type:"FeatureCollection",features:[]};if(0===r.length)return i;var o=e.mapCoords;if(1===r.length)i.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[r[0],o]}});else{var s=this.getThreeClickPolygon(r[0],r[1],o,n);s&&i.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:s.geometry})}return i}},{key:"getThreeClickPolygon",value:function(t,e,n,r){return null}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell"),s(u(p.prototype),"handlePointerMove",this).call(this,t,e)}},{key:"createTentativeFeature",value:function(t){var e,n=t.lastPointerMoveEvent,r=this.getClickSequence(),i=n?[n.mapCoords]:[];return 2===r.length&&(e=this.getThreeClickPolygon(r[0],r[1],i[0],t.modeConfig)),e}}])&&o(n.prototype,r),p}(n(6403).GeoJsonEditMode);e.ThreeClickPolygonMode=h},1601:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TransformMode=void 0;var r=n(4102),i=n(2636),o=n(1864),s=n(7572);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,n){return h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}},h(t,e,n||t)}function p(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function g(t,e){return g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},g(t,e)}var m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}(A,t);var e,n,a,m=(e=A,function(){var t,n=d(e);if(f()){var r=d(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return p(this,t)});function A(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,A),m.call(this,[new i.TranslateMode,new o.ScaleMode,new s.RotateMode])}return n=A,a=[{key:"handlePointerMove",value:function(t,e){var n=null;h(d(A.prototype),"handlePointerMove",this).call(this,t,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},e,{onUpdateCursor:function(t){n=t||n}})),e.onUpdateCursor(n)}},{key:"handleStartDragging",value:function(t,e){var n=null,r=null,s=[];this._modes.forEach((function(t){t instanceof i.TranslateMode?r=t:(t instanceof o.ScaleMode&&(n=t),s.push(t))})),n instanceof o.ScaleMode&&!n.isEditHandleSelected()&&s.push(r),s.filter(Boolean).forEach((function(n){return n.handleStartDragging(t,e)}))}},{key:"getGuides",value:function(t){var e=h(d(A.prototype),"getGuides",this).call(this,t),n=(this._modes||[]).find((function(t){return t instanceof s.RotateMode}));if(n instanceof s.RotateMode){var i=e.features.filter((function(t){var e=t.properties||{},r=e.editHandleType,i=[e.mode];return n.getIsRotating()&&i.push(r),!i.includes("scale")}));e=(0,r.featureCollection)(i)}return e}}],a&&c(n.prototype,a),A}(n(1807).CompositeMode);e.TransformMode=m},2636:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TranslateMode=void 0;var r=u(n(1208)),i=u(n(1013)),o=u(n(2418)),s=n(4102),a=n(6403),l=n(4638);function u(t){return t&&t.__esModule?t:{default:t}}function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e){return!e||"object"!==c(e)&&"function"!=typeof e?d(t):e}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function m(t){return m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},m(t)}function A(t,e){return A=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},A(t,e)}function y(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var _=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&A(t,e)}(c,t);var e,n,a,u=(e=c,function(){var t,n=m(e);if(g()){var r=m(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return f(this,t)});function c(){var t;h(this,c);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return y(d(t=u.call.apply(u,[this].concat(n))),"_geometryBeforeTranslate",void 0),y(d(t),"_isTranslatable",void 0),t}return n=c,(a=[{key:"handleDragging",value:function(t,e){if(this._isTranslatable){if(this._geometryBeforeTranslate){var n=this.getTranslateAction(t.pointerDownMapCoords,t.mapCoords,"translating",e);n&&e.onEdit(n)}t.cancelPan()}}},{key:"handlePointerMove",value:function(t,e){this._isTranslatable=this.isSelectionPicked(t.pointerDownPicks||t.picks,e),this.updateCursor(e)}},{key:"handleStartDragging",value:function(t,e){this._isTranslatable&&(this._geometryBeforeTranslate=this.getSelectedFeaturesAsFeatureCollection(e))}},{key:"handleStopDragging",value:function(t,e){if(this._geometryBeforeTranslate){var n=this.getTranslateAction(t.pointerDownMapCoords,t.mapCoords,"translated",e);n&&e.onEdit(n),this._geometryBeforeTranslate=null}}},{key:"updateCursor",value:function(t){this._isTranslatable?t.onUpdateCursor("move"):t.onUpdateCursor(null)}},{key:"getTranslateAction",value:function(t,e,n,a){if(!this._geometryBeforeTranslate)return null;for(var u=(0,s.point)(t),c=(0,s.point)(e),h=(0,i.default)(u,c),p=(0,r.default)(u,c),f=(0,o.default)(this._geometryBeforeTranslate,h,p),d=new l.ImmutableFeatureCollection(a.data),g=a.selectedIndexes,m=0;m<g.length;m++){var A=g[m],y=f.features[m];d=d.replaceGeometry(A,y.geometry)}return{updatedData:d.getObject(),editType:n,editContext:{featureIndexes:g}}}}])&&p(n.prototype,a),c}(a.GeoJsonEditMode);e.TranslateMode=_},3804:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e,n){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}},s(t,e,n||t)}function a(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function c(t,e){return c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},c(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.TwoClickPolygonMode=void 0;var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(p,t);var e,n,r,h=(e=p,function(){var t,n=u(e);if(l()){var r=u(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return a(this,t)});function p(){return i(this,p),h.apply(this,arguments)}return n=p,(r=[{key:"handleClick",value:function(t,e){e.modeConfig&&e.modeConfig.dragToDraw||(this.addClickSequence(t),this.checkAndFinishPolygon(e))}},{key:"handleStartDragging",value:function(t,e){e.modeConfig&&e.modeConfig.dragToDraw&&(this.addClickSequence(t),t.cancelPan())}},{key:"handleStopDragging",value:function(t,e){e.modeConfig&&e.modeConfig.dragToDraw&&(this.addClickSequence(t),this.checkAndFinishPolygon(e))}},{key:"checkAndFinishPolygon",value:function(t){var e=this.getClickSequence(),n=this.getTentativeGuide(t);if(e.length>1&&n&&"Polygon"===n.geometry.type){var r={type:"Feature",properties:{shape:n.properties.shape},geometry:{type:"Polygon",coordinates:n.geometry.coordinates}},i=this.getAddFeatureOrBooleanPolygonAction(r,t);this.resetClickSequence(),i&&t.onEdit(i)}}},{key:"getGuides",value:function(t){var e=t.lastPointerMoveEvent,n=t.modeConfig,r=this.getClickSequence(),i={type:"FeatureCollection",features:[]};if(0===r.length)return i;var o=r[0],s=e.mapCoords,a=this.getTwoClickPolygon(o,s,n);return a&&i.features.push({type:"Feature",properties:{shape:a.properties&&a.properties.shape,guideType:"tentative"},geometry:a.geometry}),i}},{key:"getTwoClickPolygon",value:function(t,e,n){return null}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell"),s(u(p.prototype),"handlePointerMove",this).call(this,t,e)}},{key:"createTentativeFeature",value:function(t){var e,n=t.lastPointerMoveEvent,r=this.getClickSequence(),i=n?[n.mapCoords]:[];return 1===r.length&&(e=this.getTwoClickPolygon(r[0],i[0],t.modeConfig)),e}}])&&o(n.prototype,r),p}(n(6403).GeoJsonEditMode);e.TwoClickPolygonMode=h},3105:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}function l(t,e){return l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},l(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.ViewMode=void 0;var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(r,t);var e,n=(e=r,function(){var t,n=a(e);if(s()){var r=a(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return o(this,t)});function r(){return i(this,r),n.apply(this,arguments)}return r}(n(6403).GeoJsonEditMode);e.ViewMode=u},6499:(t,e)=>{"use strict";function n(t,e){if(t===e)return!0;if(Array.isArray(t)){var n=t.length;if(!e||e.length!==n)return!1;for(var r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e,r={};return function(i){for(var o in i)if(!n(i[o],r[o])){e=t(i),r=i;break}return e}}},2843:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toDeckColor=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[255,0,0,255];return Array.isArray(t)?[255*t[0],255*t[1],255*t[2],255*t[3]]:e},e.recursivelyTraverseNestedArrays=function t(e,n,r){if(!Array.isArray(e[0]))return!0;for(var i=0;i<e.length;i++)if(t(e[i],[].concat(p(n),[i]),r)){r(e,n);break}return!1},e.generatePointsParallelToLinePoints=function(t,e,n){var s={type:"LineString",coordinates:[t,e]},l=(0,a.point)(n),u=(0,o.default)(l,s),c=(0,i.default)(t,e),h=(n[0]-t[0])*(e[1]-t[1])-(n[1]-t[1])*(e[0]-t[0])<0?c-90:c-270,p=(0,r.default)(e,u,h),f=(0,r.default)(t,u,h);return[p.geometry.coordinates,f.geometry.coordinates]},e.distance2d=g,e.mix=m,e.nearestPointOnProjectedLine=function(t,e,n){var r=new u.default(n),i=t.geometry.coordinates.map((function(t){var e=h(t,3),n=e[0],i=e[1],o=e[2],s=void 0===o?0:o;return r.project([n,i,s])})),o=h(r.project(e.geometry.coordinates),2),s=o[0],a=o[1],l=1/0,c={};i.forEach((function(t,e){var n=h(t,2),r=n[0],o=n[1];if(0!==e){var u=h(i[e-1],2),p=u[0],f=u[1],d=f-o,g=r-p,m=p*o-r*f,A=d*d+g*g,y=Math.abs(d*s+g*a+m)/Math.sqrt(A);y<l&&(l=y,c={index:e,x0:(g*(g*s-d*a)-d*m)/A,y0:(d*(-g*s+d*a)-g*m)/A})}}));var p=c,f=p.index,d=p.x0,A=p.y0,y=h(i[f-1],3),_=y[0],v=y[1],b=y[2],x=void 0===b?0:b,w=h(i[f],3),E=w[0],S=w[1],T=w[2],P=void 0===T?0:T,M=g(_,v,E,S),C=m(x,P,g(_,v,d,A)/M);return{type:"Feature",geometry:{type:"Point",coordinates:r.unproject([d,A,C])},properties:{dist:l,index:f-1}}},e.nearestPointOnLine=function(t,e,n){var r,i,o;n&&(o=new u.default(n));var c=(0,a.point)([1/0,1/0],{dist:1/0});return!(null===(r=t.geometry)||void 0===r?void 0:r.coordinates.length)||(null===(i=t.geometry)||void 0===i?void 0:i.coordinates.length)<2||(0,s.flattenEach)(t,(function(t){var n,r,i,s,u,h,p,f=(0,l.getCoords)(t),d=(0,l.getCoords)(e);if(f.length>1&&d.length){var g,m;o?(g=f.map((function(t){return o.project(t)})),m=o.project(d)):(g=f,m=d);for(var A=1;A<g.length;A++){if(g[A][0]!==g[A-1][0]){var y=(g[A][1]-g[A-1][1])/(g[A][0]-g[A-1][0]),_=g[A][1]-y*g[A][0];p=Math.abs(y*m[0]+_-m[1])/Math.sqrt(y*y+1)}else p=Math.abs(m[0]-g[A][0]);var v=Math.pow(g[A][1]-g[A-1][1],2)+Math.pow(g[A][0]-g[A-1][0],2),b=Math.pow(g[A][1]-m[1],2)+Math.pow(g[A][0]-m[0],2),x=Math.pow(g[A-1][1]-m[1],2)+Math.pow(g[A-1][0]-m[0],2),w=Math.pow(p,2),E=b-w+x-w;E>v&&(p=Math.sqrt(Math.min(b,x))),(null==n||n>p)&&(E>v?x<b?(r=0,i=1):(i=0,r=1):(r=Math.sqrt(x-w)/Math.sqrt(v),i=Math.sqrt(b-w)/Math.sqrt(v)),n=p,h=A)}var S=g[h-1][0]-g[h][0],T=g[h-1][1]-g[h][1];s=g[h-1][0]-S*r,u=g[h-1][1]-T*r}var P={x:s,y:u,idx:h-1,to:r,from:i};if(o){var M=o.unproject([P.x,P.y]);P={x:M[0],y:M[1],idx:h-1,to:r,from:i}}c=(0,a.point)([P.x,P.y],{dist:Math.abs(P.from-P.to),index:P.idx})})),c},e.getPickedEditHandle=function(t){var e=A(t);return e.length?e[0]:null},e.getPickedSnapSourceEditHandle=function(t){return A(t).find((function(t){return"snap-source"===t.properties.editHandleType}))},e.getNonGuidePicks=function(t){return t&&t.filter((function(t){return!t.isGuide}))},e.getPickedExistingEditHandle=function(t){return A(t).find((function(t){var e=t.properties;return e.featureIndex>=0&&"existing"===e.editHandleType}))},e.getPickedIntermediateEditHandle=function(t){return A(t).find((function(t){var e=t.properties;return e.featureIndex>=0&&"intermediate"===e.editHandleType}))},e.getPickedEditHandles=A,e.getEditHandlesForGeometry=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"existing",r=[];switch(t.type){case"Point":r=[{type:"Feature",properties:{guideType:"editHandle",editHandleType:n,positionIndexes:[],featureIndex:e},geometry:{type:"Point",coordinates:t.coordinates}}];break;case"MultiPoint":case"LineString":r=r.concat(y(t.coordinates,[],e,n));break;case"Polygon":case"MultiLineString":for(var i=0;i<t.coordinates.length;i++)r=r.concat(y(t.coordinates[i],[i],e,n)),"Polygon"===t.type&&(r=r.slice(0,-1));break;case"MultiPolygon":for(var o=0;o<t.coordinates.length;o++)for(var s=0;s<t.coordinates[o].length;s++)r=(r=r.concat(y(t.coordinates[o][s],[o,s],e,n))).slice(0,-1);break;default:throw Error("Unhandled geometry type: ".concat(t.type))}return r};var r=c(n(3737)),i=c(n(1208)),o=c(n(3892)),s=n(1540),a=n(4102),l=n(611),u=c(n(4235));function c(t){return t&&t.__esModule?t:{default:t}}function h(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(t,e)||f(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t){return function(t){if(Array.isArray(t))return d(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||f(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){if(t){if("string"==typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(t,e):void 0}}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function g(t,e,n,r){var i=t-n,o=e-r;return Math.sqrt(i*i+o*o)}function m(t,e,n){return e*n+t*(1-n)}function A(t){return t&&t.filter((function(t){return t.isGuide&&"editHandle"===t.object.properties.guideType})).map((function(t){return t.object}))||[]}function y(t,e,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"existing",i=[],o=0;o<t.length;o++){var s=t[o];i.push({type:"Feature",properties:{guideType:"editHandle",positionIndexes:[].concat(p(e),[o]),featureIndex:n,editHandleType:r},geometry:{type:"Point",coordinates:s}})}return i}},6914:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"ArrowStyles",{enumerable:!0,get:function(){return r.ArrowStyles}}),Object.defineProperty(e,"DEFAULT_ARROWS",{enumerable:!0,get:function(){return r.DEFAULT_ARROWS}}),Object.defineProperty(e,"MAX_ARROWS",{enumerable:!0,get:function(){return r.MAX_ARROWS}}),Object.defineProperty(e,"EditableGeoJsonLayer",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"EditableH3ClusterLayer",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"SelectionLayer",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"ElevatedEditHandleLayer",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"PathOutlineLayer",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(e,"PathMarkerLayer",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(e,"JunctionScatterplotLayer",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(e,"toDeckColor",{enumerable:!0,get:function(){return h.toDeckColor}});var r=n(462),i=p(n(5085)),o=p(n(9132)),s=p(n(7541)),a=p(n(357)),l=p(n(2954)),u=p(n(5213)),c=p(n(6755)),h=n(7484);function p(t){return t&&t.__esModule?t:{default:t}}},5085:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=n(9119),o=n(9199),s=(r=n(3049))&&r.__esModule?r:{default:r};function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e,n){return c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}},c(t,e,n||t)}function h(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function d(t,e){return d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},d(t,e)}function g(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var m=[0,0,0,153],A=[0,0,0,144],y=[0,0,0,255],_=[0,0,144,144],v=[144,144,144,255],b=[144,144,144,144],x=[192,0,0,255],w=[0,0,0,128],E=[124,0,192,255],S=[255,255,255,255],T=o.DrawPolygonMode;function P(t){return t&&"function"==typeof t?function(e){return t(function(t){return t.__source?t.__source.object:t.sourceFeature?t.sourceFeature.feature:t}(e))}:t}function M(t){switch(t.properties.editHandleType){case"existing":return x;case"snap-source":return E;default:return w}}var C={mode:T,onEdit:function(){},pickable:!0,pickingRadius:10,pickingDepth:5,fp64:!1,filled:!0,stroked:!0,lineWidthScale:1,lineWidthMinPixels:1,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineWidthUnits:"pixels",lineJointRounded:!1,lineMiterLimit:4,pointRadiusScale:1,pointRadiusMinPixels:2,pointRadiusMaxPixels:Number.MAX_SAFE_INTEGER,getLineColor:function(t,e,n){return e?y:m},getFillColor:function(t,e,n){return e?_:A},getRadius:function(t){return t&&t.properties&&t.properties.radius||t&&t.properties&&t.properties.size||1},getLineWidth:function(t){return t&&t.properties&&t.properties.lineWidth||3},getTentativeLineColor:function(t){return v},getTentativeFillColor:function(t){return b},getTentativeLineWidth:function(t){return t&&t.properties&&t.properties.lineWidth||3},editHandleType:"point",editHandlePointRadiusScale:1,editHandlePointOutline:!0,editHandlePointStrokeWidth:2,editHandlePointRadiusMinPixels:4,editHandlePointRadiusMaxPixels:8,getEditHandlePointColor:M,getEditHandlePointOutlineColor:function(t){return S},getEditHandlePointRadius:function(t){switch(t.properties.editHandleType){case"existing":return 5;case"snap":return 7;default:return 3}},editHandleIconAtlas:null,editHandleIconMapping:null,editHandleIconSizeScale:1,getEditHandleIcon:function(t){return t.properties.editHandleType},getEditHandleIconSize:10,getEditHandleIconColor:M,getEditHandleIconAngle:0,billboard:!0},I={view:o.ViewMode,modify:o.ModifyMode,translate:new o.SnappableMode(new o.TranslateMode),transform:new o.SnappableMode(new o.TransformMode),scale:o.ScaleMode,rotate:o.RotateMode,duplicate:o.DuplicateMode,split:o.SplitPolygonMode,extrude:o.ExtrudeMode,elevation:o.ElevationMode,drawPoint:o.DrawPointMode,drawLineString:o.DrawLineStringMode,drawPolygon:o.DrawPolygonMode,drawRectangle:o.DrawRectangleMode,drawSquareFromCenter:o.DrawSquareFromCenterMode,drawCircleFromCenter:o.DrawCircleFromCenterMode,drawCircleByBoundingBox:o.DrawCircleByDiameterMode,drawEllipseByBoundingBox:o.DrawEllipseByBoundingBoxMode,drawRectangleUsing3Points:o.DrawRectangleUsingThreePointsMode,drawEllipseUsing3Points:o.DrawEllipseUsingThreePointsMode,draw90DegreePolygon:o.Draw90DegreePolygonMode,drawPolygonByDragging:o.DrawPolygonByDraggingMode},O=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(s,t);var e,n,r,o=(e=s,function(){var t,n=f(e);if(p()){var r=f(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return h(this,t)});function s(){return l(this,s),o.apply(this,arguments)}return n=s,(r=[{key:"renderLayers",value:function(){var t=this.getSubLayerProps({id:"geojson",data:this.props.data,fp64:this.props.fp64,filled:this.props.filled,stroked:this.props.stroked,lineWidthScale:this.props.lineWidthScale,lineWidthMinPixels:this.props.lineWidthMinPixels,lineWidthMaxPixels:this.props.lineWidthMaxPixels,lineWidthUnits:this.props.lineWidthUnits,lineJointRounded:this.props.lineJointRounded,lineMiterLimit:this.props.lineMiterLimit,pointRadiusScale:this.props.pointRadiusScale,pointRadiusMinPixels:this.props.pointRadiusMinPixels,pointRadiusMaxPixels:this.props.pointRadiusMaxPixels,getLineColor:this.selectionAwareAccessor(this.props.getLineColor),getFillColor:this.selectionAwareAccessor(this.props.getFillColor),getRadius:this.selectionAwareAccessor(this.props.getRadius),getLineWidth:this.selectionAwareAccessor(this.props.getLineWidth),_subLayerProps:{"line-strings":{billboard:this.props.billboard},"polygons-stroke":{billboard:this.props.billboard}},updateTriggers:{getLineColor:[this.props.selectedFeatureIndexes,this.props.mode],getFillColor:[this.props.selectedFeatureIndexes,this.props.mode],getRadius:[this.props.selectedFeatureIndexes,this.props.mode],getLineWidth:[this.props.selectedFeatureIndexes,this.props.mode]}}),e=[new i.GeoJsonLayer(t)];return e.concat(this.createGuidesLayers(),this.createTooltipsLayers())}},{key:"initializeState",value:function(){c(f(s.prototype),"initializeState",this).call(this),this.setState({selectedFeatures:[],editHandles:[]})}},{key:"shouldUpdateState",value:function(t){return c(f(s.prototype),"shouldUpdateState",this).call(this,t)||t.changeFlags.stateChanged}},{key:"updateState",value:function(t){var e,n=t.props,r=t.oldProps,i=t.changeFlags;c(f(s.prototype),"updateState",this).call(this,{oldProps:r,props:n,changeFlags:i}),!i.propsOrDataChanged||0!==Object.keys(r).length&&n.mode===r.mode||("function"==typeof n.mode?e=new(0,n.mode):"string"==typeof n.mode?(e=I[n.mode],console.warn("Deprecated use of passing `mode` as a string. Pass the mode's class constructor instead.")):e=n.mode,e||(console.warn("No mode configured for ".concat(String(n.mode))),e=new T),e!==this.state.mode&&this.setState({mode:e,cursor:null}));var o=[];Array.isArray(n.selectedFeatureIndexes)&&(o=n.selectedFeatureIndexes.map((function(t){return n.data.features[t]}))),this.setState({selectedFeatures:o})}},{key:"getModeProps",value:function(t){var e=this;return{modeConfig:t.modeConfig,data:t.data,selectedIndexes:t.selectedFeatureIndexes,lastPointerMoveEvent:this.state.lastPointerMoveEvent,cursor:this.state.cursor,onEdit:function(n){e.setNeedsUpdate(),t.onEdit(n)},onUpdateCursor:function(t){e.setState({cursor:t})}}}},{key:"selectionAwareAccessor",value:function(t){var e=this;return"function"!=typeof t?t:function(n){return t(n,e.isFeatureSelected(n),e.props.mode)}}},{key:"isFeatureSelected",value:function(t){if(!this.props.data||!this.props.selectedFeatureIndexes)return!1;if(!this.props.selectedFeatureIndexes.length)return!1;var e=this.props.data.features.indexOf(t);return this.props.selectedFeatureIndexes.includes(e)}},{key:"getPickingInfo",value:function(t){var e=t.info;return t.sourceLayer.id.endsWith("guides")&&(e.isGuide=!0),e}},{key:"createGuidesLayers",value:function(){var t,e=this.getActiveMode().getGuides(this.getModeProps(this.props));return e&&e.features.length?(t="icon"===this.props.editHandleType?{type:i.IconLayer,iconAtlas:this.props.editHandleIconAtlas,iconMapping:this.props.editHandleIconMapping,sizeScale:this.props.editHandleIconSizeScale,getIcon:P(this.props.getEditHandleIcon),getSize:P(this.props.getEditHandleIconSize),getColor:P(this.props.getEditHandleIconColor),getAngle:P(this.props.getEditHandleIconAngle)}:{type:i.ScatterplotLayer,radiusScale:this.props.editHandlePointRadiusScale,stroked:this.props.editHandlePointOutline,getLineWidth:this.props.editHandlePointStrokeWidth,radiusMinPixels:this.props.editHandlePointRadiusMinPixels,radiusMaxPixels:this.props.editHandlePointRadiusMaxPixels,getRadius:P(this.props.getEditHandlePointRadius),getFillColor:P(this.props.getEditHandlePointColor),getLineColor:P(this.props.getEditHandlePointOutlineColor)},[new i.GeoJsonLayer(this.getSubLayerProps({id:"guides",data:e,fp64:this.props.fp64,_subLayerProps:{points:t},lineWidthScale:this.props.lineWidthScale,lineWidthMinPixels:this.props.lineWidthMinPixels,lineWidthMaxPixels:this.props.lineWidthMaxPixels,lineWidthUnits:this.props.lineWidthUnits,lineJointRounded:this.props.lineJointRounded,lineMiterLimit:this.props.lineMiterLimit,getLineColor:P(this.props.getTentativeLineColor),getLineWidth:P(this.props.getTentativeLineWidth),getFillColor:P(this.props.getTentativeFillColor)}))]):[]}},{key:"createTooltipsLayers",value:function(){var t=this.getActiveMode().getTooltips(this.getModeProps(this.props));return[new i.TextLayer(this.getSubLayerProps({id:"tooltips",data:t}))]}},{key:"onLayerClick",value:function(t){this.getActiveMode().handleClick(t,this.getModeProps(this.props))}},{key:"onLayerKeyUp",value:function(t){this.getActiveMode().handleKeyUp(t,this.getModeProps(this.props))}},{key:"onStartDragging",value:function(t){this.getActiveMode().handleStartDragging(t,this.getModeProps(this.props))}},{key:"onDragging",value:function(t){this.getActiveMode().handleDragging(t,this.getModeProps(this.props))}},{key:"onStopDragging",value:function(t){this.getActiveMode().handleStopDragging(t,this.getModeProps(this.props))}},{key:"onPointerMove",value:function(t){this.setState({lastPointerMoveEvent:t}),this.getActiveMode().handlePointerMove(t,this.getModeProps(this.props))}},{key:"getCursor",value:function(t){var e=t.isDragging;if(null===this.state)return null;var n=this.state.cursor;return n||(n=e?"grabbing":"grab"),n}},{key:"getActiveMode",value:function(){return this.state.mode}}])&&u(n.prototype,r),s}(s.default);e.default=O,g(O,"layerName","EditableGeoJsonLayer"),g(O,"defaultProps",C)},9132:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(4086),i=n(9199),o=n(9947),s=l(n(5085)),a=l(n(3049));function l(t){return t&&t.__esModule?t:{default:t}}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function c(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function d(t,e,n){return d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=A(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}},d(t,e,n||t)}function g(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function A(t){return A=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},A(t)}function y(t,e){return y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},y(t,e)}function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){b(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function b(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var x=i.ViewMode,w={type:"FeatureCollection",features:[]},E=v({mode:x},s.default.defaultProps,{data:[],selectedIndexes:[],filled:!1,stroked:!0,lineWidthScale:1,lineWidthMinPixels:1,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineWidthUnits:"pixels",getHexagons:function(t){return t.hexIds},getEditedCluster:function(t,e){return e?v({},e,{hexIds:t}):{hexIds:t}},resolution:9}),S=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}(l,t);var e,n,i,a=(e=l,function(){var t,n=A(e);if(m()){var r=A(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return g(this,t)});function l(){return p(this,l),a.apply(this,arguments)}return n=l,(i=[{key:"initializeState",value:function(){d(A(l.prototype),"initializeState",this).call(this),this.setState({tentativeHexagonIDs:[]})}},{key:"getDerivedHexagonIDs",value:function(t){return(0,o.polyfill)(t,this.props.resolution,!0)}},{key:"getDerivedHexagonID",value:function(t){return(0,o.geoToH3)(t[1],t[0],this.props.resolution)}},{key:"renderLayers",value:function(){var t=this;return[new s.default(this.getSubLayerProps({id:"editable-geojson",mode:this.props.mode,data:w,selectedFeatureIndexes:[],onEdit:function(e){var n=e.editType,r=e.editContext;switch(n){case"updateTentativeFeature":if("Polygon"===r.feature.geometry.type){var i=r.feature.geometry.coordinates,o=t.getDerivedHexagonIDs(i);t.setState({tentativeHexagonIDs:o})}else if("Point"===r.feature.geometry.type){var s=r.feature.geometry.coordinates,a=t.getDerivedHexagonID(s);t.setState({tentativeHexagonIDs:[a]})}break;case"addFeature":var l=c(t.props.data),u=t.props.modeConfig;if(u&&u.booleanOperation)if(1!==t.props.selectedIndexes.length)console.warn("booleanOperation only supported for single cluster selection");else{var h,p=new Set(t.getSelectedHexIDs()),f=new Set(t.state.tentativeHexagonIDs);switch(u.booleanOperation){default:h=c(new Set([].concat(c(p),c(f))));break;case"intersection":h=c(p).filter((function(t){return f.has(t)}));break;case"difference":h=c(p).filter((function(t){return!f.has(t)}))}var d=t.props.selectedIndexes[0],g=t.props.data[d];l[d]=t.props.getEditedCluster(h,g)}else l.push(t.props.getEditedCluster(t.state.tentativeHexagonIDs,null));t.setState({tentativeHexagonIDs:[]}),t.props.onEdit({updatedData:l})}}})),new r.H3ClusterLayer(this.getSubLayerProps({id:"hexagons",data:this.props.data,getHexagons:this.props.getHexagons})),new r.H3ClusterLayer(this.getSubLayerProps({id:"tentative-hexagons",data:[{hexIds:this.state.tentativeHexagonIDs}],getHexagons:function(t){return t.hexIds}}))]}},{key:"getSelectedHexIDs",value:function(){var t=this,e=[];return this.props.selectedIndexes.forEach((function(n){var r=t.props.data[n],i=t.props.getHexagons(r);e=e.concat(i)})),e}},{key:"getCursor",value:function(t){var e=t.isDragging,n=this.state.cursor;return n||(n=e?"grabbing":"grab"),n}}])&&f(n.prototype,i),l}(a.default);e.default=S,b(S,"layerName","EditableH3ClusterLayer"),b(S,"defaultProps",E)},3049:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(3764);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){g(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function a(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(t){if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function d(t,e){return d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},d(t,e)}function g(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var m=["anyclick","pointermove","panstart","panmove","panend","keyup"],A=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(o,t);var e,n,r,i=(e=o,function(){var t,n=f(e);if(p()){var r=f(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return h(this,t)});function o(){return u(this,o),i.apply(this,arguments)}return n=o,(r=[{key:"onLayerClick",value:function(t){}},{key:"onStartDragging",value:function(t){}},{key:"onStopDragging",value:function(t){}},{key:"onDragging",value:function(t){}},{key:"onPointerMove",value:function(t){}},{key:"onLayerKeyUp",value:function(t){}},{key:"initializeState",value:function(){this.setState({_editableLayerState:{pointerDownPicks:null,pointerDownScreenCoords:null,pointerDownMapCoords:null,eventHandler:this._forwardEventToCurrentLayer.bind(this)}}),this._addEventHandlers()}},{key:"finalizeState",value:function(){this._removeEventHandlers()}},{key:"_addEventHandlers",value:function(){var t,e=this.context.deck.eventManager,n=this.state._editableLayerState.eventHandler,r=a(m);try{for(r.s();!(t=r.n()).done;){var i=t.value;e.on(i,n,{priority:100})}}catch(t){r.e(t)}finally{r.f()}}},{key:"_removeEventHandlers",value:function(){var t,e=this.context.deck.eventManager,n=this.state._editableLayerState.eventHandler,r=a(m);try{for(r.s();!(t=r.n()).done;){var i=t.value;e.off(i,n)}}catch(t){r.e(t)}finally{r.f()}}},{key:"_forwardEventToCurrentLayer",value:function(t){var e=this.getCurrentLayer(),n=e["_on".concat(t.type)].bind(e);n?n(t):console.warn("no handler for mjolnir.js event ".concat(t.type))}},{key:"_onanyclick",value:function(t){var e=t.srcEvent,n=this.getScreenCoords(e),r=this.getMapCoords(n),i=this.getPicks(n);this.onLayerClick({mapCoords:r,screenCoords:n,picks:i,sourceEvent:e})}},{key:"_onkeyup",value:function(t){var e=t.srcEvent;this.onLayerKeyUp(e)}},{key:"_onpanstart",value:function(t){var e=this.getScreenCoords(t.srcEvent),n=this.getMapCoords(e),r=this.getPicks(e);this.setState({_editableLayerState:s({},this.state._editableLayerState,{pointerDownScreenCoords:e,pointerDownMapCoords:n,pointerDownPicks:r})}),this.onStartDragging({picks:r,screenCoords:e,mapCoords:n,pointerDownScreenCoords:e,pointerDownMapCoords:n,cancelPan:t.stopImmediatePropagation,sourceEvent:t.srcEvent})}},{key:"_onpanmove",value:function(t){var e=t.srcEvent,n=this.getScreenCoords(e),r=this.getMapCoords(n),i=this.state._editableLayerState,o=i.pointerDownPicks,s=i.pointerDownScreenCoords,a=i.pointerDownMapCoords,l=this.getPicks(n);this.onDragging({screenCoords:n,mapCoords:r,picks:l,pointerDownPicks:o,pointerDownScreenCoords:s,pointerDownMapCoords:a,sourceEvent:e,cancelPan:t.stopImmediatePropagation})}},{key:"_onpanend",value:function(t){var e=t.srcEvent,n=this.getScreenCoords(e),r=this.getMapCoords(n),i=this.state._editableLayerState,o=i.pointerDownPicks,a=i.pointerDownScreenCoords,l=i.pointerDownMapCoords,u=this.getPicks(n);this.onStopDragging({picks:u,screenCoords:n,mapCoords:r,pointerDownPicks:o,pointerDownScreenCoords:a,pointerDownMapCoords:l,sourceEvent:e}),this.setState({_editableLayerState:s({},this.state._editableLayerState,{pointerDownScreenCoords:null,pointerDownMapCoords:null,pointerDownPicks:null})})}},{key:"_onpointermove",value:function(t){var e=t.srcEvent,n=this.getScreenCoords(e),r=this.getMapCoords(n),i=this.state._editableLayerState,o=i.pointerDownPicks,s=i.pointerDownScreenCoords,a=i.pointerDownMapCoords,l=this.getPicks(n);this.onPointerMove({screenCoords:n,mapCoords:r,picks:l,pointerDownPicks:o,pointerDownScreenCoords:s,pointerDownMapCoords:a,sourceEvent:e})}},{key:"getPicks",value:function(t){return this.context.deck.pickMultipleObjects({x:t[0],y:t[1],layerIds:[this.props.id],radius:this.props.pickingRadius,depth:this.props.pickingDepth})}},{key:"getScreenCoords",value:function(t){return[t.clientX-this.context.gl.canvas.getBoundingClientRect().left,t.clientY-this.context.gl.canvas.getBoundingClientRect().top]}},{key:"getMapCoords",value:function(t){return this.context.viewport.unproject([t[0],t[1]])}}])&&c(n.prototype,r),o}(r.CompositeLayer);e.default=A,g(A,"layerName","EditableLayer")},357:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(3764),i=n(9119);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}function h(t,e){return h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},h(t,e)}function p(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(p,t);var e,n,r,o=(e=p,function(){var t,n=c(e);if(u()){var r=c(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return l(this,t)});function p(){return s(this,p),o.apply(this,arguments)}return n=p,(r=[{key:"renderLayers",value:function(){return[new i.ScatterplotLayer(Object.assign({},this.props,{id:"".concat(this.props.id,"-ScatterplotLayer"),data:this.props.data})),new i.LineLayer(Object.assign({},this.props,{id:"".concat(this.props.id,"-LineLayer"),data:this.props.data,pickable:!1,getSourcePosition:function(t){var e=t.position;return[e[0],e[1],0]},getTargetPosition:function(t){var e=t.position;return[e[0],e[1],e[2]||0]},getColor:[150,150,150,200],getStrokeWidth:3}))]}}])&&a(n.prototype,r),p}(r.CompositeLayer);e.default=f,p(f,"layerName","ElevatedEditHandleLayer"),p(f,"defaultProps",{})},6755:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(3764),i=n(9119);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){d(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(s,t);var e,n,r,o=(e=s,function(){var t,n=p(e);if(h()){var r=p(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return c(this,t)});function s(){return l(this,s),o.apply(this,arguments)}return n=s,(r=[{key:"renderLayers",value:function(){var t=this.props,e=t.id,n=t.getFillColor,r=t.getStrokeColor,o=t.getInnerRadius,s=t.updateTriggers;return[new i.ScatterplotLayer(a({},this.props,{id:"".concat(e,"-full"),data:this.props.data,getLineColor:r,updateTriggers:a({},s,{getStrokeColor:s.getStrokeColor})})),new i.ScatterplotLayer(a({},this.props,{id:"".concat(e,"-inner"),data:this.props.data,getFillColor:n,getRadius:o,pickable:!1,updateTriggers:a({},s,{getFillColor:s.getFillColor,getRadius:s.getInnerRadius})}))]}}])&&u(n.prototype,r),s}(r.CompositeLayer);e.default=g,d(g,"layerName","JunctionScatterplotLayer"),d(g,"defaultProps",a({},i.ScatterplotLayer.defaultProps,{getFillColor:function(t){return[0,0,0,255]},getStrokeColor:function(t){return[255,255,255,255]},getInnerRadius:function(t){return 1}}))},7451:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}function l(t,e){return l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},l(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(r,t);var e,n=(e=r,function(){var t,n=a(e);if(s()){var r=a(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return o(this,t)});function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i(this,r),n.call(this,Object.assign({},t,{attributes:c(t)}))}return r}(n(2150).Geometry);function c(t){for(var e=t.length,n=void 0===e?1:e,r=t.headSize,i=void 0===r?.2:r,o=t.tailWidth,s=void 0===o?.05:o,a=t.tailStart,l=void 0===a?.05:a,u=[.5,1,0,.5-i/2,1-i,0,.5+i/2,1-i,0,.5-s/2,l,0,.5+s/2,1-i,0,.5+s/2,l,0,.5-s/2,l,0,.5-s/2,1-i,0,.5+s/2,1-i,0],c=new Array(u.length),h=0;h<u.length/3;h++){var p=3*h;c[p+0]=(u[p+0]-.5)*n,c[p+1]=(u[p+1]-.5)*n,c[p+2]=0}return{positions:new Float32Array(c),normals:new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]),texCoords:new Float32Array(u)}}e.default=u},563:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e,n=t.data,o=t.getPath,c=void 0===o?function(t){return t.path}:o,h=t.getDirection,p=void 0===h?function(t){return t.direction}:h,f=t.getColor,d=void 0===f?function(t){return a}:f,g=t.getMarkerPercentages,m=void 0===g?function(t){return[.5]}:g,A=t.projectFlat,y=[],_=i(n);try{for(_.s();!(e=_.n()).done;){var v,b=e.value,x=c(b),w=p(b)||l,E=d(b),S=x.map((function(t){return new r.Vector2(t)})),T=S.slice(0).reverse(),P=s(S),M=i(m(b,{lineLength:P}));try{for(M.s();!(v=M.n()).done;){var C=v.value;if(w.forward){var I=u({path:S,percentage:C,lineLength:P,color:E,object:b,projectFlat:A});y.push(I)}if(w.backward){var O=u({path:T,percentage:C,lineLength:P,color:E,object:b,projectFlat:A});y.push(O)}}}catch(t){M.e(t)}finally{M.f()}}}catch(t){_.e(t)}finally{_.f()}return y};var r=n(9811);function i(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,s=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){a=!0,i=t},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw i}}}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t){for(var e=0,n=0;n<t.length-1;n++)e+=t[n].distance(t[n+1]);return e}var a=[0,0,0,255],l={forward:!0,backward:!1};function u(t){var e=t.path,n=t.percentage,i=t.lineLength,o=t.color,s=t.object,a=t.projectFlat,l=i*n,u=0,c=0,h=0;for(h=0;h<e.length-1&&!((u+=e[h].distance(e[h+1]))>l);h++)c=u;var p=l-c,f=e[h+1].clone().subtract(e[h]).normalize().clone().multiply(new r.Vector2(p,p)).add(e[h]),d=180*new r.Vector2(a(e[h+1])).subtract(a(e[h])).verticalAngle()/Math.PI;return{position:[f.x,f.y,0],angle:d,color:o,object:s}}},5213:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(3764),i=n(9119),o=n(1956),s=c(n(2954)),a=c(n(7451)),l=c(n(563)),u=n(3656);function c(t){return t&&t.__esModule?t:{default:t}}function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function p(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(t,e)||function(t,e){if(t){if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function m(t,e){return!e||"object"!==h(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function A(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}function _(t,e){return _=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},_(t,e)}function v(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var b=o.SimpleMeshLayer,x={mesh:new a.default({headSize:.2,tailWidth:.05})},w=Object.assign({},s.default.defaultProps,{MarkerLayer:b,markerLayerProps:x,sizeScale:100,fp64:!1,hightlightIndex:-1,highlightPoint:null,getPath:function(t){return t.path},getColor:function(t){return t.color},getMarkerColor:function(t){return[0,0,0,255]},getDirection:function(t){return t.direction},getMarkerPercentages:function(t,e){return e.lineLength>.1?[.25,.5,.75]:[.5]}}),E=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_(t,e)}(h,t);var e,n,o,c=(e=h,function(){var t,n=y(e);if(A()){var r=y(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return m(this,t)});function h(){return d(this,h),c.apply(this,arguments)}return n=h,(o=[{key:"initializeState",value:function(){this.state={markers:[],mesh:new a.default({headSize:.2,tailWidth:.05}),closestPoint:null}}},{key:"projectFlat",value:function(t,e,n,i){if(n===r.COORDINATE_SYSTEM.METER_OFFSETS){var o=p(e.metersToLngLatDelta(t),2),s=o[0],a=o[1],l=p(i,2),u=l[0],c=l[1];return e.projectFlat([u+s,a+c])}if(n===r.COORDINATE_SYSTEM.LNGLAT_OFFSETS){var h=p(t,2),f=h[0],d=h[1],g=p(i,2),m=g[0],A=g[1];return e.projectFlat([m+f,d+A])}return e.projectFlat(t)}},{key:"updateState",value:function(t){var e=this,n=t.props,r=t.oldProps,i=t.changeFlags;if(i.dataChanged||i.updateTriggersChanged){var o=this.props,s=o.data,a=o.getPath,u=o.getDirection,c=o.getMarkerColor,h=o.getMarkerPercentages,p=o.coordinateSystem,f=o.coordinateOrigin,d=this.context.viewport;this.state.markers=(0,l.default)({data:s,getPath:a,getDirection:u,getColor:c,getMarkerPercentages:h,projectFlat:function(t){return e.projectFlat(t,d,p,f)}}),this._recalculateClosestPoint()}i.propsChanged&&n.point!==r.point&&this._recalculateClosestPoint()}},{key:"_recalculateClosestPoint",value:function(){var t=this.props,e=t.highlightPoint,n=t.highlightIndex;if(e&&n>=0){var r=this.props.data[n],i=this.props.getPath(r),o=(0,u.getClosestPointOnPolyline)({points:i,p:e}).point;this.state.closestPoints=[{position:o}]}else this.state.closestPoints=[]}},{key:"getPickingInfo",value:function(t){var e=t.info;return Object.assign(e,{object:e.object&&e.object.path||e.object})}},{key:"renderLayers",value:function(){return[new s.default(this.props,this.getSubLayerProps({id:"paths",data:this.props.data})),new this.props.MarkerLayer(this.getSubLayerProps(Object.assign({},this.props.markerLayerProps,{id:"markers",data:this.state.markers,getOrientation:function(t){return[0,-t.angle,0]},getColor:function(t){return t.color},sizeScale:this.props.sizeScale,fp64:this.props.fp64,pickable:!1,parameters:{blend:!1,depthTest:!1}}))),this.state.closestPoints&&new i.ScatterplotLayer({id:"".concat(this.props.id,"-highlight"),data:this.state.closestPoints,fp64:this.props.fp64})]}}])&&g(n.prototype,o),h}(r.CompositeLayer);e.default=E,v(E,"layerName","PathMarkerLayer"),v(E,"defaultProps",w)},3656:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getClosestPointOnLine=i,e.getClosestPointOnPolyline=function(t){var e=t.p,n=t.points;e=new r.Vector3(e);for(var o=null,s=1/0,a=-1,l=0;l<n.length-1;++l){var u=i({p:e,p1:n[l],p2:n[l+1]}),c=e.distanceSquared(u);c<s&&(s=c,o=u,a=l)}return{point:o,index:a,p1:n[a],p2:n[a+1],distanceSquared:s,distance:Math.sqrt(s)}};var r=n(9811);function i(t){var e=t.p,n=t.p1,i=t.p2,o=t.clampToLine,s=void 0===o||o,a=new r.Vector3(i).subtract(n),l=new r.Vector3(e).subtract(n),u=a.dot(l);return s&&(u=(0,r.clamp)(u,0,1)),a.lerp(u)}},2954:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(9119),i=a(n(9757)),o=n(2150),s=a(n(2933));function a(t){return t&&t.__esModule?t:{default:t}}function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,n){return h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}},h(t,e,n||t)}function p(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function g(t,e){return g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},g(t,e)}function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A(t){var e=t.source,n=t.code,r=void 0===n?"":n;return e.replace(/}[^{}]*$/,r.concat("\n}\n"))}var y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}(l,t);var e,n,r,a=(e=l,function(){var t,n=d(e);if(f()){var r=d(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return p(this,t)});function l(){return u(this,l),a.apply(this,arguments)}return n=l,(r=[{key:"getShaders",value:function(){var t=h(d(l.prototype),"getShaders",this).call(this);return Object.assign({},t,{modules:t.modules.concat([s.default]),vs:A({source:t.vs,code:"  outline_setUV(gl_Position);\n  outline_setZLevel(instanceZLevel);\n"}),fs:A({source:t.fs,code:"  gl_FragColor = outline_filterColor(gl_FragColor);\n"})})}},{key:"initializeState",value:function(t){h(d(l.prototype),"initializeState",this).call(this,t),this.setState({outlineFramebuffer:new o.Framebuffer(t.gl),dummyTexture:new o.Texture2D(t.gl)}),this.state.attributeManager.addInstanced({instanceZLevel:{size:1,type:i.default.UNSIGNED_BYTE,update:this.calculateZLevels,accessor:"getZLevel"}})}},{key:"draw",value:function(t){t.moduleParameters,t.parameters;var e=t.uniforms,n=(t.context,this.props),r=n.rounded,o=n.miterLimit,s=n.widthScale,a=n.widthMinPixels,l=n.widthMaxPixels,u=n.dashJustified;e=Object.assign({},e,{jointType:Number(r),alignMode:Number(u),widthScale:s,miterLimit:o,widthMinPixels:a,widthMaxPixels:l});var c=this.state,h=c.outlineFramebuffer,p=c.dummyTexture;h.resize(),h.clear({color:!0,depth:!0}),this.state.model.updateModuleSettings({outlineEnabled:!0,outlineRenderShadowmap:!0,outlineShadowmap:p}),this.state.model.draw({uniforms:Object.assign({},e,{jointType:0,widthScale:1.3*this.props.widthScale}),parameters:{depthTest:!1,blendEquation:i.default.MAX},framebuffer:h}),this.state.model.updateModuleSettings({outlineEnabled:!0,outlineRenderShadowmap:!1,outlineShadowmap:h}),this.state.model.draw({uniforms:Object.assign({},e,{jointType:Number(r),widthScale:this.props.widthScale}),parameters:{depthTest:!1}})}},{key:"calculateZLevels",value:function(t){var e=this.props.getZLevel,n=this.state.pathTesselator;t.value=n._updateAttribute({target:t.value,size:1,getValue:function(t,n){return[e(t,n)||0]}})}}])&&c(n.prototype,r),l}(r.PathLayer);e.default=y,m(y,"layerName","PathOutlineLayer"),m(y,"defaultProps",{getZLevel:{type:"accessor",value:0}})},7541:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.SELECTION_TYPE=void 0;var r,i=n(3764),o=n(9119),s=n(4102),a=h(n(5950)),l=h(n(8727)),u=n(9199),c=h(n(5085));function h(t){return t&&t.__esModule?t:{default:t}}function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){S(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function g(t){return function(t){if(Array.isArray(t))return y(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||A(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(t,e)||A(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(t,e){if(t){if("string"==typeof t)return y(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(t,e):void 0}}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function b(t,e){return!e||"object"!==p(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function x(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function w(t){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},w(t)}function E(t,e){return E=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},E(t,e)}function S(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var T={NONE:null,RECTANGLE:"rectangle",POLYGON:"polygon"};e.SELECTION_TYPE=T;var P=(S(r={},T.RECTANGLE,u.DrawRectangleMode),S(r,T.POLYGON,u.DrawPolygonMode),r),M=S({},T.RECTANGLE,{dragToDraw:!0}),C={selectionType:T.RECTANGLE,layerIds:[],onSelect:function(){}},I={type:"FeatureCollection",features:[]},O="selection-blocker",R=["lineWidthScale","lineWidthMinPixels","lineWidthMaxPixels","lineWidthUnits","lineJointRounded","lineMiterLimit","pointRadiusScale","pointRadiusMinPixels","pointRadiusMaxPixels","lineDashJustified","getLineColor","getFillColor","getRadius","getLineWidth","getLineDashArray","getTentativeLineDashArray","getTentativeLineColor","getTentativeFillColor","getTentativeLineWidth"],L=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&E(t,e)}(h,t);var e,n,r,i=(e=h,function(){var t,n=w(e);if(x()){var r=w(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return b(this,t)});function h(){return _(this,h),i.apply(this,arguments)}return n=h,(r=[{key:"_selectRectangleObjects",value:function(t){var e=this.props,n=e.layerIds,r=e.onSelect,i=m(this.context.viewport.project(t[0][0]),2),o=i[0],s=i[1],a=m(this.context.viewport.project(t[0][2]),2),l=a[0],u=a[1];r({pickingInfos:this.context.deck.pickObjects({x:Math.min(o,l),y:Math.min(s,u),width:Math.abs(l-o),height:Math.abs(u-s),layerIds:n})})}},{key:"_selectPolygonObjects",value:function(t){var e,n=this,r=this.props,i=r.layerIds,o=r.onSelect,u=t[0].map((function(t){return n.context.viewport.project(t)})),c=u.map((function(t){return t[0]})),h=u.map((function(t){return t[1]})),p=Math.min.apply(Math,g(c)),f=Math.min.apply(Math,g(h)),d=Math.max.apply(Math,g(c)),m=Math.max.apply(Math,g(h)),A=(0,s.polygon)(t),y=(0,a.default)(A,50);try{e=(0,l.default)(y,A)}catch(t){return void console.log("turfDifference() error",t)}this.setState({pendingPolygonSelection:{bigPolygon:e}});var _="".concat(this.props.id,"-").concat(O);setTimeout((function(){var t=n.context.deck.pickObjects({x:p,y:f,width:d-p,height:m-f,layerIds:[_].concat(g(i))});o({pickingInfos:t.filter((function(t){return t.layer.id!==n.props.id}))})}),250)}},{key:"renderLayers",value:function(){var t=this,e=this.state.pendingPolygonSelection,n=P[this.props.selectionType]||u.ViewMode,r=M[this.props.selectionType],i={};R.forEach((function(e){void 0!==t.props[e]&&(i[e]=t.props[e])}));var s=[new c.default(this.getSubLayerProps(d({id:"selection-geojson",pickable:!0,mode:n,modeConfig:r,selectedFeatureIndexes:[],data:I,onEdit:function(e){var n=e.updatedData;if("addFeature"===e.editType){var r=n.features[0].geometry.coordinates;t.props.selectionType===T.RECTANGLE?t._selectRectangleObjects(r):t.props.selectionType===T.POLYGON&&t._selectPolygonObjects(r)}}},i)))];if(e){var a=e.bigPolygon;s.push(new o.PolygonLayer(this.getSubLayerProps({id:O,pickable:!0,stroked:!1,opacity:1,data:[a],getLineColor:function(t){return[0,0,0,1]},getFillColor:function(t){return[0,0,0,1]},getPolygon:function(t){return t.geometry.coordinates}})))}return s}},{key:"shouldUpdateState",value:function(t){var e=t.changeFlags,n=e.stateChanged,r=e.propsOrDataChanged;return n||r}}])&&v(n.prototype,r),h}(i.CompositeLayer);e.default=L,S(L,"layerName","SelectionLayer"),S(L,"defaultProps",C)},2933:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={outlineEnabled:!1,outlineRenderShadowmap:!1,outlineShadowmap:null},r={name:"outline",vs:"attribute float instanceZLevel;\nvarying float outline_vzLevel;\nvarying vec4 outline_vPosition;\n\n// Set the z level for the outline shadowmap rendering\nvoid outline_setZLevel(float zLevel) {\n  outline_vzLevel = zLevel;\n}\n\n// Store an adjusted position for texture2DProj\nvoid outline_setUV(vec4 position) {\n  // mat4(\n  //   0.5, 0.0, 0.0, 0.0,\n  //   0.0, 0.5, 0.0, 0.0,\n  //   0.0, 0.0, 0.5, 0.0,\n  //   0.5, 0.5, 0.5, 1.0\n  // ) * position;\n  outline_vPosition = vec4(position.xyz * 0.5 + position.w * 0.5, position.w);\n}\n",fs:"uniform bool outline_uEnabled;\nuniform bool outline_uRenderOutlines;\nuniform sampler2D outline_uShadowmap;\n\nvarying float outline_vzLevel;\n// varying vec2 outline_vUV;\nvarying vec4 outline_vPosition;\n\nconst float OUTLINE_Z_LEVEL_ERROR = 0.01;\n\n// Return a darker color in shadowmap\nvec4 outline_filterShadowColor(vec4 color) {\n  return vec4(outline_vzLevel / 255., outline_vzLevel / 255., outline_vzLevel / 255., 1.);\n}\n\n// Return a darker color if in shadowmap\nvec4 outline_filterDarkenColor(vec4 color) {\n  if (outline_uEnabled) {\n    float maxZLevel;\n    if (outline_vPosition.q > 0.0) {\n      maxZLevel = texture2DProj(outline_uShadowmap, outline_vPosition).r * 255.;\n    } else {\n      discard;\n    }\n    if (maxZLevel < outline_vzLevel + OUTLINE_Z_LEVEL_ERROR) {\n      vec4(color.rgb * 0.5, color.a);\n    } else {\n      discard;\n    }\n  }\n  return color;\n}\n\n// if enabled and rendering outlines - Render depth to shadowmap\n// if enabled and rendering colors - Return a darker color if in shadowmap\n// if disabled, just return color\nvec4 outline_filterColor(vec4 color) {\n  if (outline_uEnabled) {\n    return outline_uRenderOutlines ?\n      outline_filterShadowColor(color) :\n      outline_filterDarkenColor(color);\n  }\n  return color;\n}\n",getUniforms:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,e=t.outlineEnabled,r=t.outlineRenderShadowmap,i=t.outlineShadowmap,o={};return void 0!==e&&(o.outline_uEnabled=e),void 0!==r&&(o.outline_uRenderOutlines=r),void 0!==i&&(o.outline_uShadowmap=i),o}};e.default=r},462:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MAX_ARROWS=e.DEFAULT_ARROWS=e.ArrowStyles=void 0,e.ArrowStyles={NONE:0,FORWARD:1,BACKWARD:2,BOTH:3},e.DEFAULT_ARROWS=1,e.MAX_ARROWS=3},7484:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toDeckColor=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[255,0,0,255];return Array.isArray(t)?[255*t[0],255*t[1],255*t[2],255*t[3]]:e},e.recursivelyTraverseNestedArrays=function t(e,n,r){if(!Array.isArray(e[0]))return!0;for(var i=0;i<e.length;i++)if(t(e[i],[].concat(function(t){if(Array.isArray(t))return h(t)}(o=n)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(o)||c(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[i]),r)){r(e,n);break}var o;return!1},e.generatePointsParallelToLinePoints=function(t,e,n){var a={type:"LineString",coordinates:[t,e]},l=(0,s.point)(n),u=(0,o.default)(l,a),c=(0,i.default)(t,e),h=(n[0]-t[0])*(e[1]-t[1])-(n[1]-t[1])*(e[0]-t[0])<0?c-90:c-270,p=(0,r.default)(e,u,h),f=(0,r.default)(t,u,h);return[p.geometry.coordinates,f.geometry.coordinates]},e.distance2d=p,e.mix=f,e.nearestPointOnProjectedLine=function(t,e,n){var r=new a.default(n),i=t.geometry.coordinates.map((function(t){var e=u(t,3),n=e[0],i=e[1],o=e[2],s=void 0===o?0:o;return r.project([n,i,s])})),o=u(r.project(e.geometry.coordinates),2),s=o[0],l=o[1],c=1/0,h={};i.forEach((function(t,e){var n=u(t,2),r=n[0],o=n[1];if(0!==e){var a=u(i[e-1],2),p=a[0],f=a[1],d=f-o,g=r-p,m=p*o-r*f,A=d*d+g*g,y=Math.abs(d*s+g*l+m)/Math.sqrt(A);y<c&&(c=y,h={index:e,x0:(g*(g*s-d*l)-d*m)/A,y0:(d*(-g*s+d*l)-g*m)/A})}}));var d=h,g=d.index,m=d.x0,A=d.y0,y=u(i[g-1],3),_=y[0],v=y[1],b=y[2],x=void 0===b?0:b,w=u(i[g],3),E=w[0],S=w[1],T=w[2],P=void 0===T?0:T,M=p(_,v,E,S),C=f(x,P,p(_,v,m,A)/M);return{type:"Feature",geometry:{type:"Point",coordinates:r.unproject([m,A,C])},properties:{dist:c,index:g-1}}};var r=l(n(3737)),i=l(n(1208)),o=l(n(3892)),s=n(4102),a=l(n(4235));function l(t){return t&&t.__esModule?t:{default:t}}function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(t,e)||c(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){if(t){if("string"==typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function p(t,e,n,r){var i=t-n,o=e-r;return Math.sqrt(i*i+o*o)}function f(t,e,n){return e*n+t*(1-n)}},701:(t,e,n)=>{"use strict";n.r(e),n.d(e,{v1:()=>f,v3:()=>b,v4:()=>x,v5:()=>S});var r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),i=new Uint8Array(16);function o(){if(!r)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(i)}for(var s=[],a=0;a<256;++a)s[a]=(a+256).toString(16).substr(1);const l=function(t,e){var n=e||0,r=s;return[r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]]].join("")};var u,c,h=0,p=0;const f=function(t,e,n){var r=e&&n||0,i=e||[],s=(t=t||{}).node||u,a=void 0!==t.clockseq?t.clockseq:c;if(null==s||null==a){var f=t.random||(t.rng||o)();null==s&&(s=u=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==a&&(a=c=16383&(f[6]<<8|f[7]))}var d=void 0!==t.msecs?t.msecs:(new Date).getTime(),g=void 0!==t.nsecs?t.nsecs:p+1,m=d-h+(g-p)/1e4;if(m<0&&void 0===t.clockseq&&(a=a+1&16383),(m<0||d>h)&&void 0===t.nsecs&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");h=d,p=g,c=a;var A=(1e4*(268435455&(d+=122192928e5))+g)%4294967296;i[r++]=A>>>24&255,i[r++]=A>>>16&255,i[r++]=A>>>8&255,i[r++]=255&A;var y=d/4294967296*1e4&268435455;i[r++]=y>>>8&255,i[r++]=255&y,i[r++]=y>>>24&15|16,i[r++]=y>>>16&255,i[r++]=a>>>8|128,i[r++]=255&a;for(var _=0;_<6;++_)i[r+_]=s[_];return e||l(i)};function d(t,e,n){var r=function(t,r,i,o){var s=i&&o||0;if("string"==typeof t&&(t=function(t){t=unescape(encodeURIComponent(t));for(var e=new Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(t)),"string"==typeof r&&(r=function(t){var e=[];return t.replace(/[a-fA-F0-9]{2}/g,(function(t){e.push(parseInt(t,16))})),e}(r)),!Array.isArray(t))throw TypeError("value must be an array of bytes");if(!Array.isArray(r)||16!==r.length)throw TypeError("namespace must be uuid string or an Array of 16 byte values");var a=n(r.concat(t));if(a[6]=15&a[6]|e,a[8]=63&a[8]|128,i)for(var u=0;u<16;++u)i[s+u]=a[u];return i||l(a)};try{r.name=t}catch(t){}return r.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",r.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",r}function g(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function m(t,e,n,r,i,o){return g((s=g(g(e,t),g(r,o)))<<(a=i)|s>>>32-a,n);var s,a}function A(t,e,n,r,i,o,s){return m(e&n|~e&r,t,e,i,o,s)}function y(t,e,n,r,i,o,s){return m(e&r|n&~r,t,e,i,o,s)}function _(t,e,n,r,i,o,s){return m(e^n^r,t,e,i,o,s)}function v(t,e,n,r,i,o,s){return m(n^(e|~r),t,e,i,o,s)}const b=d("v3",48,(function(t){if("string"==typeof t){var e=unescape(encodeURIComponent(t));t=new Array(e.length);for(var n=0;n<e.length;n++)t[n]=e.charCodeAt(n)}return function(t){var e,n,r,i=[],o=32*t.length,s="0123456789abcdef";for(e=0;e<o;e+=8)n=t[e>>5]>>>e%32&255,r=parseInt(s.charAt(n>>>4&15)+s.charAt(15&n),16),i.push(r);return i}(function(t,e){var n,r,i,o,s;t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;var a=1732584193,l=-271733879,u=-1732584194,c=271733878;for(n=0;n<t.length;n+=16)r=a,i=l,o=u,s=c,a=A(a,l,u,c,t[n],7,-680876936),c=A(c,a,l,u,t[n+1],12,-389564586),u=A(u,c,a,l,t[n+2],17,606105819),l=A(l,u,c,a,t[n+3],22,-1044525330),a=A(a,l,u,c,t[n+4],7,-176418897),c=A(c,a,l,u,t[n+5],12,1200080426),u=A(u,c,a,l,t[n+6],17,-1473231341),l=A(l,u,c,a,t[n+7],22,-45705983),a=A(a,l,u,c,t[n+8],7,1770035416),c=A(c,a,l,u,t[n+9],12,-1958414417),u=A(u,c,a,l,t[n+10],17,-42063),l=A(l,u,c,a,t[n+11],22,-1990404162),a=A(a,l,u,c,t[n+12],7,1804603682),c=A(c,a,l,u,t[n+13],12,-40341101),u=A(u,c,a,l,t[n+14],17,-1502002290),a=y(a,l=A(l,u,c,a,t[n+15],22,1236535329),u,c,t[n+1],5,-165796510),c=y(c,a,l,u,t[n+6],9,-1069501632),u=y(u,c,a,l,t[n+11],14,643717713),l=y(l,u,c,a,t[n],20,-373897302),a=y(a,l,u,c,t[n+5],5,-701558691),c=y(c,a,l,u,t[n+10],9,38016083),u=y(u,c,a,l,t[n+15],14,-660478335),l=y(l,u,c,a,t[n+4],20,-405537848),a=y(a,l,u,c,t[n+9],5,568446438),c=y(c,a,l,u,t[n+14],9,-1019803690),u=y(u,c,a,l,t[n+3],14,-187363961),l=y(l,u,c,a,t[n+8],20,1163531501),a=y(a,l,u,c,t[n+13],5,-1444681467),c=y(c,a,l,u,t[n+2],9,-51403784),u=y(u,c,a,l,t[n+7],14,1735328473),a=_(a,l=y(l,u,c,a,t[n+12],20,-1926607734),u,c,t[n+5],4,-378558),c=_(c,a,l,u,t[n+8],11,-2022574463),u=_(u,c,a,l,t[n+11],16,1839030562),l=_(l,u,c,a,t[n+14],23,-35309556),a=_(a,l,u,c,t[n+1],4,-1530992060),c=_(c,a,l,u,t[n+4],11,1272893353),u=_(u,c,a,l,t[n+7],16,-155497632),l=_(l,u,c,a,t[n+10],23,-1094730640),a=_(a,l,u,c,t[n+13],4,681279174),c=_(c,a,l,u,t[n],11,-358537222),u=_(u,c,a,l,t[n+3],16,-722521979),l=_(l,u,c,a,t[n+6],23,76029189),a=_(a,l,u,c,t[n+9],4,-640364487),c=_(c,a,l,u,t[n+12],11,-421815835),u=_(u,c,a,l,t[n+15],16,530742520),a=v(a,l=_(l,u,c,a,t[n+2],23,-995338651),u,c,t[n],6,-198630844),c=v(c,a,l,u,t[n+7],10,1126891415),u=v(u,c,a,l,t[n+14],15,-1416354905),l=v(l,u,c,a,t[n+5],21,-57434055),a=v(a,l,u,c,t[n+12],6,1700485571),c=v(c,a,l,u,t[n+3],10,-1894986606),u=v(u,c,a,l,t[n+10],15,-1051523),l=v(l,u,c,a,t[n+1],21,-2054922799),a=v(a,l,u,c,t[n+8],6,1873313359),c=v(c,a,l,u,t[n+15],10,-30611744),u=v(u,c,a,l,t[n+6],15,-1560198380),l=v(l,u,c,a,t[n+13],21,1309151649),a=v(a,l,u,c,t[n+4],6,-145523070),c=v(c,a,l,u,t[n+11],10,-1120210379),u=v(u,c,a,l,t[n+2],15,718787259),l=v(l,u,c,a,t[n+9],21,-343485551),a=g(a,r),l=g(l,i),u=g(u,o),c=g(c,s);return[a,l,u,c]}(function(t){var e,n=[];for(n[(t.length>>2)-1]=void 0,e=0;e<n.length;e+=1)n[e]=0;var r=8*t.length;for(e=0;e<r;e+=8)n[e>>5]|=(255&t[e/8])<<e%32;return n}(t),8*t.length))})),x=function(t,e,n){var r=e&&n||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var i=(t=t||{}).random||(t.rng||o)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e)for(var s=0;s<16;++s)e[r+s]=i[s];return e||l(i)};function w(t,e,n,r){switch(t){case 0:return e&n^~e&r;case 1:case 3:return e^n^r;case 2:return e&n^e&r^n&r}}function E(t,e){return t<<e|t>>>32-e}const S=d("v5",80,(function(t){var e=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof t){var r=unescape(encodeURIComponent(t));t=new Array(r.length);for(var i=0;i<r.length;i++)t[i]=r.charCodeAt(i)}t.push(128);var o=t.length/4+2,s=Math.ceil(o/16),a=new Array(s);for(i=0;i<s;i++){a[i]=new Array(16);for(var l=0;l<16;l++)a[i][l]=t[64*i+4*l]<<24|t[64*i+4*l+1]<<16|t[64*i+4*l+2]<<8|t[64*i+4*l+3]}for(a[s-1][14]=8*(t.length-1)/Math.pow(2,32),a[s-1][14]=Math.floor(a[s-1][14]),a[s-1][15]=8*(t.length-1)&4294967295,i=0;i<s;i++){for(var u=new Array(80),c=0;c<16;c++)u[c]=a[i][c];for(c=16;c<80;c++)u[c]=E(u[c-3]^u[c-8]^u[c-14]^u[c-16],1);var h=n[0],p=n[1],f=n[2],d=n[3],g=n[4];for(c=0;c<80;c++){var m=Math.floor(c/20),A=E(h,5)+w(m,p,f,d)+g+e[m]+u[c]>>>0;g=d,d=f,f=E(p,30)>>>0,p=h,h=A}n[0]=n[0]+h>>>0,n[1]=n[1]+p>>>0,n[2]=n[2]+f>>>0,n[3]=n[3]+d>>>0,n[4]=n[4]+g>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]}))},7418:t=>{"use strict";var e=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function i(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,o){for(var s,a,l=i(t),u=1;u<arguments.length;u++){for(var c in s=Object(arguments[u]))n.call(s,c)&&(l[c]=s[c]);if(e){a=e(s);for(var h=0;h<a.length;h++)r.call(s,a[h])&&(l[a[h]]=s[a[h]])}}return l}},4244:t=>{"use strict";var e=function(t){return t!=t};t.exports=function(t,n){return 0===t&&0===n?1/t==1/n:t===n||!(!e(t)||!e(n))}},609:(t,e,n)=>{"use strict";var r=n(4289),i=n(5559),o=n(4244),s=n(5624),a=n(2281),l=i(s(),Object);r(l,{getPolyfill:s,implementation:o,shim:a}),t.exports=l},5624:(t,e,n)=>{"use strict";var r=n(4244);t.exports=function(){return"function"==typeof Object.is?Object.is:r}},2281:(t,e,n)=>{"use strict";var r=n(5624),i=n(4289);t.exports=function(){var t=r();return i(Object,{is:t},{is:function(){return Object.is!==t}}),t}},8987:(t,e,n)=>{"use strict";var r;if(!Object.keys){var i=Object.prototype.hasOwnProperty,o=Object.prototype.toString,s=n(1414),a=Object.prototype.propertyIsEnumerable,l=!a.call({toString:null},"toString"),u=a.call((function(){}),"prototype"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],h=function(t){var e=t.constructor;return e&&e.prototype===t},p={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},f=function(){if("undefined"==typeof window)return!1;for(var t in window)try{if(!p["$"+t]&&i.call(window,t)&&null!==window[t]&&"object"==typeof window[t])try{h(window[t])}catch(t){return!0}}catch(t){return!0}return!1}();r=function(t){var e=null!==t&&"object"==typeof t,n="[object Function]"===o.call(t),r=s(t),a=e&&"[object String]"===o.call(t),p=[];if(!e&&!n&&!r)throw new TypeError("Object.keys called on a non-object");var d=u&&n;if(a&&t.length>0&&!i.call(t,0))for(var g=0;g<t.length;++g)p.push(String(g));if(r&&t.length>0)for(var m=0;m<t.length;++m)p.push(String(m));else for(var A in t)d&&"prototype"===A||!i.call(t,A)||p.push(String(A));if(l)for(var y=function(t){if("undefined"==typeof window||!f)return h(t);try{return h(t)}catch(t){return!1}}(t),_=0;_<c.length;++_)y&&"constructor"===c[_]||!i.call(t,c[_])||p.push(c[_]);return p}}t.exports=r},2215:(t,e,n)=>{"use strict";var r=Array.prototype.slice,i=n(1414),o=Object.keys,s=o?function(t){return o(t)}:n(8987),a=Object.keys;s.shim=function(){if(Object.keys){var t=function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2);t||(Object.keys=function(t){return i(t)?a(r.call(t)):a(t)})}else Object.keys=s;return Object.keys||s},t.exports=s},1414:t=>{"use strict";var e=Object.prototype.toString;t.exports=function(t){var n=e.call(t),r="[object Arguments]"===n;return r||(r="[object Array]"!==n&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===e.call(t.callee)),r}},3614:(t,e,n)=>{"use strict";t.exports=i;var r=n(645);function i(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;var o=4294967296,s=1/o,a="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function l(t){return t.type===i.Bytes?t.readVarint()+t.pos:t.pos+1}function u(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function c(t,e,n){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(r);for(var i=n.pos-1;i>=t;i--)n.buf[i+r]=n.buf[i]}function h(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function p(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function f(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function d(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function g(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function m(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function A(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function y(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function _(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function v(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function b(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function x(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}i.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),i=r>>3,o=this.pos;this.type=7&r,t(i,e,this),this.pos===o&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=v(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=x(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=v(this.buf,this.pos)+v(this.buf,this.pos+4)*o;return this.pos+=8,t},readSFixed64:function(){var t=v(this.buf,this.pos)+x(this.buf,this.pos+4)*o;return this.pos+=8,t},readFloat:function(){var t=r.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=r.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,r=this.buf;return e=127&(n=r[this.pos++]),n<128?e:(e|=(127&(n=r[this.pos++]))<<7,n<128?e:(e|=(127&(n=r[this.pos++]))<<14,n<128?e:(e|=(127&(n=r[this.pos++]))<<21,n<128?e:function(t,e,n){var r,i,o=n.buf;if(r=(112&(i=o[n.pos++]))>>4,i<128)return u(t,r,e);if(r|=(127&(i=o[n.pos++]))<<3,i<128)return u(t,r,e);if(r|=(127&(i=o[n.pos++]))<<10,i<128)return u(t,r,e);if(r|=(127&(i=o[n.pos++]))<<17,i<128)return u(t,r,e);if(r|=(127&(i=o[n.pos++]))<<24,i<128)return u(t,r,e);if(r|=(1&(i=o[n.pos++]))<<31,i<128)return u(t,r,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=r[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&a?function(t,e,n){return a.decode(t.subarray(e,n))}(this.buf,e,t):function(t,e,n){for(var r="",i=e;i<n;){var o,s,a,l=t[i],u=null,c=l>239?4:l>223?3:l>191?2:1;if(i+c>n)break;1===c?l<128&&(u=l):2===c?128==(192&(o=t[i+1]))&&(u=(31&l)<<6|63&o)<=127&&(u=null):3===c?(o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&((u=(15&l)<<12|(63&o)<<6|63&s)<=2047||u>=55296&&u<=57343)&&(u=null)):4===c&&(o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&((u=(15&l)<<18|(63&o)<<12|(63&s)<<6|63&a)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,c=1):u>65535&&(u-=65536,r+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),r+=String.fromCharCode(u),i+=c}return r}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==i.Bytes)return t.push(this.readVarint(e));var n=l(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==i.Bytes)return t.push(this.readSVarint());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==i.Bytes)return t.push(this.readBoolean());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==i.Bytes)return t.push(this.readFloat());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==i.Bytes)return t.push(this.readDouble());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==i.Bytes)return t.push(this.readFixed32());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==i.Bytes)return t.push(this.readSFixed32());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==i.Bytes)return t.push(this.readFixed64());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==i.Bytes)return t.push(this.readSFixed64());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===i.Varint)for(;this.buf[this.pos++]>127;);else if(e===i.Bytes)this.pos=this.readVarint()+this.pos;else if(e===i.Fixed32)this.pos+=4;else{if(e!==i.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),b(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),b(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),b(this.buf,-1&t,this.pos),b(this.buf,Math.floor(t*s),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),b(this.buf,-1&t,this.pos),b(this.buf,Math.floor(t*s),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,r;if(t>=0?(n=t%4294967296|0,r=t/4294967296|0):(r=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,r=r+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos]=127&t}(n,0,e),function(t,e){var n=(7&t)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(r,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var r,i,o=0;o<e.length;o++){if((r=e.charCodeAt(o))>55295&&r<57344){if(!i){r>56319||o+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):i=r;continue}if(r<56320){t[n++]=239,t[n++]=191,t[n++]=189,i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&(t[n++]=239,t[n++]=191,t[n++]=189,i=null);r<128?t[n++]=r:(r<2048?t[n++]=r>>6|192:(r<65536?t[n++]=r>>12|224:(t[n++]=r>>18|240,t[n++]=r>>12&63|128),t[n++]=r>>6&63|128),t[n++]=63&r|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&c(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),r.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),r.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var r=this.pos-n;r>=128&&c(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,n){this.writeTag(t,i.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,h,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,p,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,g,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,f,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,d,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,m,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,A,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,y,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,_,e)},writeBytesField:function(t,e){this.writeTag(t,i.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,i.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,i.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,i.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}},1895:t=>{t.exports=function(t,e,n,r){var i=t[0],o=t[1],s=!1;void 0===n&&(n=0),void 0===r&&(r=e.length);for(var a=(r-n)/2,l=0,u=a-1;l<a;u=l++){var c=e[n+2*l+0],h=e[n+2*l+1],p=e[n+2*u+0],f=e[n+2*u+1];h>o!=f>o&&i<(p-c)*(o-h)/(f-h)+c&&(s=!s)}return s}},6960:(t,e,n)=>{var r=n(1895),i=n(8139);t.exports=function(t,e,n,o){return e.length>0&&Array.isArray(e[0])?i(t,e,n,o):r(t,e,n,o)},t.exports.nested=i,t.exports.flat=r},8139:t=>{t.exports=function(t,e,n,r){var i=t[0],o=t[1],s=!1;void 0===n&&(n=0),void 0===r&&(r=e.length);for(var a=r-n,l=0,u=a-1;l<a;u=l++){var c=e[l+n][0],h=e[l+n][1],p=e[u+n][0],f=e[u+n][1];h>o!=f>o&&i<(p-c)*(o-h)/(f-h)+c&&(s=!s)}return s}},2676:function(t){t.exports=function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function n(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}var r=function(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null};function i(t,e){return t>e?1:t<e?-1:0}function o(t,e,n){for(var i=new r(null,null),o=i,s=i;;){var a=n(t,e.key);if(a<0){if(null===e.left)break;if(n(t,e.left.key)<0){var l=e.left;if(e.left=l.right,l.right=e,null===(e=l).left)break}s.left=e,s=e,e=e.left}else{if(!(a>0))break;if(null===e.right)break;if(n(t,e.right.key)>0&&(l=e.right,e.right=l.left,l.left=e,null===(e=l).right))break;o.right=e,o=e,e=e.right}}return o.right=e.left,s.left=e.right,e.left=i.right,e.right=i.left,e}function s(t,e,n,i){var s=new r(t,e);if(null===n)return s.left=s.right=null,s;var a=i(t,(n=o(t,n,i)).key);return a<0?(s.left=n.left,s.right=n,n.left=null):a>=0&&(s.right=n.right,s.left=n,n.right=null),s}function a(t,e,n){var r=null,i=null;if(e){var s=n((e=o(t,e,n)).key,t);0===s?(r=e.left,i=e.right):s<0?(i=e.right,e.right=null,r=e):(r=e.left,e.left=null,i=e)}return{left:r,right:i}}function l(t,e,n,r,i){if(t){r(e+(n?" ":" ")+i(t)+"\n");var o=e+(n?"    ":"   ");t.left&&l(t.left,o,!1,r,i),t.right&&l(t.right,o,!0,r,i)}}var u=function(){function t(t){void 0===t&&(t=i),this._root=null,this._size=0,this._comparator=t}return t.prototype.insert=function(t,e){return this._size++,this._root=s(t,e,this._root,this._comparator)},t.prototype.add=function(t,e){var n=new r(t,e);null===this._root&&(n.left=n.right=null,this._size++,this._root=n);var i=this._comparator,s=o(t,this._root,i),a=i(t,s.key);return 0===a?this._root=s:(a<0?(n.left=s.left,n.right=s,s.left=null):a>0&&(n.right=s.right,n.left=s,s.right=null),this._size++,this._root=n),this._root},t.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},t.prototype._remove=function(t,e,n){var r;return null===e?null:0===n(t,(e=o(t,e,n)).key)?(null===e.left?r=e.right:(r=o(t,e.left,n)).right=e.right,this._size--,r):e},t.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=o(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},t.prototype.findStatic=function(t){for(var e=this._root,n=this._comparator;e;){var r=n(t,e.key);if(0===r)return e;e=r<0?e.left:e.right}return null},t.prototype.find=function(t){return this._root&&(this._root=o(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},t.prototype.contains=function(t){for(var e=this._root,n=this._comparator;e;){var r=n(t,e.key);if(0===r)return!0;e=r<0?e.left:e.right}return!1},t.prototype.forEach=function(t,e){for(var n=this._root,r=[],i=!1;!i;)null!==n?(r.push(n),n=n.left):0!==r.length?(n=r.pop(),t.call(e,n),n=n.right):i=!0;return this},t.prototype.range=function(t,e,n,r){for(var i=[],o=this._comparator,s=this._root;0!==i.length||s;)if(s)i.push(s),s=s.left;else{if(o((s=i.pop()).key,e)>0)break;if(o(s.key,t)>=0&&n.call(r,s))return this;s=s.right}return this},t.prototype.keys=function(){var t=[];return this.forEach((function(e){var n=e.key;return t.push(n)})),t},t.prototype.values=function(){var t=[];return this.forEach((function(e){var n=e.data;return t.push(n)})),t},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},t.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},t.prototype.at=function(t){for(var e=this._root,n=!1,r=0,i=[];!n;)if(e)i.push(e),e=e.left;else if(i.length>0){if(e=i.pop(),r===t)return e;r++,e=e.right}else n=!0;return null},t.prototype.next=function(t){var e=this._root,n=null;if(t.right){for(n=t.right;n.left;)n=n.left;return n}for(var r=this._comparator;e;){var i=r(t.key,e.key);if(0===i)break;i<0?(n=e,e=e.left):e=e.right}return n},t.prototype.prev=function(t){var e=this._root,n=null;if(null!==t.left){for(n=t.left;n.right;)n=n.right;return n}for(var r=this._comparator;e;){var i=r(t.key,e.key);if(0===i)break;i<0?e=e.left:(n=e,e=e.right)}return n},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return function(t){for(var e=t,n=[],i=!1,o=new r(null,null),s=o;!i;)e?(n.push(e),e=e.left):n.length>0?e=(e=s=s.next=n.pop()).right:i=!0;return s.next=null,o.next}(this._root)},t.prototype.load=function(t,e,n){void 0===e&&(e=[]),void 0===n&&(n=!1);var i=t.length,o=this._comparator;if(n&&p(t,e,0,i-1,o),null===this._root)this._root=c(t,e,0,i),this._size=i;else{var s=function(t,e,n){for(var i=new r(null,null),o=i,s=t,a=e;null!==s&&null!==a;)n(s.key,a.key)<0?(o.next=s,s=s.next):(o.next=a,a=a.next),o=o.next;return null!==s?o.next=s:null!==a&&(o.next=a),i.next}(this.toList(),function(t,e){for(var n=new r(null,null),i=n,o=0;o<t.length;o++)i=i.next=new r(t[o],e[o]);return i.next=null,n.next}(t,e),o);i=this._size+i,this._root=h({head:s},0,i)}return this},t.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){void 0===t&&(t=function(t){return String(t.key)});var e=[];return l(this._root,"",!0,(function(t){return e.push(t)}),t),e.join("")},t.prototype.update=function(t,e,n){var r=this._comparator,i=a(t,this._root,r),l=i.left,u=i.right;r(t,e)<0?u=s(e,n,u,r):l=s(e,n,l,r),this._root=function(t,e,n){return null===e?t:(null===t||((e=o(t.key,e,n)).left=t),e)}(l,u,r)},t.prototype.split=function(t){return a(t,this._root,this._comparator)},t}();function c(t,e,n,i){var o=i-n;if(o>0){var s=n+Math.floor(o/2),a=t[s],l=e[s],u=new r(a,l);return u.left=c(t,e,n,s),u.right=c(t,e,s+1,i),u}return null}function h(t,e,n){var r=n-e;if(r>0){var i=e+Math.floor(r/2),o=h(t,e,i),s=t.head;return s.left=o,t.head=t.head.next,s.right=h(t,i+1,n),s}return null}function p(t,e,n,r,i){if(!(n>=r)){for(var o=t[n+r>>1],s=n-1,a=r+1;;){do{s++}while(i(t[s],o)<0);do{a--}while(i(t[a],o)>0);if(s>=a)break;var l=t[s];t[s]=t[a],t[a]=l,l=e[s],e[s]=e[a],e[a]=l}p(t,e,n,a,i),p(t,e,a+1,r,i)}}var f=function(t,e){return t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y},d=function(t,e){if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;var n=t.ll.x<e.ll.x?e.ll.x:t.ll.x,r=t.ur.x<e.ur.x?t.ur.x:e.ur.x;return{ll:{x:n,y:t.ll.y<e.ll.y?e.ll.y:t.ll.y},ur:{x:r,y:t.ur.y<e.ur.y?t.ur.y:e.ur.y}}},g=Number.EPSILON;void 0===g&&(g=Math.pow(2,-52));var m=g*g,A=function(t,e){if(-g<t&&t<g&&-g<e&&e<g)return 0;var n=t-e;return n*n<m*t*e?0:t<e?-1:1},y=function(){function e(){t(this,e),this.reset()}return n(e,[{key:"reset",value:function(){this.xRounder=new _,this.yRounder=new _}},{key:"round",value:function(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}}]),e}(),_=function(){function e(){t(this,e),this.tree=new u,this.round(0)}return n(e,[{key:"round",value:function(t){var e=this.tree.add(t),n=this.tree.prev(e);if(null!==n&&0===A(e.key,n.key))return this.tree.remove(t),n.key;var r=this.tree.next(e);return null!==r&&0===A(e.key,r.key)?(this.tree.remove(t),r.key):t}}]),e}(),v=new y,b=function(t,e){return t.x*e.y-t.y*e.x},x=function(t,e){return t.x*e.x+t.y*e.y},w=function(t,e,n){var r={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y},o=b(r,i);return A(o,0)},E=function(t){return Math.sqrt(x(t,t))},S=function(t,e,n){var r={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y};return x(i,r)/E(i)/E(r)},T=function(t,e,n){return 0===e.y?null:{x:t.x+e.x/e.y*(n-t.y),y:n}},P=function(t,e,n){return 0===e.x?null:{x:n,y:t.y+e.y/e.x*(n-t.x)}},M=function(){function e(n,r){t(this,e),void 0===n.events?n.events=[this]:n.events.push(this),this.point=n,this.isLeft=r}return n(e,null,[{key:"compare",value:function(t,n){var r=e.comparePoints(t.point,n.point);return 0!==r?r:(t.point!==n.point&&t.link(n),t.isLeft!==n.isLeft?t.isLeft?1:-1:I.compare(t.segment,n.segment))}},{key:"comparePoints",value:function(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}}]),n(e,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var e=t.point.events,n=0,r=e.length;n<r;n++){var i=e[n];this.point.events.push(i),i.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,e=0;e<t;e++){var n=this.point.events[e];if(void 0===n.segment.consumedBy)for(var r=e+1;r<t;r++){var i=this.point.events[r];void 0===i.consumedBy&&n.otherSE.point.events===i.otherSE.point.events&&n.segment.consume(i.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],e=0,n=this.point.events.length;e<n;e++){var r=this.point.events[e];r!==this&&!r.segment.ringOut&&r.segment.isInResult()&&t.push(r)}return t}},{key:"getLeftmostComparator",value:function(t){var e=this,n=new Map,r=function(r){var i,o,s,a,l,u=r.otherSE;n.set(r,{sine:(i=e.point,o=t.point,s=u.point,a={x:o.x-i.x,y:o.y-i.y},l={x:s.x-i.x,y:s.y-i.y},b(l,a)/E(l)/E(a)),cosine:S(e.point,t.point,u.point)})};return function(t,e){n.has(t)||r(t),n.has(e)||r(e);var i=n.get(t),o=i.sine,s=i.cosine,a=n.get(e),l=a.sine,u=a.cosine;return o>=0&&l>=0?s<u?1:s>u?-1:0:o<0&&l<0?s<u?-1:s>u?1:0:l<o?-1:l>o?1:0}}}]),e}(),C=0,I=function(){function e(n,r,i,o){t(this,e),this.id=++C,this.leftSE=n,n.segment=this,n.otherSE=r,this.rightSE=r,r.segment=this,r.otherSE=n,this.rings=i,this.windings=o}return n(e,null,[{key:"compare",value:function(t,e){var n=t.leftSE.point.x,r=e.leftSE.point.x,i=t.rightSE.point.x,o=e.rightSE.point.x;if(o<n)return 1;if(i<r)return-1;var s=t.leftSE.point.y,a=e.leftSE.point.y,l=t.rightSE.point.y,u=e.rightSE.point.y;if(n<r){if(a<s&&a<l)return 1;if(a>s&&a>l)return-1;var c=t.comparePoint(e.leftSE.point);if(c<0)return 1;if(c>0)return-1;var h=e.comparePoint(t.rightSE.point);return 0!==h?h:-1}if(n>r){if(s<a&&s<u)return-1;if(s>a&&s>u)return 1;var p=e.comparePoint(t.leftSE.point);if(0!==p)return p;var f=t.comparePoint(e.rightSE.point);return f<0?1:f>0?-1:1}if(s<a)return-1;if(s>a)return 1;if(i<o){var d=e.comparePoint(t.rightSE.point);if(0!==d)return d}if(i>o){var g=t.comparePoint(e.rightSE.point);if(g<0)return 1;if(g>0)return-1}if(i!==o){var m=l-s,A=i-n,y=u-a,_=o-r;if(m>A&&y<_)return 1;if(m<A&&y>_)return-1}return i>o?1:i<o||l<u?-1:l>u?1:t.id<e.id?-1:t.id>e.id?1:0}}]),n(e,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var e=this.leftSE.point,n=this.rightSE.point,r=this.vector();if(e.x===n.x)return t.x===e.x?0:t.x<e.x?1:-1;var i=(t.y-e.y)/r.y,o=e.x+i*r.x;if(t.x===o)return 0;var s=(t.x-e.x)/r.x,a=e.y+s*r.y;return t.y===a?0:t.y<a?-1:1}},{key:"getIntersection",value:function(t){var e=this.bbox(),n=t.bbox(),r=d(e,n);if(null===r)return null;var i=this.leftSE.point,o=this.rightSE.point,s=t.leftSE.point,a=t.rightSE.point,l=f(e,s)&&0===this.comparePoint(s),u=f(n,i)&&0===t.comparePoint(i),c=f(e,a)&&0===this.comparePoint(a),h=f(n,o)&&0===t.comparePoint(o);if(u&&l)return h&&!c?o:!h&&c?a:null;if(u)return c&&i.x===a.x&&i.y===a.y?null:i;if(l)return h&&o.x===s.x&&o.y===s.y?null:s;if(h&&c)return null;if(h)return o;if(c)return a;var p=function(t,e,n,r){if(0===e.x)return P(n,r,t.x);if(0===r.x)return P(t,e,n.x);if(0===e.y)return T(n,r,t.y);if(0===r.y)return T(t,e,n.y);var i=b(e,r);if(0==i)return null;var o={x:n.x-t.x,y:n.y-t.y},s=b(o,e)/i,a=b(o,r)/i;return{x:(t.x+a*e.x+(n.x+s*r.x))/2,y:(t.y+a*e.y+(n.y+s*r.y))/2}}(i,this.vector(),s,t.vector());return null===p?null:f(r,p)?v.round(p.x,p.y):null}},{key:"split",value:function(t){var n=[],r=void 0!==t.events,i=new M(t,!0),o=new M(t,!1),s=this.rightSE;this.replaceRightSE(o),n.push(o),n.push(i);var a=new e(i,s,this.rings.slice(),this.windings.slice());return M.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),M.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),r&&(i.checkForConsuming(),o.checkForConsuming()),n}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var e=0,n=this.windings.length;e<n;e++)this.windings[e]*=-1}},{key:"consume",value:function(t){for(var n=this,r=t;n.consumedBy;)n=n.consumedBy;for(;r.consumedBy;)r=r.consumedBy;var i=e.compare(n,r);if(0!==i){if(i>0){var o=n;n=r,r=o}if(n.prev===r){var s=n;n=r,r=s}for(var a=0,l=r.rings.length;a<l;a++){var u=r.rings[a],c=r.windings[a],h=n.rings.indexOf(u);-1===h?(n.rings.push(u),n.windings.push(c)):n.windings[h]+=c}r.rings=null,r.windings=null,r.consumedBy=n,r.leftSE.consumedBy=n.leftSE,r.rightSE.consumedBy=n.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var e=this._afterState.rings,n=this._afterState.windings,r=this._afterState.multiPolys,i=0,o=this.rings.length;i<o;i++){var s=this.rings[i],a=this.windings[i],l=e.indexOf(s);-1===l?(e.push(s),n.push(a)):n[l]+=a}for(var u=[],c=[],h=0,p=e.length;h<p;h++)if(0!==n[h]){var f=e[h],d=f.poly;if(-1===c.indexOf(d))if(f.isExterior)u.push(d);else{-1===c.indexOf(d)&&c.push(d);var g=u.indexOf(f.poly);-1!==g&&u.splice(g,1)}}for(var m=0,A=u.length;m<A;m++){var y=u[m].multiPoly;-1===r.indexOf(y)&&r.push(y)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(j.type){case"union":var n=0===t.length,r=0===e.length;this._isInResult=n!==r;break;case"intersection":var i,o;t.length<e.length?(i=t.length,o=e.length):(i=e.length,o=t.length),this._isInResult=o===j.numMultiPolys&&i<o;break;case"xor":var s=Math.abs(t.length-e.length);this._isInResult=s%2==1;break;case"difference":var a=function(t){return 1===t.length&&t[0].isSubject};this._isInResult=a(t)!==a(e);break;default:throw new Error("Unrecognized operation type found ".concat(j.type))}return this._isInResult}}],[{key:"fromRing",value:function(t,n,r){var i,o,s,a=M.comparePoints(t,n);if(a<0)i=t,o=n,s=1;else{if(!(a>0))throw new Error("Tried to create degenerate segment at [".concat(t.x,", ").concat(t.y,"]"));i=n,o=t,s=-1}return new e(new M(i,!0),new M(o,!1),[r],[s])}}]),e}(),O=function(){function e(n,r,i){if(t(this,e),!Array.isArray(n)||0===n.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=r,this.isExterior=i,this.segments=[],"number"!=typeof n[0][0]||"number"!=typeof n[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var o=v.round(n[0][0],n[0][1]);this.bbox={ll:{x:o.x,y:o.y},ur:{x:o.x,y:o.y}};for(var s=o,a=1,l=n.length;a<l;a++){if("number"!=typeof n[a][0]||"number"!=typeof n[a][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var u=v.round(n[a][0],n[a][1]);u.x===s.x&&u.y===s.y||(this.segments.push(I.fromRing(s,u,this)),u.x<this.bbox.ll.x&&(this.bbox.ll.x=u.x),u.y<this.bbox.ll.y&&(this.bbox.ll.y=u.y),u.x>this.bbox.ur.x&&(this.bbox.ur.x=u.x),u.y>this.bbox.ur.y&&(this.bbox.ur.y=u.y),s=u)}o.x===s.x&&o.y===s.y||this.segments.push(I.fromRing(s,o,this))}return n(e,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,n=this.segments.length;e<n;e++){var r=this.segments[e];t.push(r.leftSE),t.push(r.rightSE)}return t}}]),e}(),R=function(){function e(n,r){if(t(this,e),!Array.isArray(n))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new O(n[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var i=1,o=n.length;i<o;i++){var s=new O(n[i],this,!1);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.interiorRings.push(s)}this.multiPoly=r}return n(e,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),e=0,n=this.interiorRings.length;e<n;e++)for(var r=this.interiorRings[e].getSweepEvents(),i=0,o=r.length;i<o;i++)t.push(r[i]);return t}}]),e}(),L=function(){function e(n,r){if(t(this,e),!Array.isArray(n))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof n[0][0][0]&&(n=[n])}catch(t){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var i=0,o=n.length;i<o;i++){var s=new R(n[i],this);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.polys.push(s)}this.isSubject=r}return n(e,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,n=this.polys.length;e<n;e++)for(var r=this.polys[e].getSweepEvents(),i=0,o=r.length;i<o;i++)t.push(r[i]);return t}}]),e}(),k=function(){function e(n){t(this,e),this.events=n;for(var r=0,i=n.length;r<i;r++)n[r].segment.ringOut=this;this.poly=null}return n(e,null,[{key:"factory",value:function(t){for(var n=[],r=0,i=t.length;r<i;r++){var o=t[r];if(o.isInResult()&&!o.ringOut){for(var s=null,a=o.leftSE,l=o.rightSE,u=[a],c=a.point,h=[];s=a,a=l,u.push(a),a.point!==c;)for(;;){var p=a.getAvailableLinkedEvents();if(0===p.length){var f=u[0].point,d=u[u.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(f.x,",")+" ".concat(f.y,"]. Last matching segment found ends at")+" [".concat(d.x,", ").concat(d.y,"]."))}if(1===p.length){l=p[0].otherSE;break}for(var g=null,m=0,A=h.length;m<A;m++)if(h[m].point===a.point){g=m;break}if(null===g){h.push({index:u.length,point:a.point});var y=a.getLeftmostComparator(s);l=p.sort(y)[0].otherSE;break}var _=h.splice(g)[0],v=u.splice(_.index);v.unshift(v[0].otherSE),n.push(new e(v.reverse()))}n.push(new e(u))}}return n}}]),n(e,[{key:"getGeom",value:function(){for(var t=this.events[0].point,e=[t],n=1,r=this.events.length-1;n<r;n++){var i=this.events[n].point,o=this.events[n+1].point;0!==w(i,t,o)&&(e.push(i),t=i)}if(1===e.length)return null;var s=e[0],a=e[1];0===w(s,t,a)&&e.shift(),e.push(e[0]);for(var l=this.isExteriorRing()?1:-1,u=this.isExteriorRing()?0:e.length-1,c=this.isExteriorRing()?e.length:-1,h=[],p=u;p!=c;p+=l)h.push([e[p].x,e[p].y]);return h}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],e=1,n=this.events.length;e<n;e++){var r=this.events[e];M.compare(t,r)>0&&(t=r)}for(var i=t.segment.prevInResult(),o=i?i.prevInResult():null;;){if(!i)return null;if(!o)return i.ringOut;if(o.ringOut!==i.ringOut)return o.ringOut.enclosingRing()!==i.ringOut?i.ringOut:i.ringOut.enclosingRing();i=o.prevInResult(),o=i?i.prevInResult():null}}}]),e}(),D=function(){function e(n){t(this,e),this.exteriorRing=n,n.poly=this,this.interiorRings=[]}return n(e,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(var e=0,n=this.interiorRings.length;e<n;e++){var r=this.interiorRings[e].getGeom();null!==r&&t.push(r)}return t}}]),e}(),N=function(){function e(n){t(this,e),this.rings=n,this.polys=this._composePolys(n)}return n(e,[{key:"getGeom",value:function(){for(var t=[],e=0,n=this.polys.length;e<n;e++){var r=this.polys[e].getGeom();null!==r&&t.push(r)}return t}},{key:"_composePolys",value:function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];if(!i.poly)if(i.isExteriorRing())e.push(new D(i));else{var o=i.enclosingRing();o.poly||e.push(new D(o)),o.poly.addInterior(i)}}return e}}]),e}(),F=function(){function e(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:I.compare;t(this,e),this.queue=n,this.tree=new u(r),this.segments=[]}return n(e,[{key:"process",value:function(t){var e=t.segment,n=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e),n;var r=t.isLeft?this.tree.insert(e):this.tree.find(e);if(!r)throw new Error("Unable to find segment #".concat(e.id," ")+"[".concat(e.leftSE.point.x,", ").concat(e.leftSE.point.y,"] -> ")+"[".concat(e.rightSE.point.x,", ").concat(e.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var i=r,o=r,s=void 0,a=void 0;void 0===s;)null===(i=this.tree.prev(i))?s=null:void 0===i.key.consumedBy&&(s=i.key);for(;void 0===a;)null===(o=this.tree.next(o))?a=null:void 0===o.key.consumedBy&&(a=o.key);if(t.isLeft){var l=null;if(s){var u=s.getIntersection(e);if(null!==u&&(e.isAnEndpoint(u)||(l=u),!s.isAnEndpoint(u)))for(var c=this._splitSafely(s,u),h=0,p=c.length;h<p;h++)n.push(c[h])}var f=null;if(a){var d=a.getIntersection(e);if(null!==d&&(e.isAnEndpoint(d)||(f=d),!a.isAnEndpoint(d)))for(var g=this._splitSafely(a,d),m=0,A=g.length;m<A;m++)n.push(g[m])}if(null!==l||null!==f){var y;y=null===l?f:null===f||M.comparePoints(l,f)<=0?l:f,this.queue.remove(e.rightSE),n.push(e.rightSE);for(var _=e.split(y),v=0,b=_.length;v<b;v++)n.push(_[v])}n.length>0?(this.tree.remove(e),n.push(t)):(this.segments.push(e),e.prev=s)}else{if(s&&a){var x=s.getIntersection(a);if(null!==x){if(!s.isAnEndpoint(x))for(var w=this._splitSafely(s,x),E=0,S=w.length;E<S;E++)n.push(w[E]);if(!a.isAnEndpoint(x))for(var T=this._splitSafely(a,x),P=0,C=T.length;P<C;P++)n.push(T[P])}}this.tree.remove(e)}return n}},{key:"_splitSafely",value:function(t,e){this.tree.remove(t);var n=t.rightSE;this.queue.remove(n);var r=t.split(e);return r.push(n),void 0===t.consumedBy&&this.tree.insert(t),r}}]),e}(),B="undefined"!=typeof process&&"MISSING_ENV_VAR".POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,z="undefined"!=typeof process&&"MISSING_ENV_VAR".POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,j=new(function(){function e(){t(this,e)}return n(e,[{key:"run",value:function(t,e,n){j.type=t,v.reset();for(var r=[new L(e,!0)],i=0,o=n.length;i<o;i++)r.push(new L(n[i],!1));if(j.numMultiPolys=r.length,"difference"===j.type)for(var s=r[0],a=1;a<r.length;)null!==d(r[a].bbox,s.bbox)?a++:r.splice(a,1);if("intersection"===j.type)for(var l=0,c=r.length;l<c;l++)for(var h=r[l],p=l+1,f=r.length;p<f;p++)if(null===d(h.bbox,r[p].bbox))return[];for(var g=new u(M.compare),m=0,A=r.length;m<A;m++)for(var y=r[m].getSweepEvents(),_=0,b=y.length;_<b;_++)if(g.insert(y[_]),g.size>B)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var x=new F(g),w=g.size,E=g.pop();E;){var S=E.key;if(g.size===w){var T=S.segment;throw new Error("Unable to pop() ".concat(S.isLeft?"left":"right"," SweepEvent ")+"[".concat(S.point.x,", ").concat(S.point.y,"] from segment #").concat(T.id," ")+"[".concat(T.leftSE.point.x,", ").concat(T.leftSE.point.y,"] -> ")+"[".concat(T.rightSE.point.x,", ").concat(T.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(g.size>B)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(x.segments.length>z)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var P=x.process(S),C=0,I=P.length;C<I;C++){var O=P[C];void 0===O.consumedBy&&g.insert(O)}w=g.size,E=g.pop()}v.reset();var R=k.factory(x.segments);return new N(R).getGeom()}}]),e}());return{union:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return j.run("union",t,n)},intersection:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return j.run("intersection",t,n)},xor:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return j.run("xor",t,n)},difference:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return j.run("difference",t,n)}}}()},8297:(t,e,n)=>{"use strict";var r=n(5318);Object.defineProperty(e,"__esModule",{value:!0}),e.isMobile=function(){return void 0!==i.window.orientation},e.default=function(t){if(!t&&!(0,o.default)())return"Node";if((0,s.default)(t))return"Electron";var e="undefined"!=typeof navigator?navigator:{},n=t||e.userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";var r=-1!==n.indexOf("MSIE "),a=-1!==n.indexOf("Trident/");return r||a?"IE":i.window.chrome?"Chrome":i.window.safari?"Safari":i.window.mozInnerScreenX?"Firefox":"Unknown"};var i=n(2361),o=r(n(2999)),s=r(n(3941))},2361:(t,e,n)=>{"use strict";var r=n(5318);Object.defineProperty(e,"__esModule",{value:!0}),e.console=e.process=e.document=e.global=e.window=e.self=void 0;var i=r(n(8)),o={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==n.g&&n.g,document:"undefined"!=typeof document&&document,process:"object"===("undefined"==typeof process?"undefined":(0,i.default)(process))&&process},s=o.self||o.window||o.global;e.self=s;var a=o.window||o.self||o.global;e.window=a;var l=o.global||o.self||o.window;e.global=l;var u=o.document||{};e.document=u;var c=o.process||{};e.process=c;var h=console;e.console=h},9718:(t,e,n)=>{"use strict";var r=n(5318),i=n(8);Object.defineProperty(e,"CO",{enumerable:!0,get:function(){return o.global}}),Object.defineProperty(e,"jU",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"qs",{enumerable:!0,get:function(){return a.default}});var o=n(2361),s=u(n(2999)),a=u(n(8297));r(n(3941));function l(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(l=function(t){return t?n:e})(t)}function u(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=l(e);if(n&&n.has(t))return n.get(t);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var a=o?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=t[s]}return r.default=t,n&&n.set(t,r),r}},2999:(t,e,n)=>{"use strict";var r=n(5318);Object.defineProperty(e,"__esModule",{value:!0}),e.default=s,e.isBrowserMainThread=function(){return s()&&"undefined"!=typeof document};var i=r(n(8)),o=r(n(3941));function s(){return!("object"===("undefined"==typeof process?"undefined":(0,i.default)(process))&&"[object process]"===String(process)&&!process.browser)||(0,o.default)()}},3941:(t,e,n)=>{"use strict";var r=n(5318);Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if("undefined"!=typeof window&&"object"===(0,i.default)(window.process)&&"renderer"===window.process.type)return!0;if("undefined"!=typeof process&&"object"===(0,i.default)(process.versions)&&Boolean(process.versions.electron))return!0;var e="object"===("undefined"==typeof navigator?"undefined":(0,i.default)(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)};var i=r(n(8))},6073:(t,e,n)=>{"use strict";n.d(e,{u9:()=>i,N4:()=>o});const r={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==n.g&&n.g,document:"undefined"!=typeof document&&document,process:"object"==typeof process&&process},i=r.window||r.self||r.global,o=r.process||{};console},5989:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var r=n(1202);function i(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||(0,r.Z)()}},1202:(t,e,n)=>{"use strict";function r(t){if("undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof process&&"object"==typeof process.versions&&Boolean(process.versions.electron))return!0;const e="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}n.d(e,{Z:()=>r})},4708:(t,e,n)=>{"use strict";n.d(e,{Z:()=>_});var r=n(5989);const i="undefined"!=typeof __VERSION__?__VERSION__:"untranspiled source",o=(0,r.Z)();class s{constructor(t,e,n="sessionStorage"){this.storage=function(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch(t){return null}}(n),this.id=t,this.config={},Object.assign(this.config,e),this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){return this.config={},this.updateConfiguration(t)}updateConfiguration(t){if(Object.assign(this.config,t),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}return this}_loadConfiguration(){let t={};if(this.storage){const e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}}function a(t,e,n,r=600){const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const o=t.width*n,s=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(s/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(s,"px;"),"background:url(".concat(i,");"),"background-size:".concat(o,"px ").concat(s,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}const l={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function u(t){return"string"==typeof t?l[t.toUpperCase()]||l.WHITE:t}function c(t,e){if(!t)throw new Error(e||"Assertion failed")}var h=n(6073);function p(){let t;if(o&&h.u9.performance)t=h.u9.performance.now();else if(h.N4.hrtime){const e=h.N4.hrtime();t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}const f={debug:o&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},d={enabled:!0,level:0};function g(){}const m={},A={once:!0};function y(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}class _{constructor({id:t}={id:""}){this.id=t,this.VERSION=i,this._startTs=p(),this._deltaTs=p(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new s("__probe-".concat(this.id,"__"),d),this.userData={},this.timeStamp("".concat(this.id," started")),function(t,e=["constructor"]){const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const n of r)"function"==typeof t[n]&&(e.find((t=>n===t))||(t[n]=t[n].bind(t)))}(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((p()-this._startTs).toPrecision(10))}getDelta(){return Number((p()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(t=!0){return this._storage.updateConfiguration({enabled:t}),this}setLevel(t){return this._storage.updateConfiguration({level:t}),this}assert(t,e){c(t,e)}warn(t){return this._getLogFunction(0,t,f.warn,arguments,A)}error(t){return this._getLogFunction(0,t,f.error,arguments)}deprecated(t,e){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(e,"` instead"))}removed(t,e){return this.error("`".concat(t,"` has been removed. Use `").concat(e,"` instead"))}probe(t,e){return this._getLogFunction(t,e,f.log,arguments,{time:!0,once:!0})}log(t,e){return this._getLogFunction(t,e,f.debug,arguments)}info(t,e){return this._getLogFunction(t,e,console.info,arguments)}once(t,e){return this._getLogFunction(t,e,f.debug||f.info,arguments,A)}table(t,e,n){return e?this._getLogFunction(t,e,console.table||g,n&&[n],{tag:y(e)}):g}image({logLevel:t,priority:e,image:r,message:i="",scale:s=1}){return this._shouldLog(t||e)?o?function({image:t,message:e="",scale:n=1}){if("string"==typeof t){const r=new Image;return r.onload=()=>{const t=a(r,e,n);console.log(...t)},r.src=t,g}const r=t.nodeName||"";if("img"===r.toLowerCase())return console.log(...a(t,e,n)),g;if("canvas"===r.toLowerCase()){const r=new Image;return r.onload=()=>console.log(...a(r,e,n)),r.src=t.toDataURL(),g}return g}({image:r,message:i,scale:s}):function({image:t,message:e="",scale:r=1}){let i=null;try{i=n(5307)}catch(t){}return i?()=>i(t,{fit:"box",width:"".concat(Math.round(80*r),"%")}).then((t=>console.log(t))):g}({image:r,message:i,scale:s}):g}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}get(t){return this._storage.config[t]}set(t,e){this._storage.updateConfiguration({[t]:e})}time(t,e){return this._getLogFunction(t,e,console.time?console.time:console.info)}timeEnd(t,e){return this._getLogFunction(t,e,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,e){return this._getLogFunction(t,e,console.timeStamp||g)}group(t,e,n={collapsed:!1}){n=b({logLevel:t,message:e,opts:n});const{collapsed:r}=n;return n.method=(r?console.groupCollapsed:console.group)||console.info,this._getLogFunction(n)}groupCollapsed(t,e,n={}){return this.group(t,e,Object.assign({},n,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||g)}withGroup(t,e,n){this.group(t,e)();try{n()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=v(t)}_getLogFunction(t,e,n,r=[],i){if(this._shouldLog(t)){i=b({logLevel:t,message:e,args:r,opts:i}),c(n=n||i.method),i.total=this.getTotal(),i.delta=this.getDelta(),this._deltaTs=p();const s=i.tag||i.message;if(i.once){if(m[s])return g;m[s]=p()}return e=function(t,e,n){if("string"==typeof e){const a=n.time?function(t,e=8){const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}(function(t){let e;return e=t<10?"".concat(t.toFixed(2),"ms"):t<100?"".concat(t.toFixed(1),"ms"):t<1e3?"".concat(t.toFixed(0),"ms"):"".concat((t/1e3).toFixed(2),"s"),e}(n.total)):"";r=e=n.time?"".concat(t,": ").concat(a,"  ").concat(e):"".concat(t,": ").concat(e),i=n.color,s=n.background,o||"string"!=typeof r||(i&&(i=u(i),r="[".concat(i,"m").concat(r,"[39m")),s&&(i=u(s),r="[".concat(s+10,"m").concat(r,"[49m"))),e=r}var r,i,s;return e}(this.id,i.message,i),n.bind(console,e,...i.args)}return g}}function v(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return c(Number.isFinite(e)&&e>=0),e}function b(t){const{logLevel:e,message:n}=t;t.logLevel=v(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(t.args=r,typeof e){case"string":case"function":void 0!==n&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e)}"function"==typeof t.message&&(t.message=t.message());const i=typeof t.message;return c("string"===i||"object"===i),Object.assign(t,t.opts)}_.VERSION=i},2703:(t,e,n)=>{"use strict";var r=n(414);function i(){}function o(){}o.resetWarningCache=i,t.exports=function(){function t(t,e,n,i,o,s){if(s!==r){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function e(){return t}t.isRequired=t;var n={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:o,resetWarningCache:i};return n.PropTypes=n,n}},5697:(t,e,n)=>{t.exports=n(2703)()},414:t=>{"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},2582:function(t){t.exports=function(){"use strict";function t(t,r,i,o,s){!function t(n,r,i,o,s){for(;o>i;){if(o-i>600){var a=o-i+1,l=r-i+1,u=Math.log(a),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(a-c)/a)*(l-a/2<0?-1:1);t(n,r,Math.max(i,Math.floor(r-l*c/a+h)),Math.min(o,Math.floor(r+(a-l)*c/a+h)),s)}var p=n[r],f=i,d=o;for(e(n,i,r),s(n[o],p)>0&&e(n,i,o);f<d;){for(e(n,f,d),f++,d--;s(n[f],p)<0;)f++;for(;s(n[d],p)>0;)d--}0===s(n[i],p)?e(n,i,d):e(n,++d,o),d<=r&&(i=d+1),r<=d&&(o=d-1)}}(t,r,i||0,o||t.length-1,s||n)}function e(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function n(t,e){return t<e?-1:t>e?1:0}var r=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function i(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function o(t,e){s(t,0,t.children.length,e,t)}function s(t,e,n,r,i){i||(i=d(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=e;o<n;o++){var s=t.children[o];a(i,t.leaf?r(s):s)}return i}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l(t,e){return t.minX-e.minX}function u(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function h(t){return t.maxX-t.minX+(t.maxY-t.minY)}function p(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function f(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function d(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(e,n,r,i,o){for(var s=[n,r];s.length;)if(!((r=s.pop())-(n=s.pop())<=i)){var a=n+Math.ceil((r-n)/i/2)*i;t(e,a,n,r,o),s.push(n,a,a,r)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(t){var e=this.data,n=[];if(!f(t,e))return n;for(var r=this.toBBox,i=[];e;){for(var o=0;o<e.children.length;o++){var s=e.children[o],a=e.leaf?r(s):s;f(t,a)&&(e.leaf?n.push(s):p(t,a)?this._all(s,n):i.push(s))}e=i.pop()}return n},r.prototype.collides=function(t){var e=this.data;if(!f(t,e))return!1;for(var n=[];e;){for(var r=0;r<e.children.length;r++){var i=e.children[r],o=e.leaf?this.toBBox(i):i;if(f(t,o)){if(e.leaf||p(t,o))return!0;n.push(i)}}e=n.pop()}return!1},r.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},r.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},r.prototype.clear=function(){return this.data=d([]),this},r.prototype.remove=function(t,e){if(!t)return this;for(var n,r,o,s=this.data,a=this.toBBox(t),l=[],u=[];s||l.length;){if(s||(s=l.pop(),r=l[l.length-1],n=u.pop(),o=!0),s.leaf){var c=i(t,s.children,e);if(-1!==c)return s.children.splice(c,1),l.push(s),this._condense(l),this}o||s.leaf||!p(s,a)?r?(n++,s=r.children[n],o=!1):s=null:(l.push(s),u.push(n),n=0,r=s,s=s.children[0])}return this},r.prototype.toBBox=function(t){return t},r.prototype.compareMinX=function(t,e){return t.minX-e.minX},r.prototype.compareMinY=function(t,e){return t.minY-e.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(t){return this.data=t,this},r.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},r.prototype._build=function(t,e,n,r){var i,s=n-e+1,a=this._maxEntries;if(s<=a)return o(i=d(t.slice(e,n+1)),this.toBBox),i;r||(r=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,r-1))),(i=d([])).leaf=!1,i.height=r;var l=Math.ceil(s/a),u=l*Math.ceil(Math.sqrt(a));g(t,e,n,u,this.compareMinX);for(var c=e;c<=n;c+=u){var h=Math.min(c+u-1,n);g(t,c,h,l,this.compareMinY);for(var p=c;p<=h;p+=l){var f=Math.min(p+l-1,h);i.children.push(this._build(t,p,f,r-1))}}return o(i,this.toBBox),i},r.prototype._chooseSubtree=function(t,e,n,r){for(;r.push(e),!e.leaf&&r.length-1!==n;){for(var i=1/0,o=1/0,s=void 0,a=0;a<e.children.length;a++){var l=e.children[a],u=c(l),h=(p=t,f=l,(Math.max(f.maxX,p.maxX)-Math.min(f.minX,p.minX))*(Math.max(f.maxY,p.maxY)-Math.min(f.minY,p.minY))-u);h<o?(o=h,i=u<i?u:i,s=l):h===o&&u<i&&(i=u,s=l)}e=s||e.children[0]}var p,f;return e},r.prototype._insert=function(t,e,n){var r=n?t:this.toBBox(t),i=[],o=this._chooseSubtree(r,this.data,e,i);for(o.children.push(t),a(o,r);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(r,i,e)},r.prototype._split=function(t,e){var n=t[e],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var s=this._chooseSplitIndex(n,i,r),a=d(n.children.splice(s,n.children.length-s));a.height=n.height,a.leaf=n.leaf,o(n,this.toBBox),o(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},r.prototype._splitRoot=function(t,e){this.data=d([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(t,e,n){for(var r,i,o,a,l,u,h,p=1/0,f=1/0,d=e;d<=n-e;d++){var g=s(t,0,d,this.toBBox),m=s(t,d,n,this.toBBox),A=(i=g,o=m,void 0,void 0,void 0,void 0,a=Math.max(i.minX,o.minX),l=Math.max(i.minY,o.minY),u=Math.min(i.maxX,o.maxX),h=Math.min(i.maxY,o.maxY),Math.max(0,u-a)*Math.max(0,h-l)),y=c(g)+c(m);A<p?(p=A,r=d,f=y<f?y:f):A===p&&y<f&&(f=y,r=d)}return r||n-e},r.prototype._chooseSplitAxis=function(t,e,n){var r=t.leaf?this.compareMinX:l,i=t.leaf?this.compareMinY:u;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)},r.prototype._allDistMargin=function(t,e,n,r){t.children.sort(r);for(var i=this.toBBox,o=s(t,0,e,i),l=s(t,n-e,n,i),u=h(o)+h(l),c=e;c<n-e;c++){var p=t.children[c];a(o,t.leaf?i(p):p),u+=h(o)}for(var f=n-e-1;f>=e;f--){var d=t.children[f];a(l,t.leaf?i(d):d),u+=h(l)}return u},r.prototype._adjustParentBBoxes=function(t,e,n){for(var r=n;r>=0;r--)a(e[r],t)},r.prototype._condense=function(t){for(var e=t.length-1,n=void 0;e>=0;e--)0===t[e].children.length?e>0?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},r}()},4448:(t,e,n)=>{"use strict";var r=n(7294),i=n(7418),o=n(3840);function s(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!r)throw Error(s(227));var a=new Set,l={};function u(t,e){c(t,e),c(t+"Capture",e)}function c(t,e){for(l[t]=e,t=0;t<e.length;t++)a.add(e[t])}var h=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f=Object.prototype.hasOwnProperty,d={},g={};function m(t,e,n,r,i,o,s){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var A={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){A[t]=new m(t,0,!1,t,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];A[e]=new m(e,1,!1,t[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){A[t]=new m(t,2,!1,t.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){A[t]=new m(t,2,!1,t,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){A[t]=new m(t,3,!1,t.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(t){A[t]=new m(t,3,!0,t,null,!1,!1)})),["capture","download"].forEach((function(t){A[t]=new m(t,4,!1,t,null,!1,!1)})),["cols","rows","size","span"].forEach((function(t){A[t]=new m(t,6,!1,t,null,!1,!1)})),["rowSpan","start"].forEach((function(t){A[t]=new m(t,5,!1,t.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function _(t){return t[1].toUpperCase()}function v(t,e,n,r){var i=A.hasOwnProperty(e)?A[e]:null;(null!==i?0===i.type:!r&&2<e.length&&("o"===e[0]||"O"===e[0])&&("n"===e[1]||"N"===e[1]))||(function(t,e,n,r){if(null==e||function(t,e,n,r){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,i,r)&&(n=null),r||null===i?function(t){return!!f.call(g,t)||!f.call(d,t)&&(p.test(t)?g[t]=!0:(d[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=null===n?3!==i.type&&"":n:(e=i.attributeName,r=i.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(y,_);A[e]=new m(e,1,!1,t,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(y,_);A[e]=new m(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(y,_);A[e]=new m(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(t){A[t]=new m(t,1,!1,t.toLowerCase(),null,!1,!1)})),A.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(t){A[t]=new m(t,1,!1,t.toLowerCase(),null,!0,!0)}));var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=60103,w=60106,E=60107,S=60108,T=60114,P=60109,M=60110,C=60112,I=60113,O=60120,R=60115,L=60116,k=60121,D=60128,N=60129,F=60130,B=60131;if("function"==typeof Symbol&&Symbol.for){var z=Symbol.for;x=z("react.element"),w=z("react.portal"),E=z("react.fragment"),S=z("react.strict_mode"),T=z("react.profiler"),P=z("react.provider"),M=z("react.context"),C=z("react.forward_ref"),I=z("react.suspense"),O=z("react.suspense_list"),R=z("react.memo"),L=z("react.lazy"),k=z("react.block"),z("react.scope"),D=z("react.opaque.id"),N=z("react.debug_trace_mode"),F=z("react.offscreen"),B=z("react.legacy_hidden")}var j,U="function"==typeof Symbol&&Symbol.iterator;function V(t){return null===t||"object"!=typeof t?null:"function"==typeof(t=U&&t[U]||t["@@iterator"])?t:null}function G(t){if(void 0===j)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);j=e&&e[1]||""}return"\n"+j+t}var Z=!1;function q(t,e){if(!t||Z)return"";Z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(t){var r=t}Reflect.construct(t,[],e)}else{try{e.call()}catch(t){r=t}t.call(e.prototype)}else{try{throw Error()}catch(t){r=t}t()}}catch(t){if(t&&r&&"string"==typeof t.stack){for(var i=t.stack.split("\n"),o=r.stack.split("\n"),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(1!==s||1!==a)do{if(s--,0>--a||i[s]!==o[a])return"\n"+i[s].replace(" at new "," at ")}while(1<=s&&0<=a);break}}}finally{Z=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?G(t):""}function W(t){switch(t.tag){case 5:return G(t.type);case 16:return G("Lazy");case 13:return G("Suspense");case 19:return G("SuspenseList");case 0:case 2:case 15:return q(t.type,!1);case 11:return q(t.type.render,!1);case 22:return q(t.type._render,!1);case 1:return q(t.type,!0);default:return""}}function H(t){if(null==t)return null;if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t;switch(t){case E:return"Fragment";case w:return"Portal";case T:return"Profiler";case S:return"StrictMode";case I:return"Suspense";case O:return"SuspenseList"}if("object"==typeof t)switch(t.$$typeof){case M:return(t.displayName||"Context")+".Consumer";case P:return(t._context.displayName||"Context")+".Provider";case C:var e=t.render;return e=e.displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case R:return H(t.type);case k:return H(t._render);case L:e=t._payload,t=t._init;try{return H(t(e))}catch(t){}}return null}function X(t){switch(typeof t){case"boolean":case"number":case"object":case"string":case"undefined":return t;default:return""}}function $(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function Y(t){t._valueTracker||(t._valueTracker=function(t){var e=$(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(t){r=""+t,o.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(t){r=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function Q(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=$(t)?t.checked?"true":"false":t.value),(t=r)!==n&&(e.setValue(t),!0)}function K(t){if(void 0===(t=t||("undefined"!=typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function J(t,e){var n=e.checked;return i({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function tt(t,e){var n=null==e.defaultValue?"":e.defaultValue,r=null!=e.checked?e.checked:e.defaultChecked;n=X(null!=e.value?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function et(t,e){null!=(e=e.checked)&&v(t,"checked",e,!1)}function nt(t,e){et(t,e);var n=X(e.value),r=e.type;if(null!=n)"number"===r?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===r||"reset"===r)return void t.removeAttribute("value");e.hasOwnProperty("value")?it(t,e.type,n):e.hasOwnProperty("defaultValue")&&it(t,e.type,X(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function rt(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!("submit"!==r&&"reset"!==r||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function it(t,e,n){"number"===e&&K(t.ownerDocument)===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}function ot(t,e){return t=i({children:void 0},e),(e=function(t){var e="";return r.Children.forEach(t,(function(t){null!=t&&(e+=t)})),e}(e.children))&&(t.children=e),t}function st(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+X(n),e=null,i=0;i<t.length;i++){if(t[i].value===n)return t[i].selected=!0,void(r&&(t[i].defaultSelected=!0));null!==e||t[i].disabled||(e=t[i])}null!==e&&(e.selected=!0)}}function at(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(s(91));return i({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function lt(t,e){var n=e.value;if(null==n){if(n=e.children,e=e.defaultValue,null!=n){if(null!=e)throw Error(s(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(s(93));n=n[0]}e=n}null==e&&(e=""),n=e}t._wrapperState={initialValue:X(n)}}function ut(t,e){var n=X(e.value),r=X(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=r&&(t.defaultValue=""+r)}function ct(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}var ht="http://www.w3.org/1999/xhtml";function pt(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ft(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?pt(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var dt,gt,mt=(gt=function(t,e){if("http://www.w3.org/2000/svg"!==t.namespaceURI||"innerHTML"in t)t.innerHTML=e;else{for((dt=dt||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=dt.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,n,r){MSApp.execUnsafeLocalFunction((function(){return gt(t,e)}))}:gt);function At(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}var yt={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},_t=["Webkit","ms","Moz","O"];function vt(t,e,n){return null==e||"boolean"==typeof e||""===e?"":n||"number"!=typeof e||0===e||yt.hasOwnProperty(t)&&yt[t]?(""+e).trim():e+"px"}function bt(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=vt(n,e[n],r);"float"===n&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}Object.keys(yt).forEach((function(t){_t.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),yt[e]=yt[t]}))}));var xt=i({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function wt(t,e){if(e){if(xt[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(s(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(s(60));if("object"!=typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=e.style&&"object"!=typeof e.style)throw Error(s(62))}}function Et(t,e){if(-1===t.indexOf("-"))return"string"==typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function St(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var Tt=null,Pt=null,Mt=null;function Ct(t){if(t=ni(t)){if("function"!=typeof Tt)throw Error(s(280));var e=t.stateNode;e&&(e=ii(e),Tt(t.stateNode,t.type,e))}}function It(t){Pt?Mt?Mt.push(t):Mt=[t]:Pt=t}function Ot(){if(Pt){var t=Pt,e=Mt;if(Mt=Pt=null,Ct(t),e)for(t=0;t<e.length;t++)Ct(e[t])}}function Rt(t,e){return t(e)}function Lt(t,e,n,r,i){return t(e,n,r,i)}function kt(){}var Dt=Rt,Nt=!1,Ft=!1;function Bt(){null===Pt&&null===Mt||(kt(),Ot())}function zt(t,e){var n=t.stateNode;if(null===n)return null;var r=ii(n);if(null===r)return null;n=r[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!r;break t;default:t=!1}if(t)return null;if(n&&"function"!=typeof n)throw Error(s(231,e,typeof n));return n}var jt=!1;if(h)try{var Ut={};Object.defineProperty(Ut,"passive",{get:function(){jt=!0}}),window.addEventListener("test",Ut,Ut),window.removeEventListener("test",Ut,Ut)}catch(gt){jt=!1}function Vt(t,e,n,r,i,o,s,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(t){this.onError(t)}}var Gt=!1,Zt=null,qt=!1,Wt=null,Ht={onError:function(t){Gt=!0,Zt=t}};function Xt(t,e,n,r,i,o,s,a,l){Gt=!1,Zt=null,Vt.apply(Ht,arguments)}function $t(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!=(1026&(e=t).flags)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function Yt(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&null!==(t=t.alternate)&&(e=t.memoizedState),null!==e)return e.dehydrated}return null}function Qt(t){if($t(t)!==t)throw Error(s(188))}function Kt(t){if(t=function(t){var e=t.alternate;if(!e){if(null===(e=$t(t)))throw Error(s(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return Qt(i),t;if(o===r)return Qt(i),e;o=o.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,r=o;break}if(l===r){a=!0,r=i,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,r=i;break}if(l===r){a=!0,r=o,n=i;break}l=l.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?t:e}(t),!t)return null;for(var e=t;;){if(5===e.tag||6===e.tag)return e;if(e.child)e.child.return=e,e=e.child;else{if(e===t)break;for(;!e.sibling;){if(!e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}}return null}function Jt(t,e){for(var n=t.alternate;null!==e;){if(e===t||e===n)return!0;e=e.return}return!1}var te,ee,ne,re,ie=!1,oe=[],se=null,ae=null,le=null,ue=new Map,ce=new Map,he=[],pe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function fe(t,e,n,r,i){return{blockedOn:t,domEventName:e,eventSystemFlags:16|n,nativeEvent:i,targetContainers:[r]}}function de(t,e){switch(t){case"focusin":case"focusout":se=null;break;case"dragenter":case"dragleave":ae=null;break;case"mouseover":case"mouseout":le=null;break;case"pointerover":case"pointerout":ue.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ce.delete(e.pointerId)}}function ge(t,e,n,r,i,o){return null===t||t.nativeEvent!==o?(t=fe(e,n,r,i,o),null!==e&&null!==(e=ni(e))&&ee(e),t):(t.eventSystemFlags|=r,e=t.targetContainers,null!==i&&-1===e.indexOf(i)&&e.push(i),t)}function me(t){var e=ei(t.target);if(null!==e){var n=$t(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=Yt(n)))return t.blockedOn=e,void re(t.lanePriority,(function(){o.unstable_runWithPriority(t.priority,(function(){ne(n)}))}))}else if(3===e&&n.stateNode.hydrate)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function Ae(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var n=Ke(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==n)return null!==(e=ni(n))&&ee(e),t.blockedOn=n,!1;e.shift()}return!0}function ye(t,e,n){Ae(t)&&n.delete(e)}function _e(){for(ie=!1;0<oe.length;){var t=oe[0];if(null!==t.blockedOn){null!==(t=ni(t.blockedOn))&&te(t);break}for(var e=t.targetContainers;0<e.length;){var n=Ke(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==n){t.blockedOn=n;break}e.shift()}null===t.blockedOn&&oe.shift()}null!==se&&Ae(se)&&(se=null),null!==ae&&Ae(ae)&&(ae=null),null!==le&&Ae(le)&&(le=null),ue.forEach(ye),ce.forEach(ye)}function ve(t,e){t.blockedOn===e&&(t.blockedOn=null,ie||(ie=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,_e)))}function be(t){function e(e){return ve(e,t)}if(0<oe.length){ve(oe[0],t);for(var n=1;n<oe.length;n++){var r=oe[n];r.blockedOn===t&&(r.blockedOn=null)}}for(null!==se&&ve(se,t),null!==ae&&ve(ae,t),null!==le&&ve(le,t),ue.forEach(e),ce.forEach(e),n=0;n<he.length;n++)(r=he[n]).blockedOn===t&&(r.blockedOn=null);for(;0<he.length&&null===(n=he[0]).blockedOn;)me(n),null===n.blockedOn&&he.shift()}function xe(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var we={animationend:xe("Animation","AnimationEnd"),animationiteration:xe("Animation","AnimationIteration"),animationstart:xe("Animation","AnimationStart"),transitionend:xe("Transition","TransitionEnd")},Ee={},Se={};function Te(t){if(Ee[t])return Ee[t];if(!we[t])return t;var e,n=we[t];for(e in n)if(n.hasOwnProperty(e)&&e in Se)return Ee[t]=n[e];return t}h&&(Se=document.createElement("div").style,"AnimationEvent"in window||(delete we.animationend.animation,delete we.animationiteration.animation,delete we.animationstart.animation),"TransitionEvent"in window||delete we.transitionend.transition);var Pe=Te("animationend"),Me=Te("animationiteration"),Ce=Te("animationstart"),Ie=Te("transitionend"),Oe=new Map,Re=new Map,Le=["abort","abort",Pe,"animationEnd",Me,"animationIteration",Ce,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Ie,"transitionEnd","waiting","waiting"];function ke(t,e){for(var n=0;n<t.length;n+=2){var r=t[n],i=t[n+1];i="on"+(i[0].toUpperCase()+i.slice(1)),Re.set(r,e),Oe.set(r,i),u(i,[r])}}(0,o.unstable_now)();var De=8;function Ne(t){if(0!=(1&t))return De=15,1;if(0!=(2&t))return De=14,2;if(0!=(4&t))return De=13,4;var e=24&t;return 0!==e?(De=12,e):0!=(32&t)?(De=11,32):0!=(e=192&t)?(De=10,e):0!=(256&t)?(De=9,256):0!=(e=3584&t)?(De=8,e):0!=(4096&t)?(De=7,4096):0!=(e=4186112&t)?(De=6,e):0!=(e=62914560&t)?(De=5,e):67108864&t?(De=4,67108864):0!=(134217728&t)?(De=3,134217728):0!=(e=805306368&t)?(De=2,e):0!=(1073741824&t)?(De=1,1073741824):(De=8,t)}function Fe(t,e){var n=t.pendingLanes;if(0===n)return De=0;var r=0,i=0,o=t.expiredLanes,s=t.suspendedLanes,a=t.pingedLanes;if(0!==o)r=o,i=De=15;else if(0!=(o=134217727&n)){var l=o&~s;0!==l?(r=Ne(l),i=De):0!=(a&=o)&&(r=Ne(a),i=De)}else 0!=(o=n&~s)?(r=Ne(o),i=De):0!==a&&(r=Ne(a),i=De);if(0===r)return 0;if(r=n&((0>(r=31-Ge(r))?0:1<<r)<<1)-1,0!==e&&e!==r&&0==(e&s)){if(Ne(e),i<=De)return e;De=i}if(0!==(e=t.entangledLanes))for(t=t.entanglements,e&=r;0<e;)i=1<<(n=31-Ge(e)),r|=t[n],e&=~i;return r}function Be(t){return 0!=(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function ze(t,e){switch(t){case 15:return 1;case 14:return 2;case 12:return 0===(t=je(24&~e))?ze(10,e):t;case 10:return 0===(t=je(192&~e))?ze(8,e):t;case 8:return 0===(t=je(3584&~e))&&0===(t=je(4186112&~e))&&(t=512),t;case 2:return 0===(e=je(805306368&~e))&&(e=268435456),e}throw Error(s(358,t))}function je(t){return t&-t}function Ue(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Ve(t,e,n){t.pendingLanes|=e;var r=e-1;t.suspendedLanes&=r,t.pingedLanes&=r,(t=t.eventTimes)[e=31-Ge(e)]=n}var Ge=Math.clz32?Math.clz32:function(t){return 0===t?32:31-(Ze(t)/qe|0)|0},Ze=Math.log,qe=Math.LN2,We=o.unstable_UserBlockingPriority,He=o.unstable_runWithPriority,Xe=!0;function $e(t,e,n,r){Nt||kt();var i=Qe,o=Nt;Nt=!0;try{Lt(i,t,e,n,r)}finally{(Nt=o)||Bt()}}function Ye(t,e,n,r){He(We,Qe.bind(null,t,e,n,r))}function Qe(t,e,n,r){var i;if(Xe)if((i=0==(4&e))&&0<oe.length&&-1<pe.indexOf(t))t=fe(null,t,e,n,r),oe.push(t);else{var o=Ke(t,e,n,r);if(null===o)i&&de(t,r);else{if(i){if(-1<pe.indexOf(t))return t=fe(o,t,e,n,r),void oe.push(t);if(function(t,e,n,r,i){switch(e){case"focusin":return se=ge(se,t,e,n,r,i),!0;case"dragenter":return ae=ge(ae,t,e,n,r,i),!0;case"mouseover":return le=ge(le,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return ue.set(o,ge(ue.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,ce.set(o,ge(ce.get(o)||null,t,e,n,r,i)),!0}return!1}(o,t,e,n,r))return;de(t,r)}kr(t,e,r,null,n)}}}function Ke(t,e,n,r){var i=St(r);if(null!==(i=ei(i))){var o=$t(i);if(null===o)i=null;else{var s=o.tag;if(13===s){if(null!==(i=Yt(o)))return i;i=null}else if(3===s){if(o.stateNode.hydrate)return 3===o.tag?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null)}}return kr(t,e,r,i,n),null}var Je=null,tn=null,en=null;function nn(){if(en)return en;var t,e,n=tn,r=n.length,i="value"in Je?Je.value:Je.textContent,o=i.length;for(t=0;t<r&&n[t]===i[t];t++);var s=r-t;for(e=1;e<=s&&n[r-e]===i[o-e];e++);return en=i.slice(t,1<e?1-e:void 0)}function rn(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function on(){return!0}function sn(){return!1}function an(t){function e(e,n,r,i,o){for(var s in this._reactName=e,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null,t)t.hasOwnProperty(s)&&(e=t[s],this[s]=e?e(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?on:sn,this.isPropagationStopped=sn,this}return i(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!=typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=on)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!=typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=on)},persist:function(){},isPersistent:on}),e}var ln,un,cn,hn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},pn=an(hn),fn=i({},hn,{view:0,detail:0}),dn=an(fn),gn=i({},fn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Pn,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==cn&&(cn&&"mousemove"===t.type?(ln=t.screenX-cn.screenX,un=t.screenY-cn.screenY):un=ln=0,cn=t),ln)},movementY:function(t){return"movementY"in t?t.movementY:un}}),mn=an(gn),An=an(i({},gn,{dataTransfer:0})),yn=an(i({},fn,{relatedTarget:0})),_n=an(i({},hn,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=i({},hn,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),bn=an(vn),xn=an(i({},hn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},En={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tn(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=Sn[t])&&!!e[t]}function Pn(){return Tn}var Mn=i({},fn,{key:function(t){if(t.key){var e=wn[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=rn(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?En[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Pn,charCode:function(t){return"keypress"===t.type?rn(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?rn(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),Cn=an(Mn),In=an(i({},gn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),On=an(i({},fn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Pn})),Rn=an(i({},hn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Ln=i({},gn,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),kn=an(Ln),Dn=[9,13,27,32],Nn=h&&"CompositionEvent"in window,Fn=null;h&&"documentMode"in document&&(Fn=document.documentMode);var Bn=h&&"TextEvent"in window&&!Fn,zn=h&&(!Nn||Fn&&8<Fn&&11>=Fn),jn=String.fromCharCode(32),Un=!1;function Vn(t,e){switch(t){case"keyup":return-1!==Dn.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gn(t){return"object"==typeof(t=t.detail)&&"data"in t?t.data:null}var Zn=!1,qn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!qn[t.type]:"textarea"===e}function Hn(t,e,n,r){It(r),0<(e=Nr(e,"onChange")).length&&(n=new pn("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Xn=null,$n=null;function Yn(t){Mr(t,0)}function Qn(t){if(Q(ri(t)))return t}function Kn(t,e){if("change"===t)return e}var Jn=!1;if(h){var tr;if(h){var er="oninput"in document;if(!er){var nr=document.createElement("div");nr.setAttribute("oninput","return;"),er="function"==typeof nr.oninput}tr=er}else tr=!1;Jn=tr&&(!document.documentMode||9<document.documentMode)}function rr(){Xn&&(Xn.detachEvent("onpropertychange",ir),$n=Xn=null)}function ir(t){if("value"===t.propertyName&&Qn($n)){var e=[];if(Hn(e,$n,t,St(t)),t=Yn,Nt)t(e);else{Nt=!0;try{Rt(t,e)}finally{Nt=!1,Bt()}}}}function or(t,e,n){"focusin"===t?(rr(),$n=n,(Xn=e).attachEvent("onpropertychange",ir)):"focusout"===t&&rr()}function sr(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return Qn($n)}function ar(t,e){if("click"===t)return Qn(e)}function lr(t,e){if("input"===t||"change"===t)return Qn(e)}var ur="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e},cr=Object.prototype.hasOwnProperty;function hr(t,e){if(ur(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!cr.call(e,n[r])||!ur(t[n[r]],e[n[r]]))return!1;return!0}function pr(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function fr(t,e){var n,r=pr(t);for(t=0;r;){if(3===r.nodeType){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}t:{for(;r;){if(r.nextSibling){r=r.nextSibling;break t}r=r.parentNode}r=void 0}r=pr(r)}}function dr(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?dr(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function gr(){for(var t=window,e=K();e instanceof t.HTMLIFrameElement;){try{var n="string"==typeof e.contentWindow.location.href}catch(t){n=!1}if(!n)break;e=K((t=e.contentWindow).document)}return e}function mr(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}var Ar=h&&"documentMode"in document&&11>=document.documentMode,yr=null,_r=null,vr=null,br=!1;function xr(t,e,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==yr||yr!==K(r)||(r="selectionStart"in(r=yr)&&mr(r)?{start:r.selectionStart,end:r.selectionEnd}:{anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},vr&&hr(vr,r)||(vr=r,0<(r=Nr(_r,"onSelect")).length&&(e=new pn("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=yr)))}ke("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),ke("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),ke(Le,2);for(var wr="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),Er=0;Er<wr.length;Er++)Re.set(wr[Er],0);c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Sr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Tr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Sr));function Pr(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,function(t,e,n,r,i,o,a,l,u){if(Xt.apply(this,arguments),Gt){if(!Gt)throw Error(s(198));var c=Zt;Gt=!1,Zt=null,qt||(qt=!0,Wt=c)}}(r,e,void 0,t),t.currentTarget=null}function Mr(t,e){e=0!=(4&e);for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;t:{var o=void 0;if(e)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==o&&i.isPropagationStopped())break t;Pr(i,a,u),o=l}else for(s=0;s<r.length;s++){if(l=(a=r[s]).instance,u=a.currentTarget,a=a.listener,l!==o&&i.isPropagationStopped())break t;Pr(i,a,u),o=l}}}if(qt)throw t=Wt,qt=!1,Wt=null,t}function Cr(t,e){var n=oi(e),r=t+"__bubble";n.has(r)||(Lr(e,t,2,!1),n.add(r))}var Ir="_reactListening"+Math.random().toString(36).slice(2);function Or(t){t[Ir]||(t[Ir]=!0,a.forEach((function(e){Tr.has(e)||Rr(e,!1,t,null),Rr(e,!0,t,null)})))}function Rr(t,e,n,r){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,o=n;if("selectionchange"===t&&9!==n.nodeType&&(o=n.ownerDocument),null!==r&&!e&&Tr.has(t)){if("scroll"!==t)return;i|=2,o=r}var s=oi(o),a=t+"__"+(e?"capture":"bubble");s.has(a)||(e&&(i|=4),Lr(o,t,i,e),s.add(a))}function Lr(t,e,n,r){var i=Re.get(e);switch(void 0===i?2:i){case 0:i=$e;break;case 1:i=Ye;break;default:i=Qe}n=i.bind(null,e,n,t),i=void 0,!jt||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(i=!0),r?void 0!==i?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):void 0!==i?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function kr(t,e,n,r,i){var o=r;if(0==(1&e)&&0==(2&e)&&null!==r)t:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var a=r.stateNode.containerInfo;if(a===i||8===a.nodeType&&a.parentNode===i)break;if(4===s)for(s=r.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;s=s.return}for(;null!==a;){if(null===(s=ei(a)))return;if(5===(l=s.tag)||6===l){r=o=s;continue t}a=a.parentNode}}r=r.return}!function(t,e,n){if(Ft)return t();Ft=!0;try{Dt(t,e,n)}finally{Ft=!1,Bt()}}((function(){var r=o,i=St(n),s=[];t:{var a=Oe.get(t);if(void 0!==a){var l=pn,u=t;switch(t){case"keypress":if(0===rn(n))break t;case"keydown":case"keyup":l=Cn;break;case"focusin":u="focus",l=yn;break;case"focusout":u="blur",l=yn;break;case"beforeblur":case"afterblur":l=yn;break;case"click":if(2===n.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=mn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=An;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=On;break;case Pe:case Me:case Ce:l=_n;break;case Ie:l=Rn;break;case"scroll":l=dn;break;case"wheel":l=kn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=In}var c=0!=(4&e),h=!c&&"scroll"===t,p=c?null!==a?a+"Capture":null:a;c=[];for(var f,d=r;null!==d;){var g=(f=d).stateNode;if(5===f.tag&&null!==g&&(f=g,null!==p&&null!=(g=zt(d,p))&&c.push(Dr(d,g,f))),h)break;d=d.return}0<c.length&&(a=new l(a,u,null,n,i),s.push({event:a,listeners:c}))}}if(0==(7&e)){if(l="mouseout"===t||"pointerout"===t,(!(a="mouseover"===t||"pointerover"===t)||0!=(16&e)||!(u=n.relatedTarget||n.fromElement)||!ei(u)&&!u[Jr])&&(l||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=r,null!==(u=(u=n.relatedTarget||n.toElement)?ei(u):null)&&(u!==(h=$t(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(l=null,u=r),l!==u)){if(c=mn,g="onMouseLeave",p="onMouseEnter",d="mouse","pointerout"!==t&&"pointerover"!==t||(c=In,g="onPointerLeave",p="onPointerEnter",d="pointer"),h=null==l?a:ri(l),f=null==u?a:ri(u),(a=new c(g,d+"leave",l,n,i)).target=h,a.relatedTarget=f,g=null,ei(i)===r&&((c=new c(p,d+"enter",u,n,i)).target=f,c.relatedTarget=h,g=c),h=g,l&&u)t:{for(p=u,d=0,f=c=l;f;f=Fr(f))d++;for(f=0,g=p;g;g=Fr(g))f++;for(;0<d-f;)c=Fr(c),d--;for(;0<f-d;)p=Fr(p),f--;for(;d--;){if(c===p||null!==p&&c===p.alternate)break t;c=Fr(c),p=Fr(p)}c=null}else c=null;null!==l&&Br(s,a,l,c,!1),null!==u&&null!==h&&Br(s,h,u,c,!0)}if("select"===(l=(a=r?ri(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var m=Kn;else if(Wn(a))if(Jn)m=lr;else{m=sr;var A=or}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(m=ar);switch(m&&(m=m(t,r))?Hn(s,m,n,i):(A&&A(t,a,r),"focusout"===t&&(A=a._wrapperState)&&A.controlled&&"number"===a.type&&it(a,"number",a.value)),A=r?ri(r):window,t){case"focusin":(Wn(A)||"true"===A.contentEditable)&&(yr=A,_r=r,vr=null);break;case"focusout":vr=_r=yr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,xr(s,n,i);break;case"selectionchange":if(Ar)break;case"keydown":case"keyup":xr(s,n,i)}var y;if(Nn)t:{switch(t){case"compositionstart":var _="onCompositionStart";break t;case"compositionend":_="onCompositionEnd";break t;case"compositionupdate":_="onCompositionUpdate";break t}_=void 0}else Zn?Vn(t,n)&&(_="onCompositionEnd"):"keydown"===t&&229===n.keyCode&&(_="onCompositionStart");_&&(zn&&"ko"!==n.locale&&(Zn||"onCompositionStart"!==_?"onCompositionEnd"===_&&Zn&&(y=nn()):(tn="value"in(Je=i)?Je.value:Je.textContent,Zn=!0)),0<(A=Nr(r,_)).length&&(_=new xn(_,t,null,n,i),s.push({event:_,listeners:A}),(y||null!==(y=Gn(n)))&&(_.data=y))),(y=Bn?function(t,e){switch(t){case"compositionend":return Gn(e);case"keypress":return 32!==e.which?null:(Un=!0,jn);case"textInput":return(t=e.data)===jn&&Un?null:t;default:return null}}(t,n):function(t,e){if(Zn)return"compositionend"===t||!Nn&&Vn(t,e)?(t=nn(),en=tn=Je=null,Zn=!1,t):null;switch(t){default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return zn&&"ko"!==e.locale?null:e.data}}(t,n))&&0<(r=Nr(r,"onBeforeInput")).length&&(i=new xn("onBeforeInput","beforeinput",null,n,i),s.push({event:i,listeners:r}),i.data=y)}Mr(s,e)}))}function Dr(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Nr(t,e){for(var n=e+"Capture",r=[];null!==t;){var i=t,o=i.stateNode;5===i.tag&&null!==o&&(i=o,null!=(o=zt(t,n))&&r.unshift(Dr(t,o,i)),null!=(o=zt(t,e))&&r.push(Dr(t,o,i))),t=t.return}return r}function Fr(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function Br(t,e,n,r,i){for(var o=e._reactName,s=[];null!==n&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(null!==l&&l===r)break;5===a.tag&&null!==u&&(a=u,i?null!=(l=zt(n,o))&&s.unshift(Dr(n,l,a)):i||null!=(l=zt(n,o))&&s.push(Dr(n,l,a))),n=n.return}0!==s.length&&t.push({event:e,listeners:s})}function zr(){}var jr=null,Ur=null;function Vr(t,e){switch(t){case"button":case"input":case"select":case"textarea":return!!e.autoFocus}return!1}function Gr(t,e){return"textarea"===t||"option"===t||"noscript"===t||"string"==typeof e.children||"number"==typeof e.children||"object"==typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var Zr="function"==typeof setTimeout?setTimeout:void 0,qr="function"==typeof clearTimeout?clearTimeout:void 0;function Wr(t){(1===t.nodeType||9===t.nodeType&&null!=(t=t.body))&&(t.textContent="")}function Hr(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break}return t}function Xr(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if("$"===n||"$!"===n||"$?"===n){if(0===e)return t;e--}else"/$"===n&&e++}t=t.previousSibling}return null}var $r=0,Yr=Math.random().toString(36).slice(2),Qr="__reactFiber$"+Yr,Kr="__reactProps$"+Yr,Jr="__reactContainer$"+Yr,ti="__reactEvents$"+Yr;function ei(t){var e=t[Qr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Jr]||n[Qr]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=Xr(t);null!==t;){if(n=t[Qr])return n;t=Xr(t)}return e}n=(t=n).parentNode}return null}function ni(t){return!(t=t[Qr]||t[Jr])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function ri(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(s(33))}function ii(t){return t[Kr]||null}function oi(t){var e=t[ti];return void 0===e&&(e=t[ti]=new Set),e}var si=[],ai=-1;function li(t){return{current:t}}function ui(t){0>ai||(t.current=si[ai],si[ai]=null,ai--)}function ci(t,e){ai++,si[ai]=t.current,t.current=e}var hi={},pi=li(hi),fi=li(!1),di=hi;function gi(t,e){var n=t.type.contextTypes;if(!n)return hi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=e[i];return r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function mi(t){return null!=t.childContextTypes}function Ai(){ui(fi),ui(pi)}function yi(t,e,n){if(pi.current!==hi)throw Error(s(168));ci(pi,e),ci(fi,n)}function _i(t,e,n){var r=t.stateNode;if(t=e.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in t))throw Error(s(108,H(e)||"Unknown",o));return i({},n,r)}function vi(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||hi,di=pi.current,ci(pi,t),ci(fi,fi.current),!0}function bi(t,e,n){var r=t.stateNode;if(!r)throw Error(s(169));n?(t=_i(t,e,di),r.__reactInternalMemoizedMergedChildContext=t,ui(fi),ui(pi),ci(pi,t)):ui(fi),ci(fi,n)}var xi=null,wi=null,Ei=o.unstable_runWithPriority,Si=o.unstable_scheduleCallback,Ti=o.unstable_cancelCallback,Pi=o.unstable_shouldYield,Mi=o.unstable_requestPaint,Ci=o.unstable_now,Ii=o.unstable_getCurrentPriorityLevel,Oi=o.unstable_ImmediatePriority,Ri=o.unstable_UserBlockingPriority,Li=o.unstable_NormalPriority,ki=o.unstable_LowPriority,Di=o.unstable_IdlePriority,Ni={},Fi=void 0!==Mi?Mi:function(){},Bi=null,zi=null,ji=!1,Ui=Ci(),Vi=1e4>Ui?Ci:function(){return Ci()-Ui};function Gi(){switch(Ii()){case Oi:return 99;case Ri:return 98;case Li:return 97;case ki:return 96;case Di:return 95;default:throw Error(s(332))}}function Zi(t){switch(t){case 99:return Oi;case 98:return Ri;case 97:return Li;case 96:return ki;case 95:return Di;default:throw Error(s(332))}}function qi(t,e){return t=Zi(t),Ei(t,e)}function Wi(t,e,n){return t=Zi(t),Si(t,e,n)}function Hi(){if(null!==zi){var t=zi;zi=null,Ti(t)}Xi()}function Xi(){if(!ji&&null!==Bi){ji=!0;var t=0;try{var e=Bi;qi(99,(function(){for(;t<e.length;t++){var n=e[t];do{n=n(!0)}while(null!==n)}})),Bi=null}catch(e){throw null!==Bi&&(Bi=Bi.slice(t+1)),Si(Oi,Hi),e}finally{ji=!1}}}var $i=b.ReactCurrentBatchConfig;function Yi(t,e){if(t&&t.defaultProps){for(var n in e=i({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}return e}var Qi=li(null),Ki=null,Ji=null,to=null;function eo(){to=Ji=Ki=null}function no(t){var e=Qi.current;ui(Qi),t.type._context._currentValue=e}function ro(t,e){for(;null!==t;){var n=t.alternate;if((t.childLanes&e)===e){if(null===n||(n.childLanes&e)===e)break;n.childLanes|=e}else t.childLanes|=e,null!==n&&(n.childLanes|=e);t=t.return}}function io(t,e){Ki=t,to=Ji=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(0!=(t.lanes&e)&&(Ns=!0),t.firstContext=null)}function oo(t,e){if(to!==t&&!1!==e&&0!==e)if("number"==typeof e&&1073741823!==e||(to=t,e=1073741823),e={context:t,observedBits:e,next:null},null===Ji){if(null===Ki)throw Error(s(308));Ji=e,Ki.dependencies={lanes:0,firstContext:e,responders:null}}else Ji=Ji.next=e;return t._currentValue}var so=!1;function ao(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function lo(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function uo(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function co(t,e){if(null!==(t=t.updateQueue)){var n=(t=t.shared).pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}}function ho(t,e){var n=t.updateQueue,r=t.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?i=o=s:o=o.next=s,n=n.next}while(null!==n);null===o?i=o=e:o=o.next=e}else i=o=e;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(t.updateQueue=n)}null===(t=n.lastBaseUpdate)?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function po(t,e,n,r){var o=t.updateQueue;so=!1;var s=o.firstBaseUpdate,a=o.lastBaseUpdate,l=o.shared.pending;if(null!==l){o.shared.pending=null;var u=l,c=u.next;u.next=null,null===a?s=c:a.next=c,a=u;var h=t.alternate;if(null!==h){var p=(h=h.updateQueue).lastBaseUpdate;p!==a&&(null===p?h.firstBaseUpdate=c:p.next=c,h.lastBaseUpdate=u)}}if(null!==s){for(p=o.baseState,a=0,h=c=u=null;;){l=s.lane;var f=s.eventTime;if((r&l)===l){null!==h&&(h=h.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});t:{var d=t,g=s;switch(l=e,f=n,g.tag){case 1:if("function"==typeof(d=g.payload)){p=d.call(f,p,l);break t}p=d;break t;case 3:d.flags=-4097&d.flags|64;case 0:if(null==(l="function"==typeof(d=g.payload)?d.call(f,p,l):d))break t;p=i({},p,l);break t;case 2:so=!0}}null!==s.callback&&(t.flags|=32,null===(l=o.effects)?o.effects=[s]:l.push(s))}else f={eventTime:f,lane:l,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===h?(c=h=f,u=p):h=h.next=f,a|=l;if(null===(s=s.next)){if(null===(l=o.shared.pending))break;s=l.next,l.next=null,o.lastBaseUpdate=l,o.shared.pending=null}}null===h&&(u=p),o.baseState=u,o.firstBaseUpdate=c,o.lastBaseUpdate=h,Ba|=a,t.lanes=a,t.memoizedState=p}}function fo(t,e,n){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!=typeof i)throw Error(s(191,i));i.call(r)}}}var go=(new r.Component).refs;function mo(t,e,n,r){n=null==(n=n(r,e=t.memoizedState))?e:i({},e,n),t.memoizedState=n,0===t.lanes&&(t.updateQueue.baseState=n)}var Ao={isMounted:function(t){return!!(t=t._reactInternals)&&$t(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=ul(),i=cl(t),o=uo(r,i);o.payload=e,null!=n&&(o.callback=n),co(t,o),hl(t,i,r)},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=ul(),i=cl(t),o=uo(r,i);o.tag=1,o.payload=e,null!=n&&(o.callback=n),co(t,o),hl(t,i,r)},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ul(),r=cl(t),i=uo(n,r);i.tag=2,null!=e&&(i.callback=e),co(t,i),hl(t,r,n)}};function yo(t,e,n,r,i,o,s){return"function"==typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(r,o,s):!(e.prototype&&e.prototype.isPureReactComponent&&hr(n,r)&&hr(i,o))}function _o(t,e,n){var r=!1,i=hi,o=e.contextType;return"object"==typeof o&&null!==o?o=oo(o):(i=mi(e)?di:pi.current,o=(r=null!=(r=e.contextTypes))?gi(t,i):hi),e=new e(n,o),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=Ao,t.stateNode=e,e._reactInternals=t,r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function vo(t,e,n,r){t=e.state,"function"==typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,r),"function"==typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Ao.enqueueReplaceState(e,e.state,null)}function bo(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=go,ao(t);var o=e.contextType;"object"==typeof o&&null!==o?i.context=oo(o):(o=mi(e)?di:pi.current,i.context=gi(t,o)),po(t,n,i,r),i.state=t.memoizedState,"function"==typeof(o=e.getDerivedStateFromProps)&&(mo(t,e,o,n),i.state=t.memoizedState),"function"==typeof e.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(e=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),e!==i.state&&Ao.enqueueReplaceState(i,i.state,null),po(t,n,i,r),i.state=t.memoizedState),"function"==typeof i.componentDidMount&&(t.flags|=4)}var xo=Array.isArray;function wo(t,e,n){if(null!==(t=n.ref)&&"function"!=typeof t&&"object"!=typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,t));var i=""+t;return null!==e&&null!==e.ref&&"function"==typeof e.ref&&e.ref._stringRef===i?e.ref:(e=function(t){var e=r.refs;e===go&&(e=r.refs={}),null===t?delete e[i]:e[i]=t},e._stringRef=i,e)}if("string"!=typeof t)throw Error(s(284));if(!n._owner)throw Error(s(290,t))}return t}function Eo(t,e){if("textarea"!==t.type)throw Error(s(31,"[object Object]"===Object.prototype.toString.call(e)?"object with keys {"+Object.keys(e).join(", ")+"}":e))}function So(t){function e(e,n){if(t){var r=e.lastEffect;null!==r?(r.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,r){if(!t)return null;for(;null!==r;)e(n,r),r=r.sibling;return null}function r(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(t,e){return(t=Gl(t,e)).index=0,t.sibling=null,t}function o(e,n,r){return e.index=r,t?null!==(r=e.alternate)?(r=r.index)<n?(e.flags=2,n):r:(e.flags=2,n):n}function a(e){return t&&null===e.alternate&&(e.flags=2),e}function l(t,e,n,r){return null===e||6!==e.tag?((e=Hl(n,t.mode,r)).return=t,e):((e=i(e,n)).return=t,e)}function u(t,e,n,r){return null!==e&&e.elementType===n.type?((r=i(e,n.props)).ref=wo(t,e,n),r.return=t,r):((r=Zl(n.type,n.key,n.props,null,t.mode,r)).ref=wo(t,e,n),r.return=t,r)}function c(t,e,n,r){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=Xl(n,t.mode,r)).return=t,e):((e=i(e,n.children||[])).return=t,e)}function h(t,e,n,r,o){return null===e||7!==e.tag?((e=ql(n,t.mode,r,o)).return=t,e):((e=i(e,n)).return=t,e)}function p(t,e,n){if("string"==typeof e||"number"==typeof e)return(e=Hl(""+e,t.mode,n)).return=t,e;if("object"==typeof e&&null!==e){switch(e.$$typeof){case x:return(n=Zl(e.type,e.key,e.props,null,t.mode,n)).ref=wo(t,null,e),n.return=t,n;case w:return(e=Xl(e,t.mode,n)).return=t,e}if(xo(e)||V(e))return(e=ql(e,t.mode,n,null)).return=t,e;Eo(t,e)}return null}function f(t,e,n,r){var i=null!==e?e.key:null;if("string"==typeof n||"number"==typeof n)return null!==i?null:l(t,e,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case x:return n.key===i?n.type===E?h(t,e,n.props.children,r,i):u(t,e,n,r):null;case w:return n.key===i?c(t,e,n,r):null}if(xo(n)||V(n))return null!==i?null:h(t,e,n,r,null);Eo(t,n)}return null}function d(t,e,n,r,i){if("string"==typeof r||"number"==typeof r)return l(e,t=t.get(n)||null,""+r,i);if("object"==typeof r&&null!==r){switch(r.$$typeof){case x:return t=t.get(null===r.key?n:r.key)||null,r.type===E?h(e,t,r.props.children,i,r.key):u(e,t,r,i);case w:return c(e,t=t.get(null===r.key?n:r.key)||null,r,i)}if(xo(r)||V(r))return h(e,t=t.get(n)||null,r,i,null);Eo(e,r)}return null}function g(i,s,a,l){for(var u=null,c=null,h=s,g=s=0,m=null;null!==h&&g<a.length;g++){h.index>g?(m=h,h=null):m=h.sibling;var A=f(i,h,a[g],l);if(null===A){null===h&&(h=m);break}t&&h&&null===A.alternate&&e(i,h),s=o(A,s,g),null===c?u=A:c.sibling=A,c=A,h=m}if(g===a.length)return n(i,h),u;if(null===h){for(;g<a.length;g++)null!==(h=p(i,a[g],l))&&(s=o(h,s,g),null===c?u=h:c.sibling=h,c=h);return u}for(h=r(i,h);g<a.length;g++)null!==(m=d(h,i,g,a[g],l))&&(t&&null!==m.alternate&&h.delete(null===m.key?g:m.key),s=o(m,s,g),null===c?u=m:c.sibling=m,c=m);return t&&h.forEach((function(t){return e(i,t)})),u}function m(i,a,l,u){var c=V(l);if("function"!=typeof c)throw Error(s(150));if(null==(l=c.call(l)))throw Error(s(151));for(var h=c=null,g=a,m=a=0,A=null,y=l.next();null!==g&&!y.done;m++,y=l.next()){g.index>m?(A=g,g=null):A=g.sibling;var _=f(i,g,y.value,u);if(null===_){null===g&&(g=A);break}t&&g&&null===_.alternate&&e(i,g),a=o(_,a,m),null===h?c=_:h.sibling=_,h=_,g=A}if(y.done)return n(i,g),c;if(null===g){for(;!y.done;m++,y=l.next())null!==(y=p(i,y.value,u))&&(a=o(y,a,m),null===h?c=y:h.sibling=y,h=y);return c}for(g=r(i,g);!y.done;m++,y=l.next())null!==(y=d(g,i,m,y.value,u))&&(t&&null!==y.alternate&&g.delete(null===y.key?m:y.key),a=o(y,a,m),null===h?c=y:h.sibling=y,h=y);return t&&g.forEach((function(t){return e(i,t)})),c}return function(t,r,o,l){var u="object"==typeof o&&null!==o&&o.type===E&&null===o.key;u&&(o=o.props.children);var c="object"==typeof o&&null!==o;if(c)switch(o.$$typeof){case x:t:{for(c=o.key,u=r;null!==u;){if(u.key===c){if(7===u.tag){if(o.type===E){n(t,u.sibling),(r=i(u,o.props.children)).return=t,t=r;break t}}else if(u.elementType===o.type){n(t,u.sibling),(r=i(u,o.props)).ref=wo(t,u,o),r.return=t,t=r;break t}n(t,u);break}e(t,u),u=u.sibling}o.type===E?((r=ql(o.props.children,t.mode,l,o.key)).return=t,t=r):((l=Zl(o.type,o.key,o.props,null,t.mode,l)).ref=wo(t,r,o),l.return=t,t=l)}return a(t);case w:t:{for(u=o.key;null!==r;){if(r.key===u){if(4===r.tag&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){n(t,r.sibling),(r=i(r,o.children||[])).return=t,t=r;break t}n(t,r);break}e(t,r),r=r.sibling}(r=Xl(o,t.mode,l)).return=t,t=r}return a(t)}if("string"==typeof o||"number"==typeof o)return o=""+o,null!==r&&6===r.tag?(n(t,r.sibling),(r=i(r,o)).return=t,t=r):(n(t,r),(r=Hl(o,t.mode,l)).return=t,t=r),a(t);if(xo(o))return g(t,r,o,l);if(V(o))return m(t,r,o,l);if(c&&Eo(t,o),void 0===o&&!u)switch(t.tag){case 1:case 22:case 0:case 11:case 15:throw Error(s(152,H(t.type)||"Component"))}return n(t,r)}}var To=So(!0),Po=So(!1),Mo={},Co=li(Mo),Io=li(Mo),Oo=li(Mo);function Ro(t){if(t===Mo)throw Error(s(174));return t}function Lo(t,e){switch(ci(Oo,e),ci(Io,t),ci(Co,Mo),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ft(null,"");break;default:e=ft(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}ui(Co),ci(Co,e)}function ko(){ui(Co),ui(Io),ui(Oo)}function Do(t){Ro(Oo.current);var e=Ro(Co.current),n=ft(e,t.type);e!==n&&(ci(Io,t),ci(Co,n))}function No(t){Io.current===t&&(ui(Co),ui(Io))}var Fo=li(0);function Bo(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!=(64&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var zo=null,jo=null,Uo=!1;function Vo(t,e){var n=Ul(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=e,n.return=t,n.flags=8,null!==t.lastEffect?(t.lastEffect.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n}function Go(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,!0);default:return!1}}function Zo(t){if(Uo){var e=jo;if(e){var n=e;if(!Go(t,e)){if(!(e=Hr(n.nextSibling))||!Go(t,e))return t.flags=-1025&t.flags|2,Uo=!1,void(zo=t);Vo(zo,n)}zo=t,jo=Hr(e.firstChild)}else t.flags=-1025&t.flags|2,Uo=!1,zo=t}}function qo(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;zo=t}function Wo(t){if(t!==zo)return!1;if(!Uo)return qo(t),Uo=!0,!1;var e=t.type;if(5!==t.tag||"head"!==e&&"body"!==e&&!Gr(e,t.memoizedProps))for(e=jo;e;)Vo(t,e),e=Hr(e.nextSibling);if(qo(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(s(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var n=t.data;if("/$"===n){if(0===e){jo=Hr(t.nextSibling);break t}e--}else"$"!==n&&"$!"!==n&&"$?"!==n||e++}t=t.nextSibling}jo=null}}else jo=zo?Hr(t.stateNode.nextSibling):null;return!0}function Ho(){jo=zo=null,Uo=!1}var Xo=[];function $o(){for(var t=0;t<Xo.length;t++)Xo[t]._workInProgressVersionPrimary=null;Xo.length=0}var Yo=b.ReactCurrentDispatcher,Qo=b.ReactCurrentBatchConfig,Ko=0,Jo=null,ts=null,es=null,ns=!1,rs=!1;function is(){throw Error(s(321))}function os(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ur(t[n],e[n]))return!1;return!0}function ss(t,e,n,r,i,o){if(Ko=o,Jo=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Yo.current=null===t||null===t.memoizedState?Rs:Ls,t=n(r,i),rs){o=0;do{if(rs=!1,!(25>o))throw Error(s(301));o+=1,es=ts=null,e.updateQueue=null,Yo.current=ks,t=n(r,i)}while(rs)}if(Yo.current=Os,e=null!==ts&&null!==ts.next,Ko=0,es=ts=Jo=null,ns=!1,e)throw Error(s(300));return t}function as(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===es?Jo.memoizedState=es=t:es=es.next=t,es}function ls(){if(null===ts){var t=Jo.alternate;t=null!==t?t.memoizedState:null}else t=ts.next;var e=null===es?Jo.memoizedState:es.next;if(null!==e)es=e,ts=t;else{if(null===t)throw Error(s(310));t={memoizedState:(ts=t).memoizedState,baseState:ts.baseState,baseQueue:ts.baseQueue,queue:ts.queue,next:null},null===es?Jo.memoizedState=es=t:es=es.next=t}return es}function us(t,e){return"function"==typeof e?e(t):e}function cs(t){var e=ls(),n=e.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=t;var r=ts,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,n.pending=null}if(null!==i){i=i.next,r=r.baseState;var l=a=o=null,u=i;do{var c=u.lane;if((Ko&c)===c)null!==l&&(l=l.next={lane:0,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null}),r=u.eagerReducer===t?u.eagerState:t(r,u.action);else{var h={lane:c,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null};null===l?(a=l=h,o=r):l=l.next=h,Jo.lanes|=c,Ba|=c}u=u.next}while(null!==u&&u!==i);null===l?o=r:l.next=a,ur(r,e.memoizedState)||(Ns=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}return[e.memoizedState,n.dispatch]}function hs(t){var e=ls(),n=e.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{o=t(o,a.action),a=a.next}while(a!==i);ur(o,e.memoizedState)||(Ns=!0),e.memoizedState=o,null===e.baseQueue&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function ps(t,e,n){var r=e._getVersion;r=r(e._source);var i=e._workInProgressVersionPrimary;if(null!==i?t=i===r:(t=t.mutableReadLanes,(t=(Ko&t)===t)&&(e._workInProgressVersionPrimary=r,Xo.push(e))),t)return n(e._source);throw Xo.push(e),Error(s(350))}function fs(t,e,n,r){var i=Ia;if(null===i)throw Error(s(349));var o=e._getVersion,a=o(e._source),l=Yo.current,u=l.useState((function(){return ps(i,e,n)})),c=u[1],h=u[0];u=es;var p=t.memoizedState,f=p.refs,d=f.getSnapshot,g=p.source;p=p.subscribe;var m=Jo;return t.memoizedState={refs:f,source:e,subscribe:r},l.useEffect((function(){f.getSnapshot=n,f.setSnapshot=c;var t=o(e._source);if(!ur(a,t)){t=n(e._source),ur(h,t)||(c(t),t=cl(m),i.mutableReadLanes|=t&i.pendingLanes),t=i.mutableReadLanes,i.entangledLanes|=t;for(var r=i.entanglements,s=t;0<s;){var l=31-Ge(s),u=1<<l;r[l]|=t,s&=~u}}}),[n,e,r]),l.useEffect((function(){return r(e._source,(function(){var t=f.getSnapshot,n=f.setSnapshot;try{n(t(e._source));var r=cl(m);i.mutableReadLanes|=r&i.pendingLanes}catch(t){n((function(){throw t}))}}))}),[e,r]),ur(d,n)&&ur(g,e)&&ur(p,r)||((t={pending:null,dispatch:null,lastRenderedReducer:us,lastRenderedState:h}).dispatch=c=Is.bind(null,Jo,t),u.queue=t,u.baseQueue=null,h=ps(i,e,n),u.memoizedState=u.baseState=h),h}function ds(t,e,n){return fs(ls(),t,e,n)}function gs(t){var e=as();return"function"==typeof t&&(t=t()),e.memoizedState=e.baseState=t,t=(t=e.queue={pending:null,dispatch:null,lastRenderedReducer:us,lastRenderedState:t}).dispatch=Is.bind(null,Jo,t),[e.memoizedState,t]}function ms(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},null===(e=Jo.updateQueue)?(e={lastEffect:null},Jo.updateQueue=e,e.lastEffect=t.next=t):null===(n=e.lastEffect)?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t),t}function As(t){return t={current:t},as().memoizedState=t}function ys(){return ls().memoizedState}function _s(t,e,n,r){var i=as();Jo.flags|=t,i.memoizedState=ms(1|e,n,void 0,void 0===r?null:r)}function vs(t,e,n,r){var i=ls();r=void 0===r?null:r;var o=void 0;if(null!==ts){var s=ts.memoizedState;if(o=s.destroy,null!==r&&os(r,s.deps))return void ms(e,n,o,r)}Jo.flags|=t,i.memoizedState=ms(1|e,n,o,r)}function bs(t,e){return _s(516,4,t,e)}function xs(t,e){return vs(516,4,t,e)}function ws(t,e){return vs(4,2,t,e)}function Es(t,e){return"function"==typeof e?(t=t(),e(t),function(){e(null)}):null!=e?(t=t(),e.current=t,function(){e.current=null}):void 0}function Ss(t,e,n){return n=null!=n?n.concat([t]):null,vs(4,2,Es.bind(null,e,t),n)}function Ts(){}function Ps(t,e){var n=ls();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&os(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Ms(t,e){var n=ls();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&os(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Cs(t,e){var n=Gi();qi(98>n?98:n,(function(){t(!0)})),qi(97<n?97:n,(function(){var n=Qo.transition;Qo.transition=1;try{t(!1),e()}finally{Qo.transition=n}}))}function Is(t,e,n){var r=ul(),i=cl(t),o={lane:i,action:n,eagerReducer:null,eagerState:null,next:null},s=e.pending;if(null===s?o.next=o:(o.next=s.next,s.next=o),e.pending=o,s=t.alternate,t===Jo||null!==s&&s===Jo)rs=ns=!0;else{if(0===t.lanes&&(null===s||0===s.lanes)&&null!==(s=e.lastRenderedReducer))try{var a=e.lastRenderedState,l=s(a,n);if(o.eagerReducer=s,o.eagerState=l,ur(l,a))return}catch(t){}hl(t,i,r)}}var Os={readContext:oo,useCallback:is,useContext:is,useEffect:is,useImperativeHandle:is,useLayoutEffect:is,useMemo:is,useReducer:is,useRef:is,useState:is,useDebugValue:is,useDeferredValue:is,useTransition:is,useMutableSource:is,useOpaqueIdentifier:is,unstable_isNewReconciler:!1},Rs={readContext:oo,useCallback:function(t,e){return as().memoizedState=[t,void 0===e?null:e],t},useContext:oo,useEffect:bs,useImperativeHandle:function(t,e,n){return n=null!=n?n.concat([t]):null,_s(4,2,Es.bind(null,e,t),n)},useLayoutEffect:function(t,e){return _s(4,2,t,e)},useMemo:function(t,e){var n=as();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=as();return e=void 0!==n?n(e):e,r.memoizedState=r.baseState=e,t=(t=r.queue={pending:null,dispatch:null,lastRenderedReducer:t,lastRenderedState:e}).dispatch=Is.bind(null,Jo,t),[r.memoizedState,t]},useRef:As,useState:gs,useDebugValue:Ts,useDeferredValue:function(t){var e=gs(t),n=e[0],r=e[1];return bs((function(){var e=Qo.transition;Qo.transition=1;try{r(t)}finally{Qo.transition=e}}),[t]),n},useTransition:function(){var t=gs(!1),e=t[0];return As(t=Cs.bind(null,t[1])),[t,e]},useMutableSource:function(t,e,n){var r=as();return r.memoizedState={refs:{getSnapshot:e,setSnapshot:null},source:t,subscribe:n},fs(r,t,e,n)},useOpaqueIdentifier:function(){if(Uo){var t=!1,e=function(t){return{$$typeof:D,toString:t,valueOf:t}}((function(){throw t||(t=!0,n("r:"+($r++).toString(36))),Error(s(355))})),n=gs(e)[1];return 0==(2&Jo.mode)&&(Jo.flags|=516,ms(5,(function(){n("r:"+($r++).toString(36))}),void 0,null)),e}return gs(e="r:"+($r++).toString(36)),e},unstable_isNewReconciler:!1},Ls={readContext:oo,useCallback:Ps,useContext:oo,useEffect:xs,useImperativeHandle:Ss,useLayoutEffect:ws,useMemo:Ms,useReducer:cs,useRef:ys,useState:function(){return cs(us)},useDebugValue:Ts,useDeferredValue:function(t){var e=cs(us),n=e[0],r=e[1];return xs((function(){var e=Qo.transition;Qo.transition=1;try{r(t)}finally{Qo.transition=e}}),[t]),n},useTransition:function(){var t=cs(us)[0];return[ys().current,t]},useMutableSource:ds,useOpaqueIdentifier:function(){return cs(us)[0]},unstable_isNewReconciler:!1},ks={readContext:oo,useCallback:Ps,useContext:oo,useEffect:xs,useImperativeHandle:Ss,useLayoutEffect:ws,useMemo:Ms,useReducer:hs,useRef:ys,useState:function(){return hs(us)},useDebugValue:Ts,useDeferredValue:function(t){var e=hs(us),n=e[0],r=e[1];return xs((function(){var e=Qo.transition;Qo.transition=1;try{r(t)}finally{Qo.transition=e}}),[t]),n},useTransition:function(){var t=hs(us)[0];return[ys().current,t]},useMutableSource:ds,useOpaqueIdentifier:function(){return hs(us)[0]},unstable_isNewReconciler:!1},Ds=b.ReactCurrentOwner,Ns=!1;function Fs(t,e,n,r){e.child=null===t?Po(e,null,n,r):To(e,t.child,n,r)}function Bs(t,e,n,r,i){n=n.render;var o=e.ref;return io(e,i),r=ss(t,e,n,r,o,i),null===t||Ns?(e.flags|=1,Fs(t,e,r,i),e.child):(e.updateQueue=t.updateQueue,e.flags&=-517,t.lanes&=~i,na(t,e,i))}function zs(t,e,n,r,i,o){if(null===t){var s=n.type;return"function"!=typeof s||Vl(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=Zl(n.type,null,r,e,e.mode,o)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=s,js(t,e,s,r,i,o))}return s=t.child,0==(i&o)&&(i=s.memoizedProps,(n=null!==(n=n.compare)?n:hr)(i,r)&&t.ref===e.ref)?na(t,e,o):(e.flags|=1,(t=Gl(s,r)).ref=e.ref,t.return=e,e.child=t)}function js(t,e,n,r,i,o){if(null!==t&&hr(t.memoizedProps,r)&&t.ref===e.ref){if(Ns=!1,0==(o&i))return e.lanes=t.lanes,na(t,e,o);0!=(16384&t.flags)&&(Ns=!0)}return Gs(t,e,n,r,o)}function Us(t,e,n){var r=e.pendingProps,i=r.children,o=null!==t?t.memoizedState:null;if("hidden"===r.mode||"unstable-defer-without-hiding"===r.mode)if(0==(4&e.mode))e.memoizedState={baseLanes:0},_l(0,n);else{if(0==(1073741824&n))return t=null!==o?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t},_l(0,t),null;e.memoizedState={baseLanes:0},_l(0,null!==o?o.baseLanes:n)}else null!==o?(r=o.baseLanes|n,e.memoizedState=null):r=n,_l(0,r);return Fs(t,e,i,n),e.child}function Vs(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.flags|=128)}function Gs(t,e,n,r,i){var o=mi(n)?di:pi.current;return o=gi(e,o),io(e,i),n=ss(t,e,n,r,o,i),null===t||Ns?(e.flags|=1,Fs(t,e,n,i),e.child):(e.updateQueue=t.updateQueue,e.flags&=-517,t.lanes&=~i,na(t,e,i))}function Zs(t,e,n,r,i){if(mi(n)){var o=!0;vi(e)}else o=!1;if(io(e,i),null===e.stateNode)null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),_o(e,n,r),bo(e,n,r,i),r=!0;else if(null===t){var s=e.stateNode,a=e.memoizedProps;s.props=a;var l=s.context,u=n.contextType;u="object"==typeof u&&null!==u?oo(u):gi(e,u=mi(n)?di:pi.current);var c=n.getDerivedStateFromProps,h="function"==typeof c||"function"==typeof s.getSnapshotBeforeUpdate;h||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==r||l!==u)&&vo(e,s,r,u),so=!1;var p=e.memoizedState;s.state=p,po(e,r,s,i),l=e.memoizedState,a!==r||p!==l||fi.current||so?("function"==typeof c&&(mo(e,n,c,r),l=e.memoizedState),(a=so||yo(e,n,a,r,p,l,u))?(h||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||("function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"==typeof s.componentDidMount&&(e.flags|=4)):("function"==typeof s.componentDidMount&&(e.flags|=4),e.memoizedProps=r,e.memoizedState=l),s.props=r,s.state=l,s.context=u,r=a):("function"==typeof s.componentDidMount&&(e.flags|=4),r=!1)}else{s=e.stateNode,lo(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Yi(e.type,a),s.props=u,h=e.pendingProps,p=s.context,l="object"==typeof(l=n.contextType)&&null!==l?oo(l):gi(e,l=mi(n)?di:pi.current);var f=n.getDerivedStateFromProps;(c="function"==typeof f||"function"==typeof s.getSnapshotBeforeUpdate)||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==h||p!==l)&&vo(e,s,r,l),so=!1,p=e.memoizedState,s.state=p,po(e,r,s,i);var d=e.memoizedState;a!==h||p!==d||fi.current||so?("function"==typeof f&&(mo(e,n,f,r),d=e.memoizedState),(u=so||yo(e,n,u,r,p,d,l))?(c||"function"!=typeof s.UNSAFE_componentWillUpdate&&"function"!=typeof s.componentWillUpdate||("function"==typeof s.componentWillUpdate&&s.componentWillUpdate(r,d,l),"function"==typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,d,l)),"function"==typeof s.componentDidUpdate&&(e.flags|=4),"function"==typeof s.getSnapshotBeforeUpdate&&(e.flags|=256)):("function"!=typeof s.componentDidUpdate||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=256),e.memoizedProps=r,e.memoizedState=d),s.props=r,s.state=d,s.context=l,r=u):("function"!=typeof s.componentDidUpdate||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=256),r=!1)}return qs(t,e,n,r,o,i)}function qs(t,e,n,r,i,o){Vs(t,e);var s=0!=(64&e.flags);if(!r&&!s)return i&&bi(e,n,!1),na(t,e,o);r=e.stateNode,Ds.current=e;var a=s&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return e.flags|=1,null!==t&&s?(e.child=To(e,t.child,null,o),e.child=To(e,null,a,o)):Fs(t,e,a,o),e.memoizedState=r.state,i&&bi(e,n,!0),e.child}function Ws(t){var e=t.stateNode;e.pendingContext?yi(0,e.pendingContext,e.pendingContext!==e.context):e.context&&yi(0,e.context,!1),Lo(t,e.containerInfo)}var Hs,Xs,$s,Ys={dehydrated:null,retryLane:0};function Qs(t,e,n){var r,i=e.pendingProps,o=Fo.current,s=!1;return(r=0!=(64&e.flags))||(r=(null===t||null!==t.memoizedState)&&0!=(2&o)),r?(s=!0,e.flags&=-65):null!==t&&null===t.memoizedState||void 0===i.fallback||!0===i.unstable_avoidThisFallback||(o|=1),ci(Fo,1&o),null===t?(void 0!==i.fallback&&Zo(e),t=i.children,o=i.fallback,s?(t=Ks(e,t,o,n),e.child.memoizedState={baseLanes:n},e.memoizedState=Ys,t):"number"==typeof i.unstable_expectedLoadTime?(t=Ks(e,t,o,n),e.child.memoizedState={baseLanes:n},e.memoizedState=Ys,e.lanes=33554432,t):((n=Wl({mode:"visible",children:t},e.mode,n,null)).return=e,e.child=n)):(t.memoizedState,s?(i=function(t,e,n,r,i){var o=e.mode,s=t.child;t=s.sibling;var a={mode:"hidden",children:n};return 0==(2&o)&&e.child!==s?((n=e.child).childLanes=0,n.pendingProps=a,null!==(s=n.lastEffect)?(e.firstEffect=n.firstEffect,e.lastEffect=s,s.nextEffect=null):e.firstEffect=e.lastEffect=null):n=Gl(s,a),null!==t?r=Gl(t,r):(r=ql(r,o,i,null)).flags|=2,r.return=e,n.return=e,n.sibling=r,e.child=n,r}(t,e,i.children,i.fallback,n),s=e.child,o=t.child.memoizedState,s.memoizedState=null===o?{baseLanes:n}:{baseLanes:o.baseLanes|n},s.childLanes=t.childLanes&~n,e.memoizedState=Ys,i):(n=function(t,e,n,r){var i=t.child;return t=i.sibling,n=Gl(i,{mode:"visible",children:n}),0==(2&e.mode)&&(n.lanes=r),n.return=e,n.sibling=null,null!==t&&(t.nextEffect=null,t.flags=8,e.firstEffect=e.lastEffect=t),e.child=n}(t,e,i.children,n),e.memoizedState=null,n))}function Ks(t,e,n,r){var i=t.mode,o=t.child;return e={mode:"hidden",children:e},0==(2&i)&&null!==o?(o.childLanes=0,o.pendingProps=e):o=Wl(e,i,0,null),n=ql(n,i,r,null),o.return=t,n.return=t,o.sibling=n,t.child=o,n}function Js(t,e){t.lanes|=e;var n=t.alternate;null!==n&&(n.lanes|=e),ro(t.return,e)}function ta(t,e,n,r,i,o){var s=t.memoizedState;null===s?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i,lastEffect:o}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i,s.lastEffect=o)}function ea(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(Fs(t,e,r.children,n),0!=(2&(r=Fo.current)))r=1&r|2,e.flags|=64;else{if(null!==t&&0!=(64&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&Js(t,n);else if(19===t.tag)Js(t,n);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ci(Fo,r),0==(2&e.mode))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;null!==n;)null!==(t=n.alternate)&&null===Bo(t)&&(i=n),n=n.sibling;null===(n=i)?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),ta(e,!1,i,n,o,e.lastEffect);break;case"backwards":for(n=null,i=e.child,e.child=null;null!==i;){if(null!==(t=i.alternate)&&null===Bo(t)){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}ta(e,!0,n,null,o,e.lastEffect);break;case"together":ta(e,!1,null,null,void 0,e.lastEffect);break;default:e.memoizedState=null}return e.child}function na(t,e,n){if(null!==t&&(e.dependencies=t.dependencies),Ba|=e.lanes,0!=(n&e.childLanes)){if(null!==t&&e.child!==t.child)throw Error(s(153));if(null!==e.child){for(n=Gl(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=Gl(t,t.pendingProps)).return=e;n.sibling=null}return e.child}return null}function ra(t,e){if(!Uo)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?e||null===t.tail?t.tail=null:t.tail.sibling=null:r.sibling=null}}function ia(t,e,n){var r=e.pendingProps;switch(e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return mi(e.type)&&Ai(),null;case 3:return ko(),ui(fi),ui(pi),$o(),(r=e.stateNode).pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==t&&null!==t.child||(Wo(e)?e.flags|=4:r.hydrate||(e.flags|=256)),null;case 5:No(e);var o=Ro(Oo.current);if(n=e.type,null!==t&&null!=e.stateNode)Xs(t,e,n,r),t.ref!==e.ref&&(e.flags|=128);else{if(!r){if(null===e.stateNode)throw Error(s(166));return null}if(t=Ro(Co.current),Wo(e)){r=e.stateNode,n=e.type;var a=e.memoizedProps;switch(r[Qr]=e,r[Kr]=a,n){case"dialog":Cr("cancel",r),Cr("close",r);break;case"iframe":case"object":case"embed":Cr("load",r);break;case"video":case"audio":for(t=0;t<Sr.length;t++)Cr(Sr[t],r);break;case"source":Cr("error",r);break;case"img":case"image":case"link":Cr("error",r),Cr("load",r);break;case"details":Cr("toggle",r);break;case"input":tt(r,a),Cr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Cr("invalid",r);break;case"textarea":lt(r,a),Cr("invalid",r)}for(var u in wt(n,a),t=null,a)a.hasOwnProperty(u)&&(o=a[u],"children"===u?"string"==typeof o?r.textContent!==o&&(t=["children",o]):"number"==typeof o&&r.textContent!==""+o&&(t=["children",""+o]):l.hasOwnProperty(u)&&null!=o&&"onScroll"===u&&Cr("scroll",r));switch(n){case"input":Y(r),rt(r,a,!0);break;case"textarea":Y(r),ct(r);break;case"select":case"option":break;default:"function"==typeof a.onClick&&(r.onclick=zr)}r=t,e.updateQueue=r,null!==r&&(e.flags|=4)}else{switch(u=9===o.nodeType?o:o.ownerDocument,t===ht&&(t=pt(n)),t===ht?"script"===n?((t=u.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"==typeof r.is?t=u.createElement(n,{is:r.is}):(t=u.createElement(n),"select"===n&&(u=t,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):t=u.createElementNS(t,n),t[Qr]=e,t[Kr]=r,Hs(t,e),e.stateNode=t,u=Et(n,r),n){case"dialog":Cr("cancel",t),Cr("close",t),o=r;break;case"iframe":case"object":case"embed":Cr("load",t),o=r;break;case"video":case"audio":for(o=0;o<Sr.length;o++)Cr(Sr[o],t);o=r;break;case"source":Cr("error",t),o=r;break;case"img":case"image":case"link":Cr("error",t),Cr("load",t),o=r;break;case"details":Cr("toggle",t),o=r;break;case"input":tt(t,r),o=J(t,r),Cr("invalid",t);break;case"option":o=ot(t,r);break;case"select":t._wrapperState={wasMultiple:!!r.multiple},o=i({},r,{value:void 0}),Cr("invalid",t);break;case"textarea":lt(t,r),o=at(t,r),Cr("invalid",t);break;default:o=r}wt(n,o);var c=o;for(a in c)if(c.hasOwnProperty(a)){var h=c[a];"style"===a?bt(t,h):"dangerouslySetInnerHTML"===a?null!=(h=h?h.__html:void 0)&&mt(t,h):"children"===a?"string"==typeof h?("textarea"!==n||""!==h)&&At(t,h):"number"==typeof h&&At(t,""+h):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(l.hasOwnProperty(a)?null!=h&&"onScroll"===a&&Cr("scroll",t):null!=h&&v(t,a,h,u))}switch(n){case"input":Y(t),rt(t,r,!1);break;case"textarea":Y(t),ct(t);break;case"option":null!=r.value&&t.setAttribute("value",""+X(r.value));break;case"select":t.multiple=!!r.multiple,null!=(a=r.value)?st(t,!!r.multiple,a,!1):null!=r.defaultValue&&st(t,!!r.multiple,r.defaultValue,!0);break;default:"function"==typeof o.onClick&&(t.onclick=zr)}Vr(n,r)&&(e.flags|=4)}null!==e.ref&&(e.flags|=128)}return null;case 6:if(t&&null!=e.stateNode)$s(0,e,t.memoizedProps,r);else{if("string"!=typeof r&&null===e.stateNode)throw Error(s(166));n=Ro(Oo.current),Ro(Co.current),Wo(e)?(r=e.stateNode,n=e.memoizedProps,r[Qr]=e,r.nodeValue!==n&&(e.flags|=4)):((r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[Qr]=e,e.stateNode=r)}return null;case 13:return ui(Fo),r=e.memoizedState,0!=(64&e.flags)?(e.lanes=n,e):(r=null!==r,n=!1,null===t?void 0!==e.memoizedProps.fallback&&Wo(e):n=null!==t.memoizedState,r&&!n&&0!=(2&e.mode)&&(null===t&&!0!==e.memoizedProps.unstable_avoidThisFallback||0!=(1&Fo.current)?0===Da&&(Da=3):(0!==Da&&3!==Da||(Da=4),null===Ia||0==(134217727&Ba)&&0==(134217727&za)||gl(Ia,Ra))),(r||n)&&(e.flags|=4),null);case 4:return ko(),null===t&&Or(e.stateNode.containerInfo),null;case 10:return no(e),null;case 19:if(ui(Fo),null===(r=e.memoizedState))return null;if(a=0!=(64&e.flags),null===(u=r.rendering))if(a)ra(r,!1);else{if(0!==Da||null!==t&&0!=(64&t.flags))for(t=e.child;null!==t;){if(null!==(u=Bo(t))){for(e.flags|=64,ra(r,!1),null!==(a=u.updateQueue)&&(e.updateQueue=a,e.flags|=4),null===r.lastEffect&&(e.firstEffect=null),e.lastEffect=r.lastEffect,r=n,n=e.child;null!==n;)t=r,(a=n).flags&=2,a.nextEffect=null,a.firstEffect=null,a.lastEffect=null,null===(u=a.alternate)?(a.childLanes=0,a.lanes=t,a.child=null,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=u.childLanes,a.lanes=u.lanes,a.child=u.child,a.memoizedProps=u.memoizedProps,a.memoizedState=u.memoizedState,a.updateQueue=u.updateQueue,a.type=u.type,t=u.dependencies,a.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ci(Fo,1&Fo.current|2),e.child}t=t.sibling}null!==r.tail&&Vi()>Ga&&(e.flags|=64,a=!0,ra(r,!1),e.lanes=33554432)}else{if(!a)if(null!==(t=Bo(u))){if(e.flags|=64,a=!0,null!==(n=t.updateQueue)&&(e.updateQueue=n,e.flags|=4),ra(r,!0),null===r.tail&&"hidden"===r.tailMode&&!u.alternate&&!Uo)return null!==(e=e.lastEffect=r.lastEffect)&&(e.nextEffect=null),null}else 2*Vi()-r.renderingStartTime>Ga&&1073741824!==n&&(e.flags|=64,a=!0,ra(r,!1),e.lanes=33554432);r.isBackwards?(u.sibling=e.child,e.child=u):(null!==(n=r.last)?n.sibling=u:e.child=u,r.last=u)}return null!==r.tail?(n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=e.lastEffect,r.renderingStartTime=Vi(),n.sibling=null,e=Fo.current,ci(Fo,a?1&e|2:1&e),n):null;case 23:case 24:return vl(),null!==t&&null!==t.memoizedState!=(null!==e.memoizedState)&&"unstable-defer-without-hiding"!==r.mode&&(e.flags|=4),null}throw Error(s(156,e.tag))}function oa(t){switch(t.tag){case 1:mi(t.type)&&Ai();var e=t.flags;return 4096&e?(t.flags=-4097&e|64,t):null;case 3:if(ko(),ui(fi),ui(pi),$o(),0!=(64&(e=t.flags)))throw Error(s(285));return t.flags=-4097&e|64,t;case 5:return No(t),null;case 13:return ui(Fo),4096&(e=t.flags)?(t.flags=-4097&e|64,t):null;case 19:return ui(Fo),null;case 4:return ko(),null;case 10:return no(t),null;case 23:case 24:return vl(),null;default:return null}}function sa(t,e){try{var n="",r=e;do{n+=W(r),r=r.return}while(r);var i=n}catch(t){i="\nError generating stack: "+t.message+"\n"+t.stack}return{value:t,source:e,stack:i}}function aa(t,e){try{console.error(e.value)}catch(t){setTimeout((function(){throw t}))}}Hs=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Xs=function(t,e,n,r){var o=t.memoizedProps;if(o!==r){t=e.stateNode,Ro(Co.current);var s,a=null;switch(n){case"input":o=J(t,o),r=J(t,r),a=[];break;case"option":o=ot(t,o),r=ot(t,r),a=[];break;case"select":o=i({},o,{value:void 0}),r=i({},r,{value:void 0}),a=[];break;case"textarea":o=at(t,o),r=at(t,r),a=[];break;default:"function"!=typeof o.onClick&&"function"==typeof r.onClick&&(t.onclick=zr)}for(h in wt(n,r),n=null,o)if(!r.hasOwnProperty(h)&&o.hasOwnProperty(h)&&null!=o[h])if("style"===h){var u=o[h];for(s in u)u.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==h&&"children"!==h&&"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&"autoFocus"!==h&&(l.hasOwnProperty(h)?a||(a=[]):(a=a||[]).push(h,null));for(h in r){var c=r[h];if(u=null!=o?o[h]:void 0,r.hasOwnProperty(h)&&c!==u&&(null!=c||null!=u))if("style"===h)if(u){for(s in u)!u.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&u[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(a||(a=[]),a.push(h,n)),n=c;else"dangerouslySetInnerHTML"===h?(c=c?c.__html:void 0,u=u?u.__html:void 0,null!=c&&u!==c&&(a=a||[]).push(h,c)):"children"===h?"string"!=typeof c&&"number"!=typeof c||(a=a||[]).push(h,""+c):"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&(l.hasOwnProperty(h)?(null!=c&&"onScroll"===h&&Cr("scroll",t),a||u===c||(a=[])):"object"==typeof c&&null!==c&&c.$$typeof===D?c.toString():(a=a||[]).push(h,c))}n&&(a=a||[]).push("style",n);var h=a;(e.updateQueue=h)&&(e.flags|=4)}},$s=function(t,e,n,r){n!==r&&(e.flags|=4)};var la="function"==typeof WeakMap?WeakMap:Map;function ua(t,e,n){(n=uo(-1,n)).tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Ha||(Ha=!0,Xa=r),aa(0,e)},n}function ca(t,e,n){(n=uo(-1,n)).tag=3;var r=t.type.getDerivedStateFromError;if("function"==typeof r){var i=e.value;n.payload=function(){return aa(0,e),r(i)}}var o=t.stateNode;return null!==o&&"function"==typeof o.componentDidCatch&&(n.callback=function(){"function"!=typeof r&&(null===$a?$a=new Set([this]):$a.add(this),aa(0,e));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),n}var ha="function"==typeof WeakSet?WeakSet:Set;function pa(t){var e=t.ref;if(null!==e)if("function"==typeof e)try{e(null)}catch(e){Fl(t,e)}else e.current=null}function fa(t,e){switch(e.tag){case 0:case 11:case 15:case 22:case 5:case 6:case 4:case 17:return;case 1:if(256&e.flags&&null!==t){var n=t.memoizedProps,r=t.memoizedState;e=(t=e.stateNode).getSnapshotBeforeUpdate(e.elementType===e.type?n:Yi(e.type,n),r),t.__reactInternalSnapshotBeforeUpdate=e}return;case 3:return void(256&e.flags&&Wr(e.stateNode.containerInfo))}throw Error(s(163))}function da(t,e,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(e=null!==(e=n.updateQueue)?e.lastEffect:null)){t=e=e.next;do{if(3==(3&t.tag)){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}if(null!==(e=null!==(e=n.updateQueue)?e.lastEffect:null)){t=e=e.next;do{var i=t;r=i.next,0!=(4&(i=i.tag))&&0!=(1&i)&&(kl(n,t),Ll(n,t)),t=r}while(t!==e)}return;case 1:return t=n.stateNode,4&n.flags&&(null===e?t.componentDidMount():(r=n.elementType===n.type?e.memoizedProps:Yi(n.type,e.memoizedProps),t.componentDidUpdate(r,e.memoizedState,t.__reactInternalSnapshotBeforeUpdate))),void(null!==(e=n.updateQueue)&&fo(n,e,t));case 3:if(null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 5:case 1:t=n.child.stateNode}fo(n,e,t)}return;case 5:return t=n.stateNode,void(null===e&&4&n.flags&&Vr(n.type,n.memoizedProps)&&t.focus());case 6:case 4:case 12:case 19:case 17:case 20:case 21:case 23:case 24:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&be(n)))))}throw Error(s(163))}function ga(t,e){for(var n=t;;){if(5===n.tag){var r=n.stateNode;if(e)"function"==typeof(r=r.style).setProperty?r.setProperty("display","none","important"):r.display="none";else{r=n.stateNode;var i=n.memoizedProps.style;i=null!=i&&i.hasOwnProperty("display")?i.display:null,r.style.display=vt("display",i)}}else if(6===n.tag)n.stateNode.nodeValue=e?"":n.memoizedProps;else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===t)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function ma(t,e){if(wi&&"function"==typeof wi.onCommitFiberUnmount)try{wi.onCommitFiberUnmount(xi,e)}catch(t){}switch(e.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(t=e.updateQueue)&&null!==(t=t.lastEffect)){var n=t=t.next;do{var r=n,i=r.destroy;if(r=r.tag,void 0!==i)if(0!=(4&r))kl(e,n);else{r=e;try{i()}catch(t){Fl(r,t)}}n=n.next}while(n!==t)}break;case 1:if(pa(e),"function"==typeof(t=e.stateNode).componentWillUnmount)try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(t){Fl(e,t)}break;case 5:pa(e);break;case 4:xa(t,e)}}function Aa(t){t.alternate=null,t.child=null,t.dependencies=null,t.firstEffect=null,t.lastEffect=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.return=null,t.updateQueue=null}function ya(t){return 5===t.tag||3===t.tag||4===t.tag}function _a(t){t:{for(var e=t.return;null!==e;){if(ya(e))break t;e=e.return}throw Error(s(160))}var n=e;switch(e=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:e=e.containerInfo,r=!0;break;default:throw Error(s(161))}16&n.flags&&(At(e,""),n.flags&=-17);t:e:for(n=t;;){for(;null===n.sibling;){if(null===n.return||ya(n.return)){n=null;break t}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue e;if(null===n.child||4===n.tag)continue e;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break t}}r?va(t,n,e):ba(t,n,e)}function va(t,e,n){var r=t.tag,i=5===r||6===r;if(i)t=i?t.stateNode:t.stateNode.instance,e?8===n.nodeType?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(8===n.nodeType?(e=n.parentNode).insertBefore(t,n):(e=n).appendChild(t),null!=(n=n._reactRootContainer)||null!==e.onclick||(e.onclick=zr));else if(4!==r&&null!==(t=t.child))for(va(t,e,n),t=t.sibling;null!==t;)va(t,e,n),t=t.sibling}function ba(t,e,n){var r=t.tag,i=5===r||6===r;if(i)t=i?t.stateNode:t.stateNode.instance,e?n.insertBefore(t,e):n.appendChild(t);else if(4!==r&&null!==(t=t.child))for(ba(t,e,n),t=t.sibling;null!==t;)ba(t,e,n),t=t.sibling}function xa(t,e){for(var n,r,i=e,o=!1;;){if(!o){o=i.return;t:for(;;){if(null===o)throw Error(s(160));switch(n=o.stateNode,o.tag){case 5:r=!1;break t;case 3:case 4:n=n.containerInfo,r=!0;break t}o=o.return}o=!0}if(5===i.tag||6===i.tag){t:for(var a=t,l=i,u=l;;)if(ma(a,u),null!==u.child&&4!==u.tag)u.child.return=u,u=u.child;else{if(u===l)break t;for(;null===u.sibling;){if(null===u.return||u.return===l)break t;u=u.return}u.sibling.return=u.return,u=u.sibling}r?(a=n,l=i.stateNode,8===a.nodeType?a.parentNode.removeChild(l):a.removeChild(l)):n.removeChild(i.stateNode)}else if(4===i.tag){if(null!==i.child){n=i.stateNode.containerInfo,r=!0,i.child.return=i,i=i.child;continue}}else if(ma(t,i),null!==i.child){i.child.return=i,i=i.child;continue}if(i===e)break;for(;null===i.sibling;){if(null===i.return||i.return===e)return;4===(i=i.return).tag&&(o=!1)}i.sibling.return=i.return,i=i.sibling}}function wa(t,e){switch(e.tag){case 0:case 11:case 14:case 15:case 22:var n=e.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{3==(3&r.tag)&&(t=r.destroy,r.destroy=void 0,void 0!==t&&t()),r=r.next}while(r!==n)}return;case 1:case 12:case 17:return;case 5:if(null!=(n=e.stateNode)){r=e.memoizedProps;var i=null!==t?t.memoizedProps:r;t=e.type;var o=e.updateQueue;if(e.updateQueue=null,null!==o){for(n[Kr]=r,"input"===t&&"radio"===r.type&&null!=r.name&&et(n,r),Et(t,i),e=Et(t,r),i=0;i<o.length;i+=2){var a=o[i],l=o[i+1];"style"===a?bt(n,l):"dangerouslySetInnerHTML"===a?mt(n,l):"children"===a?At(n,l):v(n,a,l,e)}switch(t){case"input":nt(n,r);break;case"textarea":ut(n,r);break;case"select":t=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(o=r.value)?st(n,!!r.multiple,o,!1):t!==!!r.multiple&&(null!=r.defaultValue?st(n,!!r.multiple,r.defaultValue,!0):st(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===e.stateNode)throw Error(s(162));return void(e.stateNode.nodeValue=e.memoizedProps);case 3:return void((n=e.stateNode).hydrate&&(n.hydrate=!1,be(n.containerInfo)));case 13:return null!==e.memoizedState&&(Va=Vi(),ga(e.child,!0)),void Ea(e);case 19:return void Ea(e);case 23:case 24:return void ga(e,null!==e.memoizedState)}throw Error(s(163))}function Ea(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new ha),e.forEach((function(e){var r=zl.bind(null,t,e);n.has(e)||(n.add(e),e.then(r,r))}))}}function Sa(t,e){return null!==t&&(null===(t=t.memoizedState)||null!==t.dehydrated)&&null!==(e=e.memoizedState)&&null===e.dehydrated}var Ta=Math.ceil,Pa=b.ReactCurrentDispatcher,Ma=b.ReactCurrentOwner,Ca=0,Ia=null,Oa=null,Ra=0,La=0,ka=li(0),Da=0,Na=null,Fa=0,Ba=0,za=0,ja=0,Ua=null,Va=0,Ga=1/0;function Za(){Ga=Vi()+500}var qa,Wa=null,Ha=!1,Xa=null,$a=null,Ya=!1,Qa=null,Ka=90,Ja=[],tl=[],el=null,nl=0,rl=null,il=-1,ol=0,sl=0,al=null,ll=!1;function ul(){return 0!=(48&Ca)?Vi():-1!==il?il:il=Vi()}function cl(t){if(0==(2&(t=t.mode)))return 1;if(0==(4&t))return 99===Gi()?1:2;if(0===ol&&(ol=Fa),0!==$i.transition){0!==sl&&(sl=null!==Ua?Ua.pendingLanes:0),t=ol;var e=4186112&~sl;return 0==(e&=-e)&&0==(e=(t=4186112&~t)&-t)&&(e=8192),e}return t=Gi(),t=ze(0!=(4&Ca)&&98===t?12:t=function(t){switch(t){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(t),ol)}function hl(t,e,n){if(50<nl)throw nl=0,rl=null,Error(s(185));if(null===(t=pl(t,e)))return null;Ve(t,e,n),t===Ia&&(za|=e,4===Da&&gl(t,Ra));var r=Gi();1===e?0!=(8&Ca)&&0==(48&Ca)?ml(t):(fl(t,n),0===Ca&&(Za(),Hi())):(0==(4&Ca)||98!==r&&99!==r||(null===el?el=new Set([t]):el.add(t)),fl(t,n)),Ua=t}function pl(t,e){t.lanes|=e;var n=t.alternate;for(null!==n&&(n.lanes|=e),n=t,t=t.return;null!==t;)t.childLanes|=e,null!==(n=t.alternate)&&(n.childLanes|=e),n=t,t=t.return;return 3===n.tag?n.stateNode:null}function fl(t,e){for(var n=t.callbackNode,r=t.suspendedLanes,i=t.pingedLanes,o=t.expirationTimes,a=t.pendingLanes;0<a;){var l=31-Ge(a),u=1<<l,c=o[l];if(-1===c){if(0==(u&r)||0!=(u&i)){c=e,Ne(u);var h=De;o[l]=10<=h?c+250:6<=h?c+5e3:-1}}else c<=e&&(t.expiredLanes|=u);a&=~u}if(r=Fe(t,t===Ia?Ra:0),e=De,0===r)null!==n&&(n!==Ni&&Ti(n),t.callbackNode=null,t.callbackPriority=0);else{if(null!==n){if(t.callbackPriority===e)return;n!==Ni&&Ti(n)}15===e?(n=ml.bind(null,t),null===Bi?(Bi=[n],zi=Si(Oi,Xi)):Bi.push(n),n=Ni):14===e?n=Wi(99,ml.bind(null,t)):(n=function(t){switch(t){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(s(358,t))}}(e),n=Wi(n,dl.bind(null,t))),t.callbackPriority=e,t.callbackNode=n}}function dl(t){if(il=-1,sl=ol=0,0!=(48&Ca))throw Error(s(327));var e=t.callbackNode;if(Rl()&&t.callbackNode!==e)return null;var n=Fe(t,t===Ia?Ra:0);if(0===n)return null;var r=n,i=Ca;Ca|=16;var o=wl();for(Ia===t&&Ra===r||(Za(),bl(t,r));;)try{Tl();break}catch(e){xl(t,e)}if(eo(),Pa.current=o,Ca=i,null!==Oa?r=0:(Ia=null,Ra=0,r=Da),0!=(Fa&za))bl(t,0);else if(0!==r){if(2===r&&(Ca|=64,t.hydrate&&(t.hydrate=!1,Wr(t.containerInfo)),0!==(n=Be(t))&&(r=El(t,n))),1===r)throw e=Na,bl(t,0),gl(t,n),fl(t,Vi()),e;switch(t.finishedWork=t.current.alternate,t.finishedLanes=n,r){case 0:case 1:throw Error(s(345));case 2:case 5:Cl(t);break;case 3:if(gl(t,n),(62914560&n)===n&&10<(r=Va+500-Vi())){if(0!==Fe(t,0))break;if(((i=t.suspendedLanes)&n)!==n){ul(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Zr(Cl.bind(null,t),r);break}Cl(t);break;case 4:if(gl(t,n),(4186112&n)===n)break;for(r=t.eventTimes,i=-1;0<n;){var a=31-Ge(n);o=1<<a,(a=r[a])>i&&(i=a),n&=~o}if(n=i,10<(n=(120>(n=Vi()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Ta(n/1960))-n)){t.timeoutHandle=Zr(Cl.bind(null,t),n);break}Cl(t);break;default:throw Error(s(329))}}return fl(t,Vi()),t.callbackNode===e?dl.bind(null,t):null}function gl(t,e){for(e&=~ja,e&=~za,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ge(e),r=1<<n;t[n]=-1,e&=~r}}function ml(t){if(0!=(48&Ca))throw Error(s(327));if(Rl(),t===Ia&&0!=(t.expiredLanes&Ra)){var e=Ra,n=El(t,e);0!=(Fa&za)&&(n=El(t,e=Fe(t,e)))}else n=El(t,e=Fe(t,0));if(0!==t.tag&&2===n&&(Ca|=64,t.hydrate&&(t.hydrate=!1,Wr(t.containerInfo)),0!==(e=Be(t))&&(n=El(t,e))),1===n)throw n=Na,bl(t,0),gl(t,e),fl(t,Vi()),n;return t.finishedWork=t.current.alternate,t.finishedLanes=e,Cl(t),fl(t,Vi()),null}function Al(t,e){var n=Ca;Ca|=1;try{return t(e)}finally{0===(Ca=n)&&(Za(),Hi())}}function yl(t,e){var n=Ca;Ca&=-2,Ca|=8;try{return t(e)}finally{0===(Ca=n)&&(Za(),Hi())}}function _l(t,e){ci(ka,La),La|=e,Fa|=e}function vl(){La=ka.current,ui(ka)}function bl(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(-1!==n&&(t.timeoutHandle=-1,qr(n)),null!==Oa)for(n=Oa.return;null!==n;){var r=n;switch(r.tag){case 1:null!=(r=r.type.childContextTypes)&&Ai();break;case 3:ko(),ui(fi),ui(pi),$o();break;case 5:No(r);break;case 4:ko();break;case 13:case 19:ui(Fo);break;case 10:no(r);break;case 23:case 24:vl()}n=n.return}Ia=t,Oa=Gl(t.current,null),Ra=La=Fa=e,Da=0,Na=null,ja=za=Ba=0}function xl(t,e){for(;;){var n=Oa;try{if(eo(),Yo.current=Os,ns){for(var r=Jo.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}ns=!1}if(Ko=0,es=ts=Jo=null,rs=!1,Ma.current=null,null===n||null===n.return){Da=1,Na=e,Oa=null;break}t:{var o=t,s=n.return,a=n,l=e;if(e=Ra,a.flags|=2048,a.firstEffect=a.lastEffect=null,null!==l&&"object"==typeof l&&"function"==typeof l.then){var u=l;if(0==(2&a.mode)){var c=a.alternate;c?(a.updateQueue=c.updateQueue,a.memoizedState=c.memoizedState,a.lanes=c.lanes):(a.updateQueue=null,a.memoizedState=null)}var h=0!=(1&Fo.current),p=s;do{var f;if(f=13===p.tag){var d=p.memoizedState;if(null!==d)f=null!==d.dehydrated;else{var g=p.memoizedProps;f=void 0!==g.fallback&&(!0!==g.unstable_avoidThisFallback||!h)}}if(f){var m=p.updateQueue;if(null===m){var A=new Set;A.add(u),p.updateQueue=A}else m.add(u);if(0==(2&p.mode)){if(p.flags|=64,a.flags|=16384,a.flags&=-2981,1===a.tag)if(null===a.alternate)a.tag=17;else{var y=uo(-1,1);y.tag=2,co(a,y)}a.lanes|=1;break t}l=void 0,a=e;var _=o.pingCache;if(null===_?(_=o.pingCache=new la,l=new Set,_.set(u,l)):void 0===(l=_.get(u))&&(l=new Set,_.set(u,l)),!l.has(a)){l.add(a);var v=Bl.bind(null,o,u,a);u.then(v,v)}p.flags|=4096,p.lanes=e;break t}p=p.return}while(null!==p);l=Error((H(a.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==Da&&(Da=2),l=sa(l,a),p=s;do{switch(p.tag){case 3:o=l,p.flags|=4096,e&=-e,p.lanes|=e,ho(p,ua(0,o,e));break t;case 1:o=l;var b=p.type,x=p.stateNode;if(0==(64&p.flags)&&("function"==typeof b.getDerivedStateFromError||null!==x&&"function"==typeof x.componentDidCatch&&(null===$a||!$a.has(x)))){p.flags|=4096,e&=-e,p.lanes|=e,ho(p,ca(p,o,e));break t}}p=p.return}while(null!==p)}Ml(n)}catch(t){e=t,Oa===n&&null!==n&&(Oa=n=n.return);continue}break}}function wl(){var t=Pa.current;return Pa.current=Os,null===t?Os:t}function El(t,e){var n=Ca;Ca|=16;var r=wl();for(Ia===t&&Ra===e||bl(t,e);;)try{Sl();break}catch(e){xl(t,e)}if(eo(),Ca=n,Pa.current=r,null!==Oa)throw Error(s(261));return Ia=null,Ra=0,Da}function Sl(){for(;null!==Oa;)Pl(Oa)}function Tl(){for(;null!==Oa&&!Pi();)Pl(Oa)}function Pl(t){var e=qa(t.alternate,t,La);t.memoizedProps=t.pendingProps,null===e?Ml(t):Oa=e,Ma.current=null}function Ml(t){var e=t;do{var n=e.alternate;if(t=e.return,0==(2048&e.flags)){if(null!==(n=ia(n,e,La)))return void(Oa=n);if(24!==(n=e).tag&&23!==n.tag||null===n.memoizedState||0!=(1073741824&La)||0==(4&n.mode)){for(var r=0,i=n.child;null!==i;)r|=i.lanes|i.childLanes,i=i.sibling;n.childLanes=r}null!==t&&0==(2048&t.flags)&&(null===t.firstEffect&&(t.firstEffect=e.firstEffect),null!==e.lastEffect&&(null!==t.lastEffect&&(t.lastEffect.nextEffect=e.firstEffect),t.lastEffect=e.lastEffect),1<e.flags&&(null!==t.lastEffect?t.lastEffect.nextEffect=e:t.firstEffect=e,t.lastEffect=e))}else{if(null!==(n=oa(e)))return n.flags&=2047,void(Oa=n);null!==t&&(t.firstEffect=t.lastEffect=null,t.flags|=2048)}if(null!==(e=e.sibling))return void(Oa=e);Oa=e=t}while(null!==e);0===Da&&(Da=5)}function Cl(t){var e=Gi();return qi(99,Il.bind(null,t,e)),null}function Il(t,e){do{Rl()}while(null!==Qa);if(0!=(48&Ca))throw Error(s(327));var n=t.finishedWork;if(null===n)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(s(177));t.callbackNode=null;var r=n.lanes|n.childLanes,i=r,o=t.pendingLanes&~i;t.pendingLanes=i,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=i,t.mutableReadLanes&=i,t.entangledLanes&=i,i=t.entanglements;for(var a=t.eventTimes,l=t.expirationTimes;0<o;){var u=31-Ge(o),c=1<<u;i[u]=0,a[u]=-1,l[u]=-1,o&=~c}if(null!==el&&0==(24&r)&&el.has(t)&&el.delete(t),t===Ia&&(Oa=Ia=null,Ra=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,r=n.firstEffect):r=n:r=n.firstEffect,null!==r){if(i=Ca,Ca|=32,Ma.current=null,jr=Xe,mr(a=gr())){if("selectionStart"in a)l={start:a.selectionStart,end:a.selectionEnd};else t:if(l=(l=a.ownerDocument)&&l.defaultView||window,(c=l.getSelection&&l.getSelection())&&0!==c.rangeCount){l=c.anchorNode,o=c.anchorOffset,u=c.focusNode,c=c.focusOffset;try{l.nodeType,u.nodeType}catch(t){l=null;break t}var h=0,p=-1,f=-1,d=0,g=0,m=a,A=null;e:for(;;){for(var y;m!==l||0!==o&&3!==m.nodeType||(p=h+o),m!==u||0!==c&&3!==m.nodeType||(f=h+c),3===m.nodeType&&(h+=m.nodeValue.length),null!==(y=m.firstChild);)A=m,m=y;for(;;){if(m===a)break e;if(A===l&&++d===o&&(p=h),A===u&&++g===c&&(f=h),null!==(y=m.nextSibling))break;A=(m=A).parentNode}m=y}l=-1===p||-1===f?null:{start:p,end:f}}else l=null;l=l||{start:0,end:0}}else l=null;Ur={focusedElem:a,selectionRange:l},Xe=!1,al=null,ll=!1,Wa=r;do{try{Ol()}catch(t){if(null===Wa)throw Error(s(330));Fl(Wa,t),Wa=Wa.nextEffect}}while(null!==Wa);al=null,Wa=r;do{try{for(a=t;null!==Wa;){var _=Wa.flags;if(16&_&&At(Wa.stateNode,""),128&_){var v=Wa.alternate;if(null!==v){var b=v.ref;null!==b&&("function"==typeof b?b(null):b.current=null)}}switch(1038&_){case 2:_a(Wa),Wa.flags&=-3;break;case 6:_a(Wa),Wa.flags&=-3,wa(Wa.alternate,Wa);break;case 1024:Wa.flags&=-1025;break;case 1028:Wa.flags&=-1025,wa(Wa.alternate,Wa);break;case 4:wa(Wa.alternate,Wa);break;case 8:xa(a,l=Wa);var x=l.alternate;Aa(l),null!==x&&Aa(x)}Wa=Wa.nextEffect}}catch(t){if(null===Wa)throw Error(s(330));Fl(Wa,t),Wa=Wa.nextEffect}}while(null!==Wa);if(b=Ur,v=gr(),_=b.focusedElem,a=b.selectionRange,v!==_&&_&&_.ownerDocument&&dr(_.ownerDocument.documentElement,_)){null!==a&&mr(_)&&(v=a.start,void 0===(b=a.end)&&(b=v),"selectionStart"in _?(_.selectionStart=v,_.selectionEnd=Math.min(b,_.value.length)):(b=(v=_.ownerDocument||document)&&v.defaultView||window).getSelection&&(b=b.getSelection(),l=_.textContent.length,x=Math.min(a.start,l),a=void 0===a.end?x:Math.min(a.end,l),!b.extend&&x>a&&(l=a,a=x,x=l),l=fr(_,x),o=fr(_,a),l&&o&&(1!==b.rangeCount||b.anchorNode!==l.node||b.anchorOffset!==l.offset||b.focusNode!==o.node||b.focusOffset!==o.offset)&&((v=v.createRange()).setStart(l.node,l.offset),b.removeAllRanges(),x>a?(b.addRange(v),b.extend(o.node,o.offset)):(v.setEnd(o.node,o.offset),b.addRange(v))))),v=[];for(b=_;b=b.parentNode;)1===b.nodeType&&v.push({element:b,left:b.scrollLeft,top:b.scrollTop});for("function"==typeof _.focus&&_.focus(),_=0;_<v.length;_++)(b=v[_]).element.scrollLeft=b.left,b.element.scrollTop=b.top}Xe=!!jr,Ur=jr=null,t.current=n,Wa=r;do{try{for(_=t;null!==Wa;){var w=Wa.flags;if(36&w&&da(_,Wa.alternate,Wa),128&w){v=void 0;var E=Wa.ref;if(null!==E){var S=Wa.stateNode;Wa.tag,v=S,"function"==typeof E?E(v):E.current=v}}Wa=Wa.nextEffect}}catch(t){if(null===Wa)throw Error(s(330));Fl(Wa,t),Wa=Wa.nextEffect}}while(null!==Wa);Wa=null,Fi(),Ca=i}else t.current=n;if(Ya)Ya=!1,Qa=t,Ka=e;else for(Wa=r;null!==Wa;)e=Wa.nextEffect,Wa.nextEffect=null,8&Wa.flags&&((w=Wa).sibling=null,w.stateNode=null),Wa=e;if(0===(r=t.pendingLanes)&&($a=null),1===r?t===rl?nl++:(nl=0,rl=t):nl=0,n=n.stateNode,wi&&"function"==typeof wi.onCommitFiberRoot)try{wi.onCommitFiberRoot(xi,n,void 0,64==(64&n.current.flags))}catch(t){}if(fl(t,Vi()),Ha)throw Ha=!1,t=Xa,Xa=null,t;return 0!=(8&Ca)||Hi(),null}function Ol(){for(;null!==Wa;){var t=Wa.alternate;ll||null===al||(0!=(8&Wa.flags)?Jt(Wa,al)&&(ll=!0):13===Wa.tag&&Sa(t,Wa)&&Jt(Wa,al)&&(ll=!0));var e=Wa.flags;0!=(256&e)&&fa(t,Wa),0==(512&e)||Ya||(Ya=!0,Wi(97,(function(){return Rl(),null}))),Wa=Wa.nextEffect}}function Rl(){if(90!==Ka){var t=97<Ka?97:Ka;return Ka=90,qi(t,Dl)}return!1}function Ll(t,e){Ja.push(e,t),Ya||(Ya=!0,Wi(97,(function(){return Rl(),null})))}function kl(t,e){tl.push(e,t),Ya||(Ya=!0,Wi(97,(function(){return Rl(),null})))}function Dl(){if(null===Qa)return!1;var t=Qa;if(Qa=null,0!=(48&Ca))throw Error(s(331));var e=Ca;Ca|=32;var n=tl;tl=[];for(var r=0;r<n.length;r+=2){var i=n[r],o=n[r+1],a=i.destroy;if(i.destroy=void 0,"function"==typeof a)try{a()}catch(t){if(null===o)throw Error(s(330));Fl(o,t)}}for(n=Ja,Ja=[],r=0;r<n.length;r+=2){i=n[r],o=n[r+1];try{var l=i.create;i.destroy=l()}catch(t){if(null===o)throw Error(s(330));Fl(o,t)}}for(l=t.current.firstEffect;null!==l;)t=l.nextEffect,l.nextEffect=null,8&l.flags&&(l.sibling=null,l.stateNode=null),l=t;return Ca=e,Hi(),!0}function Nl(t,e,n){co(t,e=ua(0,e=sa(n,e),1)),e=ul(),null!==(t=pl(t,1))&&(Ve(t,1,e),fl(t,e))}function Fl(t,e){if(3===t.tag)Nl(t,t,e);else for(var n=t.return;null!==n;){if(3===n.tag){Nl(n,t,e);break}if(1===n.tag){var r=n.stateNode;if("function"==typeof n.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===$a||!$a.has(r))){var i=ca(n,t=sa(e,t),1);if(co(n,i),i=ul(),null!==(n=pl(n,1)))Ve(n,1,i),fl(n,i);else if("function"==typeof r.componentDidCatch&&(null===$a||!$a.has(r)))try{r.componentDidCatch(e,t)}catch(t){}break}}n=n.return}}function Bl(t,e,n){var r=t.pingCache;null!==r&&r.delete(e),e=ul(),t.pingedLanes|=t.suspendedLanes&n,Ia===t&&(Ra&n)===n&&(4===Da||3===Da&&(62914560&Ra)===Ra&&500>Vi()-Va?bl(t,0):ja|=n),fl(t,e)}function zl(t,e){var n=t.stateNode;null!==n&&n.delete(e),0==(e=0)&&(0==(2&(e=t.mode))?e=1:0==(4&e)?e=99===Gi()?1:2:(0===ol&&(ol=Fa),0===(e=je(62914560&~ol))&&(e=4194304))),n=ul(),null!==(t=pl(t,e))&&(Ve(t,e,n),fl(t,n))}function jl(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function Ul(t,e,n,r){return new jl(t,e,n,r)}function Vl(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Gl(t,e){var n=t.alternate;return null===n?((n=Ul(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Zl(t,e,n,r,i,o){var a=2;if(r=t,"function"==typeof t)Vl(t)&&(a=1);else if("string"==typeof t)a=5;else t:switch(t){case E:return ql(n.children,i,o,e);case N:a=8,i|=16;break;case S:a=8,i|=1;break;case T:return(t=Ul(12,n,e,8|i)).elementType=T,t.type=T,t.lanes=o,t;case I:return(t=Ul(13,n,e,i)).type=I,t.elementType=I,t.lanes=o,t;case O:return(t=Ul(19,n,e,i)).elementType=O,t.lanes=o,t;case F:return Wl(n,i,o,e);case B:return(t=Ul(24,n,e,i)).elementType=B,t.lanes=o,t;default:if("object"==typeof t&&null!==t)switch(t.$$typeof){case P:a=10;break t;case M:a=9;break t;case C:a=11;break t;case R:a=14;break t;case L:a=16,r=null;break t;case k:a=22;break t}throw Error(s(130,null==t?t:typeof t,""))}return(e=Ul(a,n,e,i)).elementType=t,e.type=r,e.lanes=o,e}function ql(t,e,n,r){return(t=Ul(7,t,r,e)).lanes=n,t}function Wl(t,e,n,r){return(t=Ul(23,t,r,e)).elementType=F,t.lanes=n,t}function Hl(t,e,n){return(t=Ul(6,t,null,e)).lanes=n,t}function Xl(t,e,n){return(e=Ul(4,null!==t.children?t.children:[],t.key,e)).lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function $l(t,e,n){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=Ue(0),this.expirationTimes=Ue(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ue(0),this.mutableSourceEagerHydrationData=null}function Yl(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==r?null:""+r,children:t,containerInfo:e,implementation:n}}function Ql(t,e,n,r){var i=e.current,o=ul(),a=cl(i);t:if(n){e:{if($t(n=n._reactInternals)!==n||1!==n.tag)throw Error(s(170));var l=n;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(mi(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(null!==l);throw Error(s(171))}if(1===n.tag){var u=n.type;if(mi(u)){n=_i(n,u,l);break t}}n=l}else n=hi;return null===e.context?e.context=n:e.pendingContext=n,(e=uo(o,a)).payload={element:t},null!==(r=void 0===r?null:r)&&(e.callback=r),co(i,e),hl(i,a,o),a}function Kl(t){return(t=t.current).child?(t.child.tag,t.child.stateNode):null}function Jl(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var n=t.retryLane;t.retryLane=0!==n&&n<e?n:e}}function tu(t,e){Jl(t,e),(t=t.alternate)&&Jl(t,e)}function eu(t,e,n){var r=null!=n&&null!=n.hydrationOptions&&n.hydrationOptions.mutableSources||null;if(n=new $l(t,e,null!=n&&!0===n.hydrate),e=Ul(3,null,null,2===e?7:1===e?3:0),n.current=e,e.stateNode=n,ao(e),t[Jr]=n.current,Or(8===t.nodeType?t.parentNode:t),r)for(t=0;t<r.length;t++){var i=(e=r[t])._getVersion;i=i(e._source),null==n.mutableSourceEagerHydrationData?n.mutableSourceEagerHydrationData=[e,i]:n.mutableSourceEagerHydrationData.push(e,i)}this._internalRoot=n}function nu(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function ru(t,e,n,r,i){var o=n._reactRootContainer;if(o){var s=o._internalRoot;if("function"==typeof i){var a=i;i=function(){var t=Kl(s);a.call(t)}}Ql(e,s,t,i)}else{if(o=n._reactRootContainer=function(t,e){if(e||(e=!(!(e=t?9===t.nodeType?t.documentElement:t.firstChild:null)||1!==e.nodeType||!e.hasAttribute("data-reactroot"))),!e)for(var n;n=t.lastChild;)t.removeChild(n);return new eu(t,0,e?{hydrate:!0}:void 0)}(n,r),s=o._internalRoot,"function"==typeof i){var l=i;i=function(){var t=Kl(s);l.call(t)}}yl((function(){Ql(e,s,t,i)}))}return Kl(s)}function iu(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!nu(e))throw Error(s(200));return Yl(t,e,null,n)}qa=function(t,e,n){var r=e.lanes;if(null!==t)if(t.memoizedProps!==e.pendingProps||fi.current)Ns=!0;else{if(0==(n&r)){switch(Ns=!1,e.tag){case 3:Ws(e),Ho();break;case 5:Do(e);break;case 1:mi(e.type)&&vi(e);break;case 4:Lo(e,e.stateNode.containerInfo);break;case 10:r=e.memoizedProps.value;var i=e.type._context;ci(Qi,i._currentValue),i._currentValue=r;break;case 13:if(null!==e.memoizedState)return 0!=(n&e.child.childLanes)?Qs(t,e,n):(ci(Fo,1&Fo.current),null!==(e=na(t,e,n))?e.sibling:null);ci(Fo,1&Fo.current);break;case 19:if(r=0!=(n&e.childLanes),0!=(64&t.flags)){if(r)return ea(t,e,n);e.flags|=64}if(null!==(i=e.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),ci(Fo,Fo.current),r)break;return null;case 23:case 24:return e.lanes=0,Us(t,e,n)}return na(t,e,n)}Ns=0!=(16384&t.flags)}else Ns=!1;switch(e.lanes=0,e.tag){case 2:if(r=e.type,null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),t=e.pendingProps,i=gi(e,pi.current),io(e,n),i=ss(null,e,r,t,i,n),e.flags|=1,"object"==typeof i&&null!==i&&"function"==typeof i.render&&void 0===i.$$typeof){if(e.tag=1,e.memoizedState=null,e.updateQueue=null,mi(r)){var o=!0;vi(e)}else o=!1;e.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,ao(e);var a=r.getDerivedStateFromProps;"function"==typeof a&&mo(e,r,a,t),i.updater=Ao,e.stateNode=i,i._reactInternals=e,bo(e,r,t,n),e=qs(null,e,r,!0,o,n)}else e.tag=0,Fs(null,e,i,n),e=e.child;return e;case 16:i=e.elementType;t:{switch(null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),t=e.pendingProps,i=(o=i._init)(i._payload),e.type=i,o=e.tag=function(t){if("function"==typeof t)return Vl(t)?1:0;if(null!=t){if((t=t.$$typeof)===C)return 11;if(t===R)return 14}return 2}(i),t=Yi(i,t),o){case 0:e=Gs(null,e,i,t,n);break t;case 1:e=Zs(null,e,i,t,n);break t;case 11:e=Bs(null,e,i,t,n);break t;case 14:e=zs(null,e,i,Yi(i.type,t),r,n);break t}throw Error(s(306,i,""))}return e;case 0:return r=e.type,i=e.pendingProps,Gs(t,e,r,i=e.elementType===r?i:Yi(r,i),n);case 1:return r=e.type,i=e.pendingProps,Zs(t,e,r,i=e.elementType===r?i:Yi(r,i),n);case 3:if(Ws(e),r=e.updateQueue,null===t||null===r)throw Error(s(282));if(r=e.pendingProps,i=null!==(i=e.memoizedState)?i.element:null,lo(t,e),po(e,r,null,n),(r=e.memoizedState.element)===i)Ho(),e=na(t,e,n);else{if((o=(i=e.stateNode).hydrate)&&(jo=Hr(e.stateNode.containerInfo.firstChild),zo=e,o=Uo=!0),o){if(null!=(t=i.mutableSourceEagerHydrationData))for(i=0;i<t.length;i+=2)(o=t[i])._workInProgressVersionPrimary=t[i+1],Xo.push(o);for(n=Po(e,null,r,n),e.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else Fs(t,e,r,n),Ho();e=e.child}return e;case 5:return Do(e),null===t&&Zo(e),r=e.type,i=e.pendingProps,o=null!==t?t.memoizedProps:null,a=i.children,Gr(r,i)?a=null:null!==o&&Gr(r,o)&&(e.flags|=16),Vs(t,e),Fs(t,e,a,n),e.child;case 6:return null===t&&Zo(e),null;case 13:return Qs(t,e,n);case 4:return Lo(e,e.stateNode.containerInfo),r=e.pendingProps,null===t?e.child=To(e,null,r,n):Fs(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,Bs(t,e,r,i=e.elementType===r?i:Yi(r,i),n);case 7:return Fs(t,e,e.pendingProps,n),e.child;case 8:case 12:return Fs(t,e,e.pendingProps.children,n),e.child;case 10:t:{r=e.type._context,i=e.pendingProps,a=e.memoizedProps,o=i.value;var l=e.type._context;if(ci(Qi,l._currentValue),l._currentValue=o,null!==a)if(l=a.value,0==(o=ur(l,o)?0:0|("function"==typeof r._calculateChangedBits?r._calculateChangedBits(l,o):1073741823))){if(a.children===i.children&&!fi.current){e=na(t,e,n);break t}}else for(null!==(l=e.child)&&(l.return=e);null!==l;){var u=l.dependencies;if(null!==u){a=l.child;for(var c=u.firstContext;null!==c;){if(c.context===r&&0!=(c.observedBits&o)){1===l.tag&&((c=uo(-1,n&-n)).tag=2,co(l,c)),l.lanes|=n,null!==(c=l.alternate)&&(c.lanes|=n),ro(l.return,n),u.lanes|=n;break}c=c.next}}else a=10===l.tag&&l.type===e.type?null:l.child;if(null!==a)a.return=l;else for(a=l;null!==a;){if(a===e){a=null;break}if(null!==(l=a.sibling)){l.return=a.return,a=l;break}a=a.return}l=a}Fs(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=(o=e.pendingProps).children,io(e,n),r=r(i=oo(i,o.unstable_observedBits)),e.flags|=1,Fs(t,e,r,n),e.child;case 14:return o=Yi(i=e.type,e.pendingProps),zs(t,e,i,o=Yi(i.type,o),r,n);case 15:return js(t,e,e.type,e.pendingProps,r,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Yi(r,i),null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),e.tag=1,mi(r)?(t=!0,vi(e)):t=!1,io(e,n),_o(e,r,i),bo(e,r,i,n),qs(null,e,r,!0,t,n);case 19:return ea(t,e,n);case 23:case 24:return Us(t,e,n)}throw Error(s(156,e.tag))},eu.prototype.render=function(t){Ql(t,this._internalRoot,null,null)},eu.prototype.unmount=function(){var t=this._internalRoot,e=t.containerInfo;Ql(null,t,null,(function(){e[Jr]=null}))},te=function(t){13===t.tag&&(hl(t,4,ul()),tu(t,4))},ee=function(t){13===t.tag&&(hl(t,67108864,ul()),tu(t,67108864))},ne=function(t){if(13===t.tag){var e=ul(),n=cl(t);hl(t,n,e),tu(t,n)}},re=function(t,e){return e()},Tt=function(t,e,n){switch(e){case"input":if(nt(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=ii(r);if(!i)throw Error(s(90));Q(r),nt(r,i)}}}break;case"textarea":ut(t,n);break;case"select":null!=(e=n.value)&&st(t,!!n.multiple,e,!1)}},Rt=Al,Lt=function(t,e,n,r,i){var o=Ca;Ca|=4;try{return qi(98,t.bind(null,e,n,r,i))}finally{0===(Ca=o)&&(Za(),Hi())}},kt=function(){0==(49&Ca)&&(function(){if(null!==el){var t=el;el=null,t.forEach((function(t){t.expiredLanes|=24&t.pendingLanes,fl(t,Vi())}))}Hi()}(),Rl())},Dt=function(t,e){var n=Ca;Ca|=2;try{return t(e)}finally{0===(Ca=n)&&(Za(),Hi())}};var ou={Events:[ni,ri,ii,It,Ot,Rl,{current:!1}]},su={findFiberByHostInstance:ei,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},au={bundleType:su.bundleType,version:su.version,rendererPackageName:su.rendererPackageName,rendererConfig:su.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=Kt(t))?null:t.stateNode},findFiberByHostInstance:su.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var lu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!lu.isDisabled&&lu.supportsFiber)try{xi=lu.inject(au),wi=lu}catch(gt){}}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ou,e.createPortal=iu,e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternals;if(void 0===e){if("function"==typeof t.render)throw Error(s(188));throw Error(s(268,Object.keys(t)))}return null===(t=Kt(e))?null:t.stateNode},e.flushSync=function(t,e){var n=Ca;if(0!=(48&n))return t(e);Ca|=1;try{if(t)return qi(99,t.bind(null,e))}finally{Ca=n,Hi()}},e.hydrate=function(t,e,n){if(!nu(e))throw Error(s(200));return ru(null,t,e,!0,n)},e.render=function(t,e,n){if(!nu(e))throw Error(s(200));return ru(null,t,e,!1,n)},e.unmountComponentAtNode=function(t){if(!nu(t))throw Error(s(40));return!!t._reactRootContainer&&(yl((function(){ru(null,null,t,!1,(function(){t._reactRootContainer=null,t[Jr]=null}))})),!0)},e.unstable_batchedUpdates=Al,e.unstable_createPortal=function(t,e){return iu(t,e,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},e.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!nu(n))throw Error(s(200));if(null==t||void 0===t._reactInternals)throw Error(s(38));return ru(t,e,n,!1,r)},e.version="17.0.2"},3935:(t,e,n)=>{"use strict";!function t(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(t){console.error(t)}}(),t.exports=n(4448)},9921:(t,e)=>{"use strict";var n="function"==typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,o=n?Symbol.for("react.fragment"):60107,s=n?Symbol.for("react.strict_mode"):60108,a=n?Symbol.for("react.profiler"):60114,l=n?Symbol.for("react.provider"):60109,u=n?Symbol.for("react.context"):60110,c=n?Symbol.for("react.async_mode"):60111,h=n?Symbol.for("react.concurrent_mode"):60111,p=n?Symbol.for("react.forward_ref"):60112,f=n?Symbol.for("react.suspense"):60113,d=n?Symbol.for("react.suspense_list"):60120,g=n?Symbol.for("react.memo"):60115,m=n?Symbol.for("react.lazy"):60116,A=n?Symbol.for("react.block"):60121,y=n?Symbol.for("react.fundamental"):60117,_=n?Symbol.for("react.responder"):60118,v=n?Symbol.for("react.scope"):60119;function b(t){if("object"==typeof t&&null!==t){var e=t.$$typeof;switch(e){case r:switch(t=t.type){case c:case h:case o:case a:case s:case f:return t;default:switch(t=t&&t.$$typeof){case u:case p:case m:case g:case l:return t;default:return e}}case i:return e}}}function x(t){return b(t)===h}e.AsyncMode=c,e.ConcurrentMode=h,e.ContextConsumer=u,e.ContextProvider=l,e.Element=r,e.ForwardRef=p,e.Fragment=o,e.Lazy=m,e.Memo=g,e.Portal=i,e.Profiler=a,e.StrictMode=s,e.Suspense=f,e.isAsyncMode=function(t){return x(t)||b(t)===c},e.isConcurrentMode=x,e.isContextConsumer=function(t){return b(t)===u},e.isContextProvider=function(t){return b(t)===l},e.isElement=function(t){return"object"==typeof t&&null!==t&&t.$$typeof===r},e.isForwardRef=function(t){return b(t)===p},e.isFragment=function(t){return b(t)===o},e.isLazy=function(t){return b(t)===m},e.isMemo=function(t){return b(t)===g},e.isPortal=function(t){return b(t)===i},e.isProfiler=function(t){return b(t)===a},e.isStrictMode=function(t){return b(t)===s},e.isSuspense=function(t){return b(t)===f},e.isValidElementType=function(t){return"string"==typeof t||"function"==typeof t||t===o||t===h||t===a||t===s||t===f||t===d||"object"==typeof t&&null!==t&&(t.$$typeof===m||t.$$typeof===g||t.$$typeof===l||t.$$typeof===u||t.$$typeof===p||t.$$typeof===y||t.$$typeof===_||t.$$typeof===v||t.$$typeof===A)},e.typeOf=b},9864:(t,e,n)=>{"use strict";t.exports=n(9921)},5251:(t,e,n)=>{"use strict";n(7418);var r=n(7294),i=60103;if("function"==typeof Symbol&&Symbol.for){var o=Symbol.for;i=o("react.element"),o("react.fragment")}var s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a=Object.prototype.hasOwnProperty,l={key:!0,ref:!0,__self:!0,__source:!0};function u(t,e,n){var r,o={},u=null,c=null;for(r in void 0!==n&&(u=""+n),void 0!==e.key&&(u=""+e.key),void 0!==e.ref&&(c=e.ref),e)a.call(e,r)&&!l.hasOwnProperty(r)&&(o[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps)void 0===o[r]&&(o[r]=e[r]);return{$$typeof:i,type:t,key:u,ref:c,props:o,_owner:s.current}}e.jsx=u,e.jsxs=u},2408:(t,e,n)=>{"use strict";var r=n(7418),i=60103,o=60106;e.Fragment=60107,e.StrictMode=60108,e.Profiler=60114;var s=60109,a=60110,l=60112;e.Suspense=60113;var u=60115,c=60116;if("function"==typeof Symbol&&Symbol.for){var h=Symbol.for;i=h("react.element"),o=h("react.portal"),e.Fragment=h("react.fragment"),e.StrictMode=h("react.strict_mode"),e.Profiler=h("react.profiler"),s=h("react.provider"),a=h("react.context"),l=h("react.forward_ref"),e.Suspense=h("react.suspense"),u=h("react.memo"),c=h("react.lazy")}var p="function"==typeof Symbol&&Symbol.iterator;function f(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var d={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g={};function m(t,e,n){this.props=t,this.context=e,this.refs=g,this.updater=n||d}function A(){}function y(t,e,n){this.props=t,this.context=e,this.refs=g,this.updater=n||d}m.prototype.isReactComponent={},m.prototype.setState=function(t,e){if("object"!=typeof t&&"function"!=typeof t&&null!=t)throw Error(f(85));this.updater.enqueueSetState(this,t,e,"setState")},m.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},A.prototype=m.prototype;var _=y.prototype=new A;_.constructor=y,r(_,m.prototype),_.isPureReactComponent=!0;var v={current:null},b=Object.prototype.hasOwnProperty,x={key:!0,ref:!0,__self:!0,__source:!0};function w(t,e,n){var r,o={},s=null,a=null;if(null!=e)for(r in void 0!==e.ref&&(a=e.ref),void 0!==e.key&&(s=""+e.key),e)b.call(e,r)&&!x.hasOwnProperty(r)&&(o[r]=e[r]);var l=arguments.length-2;if(1===l)o.children=n;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];o.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps)void 0===o[r]&&(o[r]=l[r]);return{$$typeof:i,type:t,key:s,ref:a,props:o,_owner:v.current}}function E(t){return"object"==typeof t&&null!==t&&t.$$typeof===i}var S=/\/+/g;function T(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function P(t,e,n,r,s){var a=typeof t;"undefined"!==a&&"boolean"!==a||(t=null);var l=!1;if(null===t)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case i:case o:l=!0}}if(l)return s=s(l=t),t=""===r?"."+T(l,0):r,Array.isArray(s)?(n="",null!=t&&(n=t.replace(S,"$&/")+"/"),P(s,e,n,"",(function(t){return t}))):null!=s&&(E(s)&&(s=function(t,e){return{$$typeof:i,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(s,n+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(S,"$&/")+"/")+t)),e.push(s)),1;if(l=0,r=""===r?".":r+":",Array.isArray(t))for(var u=0;u<t.length;u++){var c=r+T(a=t[u],u);l+=P(a,e,n,c,s)}else if(c=function(t){return null===t||"object"!=typeof t?null:"function"==typeof(t=p&&t[p]||t["@@iterator"])?t:null}(t),"function"==typeof c)for(t=c.call(t),u=0;!(a=t.next()).done;)l+=P(a=a.value,e,n,c=r+T(a,u++),s);else if("object"===a)throw e=""+t,Error(f(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e));return l}function M(t,e,n){if(null==t)return t;var r=[],i=0;return P(t,r,"","",(function(t){return e.call(n,t,i++)})),r}function C(t){if(-1===t._status){var e=t._result;e=e(),t._status=0,t._result=e,e.then((function(e){0===t._status&&(e=e.default,t._status=1,t._result=e)}),(function(e){0===t._status&&(t._status=2,t._result=e)}))}if(1===t._status)return t._result;throw t._result}var I={current:null};function O(){var t=I.current;if(null===t)throw Error(f(321));return t}var R={ReactCurrentDispatcher:I,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:v,IsSomeRendererActing:{current:!1},assign:r};e.Children={map:M,forEach:function(t,e,n){M(t,(function(){e.apply(this,arguments)}),n)},count:function(t){var e=0;return M(t,(function(){e++})),e},toArray:function(t){return M(t,(function(t){return t}))||[]},only:function(t){if(!E(t))throw Error(f(143));return t}},e.Component=m,e.PureComponent=y,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,e.cloneElement=function(t,e,n){if(null==t)throw Error(f(267,t));var o=r({},t.props),s=t.key,a=t.ref,l=t._owner;if(null!=e){if(void 0!==e.ref&&(a=e.ref,l=v.current),void 0!==e.key&&(s=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(c in e)b.call(e,c)&&!x.hasOwnProperty(c)&&(o[c]=void 0===e[c]&&void 0!==u?u[c]:e[c])}var c=arguments.length-2;if(1===c)o.children=n;else if(1<c){u=Array(c);for(var h=0;h<c;h++)u[h]=arguments[h+2];o.children=u}return{$$typeof:i,type:t.type,key:s,ref:a,props:o,_owner:l}},e.createContext=function(t,e){return void 0===e&&(e=null),(t={$$typeof:a,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:s,_context:t},t.Consumer=t},e.createElement=w,e.createFactory=function(t){var e=w.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:l,render:t}},e.isValidElement=E,e.lazy=function(t){return{$$typeof:c,_payload:{_status:-1,_result:t},_init:C}},e.memo=function(t,e){return{$$typeof:u,type:t,compare:void 0===e?null:e}},e.useCallback=function(t,e){return O().useCallback(t,e)},e.useContext=function(t,e){return O().useContext(t,e)},e.useDebugValue=function(){},e.useEffect=function(t,e){return O().useEffect(t,e)},e.useImperativeHandle=function(t,e,n){return O().useImperativeHandle(t,e,n)},e.useLayoutEffect=function(t,e){return O().useLayoutEffect(t,e)},e.useMemo=function(t,e){return O().useMemo(t,e)},e.useReducer=function(t,e,n){return O().useReducer(t,e,n)},e.useRef=function(t){return O().useRef(t)},e.useState=function(t){return O().useState(t)},e.version="17.0.2"},7294:(t,e,n)=>{"use strict";t.exports=n(2408)},5893:(t,e,n)=>{"use strict";t.exports=n(5251)},3697:t=>{"use strict";var e=Object,n=TypeError;t.exports=function(){if(null!=this&&this!==e(this))throw new n("RegExp.prototype.flags getter called on non-object");var t="";return this.global&&(t+="g"),this.ignoreCase&&(t+="i"),this.multiline&&(t+="m"),this.dotAll&&(t+="s"),this.unicode&&(t+="u"),this.sticky&&(t+="y"),t}},2847:(t,e,n)=>{"use strict";var r=n(4289),i=n(5559),o=n(3697),s=n(1721),a=n(2753),l=i(o);r(l,{getPolyfill:s,implementation:o,shim:a}),t.exports=l},1721:(t,e,n)=>{"use strict";var r=n(3697),i=n(4289).supportsDescriptors,o=Object.getOwnPropertyDescriptor,s=TypeError;t.exports=function(){if(!i)throw new s("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");if("gim"===/a/gim.flags){var t=o(RegExp.prototype,"flags");if(t&&"function"==typeof t.get&&"boolean"==typeof/a/.dotAll)return t.get}return r}},2753:(t,e,n)=>{"use strict";var r=n(4289).supportsDescriptors,i=n(1721),o=Object.getOwnPropertyDescriptor,s=Object.defineProperty,a=TypeError,l=Object.getPrototypeOf,u=/a/;t.exports=function(){if(!r||!l)throw new a("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var t=i(),e=l(u),n=o(e,"flags");return n&&n.get===t||s(e,"flags",{configurable:!0,enumerable:!1,get:t}),t}},8639:function(t,e){!function(t){"use strict";const e=134217729;function n(t,e,n,r,i){let o,s,a,l,u=e[0],c=r[0],h=0,p=0;c>u==c>-u?(o=u,u=e[++h]):(o=c,c=r[++p]);let f=0;if(h<t&&p<n)for(c>u==c>-u?(a=o-((s=u+o)-u),u=e[++h]):(a=o-((s=c+o)-c),c=r[++p]),o=s,0!==a&&(i[f++]=a);h<t&&p<n;)c>u==c>-u?(a=o-((s=o+u)-(l=s-o))+(u-l),u=e[++h]):(a=o-((s=o+c)-(l=s-o))+(c-l),c=r[++p]),o=s,0!==a&&(i[f++]=a);for(;h<t;)a=o-((s=o+u)-(l=s-o))+(u-l),u=e[++h],o=s,0!==a&&(i[f++]=a);for(;p<n;)a=o-((s=o+c)-(l=s-o))+(c-l),c=r[++p],o=s,0!==a&&(i[f++]=a);return 0===o&&0!==f||(i[f++]=o),f}function r(t){return new Float64Array(t)}const i=r(4),o=r(8),s=r(12),a=r(16),l=r(4);t.orient2d=function(t,r,u,c,h,p){const f=(r-p)*(u-h),d=(t-h)*(c-p),g=f-d;if(0===f||0===d||f>0!=d>0)return g;const m=Math.abs(f+d);return Math.abs(g)>=33306690738754716e-32*m?g:-function(t,r,u,c,h,p,f){let d,g,m,A,y,_,v,b,x,w,E,S,T,P,M,C,I,O;const R=t-h,L=u-h,k=r-p,D=c-p;y=(M=(b=R-(v=(_=e*R)-(_-R)))*(w=D-(x=(_=e*D)-(_-D)))-((P=R*D)-v*x-b*x-v*w))-(E=M-(I=(b=k-(v=(_=e*k)-(_-k)))*(w=L-(x=(_=e*L)-(_-L)))-((C=k*L)-v*x-b*x-v*w))),i[0]=M-(E+y)+(y-I),y=(T=P-((S=P+E)-(y=S-P))+(E-y))-(E=T-C),i[1]=T-(E+y)+(y-C),y=(O=S+E)-S,i[2]=S-(O-y)+(E-y),i[3]=O;let N=function(t,e){let n=e[0];for(let t=1;t<4;t++)n+=e[t];return n}(0,i),F=22204460492503146e-32*f;if(N>=F||-N>=F)return N;if(d=t-(R+(y=t-R))+(y-h),m=u-(L+(y=u-L))+(y-h),g=r-(k+(y=r-k))+(y-p),A=c-(D+(y=c-D))+(y-p),0===d&&0===g&&0===m&&0===A)return N;if(F=11093356479670487e-47*f+33306690738754706e-32*Math.abs(N),(N+=R*A+D*d-(k*m+L*g))>=F||-N>=F)return N;y=(M=(b=d-(v=(_=e*d)-(_-d)))*(w=D-(x=(_=e*D)-(_-D)))-((P=d*D)-v*x-b*x-v*w))-(E=M-(I=(b=g-(v=(_=e*g)-(_-g)))*(w=L-(x=(_=e*L)-(_-L)))-((C=g*L)-v*x-b*x-v*w))),l[0]=M-(E+y)+(y-I),y=(T=P-((S=P+E)-(y=S-P))+(E-y))-(E=T-C),l[1]=T-(E+y)+(y-C),y=(O=S+E)-S,l[2]=S-(O-y)+(E-y),l[3]=O;const B=n(4,i,4,l,o);y=(M=(b=R-(v=(_=e*R)-(_-R)))*(w=A-(x=(_=e*A)-(_-A)))-((P=R*A)-v*x-b*x-v*w))-(E=M-(I=(b=k-(v=(_=e*k)-(_-k)))*(w=m-(x=(_=e*m)-(_-m)))-((C=k*m)-v*x-b*x-v*w))),l[0]=M-(E+y)+(y-I),y=(T=P-((S=P+E)-(y=S-P))+(E-y))-(E=T-C),l[1]=T-(E+y)+(y-C),y=(O=S+E)-S,l[2]=S-(O-y)+(E-y),l[3]=O;const z=n(B,o,4,l,s);y=(M=(b=d-(v=(_=e*d)-(_-d)))*(w=A-(x=(_=e*A)-(_-A)))-((P=d*A)-v*x-b*x-v*w))-(E=M-(I=(b=g-(v=(_=e*g)-(_-g)))*(w=m-(x=(_=e*m)-(_-m)))-((C=g*m)-v*x-b*x-v*w))),l[0]=M-(E+y)+(y-I),y=(T=P-((S=P+E)-(y=S-P))+(E-y))-(E=T-C),l[1]=T-(E+y)+(y-C),y=(O=S+E)-S,l[2]=S-(O-y)+(E-y),l[3]=O;const j=n(z,s,4,l,a);return a[j-1]}(t,r,u,c,h,p,m)},t.orient2dfast=function(t,e,n,r,i,o){return(e-o)*(n-i)-(t-i)*(r-o)},Object.defineProperty(t,"__esModule",{value:!0})}(e)},53:(t,e)=>{"use strict";var n,r,i,o;if("object"==typeof performance&&"function"==typeof performance.now){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();e.unstable_now=function(){return a.now()-l}}if("undefined"==typeof window||"function"!=typeof MessageChannel){var u=null,c=null,h=function(){if(null!==u)try{var t=e.unstable_now();u(!0,t),u=null}catch(t){throw setTimeout(h,0),t}};n=function(t){null!==u?setTimeout(n,0,t):(u=t,setTimeout(h,0))},r=function(t,e){c=setTimeout(t,e)},i=function(){clearTimeout(c)},e.unstable_shouldYield=function(){return!1},o=e.unstable_forceFrameRate=function(){}}else{var p=window.setTimeout,f=window.clearTimeout;if("undefined"!=typeof console){var d=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!=typeof d&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var g=!1,m=null,A=-1,y=5,_=0;e.unstable_shouldYield=function(){return e.unstable_now()>=_},o=function(){},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<t?Math.floor(1e3/t):5};var v=new MessageChannel,b=v.port2;v.port1.onmessage=function(){if(null!==m){var t=e.unstable_now();_=t+y;try{m(!0,t)?b.postMessage(null):(g=!1,m=null)}catch(t){throw b.postMessage(null),t}}else g=!1},n=function(t){m=t,g||(g=!0,b.postMessage(null))},r=function(t,n){A=p((function(){t(e.unstable_now())}),n)},i=function(){f(A),A=-1}}function x(t,e){var n=t.length;t.push(e);t:for(;;){var r=n-1>>>1,i=t[r];if(!(void 0!==i&&0<S(i,e)))break t;t[r]=e,t[n]=i,n=r}}function w(t){return void 0===(t=t[0])?null:t}function E(t){var e=t[0];if(void 0!==e){var n=t.pop();if(n!==e){t[0]=n;t:for(var r=0,i=t.length;r<i;){var o=2*(r+1)-1,s=t[o],a=o+1,l=t[a];if(void 0!==s&&0>S(s,n))void 0!==l&&0>S(l,s)?(t[r]=l,t[a]=n,r=a):(t[r]=s,t[o]=n,r=o);else{if(!(void 0!==l&&0>S(l,n)))break t;t[r]=l,t[a]=n,r=a}}}return e}return null}function S(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}var T=[],P=[],M=1,C=null,I=3,O=!1,R=!1,L=!1;function k(t){for(var e=w(P);null!==e;){if(null===e.callback)E(P);else{if(!(e.startTime<=t))break;E(P),e.sortIndex=e.expirationTime,x(T,e)}e=w(P)}}function D(t){if(L=!1,k(t),!R)if(null!==w(T))R=!0,n(N);else{var e=w(P);null!==e&&r(D,e.startTime-t)}}function N(t,n){R=!1,L&&(L=!1,i()),O=!0;var o=I;try{for(k(n),C=w(T);null!==C&&(!(C.expirationTime>n)||t&&!e.unstable_shouldYield());){var s=C.callback;if("function"==typeof s){C.callback=null,I=C.priorityLevel;var a=s(C.expirationTime<=n);n=e.unstable_now(),"function"==typeof a?C.callback=a:C===w(T)&&E(T),k(n)}else E(T);C=w(T)}if(null!==C)var l=!0;else{var u=w(P);null!==u&&r(D,u.startTime-n),l=!1}return l}finally{C=null,I=o,O=!1}}var F=o;e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){R||O||(R=!0,n(N))},e.unstable_getCurrentPriorityLevel=function(){return I},e.unstable_getFirstCallbackNode=function(){return w(T)},e.unstable_next=function(t){switch(I){case 1:case 2:case 3:var e=3;break;default:e=I}var n=I;I=e;try{return t()}finally{I=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=F,e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=I;I=t;try{return e()}finally{I=n}},e.unstable_scheduleCallback=function(t,o,s){var a=e.unstable_now();switch(s="object"==typeof s&&null!==s&&"number"==typeof(s=s.delay)&&0<s?a+s:a,t){case 1:var l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}return t={id:M++,callback:o,priorityLevel:t,startTime:s,expirationTime:l=s+l,sortIndex:-1},s>a?(t.sortIndex=s,x(P,t),null===w(T)&&t===w(P)&&(L?i():L=!0,r(D,s-a))):(t.sortIndex=l,x(T,t),R||O||(R=!0,n(N))),t},e.unstable_wrapCallback=function(t){var e=I;return function(){var n=I;I=e;try{return t.apply(this,arguments)}finally{I=n}}}},3840:(t,e,n)=>{"use strict";t.exports=n(53)},5098:t=>{"use strict";t.exports={eudist:function(t,e,n){for(var r=t.length,i=0,o=0;o<r;o++){var s=(t[o]||0)-(e[o]||0);i+=s*s}return n?Math.sqrt(i):i},mandist:function(t,e,n){for(var r=t.length,i=0,o=0;o<r;o++)i+=Math.abs((t[o]||0)-(e[o]||0));return n?Math.sqrt(i):i},dist:function(t,e,n){var r=Math.abs(t-e);return n?r:r*r}}},7035:(t,e,n)=>{"use strict";var r=n(5098),i=r.eudist,o=r.dist;t.exports={kmrand:function(t,e){for(var n={},r=[],i=e<<2,o=t.length,s=t[0].length>0;r.length<e&&i-- >0;){var a=t[Math.floor(Math.random()*o)],l=s?a.join("_"):""+a;n[l]||(n[l]=!0,r.push(a))}if(r.length<e)throw new Error("Error initializating clusters");return r},kmpp:function(t,e){var n=t[0].length?i:o,r=[],s=t.length,a=t[0].length>0,l=t[Math.floor(Math.random()*s)];for(a&&l.join("_"),r.push(l);r.length<e;){for(var u=[],c=r.length,h=0,p=[],f=0;f<s;f++){for(var d=1/0,g=0;g<c;g++){var m=n(t[f],r[g]);m<=d&&(d=m)}u[f]=d}for(var A=0;A<s;A++)h+=u[A];for(var y=0;y<s;y++)p[y]={i:y,v:t[y],pr:u[y]/h,cs:0};p.sort((function(t,e){return t.pr-e.pr})),p[0].cs=p[0].pr;for(var _=1;_<s;_++)p[_].cs=p[_-1].cs+p[_].pr;for(var v=Math.random(),b=0;b<s-1&&p[b++].cs<v;);r.push(p[b-1].v)}return r}}},1160:(t,e,n)=>{"use strict";var r=n(5098),i=n(7035),o=r.eudist,s=(r.mandist,r.dist,i.kmrand),a=i.kmpp;function l(t,e,n){n=n||[];for(var r=0;r<t;r++)n[r]=e;return n}t.exports=function(t,e,n,r){var i=[],u=[],c=[],h=[],p=!1,f=r||1e4,d=t.length,g=t[0].length,m=g>0,A=[];if(n)i="kmrand"==n?s(t,e):"kmpp"==n?a(t,e):n;else for(var y={};i.length<e;){var _=Math.floor(Math.random()*d);y[_]||(y[_]=!0,i.push(t[_]))}do{l(e,0,A);for(var v=0;v<d;v++){for(var b=1/0,x=0,w=0;w<e;w++)(h=m?o(t[v],i[w]):Math.abs(t[v]-i[w]))<=b&&(b=h,x=w);c[v]=x,A[x]++}for(var E=[],S=(u=[],0);S<e;S++)E[S]=m?l(g,0,E[S]):0,u[S]=i[S];if(m){for(var T=0;T<e;T++)i[T]=[];for(var P=0;P<d;P++)for(var M=E[c[P]],C=t[P],I=0;I<g;I++)M[I]+=C[I];p=!0;for(var O=0;O<e;O++){for(var R=i[O],L=E[O],k=u[O],D=A[O],N=0;N<g;N++)R[N]=L[N]/D||0;if(p)for(var F=0;F<g;F++)if(k[F]!=R[F]){p=!1;break}}}else{for(var B=0;B<d;B++)E[c[B]]+=t[B];for(var z=0;z<e;z++)i[z]=E[z]/A[z]||0;p=!0;for(var j=0;j<e;j++)if(u[j]!=i[j]){p=!1;break}}p=p||--f<=0}while(!p);return{it:1e4-f,k:e,idxs:c,centroids:i}}},3379:t=>{"use strict";var e=[];function n(t){for(var n=-1,r=0;r<e.length;r++)if(e[r].identifier===t){n=r;break}return n}function r(t,r){for(var o={},s=[],a=0;a<t.length;a++){var l=t[a],u=r.base?l[0]+r.base:l[0],c=o[u]||0,h="".concat(u," ").concat(c);o[u]=c+1;var p=n(h),f={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)e[p].references++,e[p].updater(f);else{var d=i(f,r);r.byIndex=a,e.splice(a,0,{identifier:h,updater:d,references:1})}s.push(h)}return s}function i(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,i){var o=r(t=t||[],i=i||{});return function(t){t=t||[];for(var s=0;s<o.length;s++){var a=n(o[s]);e[a].references--}for(var l=r(t,i),u=0;u<o.length;u++){var c=n(o[u]);0===e[c].references&&(e[c].updater(),e.splice(c,1))}o=l}}},569:t=>{"use strict";var e={};t.exports=function(t,n){var r=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},9216:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},3565:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},7795:t=>{"use strict";t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,i&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(r,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},4589:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},3842:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});class r{constructor(t=[],e=i){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let t=(this.length>>1)-1;t>=0;t--)this._down(t)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:n}=this,r=e[t];for(;t>0;){const i=t-1>>1,o=e[i];if(n(r,o)>=0)break;e[t]=o,t=i}e[t]=r}_down(t){const{data:e,compare:n}=this,r=this.length>>1,i=e[t];for(;t<r;){let r=1+(t<<1),o=e[r];const s=r+1;if(s<this.length&&n(e[s],o)<0&&(r=s,o=e[s]),n(o,i)>=0)break;e[t]=o,t=r}e[t]=i}}function i(t,e){return t<e?-1:t>e?1:0}},675:function(t,e){!function(t){"use strict";function e(){}function n(t){this.message=t||""}function r(t){this.message=t||""}function i(t){this.message=t||""}function o(){}function s(t){return null===t?kt:t.color}function a(t){return null===t?null:t.parent}function l(t,e){null!==t&&(t.color=e)}function u(t){return null===t?null:t.left}function c(t){return null===t?null:t.right}function h(){this.root_=null,this.size_=0}function p(){}function f(){this.array_=[],arguments[0]instanceof vt&&this.addAll(arguments[0])}function d(){}function g(t){this.message=t||""}function m(){this.array_=[]}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(null==this)throw new TypeError(this+" is not an object");var e=Object(this),n=Math.max(Math.min(e.length,9007199254740991),0)||0,r=1 in arguments&&parseInt(Number(arguments[1]),10)||0;r=r<0?Math.max(n+r,0):Math.min(r,n);var i=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:n;for(i=i<0?Math.max(n+arguments[2],0):Math.min(i,n);r<i;)e[r]=t,++r;return e},writable:!0}),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!=t},Math.trunc=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};var A=function(){};A.prototype.interfaces_=function(){return[]},A.prototype.getClass=function(){return A},A.prototype.equalsWithTolerance=function(t,e,n){return Math.abs(t-e)<=n};var y=function(t){function e(e){t.call(this,e),this.name="IllegalArgumentException",this.message=e,this.stack=(new t).stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),_=function(){},v={MAX_VALUE:{configurable:!0}};_.isNaN=function(t){return Number.isNaN(t)},_.doubleToLongBits=function(t){return t},_.longBitsToDouble=function(t){return t},_.isInfinite=function(t){return!Number.isFinite(t)},v.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(_,v);var b=function(){},x=function(){},w=function(){},E=function t(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)this.x=0,this.y=0,this.z=t.NULL_ORDINATE;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.z=e.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=t.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},S={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};E.prototype.setOrdinate=function(t,e){switch(t){case E.X:this.x=e;break;case E.Y:this.y=e;break;case E.Z:this.z=e;break;default:throw new y("Invalid ordinate index: "+t)}},E.prototype.equals2D=function(){if(1===arguments.length){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!A.equalsWithTolerance(this.x,e.x,n)&&!!A.equalsWithTolerance(this.y,e.y,n)}},E.prototype.getOrdinate=function(t){switch(t){case E.X:return this.x;case E.Y:return this.y;case E.Z:return this.z}throw new y("Invalid ordinate index: "+t)},E.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||_.isNaN(this.z))&&_.isNaN(t.z)},E.prototype.equals=function(t){return t instanceof E&&this.equals2D(t)},E.prototype.equalInZ=function(t,e){return A.equalsWithTolerance(this.z,t.z,e)},E.prototype.compareTo=function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0},E.prototype.clone=function(){},E.prototype.copy=function(){return new E(this)},E.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},E.prototype.distance3D=function(t){var e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return Math.sqrt(e*e+n*n+r*r)},E.prototype.distance=function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},E.prototype.hashCode=function(){var t=17;return 37*(t=37*t+E.hashCode(this.x))+E.hashCode(this.y)},E.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z},E.prototype.interfaces_=function(){return[b,x,e]},E.prototype.getClass=function(){return E},E.hashCode=function(){if(1===arguments.length){var t=arguments[0],e=_.doubleToLongBits(t);return Math.trunc((e^e)>>>32)}},S.DimensionalComparator.get=function(){return T},S.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800},S.NULL_ORDINATE.get=function(){return _.NaN},S.X.get=function(){return 0},S.Y.get=function(){return 1},S.Z.get=function(){return 2},Object.defineProperties(E,S);var T=function(t){if(this._dimensionsToTest=2,0===arguments.length);else if(1===arguments.length){var e=arguments[0];if(2!==e&&3!==e)throw new y("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}};T.prototype.compare=function(t,e){var n=t,r=e,i=T.compare(n.x,r.x);if(0!==i)return i;var o=T.compare(n.y,r.y);return 0!==o?o:this._dimensionsToTest<=2?0:T.compare(n.z,r.z)},T.prototype.interfaces_=function(){return[w]},T.prototype.getClass=function(){return T},T.compare=function(t,e){return t<e?-1:t>e?1:_.isNaN(t)?_.isNaN(e)?0:-1:_.isNaN(e)?1:0};var P=function(){};P.prototype.create=function(){},P.prototype.interfaces_=function(){return[]},P.prototype.getClass=function(){return P};var M=function(){},C={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};M.prototype.interfaces_=function(){return[]},M.prototype.getClass=function(){return M},M.toLocationSymbol=function(t){switch(t){case M.EXTERIOR:return"e";case M.BOUNDARY:return"b";case M.INTERIOR:return"i";case M.NONE:return"-"}throw new y("Unknown location value: "+t)},C.INTERIOR.get=function(){return 0},C.BOUNDARY.get=function(){return 1},C.EXTERIOR.get=function(){return 2},C.NONE.get=function(){return-1},Object.defineProperties(M,C);var I=function(t,e){return t.interfaces_&&t.interfaces_().indexOf(e)>-1},O=function(){},R={LOG_10:{configurable:!0}};O.prototype.interfaces_=function(){return[]},O.prototype.getClass=function(){return O},O.log10=function(t){var e=Math.log(t);return _.isInfinite(e)||_.isNaN(e)?e:e/O.LOG_10},O.min=function(t,e,n,r){var i=t;return e<i&&(i=e),n<i&&(i=n),r<i&&(i=r),i},O.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1],n=arguments[2];return t<e?e:t>n?n:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var r=arguments[0],i=arguments[1],o=arguments[2];return r<i?i:r>o?o:r}},O.wrap=function(t,e){return t<0?e- -t%e:t%e},O.max=function(){if(3===arguments.length){var t=arguments[1],e=arguments[2],n=arguments[0];return t>n&&(n=t),e>n&&(n=e),n}if(4===arguments.length){var r=arguments[1],i=arguments[2],o=arguments[3],s=arguments[0];return r>s&&(s=r),i>s&&(s=i),o>s&&(s=o),s}},O.average=function(t,e){return(t+e)/2},R.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(O,R);var L=function(t){this.str=t};L.prototype.append=function(t){this.str+=t},L.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},L.prototype.toString=function(t){return this.str};var k=function(t){this.value=t};k.prototype.intValue=function(){return this.value},k.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},k.isNaN=function(t){return Number.isNaN(t)};var D=function(){};D.isWhitespace=function(t){return t<=32&&t>=0||127===t},D.toUpperCase=function(t){return t.toUpperCase()};var N=function t(){if(this._hi=0,this._lo=0,0===arguments.length)this.init(0);else if(1===arguments.length)if("number"==typeof arguments[0]){var e=arguments[0];this.init(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}else"string"==typeof arguments[0]&&t.call(this,t.parse(arguments[0]));else if(2===arguments.length){var r=arguments[0],i=arguments[1];this.init(r,i)}},F={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};N.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo},N.prototype.extractSignificantDigits=function(t,e){var n=this.abs(),r=N.magnitude(n._hi),i=N.TEN.pow(r);(n=n.divide(i)).gt(N.TEN)?(n=n.divide(N.TEN),r+=1):n.lt(N.ONE)&&(n=n.multiply(N.TEN),r-=1);for(var o=r+1,s=new L,a=N.MAX_PRINT_DIGITS-1,l=0;l<=a;l++){t&&l===o&&s.append(".");var u=Math.trunc(n._hi);if(u<0)break;var c=!1,h=0;u>9?(c=!0,h="9"):h="0"+u,s.append(h),n=n.subtract(N.valueOf(u)).multiply(N.TEN),c&&n.selfAdd(N.TEN);var p=!0,f=N.magnitude(n._hi);if(f<0&&Math.abs(f)>=a-l&&(p=!1),!p)break}return e[0]=r,s.toString()},N.prototype.sqr=function(){return this.multiply(this)},N.prototype.doubleValue=function(){return this._hi+this._lo},N.prototype.subtract=function(){if(arguments[0]instanceof N){var t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){var e=arguments[0];return this.add(-e)}},N.prototype.equals=function(){if(1===arguments.length){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}},N.prototype.isZero=function(){return 0===this._hi&&0===this._lo},N.prototype.selfSubtract=function(){if(arguments[0]instanceof N){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}},N.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},N.prototype.min=function(t){return this.le(t)?this:t},N.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof N){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfDivide(e,0)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1],i=null,o=null,s=null,a=null,l=null,u=null,c=null,h=null;return l=this._hi/n,h=(i=(u=N.SPLIT*l)-(i=u-l))*(s=(h=N.SPLIT*n)-(s=h-n))-(c=l*n)+i*(a=n-s)+(o=l-i)*s+o*a,h=l+(u=(this._hi-c-h+this._lo-l*r)/n),this._hi=h,this._lo=l-h+u,this}},N.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},N.prototype.divide=function(){if(arguments[0]instanceof N){var t=arguments[0],e=null,n=null,r=null,i=null,o=null,s=null,a=null,l=null;return n=(o=this._hi/t._hi)-(e=(s=N.SPLIT*o)-(e=s-o)),l=e*(r=(l=N.SPLIT*t._hi)-(r=l-t._hi))-(a=o*t._hi)+e*(i=t._hi-r)+n*r+n*i,s=(this._hi-a-l+this._lo-o*t._lo)/t._hi,new N(l=o+s,o-l+s)}if("number"==typeof arguments[0]){var u=arguments[0];return _.isNaN(u)?N.createNaN():N.copy(this).selfDivide(u,0)}},N.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo},N.prototype.pow=function(t){if(0===t)return N.valueOf(1);var e=new N(this),n=N.valueOf(1),r=Math.abs(t);if(r>1)for(;r>0;)r%2==1&&n.selfMultiply(e),(r/=2)>0&&(e=e.sqr());else n=e;return t<0?n.reciprocal():n},N.prototype.ceil=function(){if(this.isNaN())return N.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new N(t,e)},N.prototype.compareTo=function(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0},N.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},N.prototype.setValue=function(){if(arguments[0]instanceof N){var t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){var e=arguments[0];return this.init(e),this}},N.prototype.max=function(t){return this.ge(t)?this:t},N.prototype.sqrt=function(){if(this.isZero())return N.valueOf(0);if(this.isNegative())return N.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,n=N.valueOf(e),r=this.subtract(n.sqr())._hi*(.5*t);return n.add(r)},N.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof N){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0],n=null,r=null,i=null,o=null,s=null,a=null;return o=(i=this._hi+e)-(s=i-this._hi),r=(a=(o=e-s+(this._hi-o))+this._lo)+(i-(n=i+a)),this._hi=n+r,this._lo=r+(n-this._hi),this}}else if(2===arguments.length){var l=arguments[0],u=arguments[1],c=null,h=null,p=null,f=null,d=null,g=null,m=null;f=this._hi+l,h=this._lo+u,d=f-(g=f-this._hi),p=h-(m=h-this._lo);var A=(c=f+(g=(d=l-g+(this._hi-d))+h))+(g=(p=u-m+(this._lo-p))+(g+(f-c))),y=g+(c-A);return this._hi=A,this._lo=y,this}},N.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof N){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfMultiply(e,0)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1],i=null,o=null,s=null,a=null,l=null,u=null;i=(l=N.SPLIT*this._hi)-this._hi,u=N.SPLIT*n,i=l-i,o=this._hi-i,s=u-n;var c=(l=this._hi*n)+(u=i*(s=u-s)-l+i*(a=n-s)+o*s+o*a+(this._hi*r+this._lo*n)),h=u+(i=l-c);return this._hi=c,this._lo=h,this}},N.prototype.selfSqr=function(){return this.selfMultiply(this)},N.prototype.floor=function(){if(this.isNaN())return N.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new N(t,e)},N.prototype.negate=function(){return this.isNaN()?this:new N(-this._hi,-this._lo)},N.prototype.clone=function(){},N.prototype.multiply=function(){if(arguments[0]instanceof N){var t=arguments[0];return t.isNaN()?N.createNaN():N.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){var e=arguments[0];return _.isNaN(e)?N.createNaN():N.copy(this).selfMultiply(e,0)}},N.prototype.isNaN=function(){return _.isNaN(this._hi)},N.prototype.intValue=function(){return Math.trunc(this._hi)},N.prototype.toString=function(){var t=N.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()},N.prototype.toStandardNotation=function(){var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!0,e),r=e[0]+1,i=n;if("."===n.charAt(0))i="0"+n;else if(r<0)i="0."+N.stringOfChar("0",-r)+n;else if(-1===n.indexOf(".")){var o=r-n.length;i=n+N.stringOfChar("0",o)+".0"}return this.isNegative()?"-"+i:i},N.prototype.reciprocal=function(){var t,e,n,r,i=null,o=null,s=null,a=null;t=(n=1/this._hi)-(i=(s=N.SPLIT*n)-(i=s-n)),o=(a=N.SPLIT*this._hi)-this._hi;var l=n+(s=(1-(r=n*this._hi)-(a=i*(o=a-o)-r+i*(e=this._hi-o)+t*o+t*e)-n*this._lo)/this._hi);return new N(l,n-l+s)},N.prototype.toSciNotation=function(){if(this.isZero())return N.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!1,e),r=N.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===n.charAt(0))throw new Error("Found leading zero: "+n);var i="";n.length>1&&(i=n.substring(1));var o=n.charAt(0)+"."+i;return this.isNegative()?"-"+o+r:o+r},N.prototype.abs=function(){return this.isNaN()?N.NaN:this.isNegative()?this.negate():new N(this)},N.prototype.isPositive=function(){return(this._hi>0||0===this._hi)&&this._lo>0},N.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo},N.prototype.add=function(){if(arguments[0]instanceof N){var t=arguments[0];return N.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){var e=arguments[0];return N.copy(this).selfAdd(e)}},N.prototype.init=function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof N){var e=arguments[0];this._hi=e._hi,this._lo=e._lo}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this._hi=n,this._lo=r}},N.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo},N.prototype.isNegative=function(){return(this._hi<0||0===this._hi)&&this._lo<0},N.prototype.trunc=function(){return this.isNaN()?N.NaN:this.isPositive()?this.floor():this.ceil()},N.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},N.prototype.interfaces_=function(){return[e,b,x]},N.prototype.getClass=function(){return N},N.sqr=function(t){return N.valueOf(t).selfMultiply(t)},N.valueOf=function(){if("string"==typeof arguments[0]){var t=arguments[0];return N.parse(t)}if("number"==typeof arguments[0])return new N(arguments[0])},N.sqrt=function(t){return N.valueOf(t).sqrt()},N.parse=function(t){for(var e=0,n=t.length;D.isWhitespace(t.charAt(e));)e++;var r=!1;if(e<n){var i=t.charAt(e);"-"!==i&&"+"!==i||(e++,"-"===i&&(r=!0))}for(var o=new N,s=0,a=0,l=0;!(e>=n);){var u=t.charAt(e);if(e++,D.isDigit(u)){var c=u-"0";o.selfMultiply(N.TEN),o.selfAdd(c),s++}else{if("."!==u){if("e"===u||"E"===u){var h=t.substring(e);try{l=k.parseInt(h)}catch(e){throw e instanceof Error?new Error("Invalid exponent "+h+" in string "+t):e}break}throw new Error("Unexpected character '"+u+"' at position "+e+" in string "+t)}a=s}}var p=o,f=s-a-l;if(0===f)p=o;else if(f>0){var d=N.TEN.pow(f);p=o.divide(d)}else if(f<0){var g=N.TEN.pow(-f);p=o.multiply(g)}return r?p.negate():p},N.createNaN=function(){return new N(_.NaN,_.NaN)},N.copy=function(t){return new N(t)},N.magnitude=function(t){var e=Math.abs(t),n=Math.log(e)/Math.log(10),r=Math.trunc(Math.floor(n));return 10*Math.pow(10,r)<=e&&(r+=1),r},N.stringOfChar=function(t,e){for(var n=new L,r=0;r<e;r++)n.append(t);return n.toString()},F.PI.get=function(){return new N(3.141592653589793,12246467991473532e-32)},F.TWO_PI.get=function(){return new N(6.283185307179586,24492935982947064e-32)},F.PI_2.get=function(){return new N(1.5707963267948966,6123233995736766e-32)},F.E.get=function(){return new N(2.718281828459045,14456468917292502e-32)},F.NaN.get=function(){return new N(_.NaN,_.NaN)},F.EPS.get=function(){return 123259516440783e-46},F.SPLIT.get=function(){return 134217729},F.MAX_PRINT_DIGITS.get=function(){return 32},F.TEN.get=function(){return N.valueOf(10)},F.ONE.get=function(){return N.valueOf(1)},F.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},F.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(N,F);var B=function(){},z={DP_SAFE_EPSILON:{configurable:!0}};B.prototype.interfaces_=function(){return[]},B.prototype.getClass=function(){return B},B.orientationIndex=function(t,e,n){var r=B.orientationIndexFilter(t,e,n);if(r<=1)return r;var i=N.valueOf(e.x).selfAdd(-t.x),o=N.valueOf(e.y).selfAdd(-t.y),s=N.valueOf(n.x).selfAdd(-e.x),a=N.valueOf(n.y).selfAdd(-e.y);return i.selfMultiply(a).selfSubtract(o.selfMultiply(s)).signum()},B.signOfDet2x2=function(t,e,n,r){return t.multiply(r).selfSubtract(e.multiply(n)).signum()},B.intersection=function(t,e,n,r){var i=N.valueOf(r.y).selfSubtract(n.y).selfMultiply(N.valueOf(e.x).selfSubtract(t.x)),o=N.valueOf(r.x).selfSubtract(n.x).selfMultiply(N.valueOf(e.y).selfSubtract(t.y)),s=i.subtract(o),a=N.valueOf(r.x).selfSubtract(n.x).selfMultiply(N.valueOf(t.y).selfSubtract(n.y)),l=N.valueOf(r.y).selfSubtract(n.y).selfMultiply(N.valueOf(t.x).selfSubtract(n.x)),u=a.subtract(l).selfDivide(s).doubleValue(),c=N.valueOf(t.x).selfAdd(N.valueOf(e.x).selfSubtract(t.x).selfMultiply(u)).doubleValue(),h=N.valueOf(e.x).selfSubtract(t.x).selfMultiply(N.valueOf(t.y).selfSubtract(n.y)),p=N.valueOf(e.y).selfSubtract(t.y).selfMultiply(N.valueOf(t.x).selfSubtract(n.x)),f=h.subtract(p).selfDivide(s).doubleValue(),d=N.valueOf(n.y).selfAdd(N.valueOf(r.y).selfSubtract(n.y).selfMultiply(f)).doubleValue();return new E(c,d)},B.orientationIndexFilter=function(t,e,n){var r=null,i=(t.x-n.x)*(e.y-n.y),o=(t.y-n.y)*(e.x-n.x),s=i-o;if(i>0){if(o<=0)return B.signum(s);r=i+o}else{if(!(i<0))return B.signum(s);if(o>=0)return B.signum(s);r=-i-o}var a=B.DP_SAFE_EPSILON*r;return s>=a||-s>=a?B.signum(s):2},B.signum=function(t){return t>0?1:t<0?-1:0},z.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(B,z);var j=function(){},U={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};U.X.get=function(){return 0},U.Y.get=function(){return 1},U.Z.get=function(){return 2},U.M.get=function(){return 3},j.prototype.setOrdinate=function(t,e,n){},j.prototype.size=function(){},j.prototype.getOrdinate=function(t,e){},j.prototype.getCoordinate=function(){},j.prototype.getCoordinateCopy=function(t){},j.prototype.getDimension=function(){},j.prototype.getX=function(t){},j.prototype.clone=function(){},j.prototype.expandEnvelope=function(t){},j.prototype.copy=function(){},j.prototype.getY=function(t){},j.prototype.toCoordinateArray=function(){},j.prototype.interfaces_=function(){return[x]},j.prototype.getClass=function(){return j},Object.defineProperties(j,U);var V=function(){},G=function(t){function e(){t.call(this,"Projective point not representable on the Cartesian plane.")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(V),Z=function(){};Z.arraycopy=function(t,e,n,r,i){for(var o=0,s=e;s<e+i;s++)n[r+o]=t[s],o++},Z.getProperty=function(t){return{"line.separator":"\n"}[t]};var q=function t(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var n=arguments[0],r=arguments[1];this.x=n,this.y=r,this.w=1}else if(arguments[0]instanceof t&&arguments[1]instanceof t){var i=arguments[0],o=arguments[1];this.x=i.y*o.w-o.y*i.w,this.y=o.x*i.w-i.x*o.w,this.w=i.x*o.y-o.x*i.y}else if(arguments[0]instanceof E&&arguments[1]instanceof E){var s=arguments[0],a=arguments[1];this.x=s.y-a.y,this.y=a.x-s.x,this.w=s.x*a.y-a.x*s.y}}else if(3===arguments.length){var l=arguments[0],u=arguments[1],c=arguments[2];this.x=l,this.y=u,this.w=c}else if(4===arguments.length){var h=arguments[0],p=arguments[1],f=arguments[2],d=arguments[3],g=h.y-p.y,m=p.x-h.x,A=h.x*p.y-p.x*h.y,y=f.y-d.y,_=d.x-f.x,v=f.x*d.y-d.x*f.y;this.x=m*v-_*A,this.y=y*A-g*v,this.w=g*_-y*m}};q.prototype.getY=function(){var t=this.y/this.w;if(_.isNaN(t)||_.isInfinite(t))throw new G;return t},q.prototype.getX=function(){var t=this.x/this.w;if(_.isNaN(t)||_.isInfinite(t))throw new G;return t},q.prototype.getCoordinate=function(){var t=new E;return t.x=this.getX(),t.y=this.getY(),t},q.prototype.interfaces_=function(){return[]},q.prototype.getClass=function(){return q},q.intersection=function(t,e,n,r){var i=t.y-e.y,o=e.x-t.x,s=t.x*e.y-e.x*t.y,a=n.y-r.y,l=r.x-n.x,u=n.x*r.y-r.x*n.y,c=i*l-a*o,h=(o*u-l*s)/c,p=(a*s-i*u)/c;if(_.isNaN(h)||_.isInfinite(h)||_.isNaN(p)||_.isInfinite(p))throw new G;return new E(h,p)};var W=function t(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof E){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}}else if(2===arguments.length){var r=arguments[0],i=arguments[1];this.init(r.x,i.x,r.y,i.y)}else if(4===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2],l=arguments[3];this.init(o,s,a,l)}},H={serialVersionUID:{configurable:!0}};W.prototype.getArea=function(){return this.getWidth()*this.getHeight()},W.prototype.equals=function(t){if(!(t instanceof W))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()},W.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new W;var e=this._minx>t._minx?this._minx:t._minx,n=this._miny>t._miny?this._miny:t._miny,r=this._maxx<t._maxx?this._maxx:t._maxx,i=this._maxy<t._maxy?this._maxy:t._maxy;return new W(e,r,n,i)},W.prototype.isNull=function(){return this._maxx<this._minx},W.prototype.getMaxX=function(){return this._maxx},W.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof E){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof W){var e=arguments[0];return!this.isNull()&&!e.isNull()&&e.getMinX()>=this._minx&&e.getMaxX()<=this._maxx&&e.getMinY()>=this._miny&&e.getMaxY()<=this._maxy}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];return!this.isNull()&&n>=this._minx&&n<=this._maxx&&r>=this._miny&&r<=this._maxy}},W.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof W){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof E){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];return!this.isNull()&&!(n>this._maxx||n<this._minx||r>this._maxy||r<this._miny)}},W.prototype.getMinY=function(){return this._miny},W.prototype.getMinX=function(){return this._minx},W.prototype.expandToInclude=function(){if(1===arguments.length){if(arguments[0]instanceof E){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof W){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this._minx=e.getMinX(),this._maxx=e.getMaxX(),this._miny=e.getMinY(),this._maxy=e.getMaxY()):(e._minx<this._minx&&(this._minx=e._minx),e._maxx>this._maxx&&(this._maxx=e._maxx),e._miny<this._miny&&(this._miny=e._miny),e._maxy>this._maxy&&(this._maxy=e._maxy))}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.isNull()?(this._minx=n,this._maxx=n,this._miny=r,this._maxy=r):(n<this._minx&&(this._minx=n),n>this._maxx&&(this._maxx=n),r<this._miny&&(this._miny=r),r>this._maxy&&(this._maxy=r))}},W.prototype.minExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e},W.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},W.prototype.compareTo=function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0},W.prototype.translate=function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)},W.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},W.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},W.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},W.prototype.maxExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e},W.prototype.expandBy=function(){if(1===arguments.length){var t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=n,this._maxy+=n,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},W.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof W){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof E){var e=arguments[0];return this.covers(e)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];return this.covers(n,r)}},W.prototype.centre=function(){return this.isNull()?null:new E((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},W.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof E){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof W){var e=arguments[0];this._minx=e._minx,this._maxx=e._maxx,this._miny=e._miny,this._maxy=e._maxy}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.init(n.x,r.x,n.y,r.y)}else if(4===arguments.length){var i=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];i<o?(this._minx=i,this._maxx=o):(this._minx=o,this._maxx=i),s<a?(this._miny=s,this._maxy=a):(this._miny=a,this._maxy=s)}},W.prototype.getMaxY=function(){return this._maxy},W.prototype.distance=function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var n=0;return this._maxy<t._miny?n=t._miny-this._maxy:this._miny>t._maxy&&(n=this._miny-t._maxy),0===e?n:0===n?e:Math.sqrt(e*e+n*n)},W.prototype.hashCode=function(){var t=17;return 37*(t=37*(t=37*(t=37*t+E.hashCode(this._minx))+E.hashCode(this._maxx))+E.hashCode(this._miny))+E.hashCode(this._maxy)},W.prototype.interfaces_=function(){return[b,e]},W.prototype.getClass=function(){return W},W.intersects=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2];return n.x>=(t.x<e.x?t.x:e.x)&&n.x<=(t.x>e.x?t.x:e.x)&&n.y>=(t.y<e.y?t.y:e.y)&&n.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2],s=arguments[3],a=Math.min(o.x,s.x),l=Math.max(o.x,s.x),u=Math.min(r.x,i.x),c=Math.max(r.x,i.x);return!(u>l||c<a||(a=Math.min(o.y,s.y),l=Math.max(o.y,s.y),u=Math.min(r.y,i.y),c=Math.max(r.y,i.y),u>l||c<a))}},H.serialVersionUID.get=function(){return 0x51845cd552189800},Object.defineProperties(W,H);var X={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},$=function(t){this.geometryFactory=t||new Ae};$.prototype.read=function(t){var e,n,r;t=t.replace(/[\n\r]/g," ");var i=X.typeStr.exec(t);if(-1!==t.search("EMPTY")&&((i=X.emptyTypeStr.exec(t))[2]=void 0),i&&(n=i[1].toLowerCase(),r=i[2],Q[n]&&(e=Q[n].apply(this,[r]))),void 0===e)throw new Error("Could not parse WKT "+t);return e},$.prototype.write=function(t){return this.extractGeometry(t)},$.prototype.extractGeometry=function(t){var e=t.getGeometryType().toLowerCase();if(!Y[e])return null;var n=e.toUpperCase();return t.isEmpty()?n+" EMPTY":n+"("+Y[e].apply(this,[t])+")"};var Y={coordinate:function(t){return t.x+" "+t.y},point:function(t){return Y.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var e=[],n=0,r=t._geometries.length;n<r;++n)e.push("("+Y.point.apply(this,[t._geometries[n]])+")");return e.join(",")},linestring:function(t){for(var e=[],n=0,r=t._points._coordinates.length;n<r;++n)e.push(Y.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},linearring:function(t){for(var e=[],n=0,r=t._points._coordinates.length;n<r;++n)e.push(Y.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},multilinestring:function(t){for(var e=[],n=0,r=t._geometries.length;n<r;++n)e.push("("+Y.linestring.apply(this,[t._geometries[n]])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+Y.linestring.apply(this,[t._shell])+")");for(var n=0,r=t._holes.length;n<r;++n)e.push("("+Y.linestring.apply(this,[t._holes[n]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],n=0,r=t._geometries.length;n<r;++n)e.push("("+Y.polygon.apply(this,[t._geometries[n]])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],n=0,r=t._geometries.length;n<r;++n)e.push(this.extractGeometry(t._geometries[n]));return e.join(",")}},Q={point:function(t){if(void 0===t)return this.geometryFactory.createPoint();var e=t.trim().split(X.spaces);return this.geometryFactory.createPoint(new E(Number.parseFloat(e[0]),Number.parseFloat(e[1])))},multipoint:function(t){if(void 0===t)return this.geometryFactory.createMultiPoint();for(var e,n=t.trim().split(","),r=[],i=0,o=n.length;i<o;++i)e=n[i].replace(X.trimParens,"$1"),r.push(Q.point.apply(this,[e]));return this.geometryFactory.createMultiPoint(r)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString();for(var e,n=t.trim().split(","),r=[],i=0,o=n.length;i<o;++i)e=n[i].trim().split(X.spaces),r.push(new E(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLineString(r)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing();for(var e,n=t.trim().split(","),r=[],i=0,o=n.length;i<o;++i)e=n[i].trim().split(X.spaces),r.push(new E(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLinearRing(r)},multilinestring:function(t){if(void 0===t)return this.geometryFactory.createMultiLineString();for(var e,n=t.trim().split(X.parenComma),r=[],i=0,o=n.length;i<o;++i)e=n[i].replace(X.trimParens,"$1"),r.push(Q.linestring.apply(this,[e]));return this.geometryFactory.createMultiLineString(r)},polygon:function(t){if(void 0===t)return this.geometryFactory.createPolygon();for(var e,n,r,i,o=t.trim().split(X.parenComma),s=[],a=0,l=o.length;a<l;++a)e=o[a].replace(X.trimParens,"$1"),n=Q.linestring.apply(this,[e]),r=this.geometryFactory.createLinearRing(n._points),0===a?i=r:s.push(r);return this.geometryFactory.createPolygon(i,s)},multipolygon:function(t){if(void 0===t)return this.geometryFactory.createMultiPolygon();for(var e,n=t.trim().split(X.doubleParenComma),r=[],i=0,o=n.length;i<o;++i)e=n[i].replace(X.trimParens,"$1"),r.push(Q.polygon.apply(this,[e]));return this.geometryFactory.createMultiPolygon(r)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();for(var e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),n=[],r=0,i=e.length;r<i;++r)n.push(this.read(e[r]));return this.geometryFactory.createGeometryCollection(n)}},K=function(t){this.parser=new $(t)};K.prototype.write=function(t){return this.parser.write(t)},K.toLineString=function(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"};var J=function(t){function e(e){t.call(this,e),this.name="RuntimeException",this.message=e,this.stack=(new t).stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),tt=function(t){function e(){if(t.call(this),0===arguments.length)t.call(this);else if(1===arguments.length){var e=arguments[0];t.call(this,e)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(J),et=function(){};et.prototype.interfaces_=function(){return[]},et.prototype.getClass=function(){return et},et.shouldNeverReachHere=function(){if(0===arguments.length)et.shouldNeverReachHere(null);else if(1===arguments.length){var t=arguments[0];throw new tt("Should never reach here"+(null!==t?": "+t:""))}},et.isTrue=function(){var t;if(1===arguments.length)et.isTrue(arguments[0],null);else if(2===arguments.length&&(t=arguments[1],!arguments[0]))throw null===t?new tt:new tt(t)},et.equals=function(){var t,e,n;if(2===arguments.length)et.equals(t=arguments[0],e=arguments[1],null);else if(3===arguments.length&&(t=arguments[0],n=arguments[2],!(e=arguments[1]).equals(t)))throw new tt("Expected "+t+" but encountered "+e+(null!==n?": "+n:""))};var nt=function(){this._result=null,this._inputLines=Array(2).fill().map((function(){return Array(2)})),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new E,this._intPt[1]=new E,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},rt={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};nt.prototype.getIndexAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]},nt.prototype.getTopologySummary=function(){var t=new L;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()},nt.prototype.computeIntersection=function(t,e,n,r){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=n,this._inputLines[1][1]=r,this._result=this.computeIntersect(t,e,n,r)},nt.prototype.getIntersectionNum=function(){return this._result},nt.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map((function(){return Array(2)})),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}},nt.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},nt.prototype.setPrecisionModel=function(t){this._precisionModel=t},nt.prototype.isInteriorIntersection=function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var t=arguments[0],e=0;e<this._result;e++)if(!this._intPt[e].equals2D(this._inputLines[t][0])&&!this._intPt[e].equals2D(this._inputLines[t][1]))return!0;return!1}},nt.prototype.getIntersection=function(t){return this._intPt[t]},nt.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},nt.prototype.hasIntersection=function(){return this._result!==nt.NO_INTERSECTION},nt.prototype.getEdgeDistance=function(t,e){return nt.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])},nt.prototype.isCollinear=function(){return this._result===nt.COLLINEAR_INTERSECTION},nt.prototype.toString=function(){return K.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+K.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},nt.prototype.getEndpoint=function(t,e){return this._inputLines[t][e]},nt.prototype.isIntersection=function(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1},nt.prototype.getIntersectionAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]},nt.prototype.interfaces_=function(){return[]},nt.prototype.getClass=function(){return nt},nt.computeEdgeDistance=function(t,e,n){var r=Math.abs(n.x-e.x),i=Math.abs(n.y-e.y),o=-1;if(t.equals(e))o=0;else if(t.equals(n))o=r>i?r:i;else{var s=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);0!==(o=r>i?s:a)||t.equals(e)||(o=Math.max(s,a))}return et.isTrue(!(0===o&&!t.equals(e)),"Bad distance calculation"),o},nt.nonRobustComputeEdgeDistance=function(t,e,n){var r=t.x-e.x,i=t.y-e.y,o=Math.sqrt(r*r+i*i);return et.isTrue(!(0===o&&!t.equals(e)),"Invalid distance calculation"),o},rt.DONT_INTERSECT.get=function(){return 0},rt.DO_INTERSECT.get=function(){return 1},rt.COLLINEAR.get=function(){return 2},rt.NO_INTERSECTION.get=function(){return 0},rt.POINT_INTERSECTION.get=function(){return 1},rt.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(nt,rt);var it=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isInSegmentEnvelopes=function(t){var e=new W(this._inputLines[0][0],this._inputLines[0][1]),n=new W(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&n.contains(t)},e.prototype.computeIntersection=function(){if(3!==arguments.length)return t.prototype.computeIntersection.apply(this,arguments);var e=arguments[0],n=arguments[1],r=arguments[2];if(this._isProper=!1,W.intersects(n,r,e)&&0===at.orientationIndex(n,r,e)&&0===at.orientationIndex(r,n,e))return this._isProper=!0,(e.equals(n)||e.equals(r))&&(this._isProper=!1),this._result=t.POINT_INTERSECTION,null;this._result=t.NO_INTERSECTION},e.prototype.normalizeToMinimum=function(t,e,n,r,i){i.x=this.smallestInAbsValue(t.x,e.x,n.x,r.x),i.y=this.smallestInAbsValue(t.y,e.y,n.y,r.y),t.x-=i.x,t.y-=i.y,e.x-=i.x,e.y-=i.y,n.x-=i.x,n.y-=i.y,r.x-=i.x,r.y-=i.y},e.prototype.safeHCoordinateIntersection=function(t,n,r,i){var o=null;try{o=q.intersection(t,n,r,i)}catch(s){if(!(s instanceof G))throw s;o=e.nearestEndpoint(t,n,r,i)}return o},e.prototype.intersection=function(t,n,r,i){var o=this.intersectionWithNormalization(t,n,r,i);return this.isInSegmentEnvelopes(o)||(o=new E(e.nearestEndpoint(t,n,r,i))),null!==this._precisionModel&&this._precisionModel.makePrecise(o),o},e.prototype.smallestInAbsValue=function(t,e,n,r){var i=t,o=Math.abs(i);return Math.abs(e)<o&&(i=e,o=Math.abs(e)),Math.abs(n)<o&&(i=n,o=Math.abs(n)),Math.abs(r)<o&&(i=r),i},e.prototype.checkDD=function(t,e,n,r,i){var o=B.intersection(t,e,n,r),s=this.isInSegmentEnvelopes(o);Z.out.println("DD in env = "+s+"  --------------------- "+o),i.distance(o)>1e-4&&Z.out.println("Distance = "+i.distance(o))},e.prototype.intersectionWithNormalization=function(t,e,n,r){var i=new E(t),o=new E(e),s=new E(n),a=new E(r),l=new E;this.normalizeToEnvCentre(i,o,s,a,l);var u=this.safeHCoordinateIntersection(i,o,s,a);return u.x+=l.x,u.y+=l.y,u},e.prototype.computeCollinearIntersection=function(e,n,r,i){var o=W.intersects(e,n,r),s=W.intersects(e,n,i),a=W.intersects(r,i,e),l=W.intersects(r,i,n);return o&&s?(this._intPt[0]=r,this._intPt[1]=i,t.COLLINEAR_INTERSECTION):a&&l?(this._intPt[0]=e,this._intPt[1]=n,t.COLLINEAR_INTERSECTION):o&&a?(this._intPt[0]=r,this._intPt[1]=e,!r.equals(e)||s||l?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):o&&l?(this._intPt[0]=r,this._intPt[1]=n,!r.equals(n)||s||a?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):s&&a?(this._intPt[0]=i,this._intPt[1]=e,!i.equals(e)||o||l?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):s&&l?(this._intPt[0]=i,this._intPt[1]=n,!i.equals(n)||o||a?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):t.NO_INTERSECTION},e.prototype.normalizeToEnvCentre=function(t,e,n,r,i){var o=t.x<e.x?t.x:e.x,s=t.y<e.y?t.y:e.y,a=t.x>e.x?t.x:e.x,l=t.y>e.y?t.y:e.y,u=n.x<r.x?n.x:r.x,c=n.y<r.y?n.y:r.y,h=n.x>r.x?n.x:r.x,p=n.y>r.y?n.y:r.y,f=((o>u?o:u)+(a<h?a:h))/2,d=((s>c?s:c)+(l<p?l:p))/2;i.x=f,i.y=d,t.x-=i.x,t.y-=i.y,e.x-=i.x,e.y-=i.y,n.x-=i.x,n.y-=i.y,r.x-=i.x,r.y-=i.y},e.prototype.computeIntersect=function(e,n,r,i){if(this._isProper=!1,!W.intersects(e,n,r,i))return t.NO_INTERSECTION;var o=at.orientationIndex(e,n,r),s=at.orientationIndex(e,n,i);if(o>0&&s>0||o<0&&s<0)return t.NO_INTERSECTION;var a=at.orientationIndex(r,i,e),l=at.orientationIndex(r,i,n);return a>0&&l>0||a<0&&l<0?t.NO_INTERSECTION:0===o&&0===s&&0===a&&0===l?this.computeCollinearIntersection(e,n,r,i):(0===o||0===s||0===a||0===l?(this._isProper=!1,e.equals2D(r)||e.equals2D(i)?this._intPt[0]=e:n.equals2D(r)||n.equals2D(i)?this._intPt[0]=n:0===o?this._intPt[0]=new E(r):0===s?this._intPt[0]=new E(i):0===a?this._intPt[0]=new E(e):0===l&&(this._intPt[0]=new E(n))):(this._isProper=!0,this._intPt[0]=this.intersection(e,n,r,i)),t.POINT_INTERSECTION)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.nearestEndpoint=function(t,e,n,r){var i=t,o=at.distancePointLine(t,n,r),s=at.distancePointLine(e,n,r);return s<o&&(o=s,i=e),(s=at.distancePointLine(n,t,e))<o&&(o=s,i=n),(s=at.distancePointLine(r,t,e))<o&&(o=s,i=r),i},e}(nt),ot=function(){};ot.prototype.interfaces_=function(){return[]},ot.prototype.getClass=function(){return ot},ot.orientationIndex=function(t,e,n){var r=e.x-t.x,i=e.y-t.y,o=n.x-e.x,s=n.y-e.y;return ot.signOfDet2x2(r,i,o,s)},ot.signOfDet2x2=function(t,e,n,r){var i=null,o=null,s=null;if(i=1,0===t||0===r)return 0===e||0===n?0:e>0?n>0?-i:i:n>0?i:-i;if(0===e||0===n)return r>0?t>0?i:-i:t>0?-i:i;if(e>0?r>0?e<=r||(i=-i,o=t,t=n,n=o,o=e,e=r,r=o):e<=-r?(i=-i,n=-n,r=-r):(o=t,t=-n,n=o,o=e,e=-r,r=o):r>0?-e<=r?(i=-i,t=-t,e=-e):(o=-t,t=n,n=o,o=-e,e=r,r=o):e>=r?(t=-t,e=-e,n=-n,r=-r):(i=-i,o=-t,t=-n,n=o,o=-e,e=-r,r=o),t>0){if(!(n>0))return i;if(!(t<=n))return i}else{if(n>0)return-i;if(!(t>=n))return-i;i=-i,t=-t,n=-n}for(;;){if((r-=(s=Math.floor(n/t))*e)<0)return-i;if(r>e)return i;if(t>(n-=s*t)+n){if(e<r+r)return i}else{if(e>r+r)return-i;n=t-n,r=e-r,i=-i}if(0===r)return 0===n?0:-i;if(0===n)return i;if((e-=(s=Math.floor(t/n))*r)<0)return i;if(e>r)return-i;if(n>(t-=s*n)+t){if(r<e+e)return-i}else{if(r>e+e)return i;t=n-t,e=r-e,i=-i}if(0===e)return 0===t?0:i;if(0===t)return-i}};var st=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t};st.prototype.countSegment=function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var n=t.x,r=e.x;return n>r&&(n=e.x,r=t.x),this._p.x>=n&&this._p.x<=r&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var i=t.x-this._p.x,o=t.y-this._p.y,s=e.x-this._p.x,a=e.y-this._p.y,l=ot.signOfDet2x2(i,o,s,a);if(0===l)return this._isPointOnSegment=!0,null;a<o&&(l=-l),l>0&&this._crossingCount++}},st.prototype.isPointInPolygon=function(){return this.getLocation()!==M.EXTERIOR},st.prototype.getLocation=function(){return this._isPointOnSegment?M.BOUNDARY:this._crossingCount%2==1?M.INTERIOR:M.EXTERIOR},st.prototype.isOnSegment=function(){return this._isPointOnSegment},st.prototype.interfaces_=function(){return[]},st.prototype.getClass=function(){return st},st.locatePointInRing=function(){if(arguments[0]instanceof E&&I(arguments[1],j)){for(var t=arguments[1],e=new st(arguments[0]),n=new E,r=new E,i=1;i<t.size();i++)if(t.getCoordinate(i,n),t.getCoordinate(i-1,r),e.countSegment(n,r),e.isOnSegment())return e.getLocation();return e.getLocation()}if(arguments[0]instanceof E&&arguments[1]instanceof Array){for(var o=arguments[1],s=new st(arguments[0]),a=1;a<o.length;a++){var l=o[a],u=o[a-1];if(s.countSegment(l,u),s.isOnSegment())return s.getLocation()}return s.getLocation()}};var at=function(){},lt={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};at.prototype.interfaces_=function(){return[]},at.prototype.getClass=function(){return at},at.orientationIndex=function(t,e,n){return B.orientationIndex(t,e,n)},at.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,n=t[0].x,r=1;r<t.length-1;r++){var i=t[r].x-n,o=t[r+1].y;e+=i*(t[r-1].y-o)}return e/2}if(I(arguments[0],j)){var s=arguments[0],a=s.size();if(a<3)return 0;var l=new E,u=new E,c=new E;s.getCoordinate(0,u),s.getCoordinate(1,c);var h=u.x;c.x-=h;for(var p=0,f=1;f<a-1;f++)l.y=u.y,u.x=c.x,u.y=c.y,s.getCoordinate(f+1,c),c.x-=h,p+=u.x*(l.y-c.y);return p/2}},at.distanceLineLine=function(t,e,n,r){if(t.equals(e))return at.distancePointLine(t,n,r);if(n.equals(r))return at.distancePointLine(r,t,e);var i=!1;if(W.intersects(t,e,n,r)){var o=(e.x-t.x)*(r.y-n.y)-(e.y-t.y)*(r.x-n.x);if(0===o)i=!0;else{var s=(t.y-n.y)*(r.x-n.x)-(t.x-n.x)*(r.y-n.y),a=((t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y))/o,l=s/o;(l<0||l>1||a<0||a>1)&&(i=!0)}}else i=!0;return i?O.min(at.distancePointLine(t,n,r),at.distancePointLine(e,n,r),at.distancePointLine(n,t,e),at.distancePointLine(r,t,e)):0},at.isPointInRing=function(t,e){return at.locatePointInRing(t,e)!==M.EXTERIOR},at.computeLength=function(t){var e=t.size();if(e<=1)return 0;var n=0,r=new E;t.getCoordinate(0,r);for(var i=r.x,o=r.y,s=1;s<e;s++){t.getCoordinate(s,r);var a=r.x,l=r.y,u=a-i,c=l-o;n+=Math.sqrt(u*u+c*c),i=a,o=l}return n},at.isCCW=function(t){var e=t.length-1;if(e<3)throw new y("Ring has fewer than 4 points, so orientation cannot be determined");for(var n=t[0],r=0,i=1;i<=e;i++){var o=t[i];o.y>n.y&&(n=o,r=i)}var s=r;do{(s-=1)<0&&(s=e)}while(t[s].equals2D(n)&&s!==r);var a=r;do{a=(a+1)%e}while(t[a].equals2D(n)&&a!==r);var l=t[s],u=t[a];if(l.equals2D(n)||u.equals2D(n)||l.equals2D(u))return!1;var c=at.computeOrientation(l,n,u);return 0===c?l.x>u.x:c>0},at.locatePointInRing=function(t,e){return st.locatePointInRing(t,e)},at.distancePointLinePerpendicular=function(t,e,n){var r=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),i=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/r;return Math.abs(i)*Math.sqrt(r)},at.computeOrientation=function(t,e,n){return at.orientationIndex(t,e,n)},at.distancePointLine=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(0===e.length)throw new y("Line array must contain at least one vertex");for(var n=t.distance(e[0]),r=0;r<e.length-1;r++){var i=at.distancePointLine(t,e[r],e[r+1]);i<n&&(n=i)}return n}if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];if(s.x===a.x&&s.y===a.y)return o.distance(s);var l=(a.x-s.x)*(a.x-s.x)+(a.y-s.y)*(a.y-s.y),u=((o.x-s.x)*(a.x-s.x)+(o.y-s.y)*(a.y-s.y))/l;if(u<=0)return o.distance(s);if(u>=1)return o.distance(a);var c=((s.y-o.y)*(a.x-s.x)-(s.x-o.x)*(a.y-s.y))/l;return Math.abs(c)*Math.sqrt(l)}},at.isOnLine=function(t,e){for(var n=new it,r=1;r<e.length;r++){var i=e[r-1],o=e[r];if(n.computeIntersection(t,i,o),n.hasIntersection())return!0}return!1},lt.CLOCKWISE.get=function(){return-1},lt.RIGHT.get=function(){return at.CLOCKWISE},lt.COUNTERCLOCKWISE.get=function(){return 1},lt.LEFT.get=function(){return at.COUNTERCLOCKWISE},lt.COLLINEAR.get=function(){return 0},lt.STRAIGHT.get=function(){return at.COLLINEAR},Object.defineProperties(at,lt);var ut=function(){};ut.prototype.filter=function(t){},ut.prototype.interfaces_=function(){return[]},ut.prototype.getClass=function(){return ut};var ct=function(){var t=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=t,this._SRID=t.getSRID()},ht={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};ct.prototype.isGeometryCollection=function(){return this.getSortIndex()===ct.SORTINDEX_GEOMETRYCOLLECTION},ct.prototype.getFactory=function(){return this._factory},ct.prototype.getGeometryN=function(t){return this},ct.prototype.getArea=function(){return 0},ct.prototype.isRectangle=function(){return!1},ct.prototype.equals=function(){if(arguments[0]instanceof ct){var t=arguments[0];return null!==t&&this.equalsTopo(t)}if(arguments[0]instanceof Object){var e=arguments[0];if(!(e instanceof ct))return!1;var n=e;return this.equalsExact(n)}},ct.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)},ct.prototype.geometryChanged=function(){this.apply(ct.geometryChangedFilter)},ct.prototype.geometryChangedAction=function(){this._envelope=null},ct.prototype.equalsNorm=function(t){return null!==t&&this.norm().equalsExact(t.norm())},ct.prototype.getLength=function(){return 0},ct.prototype.getNumGeometries=function(){return 1},ct.prototype.compareTo=function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}if(2===arguments.length){var n=arguments[0],r=arguments[1];return this.getSortIndex()!==n.getSortIndex()?this.getSortIndex()-n.getSortIndex():this.isEmpty()&&n.isEmpty()?0:this.isEmpty()?-1:n.isEmpty()?1:this.compareToSameClass(n,r)}},ct.prototype.getUserData=function(){return this._userData},ct.prototype.getSRID=function(){return this._SRID},ct.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},ct.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===ct.SORTINDEX_GEOMETRYCOLLECTION)throw new y("This method does not support GeometryCollection arguments")},ct.prototype.equal=function(t,e,n){return 0===n?t.equals(e):t.distance(e)<=n},ct.prototype.norm=function(){var t=this.copy();return t.normalize(),t},ct.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},ct.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new W(this._envelope)},ct.prototype.setSRID=function(t){this._SRID=t},ct.prototype.setUserData=function(t){this._userData=t},ct.prototype.compare=function(t,e){for(var n=t.iterator(),r=e.iterator();n.hasNext()&&r.hasNext();){var i=n.next(),o=r.next(),s=i.compareTo(o);if(0!==s)return s}return n.hasNext()?1:r.hasNext()?-1:0},ct.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},ct.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===ct.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===ct.SORTINDEX_MULTIPOINT||this.getSortIndex()===ct.SORTINDEX_MULTILINESTRING||this.getSortIndex()===ct.SORTINDEX_MULTIPOLYGON},ct.prototype.interfaces_=function(){return[x,b,e]},ct.prototype.getClass=function(){return ct},ct.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1},ct.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1},ht.serialVersionUID.get=function(){return 0x799ea46522854c00},ht.SORTINDEX_POINT.get=function(){return 0},ht.SORTINDEX_MULTIPOINT.get=function(){return 1},ht.SORTINDEX_LINESTRING.get=function(){return 2},ht.SORTINDEX_LINEARRING.get=function(){return 3},ht.SORTINDEX_MULTILINESTRING.get=function(){return 4},ht.SORTINDEX_POLYGON.get=function(){return 5},ht.SORTINDEX_MULTIPOLYGON.get=function(){return 6},ht.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},ht.geometryChangedFilter.get=function(){return pt},Object.defineProperties(ct,ht);var pt=function(){};pt.interfaces_=function(){return[ut]},pt.filter=function(t){t.geometryChangedAction()};var ft=function(){};ft.prototype.filter=function(t){},ft.prototype.interfaces_=function(){return[]},ft.prototype.getClass=function(){return ft};var dt=function(){},gt={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};dt.prototype.isInBoundary=function(t){},dt.prototype.interfaces_=function(){return[]},dt.prototype.getClass=function(){return dt},gt.Mod2BoundaryNodeRule.get=function(){return mt},gt.EndPointBoundaryNodeRule.get=function(){return At},gt.MultiValentEndPointBoundaryNodeRule.get=function(){return yt},gt.MonoValentEndPointBoundaryNodeRule.get=function(){return _t},gt.MOD2_BOUNDARY_RULE.get=function(){return new mt},gt.ENDPOINT_BOUNDARY_RULE.get=function(){return new At},gt.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new yt},gt.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new _t},gt.OGC_SFS_BOUNDARY_RULE.get=function(){return dt.MOD2_BOUNDARY_RULE},Object.defineProperties(dt,gt);var mt=function(){};mt.prototype.isInBoundary=function(t){return t%2==1},mt.prototype.interfaces_=function(){return[dt]},mt.prototype.getClass=function(){return mt};var At=function(){};At.prototype.isInBoundary=function(t){return t>0},At.prototype.interfaces_=function(){return[dt]},At.prototype.getClass=function(){return At};var yt=function(){};yt.prototype.isInBoundary=function(t){return t>1},yt.prototype.interfaces_=function(){return[dt]},yt.prototype.getClass=function(){return yt};var _t=function(){};_t.prototype.isInBoundary=function(t){return 1===t},_t.prototype.interfaces_=function(){return[dt]},_t.prototype.getClass=function(){return _t};var vt=function(){};vt.prototype.add=function(){},vt.prototype.addAll=function(){},vt.prototype.isEmpty=function(){},vt.prototype.iterator=function(){},vt.prototype.size=function(){},vt.prototype.toArray=function(){},vt.prototype.remove=function(){},(n.prototype=new Error).name="IndexOutOfBoundsException";var bt=function(){};bt.prototype.hasNext=function(){},bt.prototype.next=function(){},bt.prototype.remove=function(){};var xt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(){},e.prototype.set=function(){},e.prototype.isEmpty=function(){},e}(vt);(r.prototype=new Error).name="NoSuchElementException";var wt=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof vt&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.ensureCapacity=function(){},e.prototype.interfaces_=function(){return[t,vt]},e.prototype.add=function(t){return 1===arguments.length?this.array_.push(t):this.array_.splice(arguments[0],arguments[1]),!0},e.prototype.clear=function(){this.array_=[]},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.set=function(t,e){var n=this.array_[t];return this.array_[t]=e,n},e.prototype.iterator=function(){return new Et(this)},e.prototype.get=function(t){if(t<0||t>=this.size())throw new n;return this.array_[t]},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.size=function(){return this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e.prototype.remove=function(t){for(var e=!1,n=0,r=this.array_.length;n<r;n++)if(this.array_[n]===t){this.array_.splice(n,1),e=!0;break}return e},e}(xt),Et=function(t){function e(e){t.call(this),this.arrayList_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new r;return this.arrayList_.get(this.position_++)},e.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},e.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},e.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},e}(bt),St=function(t){function e(){if(t.call(this),0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.ensureCapacity(e.length),this.add(e,!0)}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.ensureCapacity(n.length),this.add(n,r)}}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={coordArrayType:{configurable:!0}};return n.coordArrayType.get=function(){return new Array(0).fill(null)},e.prototype.getCoordinate=function(t){return this.get(t)},e.prototype.addAll=function(){if(2===arguments.length){for(var e=arguments[1],n=!1,r=arguments[0].iterator();r.hasNext();)this.add(r.next(),e),n=!0;return n}return t.prototype.addAll.apply(this,arguments)},e.prototype.clone=function(){for(var e=t.prototype.clone.call(this),n=0;n<this.size();n++)e.add(n,this.get(n).copy());return e},e.prototype.toCoordinateArray=function(){return this.toArray(e.coordArrayType)},e.prototype.add=function(){if(1===arguments.length){var e=arguments[0];t.prototype.add.call(this,e)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var n=arguments[0],r=arguments[1];return this.add(n,r,!0),!0}if(arguments[0]instanceof E&&"boolean"==typeof arguments[1]){var i=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(i))return null;t.prototype.add.call(this,i)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){var o=arguments[0],s=arguments[1];return this.add(o,s),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var a=arguments[0],l=arguments[1];if(arguments[2])for(var u=0;u<a.length;u++)this.add(a[u],l);else for(var c=a.length-1;c>=0;c--)this.add(a[c],l);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof E){var h=arguments[0],p=arguments[1];if(!arguments[2]){var f=this.size();if(f>0){if(h>0&&this.get(h-1).equals2D(p))return null;if(h<f&&this.get(h).equals2D(p))return null}}t.prototype.add.call(this,h,p)}}else if(4===arguments.length){var d=arguments[0],g=arguments[1],m=arguments[2],A=arguments[3],y=1;m>A&&(y=-1);for(var _=m;_!==A;_+=y)this.add(d[_],g);return!0}},e.prototype.closeRing=function(){this.size()>0&&this.add(new E(this.get(0)),!1)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},Object.defineProperties(e,n),e}(wt),Tt=function(){},Pt={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};Pt.ForwardComparator.get=function(){return Mt},Pt.BidirectionalComparator.get=function(){return Ct},Pt.coordArrayType.get=function(){return new Array(0).fill(null)},Tt.prototype.interfaces_=function(){return[]},Tt.prototype.getClass=function(){return Tt},Tt.isRing=function(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))},Tt.ptNotInList=function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(Tt.indexOf(r,e)<0)return r}return null},Tt.scroll=function(t,e){var n=Tt.indexOf(e,t);if(n<0)return null;var r=new Array(t.length).fill(null);Z.arraycopy(t,n,r,0,t.length-n),Z.arraycopy(t,0,r,t.length-n,n),Z.arraycopy(r,0,t,0,t.length)},Tt.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2];if(r===i)return!0;if(null===r||null===i)return!1;if(r.length!==i.length)return!1;for(var s=0;s<r.length;s++)if(0!==o.compare(r[s],i[s]))return!1;return!0}},Tt.intersection=function(t,e){for(var n=new St,r=0;r<t.length;r++)e.intersects(t[r])&&n.add(t[r],!0);return n.toCoordinateArray()},Tt.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1},Tt.removeRepeatedPoints=function(t){return Tt.hasRepeatedPoints(t)?new St(t,!1).toCoordinateArray():t},Tt.reverse=function(t){for(var e=t.length-1,n=Math.trunc(e/2),r=0;r<=n;r++){var i=t[r];t[r]=t[e-r],t[e-r]=i}},Tt.removeNull=function(t){for(var e=0,n=0;n<t.length;n++)null!==t[n]&&e++;var r=new Array(e).fill(null);if(0===e)return r;for(var i=0,o=0;o<t.length;o++)null!==t[o]&&(r[i++]=t[o]);return r},Tt.copyDeep=function(){if(1===arguments.length){for(var t=arguments[0],e=new Array(t.length).fill(null),n=0;n<t.length;n++)e[n]=new E(t[n]);return e}if(5===arguments.length)for(var r=arguments[0],i=arguments[1],o=arguments[2],s=arguments[3],a=arguments[4],l=0;l<a;l++)o[s+l]=new E(r[i+l])},Tt.isEqualReversed=function(t,e){for(var n=0;n<t.length;n++){var r=t[n],i=e[t.length-n-1];if(0!==r.compareTo(i))return!1}return!0},Tt.envelope=function(t){for(var e=new W,n=0;n<t.length;n++)e.expandToInclude(t[n]);return e},Tt.toCoordinateArray=function(t){return t.toArray(Tt.coordArrayType)},Tt.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]},Tt.indexOf=function(t,e){for(var n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1},Tt.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var n=t.length-1-e,r=t[e].compareTo(t[n]);if(0!==r)return r}return 1},Tt.compare=function(t,e){for(var n=0;n<t.length&&n<e.length;){var r=t[n].compareTo(e[n]);if(0!==r)return r;n++}return n<e.length?-1:n<t.length?1:0},Tt.minCoordinate=function(t){for(var e=null,n=0;n<t.length;n++)(null===e||e.compareTo(t[n])>0)&&(e=t[n]);return e},Tt.extract=function(t,e,n){e=O.clamp(e,0,t.length);var r=(n=O.clamp(n,-1,t.length))-e+1;n<0&&(r=0),e>=t.length&&(r=0),n<e&&(r=0);var i=new Array(r).fill(null);if(0===r)return i;for(var o=0,s=e;s<=n;s++)i[o++]=t[s];return i},Object.defineProperties(Tt,Pt);var Mt=function(){};Mt.prototype.compare=function(t,e){return Tt.compare(t,e)},Mt.prototype.interfaces_=function(){return[w]},Mt.prototype.getClass=function(){return Mt};var Ct=function(){};Ct.prototype.compare=function(t,e){var n=t,r=e;if(n.length<r.length)return-1;if(n.length>r.length)return 1;if(0===n.length)return 0;var i=Tt.compare(n,r);return Tt.isEqualReversed(n,r)?0:i},Ct.prototype.OLDcompare=function(t,e){var n=t,r=e;if(n.length<r.length)return-1;if(n.length>r.length)return 1;if(0===n.length)return 0;for(var i=Tt.increasingDirection(n),o=Tt.increasingDirection(r),s=i>0?0:n.length-1,a=o>0?0:n.length-1,l=0;l<n.length;l++){var u=n[s].compareTo(r[a]);if(0!==u)return u;s+=i,a+=o}return 0},Ct.prototype.interfaces_=function(){return[w]},Ct.prototype.getClass=function(){return Ct};var It=function(){};It.prototype.get=function(){},It.prototype.put=function(){},It.prototype.size=function(){},It.prototype.values=function(){},It.prototype.entrySet=function(){};var Ot=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(It);(i.prototype=new Error).name="OperationNotSupported",(o.prototype=new vt).contains=function(){};var Rt=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof vt&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(this.array_[e]===t)return!0;return!1},e.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.remove=function(t){throw new Error},e.prototype.size=function(){return this.array_.length},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e.prototype.iterator=function(){return new Lt(this)},e}(o),Lt=function(t){function e(e){t.call(this),this.hashSet_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new r;return this.hashSet_.array_[this.position_++]},e.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},e.prototype.remove=function(){throw new i},e}(bt),kt=0;(h.prototype=new Ot).get=function(t){for(var e=this.root_;null!==e;){var n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(n>0))return e.value;e=e.right}}return null},h.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:kt,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n,r,i=this.root_;do{if(n=i,(r=t.compareTo(i.key))<0)i=i.left;else{if(!(r>0)){var o=i.value;return i.value=e,o}i=i.right}}while(null!==i);var s={key:t,left:null,right:null,value:e,parent:n,color:kt,getValue:function(){return this.value},getKey:function(){return this.key}};return r<0?n.left=s:n.right=s,this.fixAfterInsertion(s),this.size_++,null},h.prototype.fixAfterInsertion=function(t){for(t.color=1;null!=t&&t!==this.root_&&1===t.parent.color;)if(a(t)===u(a(a(t)))){var e=c(a(a(t)));1===s(e)?(l(a(t),kt),l(e,kt),l(a(a(t)),1),t=a(a(t))):(t===c(a(t))&&(t=a(t),this.rotateLeft(t)),l(a(t),kt),l(a(a(t)),1),this.rotateRight(a(a(t))))}else{var n=u(a(a(t)));1===s(n)?(l(a(t),kt),l(n,kt),l(a(a(t)),1),t=a(a(t))):(t===u(a(t))&&(t=a(t),this.rotateRight(t)),l(a(t),kt),l(a(a(t)),1),this.rotateLeft(a(a(t))))}this.root_.color=kt},h.prototype.values=function(){var t=new wt,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=h.successor(e));)t.add(e.value);return t},h.prototype.entrySet=function(){var t=new Rt,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=h.successor(e));)t.add(e);return t},h.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}},h.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}},h.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},h.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}for(var n=t.parent,r=t;null!==n&&r===n.right;)r=n,n=n.parent;return n},h.prototype.size=function(){return this.size_};var Dt=function(){};Dt.prototype.interfaces_=function(){return[]},Dt.prototype.getClass=function(){return Dt},p.prototype=new o,(f.prototype=new p).contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(0===this.array_[e].compareTo(t))return!0;return!1},f.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,n=this.array_.length;e<n;e++)if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0;return this.array_.push(t),!0},f.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},f.prototype.remove=function(t){throw new i},f.prototype.size=function(){return this.array_.length},f.prototype.isEmpty=function(){return 0===this.array_.length},f.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},f.prototype.iterator=function(){return new Nt(this)};var Nt=function(t){this.treeSet_=t,this.position_=0};Nt.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new r;return this.treeSet_.array_[this.position_++]},Nt.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},Nt.prototype.remove=function(){throw new i};var Ft=function(){};Ft.sort=function(){var t,e,n,r,i=arguments[0];if(1===arguments.length)r=function(t,e){return t.compareTo(e)},i.sort(r);else if(2===arguments.length)n=arguments[1],r=function(t,e){return n.compare(t,e)},i.sort(r);else if(3===arguments.length){(e=i.slice(arguments[1],arguments[2])).sort();var o=i.slice(0,arguments[1]).concat(e,i.slice(arguments[2],i.length));for(i.splice(0,i.length),t=0;t<o.length;t++)i.push(o[t])}else if(4===arguments.length)for(e=i.slice(arguments[1],arguments[2]),n=arguments[3],r=function(t,e){return n.compare(t,e)},e.sort(r),o=i.slice(0,arguments[1]).concat(e,i.slice(arguments[2],i.length)),i.splice(0,i.length),t=0;t<o.length;t++)i.push(o[t])},Ft.asList=function(t){for(var e=new wt,n=0,r=t.length;n<r;n++)e.add(t[n]);return e};var Bt=function(){},zt={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};zt.P.get=function(){return 0},zt.L.get=function(){return 1},zt.A.get=function(){return 2},zt.FALSE.get=function(){return-1},zt.TRUE.get=function(){return-2},zt.DONTCARE.get=function(){return-3},zt.SYM_FALSE.get=function(){return"F"},zt.SYM_TRUE.get=function(){return"T"},zt.SYM_DONTCARE.get=function(){return"*"},zt.SYM_P.get=function(){return"0"},zt.SYM_L.get=function(){return"1"},zt.SYM_A.get=function(){return"2"},Bt.prototype.interfaces_=function(){return[]},Bt.prototype.getClass=function(){return Bt},Bt.toDimensionSymbol=function(t){switch(t){case Bt.FALSE:return Bt.SYM_FALSE;case Bt.TRUE:return Bt.SYM_TRUE;case Bt.DONTCARE:return Bt.SYM_DONTCARE;case Bt.P:return Bt.SYM_P;case Bt.L:return Bt.SYM_L;case Bt.A:return Bt.SYM_A}throw new y("Unknown dimension value: "+t)},Bt.toDimensionValue=function(t){switch(D.toUpperCase(t)){case Bt.SYM_FALSE:return Bt.FALSE;case Bt.SYM_TRUE:return Bt.TRUE;case Bt.SYM_DONTCARE:return Bt.DONTCARE;case Bt.SYM_P:return Bt.P;case Bt.SYM_L:return Bt.L;case Bt.SYM_A:return Bt.A}throw new y("Unknown dimension symbol: "+t)},Object.defineProperties(Bt,zt);var jt=function(){};jt.prototype.filter=function(t){},jt.prototype.interfaces_=function(){return[]},jt.prototype.getClass=function(){return jt};var Ut=function(){};Ut.prototype.filter=function(t,e){},Ut.prototype.isDone=function(){},Ut.prototype.isGeometryChanged=function(){},Ut.prototype.interfaces_=function(){return[]},Ut.prototype.getClass=function(){return Ut};var Vt=function(t){function e(e,n){if(t.call(this,n),this._geometries=e||[],t.hasNullElements(this._geometries))throw new y("geometries must not contain null elements")}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){for(var t=new W,e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t},e.prototype.getGeometryN=function(t){return this._geometries[t]},e.prototype.getSortIndex=function(){return t.SORTINDEX_GEOMETRYCOLLECTION},e.prototype.getCoordinates=function(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=0;n<this._geometries.length;n++)for(var r=this._geometries[n].getCoordinates(),i=0;i<r.length;i++)t[++e]=r[i];return t},e.prototype.getArea=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var r=e;if(this._geometries.length!==r._geometries.length)return!1;for(var i=0;i<this._geometries.length;i++)if(!this._geometries[i].equalsExact(r._geometries[i],n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<this._geometries.length;t++)this._geometries[t].normalize();Ft.sort(this._geometries)},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},e.prototype.getBoundaryDimension=function(){for(var t=Bt.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t},e.prototype.getDimension=function(){for(var t=Bt.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t},e.prototype.getLength=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t},e.prototype.getNumGeometries=function(){return this._geometries.length},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createGeometryCollection(e)},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=new f(Ft.asList(this._geometries)),n=new f(Ft.asList(t._geometries));return this.compare(e,n)}if(2===arguments.length){for(var r=arguments[1],i=arguments[0],o=this.getNumGeometries(),s=i.getNumGeometries(),a=0;a<o&&a<s;){var l=this.getGeometryN(a),u=i.getGeometryN(a),c=l.compareToSameClass(u,r);if(0!==c)return c;a++}return a<o?1:a<s?-1:0}},e.prototype.apply=function(){if(I(arguments[0],ft))for(var t=arguments[0],e=0;e<this._geometries.length;e++)this._geometries[e].apply(t);else if(I(arguments[0],Ut)){var n=arguments[0];if(0===this._geometries.length)return null;for(var r=0;r<this._geometries.length&&(this._geometries[r].apply(n),!n.isDone());r++);n.isGeometryChanged()&&this.geometryChanged()}else if(I(arguments[0],jt)){var i=arguments[0];i.filter(this);for(var o=0;o<this._geometries.length;o++)this._geometries[o].apply(i)}else if(I(arguments[0],ut)){var s=arguments[0];s.filter(this);for(var a=0;a<this._geometries.length;a++)this._geometries[a].apply(s)}},e.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),et.shouldNeverReachHere(),null},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._geometries=new Array(this._geometries.length).fill(null);for(var n=0;n<this._geometries.length;n++)e._geometries[n]=this._geometries[n].clone();return e},e.prototype.getGeometryType=function(){return"GeometryCollection"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.isEmpty=function(){for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(e,n),e}(ct),Gt=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ct.SORTINDEX_MULTILINESTRING},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?Bt.FALSE:0},e.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0},e.prototype.getDimension=function(){return 1},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[t-1-n]=this._geometries[n].reverse();return this.getFactory().createMultiLineString(e)},e.prototype.getBoundary=function(){return new Zt(this).getBoundary()},e.prototype.getGeometryType=function(){return"MultiLineString"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Dt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(e,n),e}(Vt),Zt=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var t=arguments[0],e=dt.MOD2_BOUNDARY_RULE;this._geom=t,this._geomFact=t.getFactory(),this._bnRule=e}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this._geom=n,this._geomFact=n.getFactory(),this._bnRule=r}};Zt.prototype.boundaryMultiLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this._geomFact.createPoint(e[0]):this._geomFact.createMultiPointFromCoords(e)},Zt.prototype.getBoundary=function(){return this._geom instanceof $t?this.boundaryLineString(this._geom):this._geom instanceof Gt?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},Zt.prototype.boundaryLineString=function(t){return this._geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this._bnRule.isInBoundary(2)?t.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])},Zt.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},Zt.prototype.computeBoundaryCoordinates=function(t){var e=new wt;this._endpointMap=new h;for(var n=0;n<t.getNumGeometries();n++){var r=t.getGeometryN(n);0!==r.getNumPoints()&&(this.addEndpoint(r.getCoordinateN(0)),this.addEndpoint(r.getCoordinateN(r.getNumPoints()-1)))}for(var i=this._endpointMap.entrySet().iterator();i.hasNext();){var o=i.next(),s=o.getValue().count;this._bnRule.isInBoundary(s)&&e.add(o.getKey())}return Tt.toCoordinateArray(e)},Zt.prototype.addEndpoint=function(t){var e=this._endpointMap.get(t);null===e&&(e=new qt,this._endpointMap.put(t,e)),e.count++},Zt.prototype.interfaces_=function(){return[]},Zt.prototype.getClass=function(){return Zt},Zt.getBoundary=function(){return 1===arguments.length?new Zt(arguments[0]).getBoundary():2===arguments.length?new Zt(arguments[0],arguments[1]).getBoundary():void 0};var qt=function(){this.count=null};qt.prototype.interfaces_=function(){return[]},qt.prototype.getClass=function(){return qt};var Wt=function(){},Ht={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};Wt.prototype.interfaces_=function(){return[]},Wt.prototype.getClass=function(){return Wt},Wt.chars=function(t,e){for(var n=new Array(e).fill(null),r=0;r<e;r++)n[r]=t;return String(n)},Wt.getStackTrace=function(){if(1===arguments.length){var t=arguments[0],e=new function(){},n=new function(){}(e);return t.printStackTrace(n),e.toString()}if(2===arguments.length){for(var r=arguments[0],i=arguments[1],o="",s=new function(){}(new function(){}(Wt.getStackTrace(r))),a=0;a<i;a++)try{o+=s.readLine()+Wt.NEWLINE}catch(t){if(!(t instanceof d))throw t;et.shouldNeverReachHere()}return o}},Wt.split=function(t,e){for(var n=e.length,r=new wt,i=""+t,o=i.indexOf(e);o>=0;){var s=i.substring(0,o);r.add(s),o=(i=i.substring(o+n)).indexOf(e)}i.length>0&&r.add(i);for(var a=new Array(r.size()).fill(null),l=0;l<a.length;l++)a[l]=r.get(l);return a},Wt.toString=function(){if(1===arguments.length){var t=arguments[0];return Wt.SIMPLE_ORDINATE_FORMAT.format(t)}},Wt.spaces=function(t){return Wt.chars(" ",t)},Ht.NEWLINE.get=function(){return Z.getProperty("line.separator")},Ht.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}("0.#")},Object.defineProperties(Wt,Ht);var Xt=function(){};Xt.prototype.interfaces_=function(){return[]},Xt.prototype.getClass=function(){return Xt},Xt.copyCoord=function(t,e,n,r){for(var i=Math.min(t.getDimension(),n.getDimension()),o=0;o<i;o++)n.setOrdinate(r,o,t.getOrdinate(e,o))},Xt.isRing=function(t){var e=t.size();return 0===e||!(e<=3)&&t.getOrdinate(0,j.X)===t.getOrdinate(e-1,j.X)&&t.getOrdinate(0,j.Y)===t.getOrdinate(e-1,j.Y)},Xt.isEqual=function(t,e){var n=t.size();if(n!==e.size())return!1;for(var r=Math.min(t.getDimension(),e.getDimension()),i=0;i<n;i++)for(var o=0;o<r;o++){var s=t.getOrdinate(i,o),a=e.getOrdinate(i,o);if(!(t.getOrdinate(i,o)===e.getOrdinate(i,o)||_.isNaN(s)&&_.isNaN(a)))return!1}return!0},Xt.extend=function(t,e,n){var r=t.create(n,e.getDimension()),i=e.size();if(Xt.copy(e,0,r,0,i),i>0)for(var o=i;o<n;o++)Xt.copy(e,i-1,r,o,1);return r},Xt.reverse=function(t){for(var e=t.size()-1,n=Math.trunc(e/2),r=0;r<=n;r++)Xt.swap(t,r,e-r)},Xt.swap=function(t,e,n){if(e===n)return null;for(var r=0;r<t.getDimension();r++){var i=t.getOrdinate(e,r);t.setOrdinate(e,r,t.getOrdinate(n,r)),t.setOrdinate(n,r,i)}},Xt.copy=function(t,e,n,r,i){for(var o=0;o<i;o++)Xt.copyCoord(t,e+o,n,r+o)},Xt.toString=function(){if(1===arguments.length){var t=arguments[0],e=t.size();if(0===e)return"()";var n=t.getDimension(),r=new L;r.append("(");for(var i=0;i<e;i++){i>0&&r.append(" ");for(var o=0;o<n;o++)o>0&&r.append(","),r.append(Wt.toString(t.getOrdinate(i,o)))}return r.append(")"),r.toString()}},Xt.ensureValidRing=function(t,e){var n=e.size();return 0===n?e:n<=3?Xt.createClosedRing(t,e,4):e.getOrdinate(0,j.X)===e.getOrdinate(n-1,j.X)&&e.getOrdinate(0,j.Y)===e.getOrdinate(n-1,j.Y)?e:Xt.createClosedRing(t,e,n+1)},Xt.createClosedRing=function(t,e,n){var r=t.create(n,e.getDimension()),i=e.size();Xt.copy(e,0,r,0,i);for(var o=i;o<n;o++)Xt.copy(e,0,r,o,1);return r};var $t=function(t){function e(e,n){t.call(this,n),this._points=null,this.init(e)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new W:this._points.expandEnvelope(new W)},e.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},e.prototype.getSortIndex=function(){return t.SORTINDEX_LINESTRING},e.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var r=e;if(this._points.size()!==r._points.size())return!1;for(var i=0;i<this._points.size();i++)if(!this.equal(this._points.getCoordinate(i),r._points.getCoordinate(i),n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<Math.trunc(this._points.size()/2);t++){var e=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(e)))return this._points.getCoordinate(t).compareTo(this._points.getCoordinate(e))>0&&Xt.reverse(this._points),null}},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?Bt.FALSE:0},e.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},e.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},e.prototype.getDimension=function(){return 1},e.prototype.getLength=function(){return at.computeLength(this._points)},e.prototype.getNumPoints=function(){return this._points.size()},e.prototype.reverse=function(){var t=this._points.copy();return Xt.reverse(t),this.getFactory().createLineString(t)},e.prototype.compareToSameClass=function(){if(1===arguments.length){for(var t=arguments[0],e=0,n=0;e<this._points.size()&&n<t._points.size();){var r=this._points.getCoordinate(e).compareTo(t._points.getCoordinate(n));if(0!==r)return r;e++,n++}return e<this._points.size()?1:n<t._points.size()?-1:0}if(2===arguments.length){var i=arguments[0];return arguments[1].compare(this._points,i._points)}},e.prototype.apply=function(){if(I(arguments[0],ft))for(var t=arguments[0],e=0;e<this._points.size();e++)t.filter(this._points.getCoordinate(e));else if(I(arguments[0],Ut)){var n=arguments[0];if(0===this._points.size())return null;for(var r=0;r<this._points.size()&&(n.filter(this._points,r),!n.isDone());r++);n.isGeometryChanged()&&this.geometryChanged()}else(I(arguments[0],jt)||I(arguments[0],ut))&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return new Zt(this).getBoundary()},e.prototype.isEquivalentClass=function(t){return t instanceof e},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._points=this._points.clone(),e},e.prototype.getCoordinateN=function(t){return this._points.getCoordinate(t)},e.prototype.getGeometryType=function(){return"LineString"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._points},e.prototype.isEmpty=function(){return 0===this._points.size()},e.prototype.init=function(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new y("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t},e.prototype.isCoordinate=function(t){for(var e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1},e.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},e.prototype.getPointN=function(t){return this.getFactory().createPoint(this._points.getCoordinate(t))},e.prototype.interfaces_=function(){return[Dt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(e,n),e}(ct),Yt=function(){};Yt.prototype.interfaces_=function(){return[]},Yt.prototype.getClass=function(){return Yt};var Qt=function(t){function e(e,n){t.call(this,n),this._coordinates=e||null,this.init(this._coordinates)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new W;var t=new W;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t},e.prototype.getSortIndex=function(){return t.SORTINDEX_POINT},e.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&(!(!this.isEmpty()||!e.isEmpty())||this.isEmpty()===e.isEmpty()&&this.equal(e.getCoordinate(),this.getCoordinate(),n))}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){},e.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},e.prototype.getBoundaryDimension=function(){return Bt.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getNumPoints=function(){return this.isEmpty()?0:1},e.prototype.reverse=function(){return this.copy()},e.prototype.getX=function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(2===arguments.length){var e=arguments[0];return arguments[1].compare(this._coordinates,e._coordinates)}},e.prototype.apply=function(){if(I(arguments[0],ft)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(I(arguments[0],Ut)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this._coordinates,0),e.isGeometryChanged()&&this.geometryChanged()}else(I(arguments[0],jt)||I(arguments[0],ut))&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._coordinates=this._coordinates.clone(),e},e.prototype.getGeometryType=function(){return"Point"},e.prototype.copy=function(){return new e(this._coordinates.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._coordinates},e.prototype.getY=function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y},e.prototype.isEmpty=function(){return 0===this._coordinates.size()},e.prototype.init=function(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),et.isTrue(t.size()<=1),this._coordinates=t},e.prototype.isSimple=function(){return!0},e.prototype.interfaces_=function(){return[Yt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(e,n),e}(ct),Kt=function(){};Kt.prototype.interfaces_=function(){return[]},Kt.prototype.getClass=function(){return Kt};var Jt=function(t){function e(e,n,r){if(t.call(this,r),this._shell=null,this._holes=null,null===e&&(e=this.getFactory().createLinearRing()),null===n&&(n=[]),t.hasNullElements(n))throw new y("holes must not contain null elements");if(e.isEmpty()&&t.hasNonEmptyElements(n))throw new y("shell is empty but holes are not");this._shell=e,this._holes=n}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},e.prototype.getSortIndex=function(){return t.SORTINDEX_POLYGON},e.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=this._shell.getCoordinates(),r=0;r<n.length;r++)t[++e]=n[r];for(var i=0;i<this._holes.length;i++)for(var o=this._holes[i].getCoordinates(),s=0;s<o.length;s++)t[++e]=o[s];return t},e.prototype.getArea=function(){var t=0;t+=Math.abs(at.signedArea(this._shell.getCoordinateSequence()));for(var e=0;e<this._holes.length;e++)t-=Math.abs(at.signedArea(this._holes[e].getCoordinateSequence()));return t},e.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;for(var t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),n=0;n<5;n++){var r=t.getX(n);if(r!==e.getMinX()&&r!==e.getMaxX())return!1;var i=t.getY(n);if(i!==e.getMinY()&&i!==e.getMaxY())return!1}for(var o=t.getX(0),s=t.getY(0),a=1;a<=4;a++){var l=t.getX(a),u=t.getY(a);if(l!==o==(u!==s))return!1;o=l,s=u}return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var r=e,i=this._shell,o=r._shell;if(!i.equalsExact(o,n))return!1;if(this._holes.length!==r._holes.length)return!1;for(var s=0;s<this._holes.length;s++)if(!this._holes[s].equalsExact(r._holes[s],n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){if(0===arguments.length){this.normalize(this._shell,!0);for(var t=0;t<this._holes.length;t++)this.normalize(this._holes[t],!1);Ft.sort(this._holes)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(e.isEmpty())return null;var r=new Array(e.getCoordinates().length-1).fill(null);Z.arraycopy(e.getCoordinates(),0,r,0,r.length);var i=Tt.minCoordinate(e.getCoordinates());Tt.scroll(r,i),Z.arraycopy(r,0,e.getCoordinates(),0,r.length),e.getCoordinates()[r.length]=r[0],at.isCCW(e.getCoordinates())===n&&Tt.reverse(e.getCoordinates())}},e.prototype.getCoordinate=function(){return this._shell.getCoordinate()},e.prototype.getNumInteriorRing=function(){return this._holes.length},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.getLength=function(){var t=0;t+=this._shell.getLength();for(var e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=this._shell.getNumPoints(),e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t},e.prototype.reverse=function(){var t=this.copy();t._shell=this._shell.copy().reverse(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].copy().reverse();return t},e.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=this._shell,n=t._shell;return e.compareToSameClass(n)}if(2===arguments.length){var r=arguments[1],i=arguments[0],o=this._shell,s=i._shell,a=o.compareToSameClass(s,r);if(0!==a)return a;for(var l=this.getNumInteriorRing(),u=i.getNumInteriorRing(),c=0;c<l&&c<u;){var h=this.getInteriorRingN(c),p=i.getInteriorRingN(c),f=h.compareToSameClass(p,r);if(0!==f)return f;c++}return c<l?1:c<u?-1:0}},e.prototype.apply=function(t){if(I(t,ft)){this._shell.apply(t);for(var e=0;e<this._holes.length;e++)this._holes[e].apply(t)}else if(I(t,Ut)){if(this._shell.apply(t),!t.isDone())for(var n=0;n<this._holes.length&&(this._holes[n].apply(t),!t.isDone());n++);t.isGeometryChanged()&&this.geometryChanged()}else if(I(t,jt))t.filter(this);else if(I(t,ut)){t.filter(this),this._shell.apply(t);for(var r=0;r<this._holes.length;r++)this._holes[r].apply(t)}},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(var e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._shell=this._shell.clone(),e._holes=new Array(this._holes.length).fill(null);for(var n=0;n<this._holes.length;n++)e._holes[n]=this._holes[n].clone();return e},e.prototype.getGeometryType=function(){return"Polygon"},e.prototype.copy=function(){for(var t=this._shell.copy(),n=new Array(this._holes.length).fill(null),r=0;r<n.length;r++)n[r]=this._holes[r].copy();return new e(t,n,this._factory)},e.prototype.getExteriorRing=function(){return this._shell},e.prototype.isEmpty=function(){return this._shell.isEmpty()},e.prototype.getInteriorRingN=function(t){return this._holes[t]},e.prototype.interfaces_=function(){return[Kt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(e,n),e}(ct),te=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ct.SORTINDEX_MULTIPOINT},e.prototype.isValid=function(){return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getCoordinate=function(){if(1===arguments.length){var e=arguments[0];return this._geometries[e].getCoordinate()}return t.prototype.getCoordinate.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return Bt.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.getGeometryType=function(){return"MultiPoint"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Yt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},Object.defineProperties(e,n),e}(Vt),ee=function(t){function e(e,n){e instanceof E&&n instanceof Ae&&(e=n.getCoordinateSequenceFactory().create(e)),t.call(this,e,n),this.validateConstruction()}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ct.SORTINDEX_LINEARRING},e.prototype.getBoundaryDimension=function(){return Bt.FALSE},e.prototype.isClosed=function(){return!!this.isEmpty()||t.prototype.isClosed.call(this)},e.prototype.reverse=function(){var t=this._points.copy();return Xt.reverse(t),this.getFactory().createLinearRing(t)},e.prototype.validateConstruction=function(){if(!this.isEmpty()&&!t.prototype.isClosed.call(this))throw new y("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<e.MINIMUM_VALID_SIZE)throw new y("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},e.prototype.getGeometryType=function(){return"LinearRing"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.MINIMUM_VALID_SIZE.get=function(){return 4},n.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(e,n),e}($t),ne=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ct.SORTINDEX_MULTIPOLYGON},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createMultiPolygon(e)},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new wt,e=0;e<this._geometries.length;e++)for(var n=this._geometries[e].getBoundary(),r=0;r<n.getNumGeometries();r++)t.add(n.getGeometryN(r));var i=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(i))},e.prototype.getGeometryType=function(){return"MultiPolygon"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Kt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(e,n),e}(Vt),re=function(t){this._factory=t||null,this._isUserDataCopied=!1},ie={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};re.prototype.setCopyUserData=function(t){this._isUserDataCopied=t},re.prototype.edit=function(t,e){if(null===t)return null;var n=this.editInternal(t,e);return this._isUserDataCopied&&n.setUserData(t.getUserData()),n},re.prototype.editInternal=function(t,e){return null===this._factory&&(this._factory=t.getFactory()),t instanceof Vt?this.editGeometryCollection(t,e):t instanceof Jt?this.editPolygon(t,e):t instanceof Qt||t instanceof $t?e.edit(t,this._factory):(et.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)},re.prototype.editGeometryCollection=function(t,e){for(var n=e.edit(t,this._factory),r=new wt,i=0;i<n.getNumGeometries();i++){var o=this.edit(n.getGeometryN(i),e);null===o||o.isEmpty()||r.add(o)}return n.getClass()===te?this._factory.createMultiPoint(r.toArray([])):n.getClass()===Gt?this._factory.createMultiLineString(r.toArray([])):n.getClass()===ne?this._factory.createMultiPolygon(r.toArray([])):this._factory.createGeometryCollection(r.toArray([]))},re.prototype.editPolygon=function(t,e){var n=e.edit(t,this._factory);if(null===n&&(n=this._factory.createPolygon(null)),n.isEmpty())return n;var r=this.edit(n.getExteriorRing(),e);if(null===r||r.isEmpty())return this._factory.createPolygon();for(var i=new wt,o=0;o<n.getNumInteriorRing();o++){var s=this.edit(n.getInteriorRingN(o),e);null===s||s.isEmpty()||i.add(s)}return this._factory.createPolygon(r,i.toArray([]))},re.prototype.interfaces_=function(){return[]},re.prototype.getClass=function(){return re},re.GeometryEditorOperation=function(){},ie.NoOpGeometryOperation.get=function(){return oe},ie.CoordinateOperation.get=function(){return se},ie.CoordinateSequenceOperation.get=function(){return ae},Object.defineProperties(re,ie);var oe=function(){};oe.prototype.edit=function(t,e){return t},oe.prototype.interfaces_=function(){return[re.GeometryEditorOperation]},oe.prototype.getClass=function(){return oe};var se=function(){};se.prototype.edit=function(t,e){var n=this.editCoordinates(t.getCoordinates(),t);return null===n?t:t instanceof ee?e.createLinearRing(n):t instanceof $t?e.createLineString(n):t instanceof Qt?n.length>0?e.createPoint(n[0]):e.createPoint():t},se.prototype.interfaces_=function(){return[re.GeometryEditorOperation]},se.prototype.getClass=function(){return se};var ae=function(){};ae.prototype.edit=function(t,e){return t instanceof ee?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof $t?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof Qt?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t},ae.prototype.interfaces_=function(){return[re.GeometryEditorOperation]},ae.prototype.getClass=function(){return ae};var le=function(){if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var t=arguments[0];this._coordinates=new Array(t).fill(null);for(var e=0;e<t;e++)this._coordinates[e]=new E}else if(I(arguments[0],j)){var n=arguments[0];if(null===n)return this._coordinates=new Array(0).fill(null),null;this._dimension=n.getDimension(),this._coordinates=new Array(n.size()).fill(null);for(var r=0;r<this._coordinates.length;r++)this._coordinates[r]=n.getCoordinateCopy(r)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var i=arguments[0],o=arguments[1];this._coordinates=i,this._dimension=o,null===i&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var s=arguments[0],a=arguments[1];this._coordinates=new Array(s).fill(null),this._dimension=a;for(var l=0;l<s;l++)this._coordinates[l]=new E}},ue={serialVersionUID:{configurable:!0}};le.prototype.setOrdinate=function(t,e,n){switch(e){case j.X:this._coordinates[t].x=n;break;case j.Y:this._coordinates[t].y=n;break;case j.Z:this._coordinates[t].z=n;break;default:throw new y("invalid ordinateIndex")}},le.prototype.size=function(){return this._coordinates.length},le.prototype.getOrdinate=function(t,e){switch(e){case j.X:return this._coordinates[t].x;case j.Y:return this._coordinates[t].y;case j.Z:return this._coordinates[t].z}return _.NaN},le.prototype.getCoordinate=function(){if(1===arguments.length){var t=arguments[0];return this._coordinates[t]}if(2===arguments.length){var e=arguments[0],n=arguments[1];n.x=this._coordinates[e].x,n.y=this._coordinates[e].y,n.z=this._coordinates[e].z}},le.prototype.getCoordinateCopy=function(t){return new E(this._coordinates[t])},le.prototype.getDimension=function(){return this._dimension},le.prototype.getX=function(t){return this._coordinates[t].x},le.prototype.clone=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].clone();return new le(t,this._dimension)},le.prototype.expandEnvelope=function(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t},le.prototype.copy=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].copy();return new le(t,this._dimension)},le.prototype.toString=function(){if(this._coordinates.length>0){var t=new L(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"},le.prototype.getY=function(t){return this._coordinates[t].y},le.prototype.toCoordinateArray=function(){return this._coordinates},le.prototype.interfaces_=function(){return[j,e]},le.prototype.getClass=function(){return le},ue.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(le,ue);var ce=function(){},he={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};ce.prototype.readResolve=function(){return ce.instance()},ce.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array)return new le(arguments[0]);if(I(arguments[0],j))return new le(arguments[0])}else if(2===arguments.length){var t=arguments[0],e=arguments[1];return e>3&&(e=3),e<2?new le(t):new le(t,e)}},ce.prototype.interfaces_=function(){return[P,e]},ce.prototype.getClass=function(){return ce},ce.instance=function(){return ce.instanceObject},he.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},he.instanceObject.get=function(){return new ce},Object.defineProperties(ce,he);var pe=function(t){function e(){t.call(this),this.map_=new Map}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return this.map_.get(t)||null},e.prototype.put=function(t,e){return this.map_.set(t,e),e},e.prototype.values=function(){for(var t=new wt,e=this.map_.values(),n=e.next();!n.done;)t.add(n.value),n=e.next();return t},e.prototype.entrySet=function(){var t=new Rt;return this.map_.entries().forEach((function(e){return t.add(e)})),t},e.prototype.size=function(){return this.map_.size()},e}(It),fe=function t(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=t.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof ge){var e=arguments[0];this._modelType=e,e===t.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var n=arguments[0];this._modelType=t.FIXED,this.setScale(n)}else if(arguments[0]instanceof t){var r=arguments[0];this._modelType=r._modelType,this._scale=r._scale}},de={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};fe.prototype.equals=function(t){if(!(t instanceof fe))return!1;var e=t;return this._modelType===e._modelType&&this._scale===e._scale},fe.prototype.compareTo=function(t){var e=t,n=this.getMaximumSignificantDigits(),r=e.getMaximumSignificantDigits();return new k(n).compareTo(new k(r))},fe.prototype.getScale=function(){return this._scale},fe.prototype.isFloating=function(){return this._modelType===fe.FLOATING||this._modelType===fe.FLOATING_SINGLE},fe.prototype.getType=function(){return this._modelType},fe.prototype.toString=function(){var t="UNKNOWN";return this._modelType===fe.FLOATING?t="Floating":this._modelType===fe.FLOATING_SINGLE?t="Floating-Single":this._modelType===fe.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t},fe.prototype.makePrecise=function(){if("number"==typeof arguments[0]){var t=arguments[0];return _.isNaN(t)||this._modelType===fe.FLOATING_SINGLE?t:this._modelType===fe.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof E){var e=arguments[0];if(this._modelType===fe.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}},fe.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===fe.FLOATING?t=16:this._modelType===fe.FLOATING_SINGLE?t=6:this._modelType===fe.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t},fe.prototype.setScale=function(t){this._scale=Math.abs(t)},fe.prototype.interfaces_=function(){return[e,b]},fe.prototype.getClass=function(){return fe},fe.mostPrecise=function(t,e){return t.compareTo(e)>=0?t:e},de.serialVersionUID.get=function(){return 0x6bee6404e9a25c00},de.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(fe,de);var ge=function t(e){this._name=e||null,t.nameToTypeMap.put(e,this)},me={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};ge.prototype.readResolve=function(){return ge.nameToTypeMap.get(this._name)},ge.prototype.toString=function(){return this._name},ge.prototype.interfaces_=function(){return[e]},ge.prototype.getClass=function(){return ge},me.serialVersionUID.get=function(){return-552860263173159e4},me.nameToTypeMap.get=function(){return new pe},Object.defineProperties(ge,me),fe.Type=ge,fe.FIXED=new ge("FIXED"),fe.FLOATING=new ge("FLOATING"),fe.FLOATING_SINGLE=new ge("FLOATING SINGLE");var Ae=function t(){this._precisionModel=new fe,this._SRID=0,this._coordinateSequenceFactory=t.getDefaultCoordinateSequenceFactory(),0===arguments.length||(1===arguments.length?I(arguments[0],P)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof fe&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},ye={serialVersionUID:{configurable:!0}};Ae.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new E(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new E(t.getMinX(),t.getMinY()),new E(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new E(t.getMinX(),t.getMinY()),new E(t.getMinX(),t.getMaxY()),new E(t.getMaxX(),t.getMaxY()),new E(t.getMaxX(),t.getMinY()),new E(t.getMinX(),t.getMinY())]),null)},Ae.prototype.createLineString=function(t){return t?t instanceof Array?new $t(this.getCoordinateSequenceFactory().create(t),this):I(t,j)?new $t(t,this):void 0:new $t(this.getCoordinateSequenceFactory().create([]),this)},Ae.prototype.createMultiLineString=function(){return 0===arguments.length?new Gt(null,this):1===arguments.length?new Gt(arguments[0],this):void 0},Ae.prototype.buildGeometry=function(t){for(var e=null,n=!1,r=!1,i=t.iterator();i.hasNext();){var o=i.next(),s=o.getClass();null===e&&(e=s),s!==e&&(n=!0),o.isGeometryCollectionOrDerived()&&(r=!0)}if(null===e)return this.createGeometryCollection();if(n||r)return this.createGeometryCollection(Ae.toGeometryArray(t));var a=t.iterator().next();if(t.size()>1){if(a instanceof Jt)return this.createMultiPolygon(Ae.toPolygonArray(t));if(a instanceof $t)return this.createMultiLineString(Ae.toLineStringArray(t));if(a instanceof Qt)return this.createMultiPoint(Ae.toPointArray(t));et.shouldNeverReachHere("Unhandled class: "+a.getClass().getName())}return a},Ae.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)},Ae.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof E){var t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(I(arguments[0],j))return new Qt(arguments[0],this)}},Ae.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},Ae.prototype.createPolygon=function(){if(0===arguments.length)return new Jt(null,null,this);if(1===arguments.length){if(I(arguments[0],j)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof ee){var n=arguments[0];return this.createPolygon(n,null)}}else if(2===arguments.length)return new Jt(arguments[0],arguments[1],this)},Ae.prototype.getSRID=function(){return this._SRID},Ae.prototype.createGeometryCollection=function(){return 0===arguments.length?new Vt(null,this):1===arguments.length?new Vt(arguments[0],this):void 0},Ae.prototype.createGeometry=function(t){return new re(this).edit(t,{edit:function(){if(2===arguments.length){var t=arguments[0];return this._coordinateSequenceFactory.create(t)}}})},Ae.prototype.getPrecisionModel=function(){return this._precisionModel},Ae.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(I(arguments[0],j))return new ee(arguments[0],this)}},Ae.prototype.createMultiPolygon=function(){return 0===arguments.length?new ne(null,this):1===arguments.length?new ne(arguments[0],this):void 0},Ae.prototype.createMultiPoint=function(){if(0===arguments.length)return new te(null,this);if(1===arguments.length){if(arguments[0]instanceof Array)return new te(arguments[0],this);if(arguments[0]instanceof Array){var t=arguments[0];return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(I(arguments[0],j)){var e=arguments[0];if(null===e)return this.createMultiPoint(new Array(0).fill(null));for(var n=new Array(e.size()).fill(null),r=0;r<e.size();r++){var i=this.getCoordinateSequenceFactory().create(1,e.getDimension());Xt.copy(e,r,i,0,1),n[r]=this.createPoint(i)}return this.createMultiPoint(n)}}},Ae.prototype.interfaces_=function(){return[e]},Ae.prototype.getClass=function(){return Ae},Ae.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Ae.toGeometryArray=function(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)},Ae.getDefaultCoordinateSequenceFactory=function(){return ce.instance()},Ae.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Ae.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Ae.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Ae.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Ae.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Ae.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Ae.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},ye.serialVersionUID.get=function(){return-0x5ea75f2051eeb400},Object.defineProperties(Ae,ye);var _e=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],ve=function(t){this.geometryFactory=t||new Ae};ve.prototype.read=function(t){var e,n=(e="string"==typeof t?JSON.parse(t):t).type;if(!be[n])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==_e.indexOf(n)?be[n].apply(this,[e.coordinates]):"GeometryCollection"===n?be[n].apply(this,[e.geometries]):be[n].apply(this,[e])},ve.prototype.write=function(t){var e=t.getGeometryType();if(!xe[e])throw new Error("Geometry is not supported");return xe[e].apply(this,[t])};var be={Feature:function(t){var e={};for(var n in t)e[n]=t[n];if(t.geometry){var r=t.geometry.type;if(!be[r])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=be.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},coordinates:function(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];e.push(new E(r[0],r[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new E(t[0],t[1]),new E(t[2],t[1]),new E(t[2],t[3]),new E(t[0],t[3]),new E(t[0],t[1])])},Point:function(t){var e=new E(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],n=0;n<t.length;++n)e.push(be.Point.apply(this,[t[n]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=be.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],n=0;n<t.length;++n)e.push(be.LineString.apply(this,[t[n]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=be.coordinates.apply(this,[t[0]]),n=this.geometryFactory.createLinearRing(e),r=[],i=1;i<t.length;++i){var o=t[i],s=be.coordinates.apply(this,[o]),a=this.geometryFactory.createLinearRing(s);r.push(a)}return this.geometryFactory.createPolygon(n,r)},MultiPolygon:function(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];e.push(be.Polygon.apply(this,[r]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];e.push(this.read(r))}return this.geometryFactory.createGeometryCollection(e)}},xe={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:xe.coordinate.apply(this,[t.getCoordinate()])}},MultiPoint:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var r=t._geometries[n],i=xe.Point.apply(this,[r]);e.push(i.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],n=t.getCoordinates(),r=0;r<n.length;++r){var i=n[r];e.push(xe.coordinate.apply(this,[i]))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var r=t._geometries[n],i=xe.LineString.apply(this,[r]);e.push(i.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],n=xe.LineString.apply(this,[t._shell]);e.push(n.coordinates);for(var r=0;r<t._holes.length;++r){var i=t._holes[r],o=xe.LineString.apply(this,[i]);e.push(o.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var r=t._geometries[n],i=xe.Polygon.apply(this,[r]);e.push(i.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var r=t._geometries[n],i=r.getGeometryType();e.push(xe[i].apply(this,[r]))}return{type:"GeometryCollection",geometries:e}}},we=function(t){this.geometryFactory=t||new Ae,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new ve(this.geometryFactory)};we.prototype.read=function(t){var e=this.parser.read(t);return this.precisionModel.getType()===fe.FIXED&&this.reducePrecision(e),e},we.prototype.reducePrecision=function(t){var e,n;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,n=t.points.length;e<n;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,n=t.geometries.length;e<n;e++)this.reducePrecision(t.geometries[e])};var Ee=function(){this.parser=new ve(this.geometryFactory)};Ee.prototype.write=function(t){return this.parser.write(t)};var Se=function(){},Te={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};Se.prototype.interfaces_=function(){return[]},Se.prototype.getClass=function(){return Se},Se.opposite=function(t){return t===Se.LEFT?Se.RIGHT:t===Se.RIGHT?Se.LEFT:t},Te.ON.get=function(){return 0},Te.LEFT.get=function(){return 1},Te.RIGHT.get=function(){return 2},Object.defineProperties(Se,Te),(g.prototype=new Error).name="EmptyStackException",(m.prototype=new xt).add=function(t){return this.array_.push(t),!0},m.prototype.get=function(t){if(t<0||t>=this.size())throw new Error;return this.array_[t]},m.prototype.push=function(t){return this.array_.push(t),t},m.prototype.pop=function(t){if(0===this.array_.length)throw new g;return this.array_.pop()},m.prototype.peek=function(){if(0===this.array_.length)throw new g;return this.array_[this.array_.length-1]},m.prototype.empty=function(){return 0===this.array_.length},m.prototype.isEmpty=function(){return this.empty()},m.prototype.search=function(t){return this.array_.indexOf(t)},m.prototype.size=function(){return this.array_.length},m.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t};var Pe=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Pe.prototype.getCoordinate=function(){return this._minCoord},Pe.prototype.getRightmostSide=function(t,e){var n=this.getRightmostSideOfSegment(t,e);return n<0&&(n=this.getRightmostSideOfSegment(t,e-1)),n<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),n},Pe.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates();et.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this._minIndex-1],n=t[this._minIndex+1],r=at.computeOrientation(this._minCoord,n,e),i=!1;(e.y<this._minCoord.y&&n.y<this._minCoord.y&&r===at.COUNTERCLOCKWISE||e.y>this._minCoord.y&&n.y>this._minCoord.y&&r===at.CLOCKWISE)&&(i=!0),i&&(this._minIndex=this._minIndex-1)},Pe.prototype.getRightmostSideOfSegment=function(t,e){var n=t.getEdge().getCoordinates();if(e<0||e+1>=n.length)return-1;if(n[e].y===n[e+1].y)return-1;var r=Se.LEFT;return n[e].y<n[e+1].y&&(r=Se.RIGHT),r},Pe.prototype.getEdge=function(){return this._orientedDe},Pe.prototype.checkForRightmostCoordinate=function(t){for(var e=t.getEdge().getCoordinates(),n=0;n<e.length-1;n++)(null===this._minCoord||e[n].x>this._minCoord.x)&&(this._minDe=t,this._minIndex=n,this._minCoord=e[n])},Pe.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},Pe.prototype.findEdge=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();n.isForward()&&this.checkForRightmostCoordinate(n)}et.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===Se.LEFT&&(this._orientedDe=this._minDe.getSym())},Pe.prototype.interfaces_=function(){return[]},Pe.prototype.getClass=function(){return Pe};var Me=function(t){function e(n,r){t.call(this,e.msgWithCoord(n,r)),this.pt=r?new E(r):null,this.name="TopologyException"}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getCoordinate=function(){return this.pt},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.msgWithCoord=function(t,e){return e?t:t+" [ "+e+" ]"},e}(J),Ce=function(){this.array_=[]};Ce.prototype.addLast=function(t){this.array_.push(t)},Ce.prototype.removeFirst=function(){return this.array_.shift()},Ce.prototype.isEmpty=function(){return 0===this.array_.length};var Ie=function(){this._finder=null,this._dirEdgeList=new wt,this._nodes=new wt,this._rightMostCoord=null,this._env=null,this._finder=new Pe};Ie.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();)t.next().setVisited(!1)},Ie.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},Ie.prototype.computeNodeDepth=function(t){for(var e=null,n=t.getEdges().iterator();n.hasNext();){var r=n.next();if(r.isVisited()||r.getSym().isVisited()){e=r;break}}if(null===e)throw new Me("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(var i=t.getEdges().iterator();i.hasNext();){var o=i.next();o.setVisited(!0),this.copySymDepths(o)}},Ie.prototype.computeDepth=function(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.setEdgeDepths(Se.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)},Ie.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},Ie.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(Se.RIGHT)>=1&&e.getDepth(Se.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}},Ie.prototype.computeDepths=function(t){var e=new Rt,n=new Ce,r=t.getNode();for(n.addLast(r),e.add(r),t.setVisited(!0);!n.isEmpty();){var i=n.removeFirst();e.add(i),this.computeNodeDepth(i);for(var o=i.getEdges().iterator();o.hasNext();){var s=o.next().getSym();if(!s.isVisited()){var a=s.getNode();e.contains(a)||(n.addLast(a),e.add(a))}}}},Ie.prototype.compareTo=function(t){var e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0},Ie.prototype.getEnvelope=function(){if(null===this._env){for(var t=new W,e=this._dirEdgeList.iterator();e.hasNext();)for(var n=e.next().getEdge().getCoordinates(),r=0;r<n.length-1;r++)t.expandToInclude(n[r]);this._env=t}return this._env},Ie.prototype.addReachable=function(t){var e=new m;for(e.add(t);!e.empty();){var n=e.pop();this.add(n,e)}},Ie.prototype.copySymDepths=function(t){var e=t.getSym();e.setDepth(Se.LEFT,t.getDepth(Se.RIGHT)),e.setDepth(Se.RIGHT,t.getDepth(Se.LEFT))},Ie.prototype.add=function(t,e){t.setVisited(!0),this._nodes.add(t);for(var n=t.getEdges().iterator();n.hasNext();){var r=n.next();this._dirEdgeList.add(r);var i=r.getSym().getNode();i.isVisited()||e.push(i)}},Ie.prototype.getNodes=function(){return this._nodes},Ie.prototype.getDirectedEdges=function(){return this._dirEdgeList},Ie.prototype.interfaces_=function(){return[b]},Ie.prototype.getClass=function(){return Ie};var Oe=function t(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var e=arguments[0];this.init(e.length)}else if(Number.isInteger(arguments[0])){var n=arguments[0];this.init(1),this.location[Se.ON]=n}else if(arguments[0]instanceof t){var r=arguments[0];if(this.init(r.location.length),null!==r)for(var i=0;i<this.location.length;i++)this.location[i]=r.location[i]}}else if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];this.init(3),this.location[Se.ON]=o,this.location[Se.LEFT]=s,this.location[Se.RIGHT]=a}};Oe.prototype.setAllLocations=function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t},Oe.prototype.isNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==M.NONE)return!1;return!0},Oe.prototype.setAllLocationsIfNull=function(t){for(var e=0;e<this.location.length;e++)this.location[e]===M.NONE&&(this.location[e]=t)},Oe.prototype.isLine=function(){return 1===this.location.length},Oe.prototype.merge=function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[Se.ON]=this.location[Se.ON],e[Se.LEFT]=M.NONE,e[Se.RIGHT]=M.NONE,this.location=e}for(var n=0;n<this.location.length;n++)this.location[n]===M.NONE&&n<t.location.length&&(this.location[n]=t.location[n])},Oe.prototype.getLocations=function(){return this.location},Oe.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[Se.LEFT];this.location[Se.LEFT]=this.location[Se.RIGHT],this.location[Se.RIGHT]=t},Oe.prototype.toString=function(){var t=new L;return this.location.length>1&&t.append(M.toLocationSymbol(this.location[Se.LEFT])),t.append(M.toLocationSymbol(this.location[Se.ON])),this.location.length>1&&t.append(M.toLocationSymbol(this.location[Se.RIGHT])),t.toString()},Oe.prototype.setLocations=function(t,e,n){this.location[Se.ON]=t,this.location[Se.LEFT]=e,this.location[Se.RIGHT]=n},Oe.prototype.get=function(t){return t<this.location.length?this.location[t]:M.NONE},Oe.prototype.isArea=function(){return this.location.length>1},Oe.prototype.isAnyNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===M.NONE)return!0;return!1},Oe.prototype.setLocation=function(){if(1===arguments.length){var t=arguments[0];this.setLocation(Se.ON,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.location[e]=n}},Oe.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(M.NONE)},Oe.prototype.isEqualOnSide=function(t,e){return this.location[e]===t.location[e]},Oe.prototype.allPositionsEqual=function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0},Oe.prototype.interfaces_=function(){return[]},Oe.prototype.getClass=function(){return Oe};var Re=function t(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var e=arguments[0];this.elt[0]=new Oe(e),this.elt[1]=new Oe(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.elt[0]=new Oe(n.elt[0]),this.elt[1]=new Oe(n.elt[1])}}else if(2===arguments.length){var r=arguments[0],i=arguments[1];this.elt[0]=new Oe(M.NONE),this.elt[1]=new Oe(M.NONE),this.elt[r].setLocation(i)}else if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];this.elt[0]=new Oe(o,s,a),this.elt[1]=new Oe(o,s,a)}else if(4===arguments.length){var l=arguments[0],u=arguments[1],c=arguments[2],h=arguments[3];this.elt[0]=new Oe(M.NONE,M.NONE,M.NONE),this.elt[1]=new Oe(M.NONE,M.NONE,M.NONE),this.elt[l].setLocations(u,c,h)}};Re.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},Re.prototype.setAllLocations=function(t,e){this.elt[t].setAllLocations(e)},Re.prototype.isNull=function(t){return this.elt[t].isNull()},Re.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.elt[e].setAllLocationsIfNull(n)}},Re.prototype.isLine=function(t){return this.elt[t].isLine()},Re.prototype.merge=function(t){for(var e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new Oe(t.elt[e]):this.elt[e].merge(t.elt[e])},Re.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},Re.prototype.getLocation=function(){if(1===arguments.length){var t=arguments[0];return this.elt[t].get(Se.ON)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.elt[e].get(n)}},Re.prototype.toString=function(){var t=new L;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()},Re.prototype.isArea=function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var t=arguments[0];return this.elt[t].isArea()}},Re.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()},Re.prototype.setLocation=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(Se.ON,e)}else if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];this.elt[n].setLocation(r,i)}},Re.prototype.isEqualOnSide=function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)},Re.prototype.allPositionsEqual=function(t,e){return this.elt[t].allPositionsEqual(e)},Re.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new Oe(this.elt[t].location[0]))},Re.prototype.interfaces_=function(){return[]},Re.prototype.getClass=function(){return Re},Re.toLineLabel=function(t){for(var e=new Re(M.NONE),n=0;n<2;n++)e.setLocation(n,t.getLocation(n));return e};var Le=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new wt,this._pts=new wt,this._label=new Re(M.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new wt,this._geometryFactory=null;var t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()};Le.prototype.computeRing=function(){if(null!==this._ring)return null;for(var t=new Array(this._pts.size()).fill(null),e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=at.isCCW(this._ring.getCoordinates())},Le.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},Le.prototype.computePoints=function(t){this._startDe=t;var e=t,n=!0;do{if(null===e)throw new Me("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new Me("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);var r=e.getLabel();et.isTrue(r.isArea()),this.mergeLabel(r),this.addPoints(e.getEdge(),e.isForward(),n),n=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this._startDe)},Le.prototype.getLinearRing=function(){return this._ring},Le.prototype.getCoordinate=function(t){return this._pts.get(t)},Le.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var t=this._startDe;do{var e=t.getNode().getEdges().getOutgoingDegree(this);e>this._maxNodeDegree&&(this._maxNodeDegree=e),t=this.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2},Le.prototype.addPoints=function(t,e,n){var r=t.getCoordinates();if(e){var i=1;n&&(i=0);for(var o=i;o<r.length;o++)this._pts.add(r[o])}else{var s=r.length-2;n&&(s=r.length-1);for(var a=s;a>=0;a--)this._pts.add(r[a])}},Le.prototype.isHole=function(){return this._isHole},Le.prototype.setInResult=function(){var t=this._startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!==this._startDe)},Le.prototype.containsPoint=function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!at.isPointInRing(t,e.getCoordinates()))return!1;for(var n=this._holes.iterator();n.hasNext();)if(n.next().containsPoint(t))return!1;return!0},Le.prototype.addHole=function(t){this._holes.add(t)},Le.prototype.isShell=function(){return null===this._shell},Le.prototype.getLabel=function(){return this._label},Le.prototype.getEdges=function(){return this._edges},Le.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},Le.prototype.getShell=function(){return this._shell},Le.prototype.mergeLabel=function(){if(1===arguments.length){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){var e=arguments[1],n=arguments[0].getLocation(e,Se.RIGHT);if(n===M.NONE)return null;if(this._label.getLocation(e)===M.NONE)return this._label.setLocation(e,n),null}},Le.prototype.setShell=function(t){this._shell=t,null!==t&&t.addHole(this)},Le.prototype.toPolygon=function(t){for(var e=new Array(this._holes.size()).fill(null),n=0;n<this._holes.size();n++)e[n]=this._holes.get(n).getLinearRing();return t.createPolygon(this.getLinearRing(),e)},Le.prototype.interfaces_=function(){return[]},Le.prototype.getClass=function(){return Le};var ke=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setEdgeRing=function(t,e){t.setMinEdgeRing(e)},e.prototype.getNext=function(t){return t.getNextMin()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Le),De=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildMinimalRings=function(){var t=new wt,e=this._startDe;do{if(null===e.getMinEdgeRing()){var n=new ke(e,this._geometryFactory);t.add(n)}e=e.getNext()}while(e!==this._startDe);return t},e.prototype.setEdgeRing=function(t,e){t.setEdgeRing(e)},e.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var t=this._startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this._startDe)},e.prototype.getNext=function(t){return t.getNext()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Le),Ne=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._label=t}};Ne.prototype.setVisited=function(t){this._isVisited=t},Ne.prototype.setInResult=function(t){this._isInResult=t},Ne.prototype.isCovered=function(){return this._isCovered},Ne.prototype.isCoveredSet=function(){return this._isCoveredSet},Ne.prototype.setLabel=function(t){this._label=t},Ne.prototype.getLabel=function(){return this._label},Ne.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0},Ne.prototype.updateIM=function(t){et.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)},Ne.prototype.isInResult=function(){return this._isInResult},Ne.prototype.isVisited=function(){return this._isVisited},Ne.prototype.interfaces_=function(){return[]},Ne.prototype.getClass=function(){return Ne};var Fe=function(t){function e(){t.call(this),this._coord=null,this._edges=null;var e=arguments[0],n=arguments[1];this._coord=e,this._edges=n,this._label=new Re(0,M.NONE)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isIncidentEdgeInResult=function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1},e.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},e.prototype.getCoordinate=function(){return this._coord},e.prototype.print=function(t){t.println("node "+this._coord+" lbl: "+this._label)},e.prototype.computeIM=function(t){},e.prototype.computeMergedLocation=function(t,e){var n=M.NONE;if(n=this._label.getLocation(e),!t.isNull(e)){var r=t.getLocation(e);n!==M.BOUNDARY&&(n=r)}return n},e.prototype.setLabel=function(){if(2!==arguments.length)return t.prototype.setLabel.apply(this,arguments);var e=arguments[0],n=arguments[1];null===this._label?this._label=new Re(e,n):this._label.setLocation(e,n)},e.prototype.getEdges=function(){return this._edges},e.prototype.mergeLabel=function(){if(arguments[0]instanceof e){var t=arguments[0];this.mergeLabel(t._label)}else if(arguments[0]instanceof Re)for(var n=arguments[0],r=0;r<2;r++){var i=this.computeMergedLocation(n,r);this._label.getLocation(r)===M.NONE&&this._label.setLocation(r,i)}},e.prototype.add=function(t){this._edges.insert(t),t.setNode(this)},e.prototype.setLabelBoundary=function(t){if(null===this._label)return null;var e=M.NONE;null!==this._label&&(e=this._label.getLocation(t));var n=null;if(e===M.BOUNDARY)n=M.INTERIOR;else n=M.BOUNDARY;this._label.setLocation(t,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ne),Be=function(){this.nodeMap=new h,this.nodeFact=null;var t=arguments[0];this.nodeFact=t};Be.prototype.find=function(t){return this.nodeMap.get(t)},Be.prototype.addNode=function(){if(arguments[0]instanceof E){var t=arguments[0],e=this.nodeMap.get(t);return null===e&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof Fe){var n=arguments[0],r=this.nodeMap.get(n.getCoordinate());return null===r?(this.nodeMap.put(n.getCoordinate(),n),n):(r.mergeLabel(n),r)}},Be.prototype.print=function(t){for(var e=this.iterator();e.hasNext();)e.next().print(t)},Be.prototype.iterator=function(){return this.nodeMap.values().iterator()},Be.prototype.values=function(){return this.nodeMap.values()},Be.prototype.getBoundaryNodes=function(t){for(var e=new wt,n=this.iterator();n.hasNext();){var r=n.next();r.getLabel().getLocation(t)===M.BOUNDARY&&e.add(r)}return e},Be.prototype.add=function(t){var e=t.getCoordinate();this.addNode(e).add(t)},Be.prototype.interfaces_=function(){return[]},Be.prototype.getClass=function(){return Be};var ze=function(){},je={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};ze.prototype.interfaces_=function(){return[]},ze.prototype.getClass=function(){return ze},ze.isNorthern=function(t){return t===ze.NE||t===ze.NW},ze.isOpposite=function(t,e){return t!==e&&2==(t-e+4)%4},ze.commonHalfPlane=function(t,e){if(t===e)return t;if(2==(t-e+4)%4)return-1;var n=t<e?t:e;return 0===n&&3===(t>e?t:e)?3:n},ze.isInHalfPlane=function(t,e){return e===ze.SE?t===ze.SE||t===ze.SW:t===e||t===e+1},ze.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new y("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?ze.NE:ze.SE:e>=0?ze.NW:ze.SW}if(arguments[0]instanceof E&&arguments[1]instanceof E){var n=arguments[0],r=arguments[1];if(r.x===n.x&&r.y===n.y)throw new y("Cannot compute the quadrant for two identical points "+n);return r.x>=n.x?r.y>=n.y?ze.NE:ze.SE:r.y>=n.y?ze.NW:ze.SW}},je.NE.get=function(){return 0},je.NW.get=function(){return 1},je.SW.get=function(){return 2},je.SE.get=function(){return 3},Object.defineProperties(ze,je);var Ue=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){var t=arguments[0];this._edge=t}else if(3===arguments.length){var e=arguments[0],n=arguments[1],r=arguments[2];this._edge=e,this.init(n,r),this._label=null}else if(4===arguments.length){var i=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this._edge=i,this.init(o,s),this._label=a}};Ue.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:at.computeOrientation(t._p0,t._p1,this._p1)},Ue.prototype.getDy=function(){return this._dy},Ue.prototype.getCoordinate=function(){return this._p0},Ue.prototype.setNode=function(t){this._node=t},Ue.prototype.print=function(t){var e=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),r=n.lastIndexOf("."),i=n.substring(r+1);t.print("  "+i+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)},Ue.prototype.compareTo=function(t){var e=t;return this.compareDirection(e)},Ue.prototype.getDirectedCoordinate=function(){return this._p1},Ue.prototype.getDx=function(){return this._dx},Ue.prototype.getLabel=function(){return this._label},Ue.prototype.getEdge=function(){return this._edge},Ue.prototype.getQuadrant=function(){return this._quadrant},Ue.prototype.getNode=function(){return this._node},Ue.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),n=e.lastIndexOf(".");return"  "+e.substring(n+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label},Ue.prototype.computeLabel=function(t){},Ue.prototype.init=function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=ze.quadrant(this._dx,this._dy),et.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")},Ue.prototype.interfaces_=function(){return[b]},Ue.prototype.getClass=function(){return Ue};var Ve=function(t){function e(){var e=arguments[0],n=arguments[1];if(t.call(this,e),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=n,n)this.init(e.getCoordinate(0),e.getCoordinate(1));else{var r=e.getNumPoints()-1;this.init(e.getCoordinate(r),e.getCoordinate(r-1))}this.computeDirectedLabel()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getNextMin=function(){return this._nextMin},e.prototype.getDepth=function(t){return this._depth[t]},e.prototype.setVisited=function(t){this._isVisited=t},e.prototype.computeDirectedLabel=function(){this._label=new Re(this._edge.getLabel()),this._isForward||this._label.flip()},e.prototype.getNext=function(){return this._next},e.prototype.setDepth=function(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new Me("assigned depths do not match",this.getCoordinate());this._depth[t]=e},e.prototype.isInteriorAreaEdge=function(){for(var t=!0,e=0;e<2;e++)this._label.isArea(e)&&this._label.getLocation(e,Se.LEFT)===M.INTERIOR&&this._label.getLocation(e,Se.RIGHT)===M.INTERIOR||(t=!1);return t},e.prototype.setNextMin=function(t){this._nextMin=t},e.prototype.print=function(e){t.prototype.print.call(this,e),e.print(" "+this._depth[Se.LEFT]+"/"+this._depth[Se.RIGHT]),e.print(" ("+this.getDepthDelta()+")"),this._isInResult&&e.print(" inResult")},e.prototype.setMinEdgeRing=function(t){this._minEdgeRing=t},e.prototype.isLineEdge=function(){var t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,M.EXTERIOR),n=!this._label.isArea(1)||this._label.allPositionsEqual(1,M.EXTERIOR);return t&&e&&n},e.prototype.setEdgeRing=function(t){this._edgeRing=t},e.prototype.getMinEdgeRing=function(){return this._minEdgeRing},e.prototype.getDepthDelta=function(){var t=this._edge.getDepthDelta();return this._isForward||(t=-t),t},e.prototype.setInResult=function(t){this._isInResult=t},e.prototype.getSym=function(){return this._sym},e.prototype.isForward=function(){return this._isForward},e.prototype.getEdge=function(){return this._edge},e.prototype.printEdge=function(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)},e.prototype.setSym=function(t){this._sym=t},e.prototype.setVisitedEdge=function(t){this.setVisited(t),this._sym.setVisited(t)},e.prototype.setEdgeDepths=function(t,e){var n=this.getEdge().getDepthDelta();this._isForward||(n=-n);var r=1;t===Se.LEFT&&(r=-1);var i=Se.opposite(t),o=e+n*r;this.setDepth(t,e),this.setDepth(i,o)},e.prototype.getEdgeRing=function(){return this._edgeRing},e.prototype.isInResult=function(){return this._isInResult},e.prototype.setNext=function(t){this._next=t},e.prototype.isVisited=function(){return this._isVisited},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.depthFactor=function(t,e){return t===M.EXTERIOR&&e===M.INTERIOR?1:t===M.INTERIOR&&e===M.EXTERIOR?-1:0},e}(Ue),Ge=function(){};Ge.prototype.createNode=function(t){return new Fe(t,null)},Ge.prototype.interfaces_=function(){return[]},Ge.prototype.getClass=function(){return Ge};var Ze=function(){if(this._edges=new wt,this._nodes=null,this._edgeEndList=new wt,0===arguments.length)this._nodes=new Be(new Ge);else if(1===arguments.length){var t=arguments[0];this._nodes=new Be(t)}};Ze.prototype.printEdges=function(t){t.println("Edges:");for(var e=0;e<this._edges.size();e++){t.println("edge "+e+":");var n=this._edges.get(e);n.print(t),n.eiList.print(t)}},Ze.prototype.find=function(t){return this._nodes.find(t)},Ze.prototype.addNode=function(){if(arguments[0]instanceof Fe){var t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof E){var e=arguments[0];return this._nodes.addNode(e)}},Ze.prototype.getNodeIterator=function(){return this._nodes.iterator()},Ze.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()},Ze.prototype.debugPrintln=function(t){Z.out.println(t)},Ze.prototype.isBoundaryNode=function(t,e){var n=this._nodes.find(e);if(null===n)return!1;var r=n.getLabel();return null!==r&&r.getLocation(t)===M.BOUNDARY},Ze.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkAllDirectedEdges()},Ze.prototype.matchInSameDirection=function(t,e,n,r){return!!t.equals(n)&&at.computeOrientation(t,e,r)===at.COLLINEAR&&ze.quadrant(t,e)===ze.quadrant(n,r)},Ze.prototype.getEdgeEnds=function(){return this._edgeEndList},Ze.prototype.debugPrint=function(t){Z.out.print(t)},Ze.prototype.getEdgeIterator=function(){return this._edges.iterator()},Ze.prototype.findEdgeInSameDirection=function(t,e){for(var n=0;n<this._edges.size();n++){var r=this._edges.get(n),i=r.getCoordinates();if(this.matchInSameDirection(t,e,i[0],i[1]))return r;if(this.matchInSameDirection(t,e,i[i.length-1],i[i.length-2]))return r}return null},Ze.prototype.insertEdge=function(t){this._edges.add(t)},Ze.prototype.findEdgeEnd=function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var n=e.next();if(n.getEdge()===t)return n}return null},Ze.prototype.addEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this._edges.add(n);var r=new Ve(n,!0),i=new Ve(n,!1);r.setSym(i),i.setSym(r),this.add(r),this.add(i)}},Ze.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)},Ze.prototype.getNodes=function(){return this._nodes.values()},Ze.prototype.findEdge=function(t,e){for(var n=0;n<this._edges.size();n++){var r=this._edges.get(n),i=r.getCoordinates();if(t.equals(i[0])&&e.equals(i[1]))return r}return null},Ze.prototype.interfaces_=function(){return[]},Ze.prototype.getClass=function(){return Ze},Ze.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()};var qe=function(){this._geometryFactory=null,this._shellList=new wt;var t=arguments[0];this._geometryFactory=t};qe.prototype.sortShellsAndHoles=function(t,e,n){for(var r=t.iterator();r.hasNext();){var i=r.next();i.isHole()?n.add(i):e.add(i)}},qe.prototype.computePolygons=function(t){for(var e=new wt,n=t.iterator();n.hasNext();){var r=n.next().toPolygon(this._geometryFactory);e.add(r)}return e},qe.prototype.placeFreeHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next();if(null===r.getShell()){var i=this.findEdgeRingContaining(r,t);if(null===i)throw new Me("unable to assign hole to a shell",r.getCoordinate(0));r.setShell(i)}}},qe.prototype.buildMinimalEdgeRings=function(t,e,n){for(var r=new wt,i=t.iterator();i.hasNext();){var o=i.next();if(o.getMaxNodeDegree()>2){o.linkDirectedEdgesForMinimalEdgeRings();var s=o.buildMinimalRings(),a=this.findShell(s);null!==a?(this.placePolygonHoles(a,s),e.add(a)):n.addAll(s)}else r.add(o)}return r},qe.prototype.containsPoint=function(t){for(var e=this._shellList.iterator();e.hasNext();)if(e.next().containsPoint(t))return!0;return!1},qe.prototype.buildMaximalEdgeRings=function(t){for(var e=new wt,n=t.iterator();n.hasNext();){var r=n.next();if(r.isInResult()&&r.getLabel().isArea()&&null===r.getEdgeRing()){var i=new De(r,this._geometryFactory);e.add(i),i.setInResult()}}return e},qe.prototype.placePolygonHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next();r.isHole()&&r.setShell(t)}},qe.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},qe.prototype.findEdgeRingContaining=function(t,e){for(var n=t.getLinearRing(),r=n.getEnvelopeInternal(),i=n.getCoordinateN(0),o=null,s=null,a=e.iterator();a.hasNext();){var l=a.next(),u=l.getLinearRing(),c=u.getEnvelopeInternal();null!==o&&(s=o.getLinearRing().getEnvelopeInternal());var h=!1;c.contains(r)&&at.isPointInRing(i,u.getCoordinates())&&(h=!0),h&&(null===o||s.contains(c))&&(o=l)}return o},qe.prototype.findShell=function(t){for(var e=0,n=null,r=t.iterator();r.hasNext();){var i=r.next();i.isHole()||(n=i,e++)}return et.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),n},qe.prototype.add=function(){if(1===arguments.length){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){var e=arguments[0],n=arguments[1];Ze.linkResultDirectedEdges(n);var r=this.buildMaximalEdgeRings(e),i=new wt,o=this.buildMinimalEdgeRings(r,this._shellList,i);this.sortShellsAndHoles(o,this._shellList,i),this.placeFreeHoles(this._shellList,i)}},qe.prototype.interfaces_=function(){return[]},qe.prototype.getClass=function(){return qe};var We=function(){};We.prototype.getBounds=function(){},We.prototype.interfaces_=function(){return[]},We.prototype.getClass=function(){return We};var He=function(){this._bounds=null,this._item=null;var t=arguments[0],e=arguments[1];this._bounds=t,this._item=e};He.prototype.getItem=function(){return this._item},He.prototype.getBounds=function(){return this._bounds},He.prototype.interfaces_=function(){return[We,e]},He.prototype.getClass=function(){return He};var Xe=function(){this._size=null,this._items=null,this._size=0,this._items=new wt,this._items.add(null)};Xe.prototype.poll=function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t},Xe.prototype.size=function(){return this._size},Xe.prototype.reorder=function(t){for(var e=null,n=this._items.get(t);2*t<=this._size&&((e=2*t)!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(n)<0);t=e)this._items.set(t,this._items.get(e));this._items.set(t,n)},Xe.prototype.clear=function(){this._size=0,this._items.clear()},Xe.prototype.isEmpty=function(){return 0===this._size},Xe.prototype.add=function(t){this._items.add(null),this._size+=1;var e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)},Xe.prototype.interfaces_=function(){return[]},Xe.prototype.getClass=function(){return Xe};var $e=function(){};$e.prototype.visitItem=function(t){},$e.prototype.interfaces_=function(){return[]},$e.prototype.getClass=function(){return $e};var Ye=function(){};Ye.prototype.insert=function(t,e){},Ye.prototype.remove=function(t,e){},Ye.prototype.query=function(){},Ye.prototype.interfaces_=function(){return[]},Ye.prototype.getClass=function(){return Ye};var Qe=function(){if(this._childBoundables=new wt,this._bounds=null,this._level=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._level=t}},Ke={serialVersionUID:{configurable:!0}};Qe.prototype.getLevel=function(){return this._level},Qe.prototype.size=function(){return this._childBoundables.size()},Qe.prototype.getChildBoundables=function(){return this._childBoundables},Qe.prototype.addChildBoundable=function(t){et.isTrue(null===this._bounds),this._childBoundables.add(t)},Qe.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},Qe.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds},Qe.prototype.interfaces_=function(){return[We,e]},Qe.prototype.getClass=function(){return Qe},Ke.serialVersionUID.get=function(){return 0x5a1e55ec41369800},Object.defineProperties(Qe,Ke);var Je=function(){};Je.reverseOrder=function(){return{compare:function(t,e){return e.compareTo(t)}}},Je.min=function(t){return Je.sort(t),t.get(0)},Je.sort=function(t,e){var n=t.toArray();e?Ft.sort(n,e):Ft.sort(n);for(var r=t.iterator(),i=0,o=n.length;i<o;i++)r.next(),r.set(n[i])},Je.singletonList=function(t){var e=new wt;return e.add(t),e};var tn=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],e=arguments[1],n=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=n,this._distance=this.distance()};tn.prototype.expandToQueue=function(t,e){var n=tn.isComposite(this._boundable1),r=tn.isComposite(this._boundable2);if(n&&r)return tn.area(this._boundable1)>tn.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,t,e),null):(this.expand(this._boundable2,this._boundable1,t,e),null);if(n)return this.expand(this._boundable1,this._boundable2,t,e),null;if(r)return this.expand(this._boundable2,this._boundable1,t,e),null;throw new y("neither boundable is composite")},tn.prototype.isLeaves=function(){return!(tn.isComposite(this._boundable1)||tn.isComposite(this._boundable2))},tn.prototype.compareTo=function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0},tn.prototype.expand=function(t,e,n,r){for(var i=t.getChildBoundables().iterator();i.hasNext();){var o=i.next(),s=new tn(o,e,this._itemDistance);s.getDistance()<r&&n.add(s)}},tn.prototype.getBoundable=function(t){return 0===t?this._boundable1:this._boundable2},tn.prototype.getDistance=function(){return this._distance},tn.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},tn.prototype.interfaces_=function(){return[b]},tn.prototype.getClass=function(){return tn},tn.area=function(t){return t.getBounds().getArea()},tn.isComposite=function(t){return t instanceof Qe};var en=function t(){if(this._root=null,this._built=!1,this._itemBoundables=new wt,this._nodeCapacity=null,0===arguments.length){var e=t.DEFAULT_NODE_CAPACITY;this._nodeCapacity=e}else if(1===arguments.length){var n=arguments[0];et.isTrue(n>1,"Node capacity must be greater than 1"),this._nodeCapacity=n}},nn={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};en.prototype.getNodeCapacity=function(){return this._nodeCapacity},en.prototype.lastNode=function(t){return t.get(t.size()-1)},en.prototype.size=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();n instanceof Qe?t+=this.size(n):n instanceof He&&(t+=1)}return t}},en.prototype.removeItem=function(t,e){for(var n=null,r=t.getChildBoundables().iterator();r.hasNext();){var i=r.next();i instanceof He&&i.getItem()===e&&(n=i)}return null!==n&&(t.getChildBoundables().remove(n),!0)},en.prototype.itemsTree=function(){if(0===arguments.length){this.build();var t=this.itemsTree(this._root);return null===t?new wt:t}if(1===arguments.length){for(var e=arguments[0],n=new wt,r=e.getChildBoundables().iterator();r.hasNext();){var i=r.next();if(i instanceof Qe){var o=this.itemsTree(i);null!==o&&n.add(o)}else i instanceof He?n.add(i.getItem()):et.shouldNeverReachHere()}return n.size()<=0?null:n}},en.prototype.insert=function(t,e){et.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new He(t,e))},en.prototype.boundablesAtLevel=function(){if(1===arguments.length){var t=arguments[0],e=new wt;return this.boundablesAtLevel(t,this._root,e),e}if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];if(et.isTrue(n>-2),r.getLevel()===n)return i.add(r),null;for(var o=r.getChildBoundables().iterator();o.hasNext();){var s=o.next();s instanceof Qe?this.boundablesAtLevel(n,s,i):(et.isTrue(s instanceof He),-1===n&&i.add(s))}return null}},en.prototype.query=function(){if(1===arguments.length){var t=arguments[0];this.build();var e=new wt;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.query(t,this._root,e),e}if(2===arguments.length){var n=arguments[0],r=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.query(n,this._root,r)}else if(3===arguments.length)if(I(arguments[2],$e)&&arguments[0]instanceof Object&&arguments[1]instanceof Qe)for(var i=arguments[0],o=arguments[2],s=arguments[1].getChildBoundables(),a=0;a<s.size();a++){var l=s.get(a);this.getIntersectsOp().intersects(l.getBounds(),i)&&(l instanceof Qe?this.query(i,l,o):l instanceof He?o.visitItem(l.getItem()):et.shouldNeverReachHere())}else if(I(arguments[2],xt)&&arguments[0]instanceof Object&&arguments[1]instanceof Qe)for(var u=arguments[0],c=arguments[2],h=arguments[1].getChildBoundables(),p=0;p<h.size();p++){var f=h.get(p);this.getIntersectsOp().intersects(f.getBounds(),u)&&(f instanceof Qe?this.query(u,f,c):f instanceof He?c.add(f.getItem()):et.shouldNeverReachHere())}},en.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},en.prototype.getRoot=function(){return this.build(),this._root},en.prototype.remove=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.remove(t,this._root,e)}if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2],o=this.removeItem(r,i);if(o)return!0;for(var s=null,a=r.getChildBoundables().iterator();a.hasNext();){var l=a.next();if(this.getIntersectsOp().intersects(l.getBounds(),n)&&l instanceof Qe&&(o=this.remove(n,l,i))){s=l;break}}return null!==s&&s.getChildBoundables().isEmpty()&&r.getChildBoundables().remove(s),o}},en.prototype.createHigherLevels=function(t,e){et.isTrue(!t.isEmpty());var n=this.createParentBoundables(t,e+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,e+1)},en.prototype.depth=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();if(n instanceof Qe){var r=this.depth(n);r>t&&(t=r)}}return t+1}},en.prototype.createParentBoundables=function(t,e){et.isTrue(!t.isEmpty());var n=new wt;n.add(this.createNode(e));var r=new wt(t);Je.sort(r,this.getComparator());for(var i=r.iterator();i.hasNext();){var o=i.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(e)),this.lastNode(n).addChildBoundable(o)}return n},en.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},en.prototype.interfaces_=function(){return[e]},en.prototype.getClass=function(){return en},en.compareDoubles=function(t,e){return t>e?1:t<e?-1:0},nn.IntersectsOp.get=function(){return rn},nn.serialVersionUID.get=function(){return-0x35ef64c82d4c5400},nn.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(en,nn);var rn=function(){},on=function(){};on.prototype.distance=function(t,e){},on.prototype.interfaces_=function(){return[]},on.prototype.getClass=function(){return on};var sn=function(t){function n(e){e=e||n.DEFAULT_NODE_CAPACITY,t.call(this,e)}t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n;var r={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return n.prototype.createParentBoundablesFromVerticalSlices=function(t,e){et.isTrue(t.length>0);for(var n=new wt,r=0;r<t.length;r++)n.addAll(this.createParentBoundablesFromVerticalSlice(t[r],e));return n},n.prototype.createNode=function(t){return new an(t)},n.prototype.size=function(){return 0===arguments.length?t.prototype.size.call(this):t.prototype.size.apply(this,arguments)},n.prototype.insert=function(){if(2!==arguments.length)return t.prototype.insert.apply(this,arguments);var e=arguments[0],n=arguments[1];if(e.isNull())return null;t.prototype.insert.call(this,e,n)},n.prototype.getIntersectsOp=function(){return n.intersectsOp},n.prototype.verticalSlices=function(t,e){for(var n=Math.trunc(Math.ceil(t.size()/e)),r=new Array(e).fill(null),i=t.iterator(),o=0;o<e;o++){r[o]=new wt;for(var s=0;i.hasNext()&&s<n;){var a=i.next();r[o].add(a),s++}}return r},n.prototype.query=function(){if(1===arguments.length){var e=arguments[0];return t.prototype.query.call(this,e)}if(2===arguments.length){var n=arguments[0],r=arguments[1];t.prototype.query.call(this,n,r)}else if(3===arguments.length)if(I(arguments[2],$e)&&arguments[0]instanceof Object&&arguments[1]instanceof Qe){var i=arguments[0],o=arguments[1],s=arguments[2];t.prototype.query.call(this,i,o,s)}else if(I(arguments[2],xt)&&arguments[0]instanceof Object&&arguments[1]instanceof Qe){var a=arguments[0],l=arguments[1],u=arguments[2];t.prototype.query.call(this,a,l,u)}},n.prototype.getComparator=function(){return n.yComparator},n.prototype.createParentBoundablesFromVerticalSlice=function(e,n){return t.prototype.createParentBoundables.call(this,e,n)},n.prototype.remove=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return t.prototype.remove.call(this,e,n)}return t.prototype.remove.apply(this,arguments)},n.prototype.depth=function(){return 0===arguments.length?t.prototype.depth.call(this):t.prototype.depth.apply(this,arguments)},n.prototype.createParentBoundables=function(t,e){et.isTrue(!t.isEmpty());var r=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),i=new wt(t);Je.sort(i,n.xComparator);var o=this.verticalSlices(i,Math.trunc(Math.ceil(Math.sqrt(r))));return this.createParentBoundablesFromVerticalSlices(o,e)},n.prototype.nearestNeighbour=function(){if(1===arguments.length){if(I(arguments[0],on)){var t=arguments[0],e=new tn(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(e)}if(arguments[0]instanceof tn){var r=arguments[0];return this.nearestNeighbour(r,_.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof n&&I(arguments[1],on)){var i=arguments[0],o=arguments[1],s=new tn(this.getRoot(),i.getRoot(),o);return this.nearestNeighbour(s)}if(arguments[0]instanceof tn&&"number"==typeof arguments[1]){var a=arguments[0],l=arguments[1],u=null,c=new Xe;for(c.add(a);!c.isEmpty()&&l>0;){var h=c.poll(),p=h.getDistance();if(p>=l)break;h.isLeaves()?(l=p,u=h):h.expandToQueue(c,l)}return[u.getBoundable(0).getItem(),u.getBoundable(1).getItem()]}}else if(3===arguments.length){var f=arguments[2],d=new He(arguments[0],arguments[1]),g=new tn(this.getRoot(),d,f);return this.nearestNeighbour(g)[0]}},n.prototype.interfaces_=function(){return[Ye,e]},n.prototype.getClass=function(){return n},n.centreX=function(t){return n.avg(t.getMinX(),t.getMaxX())},n.avg=function(t,e){return(t+e)/2},n.centreY=function(t){return n.avg(t.getMinY(),t.getMaxY())},r.STRtreeNode.get=function(){return an},r.serialVersionUID.get=function(){return 0x39920f7d5f261e0},r.xComparator.get=function(){return{interfaces_:function(){return[w]},compare:function(e,r){return t.compareDoubles(n.centreX(e.getBounds()),n.centreX(r.getBounds()))}}},r.yComparator.get=function(){return{interfaces_:function(){return[w]},compare:function(e,r){return t.compareDoubles(n.centreY(e.getBounds()),n.centreY(r.getBounds()))}}},r.intersectsOp.get=function(){return{interfaces_:function(){return[t.IntersectsOp]},intersects:function(t,e){return t.intersects(e)}}},r.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(n,r),n}(en),an=function(t){function e(){var e=arguments[0];t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.computeBounds=function(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var n=e.next();null===t?t=new W(n.getBounds()):t.expandToInclude(n.getBounds())}return t},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Qe),ln=function(){};ln.prototype.interfaces_=function(){return[]},ln.prototype.getClass=function(){return ln},ln.relativeSign=function(t,e){return t<e?-1:t>e?1:0},ln.compare=function(t,e,n){if(e.equals2D(n))return 0;var r=ln.relativeSign(e.x,n.x),i=ln.relativeSign(e.y,n.y);switch(t){case 0:return ln.compareValue(r,i);case 1:return ln.compareValue(i,r);case 2:return ln.compareValue(i,-r);case 3:return ln.compareValue(-r,i);case 4:return ln.compareValue(-r,-i);case 5:return ln.compareValue(-i,-r);case 6:return ln.compareValue(-i,r);case 7:return ln.compareValue(r,-i)}return et.shouldNeverReachHere("invalid octant value"),0},ln.compareValue=function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0};var un=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];this._segString=t,this.coord=new E(e),this.segmentIndex=n,this._segmentOctant=r,this._isInterior=!e.equals2D(t.getCoordinate(n))};un.prototype.getCoordinate=function(){return this.coord},un.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)},un.prototype.compareTo=function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:ln.compare(this._segmentOctant,this.coord,e.coord)},un.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t},un.prototype.isInterior=function(){return this._isInterior},un.prototype.interfaces_=function(){return[b]},un.prototype.getClass=function(){return un};var cn=function(){this._nodeMap=new h,this._edge=null;var t=arguments[0];this._edge=t};cn.prototype.getSplitCoordinates=function(){var t=new St;this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var r=e.next();this.addEdgeCoordinates(n,r,t),n=r}return t.toCoordinateArray()},cn.prototype.addCollapsedNodes=function(){var t=new wt;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var n=e.next().intValue();this.add(this._edge.getCoordinate(n),n)}},cn.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},cn.prototype.findCollapsesFromExistingVertices=function(t){for(var e=0;e<this._edge.size()-2;e++){var n=this._edge.getCoordinate(e),r=this._edge.getCoordinate(e+2);n.equals2D(r)&&t.add(new k(e+1))}},cn.prototype.addEdgeCoordinates=function(t,e,n){var r=this._edge.getCoordinate(e.segmentIndex),i=e.isInterior()||!e.coord.equals2D(r);n.add(new E(t.coord),!1);for(var o=t.segmentIndex+1;o<=e.segmentIndex;o++)n.add(this._edge.getCoordinate(o));i&&n.add(new E(e.coord))},cn.prototype.iterator=function(){return this._nodeMap.values().iterator()},cn.prototype.addSplitEdges=function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),n=e.next();e.hasNext();){var r=e.next(),i=this.createSplitEdge(n,r);t.add(i),n=r}},cn.prototype.findCollapseIndex=function(t,e,n){if(!t.coord.equals2D(e.coord))return!1;var r=e.segmentIndex-t.segmentIndex;return e.isInterior()||r--,1===r&&(n[0]=t.segmentIndex+1,!0)},cn.prototype.findCollapsesFromInsertedNodes=function(t){for(var e=new Array(1).fill(null),n=this.iterator(),r=n.next();n.hasNext();){var i=n.next();this.findCollapseIndex(r,i,e)&&t.add(new k(e[0])),r=i}},cn.prototype.getEdge=function(){return this._edge},cn.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)},cn.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,r=this._edge.getCoordinate(e.segmentIndex),i=e.isInterior()||!e.coord.equals2D(r);i||n--;var o=new Array(n).fill(null),s=0;o[s++]=new E(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this._edge.getCoordinate(a);return i&&(o[s]=new E(e.coord)),new dn(o,this._edge.getData())},cn.prototype.add=function(t,e){var n=new un(this._edge,t,e,this._edge.getSegmentOctant(e)),r=this._nodeMap.get(n);return null!==r?(et.isTrue(r.coord.equals2D(t),"Found equal nodes with different coordinates"),r):(this._nodeMap.put(n,n),n)},cn.prototype.checkSplitEdgesCorrectness=function(t){var e=this._edge.getCoordinates(),n=t.get(0).getCoordinate(0);if(!n.equals2D(e[0]))throw new J("bad split edge start point at "+n);var r=t.get(t.size()-1).getCoordinates(),i=r[r.length-1];if(!i.equals2D(e[e.length-1]))throw new J("bad split edge end point at "+i)},cn.prototype.interfaces_=function(){return[]},cn.prototype.getClass=function(){return cn};var hn=function(){};hn.prototype.interfaces_=function(){return[]},hn.prototype.getClass=function(){return hn},hn.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new y("Cannot compute the octant for point ( "+t+", "+e+" )");var n=Math.abs(t),r=Math.abs(e);return t>=0?e>=0?n>=r?0:1:n>=r?7:6:e>=0?n>=r?3:2:n>=r?4:5}if(arguments[0]instanceof E&&arguments[1]instanceof E){var i=arguments[0],o=arguments[1],s=o.x-i.x,a=o.y-i.y;if(0===s&&0===a)throw new y("Cannot compute the octant for two identical points "+i);return hn.octant(s,a)}};var pn=function(){};pn.prototype.getCoordinates=function(){},pn.prototype.size=function(){},pn.prototype.getCoordinate=function(t){},pn.prototype.isClosed=function(){},pn.prototype.setData=function(t){},pn.prototype.getData=function(){},pn.prototype.interfaces_=function(){return[]},pn.prototype.getClass=function(){return pn};var fn=function(){};fn.prototype.addIntersection=function(t,e){},fn.prototype.interfaces_=function(){return[pn]},fn.prototype.getClass=function(){return fn};var dn=function(){this._nodeList=new cn(this),this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};dn.prototype.getCoordinates=function(){return this._pts},dn.prototype.size=function(){return this._pts.length},dn.prototype.getCoordinate=function(t){return this._pts[t]},dn.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},dn.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},dn.prototype.setData=function(t){this._data=t},dn.prototype.safeOctant=function(t,e){return t.equals2D(e)?0:hn.octant(t,e)},dn.prototype.getData=function(){return this._data},dn.prototype.addIntersection=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){var n=arguments[1],r=arguments[3],i=new E(arguments[0].getIntersection(r));this.addIntersection(i,n)}},dn.prototype.toString=function(){return K.toLineString(new le(this._pts))},dn.prototype.getNodeList=function(){return this._nodeList},dn.prototype.addIntersectionNode=function(t,e){var n=e,r=n+1;if(r<this._pts.length){var i=this._pts[r];t.equals2D(i)&&(n=r)}return this._nodeList.add(t,n)},dn.prototype.addIntersections=function(t,e,n){for(var r=0;r<t.getIntersectionNum();r++)this.addIntersection(t,e,n,r)},dn.prototype.interfaces_=function(){return[fn]},dn.prototype.getClass=function(){return dn},dn.getNodedSubstrings=function(){if(1===arguments.length){var t=arguments[0],e=new wt;return dn.getNodedSubstrings(t,e),e}if(2===arguments.length)for(var n=arguments[1],r=arguments[0].iterator();r.hasNext();)r.next().getNodeList().addSplitEdges(n)};var gn=function(){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new E,this.p1=new E;else if(1===arguments.length){var t=arguments[0];this.p0=new E(t.p0),this.p1=new E(t.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){var e=arguments[0],n=arguments[1],r=arguments[2],i=arguments[3];this.p0=new E(e,n),this.p1=new E(r,i)}},mn={serialVersionUID:{configurable:!0}};gn.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},gn.prototype.orientationIndex=function(){if(arguments[0]instanceof gn){var t=arguments[0],e=at.orientationIndex(this.p0,this.p1,t.p0),n=at.orientationIndex(this.p0,this.p1,t.p1);return e>=0&&n>=0||e<=0&&n<=0?Math.max(e,n):0}if(arguments[0]instanceof E){var r=arguments[0];return at.orientationIndex(this.p0,this.p1,r)}},gn.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])},gn.prototype.isVertical=function(){return this.p0.x===this.p1.x},gn.prototype.equals=function(t){if(!(t instanceof gn))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)},gn.prototype.intersection=function(t){var e=new it;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null},gn.prototype.project=function(){if(arguments[0]instanceof E){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new E(t);var e=this.projectionFactor(t),n=new E;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n}if(arguments[0]instanceof gn){var r=arguments[0],i=this.projectionFactor(r.p0),o=this.projectionFactor(r.p1);if(i>=1&&o>=1)return null;if(i<=0&&o<=0)return null;var s=this.project(r.p0);i<0&&(s=this.p0),i>1&&(s=this.p1);var a=this.project(r.p1);return o<0&&(a=this.p0),o>1&&(a=this.p1),new gn(s,a)}},gn.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},gn.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},gn.prototype.getCoordinate=function(t){return 0===t?this.p0:this.p1},gn.prototype.distancePerpendicular=function(t){return at.distancePointLinePerpendicular(t,this.p0,this.p1)},gn.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},gn.prototype.midPoint=function(){return gn.midPoint(this.p0,this.p1)},gn.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,r=e*e+n*n;return r<=0?_.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/r},gn.prototype.closestPoints=function(t){var e=this.intersection(t);if(null!==e)return[e,e];var n=new Array(2).fill(null),r=_.MAX_VALUE,i=null,o=this.closestPoint(t.p0);r=o.distance(t.p0),n[0]=o,n[1]=t.p0;var s=this.closestPoint(t.p1);(i=s.distance(t.p1))<r&&(r=i,n[0]=s,n[1]=t.p1);var a=t.closestPoint(this.p0);(i=a.distance(this.p0))<r&&(r=i,n[0]=this.p0,n[1]=a);var l=t.closestPoint(this.p1);return(i=l.distance(this.p1))<r&&(r=i,n[0]=this.p1,n[1]=l),n},gn.prototype.closestPoint=function(t){var e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1},gn.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},gn.prototype.getLength=function(){return this.p0.distance(this.p1)},gn.prototype.compareTo=function(t){var e=t,n=this.p0.compareTo(e.p0);return 0!==n?n:this.p1.compareTo(e.p1)},gn.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t},gn.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)},gn.prototype.lineIntersection=function(t){try{return q.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof G))throw t}return null},gn.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},gn.prototype.pointAlongOffset=function(t,e){var n=this.p0.x+t*(this.p1.x-this.p0.x),r=this.p0.y+t*(this.p1.y-this.p0.y),i=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y,s=Math.sqrt(i*i+o*o),a=0,l=0;if(0!==e){if(s<=0)throw new Error("Cannot compute offset from zero-length line segment");a=e*i/s,l=e*o/s}return new E(n-l,r+a)},gn.prototype.setCoordinates=function(){if(1===arguments.length){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=n.x,this.p1.y=n.y}},gn.prototype.segmentFraction=function(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||_.isNaN(e))&&(e=1),e},gn.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},gn.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},gn.prototype.distance=function(){if(arguments[0]instanceof gn){var t=arguments[0];return at.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof E){var e=arguments[0];return at.distancePointLine(e,this.p0,this.p1)}},gn.prototype.pointAlong=function(t){var e=new E;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e},gn.prototype.hashCode=function(){var t=_.doubleToLongBits(this.p0.x);t^=31*_.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),n=_.doubleToLongBits(this.p1.x);return n^=31*_.doubleToLongBits(this.p1.y),e^Math.trunc(n)^Math.trunc(n>>32)},gn.prototype.interfaces_=function(){return[b,e]},gn.prototype.getClass=function(){return gn},gn.midPoint=function(t,e){return new E((t.x+e.x)/2,(t.y+e.y)/2)},mn.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(gn,mn);var An=function(){this.tempEnv1=new W,this.tempEnv2=new W,this._overlapSeg1=new gn,this._overlapSeg2=new gn};An.prototype.overlap=function(){if(2===arguments.length);else if(4===arguments.length){var t=arguments[1],e=arguments[2],n=arguments[3];arguments[0].getLineSegment(t,this._overlapSeg1),e.getLineSegment(n,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},An.prototype.interfaces_=function(){return[]},An.prototype.getClass=function(){return An};var yn=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];this._pts=t,this._start=e,this._end=n,this._context=r};yn.prototype.getLineSegment=function(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]},yn.prototype.computeSelect=function(t,e,n,r){var i=this._pts[e],o=this._pts[n];if(r.tempEnv1.init(i,o),n-e==1)return r.select(this,e),null;if(!t.intersects(r.tempEnv1))return null;var s=Math.trunc((e+n)/2);e<s&&this.computeSelect(t,e,s,r),s<n&&this.computeSelect(t,s,n,r)},yn.prototype.getCoordinates=function(){for(var t=new Array(this._end-this._start+1).fill(null),e=0,n=this._start;n<=this._end;n++)t[e++]=this._pts[n];return t},yn.prototype.computeOverlaps=function(t,e){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,e)},yn.prototype.setId=function(t){this._id=t},yn.prototype.select=function(t,e){this.computeSelect(t,this._start,this._end,e)},yn.prototype.getEnvelope=function(){if(null===this._env){var t=this._pts[this._start],e=this._pts[this._end];this._env=new W(t,e)}return this._env},yn.prototype.getEndIndex=function(){return this._end},yn.prototype.getStartIndex=function(){return this._start},yn.prototype.getContext=function(){return this._context},yn.prototype.getId=function(){return this._id},yn.prototype.computeOverlapsInternal=function(t,e,n,r,i,o){var s=this._pts[t],a=this._pts[e],l=n._pts[r],u=n._pts[i];if(e-t==1&&i-r==1)return o.overlap(this,t,n,r),null;if(o.tempEnv1.init(s,a),o.tempEnv2.init(l,u),!o.tempEnv1.intersects(o.tempEnv2))return null;var c=Math.trunc((t+e)/2),h=Math.trunc((r+i)/2);t<c&&(r<h&&this.computeOverlapsInternal(t,c,n,r,h,o),h<i&&this.computeOverlapsInternal(t,c,n,h,i,o)),c<e&&(r<h&&this.computeOverlapsInternal(c,e,n,r,h,o),h<i&&this.computeOverlapsInternal(c,e,n,h,i,o))},yn.prototype.interfaces_=function(){return[]},yn.prototype.getClass=function(){return yn};var _n=function(){};_n.prototype.interfaces_=function(){return[]},_n.prototype.getClass=function(){return _n},_n.getChainStartIndices=function(t){var e=0,n=new wt;n.add(new k(e));do{var r=_n.findChainEnd(t,e);n.add(new k(r)),e=r}while(e<t.length-1);return _n.toIntArray(n)},_n.findChainEnd=function(t,e){for(var n=e;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;for(var r=ze.quadrant(t[n],t[n+1]),i=e+1;i<t.length&&(t[i-1].equals2D(t[i])||ze.quadrant(t[i-1],t[i])===r);)i++;return i-1},_n.getChains=function(){if(1===arguments.length){var t=arguments[0];return _n.getChains(t,null)}if(2===arguments.length){for(var e=arguments[0],n=arguments[1],r=new wt,i=_n.getChainStartIndices(e),o=0;o<i.length-1;o++){var s=new yn(e,i[o],i[o+1],n);r.add(s)}return r}},_n.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var vn=function(){};vn.prototype.computeNodes=function(t){},vn.prototype.getNodedSubstrings=function(){},vn.prototype.interfaces_=function(){return[]},vn.prototype.getClass=function(){return vn};var bn=function(){if(this._segInt=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setSegmentIntersector(t)}};bn.prototype.setSegmentIntersector=function(t){this._segInt=t},bn.prototype.interfaces_=function(){return[vn]},bn.prototype.getClass=function(){return bn};var xn=function(t){function e(e){e?t.call(this,e):t.call(this),this._monoChains=new wt,this._index=new sn,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={SegmentOverlapAction:{configurable:!0}};return e.prototype.getMonotoneChains=function(){return this._monoChains},e.prototype.getNodedSubstrings=function(){return dn.getNodedSubstrings(this._nodedSegStrings)},e.prototype.getIndex=function(){return this._index},e.prototype.add=function(t){for(var e=_n.getChains(t.getCoordinates(),t).iterator();e.hasNext();){var n=e.next();n.setId(this._idCounter++),this._index.insert(n.getEnvelope(),n),this._monoChains.add(n)}},e.prototype.computeNodes=function(t){this._nodedSegStrings=t;for(var e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()},e.prototype.intersectChains=function(){for(var t=new wn(this._segInt),e=this._monoChains.iterator();e.hasNext();)for(var n=e.next(),r=this._index.query(n.getEnvelope()).iterator();r.hasNext();){var i=r.next();if(i.getId()>n.getId()&&(n.computeOverlaps(i,t),this._nOverlaps++),this._segInt.isDone())return null}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.SegmentOverlapAction.get=function(){return wn},Object.defineProperties(e,n),e}(bn),wn=function(t){function e(){t.call(this),this._si=null;var e=arguments[0];this._si=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.overlap=function(){if(4!==arguments.length)return t.prototype.overlap.apply(this,arguments);var e=arguments[1],n=arguments[2],r=arguments[3],i=arguments[0].getContext(),o=n.getContext();this._si.processIntersections(i,e,o,r)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(An),En=function t(){if(this._quadrantSegments=t.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=t.CAP_ROUND,this._joinStyle=t.JOIN_ROUND,this._mitreLimit=t.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=t.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.setQuadrantSegments(e)}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.setQuadrantSegments(n),this.setEndCapStyle(r)}else if(4===arguments.length){var i=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this.setQuadrantSegments(i),this.setEndCapStyle(o),this.setJoinStyle(s),this.setMitreLimit(a)}},Sn={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};En.prototype.getEndCapStyle=function(){return this._endCapStyle},En.prototype.isSingleSided=function(){return this._isSingleSided},En.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=En.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=En.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==En.JOIN_ROUND&&(this._quadrantSegments=En.DEFAULT_QUADRANT_SEGMENTS)},En.prototype.getJoinStyle=function(){return this._joinStyle},En.prototype.setJoinStyle=function(t){this._joinStyle=t},En.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t},En.prototype.getSimplifyFactor=function(){return this._simplifyFactor},En.prototype.getQuadrantSegments=function(){return this._quadrantSegments},En.prototype.setEndCapStyle=function(t){this._endCapStyle=t},En.prototype.getMitreLimit=function(){return this._mitreLimit},En.prototype.setMitreLimit=function(t){this._mitreLimit=t},En.prototype.setSingleSided=function(t){this._isSingleSided=t},En.prototype.interfaces_=function(){return[]},En.prototype.getClass=function(){return En},En.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)},Sn.CAP_ROUND.get=function(){return 1},Sn.CAP_FLAT.get=function(){return 2},Sn.CAP_SQUARE.get=function(){return 3},Sn.JOIN_ROUND.get=function(){return 1},Sn.JOIN_MITRE.get=function(){return 2},Sn.JOIN_BEVEL.get=function(){return 3},Sn.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},Sn.DEFAULT_MITRE_LIMIT.get=function(){return 5},Sn.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01},Object.defineProperties(En,Sn);var Tn=function(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=at.COUNTERCLOCKWISE,this._inputLine=t||null},Pn={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};Tn.prototype.isDeletable=function(t,e,n,r){var i=this._inputLine[t],o=this._inputLine[e],s=this._inputLine[n];return!!this.isConcave(i,o,s)&&!!this.isShallow(i,o,s,r)&&this.isShallowSampled(i,o,t,n,r)},Tn.prototype.deleteShallowConcavities=function(){for(var t=1,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e),r=!1;n<this._inputLine.length;){var i=!1;this.isDeletable(t,e,n,this._distanceTol)&&(this._isDeleted[e]=Tn.DELETE,i=!0,r=!0),t=i?n:e,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e)}return r},Tn.prototype.isShallowConcavity=function(t,e,n,r){return at.computeOrientation(t,e,n)===this._angleOrientation&&at.distancePointLine(e,t,n)<r},Tn.prototype.isShallowSampled=function(t,e,n,r,i){var o=Math.trunc((r-n)/Tn.NUM_PTS_TO_CHECK);o<=0&&(o=1);for(var s=n;s<r;s+=o)if(!this.isShallow(t,e,this._inputLine[s],i))return!1;return!0},Tn.prototype.isConcave=function(t,e,n){return at.computeOrientation(t,e,n)===this._angleOrientation},Tn.prototype.simplify=function(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=at.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()},Tn.prototype.findNextNonDeletedIndex=function(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===Tn.DELETE;)e++;return e},Tn.prototype.isShallow=function(t,e,n,r){return at.distancePointLine(e,t,n)<r},Tn.prototype.collapseLine=function(){for(var t=new St,e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==Tn.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()},Tn.prototype.interfaces_=function(){return[]},Tn.prototype.getClass=function(){return Tn},Tn.simplify=function(t,e){return new Tn(t).simplify(e)},Pn.INIT.get=function(){return 0},Pn.DELETE.get=function(){return 1},Pn.KEEP.get=function(){return 1},Pn.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(Tn,Pn);var Mn=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new wt},Cn={COORDINATE_ARRAY_TYPE:{configurable:!0}};Mn.prototype.getCoordinates=function(){return this._ptList.toArray(Mn.COORDINATE_ARRAY_TYPE)},Mn.prototype.setPrecisionModel=function(t){this._precisionModel=t},Mn.prototype.addPt=function(t){var e=new E(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)},Mn.prototype.revere=function(){},Mn.prototype.addPts=function(t,e){if(e)for(var n=0;n<t.length;n++)this.addPt(t[n]);else for(var r=t.length-1;r>=0;r--)this.addPt(t[r])},Mn.prototype.isRedundant=function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance},Mn.prototype.toString=function(){return(new Ae).createLineString(this.getCoordinates()).toString()},Mn.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var t=new E(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)},Mn.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t},Mn.prototype.interfaces_=function(){return[]},Mn.prototype.getClass=function(){return Mn},Cn.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(Mn,Cn);var In=function(){},On={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};In.prototype.interfaces_=function(){return[]},In.prototype.getClass=function(){return In},In.toDegrees=function(t){return 180*t/Math.PI},In.normalize=function(t){for(;t>Math.PI;)t-=In.PI_TIMES_2;for(;t<=-Math.PI;)t+=In.PI_TIMES_2;return t},In.angle=function(){if(1===arguments.length){var t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){var e=arguments[0],n=arguments[1],r=n.x-e.x,i=n.y-e.y;return Math.atan2(i,r)}},In.isAcute=function(t,e,n){var r=t.x-e.x,i=t.y-e.y;return r*(n.x-e.x)+i*(n.y-e.y)>0},In.isObtuse=function(t,e,n){var r=t.x-e.x,i=t.y-e.y;return r*(n.x-e.x)+i*(n.y-e.y)<0},In.interiorAngle=function(t,e,n){var r=In.angle(e,t),i=In.angle(e,n);return Math.abs(i-r)},In.normalizePositive=function(t){if(t<0){for(;t<0;)t+=In.PI_TIMES_2;t>=In.PI_TIMES_2&&(t=0)}else{for(;t>=In.PI_TIMES_2;)t-=In.PI_TIMES_2;t<0&&(t=0)}return t},In.angleBetween=function(t,e,n){var r=In.angle(e,t),i=In.angle(e,n);return In.diff(r,i)},In.diff=function(t,e){var n=null;return(n=t<e?e-t:t-e)>Math.PI&&(n=2*Math.PI-n),n},In.toRadians=function(t){return t*Math.PI/180},In.getTurn=function(t,e){var n=Math.sin(e-t);return n>0?In.COUNTERCLOCKWISE:n<0?In.CLOCKWISE:In.NONE},In.angleBetweenOriented=function(t,e,n){var r=In.angle(e,t),i=In.angle(e,n)-r;return i<=-Math.PI?i+In.PI_TIMES_2:i>Math.PI?i-In.PI_TIMES_2:i},On.PI_TIMES_2.get=function(){return 2*Math.PI},On.PI_OVER_2.get=function(){return Math.PI/2},On.PI_OVER_4.get=function(){return Math.PI/4},On.COUNTERCLOCKWISE.get=function(){return at.COUNTERCLOCKWISE},On.CLOCKWISE.get=function(){return at.CLOCKWISE},On.NONE.get=function(){return at.COLLINEAR},Object.defineProperties(In,On);var Rn=function t(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new gn,this._seg1=new gn,this._offset0=new gn,this._offset1=new gn,this._side=0,this._hasNarrowConcaveAngle=!1;var e=arguments[0],n=arguments[1],r=arguments[2];this._precisionModel=e,this._bufParams=n,this._li=new it,this._filletAngleQuantum=Math.PI/2/n.getQuadrantSegments(),n.getQuadrantSegments()>=8&&n.getJoinStyle()===En.JOIN_ROUND&&(this._closingSegLengthFactor=t.MAX_CLOSING_SEG_LEN_FACTOR),this.init(r)},Ln={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Rn.prototype.addNextSegment=function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var n=at.computeOrientation(this._s0,this._s1,this._s2),r=n===at.CLOCKWISE&&this._side===Se.LEFT||n===at.COUNTERCLOCKWISE&&this._side===Se.RIGHT;0===n?this.addCollinear(e):r?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)},Rn.prototype.addLineEndCap=function(t,e){var n=new gn(t,e),r=new gn;this.computeOffsetSegment(n,Se.LEFT,this._distance,r);var i=new gn;this.computeOffsetSegment(n,Se.RIGHT,this._distance,i);var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o);switch(this._bufParams.getEndCapStyle()){case En.CAP_ROUND:this._segList.addPt(r.p1),this.addFilletArc(e,a+Math.PI/2,a-Math.PI/2,at.CLOCKWISE,this._distance),this._segList.addPt(i.p1);break;case En.CAP_FLAT:this._segList.addPt(r.p1),this._segList.addPt(i.p1);break;case En.CAP_SQUARE:var l=new E;l.x=Math.abs(this._distance)*Math.cos(a),l.y=Math.abs(this._distance)*Math.sin(a);var u=new E(r.p1.x+l.x,r.p1.y+l.y),c=new E(i.p1.x+l.x,i.p1.y+l.y);this._segList.addPt(u),this._segList.addPt(c)}},Rn.prototype.getCoordinates=function(){return this._segList.getCoordinates()},Rn.prototype.addMitreJoin=function(t,e,n,r){var i=!0,o=null;try{o=q.intersection(e.p0,e.p1,n.p0,n.p1),(r<=0?1:o.distance(t)/Math.abs(r))>this._bufParams.getMitreLimit()&&(i=!1)}catch(t){if(!(t instanceof G))throw t;o=new E(0,0),i=!1}i?this._segList.addPt(o):this.addLimitedMitreJoin(e,n,r,this._bufParams.getMitreLimit())},Rn.prototype.addFilletCorner=function(t,e,n,r,i){var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o),l=n.x-t.x,u=n.y-t.y,c=Math.atan2(u,l);r===at.CLOCKWISE?a<=c&&(a+=2*Math.PI):a>=c&&(a-=2*Math.PI),this._segList.addPt(e),this.addFilletArc(t,a,c,r,i),this._segList.addPt(n)},Rn.prototype.addOutsideTurn=function(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Rn.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===En.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===En.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))},Rn.prototype.createSquare=function(t){this._segList.addPt(new E(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new E(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new E(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new E(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()},Rn.prototype.addSegments=function(t,e){this._segList.addPts(t,e)},Rn.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},Rn.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},Rn.prototype.initSideSegments=function(t,e,n){this._s1=t,this._s2=e,this._side=n,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,n,this._distance,this._offset1)},Rn.prototype.addLimitedMitreJoin=function(t,e,n,r){var i=this._seg0.p1,o=In.angle(i,this._seg0.p0),s=In.angleBetweenOriented(this._seg0.p0,i,this._seg1.p1)/2,a=In.normalize(o+s),l=In.normalize(a+Math.PI),u=r*n,c=n-u*Math.abs(Math.sin(s)),h=i.x+u*Math.cos(l),p=i.y+u*Math.sin(l),f=new E(h,p),d=new gn(i,f),g=d.pointAlongOffset(1,c),m=d.pointAlongOffset(1,-c);this._side===Se.LEFT?(this._segList.addPt(g),this._segList.addPt(m)):(this._segList.addPt(m),this._segList.addPt(g))},Rn.prototype.computeOffsetSegment=function(t,e,n,r){var i=e===Se.LEFT?1:-1,o=t.p1.x-t.p0.x,s=t.p1.y-t.p0.y,a=Math.sqrt(o*o+s*s),l=i*n*o/a,u=i*n*s/a;r.p0.x=t.p0.x-u,r.p0.y=t.p0.y+l,r.p1.x=t.p1.x-u,r.p1.y=t.p1.y+l},Rn.prototype.addFilletArc=function(t,e,n,r,i){var o=r===at.CLOCKWISE?-1:1,s=Math.abs(e-n),a=Math.trunc(s/this._filletAngleQuantum+.5);if(a<1)return null;for(var l=s/a,u=0,c=new E;u<s;){var h=e+o*u;c.x=t.x+i*Math.cos(h),c.y=t.y+i*Math.sin(h),this._segList.addPt(c),u+=l}},Rn.prototype.addInsideTurn=function(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Rn.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var n=new E((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(n);var r=new E((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(r)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},Rn.prototype.createCircle=function(t){var e=new E(t.x+this._distance,t.y);this._segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},Rn.prototype.addBevelJoin=function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)},Rn.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Mn,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*Rn.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},Rn.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===En.JOIN_BEVEL||this._bufParams.getJoinStyle()===En.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,at.CLOCKWISE,this._distance))},Rn.prototype.closeRing=function(){this._segList.closeRing()},Rn.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},Rn.prototype.interfaces_=function(){return[]},Rn.prototype.getClass=function(){return Rn},Ln.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001},Ln.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001},Ln.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},Ln.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(Rn,Ln);var kn=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e};kn.prototype.getOffsetCurve=function(t,e){if(this._distance=e,0===e)return null;var n=e<0,r=Math.abs(e),i=this.getSegGen(r);t.length<=1?this.computePointCurve(t[0],i):this.computeOffsetCurve(t,n,i);var o=i.getCoordinates();return n&&Tt.reverse(o),o},kn.prototype.computeSingleSidedBufferCurve=function(t,e,n){var r=this.simplifyTolerance(this._distance);if(e){n.addSegments(t,!0);var i=Tn.simplify(t,-r),o=i.length-1;n.initSideSegments(i[o],i[o-1],Se.LEFT),n.addFirstSegment();for(var s=o-2;s>=0;s--)n.addNextSegment(i[s],!0)}else{n.addSegments(t,!1);var a=Tn.simplify(t,r),l=a.length-1;n.initSideSegments(a[0],a[1],Se.LEFT),n.addFirstSegment();for(var u=2;u<=l;u++)n.addNextSegment(a[u],!0)}n.addLastSegment(),n.closeRing()},kn.prototype.computeRingBufferCurve=function(t,e,n){var r=this.simplifyTolerance(this._distance);e===Se.RIGHT&&(r=-r);var i=Tn.simplify(t,r),o=i.length-1;n.initSideSegments(i[o-1],i[0],e);for(var s=1;s<=o;s++){var a=1!==s;n.addNextSegment(i[s],a)}n.closeRing()},kn.prototype.computeLineBufferCurve=function(t,e){var n=this.simplifyTolerance(this._distance),r=Tn.simplify(t,n),i=r.length-1;e.initSideSegments(r[0],r[1],Se.LEFT);for(var o=2;o<=i;o++)e.addNextSegment(r[o],!0);e.addLastSegment(),e.addLineEndCap(r[i-1],r[i]);var s=Tn.simplify(t,-n),a=s.length-1;e.initSideSegments(s[a],s[a-1],Se.LEFT);for(var l=a-2;l>=0;l--)e.addNextSegment(s[l],!0);e.addLastSegment(),e.addLineEndCap(s[1],s[0]),e.closeRing()},kn.prototype.computePointCurve=function(t,e){switch(this._bufParams.getEndCapStyle()){case En.CAP_ROUND:e.createCircle(t);break;case En.CAP_SQUARE:e.createSquare(t)}},kn.prototype.getLineCurve=function(t,e){if(this._distance=e,e<0&&!this._bufParams.isSingleSided())return null;if(0===e)return null;var n=Math.abs(e),r=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],r);else if(this._bufParams.isSingleSided()){var i=e<0;this.computeSingleSidedBufferCurve(t,i,r)}else this.computeLineBufferCurve(t,r);return r.getCoordinates()},kn.prototype.getBufferParameters=function(){return this._bufParams},kn.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()},kn.prototype.getRingCurve=function(t,e,n){if(this._distance=n,t.length<=2)return this.getLineCurve(t,n);if(0===n)return kn.copyCoordinates(t);var r=this.getSegGen(n);return this.computeRingBufferCurve(t,e,r),r.getCoordinates()},kn.prototype.computeOffsetCurve=function(t,e,n){var r=this.simplifyTolerance(this._distance);if(e){var i=Tn.simplify(t,-r),o=i.length-1;n.initSideSegments(i[o],i[o-1],Se.LEFT),n.addFirstSegment();for(var s=o-2;s>=0;s--)n.addNextSegment(i[s],!0)}else{var a=Tn.simplify(t,r),l=a.length-1;n.initSideSegments(a[0],a[1],Se.LEFT),n.addFirstSegment();for(var u=2;u<=l;u++)n.addNextSegment(a[u],!0)}n.addLastSegment()},kn.prototype.getSegGen=function(t){return new Rn(this._precisionModel,this._bufParams,t)},kn.prototype.interfaces_=function(){return[]},kn.prototype.getClass=function(){return kn},kn.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),n=0;n<e.length;n++)e[n]=new E(t[n]);return e};var Dn=function(){this._subgraphs=null,this._seg=new gn,this._cga=new at;var t=arguments[0];this._subgraphs=t},Nn={DepthSegment:{configurable:!0}};Dn.prototype.findStabbedSegments=function(){if(1===arguments.length){for(var t=arguments[0],e=new wt,n=this._subgraphs.iterator();n.hasNext();){var r=n.next(),i=r.getEnvelope();t.y<i.getMinY()||t.y>i.getMaxY()||this.findStabbedSegments(t,r.getDirectedEdges(),e)}return e}if(3===arguments.length)if(I(arguments[2],xt)&&arguments[0]instanceof E&&arguments[1]instanceof Ve){for(var o=arguments[0],s=arguments[1],a=arguments[2],l=s.getEdge().getCoordinates(),u=0;u<l.length-1;u++)if(this._seg.p0=l[u],this._seg.p1=l[u+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<o.x||this._seg.isHorizontal()||o.y<this._seg.p0.y||o.y>this._seg.p1.y||at.computeOrientation(this._seg.p0,this._seg.p1,o)===at.RIGHT)){var c=s.getDepth(Se.LEFT);this._seg.p0.equals(l[u])||(c=s.getDepth(Se.RIGHT));var h=new Fn(this._seg,c);a.add(h)}}else if(I(arguments[2],xt)&&arguments[0]instanceof E&&I(arguments[1],xt))for(var p=arguments[0],f=arguments[2],d=arguments[1].iterator();d.hasNext();){var g=d.next();g.isForward()&&this.findStabbedSegments(p,g,f)}},Dn.prototype.getDepth=function(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:Je.min(e)._leftDepth},Dn.prototype.interfaces_=function(){return[]},Dn.prototype.getClass=function(){return Dn},Nn.DepthSegment.get=function(){return Fn},Object.defineProperties(Dn,Nn);var Fn=function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],e=arguments[1];this._upwardSeg=new gn(t),this._leftDepth=e};Fn.prototype.compareTo=function(t){var e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var n=this._upwardSeg.orientationIndex(e._upwardSeg);return 0!==n||0!=(n=-1*e._upwardSeg.orientationIndex(this._upwardSeg))?n:this._upwardSeg.compareTo(e._upwardSeg)},Fn.prototype.compareX=function(t,e){var n=t.p0.compareTo(e.p0);return 0!==n?n:t.p1.compareTo(e.p1)},Fn.prototype.toString=function(){return this._upwardSeg.toString()},Fn.prototype.interfaces_=function(){return[b]},Fn.prototype.getClass=function(){return Fn};var Bn=function(t,e,n){this.p0=t||null,this.p1=e||null,this.p2=n||null};Bn.prototype.area=function(){return Bn.area(this.p0,this.p1,this.p2)},Bn.prototype.signedArea=function(){return Bn.signedArea(this.p0,this.p1,this.p2)},Bn.prototype.interpolateZ=function(t){if(null===t)throw new y("Supplied point is null.");return Bn.interpolateZ(t,this.p0,this.p1,this.p2)},Bn.prototype.longestSideLength=function(){return Bn.longestSideLength(this.p0,this.p1,this.p2)},Bn.prototype.isAcute=function(){return Bn.isAcute(this.p0,this.p1,this.p2)},Bn.prototype.circumcentre=function(){return Bn.circumcentre(this.p0,this.p1,this.p2)},Bn.prototype.area3D=function(){return Bn.area3D(this.p0,this.p1,this.p2)},Bn.prototype.centroid=function(){return Bn.centroid(this.p0,this.p1,this.p2)},Bn.prototype.inCentre=function(){return Bn.inCentre(this.p0,this.p1,this.p2)},Bn.prototype.interfaces_=function(){return[]},Bn.prototype.getClass=function(){return Bn},Bn.area=function(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)},Bn.signedArea=function(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2},Bn.det=function(t,e,n,r){return t*r-e*n},Bn.interpolateZ=function(t,e,n,r){var i=e.x,o=e.y,s=n.x-i,a=r.x-i,l=n.y-o,u=r.y-o,c=s*u-a*l,h=t.x-i,p=t.y-o,f=(u*h-a*p)/c,d=(-l*h+s*p)/c;return e.z+f*(n.z-e.z)+d*(r.z-e.z)},Bn.longestSideLength=function(t,e,n){var r=t.distance(e),i=e.distance(n),o=n.distance(t),s=r;return i>s&&(s=i),o>s&&(s=o),s},Bn.isAcute=function(t,e,n){return!!In.isAcute(t,e,n)&&!!In.isAcute(e,n,t)&&!!In.isAcute(n,t,e)},Bn.circumcentre=function(t,e,n){var r=n.x,i=n.y,o=t.x-r,s=t.y-i,a=e.x-r,l=e.y-i,u=2*Bn.det(o,s,a,l),c=Bn.det(s,o*o+s*s,l,a*a+l*l),h=Bn.det(o,o*o+s*s,a,a*a+l*l);return new E(r-c/u,i+h/u)},Bn.perpendicularBisector=function(t,e){var n=e.x-t.x,r=e.y-t.y,i=new q(t.x+n/2,t.y+r/2,1),o=new q(t.x-r+n/2,t.y+n+r/2,1);return new q(i,o)},Bn.angleBisector=function(t,e,n){var r=e.distance(t),i=r/(r+e.distance(n)),o=n.x-t.x,s=n.y-t.y;return new E(t.x+i*o,t.y+i*s)},Bn.area3D=function(t,e,n){var r=e.x-t.x,i=e.y-t.y,o=e.z-t.z,s=n.x-t.x,a=n.y-t.y,l=n.z-t.z,u=i*l-o*a,c=o*s-r*l,h=r*a-i*s,p=u*u+c*c+h*h;return Math.sqrt(p)/2},Bn.centroid=function(t,e,n){var r=(t.x+e.x+n.x)/3,i=(t.y+e.y+n.y)/3;return new E(r,i)},Bn.inCentre=function(t,e,n){var r=e.distance(n),i=t.distance(n),o=t.distance(e),s=r+i+o,a=(r*t.x+i*e.x+o*n.x)/s,l=(r*t.y+i*e.y+o*n.y)/s;return new E(a,l)};var zn=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new wt;var t=arguments[0],e=arguments[1],n=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=n};zn.prototype.addPoint=function(t){if(this._distance<=0)return null;var e=t.getCoordinates(),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,M.EXTERIOR,M.INTERIOR)},zn.prototype.addPolygon=function(t){var e=this._distance,n=Se.LEFT;this._distance<0&&(e=-this._distance,n=Se.RIGHT);var r=t.getExteriorRing(),i=Tt.removeRepeatedPoints(r.getCoordinates());if(this._distance<0&&this.isErodedCompletely(r,this._distance))return null;if(this._distance<=0&&i.length<3)return null;this.addPolygonRing(i,e,n,M.EXTERIOR,M.INTERIOR);for(var o=0;o<t.getNumInteriorRing();o++){var s=t.getInteriorRingN(o),a=Tt.removeRepeatedPoints(s.getCoordinates());this._distance>0&&this.isErodedCompletely(s,-this._distance)||this.addPolygonRing(a,e,Se.opposite(n),M.INTERIOR,M.EXTERIOR)}},zn.prototype.isTriangleErodedCompletely=function(t,e){var n=new Bn(t[0],t[1],t[2]),r=n.inCentre();return at.distancePointLine(r,n.p0,n.p1)<Math.abs(e)},zn.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var e=Tt.removeRepeatedPoints(t.getCoordinates()),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,M.EXTERIOR,M.INTERIOR)},zn.prototype.addCurve=function(t,e,n){if(null===t||t.length<2)return null;var r=new dn(t,new Re(0,M.BOUNDARY,e,n));this._curveList.add(r)},zn.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},zn.prototype.addPolygonRing=function(t,e,n,r,i){if(0===e&&t.length<ee.MINIMUM_VALID_SIZE)return null;var o=r,s=i;t.length>=ee.MINIMUM_VALID_SIZE&&at.isCCW(t)&&(o=i,s=r,n=Se.opposite(n));var a=this._curveBuilder.getRingCurve(t,n,e);this.addCurve(a,o,s)},zn.prototype.add=function(t){if(t.isEmpty())return null;t instanceof Jt?this.addPolygon(t):t instanceof $t?this.addLineString(t):t instanceof Qt?this.addPoint(t):(t instanceof te||t instanceof Gt||t instanceof ne||t instanceof Vt)&&this.addCollection(t)},zn.prototype.isErodedCompletely=function(t,e){var n=t.getCoordinates();if(n.length<4)return e<0;if(4===n.length)return this.isTriangleErodedCompletely(n,e);var r=t.getEnvelopeInternal(),i=Math.min(r.getHeight(),r.getWidth());return e<0&&2*Math.abs(e)>i},zn.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},zn.prototype.interfaces_=function(){return[]},zn.prototype.getClass=function(){return zn};var jn=function(){};jn.prototype.locate=function(t){},jn.prototype.interfaces_=function(){return[]},jn.prototype.getClass=function(){return jn};var Un=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};Un.prototype.next=function(){if(this._atStart)return this._atStart=!1,Un.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new r;var t=this._parent.getGeometryN(this._index++);return t instanceof Vt?(this._subcollectionIterator=new Un(t),this._subcollectionIterator.next()):t},Un.prototype.remove=function(){throw new Error(this.getClass().getName())},Un.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},Un.prototype.interfaces_=function(){return[bt]},Un.prototype.getClass=function(){return Un},Un.isAtomic=function(t){return!(t instanceof Vt)};var Vn=function(){this._geom=null;var t=arguments[0];this._geom=t};Vn.prototype.locate=function(t){return Vn.locate(t,this._geom)},Vn.prototype.interfaces_=function(){return[jn]},Vn.prototype.getClass=function(){return Vn},Vn.isPointInRing=function(t,e){return!!e.getEnvelopeInternal().intersects(t)&&at.isPointInRing(t,e.getCoordinates())},Vn.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var n=e.getExteriorRing();if(!Vn.isPointInRing(t,n))return!1;for(var r=0;r<e.getNumInteriorRing();r++){var i=e.getInteriorRingN(r);if(Vn.isPointInRing(t,i))return!1}return!0},Vn.containsPoint=function(t,e){if(e instanceof Jt)return Vn.containsPointInPolygon(t,e);if(e instanceof Vt)for(var n=new Un(e);n.hasNext();){var r=n.next();if(r!==e&&Vn.containsPoint(t,r))return!0}return!1},Vn.locate=function(t,e){return e.isEmpty()?M.EXTERIOR:Vn.containsPoint(t,e)?M.INTERIOR:M.EXTERIOR};var Gn=function(){this._edgeMap=new h,this._edgeList=null,this._ptInAreaLocation=[M.NONE,M.NONE]};Gn.prototype.getNextCW=function(t){this.getEdges();var e=this._edgeList.indexOf(t),n=e-1;return 0===e&&(n=this._edgeList.size()-1),this._edgeList.get(n)},Gn.prototype.propagateSideLabels=function(t){for(var e=M.NONE,n=this.iterator();n.hasNext();){var r=n.next().getLabel();r.isArea(t)&&r.getLocation(t,Se.LEFT)!==M.NONE&&(e=r.getLocation(t,Se.LEFT))}if(e===M.NONE)return null;for(var i=e,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getLabel();if(a.getLocation(t,Se.ON)===M.NONE&&a.setLocation(t,Se.ON,i),a.isArea(t)){var l=a.getLocation(t,Se.LEFT),u=a.getLocation(t,Se.RIGHT);if(u!==M.NONE){if(u!==i)throw new Me("side location conflict",s.getCoordinate());l===M.NONE&&et.shouldNeverReachHere("found single null side (at "+s.getCoordinate()+")"),i=l}else et.isTrue(a.getLocation(t,Se.LEFT)===M.NONE,"found single null side"),a.setLocation(t,Se.RIGHT,i),a.setLocation(t,Se.LEFT,i)}}},Gn.prototype.getCoordinate=function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},Gn.prototype.print=function(t){Z.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();)e.next().print(t)},Gn.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},Gn.prototype.checkAreaLabelsConsistent=function(t){var e=this.getEdges();if(e.size()<=0)return!0;var n=e.size()-1,r=e.get(n).getLabel().getLocation(t,Se.LEFT);et.isTrue(r!==M.NONE,"Found unlabelled area edge");for(var i=r,o=this.iterator();o.hasNext();){var s=o.next().getLabel();et.isTrue(s.isArea(t),"Found non-area edge");var a=s.getLocation(t,Se.LEFT),l=s.getLocation(t,Se.RIGHT);if(a===l)return!1;if(l!==i)return!1;i=a}return!0},Gn.prototype.findIndex=function(t){this.iterator();for(var e=0;e<this._edgeList.size();e++)if(this._edgeList.get(e)===t)return e;return-1},Gn.prototype.iterator=function(){return this.getEdges().iterator()},Gn.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new wt(this._edgeMap.values())),this._edgeList},Gn.prototype.getLocation=function(t,e,n){return this._ptInAreaLocation[t]===M.NONE&&(this._ptInAreaLocation[t]=Vn.locate(e,n[t].getGeometry())),this._ptInAreaLocation[t]},Gn.prototype.toString=function(){var t=new L;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var n=e.next();t.append(n),t.append("\n")}return t.toString()},Gn.prototype.computeEdgeEndLabels=function(t){for(var e=this.iterator();e.hasNext();)e.next().computeLabel(t)},Gn.prototype.computeLabelling=function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],n=this.iterator();n.hasNext();)for(var r=n.next().getLabel(),i=0;i<2;i++)r.isLine(i)&&r.getLocation(i)===M.BOUNDARY&&(e[i]=!0);for(var o=this.iterator();o.hasNext();)for(var s=o.next(),a=s.getLabel(),l=0;l<2;l++)if(a.isAnyNull(l)){var u=M.NONE;if(e[l])u=M.EXTERIOR;else{var c=s.getCoordinate();u=this.getLocation(l,c,t)}a.setAllLocationsIfNull(l,u)}},Gn.prototype.getDegree=function(){return this._edgeMap.size()},Gn.prototype.insertEdgeEnd=function(t,e){this._edgeMap.put(t,e),this._edgeList=null},Gn.prototype.interfaces_=function(){return[]},Gn.prototype.getClass=function(){return Gn};var Zn=function(t){function e(){t.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var t=null,e=null,n=this._SCANNING_FOR_INCOMING,r=0;r<this._resultAreaEdgeList.size();r++){var i=this._resultAreaEdgeList.get(r),o=i.getSym();if(i.getLabel().isArea())switch(null===t&&i.isInResult()&&(t=i),n){case this._SCANNING_FOR_INCOMING:if(!o.isInResult())continue;e=o,n=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!i.isInResult())continue;e.setNext(i),n=this._SCANNING_FOR_INCOMING}}if(n===this._LINKING_TO_OUTGOING){if(null===t)throw new Me("no outgoing dirEdge found",this.getCoordinate());et.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}},e.prototype.insert=function(t){var e=t;this.insertEdgeEnd(e,e)},e.prototype.getRightmostEdge=function(){var t=this.getEdges(),e=t.size();if(e<1)return null;var n=t.get(0);if(1===e)return n;var r=t.get(e-1),i=n.getQuadrant(),o=r.getQuadrant();return ze.isNorthern(i)&&ze.isNorthern(o)?n:ze.isNorthern(i)||ze.isNorthern(o)?0!==n.getDy()?n:0!==r.getDy()?r:(et.shouldNeverReachHere("found two horizontal edges incident on node"),null):r},e.prototype.print=function(t){Z.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var n=e.next();t.print("out "),n.print(t),t.println(),t.print("in "),n.getSym().print(t),t.println()}},e.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new wt;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}return this._resultAreaEdgeList},e.prototype.updateLabelling=function(t){for(var e=this.iterator();e.hasNext();){var n=e.next().getLabel();n.setAllLocationsIfNull(0,t.getLocation(0)),n.setAllLocationsIfNull(1,t.getLocation(1))}},e.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var t=null,e=null,n=this._edgeList.size()-1;n>=0;n--){var r=this._edgeList.get(n),i=r.getSym();null===e&&(e=i),null!==t&&i.setNext(t),t=r}e.setNext(t)},e.prototype.computeDepths=function(){if(1===arguments.length){var t=arguments[0],e=this.findIndex(t),n=t.getDepth(Se.LEFT),r=t.getDepth(Se.RIGHT),i=this.computeDepths(e+1,this._edgeList.size(),n);if(this.computeDepths(0,e,i)!==r)throw new Me("depth mismatch at "+t.getCoordinate())}else if(3===arguments.length){for(var o=arguments[1],s=arguments[2],a=arguments[0];a<o;a++){var l=this._edgeList.get(a);l.setEdgeDepths(Se.RIGHT,s),s=l.getDepth(Se.LEFT)}return s}},e.prototype.mergeSymLabels=function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}},e.prototype.linkMinimalDirectedEdges=function(t){for(var e=null,n=null,r=this._SCANNING_FOR_INCOMING,i=this._resultAreaEdgeList.size()-1;i>=0;i--){var o=this._resultAreaEdgeList.get(i),s=o.getSym();switch(null===e&&o.getEdgeRing()===t&&(e=o),r){case this._SCANNING_FOR_INCOMING:if(s.getEdgeRing()!==t)continue;n=s,r=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(o.getEdgeRing()!==t)continue;n.setNextMin(o),r=this._SCANNING_FOR_INCOMING}}r===this._LINKING_TO_OUTGOING&&(et.isTrue(null!==e,"found null for first outgoing dirEdge"),et.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(e))},e.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();)e.next().isInResult()&&t++;return t}if(1===arguments.length){for(var n=arguments[0],r=0,i=this.iterator();i.hasNext();)i.next().getEdgeRing()===n&&r++;return r}},e.prototype.getLabel=function(){return this._label},e.prototype.findCoveredLineEdges=function(){for(var t=M.NONE,e=this.iterator();e.hasNext();){var n=e.next(),r=n.getSym();if(!n.isLineEdge()){if(n.isInResult()){t=M.INTERIOR;break}if(r.isInResult()){t=M.EXTERIOR;break}}}if(t===M.NONE)return null;for(var i=t,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getSym();s.isLineEdge()?s.getEdge().setCovered(i===M.INTERIOR):(s.isInResult()&&(i=M.EXTERIOR),a.isInResult()&&(i=M.INTERIOR))}},e.prototype.computeLabelling=function(e){t.prototype.computeLabelling.call(this,e),this._label=new Re(M.NONE);for(var n=this.iterator();n.hasNext();)for(var r=n.next().getEdge().getLabel(),i=0;i<2;i++){var o=r.getLocation(i);o!==M.INTERIOR&&o!==M.BOUNDARY||this._label.setLocation(i,M.INTERIOR)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Gn),qn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createNode=function(t){return new Fe(t,new Zn)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ge),Wn=function t(){this._pts=null,this._orientation=null;var e=arguments[0];this._pts=e,this._orientation=t.orientation(e)};Wn.prototype.compareTo=function(t){var e=t;return Wn.compareOriented(this._pts,this._orientation,e._pts,e._orientation)},Wn.prototype.interfaces_=function(){return[b]},Wn.prototype.getClass=function(){return Wn},Wn.orientation=function(t){return 1===Tt.increasingDirection(t)},Wn.compareOriented=function(t,e,n,r){for(var i=e?1:-1,o=r?1:-1,s=e?t.length:-1,a=r?n.length:-1,l=e?0:t.length-1,u=r?0:n.length-1;;){var c=t[l].compareTo(n[u]);if(0!==c)return c;var h=(l+=i)===s,p=(u+=o)===a;if(h&&!p)return-1;if(!h&&p)return 1;if(h&&p)return 0}};var Hn=function(){this._edges=new wt,this._ocaMap=new h};Hn.prototype.print=function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this._edges.size();e++){var n=this._edges.get(e);e>0&&t.print(","),t.print("(");for(var r=n.getCoordinates(),i=0;i<r.length;i++)i>0&&t.print(","),t.print(r[i].x+" "+r[i].y);t.println(")")}t.print(")  ")},Hn.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},Hn.prototype.findEdgeIndex=function(t){for(var e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1},Hn.prototype.iterator=function(){return this._edges.iterator()},Hn.prototype.getEdges=function(){return this._edges},Hn.prototype.get=function(t){return this._edges.get(t)},Hn.prototype.findEqualEdge=function(t){var e=new Wn(t.getCoordinates());return this._ocaMap.get(e)},Hn.prototype.add=function(t){this._edges.add(t);var e=new Wn(t.getCoordinates());this._ocaMap.put(e,t)},Hn.prototype.interfaces_=function(){return[]},Hn.prototype.getClass=function(){return Hn};var Xn=function(){};Xn.prototype.processIntersections=function(t,e,n,r){},Xn.prototype.isDone=function(){},Xn.prototype.interfaces_=function(){return[]},Xn.prototype.getClass=function(){return Xn};var $n=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t};$n.prototype.isTrivialIntersection=function(t,e,n,r){if(t===n&&1===this._li.getIntersectionNum()){if($n.isAdjacentSegments(e,r))return!0;if(t.isClosed()){var i=t.size()-1;if(0===e&&r===i||0===r&&e===i)return!0}}return!1},$n.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},$n.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},$n.prototype.getLineIntersector=function(){return this._li},$n.prototype.hasProperIntersection=function(){return this._hasProper},$n.prototype.processIntersections=function(t,e,n,r){if(t===n&&e===r)return null;this.numTests++;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[r],a=n.getCoordinates()[r+1];this._li.computeIntersection(i,o,s,a),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,n,r)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),n.addIntersections(this._li,r,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},$n.prototype.hasIntersection=function(){return this._hasIntersection},$n.prototype.isDone=function(){return!1},$n.prototype.hasInteriorIntersection=function(){return this._hasInterior},$n.prototype.interfaces_=function(){return[Xn]},$n.prototype.getClass=function(){return $n},$n.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var Yn=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.coord=new E(t),this.segmentIndex=e,this.dist=n};Yn.prototype.getSegmentIndex=function(){return this.segmentIndex},Yn.prototype.getCoordinate=function(){return this.coord},Yn.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)},Yn.prototype.compareTo=function(t){var e=t;return this.compare(e.segmentIndex,e.dist)},Yn.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t},Yn.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},Yn.prototype.getDistance=function(){return this.dist},Yn.prototype.compare=function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0},Yn.prototype.interfaces_=function(){return[b]},Yn.prototype.getClass=function(){return Yn};var Qn=function(){this._nodeMap=new h,this.edge=null;var t=arguments[0];this.edge=t};Qn.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},Qn.prototype.iterator=function(){return this._nodeMap.values().iterator()},Qn.prototype.addSplitEdges=function(t){this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var r=e.next(),i=this.createSplitEdge(n,r);t.add(i),n=r}},Qn.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},Qn.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,r=this.edge.pts[e.segmentIndex],i=e.dist>0||!e.coord.equals2D(r);i||n--;var o=new Array(n).fill(null),s=0;o[s++]=new E(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this.edge.pts[a];return i&&(o[s]=e.coord),new nr(o,new Re(this.edge._label))},Qn.prototype.add=function(t,e,n){var r=new Yn(t,e,n),i=this._nodeMap.get(r);return null!==i?i:(this._nodeMap.put(r,r),r)},Qn.prototype.isIntersection=function(t){for(var e=this.iterator();e.hasNext();)if(e.next().coord.equals(t))return!0;return!1},Qn.prototype.interfaces_=function(){return[]},Qn.prototype.getClass=function(){return Qn};var Kn=function(){};Kn.prototype.getChainStartIndices=function(t){var e=0,n=new wt;n.add(new k(e));do{var r=this.findChainEnd(t,e);n.add(new k(r)),e=r}while(e<t.length-1);return Kn.toIntArray(n)},Kn.prototype.findChainEnd=function(t,e){for(var n=ze.quadrant(t[e],t[e+1]),r=e+1;r<t.length&&ze.quadrant(t[r-1],t[r])===n;)r++;return r-1},Kn.prototype.interfaces_=function(){return[]},Kn.prototype.getClass=function(){return Kn},Kn.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var Jn=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new W,this.env2=new W;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new Kn;this.startIndex=e.getChainStartIndices(this.pts)};Jn.prototype.getCoordinates=function(){return this.pts},Jn.prototype.getMaxX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e>n?e:n},Jn.prototype.getMinX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e<n?e:n},Jn.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],r)}else if(6===arguments.length){var i=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3],l=arguments[4],u=arguments[5],c=this.pts[i],h=this.pts[o],p=s.pts[a],f=s.pts[l];if(o-i==1&&l-a==1)return u.addIntersections(this.e,i,s.e,a),null;if(this.env1.init(c,h),this.env2.init(p,f),!this.env1.intersects(this.env2))return null;var d=Math.trunc((i+o)/2),g=Math.trunc((a+l)/2);i<d&&(a<g&&this.computeIntersectsForChain(i,d,s,a,g,u),g<l&&this.computeIntersectsForChain(i,d,s,g,l,u)),d<o&&(a<g&&this.computeIntersectsForChain(d,o,s,a,g,u),g<l&&this.computeIntersectsForChain(d,o,s,g,l,u))}},Jn.prototype.getStartIndexes=function(){return this.startIndex},Jn.prototype.computeIntersects=function(t,e){for(var n=0;n<this.startIndex.length-1;n++)for(var r=0;r<t.startIndex.length-1;r++)this.computeIntersectsForChain(n,t,r,e)},Jn.prototype.interfaces_=function(){return[]},Jn.prototype.getClass=function(){return Jn};var tr=function t(){this._depth=Array(2).fill().map((function(){return Array(3)}));for(var e=0;e<2;e++)for(var n=0;n<3;n++)this._depth[e][n]=t.NULL_VALUE},er={NULL_VALUE:{configurable:!0}};tr.prototype.getDepth=function(t,e){return this._depth[t][e]},tr.prototype.setDepth=function(t,e,n){this._depth[t][e]=n},tr.prototype.isNull=function(){if(0===arguments.length){for(var t=0;t<2;t++)for(var e=0;e<3;e++)if(this._depth[t][e]!==tr.NULL_VALUE)return!1;return!0}if(1===arguments.length){var n=arguments[0];return this._depth[n][1]===tr.NULL_VALUE}if(2===arguments.length){var r=arguments[0],i=arguments[1];return this._depth[r][i]===tr.NULL_VALUE}},tr.prototype.normalize=function(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(var n=1;n<3;n++){var r=0;this._depth[t][n]>e&&(r=1),this._depth[t][n]=r}}},tr.prototype.getDelta=function(t){return this._depth[t][Se.RIGHT]-this._depth[t][Se.LEFT]},tr.prototype.getLocation=function(t,e){return this._depth[t][e]<=0?M.EXTERIOR:M.INTERIOR},tr.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},tr.prototype.add=function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<2;e++)for(var n=1;n<3;n++){var r=t.getLocation(e,n);r!==M.EXTERIOR&&r!==M.INTERIOR||(this.isNull(e,n)?this._depth[e][n]=tr.depthAtLocation(r):this._depth[e][n]+=tr.depthAtLocation(r))}else if(3===arguments.length){var i=arguments[0],o=arguments[1];arguments[2]===M.INTERIOR&&this._depth[i][o]++}},tr.prototype.interfaces_=function(){return[]},tr.prototype.getClass=function(){return tr},tr.depthAtLocation=function(t){return t===M.EXTERIOR?0:t===M.INTERIOR?1:tr.NULL_VALUE},er.NULL_VALUE.get=function(){return-1},Object.defineProperties(tr,er);var nr=function(t){function e(){if(t.call(this),this.pts=null,this._env=null,this.eiList=new Qn(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new tr,this._depthDelta=0,1===arguments.length){var n=arguments[0];e.call(this,n,null)}else if(2===arguments.length){var r=arguments[0],i=arguments[1];this.pts=r,this._label=i}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDepth=function(){return this._depth},e.prototype.getCollapsedEdge=function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new e(t,Re.toLineLabel(this._label))},e.prototype.isIsolated=function(){return this._isIsolated},e.prototype.getCoordinates=function(){return this.pts},e.prototype.setIsolated=function(t){this._isIsolated=t},e.prototype.setName=function(t){this._name=t},e.prototype.equals=function(t){if(!(t instanceof e))return!1;var n=t;if(this.pts.length!==n.pts.length)return!1;for(var r=!0,i=!0,o=this.pts.length,s=0;s<this.pts.length;s++)if(this.pts[s].equals2D(n.pts[s])||(r=!1),this.pts[s].equals2D(n.pts[--o])||(i=!1),!r&&!i)return!1;return!0},e.prototype.getCoordinate=function(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){var t=arguments[0];return this.pts[t]}},e.prototype.print=function(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)},e.prototype.computeIM=function(t){e.updateIM(this._label,t)},e.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},e.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},e.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},e.prototype.getDepthDelta=function(){return this._depthDelta},e.prototype.getNumPoints=function(){return this.pts.length},e.prototype.printReverse=function(t){t.print("edge "+this._name+": ");for(var e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")},e.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new Jn(this)),this._mce},e.prototype.getEnvelope=function(){if(null===this._env){this._env=new W;for(var t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env},e.prototype.addIntersection=function(t,e,n,r){var i=new E(t.getIntersection(r)),o=e,s=t.getEdgeDistance(n,r),a=o+1;if(a<this.pts.length){var l=this.pts[a];i.equals2D(l)&&(o=a,s=0)}this.eiList.add(i,o,s)},e.prototype.toString=function(){var t=new L;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()},e.prototype.isPointwiseEqual=function(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0},e.prototype.setDepthDelta=function(t){this._depthDelta=t},e.prototype.getEdgeIntersectionList=function(){return this.eiList},e.prototype.addIntersections=function(t,e,n){for(var r=0;r<t.getIntersectionNum();r++)this.addIntersection(t,e,n,r)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.updateIM=function(){if(2!==arguments.length)return t.prototype.updateIM.apply(this,arguments);var e=arguments[0],n=arguments[1];n.setAtLeastIfValid(e.getLocation(0,Se.ON),e.getLocation(1,Se.ON),1),e.isArea()&&(n.setAtLeastIfValid(e.getLocation(0,Se.LEFT),e.getLocation(1,Se.LEFT),2),n.setAtLeastIfValid(e.getLocation(0,Se.RIGHT),e.getLocation(1,Se.RIGHT),2))},e}(Ne),rr=function(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Hn,this._bufParams=t||null};rr.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t},rr.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),r=t.getLabel();e.isPointwiseEqual(t)||(r=new Re(t.getLabel())).flip(),n.merge(r);var i=rr.depthDelta(r),o=e.getDepthDelta()+i;e.setDepthDelta(o)}else this._edgeList.add(t),t.setDepthDelta(rr.depthDelta(t.getLabel()))},rr.prototype.buildSubgraphs=function(t,e){for(var n=new wt,r=t.iterator();r.hasNext();){var i=r.next(),o=i.getRightmostCoordinate(),s=new Dn(n).getDepth(o);i.computeDepth(s),i.findResultEdges(),n.add(i),e.add(i.getDirectedEdges(),i.getNodes())}},rr.prototype.createSubgraphs=function(t){for(var e=new wt,n=t.getNodes().iterator();n.hasNext();){var r=n.next();if(!r.isVisited()){var i=new Ie;i.create(r),e.add(i)}}return Je.sort(e,Je.reverseOrder()),e},rr.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},rr.prototype.getNoder=function(t){if(null!==this._workingNoder)return this._workingNoder;var e=new xn,n=new it;return n.setPrecisionModel(t),e.setSegmentIntersector(new $n(n)),e},rr.prototype.buffer=function(t,e){var n=this._workingPrecisionModel;null===n&&(n=t.getPrecisionModel()),this._geomFact=t.getFactory();var r=new kn(n,this._bufParams),i=new zn(t,e,r).getCurves();if(i.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(i,n),this._graph=new Ze(new qn),this._graph.addEdges(this._edgeList.getEdges());var o=this.createSubgraphs(this._graph),s=new qe(this._geomFact);this.buildSubgraphs(o,s);var a=s.getPolygons();return a.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(a)},rr.prototype.computeNodedEdges=function(t,e){var n=this.getNoder(e);n.computeNodes(t);for(var r=n.getNodedSubstrings().iterator();r.hasNext();){var i=r.next(),o=i.getCoordinates();if(2!==o.length||!o[0].equals2D(o[1])){var s=i.getData(),a=new nr(i.getCoordinates(),new Re(s));this.insertUniqueEdge(a)}}},rr.prototype.setNoder=function(t){this._workingNoder=t},rr.prototype.interfaces_=function(){return[]},rr.prototype.getClass=function(){return rr},rr.depthDelta=function(t){var e=t.getLocation(0,Se.LEFT),n=t.getLocation(0,Se.RIGHT);return e===M.INTERIOR&&n===M.EXTERIOR?1:e===M.EXTERIOR&&n===M.INTERIOR?-1:0},rr.convertSegStrings=function(t){for(var e=new Ae,n=new wt;t.hasNext();){var r=t.next(),i=e.createLineString(r.getCoordinates());n.add(i)}return e.buildGeometry(n)};var ir=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var t=arguments[0],e=arguments[1];this._noder=t,this._scaleFactor=e,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2],o=arguments[3];this._noder=n,this._scaleFactor=r,this._offsetX=i,this._offsetY=o,this._isScaled=!this.isIntegerPrecision()}};ir.prototype.rescale=function(){if(I(arguments[0],vt))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.rescale(e.getCoordinates())}else if(arguments[0]instanceof Array){for(var n=arguments[0],r=0;r<n.length;r++)n[r].x=n[r].x/this._scaleFactor+this._offsetX,n[r].y=n[r].y/this._scaleFactor+this._offsetY;2===n.length&&n[0].equals2D(n[1])&&Z.out.println(n)}},ir.prototype.scale=function(){if(I(arguments[0],vt)){for(var t=arguments[0],e=new wt,n=t.iterator();n.hasNext();){var r=n.next();e.add(new dn(this.scale(r.getCoordinates()),r.getData()))}return e}if(arguments[0]instanceof Array){for(var i=arguments[0],o=new Array(i.length).fill(null),s=0;s<i.length;s++)o[s]=new E(Math.round((i[s].x-this._offsetX)*this._scaleFactor),Math.round((i[s].y-this._offsetY)*this._scaleFactor),i[s].z);return Tt.removeRepeatedPoints(o)}},ir.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor},ir.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t},ir.prototype.computeNodes=function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)},ir.prototype.interfaces_=function(){return[vn]},ir.prototype.getClass=function(){return ir};var or=function(){this._li=new it,this._segStrings=null;var t=arguments[0];this._segStrings=t},sr={fact:{configurable:!0}};or.prototype.checkEndPtVertexIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this._segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this._segStrings)}else if(2===arguments.length)for(var n=arguments[0],r=arguments[1].iterator();r.hasNext();)for(var i=r.next().getCoordinates(),o=1;o<i.length-1;o++)if(i[o].equals(n))throw new J("found endpt/interior pt intersection at index "+o+" :pt "+n)},or.prototype.checkInteriorIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();)for(var e=t.next(),n=this._segStrings.iterator();n.hasNext();){var r=n.next();this.checkInteriorIntersections(e,r)}else if(2===arguments.length)for(var i=arguments[0],o=arguments[1],s=i.getCoordinates(),a=o.getCoordinates(),l=0;l<s.length-1;l++)for(var u=0;u<a.length-1;u++)this.checkInteriorIntersections(i,l,o,u);else if(4===arguments.length){var c=arguments[0],h=arguments[1],p=arguments[2],f=arguments[3];if(c===p&&h===f)return null;var d=c.getCoordinates()[h],g=c.getCoordinates()[h+1],m=p.getCoordinates()[f],A=p.getCoordinates()[f+1];if(this._li.computeIntersection(d,g,m,A),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,d,g)||this.hasInteriorIntersection(this._li,m,A)))throw new J("found non-noded intersection at "+d+"-"+g+" and "+m+"-"+A)}},or.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},or.prototype.checkCollapses=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(1===arguments.length)for(var n=arguments[0].getCoordinates(),r=0;r<n.length-2;r++)this.checkCollapse(n[r],n[r+1],n[r+2])},or.prototype.hasInteriorIntersection=function(t,e,n){for(var r=0;r<t.getIntersectionNum();r++){var i=t.getIntersection(r);if(!i.equals(e)&&!i.equals(n))return!0}return!1},or.prototype.checkCollapse=function(t,e,n){if(t.equals(n))throw new J("found non-noded collapse at "+or.fact.createLineString([t,e,n]))},or.prototype.interfaces_=function(){return[]},or.prototype.getClass=function(){return or},sr.fact.get=function(){return new Ae},Object.defineProperties(or,sr);var ar=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],e=arguments[1],n=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=n,e<=0)throw new y("Scale factor must be non-zero");1!==e&&(this._pt=new E(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new E,this._p1Scaled=new E),this.initCorners(this._pt)},lr={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};ar.prototype.intersectsScaled=function(t,e){var n=Math.min(t.x,e.x),r=Math.max(t.x,e.x),i=Math.min(t.y,e.y),o=Math.max(t.y,e.y),s=this._maxx<n||this._minx>r||this._maxy<i||this._miny>o;if(s)return!1;var a=this.intersectsToleranceSquare(t,e);return et.isTrue(!(s&&a),"Found bad envelope test"),a},ar.prototype.initCorners=function(t){this._minx=t.x-.5,this._maxx=t.x+.5,this._miny=t.y-.5,this._maxy=t.y+.5,this._corner[0]=new E(this._maxx,this._maxy),this._corner[1]=new E(this._minx,this._maxy),this._corner[2]=new E(this._minx,this._miny),this._corner[3]=new E(this._maxx,this._miny)},ar.prototype.intersects=function(t,e){return 1===this._scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},ar.prototype.scale=function(t){return Math.round(t*this._scaleFactor)},ar.prototype.getCoordinate=function(){return this._originalPt},ar.prototype.copyScaled=function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)},ar.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var t=ar.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new W(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv},ar.prototype.intersectsPixelClosure=function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.hasIntersection()))))},ar.prototype.intersectsToleranceSquare=function(t,e){var n=!1,r=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.isProper()||(this._li.hasIntersection()&&(r=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.isProper()||n&&r||t.equals(this._pt)||e.equals(this._pt)))))},ar.prototype.addSnappedNode=function(t,e){var n=t.getCoordinate(e),r=t.getCoordinate(e+1);return!!this.intersects(n,r)&&(t.addIntersection(this.getCoordinate(),e),!0)},ar.prototype.interfaces_=function(){return[]},ar.prototype.getClass=function(){return ar},lr.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75},Object.defineProperties(ar,lr);var ur=function(){this.tempEnv1=new W,this.selectedSegment=new gn};ur.prototype.select=function(){if(1===arguments.length);else if(2===arguments.length){var t=arguments[1];arguments[0].getLineSegment(t,this.selectedSegment),this.select(this.selectedSegment)}},ur.prototype.interfaces_=function(){return[]},ur.prototype.getClass=function(){return ur};var cr=function(){this._index=null;var t=arguments[0];this._index=t},hr={HotPixelSnapAction:{configurable:!0}};cr.prototype.snap=function(){if(1===arguments.length){var t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){var e=arguments[0],n=arguments[1],r=arguments[2],i=e.getSafeEnvelope(),o=new pr(e,n,r);return this._index.query(i,{interfaces_:function(){return[$e]},visitItem:function(t){t.select(i,o)}}),o.isNodeAdded()}},cr.prototype.interfaces_=function(){return[]},cr.prototype.getClass=function(){return cr},hr.HotPixelSnapAction.get=function(){return pr},Object.defineProperties(cr,hr);var pr=function(t){function e(){t.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var e=arguments[0],n=arguments[1],r=arguments[2];this._hotPixel=e,this._parentEdge=n,this._hotPixelVertexIndex=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isNodeAdded=function(){return this._isNodeAdded},e.prototype.select=function(){if(2!==arguments.length)return t.prototype.select.apply(this,arguments);var e=arguments[1],n=arguments[0].getContext();if(null!==this._parentEdge&&n===this._parentEdge&&e===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(n,e)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(ur),fr=function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new wt};fr.prototype.processIntersections=function(t,e,n,r){if(t===n&&e===r)return null;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[r],a=n.getCoordinates()[r+1];if(this._li.computeIntersection(i,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var l=0;l<this._li.getIntersectionNum();l++)this._interiorIntersections.add(this._li.getIntersection(l));t.addIntersections(this._li,e,0),n.addIntersections(this._li,r,1)}},fr.prototype.isDone=function(){return!1},fr.prototype.getInteriorIntersections=function(){return this._interiorIntersections},fr.prototype.interfaces_=function(){return[Xn]},fr.prototype.getClass=function(){return fr};var dr=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new it,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};dr.prototype.checkCorrectness=function(t){var e=dn.getNodedSubstrings(t),n=new or(e);try{n.checkValid()}catch(t){if(!(t instanceof V))throw t;t.printStackTrace()}},dr.prototype.getNodedSubstrings=function(){return dn.getNodedSubstrings(this._nodedSegStrings)},dr.prototype.snapRound=function(t,e){var n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)},dr.prototype.findInteriorIntersections=function(t,e){var n=new fr(e);return this._noder.setSegmentIntersector(n),this._noder.computeNodes(t),n.getInteriorIntersections()},dr.prototype.computeVertexSnaps=function(){if(I(arguments[0],vt))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.computeVertexSnaps(e)}else if(arguments[0]instanceof dn)for(var n=arguments[0],r=n.getCoordinates(),i=0;i<r.length;i++){var o=new ar(r[i],this._scaleFactor,this._li);this._pointSnapper.snap(o,n,i)&&n.addIntersection(r[i],i)}},dr.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new xn,this._pointSnapper=new cr(this._noder.getIndex()),this.snapRound(t,this._li)},dr.prototype.computeIntersectionSnaps=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),r=new ar(n,this._scaleFactor,this._li);this._pointSnapper.snap(r)}},dr.prototype.interfaces_=function(){return[vn]},dr.prototype.getClass=function(){return dr};var gr=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new En,this._resultGeometry=null,this._saveException=null,1===arguments.length){var t=arguments[0];this._argGeom=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._argGeom=e,this._bufParams=n}},mr={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};gr.prototype.bufferFixedPrecision=function(t){var e=new ir(new dr(new fe(1)),t.getScale()),n=new rr(this._bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this._resultGeometry=n.buffer(this._argGeom,this._distance)},gr.prototype.bufferReducedPrecision=function(){var t=this;if(0===arguments.length){for(var e=gr.MAX_PRECISION_DIGITS;e>=0;e--){try{t.bufferReducedPrecision(e)}catch(e){if(!(e instanceof Me))throw e;t._saveException=e}if(null!==t._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var n=arguments[0],r=gr.precisionScaleFactor(this._argGeom,this._distance,n),i=new fe(r);this.bufferFixedPrecision(i)}},gr.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===fe.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()},gr.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)},gr.prototype.bufferOriginalPrecision=function(){try{var t=new rr(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof J))throw t;this._saveException=t}},gr.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry},gr.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)},gr.prototype.interfaces_=function(){return[]},gr.prototype.getClass=function(){return gr},gr.bufferOp=function(){if(2===arguments.length){var t=arguments[1];return new gr(arguments[0]).getResultGeometry(t)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof ct&&"number"==typeof arguments[1]){var e=arguments[1],n=arguments[2],r=new gr(arguments[0]);return r.setQuadrantSegments(n),r.getResultGeometry(e)}if(arguments[2]instanceof En&&arguments[0]instanceof ct&&"number"==typeof arguments[1]){var i=arguments[1];return new gr(arguments[0],arguments[2]).getResultGeometry(i)}}else if(4===arguments.length){var o=arguments[1],s=arguments[2],a=arguments[3],l=new gr(arguments[0]);return l.setQuadrantSegments(s),l.setEndCapStyle(a),l.getResultGeometry(o)}},gr.precisionScaleFactor=function(t,e,n){var r=t.getEnvelopeInternal(),i=O.max(Math.abs(r.getMaxX()),Math.abs(r.getMaxY()),Math.abs(r.getMinX()),Math.abs(r.getMinY()))+2*(e>0?e:0),o=n-Math.trunc(Math.log(i)/Math.log(10)+1);return Math.pow(10,o)},mr.CAP_ROUND.get=function(){return En.CAP_ROUND},mr.CAP_BUTT.get=function(){return En.CAP_FLAT},mr.CAP_FLAT.get=function(){return En.CAP_FLAT},mr.CAP_SQUARE.get=function(){return En.CAP_SQUARE},mr.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(gr,mr);var Ar=function(){this._pt=[new E,new E],this._distance=_.NaN,this._isNull=!0};Ar.prototype.getCoordinates=function(){return this._pt},Ar.prototype.getCoordinate=function(t){return this._pt[t]},Ar.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var r=e.distance(n);r<this._distance&&this.initialize(e,n,r)}},Ar.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(r),this._distance=i,this._isNull=!1}},Ar.prototype.getDistance=function(){return this._distance},Ar.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var r=e.distance(n);r>this._distance&&this.initialize(e,n,r)}},Ar.prototype.interfaces_=function(){return[]},Ar.prototype.getClass=function(){return Ar};var yr=function(){};yr.prototype.interfaces_=function(){return[]},yr.prototype.getClass=function(){return yr},yr.computeDistance=function(){if(arguments[2]instanceof Ar&&arguments[0]instanceof $t&&arguments[1]instanceof E)for(var t=arguments[1],e=arguments[2],n=arguments[0].getCoordinates(),r=new gn,i=0;i<n.length-1;i++){r.setCoordinates(n[i],n[i+1]);var o=r.closestPoint(t);e.setMinimum(o,t)}else if(arguments[2]instanceof Ar&&arguments[0]instanceof Jt&&arguments[1]instanceof E){var s=arguments[0],a=arguments[1],l=arguments[2];yr.computeDistance(s.getExteriorRing(),a,l);for(var u=0;u<s.getNumInteriorRing();u++)yr.computeDistance(s.getInteriorRingN(u),a,l)}else if(arguments[2]instanceof Ar&&arguments[0]instanceof ct&&arguments[1]instanceof E){var c=arguments[0],h=arguments[1],p=arguments[2];if(c instanceof $t)yr.computeDistance(c,h,p);else if(c instanceof Jt)yr.computeDistance(c,h,p);else if(c instanceof Vt)for(var f=c,d=0;d<f.getNumGeometries();d++){var g=f.getGeometryN(d);yr.computeDistance(g,h,p)}else p.setMinimum(c.getCoordinate(),h)}else if(arguments[2]instanceof Ar&&arguments[0]instanceof gn&&arguments[1]instanceof E){var m=arguments[1],A=arguments[2],y=arguments[0].closestPoint(m);A.setMinimum(y,m)}};var _r=function(t){this._maxPtDist=new Ar,this._inputGeom=t||null},vr={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};_r.prototype.computeMaxMidpointDistance=function(t){var e=new xr(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},_r.prototype.computeMaxVertexDistance=function(t){var e=new br(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},_r.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()},_r.prototype.getDistancePoints=function(){return this._maxPtDist},_r.prototype.interfaces_=function(){return[]},_r.prototype.getClass=function(){return _r},vr.MaxPointDistanceFilter.get=function(){return br},vr.MaxMidpointDistanceFilter.get=function(){return xr},Object.defineProperties(_r,vr);var br=function(t){this._maxPtDist=new Ar,this._minPtDist=new Ar,this._geom=t||null};br.prototype.filter=function(t){this._minPtDist.initialize(),yr.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},br.prototype.getMaxPointDistance=function(){return this._maxPtDist},br.prototype.interfaces_=function(){return[ft]},br.prototype.getClass=function(){return br};var xr=function(t){this._maxPtDist=new Ar,this._minPtDist=new Ar,this._geom=t||null};xr.prototype.filter=function(t,e){if(0===e)return null;var n=t.getCoordinate(e-1),r=t.getCoordinate(e),i=new E((n.x+r.x)/2,(n.y+r.y)/2);this._minPtDist.initialize(),yr.computeDistance(this._geom,i,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},xr.prototype.isDone=function(){return!1},xr.prototype.isGeometryChanged=function(){return!1},xr.prototype.getMaxPointDistance=function(){return this._maxPtDist},xr.prototype.interfaces_=function(){return[Ut]},xr.prototype.getClass=function(){return xr};var wr=function(t){this._comps=t||null};wr.prototype.filter=function(t){t instanceof Jt&&this._comps.add(t)},wr.prototype.interfaces_=function(){return[jt]},wr.prototype.getClass=function(){return wr},wr.getPolygons=function(){if(1===arguments.length){var t=arguments[0];return wr.getPolygons(t,new wt)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof Jt?n.add(e):e instanceof Vt&&e.apply(new wr(n)),n}};var Er=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length){var t=arguments[0];this._lines=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._lines=e,this._isForcedToLineString=n}};Er.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof ee){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof $t&&this._lines.add(t)},Er.prototype.setForceToLineString=function(t){this._isForcedToLineString=t},Er.prototype.interfaces_=function(){return[ut]},Er.prototype.getClass=function(){return Er},Er.getGeometry=function(){if(1===arguments.length){var t=arguments[0];return t.getFactory().buildGeometry(Er.getLines(t))}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().buildGeometry(Er.getLines(e,n))}},Er.getLines=function(){if(1===arguments.length){var t=arguments[0];return Er.getLines(t,!1)}if(2===arguments.length){if(I(arguments[0],vt)&&I(arguments[1],vt)){for(var e=arguments[1],n=arguments[0].iterator();n.hasNext();){var r=n.next();Er.getLines(r,e)}return e}if(arguments[0]instanceof ct&&"boolean"==typeof arguments[1]){var i=arguments[0],o=arguments[1],s=new wt;return i.apply(new Er(s,o)),s}if(arguments[0]instanceof ct&&I(arguments[1],vt)){var a=arguments[0],l=arguments[1];return a instanceof $t?l.add(a):a.apply(new Er(l)),l}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&I(arguments[0],vt)&&I(arguments[1],vt)){for(var u=arguments[1],c=arguments[2],h=arguments[0].iterator();h.hasNext();){var p=h.next();Er.getLines(p,u,c)}return u}if("boolean"==typeof arguments[2]&&arguments[0]instanceof ct&&I(arguments[1],vt)){var f=arguments[1],d=arguments[2];return arguments[0].apply(new Er(f,d)),f}}};var Sr=function(){if(this._boundaryRule=dt.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];if(null===t)throw new y("Rule must be non-null");this._boundaryRule=t}};Sr.prototype.locateInternal=function(){if(arguments[0]instanceof E&&arguments[1]instanceof Jt){var t=arguments[0],e=arguments[1];if(e.isEmpty())return M.EXTERIOR;var n=e.getExteriorRing(),r=this.locateInPolygonRing(t,n);if(r===M.EXTERIOR)return M.EXTERIOR;if(r===M.BOUNDARY)return M.BOUNDARY;for(var i=0;i<e.getNumInteriorRing();i++){var o=e.getInteriorRingN(i),s=this.locateInPolygonRing(t,o);if(s===M.INTERIOR)return M.EXTERIOR;if(s===M.BOUNDARY)return M.BOUNDARY}return M.INTERIOR}if(arguments[0]instanceof E&&arguments[1]instanceof $t){var a=arguments[0],l=arguments[1];if(!l.getEnvelopeInternal().intersects(a))return M.EXTERIOR;var u=l.getCoordinates();return l.isClosed()||!a.equals(u[0])&&!a.equals(u[u.length-1])?at.isOnLine(a,u)?M.INTERIOR:M.EXTERIOR:M.BOUNDARY}if(arguments[0]instanceof E&&arguments[1]instanceof Qt){var c=arguments[0];return arguments[1].getCoordinate().equals2D(c)?M.INTERIOR:M.EXTERIOR}},Sr.prototype.locateInPolygonRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?at.locatePointInRing(t,e.getCoordinates()):M.EXTERIOR},Sr.prototype.intersects=function(t,e){return this.locate(t,e)!==M.EXTERIOR},Sr.prototype.updateLocationInfo=function(t){t===M.INTERIOR&&(this._isIn=!0),t===M.BOUNDARY&&this._numBoundaries++},Sr.prototype.computeLocation=function(t,e){if(e instanceof Qt&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof $t)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof Jt)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof Gt)for(var n=e,r=0;r<n.getNumGeometries();r++){var i=n.getGeometryN(r);this.updateLocationInfo(this.locateInternal(t,i))}else if(e instanceof ne)for(var o=e,s=0;s<o.getNumGeometries();s++){var a=o.getGeometryN(s);this.updateLocationInfo(this.locateInternal(t,a))}else if(e instanceof Vt)for(var l=new Un(e);l.hasNext();){var u=l.next();u!==e&&this.computeLocation(t,u)}},Sr.prototype.locate=function(t,e){return e.isEmpty()?M.EXTERIOR:e instanceof $t||e instanceof Jt?this.locateInternal(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?M.BOUNDARY:this._numBoundaries>0||this._isIn?M.INTERIOR:M.EXTERIOR)},Sr.prototype.interfaces_=function(){return[]},Sr.prototype.getClass=function(){return Sr};var Tr=function t(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length)t.call(this,arguments[0],t.INSIDE_AREA,arguments[1]);else if(3===arguments.length){var e=arguments[0],n=arguments[1],r=arguments[2];this._component=e,this._segIndex=n,this._pt=r}},Pr={INSIDE_AREA:{configurable:!0}};Tr.prototype.isInsideArea=function(){return this._segIndex===Tr.INSIDE_AREA},Tr.prototype.getCoordinate=function(){return this._pt},Tr.prototype.getGeometryComponent=function(){return this._component},Tr.prototype.getSegmentIndex=function(){return this._segIndex},Tr.prototype.interfaces_=function(){return[]},Tr.prototype.getClass=function(){return Tr},Pr.INSIDE_AREA.get=function(){return-1},Object.defineProperties(Tr,Pr);var Mr=function(t){this._pts=t||null};Mr.prototype.filter=function(t){t instanceof Qt&&this._pts.add(t)},Mr.prototype.interfaces_=function(){return[jt]},Mr.prototype.getClass=function(){return Mr},Mr.getPoints=function(){if(1===arguments.length){var t=arguments[0];return t instanceof Qt?Je.singletonList(t):Mr.getPoints(t,new wt)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof Qt?n.add(e):e instanceof Vt&&e.apply(new Mr(n)),n}};var Cr=function(){this._locations=null;var t=arguments[0];this._locations=t};Cr.prototype.filter=function(t){(t instanceof Qt||t instanceof $t||t instanceof Jt)&&this._locations.add(new Tr(t,0,t.getCoordinate()))},Cr.prototype.interfaces_=function(){return[jt]},Cr.prototype.getClass=function(){return Cr},Cr.getLocations=function(t){var e=new wt;return t.apply(new Cr(e)),e};var Ir=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new Sr,this._minDistanceLocation=null,this._minDistance=_.MAX_VALUE,2===arguments.length){var t=arguments[0],e=arguments[1];this._geom=[t,e],this._terminateDistance=0}else if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=n,this._geom[1]=r,this._terminateDistance=i}};Ir.prototype.computeContainmentDistance=function(){if(0===arguments.length){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],r=1-e,i=wr.getPolygons(this._geom[e]);if(i.size()>0){var o=Cr.getLocations(this._geom[r]);if(this.computeContainmentDistance(o,i,n),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[r]=n[0],this._minDistanceLocation[e]=n[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&I(arguments[0],xt)&&I(arguments[1],xt)){for(var s=arguments[0],a=arguments[1],l=arguments[2],u=0;u<s.size();u++)for(var c=s.get(u),h=0;h<a.size();h++)if(this.computeContainmentDistance(c,a.get(h),l),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof Tr&&arguments[1]instanceof Jt){var p=arguments[0],f=arguments[1],d=arguments[2],g=p.getCoordinate();if(M.EXTERIOR!==this._ptLocator.locate(g,f))return this._minDistance=0,d[0]=p,d[1]=new Tr(f,g),null}},Ir.prototype.computeMinDistanceLinesPoints=function(t,e,n){for(var r=0;r<t.size();r++)for(var i=t.get(r),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(i,s,n),this._minDistance<=this._terminateDistance)return null}},Ir.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),e=Er.getLines(this._geom[0]),n=Er.getLines(this._geom[1]),r=Mr.getPoints(this._geom[0]),i=Mr.getPoints(this._geom[1]);return this.computeMinDistanceLines(e,n,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,i,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,r,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(r,i,t),void this.updateMinDistance(t,!1))))},Ir.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},Ir.prototype.updateMinDistance=function(t,e){if(null===t[0])return null;e?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])},Ir.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},Ir.prototype.computeMinDistance=function(){if(0===arguments.length){if(null!==this._minDistanceLocation)return null;if(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof $t&&arguments[1]instanceof Qt){var t=arguments[0],e=arguments[1],n=arguments[2];if(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this._minDistance)return null;for(var r=t.getCoordinates(),i=e.getCoordinate(),o=0;o<r.length-1;o++){var s=at.distancePointLine(i,r[o],r[o+1]);if(s<this._minDistance){this._minDistance=s;var a=new gn(r[o],r[o+1]).closestPoint(i);n[0]=new Tr(t,o,a),n[1]=new Tr(e,0,i)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof $t&&arguments[1]instanceof $t){var l=arguments[0],u=arguments[1],c=arguments[2];if(l.getEnvelopeInternal().distance(u.getEnvelopeInternal())>this._minDistance)return null;for(var h=l.getCoordinates(),p=u.getCoordinates(),f=0;f<h.length-1;f++)for(var d=0;d<p.length-1;d++){var g=at.distanceLineLine(h[f],h[f+1],p[d],p[d+1]);if(g<this._minDistance){this._minDistance=g;var m=new gn(h[f],h[f+1]),A=new gn(p[d],p[d+1]),y=m.closestPoints(A);c[0]=new Tr(l,f,y[0]),c[1]=new Tr(u,d,y[1])}if(this._minDistance<=this._terminateDistance)return null}}},Ir.prototype.computeMinDistancePoints=function(t,e,n){for(var r=0;r<t.size();r++)for(var i=t.get(r),o=0;o<e.size();o++){var s=e.get(o),a=i.getCoordinate().distance(s.getCoordinate());if(a<this._minDistance&&(this._minDistance=a,n[0]=new Tr(i,0,i.getCoordinate()),n[1]=new Tr(s,0,s.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},Ir.prototype.distance=function(){if(null===this._geom[0]||null===this._geom[1])throw new y("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},Ir.prototype.computeMinDistanceLines=function(t,e,n){for(var r=0;r<t.size();r++)for(var i=t.get(r),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(i,s,n),this._minDistance<=this._terminateDistance)return null}},Ir.prototype.interfaces_=function(){return[]},Ir.prototype.getClass=function(){return Ir},Ir.distance=function(t,e){return new Ir(t,e).distance()},Ir.isWithinDistance=function(t,e,n){return new Ir(t,e,n).distance()<=n},Ir.nearestPoints=function(t,e){return new Ir(t,e).nearestPoints()};var Or=function(){this._pt=[new E,new E],this._distance=_.NaN,this._isNull=!0};Or.prototype.getCoordinates=function(){return this._pt},Or.prototype.getCoordinate=function(t){return this._pt[t]},Or.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var r=e.distance(n);r<this._distance&&this.initialize(e,n,r)}},Or.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(r),this._distance=i,this._isNull=!1}},Or.prototype.toString=function(){return K.toLineString(this._pt[0],this._pt[1])},Or.prototype.getDistance=function(){return this._distance},Or.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var r=e.distance(n);r>this._distance&&this.initialize(e,n,r)}},Or.prototype.interfaces_=function(){return[]},Or.prototype.getClass=function(){return Or};var Rr=function(){};Rr.prototype.interfaces_=function(){return[]},Rr.prototype.getClass=function(){return Rr},Rr.computeDistance=function(){if(arguments[2]instanceof Or&&arguments[0]instanceof $t&&arguments[1]instanceof E)for(var t=arguments[0],e=arguments[1],n=arguments[2],r=new gn,i=t.getCoordinates(),o=0;o<i.length-1;o++){r.setCoordinates(i[o],i[o+1]);var s=r.closestPoint(e);n.setMinimum(s,e)}else if(arguments[2]instanceof Or&&arguments[0]instanceof Jt&&arguments[1]instanceof E){var a=arguments[0],l=arguments[1],u=arguments[2];Rr.computeDistance(a.getExteriorRing(),l,u);for(var c=0;c<a.getNumInteriorRing();c++)Rr.computeDistance(a.getInteriorRingN(c),l,u)}else if(arguments[2]instanceof Or&&arguments[0]instanceof ct&&arguments[1]instanceof E){var h=arguments[0],p=arguments[1],f=arguments[2];if(h instanceof $t)Rr.computeDistance(h,p,f);else if(h instanceof Jt)Rr.computeDistance(h,p,f);else if(h instanceof Vt)for(var d=h,g=0;g<d.getNumGeometries();g++){var m=d.getGeometryN(g);Rr.computeDistance(m,p,f)}else f.setMinimum(h.getCoordinate(),p)}else if(arguments[2]instanceof Or&&arguments[0]instanceof gn&&arguments[1]instanceof E){var A=arguments[1],y=arguments[2],_=arguments[0].closestPoint(A);y.setMinimum(_,A)}};var Lr=function(){this._g0=null,this._g1=null,this._ptDist=new Or,this._densifyFrac=0;var t=arguments[0],e=arguments[1];this._g0=t,this._g1=e},kr={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};Lr.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},Lr.prototype.setDensifyFraction=function(t){if(t>1||t<=0)throw new y("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t},Lr.prototype.compute=function(t,e){this.computeOrientedDistance(t,e,this._ptDist),this.computeOrientedDistance(e,t,this._ptDist)},Lr.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},Lr.prototype.computeOrientedDistance=function(t,e,n){var r=new Dr(e);if(t.apply(r),n.setMaximum(r.getMaxPointDistance()),this._densifyFrac>0){var i=new Nr(e,this._densifyFrac);t.apply(i),n.setMaximum(i.getMaxPointDistance())}},Lr.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},Lr.prototype.interfaces_=function(){return[]},Lr.prototype.getClass=function(){return Lr},Lr.distance=function(){if(2===arguments.length)return new Lr(arguments[0],arguments[1]).distance();if(3===arguments.length){var t=arguments[2],e=new Lr(arguments[0],arguments[1]);return e.setDensifyFraction(t),e.distance()}},kr.MaxPointDistanceFilter.get=function(){return Dr},kr.MaxDensifiedByFractionDistanceFilter.get=function(){return Nr},Object.defineProperties(Lr,kr);var Dr=function(){this._maxPtDist=new Or,this._minPtDist=new Or,this._euclideanDist=new Rr,this._geom=null;var t=arguments[0];this._geom=t};Dr.prototype.filter=function(t){this._minPtDist.initialize(),Rr.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Dr.prototype.getMaxPointDistance=function(){return this._maxPtDist},Dr.prototype.interfaces_=function(){return[ft]},Dr.prototype.getClass=function(){return Dr};var Nr=function(){this._maxPtDist=new Or,this._minPtDist=new Or,this._geom=null,this._numSubSegs=0;var t=arguments[0],e=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/e))};Nr.prototype.filter=function(t,e){if(0===e)return null;for(var n=t.getCoordinate(e-1),r=t.getCoordinate(e),i=(r.x-n.x)/this._numSubSegs,o=(r.y-n.y)/this._numSubSegs,s=0;s<this._numSubSegs;s++){var a=n.x+s*i,l=n.y+s*o,u=new E(a,l);this._minPtDist.initialize(),Rr.computeDistance(this._geom,u,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},Nr.prototype.isDone=function(){return!1},Nr.prototype.isGeometryChanged=function(){return!1},Nr.prototype.getMaxPointDistance=function(){return this._maxPtDist},Nr.prototype.interfaces_=function(){return[Ut]},Nr.prototype.getClass=function(){return Nr};var Fr=function(t,e,n){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=e||null,this._result=n||null},Br={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};Fr.prototype.checkMaximumDistance=function(t,e,n){var r=new Lr(e,t);if(r.setDensifyFraction(.25),this._maxDistanceFound=r.orientedDistance(),this._maxDistanceFound>n){this._isValid=!1;var i=r.getCoordinates();this._errorLocation=i[1],this._errorIndicator=t.getFactory().createLineString(i),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+K.toLineString(i[0],i[1])+")"}},Fr.prototype.isValid=function(){var t=Math.abs(this._bufDistance),e=Fr.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-e,this._maxValidDistance=t+e,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),Fr.VERBOSE&&Z.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},Fr.prototype.checkNegativeValid=function(){if(!(this._input instanceof Jt||this._input instanceof ne||this._input instanceof Vt))return null;var t=this.getPolygonLines(this._input);if(this.checkMinimumDistance(t,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(t,this._result,this._maxValidDistance)},Fr.prototype.getErrorIndicator=function(){return this._errorIndicator},Fr.prototype.checkMinimumDistance=function(t,e,n){var r=new Ir(t,e,n);if(this._minDistanceFound=r.distance(),this._minDistanceFound<n){this._isValid=!1;var i=r.nearestPoints();this._errorLocation=r.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(i),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+K.toLineString(i[0],i[1])+" )"}},Fr.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();if(this.checkMinimumDistance(this._input,t,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,t,this._maxValidDistance)},Fr.prototype.getErrorLocation=function(){return this._errorLocation},Fr.prototype.getPolygonLines=function(t){for(var e=new wt,n=new Er(e),r=wr.getPolygons(t).iterator();r.hasNext();)r.next().apply(n);return t.getFactory().buildGeometry(e)},Fr.prototype.getErrorMessage=function(){return this._errMsg},Fr.prototype.interfaces_=function(){return[]},Fr.prototype.getClass=function(){return Fr},Br.VERBOSE.get=function(){return!1},Br.MAX_DISTANCE_DIFF_FRAC.get=function(){return.012},Object.defineProperties(Fr,Br);var zr=function(t,e,n){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=e||null,this._result=n||null},jr={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};zr.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},zr.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*zr.MAX_ENV_DIFF_FRAC;0===t&&(t=.001);var e=new W(this._input.getEnvelopeInternal());e.expandBy(this._distance);var n=new W(this._result.getEnvelopeInternal());n.expandBy(t),n.contains(e)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(n)),this.report("Envelope")},zr.prototype.checkDistance=function(){var t=new Fr(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")},zr.prototype.checkArea=function(){var t=this._input.getArea(),e=this._result.getArea();this._distance>0&&t>e&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<e&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},zr.prototype.checkPolygonal=function(){this._result instanceof Jt||this._result instanceof ne||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},zr.prototype.getErrorIndicator=function(){return this._errorIndicator},zr.prototype.getErrorLocation=function(){return this._errorLocation},zr.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2||this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},zr.prototype.report=function(t){if(!zr.VERBOSE)return null;Z.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))},zr.prototype.getErrorMessage=function(){return this._errorMsg},zr.prototype.interfaces_=function(){return[]},zr.prototype.getClass=function(){return zr},zr.isValidMsg=function(t,e,n){var r=new zr(t,e,n);return r.isValid()?null:r.getErrorMessage()},zr.isValid=function(t,e,n){return!!new zr(t,e,n).isValid()},jr.VERBOSE.get=function(){return!1},jr.MAX_ENV_DIFF_FRAC.get=function(){return.012},Object.defineProperties(zr,jr);var Ur=function(){this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};Ur.prototype.getCoordinates=function(){return this._pts},Ur.prototype.size=function(){return this._pts.length},Ur.prototype.getCoordinate=function(t){return this._pts[t]},Ur.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},Ur.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:hn.octant(this.getCoordinate(t),this.getCoordinate(t+1))},Ur.prototype.setData=function(t){this._data=t},Ur.prototype.getData=function(){return this._data},Ur.prototype.toString=function(){return K.toLineString(new le(this._pts))},Ur.prototype.interfaces_=function(){return[pn]},Ur.prototype.getClass=function(){return Ur};var Vr=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new wt,this._intersectionCount=0,this._keepIntersections=!0;var t=arguments[0];this._li=t,this._interiorIntersection=null};Vr.prototype.getInteriorIntersection=function(){return this._interiorIntersection},Vr.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t},Vr.prototype.getIntersectionSegments=function(){return this._intSegments},Vr.prototype.count=function(){return this._intersectionCount},Vr.prototype.getIntersections=function(){return this._intersections},Vr.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},Vr.prototype.setKeepIntersections=function(t){this._keepIntersections=t},Vr.prototype.processIntersections=function(t,e,n,r){if(!this._findAllIntersections&&this.hasIntersection())return null;if(t===n&&e===r)return null;if(this._isCheckEndSegmentsOnly&&!this.isEndSegment(t,e)&&!this.isEndSegment(n,r))return null;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[r],a=n.getCoordinates()[r+1];this._li.computeIntersection(i,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=i,this._intSegments[1]=o,this._intSegments[2]=s,this._intSegments[3]=a,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},Vr.prototype.isEndSegment=function(t,e){return 0===e||e>=t.size()-2},Vr.prototype.hasIntersection=function(){return null!==this._interiorIntersection},Vr.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection},Vr.prototype.interfaces_=function(){return[Xn]},Vr.prototype.getClass=function(){return Vr},Vr.createAllIntersectionsFinder=function(t){var e=new Vr(t);return e.setFindAllIntersections(!0),e},Vr.createAnyIntersectionFinder=function(t){return new Vr(t)},Vr.createIntersectionCounter=function(t){var e=new Vr(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e};var Gr=function(){this._li=new it,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var t=arguments[0];this._segStrings=t};Gr.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()},Gr.prototype.getIntersections=function(){return this._segInt.getIntersections()},Gr.prototype.isValid=function(){return this.execute(),this._isValid},Gr.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},Gr.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new Vr(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new xn;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},Gr.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new Me(this.getErrorMessage(),this._segInt.getInteriorIntersection())},Gr.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+K.toLineString(t[0],t[1])+" and "+K.toLineString(t[2],t[3])},Gr.prototype.interfaces_=function(){return[]},Gr.prototype.getClass=function(){return Gr},Gr.computeIntersections=function(t){var e=new Gr(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()};var Zr=function t(){this._nv=null;var e=arguments[0];this._nv=new Gr(t.toSegmentStrings(e))};Zr.prototype.checkValid=function(){this._nv.checkValid()},Zr.prototype.interfaces_=function(){return[]},Zr.prototype.getClass=function(){return Zr},Zr.toSegmentStrings=function(t){for(var e=new wt,n=t.iterator();n.hasNext();){var r=n.next();e.add(new Ur(r.getCoordinates(),r))}return e},Zr.checkValid=function(t){new Zr(t).checkValid()};var qr=function(t){this._mapOp=t};qr.prototype.map=function(t){for(var e=new wt,n=0;n<t.getNumGeometries();n++){var r=this._mapOp.map(t.getGeometryN(n));r.isEmpty()||e.add(r)}return t.getFactory().createGeometryCollection(Ae.toGeometryArray(e))},qr.prototype.interfaces_=function(){return[]},qr.prototype.getClass=function(){return qr},qr.map=function(t,e){return new qr(e).map(t)};var Wr=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new wt,this._resultLineList=new wt;var t=arguments[0],e=arguments[1],n=arguments[2];this._op=t,this._geometryFactory=e,this._ptLocator=n};Wr.prototype.collectLines=function(t){for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next();this.collectLineEdge(n,t,this._lineEdgesList),this.collectBoundaryTouchEdge(n,t,this._lineEdgesList)}},Wr.prototype.labelIsolatedLine=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,n)},Wr.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList},Wr.prototype.collectLineEdge=function(t,e,n){var r=t.getLabel(),i=t.getEdge();t.isLineEdge()&&(t.isVisited()||!Ti.isResultOfOp(r,e)||i.isCovered()||(n.add(i),t.setVisitedEdge(!0)))},Wr.prototype.findCoveredLineEdges=function(){for(var t=this._op.getGraph().getNodes().iterator();t.hasNext();)t.next().getEdges().findCoveredLineEdges();for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next(),r=n.getEdge();if(n.isLineEdge()&&!r.isCoveredSet()){var i=this._op.isCoveredByA(n.getCoordinate());r.setCovered(i)}}},Wr.prototype.labelIsolatedLines=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),r=n.getLabel();n.isIsolated()&&(r.isNull(0)?this.labelIsolatedLine(n,0):this.labelIsolatedLine(n,1))}},Wr.prototype.buildLines=function(t){for(var e=this._lineEdgesList.iterator();e.hasNext();){var n=e.next(),r=this._geometryFactory.createLineString(n.getCoordinates());this._resultLineList.add(r),n.setInResult(!0)}},Wr.prototype.collectBoundaryTouchEdge=function(t,e,n){var r=t.getLabel();return t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult()?null:(et.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(Ti.isResultOfOp(r,e)&&e===Ti.INTERSECTION&&(n.add(t.getEdge()),t.setVisitedEdge(!0))))},Wr.prototype.interfaces_=function(){return[]},Wr.prototype.getClass=function(){return Wr};var Hr=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new wt;var t=arguments[0],e=arguments[1];this._op=t,this._geometryFactory=e};Hr.prototype.filterCoveredNodeToPoint=function(t){var e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){var n=this._geometryFactory.createPoint(e);this._resultPointList.add(n)}},Hr.prototype.extractNonCoveredResultNodes=function(t){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();){var n=e.next();if(!(n.isInResult()||n.isIncidentEdgeInResult()||0!==n.getEdges().getDegree()&&t!==Ti.INTERSECTION)){var r=n.getLabel();Ti.isResultOfOp(r,t)&&this.filterCoveredNodeToPoint(n)}}},Hr.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList},Hr.prototype.interfaces_=function(){return[]},Hr.prototype.getClass=function(){return Hr};var Xr=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};Xr.prototype.transformPoint=function(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},Xr.prototype.transformPolygon=function(t,e){var n=!0,r=this.transformLinearRing(t.getExteriorRing(),t);null!==r&&r instanceof ee&&!r.isEmpty()||(n=!1);for(var i=new wt,o=0;o<t.getNumInteriorRing();o++){var s=this.transformLinearRing(t.getInteriorRingN(o),t);null===s||s.isEmpty()||(s instanceof ee||(n=!1),i.add(s))}if(n)return this._factory.createPolygon(r,i.toArray([]));var a=new wt;return null!==r&&a.add(r),a.addAll(i),this._factory.buildGeometry(a)},Xr.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)},Xr.prototype.getInputGeometry=function(){return this._inputGeom},Xr.prototype.transformMultiLineString=function(t,e){for(var n=new wt,r=0;r<t.getNumGeometries();r++){var i=this.transformLineString(t.getGeometryN(r),t);null!==i&&(i.isEmpty()||n.add(i))}return this._factory.buildGeometry(n)},Xr.prototype.transformCoordinates=function(t,e){return this.copy(t)},Xr.prototype.transformLineString=function(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},Xr.prototype.transformMultiPoint=function(t,e){for(var n=new wt,r=0;r<t.getNumGeometries();r++){var i=this.transformPoint(t.getGeometryN(r),t);null!==i&&(i.isEmpty()||n.add(i))}return this._factory.buildGeometry(n)},Xr.prototype.transformMultiPolygon=function(t,e){for(var n=new wt,r=0;r<t.getNumGeometries();r++){var i=this.transformPolygon(t.getGeometryN(r),t);null!==i&&(i.isEmpty()||n.add(i))}return this._factory.buildGeometry(n)},Xr.prototype.copy=function(t){return t.copy()},Xr.prototype.transformGeometryCollection=function(t,e){for(var n=new wt,r=0;r<t.getNumGeometries();r++){var i=this.transform(t.getGeometryN(r));null!==i&&(this._pruneEmptyGeometry&&i.isEmpty()||n.add(i))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(Ae.toGeometryArray(n)):this._factory.buildGeometry(n)},Xr.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof Qt)return this.transformPoint(t,null);if(t instanceof te)return this.transformMultiPoint(t,null);if(t instanceof ee)return this.transformLinearRing(t,null);if(t instanceof $t)return this.transformLineString(t,null);if(t instanceof Gt)return this.transformMultiLineString(t,null);if(t instanceof Jt)return this.transformPolygon(t,null);if(t instanceof ne)return this.transformMultiPolygon(t,null);if(t instanceof Vt)return this.transformGeometryCollection(t,null);throw new y("Unknown Geometry subtype: "+t.getClass().getName())},Xr.prototype.transformLinearRing=function(t,e){var n=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===n)return this._factory.createLinearRing(null);var r=n.size();return r>0&&r<4&&!this._preserveType?this._factory.createLineString(n):this._factory.createLinearRing(n)},Xr.prototype.interfaces_=function(){return[]},Xr.prototype.getClass=function(){return Xr};var $r=function t(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new gn,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof $t&&"number"==typeof arguments[1]){var e=arguments[1];t.call(this,arguments[0].getCoordinates(),e)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var n=arguments[0],r=arguments[1];this._srcPts=n,this._isClosed=t.isClosed(n),this._snapTolerance=r}};$r.prototype.snapVertices=function(t,e){for(var n=this._isClosed?t.size()-1:t.size(),r=0;r<n;r++){var i=t.get(r),o=this.findSnapForVertex(i,e);null!==o&&(t.set(r,new E(o)),0===r&&this._isClosed&&t.set(t.size()-1,new E(o)))}},$r.prototype.findSnapForVertex=function(t,e){for(var n=0;n<e.length;n++){if(t.equals2D(e[n]))return null;if(t.distance(e[n])<this._snapTolerance)return e[n]}return null},$r.prototype.snapTo=function(t){var e=new St(this._srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()},$r.prototype.snapSegments=function(t,e){if(0===e.length)return null;var n=e.length;e[0].equals2D(e[e.length-1])&&(n=e.length-1);for(var r=0;r<n;r++){var i=e[r],o=this.findSegmentIndexToSnap(i,t);o>=0&&t.add(o+1,new E(i),!1)}},$r.prototype.findSegmentIndexToSnap=function(t,e){for(var n=_.MAX_VALUE,r=-1,i=0;i<e.size()-1;i++){if(this._seg.p0=e.get(i),this._seg.p1=e.get(i+1),this._seg.p0.equals2D(t)||this._seg.p1.equals2D(t)){if(this._allowSnappingToSourceVertices)continue;return-1}var o=this._seg.distance(t);o<this._snapTolerance&&o<n&&(n=o,r=i)}return r},$r.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t},$r.prototype.interfaces_=function(){return[]},$r.prototype.getClass=function(){return $r},$r.isClosed=function(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])};var Yr=function(t){this._srcGeom=t||null},Qr={SNAP_PRECISION_FACTOR:{configurable:!0}};Yr.prototype.snapTo=function(t,e){var n=this.extractTargetCoordinates(t);return new Kr(e,n).transform(this._srcGeom)},Yr.prototype.snapToSelf=function(t,e){var n=this.extractTargetCoordinates(this._srcGeom),r=new Kr(t,n,!0).transform(this._srcGeom),i=r;return e&&I(i,Kt)&&(i=r.buffer(0)),i},Yr.prototype.computeSnapTolerance=function(t){return this.computeMinimumSegmentLength(t)/10},Yr.prototype.extractTargetCoordinates=function(t){for(var e=new f,n=t.getCoordinates(),r=0;r<n.length;r++)e.add(n[r]);return e.toArray(new Array(0).fill(null))},Yr.prototype.computeMinimumSegmentLength=function(t){for(var e=_.MAX_VALUE,n=0;n<t.length-1;n++){var r=t[n].distance(t[n+1]);r<e&&(e=r)}return e},Yr.prototype.interfaces_=function(){return[]},Yr.prototype.getClass=function(){return Yr},Yr.snap=function(t,e,n){var r=new Array(2).fill(null),i=new Yr(t);r[0]=i.snapTo(e,n);var o=new Yr(e);return r[1]=o.snapTo(r[0],n),r},Yr.computeOverlaySnapTolerance=function(){if(1===arguments.length){var t=arguments[0],e=Yr.computeSizeBasedSnapTolerance(t),n=t.getPrecisionModel();if(n.getType()===fe.FIXED){var r=1/n.getScale()*2/1.415;r>e&&(e=r)}return e}if(2===arguments.length){var i=arguments[0],o=arguments[1];return Math.min(Yr.computeOverlaySnapTolerance(i),Yr.computeOverlaySnapTolerance(o))}},Yr.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*Yr.SNAP_PRECISION_FACTOR},Yr.snapToSelf=function(t,e,n){return new Yr(t).snapToSelf(e,n)},Qr.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(Yr,Qr);var Kr=function(t){function e(e,n,r){t.call(this),this._snapTolerance=e||null,this._snapPts=n||null,this._isSelfSnap=void 0!==r&&r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.snapLine=function(t,e){var n=new $r(t,this._snapTolerance);return n.setAllowSnappingToSourceVertices(this._isSelfSnap),n.snapTo(e)},e.prototype.transformCoordinates=function(t,e){var n=t.toCoordinateArray(),r=this.snapLine(n,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(r)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Xr),Jr=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};Jr.prototype.getCommon=function(){return _.longBitsToDouble(this._commonBits)},Jr.prototype.add=function(t){var e=_.doubleToLongBits(t);return this._isFirst?(this._commonBits=e,this._commonSignExp=Jr.signExpBits(this._commonBits),this._isFirst=!1,null):Jr.signExpBits(e)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=Jr.numCommonMostSigMantissaBits(this._commonBits,e),void(this._commonBits=Jr.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))},Jr.prototype.toString=function(){if(1===arguments.length){var t=arguments[0],e=_.longBitsToDouble(t),n="0000000000000000000000000000000000000000000000000000000000000000"+_.toBinaryString(t),r=n.substring(n.length-64);return r.substring(0,1)+"  "+r.substring(1,12)+"(exp) "+r.substring(12)+" [ "+e+" ]"}},Jr.prototype.interfaces_=function(){return[]},Jr.prototype.getClass=function(){return Jr},Jr.getBit=function(t,e){return 0!=(t&1<<e)?1:0},Jr.signExpBits=function(t){return t>>52},Jr.zeroLowerBits=function(t,e){return t&~((1<<e)-1)},Jr.numCommonMostSigMantissaBits=function(t,e){for(var n=0,r=52;r>=0;r--){if(Jr.getBit(t,r)!==Jr.getBit(e,r))return n;n++}return 52};var ti=function(){this._commonCoord=null,this._ccFilter=new ni},ei={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};ti.prototype.addCommonBits=function(t){var e=new ri(this._commonCoord);t.apply(e),t.geometryChanged()},ti.prototype.removeCommonBits=function(t){if(0===this._commonCoord.x&&0===this._commonCoord.y)return t;var e=new E(this._commonCoord);e.x=-e.x,e.y=-e.y;var n=new ri(e);return t.apply(n),t.geometryChanged(),t},ti.prototype.getCommonCoordinate=function(){return this._commonCoord},ti.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},ti.prototype.interfaces_=function(){return[]},ti.prototype.getClass=function(){return ti},ei.CommonCoordinateFilter.get=function(){return ni},ei.Translater.get=function(){return ri},Object.defineProperties(ti,ei);var ni=function(){this._commonBitsX=new Jr,this._commonBitsY=new Jr};ni.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)},ni.prototype.getCommonCoordinate=function(){return new E(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},ni.prototype.interfaces_=function(){return[ft]},ni.prototype.getClass=function(){return ni};var ri=function(){this.trans=null;var t=arguments[0];this.trans=t};ri.prototype.filter=function(t,e){var n=t.getOrdinate(e,0)+this.trans.x,r=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,n),t.setOrdinate(e,1,r)},ri.prototype.isDone=function(){return!1},ri.prototype.isGeometryChanged=function(){return!0},ri.prototype.interfaces_=function(){return[Ut]},ri.prototype.getClass=function(){return ri};var ii=function(t,e){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()};ii.prototype.selfSnap=function(t){return new Yr(t).snapTo(t,this._snapTolerance)},ii.prototype.removeCommonBits=function(t){this._cbr=new ti,this._cbr.add(t[0]),this._cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e},ii.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t},ii.prototype.getResultGeometry=function(t){var e=this.snap(this._geom),n=Ti.overlayOp(e[0],e[1],t);return this.prepareResult(n)},ii.prototype.checkValid=function(t){t.isValid()||Z.out.println("Snapped geometry is invalid")},ii.prototype.computeSnapTolerance=function(){this._snapTolerance=Yr.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},ii.prototype.snap=function(t){var e=this.removeCommonBits(t);return Yr.snap(e[0],e[1],this._snapTolerance)},ii.prototype.interfaces_=function(){return[]},ii.prototype.getClass=function(){return ii},ii.overlayOp=function(t,e,n){return new ii(t,e).getResultGeometry(n)},ii.union=function(t,e){return ii.overlayOp(t,e,Ti.UNION)},ii.intersection=function(t,e){return ii.overlayOp(t,e,Ti.INTERSECTION)},ii.symDifference=function(t,e){return ii.overlayOp(t,e,Ti.SYMDIFFERENCE)},ii.difference=function(t,e){return ii.overlayOp(t,e,Ti.DIFFERENCE)};var oi=function(t,e){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=e};oi.prototype.getResultGeometry=function(t){var e=null,n=!1,r=null;try{e=Ti.overlayOp(this._geom[0],this._geom[1],t),n=!0}catch(t){if(!(t instanceof J))throw t;r=t}if(!n)try{e=ii.overlayOp(this._geom[0],this._geom[1],t)}catch(t){throw t instanceof J?r:t}return e},oi.prototype.interfaces_=function(){return[]},oi.prototype.getClass=function(){return oi},oi.overlayOp=function(t,e,n){return new oi(t,e).getResultGeometry(n)},oi.union=function(t,e){return oi.overlayOp(t,e,Ti.UNION)},oi.intersection=function(t,e){return oi.overlayOp(t,e,Ti.INTERSECTION)},oi.symDifference=function(t,e){return oi.overlayOp(t,e,Ti.SYMDIFFERENCE)},oi.difference=function(t,e){return oi.overlayOp(t,e,Ti.DIFFERENCE)};var si=function(){this.mce=null,this.chainIndex=null;var t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e};si.prototype.computeIntersections=function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)},si.prototype.interfaces_=function(){return[]},si.prototype.getClass=function(){return si};var ai=function t(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var e=arguments[0],n=arguments[1];this._eventType=t.DELETE,this._xValue=e,this._insertEvent=n}else if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2];this._eventType=t.INSERT,this._label=r,this._xValue=i,this._obj=o}},li={INSERT:{configurable:!0},DELETE:{configurable:!0}};ai.prototype.isDelete=function(){return this._eventType===ai.DELETE},ai.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t},ai.prototype.getObject=function(){return this._obj},ai.prototype.compareTo=function(t){var e=t;return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0},ai.prototype.getInsertEvent=function(){return this._insertEvent},ai.prototype.isInsert=function(){return this._eventType===ai.INSERT},ai.prototype.isSameLabel=function(t){return null!==this._label&&this._label===t._label},ai.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},ai.prototype.interfaces_=function(){return[b]},ai.prototype.getClass=function(){return ai},li.INSERT.get=function(){return 1},li.DELETE.get=function(){return 2},Object.defineProperties(ai,li);var ui=function(){};ui.prototype.interfaces_=function(){return[]},ui.prototype.getClass=function(){return ui};var ci=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=n};ci.prototype.isTrivialIntersection=function(t,e,n,r){if(t===n&&1===this._li.getIntersectionNum()){if(ci.isAdjacentSegments(e,r))return!0;if(t.isClosed()){var i=t.getNumPoints()-1;if(0===e&&r===i||0===r&&e===i)return!0}}return!1},ci.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},ci.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t},ci.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},ci.prototype.isBoundaryPointInternal=function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next().getCoordinate();if(t.isIntersection(r))return!0}return!1},ci.prototype.hasProperIntersection=function(){return this._hasProper},ci.prototype.hasIntersection=function(){return this._hasIntersection},ci.prototype.isDone=function(){return this._isDone},ci.prototype.isBoundaryPoint=function(t,e){return!(null===e||!this.isBoundaryPointInternal(t,e[0])&&!this.isBoundaryPointInternal(t,e[1]))},ci.prototype.setBoundaryNodes=function(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e},ci.prototype.addIntersections=function(t,e,n,r){if(t===n&&e===r)return null;this.numTests++;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[r],a=n.getCoordinates()[r+1];this._li.computeIntersection(i,o,s,a),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),n.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,n,r)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(t.addIntersections(this._li,e,0),n.addIntersections(this._li,r,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},ci.prototype.interfaces_=function(){return[]},ci.prototype.getClass=function(){return ci},ci.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var hi=function(t){function e(){t.call(this),this.events=new wt,this.nOverlaps=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.prepareEvents=function(){Je.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}},e.prototype.computeIntersections=function(){if(1===arguments.length){var t=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var e=0;e<this.events.size();e++){var n=this.events.get(e);if(n.isInsert()&&this.processOverlaps(e,n.getDeleteEventIndex(),n,t),t.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof ci&&I(arguments[0],xt)&&I(arguments[1],xt)){var r=arguments[0],i=arguments[1],o=arguments[2];this.addEdges(r,r),this.addEdges(i,i),this.computeIntersections(o)}else if("boolean"==typeof arguments[2]&&I(arguments[0],xt)&&arguments[1]instanceof ci){var s=arguments[0],a=arguments[1];arguments[2]?this.addEdges(s,null):this.addEdges(s),this.computeIntersections(a)}},e.prototype.addEdge=function(t,e){for(var n=t.getMonotoneChainEdge(),r=n.getStartIndexes(),i=0;i<r.length-1;i++){var o=new si(n,i),s=new ai(e,n.getMinX(i),o);this.events.add(s),this.events.add(new ai(n.getMaxX(i),s))}},e.prototype.processOverlaps=function(t,e,n,r){for(var i=n.getObject(),o=t;o<e;o++){var s=this.events.get(o);if(s.isInsert()){var a=s.getObject();n.isSameLabel(s)||(i.computeIntersections(a,r),this.nOverlaps++)}}},e.prototype.addEdges=function(){if(1===arguments.length)for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.addEdge(e,e)}else if(2===arguments.length)for(var n=arguments[1],r=arguments[0].iterator();r.hasNext();){var i=r.next();this.addEdge(i,n)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(ui),pi=function(){this._min=_.POSITIVE_INFINITY,this._max=_.NEGATIVE_INFINITY},fi={NodeComparator:{configurable:!0}};pi.prototype.getMin=function(){return this._min},pi.prototype.intersects=function(t,e){return!(this._min>e||this._max<t)},pi.prototype.getMax=function(){return this._max},pi.prototype.toString=function(){return K.toLineString(new E(this._min,0),new E(this._max,0))},pi.prototype.interfaces_=function(){return[]},pi.prototype.getClass=function(){return pi},fi.NodeComparator.get=function(){return di},Object.defineProperties(pi,fi);var di=function(){};di.prototype.compare=function(t,e){var n=t,r=e,i=(n._min+n._max)/2,o=(r._min+r._max)/2;return i<o?-1:i>o?1:0},di.prototype.interfaces_=function(){return[w]},di.prototype.getClass=function(){return di};var gi=function(t){function e(){t.call(this),this._item=null;var e=arguments[0],n=arguments[1],r=arguments[2];this._min=e,this._max=n,this._item=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;n.visitItem(this._item)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(pi),mi=function(t){function e(){t.call(this),this._node1=null,this._node2=null;var e=arguments[0],n=arguments[1];this._node1=e,this._node2=n,this.buildExtent(this._node1,this._node2)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildExtent=function(t,e){this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)},e.prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;null!==this._node1&&this._node1.query(t,e,n),null!==this._node2&&this._node2.query(t,e,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(pi),Ai=function(){this._leaves=new wt,this._root=null,this._level=0};Ai.prototype.buildTree=function(){Je.sort(this._leaves,new pi.NodeComparator);for(var t=this._leaves,e=null,n=new wt;;){if(this.buildLevel(t,n),1===n.size())return n.get(0);e=t,t=n,n=e}},Ai.prototype.insert=function(t,e,n){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new gi(t,e,n))},Ai.prototype.query=function(t,e,n){this.init(),this._root.query(t,e,n)},Ai.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()},Ai.prototype.printNode=function(t){Z.out.println(K.toLineString(new E(t._min,this._level),new E(t._max,this._level)))},Ai.prototype.init=function(){if(null!==this._root)return null;this.buildRoot()},Ai.prototype.buildLevel=function(t,e){this._level++,e.clear();for(var n=0;n<t.size();n+=2){var r=t.get(n);if(null===(n+1<t.size()?t.get(n):null))e.add(r);else{var i=new mi(t.get(n),t.get(n+1));e.add(i)}}},Ai.prototype.interfaces_=function(){return[]},Ai.prototype.getClass=function(){return Ai};var yi=function(){this._items=new wt};yi.prototype.visitItem=function(t){this._items.add(t)},yi.prototype.getItems=function(){return this._items},yi.prototype.interfaces_=function(){return[$e]},yi.prototype.getClass=function(){return yi};var _i=function(){this._index=null;var t=arguments[0];if(!I(t,Kt))throw new y("Argument must be Polygonal");this._index=new xi(t)},vi={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};_i.prototype.locate=function(t){var e=new st(t),n=new bi(e);return this._index.query(t.y,t.y,n),e.getLocation()},_i.prototype.interfaces_=function(){return[jn]},_i.prototype.getClass=function(){return _i},vi.SegmentVisitor.get=function(){return bi},vi.IntervalIndexedGeometry.get=function(){return xi},Object.defineProperties(_i,vi);var bi=function(){this._counter=null;var t=arguments[0];this._counter=t};bi.prototype.visitItem=function(t){var e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))},bi.prototype.interfaces_=function(){return[$e]},bi.prototype.getClass=function(){return bi};var xi=function(){this._index=new Ai;var t=arguments[0];this.init(t)};xi.prototype.init=function(t){for(var e=Er.getLines(t).iterator();e.hasNext();){var n=e.next().getCoordinates();this.addLine(n)}},xi.prototype.addLine=function(t){for(var e=1;e<t.length;e++){var n=new gn(t[e-1],t[e]),r=Math.min(n.p0.y,n.p1.y),i=Math.max(n.p0.y,n.p1.y);this._index.insert(r,i,n)}},xi.prototype.query=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new yi;return this._index.query(t,e,n),n.getItems()}if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2];this._index.query(r,i,o)}},xi.prototype.interfaces_=function(){return[]},xi.prototype.getClass=function(){return xi};var wi=function(t){function e(){if(t.call(this),this._parentGeom=null,this._lineEdgeMap=new pe,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new Sr,2===arguments.length){var e=arguments[0],n=arguments[1],r=dt.OGC_SFS_BOUNDARY_RULE;this._argIndex=e,this._parentGeom=n,this._boundaryNodeRule=r,null!==n&&this.add(n)}else if(3===arguments.length){var i=arguments[0],o=arguments[1],s=arguments[2];this._argIndex=i,this._parentGeom=o,this._boundaryNodeRule=s,null!==o&&this.add(o)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertBoundaryPoint=function(t,n){var r=this._nodes.addNode(n).getLabel(),i=1;r.getLocation(t,Se.ON)===M.BOUNDARY&&i++;var o=e.determineBoundary(this._boundaryNodeRule,i);r.setLocation(t,o)},e.prototype.computeSelfNodes=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){var n=arguments[1],r=arguments[2],i=new ci(arguments[0],!0,!1);i.setIsDoneIfProperInt(r);var o=this.createEdgeSetIntersector(),s=this._parentGeom instanceof ee||this._parentGeom instanceof Jt||this._parentGeom instanceof ne,a=n||!s;return o.computeIntersections(this._edges,i,a),this.addSelfIntersectionNodes(this._argIndex),i}},e.prototype.computeSplitEdges=function(t){for(var e=this._edges.iterator();e.hasNext();)e.next().eiList.addSplitEdges(t)},e.prototype.computeEdgeIntersections=function(t,e,n){var r=new ci(e,n,!0);return r.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,t._edges,r),r},e.prototype.getGeometry=function(){return this._parentGeom},e.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},e.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},e.prototype.addPoint=function(){if(arguments[0]instanceof Qt){var t=arguments[0].getCoordinate();this.insertPoint(this._argIndex,t,M.INTERIOR)}else if(arguments[0]instanceof E){var e=arguments[0];this.insertPoint(this._argIndex,e,M.INTERIOR)}},e.prototype.addPolygon=function(t){this.addPolygonRing(t.getExteriorRing(),M.EXTERIOR,M.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var n=t.getInteriorRingN(e);this.addPolygonRing(n,M.INTERIOR,M.EXTERIOR)}},e.prototype.addEdge=function(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this._argIndex,e[0],M.BOUNDARY),this.insertPoint(this._argIndex,e[e.length-1],M.BOUNDARY)},e.prototype.addLineString=function(t){var e=Tt.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=e[0],null;var n=new nr(e,new Re(this._argIndex,M.INTERIOR));this._lineEdgeMap.put(t,n),this.insertEdge(n),et.isTrue(e.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,e[0]),this.insertBoundaryPoint(this._argIndex,e[e.length-1])},e.prototype.getInvalidPoint=function(){return this._invalidPoint},e.prototype.getBoundaryPoints=function(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),n=0,r=t.iterator();r.hasNext();){var i=r.next();e[n++]=i.getCoordinate().copy()}return e},e.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},e.prototype.addSelfIntersectionNode=function(t,e,n){if(this.isBoundaryNode(t,e))return null;n===M.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,n)},e.prototype.addPolygonRing=function(t,e,n){if(t.isEmpty())return null;var r=Tt.removeRepeatedPoints(t.getCoordinates());if(r.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=r[0],null;var i=e,o=n;at.isCCW(r)&&(i=n,o=e);var s=new nr(r,new Re(this._argIndex,M.BOUNDARY,i,o));this._lineEdgeMap.put(t,s),this.insertEdge(s),this.insertPoint(this._argIndex,r[0],M.BOUNDARY)},e.prototype.insertPoint=function(t,e,n){var r=this._nodes.addNode(e),i=r.getLabel();null===i?r._label=new Re(t,n):i.setLocation(t,n)},e.prototype.createEdgeSetIntersector=function(){return new hi},e.prototype.addSelfIntersectionNodes=function(t){for(var e=this._edges.iterator();e.hasNext();)for(var n=e.next(),r=n.getLabel().getLocation(t),i=n.eiList.iterator();i.hasNext();){var o=i.next();this.addSelfIntersectionNode(t,o.coord,r)}},e.prototype.add=function(){if(1!==arguments.length)return t.prototype.add.apply(this,arguments);var e=arguments[0];if(e.isEmpty())return null;if(e instanceof ne&&(this._useBoundaryDeterminationRule=!1),e instanceof Jt)this.addPolygon(e);else if(e instanceof $t)this.addLineString(e);else if(e instanceof Qt)this.addPoint(e);else if(e instanceof te)this.addCollection(e);else if(e instanceof Gt)this.addCollection(e);else if(e instanceof ne)this.addCollection(e);else{if(!(e instanceof Vt))throw new Error(e.getClass().getName());this.addCollection(e)}},e.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},e.prototype.locate=function(t){return I(this._parentGeom,Kt)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new _i(this._parentGeom)),this._areaPtLocator.locate(t)):this._ptLocator.locate(t,this._parentGeom)},e.prototype.findEdge=function(){if(1===arguments.length){var e=arguments[0];return this._lineEdgeMap.get(e)}return t.prototype.findEdge.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.determineBoundary=function(t,e){return t.isInBoundary(e)?M.BOUNDARY:M.INTERIOR},e}(Ze),Ei=function(){if(this._li=new it,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new wi(0,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],r=dt.OGC_SFS_BOUNDARY_RULE;e.getPrecisionModel().compareTo(n.getPrecisionModel())>=0?this.setComputationPrecision(e.getPrecisionModel()):this.setComputationPrecision(n.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new wi(0,e,r),this._arg[1]=new wi(1,n,r)}else if(3===arguments.length){var i=arguments[0],o=arguments[1],s=arguments[2];i.getPrecisionModel().compareTo(o.getPrecisionModel())>=0?this.setComputationPrecision(i.getPrecisionModel()):this.setComputationPrecision(o.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new wi(0,i,s),this._arg[1]=new wi(1,o,s)}};Ei.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()},Ei.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)},Ei.prototype.interfaces_=function(){return[]},Ei.prototype.getClass=function(){return Ei};var Si=function(){};Si.prototype.interfaces_=function(){return[]},Si.prototype.getClass=function(){return Si},Si.map=function(){if(arguments[0]instanceof ct&&I(arguments[1],Si.MapOp)){for(var t=arguments[0],e=arguments[1],n=new wt,r=0;r<t.getNumGeometries();r++){var i=e.map(t.getGeometryN(r));null!==i&&n.add(i)}return t.getFactory().buildGeometry(n)}if(I(arguments[0],vt)&&I(arguments[1],Si.MapOp)){for(var o=arguments[0],s=arguments[1],a=new wt,l=o.iterator();l.hasNext();){var u=l.next(),c=s.map(u);null!==c&&a.add(c)}return a}},Si.MapOp=function(){};var Ti=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n),this._ptLocator=new Sr,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Hn,this._resultPolyList=new wt,this._resultLineList=new wt,this._resultPointList=new wt,this._graph=new Ze(new qn),this._geomFact=e.getFactory()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),r=t.getLabel();e.isPointwiseEqual(t)||(r=new Re(t.getLabel())).flip();var i=e.getDepth();i.isNull()&&i.add(n),i.add(r),n.merge(r)}else this._edgeList.add(t)},e.prototype.getGraph=function(){return this._graph},e.prototype.cancelDuplicateResultEdges=function(){for(var t=this._graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),n=e.getSym();e.isInResult()&&n.isInResult()&&(e.setInResult(!1),n.setInResult(!1))}},e.prototype.isCoveredByLA=function(t){return!!this.isCovered(t,this._resultLineList)||!!this.isCovered(t,this._resultPolyList)},e.prototype.computeGeometry=function(t,n,r,i){var o=new wt;return o.addAll(t),o.addAll(n),o.addAll(r),o.isEmpty()?e.createEmptyResult(i,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(o)},e.prototype.mergeSymLabels=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().mergeSymLabels()},e.prototype.isCovered=function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next();if(this._ptLocator.locate(t,r)!==M.EXTERIOR)return!0}return!1},e.prototype.replaceCollapsedEdges=function(){for(var t=new wt,e=this._edgeList.iterator();e.hasNext();){var n=e.next();n.isCollapsed()&&(e.remove(),t.add(n.getCollapsedEdge()))}this._edgeList.addAll(t)},e.prototype.updateNodeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getEdges().getLabel();e.getLabel().merge(n)}},e.prototype.getResultGeometry=function(t){return this.computeOverlay(t),this._resultGeom},e.prototype.insertUniqueEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertUniqueEdge(n)}},e.prototype.computeOverlay=function(t){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var e=new wt;this._arg[0].computeSplitEdges(e),this._arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Zr.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var n=new qe(this._geomFact);n.add(this._graph),this._resultPolyList=n.getPolygons();var r=new Wr(this,this._geomFact,this._ptLocator);this._resultLineList=r.build(t);var i=new Hr(this,this._geomFact,this._ptLocator);this._resultPointList=i.build(t),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,t)},e.prototype.labelIncompleteNode=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setLocation(e,n)},e.prototype.copyPoints=function(t){for(var e=this._arg[t].getNodeIterator();e.hasNext();){var n=e.next();this._graph.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}},e.prototype.findResultAreaEdges=function(t){for(var n=this._graph.getEdgeEnds().iterator();n.hasNext();){var r=n.next(),i=r.getLabel();i.isArea()&&!r.isInteriorAreaEdge()&&e.isResultOfOp(i.getLocation(0,Se.RIGHT),i.getLocation(1,Se.RIGHT),t)&&r.setInResult(!0)}},e.prototype.computeLabelsFromDepths=function(){for(var t=this._edgeList.iterator();t.hasNext();){var e=t.next(),n=e.getLabel(),r=e.getDepth();if(!r.isNull()){r.normalize();for(var i=0;i<2;i++)n.isNull(i)||!n.isArea()||r.isNull(i)||(0===r.getDelta(i)?n.toLine(i):(et.isTrue(!r.isNull(i,Se.LEFT),"depth of LEFT side has not been initialized"),n.setLocation(i,Se.LEFT,r.getLocation(i,Se.LEFT)),et.isTrue(!r.isNull(i,Se.RIGHT),"depth of RIGHT side has not been initialized"),n.setLocation(i,Se.RIGHT,r.getLocation(i,Se.RIGHT))))}}},e.prototype.computeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},e.prototype.labelIncompleteNodes=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getLabel();e.isIsolated()&&(n.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(n)}},e.prototype.isCoveredByA=function(t){return!!this.isCovered(t,this._resultPolyList)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ei);Ti.overlayOp=function(t,e,n){return new Ti(t,e).getResultGeometry(n)},Ti.intersection=function(t,e){if(t.isEmpty()||e.isEmpty())return Ti.createEmptyResult(Ti.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var n=e;return qr.map(t,{interfaces_:function(){return[Si.MapOp]},map:function(t){return t.intersection(n)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),oi.overlayOp(t,e,Ti.INTERSECTION)},Ti.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Ti.createEmptyResult(Ti.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),oi.overlayOp(t,e,Ti.SYMDIFFERENCE)},Ti.resultDimension=function(t,e,n){var r=e.getDimension(),i=n.getDimension(),o=-1;switch(t){case Ti.INTERSECTION:o=Math.min(r,i);break;case Ti.UNION:o=Math.max(r,i);break;case Ti.DIFFERENCE:o=r;break;case Ti.SYMDIFFERENCE:o=Math.max(r,i)}return o},Ti.createEmptyResult=function(t,e,n,r){var i=null;switch(Ti.resultDimension(t,e,n)){case-1:i=r.createGeometryCollection(new Array(0).fill(null));break;case 0:i=r.createPoint();break;case 1:i=r.createLineString();break;case 2:i=r.createPolygon()}return i},Ti.difference=function(t,e){return t.isEmpty()?Ti.createEmptyResult(Ti.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),oi.overlayOp(t,e,Ti.DIFFERENCE))},Ti.isResultOfOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=t.getLocation(0),r=t.getLocation(1);return Ti.isResultOfOp(n,r,e)}if(3===arguments.length){var i=arguments[0],o=arguments[1],s=arguments[2];switch(i===M.BOUNDARY&&(i=M.INTERIOR),o===M.BOUNDARY&&(o=M.INTERIOR),s){case Ti.INTERSECTION:return i===M.INTERIOR&&o===M.INTERIOR;case Ti.UNION:return i===M.INTERIOR||o===M.INTERIOR;case Ti.DIFFERENCE:return i===M.INTERIOR&&o!==M.INTERIOR;case Ti.SYMDIFFERENCE:return i===M.INTERIOR&&o!==M.INTERIOR||i!==M.INTERIOR&&o===M.INTERIOR}return!1}},Ti.INTERSECTION=1,Ti.UNION=2,Ti.DIFFERENCE=3,Ti.SYMDIFFERENCE=4;var Pi=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new Sr,this._seg=new gn;var t=arguments[0],e=arguments[1];this._g=t,this._boundaryDistanceTolerance=e,this._linework=this.extractLinework(t)};Pi.prototype.isWithinToleranceOfBoundary=function(t){for(var e=0;e<this._linework.getNumGeometries();e++)for(var n=this._linework.getGeometryN(e).getCoordinateSequence(),r=0;r<n.size()-1;r++)if(n.getCoordinate(r,this._seg.p0),n.getCoordinate(r+1,this._seg.p1),this._seg.distance(t)<=this._boundaryDistanceTolerance)return!0;return!1},Pi.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?M.BOUNDARY:this._ptLocator.locate(t,this._g)},Pi.prototype.extractLinework=function(t){var e=new Mi;t.apply(e);var n=e.getLinework(),r=Ae.toLineStringArray(n);return t.getFactory().createMultiLineString(r)},Pi.prototype.interfaces_=function(){return[]},Pi.prototype.getClass=function(){return Pi};var Mi=function(){this._linework=null,this._linework=new wt};Mi.prototype.getLinework=function(){return this._linework},Mi.prototype.filter=function(t){if(t instanceof Jt){var e=t;this._linework.add(e.getExteriorRing());for(var n=0;n<e.getNumInteriorRing();n++)this._linework.add(e.getInteriorRingN(n))}},Mi.prototype.interfaces_=function(){return[jt]},Mi.prototype.getClass=function(){return Mi};var Ci=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var t=arguments[0];this._g=t};Ci.prototype.extractPoints=function(t,e,n){for(var r=t.getCoordinates(),i=0;i<r.length-1;i++)this.computeOffsetPoints(r[i],r[i+1],e,n)},Ci.prototype.setSidesToGenerate=function(t,e){this._doLeft=t,this._doRight=e},Ci.prototype.getPoints=function(t){for(var e=new wt,n=Er.getLines(this._g).iterator();n.hasNext();){var r=n.next();this.extractPoints(r,t,e)}return e},Ci.prototype.computeOffsetPoints=function(t,e,n,r){var i=e.x-t.x,o=e.y-t.y,s=Math.sqrt(i*i+o*o),a=n*i/s,l=n*o/s,u=(e.x+t.x)/2,c=(e.y+t.y)/2;if(this._doLeft){var h=new E(u-l,c+a);r.add(h)}if(this._doRight){var p=new E(u+l,c-a);r.add(p)}},Ci.prototype.interfaces_=function(){return[]},Ci.prototype.getClass=function(){return Ci};var Ii=function t(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=t.TOLERANCE,this._testCoords=new wt;var e=arguments[0],n=arguments[1],r=arguments[2];this._boundaryDistanceTolerance=t.computeBoundaryDistanceTolerance(e,n),this._geom=[e,n,r],this._locFinder=[new Pi(this._geom[0],this._boundaryDistanceTolerance),new Pi(this._geom[1],this._boundaryDistanceTolerance),new Pi(this._geom[2],this._boundaryDistanceTolerance)]},Oi={TOLERANCE:{configurable:!0}};Ii.prototype.reportResult=function(t,e,n){Z.out.println("Overlay result invalid - A:"+M.toLocationSymbol(e[0])+" B:"+M.toLocationSymbol(e[1])+" expected:"+(n?"i":"e")+" actual:"+M.toLocationSymbol(e[2]))},Ii.prototype.isValid=function(t){return this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]),this.checkValid(t)},Ii.prototype.checkValid=function(){if(1===arguments.length){for(var t=arguments[0],e=0;e<this._testCoords.size();e++){var n=this._testCoords.get(e);if(!this.checkValid(t,n))return this._invalidLocation=n,!1}return!0}if(2===arguments.length){var r=arguments[0],i=arguments[1];return this._location[0]=this._locFinder[0].getLocation(i),this._location[1]=this._locFinder[1].getLocation(i),this._location[2]=this._locFinder[2].getLocation(i),!!Ii.hasLocation(this._location,M.BOUNDARY)||this.isValidResult(r,this._location)}},Ii.prototype.addTestPts=function(t){var e=new Ci(t);this._testCoords.addAll(e.getPoints(5*this._boundaryDistanceTolerance))},Ii.prototype.isValidResult=function(t,e){var n=Ti.isResultOfOp(e[0],e[1],t),r=!(n^e[2]===M.INTERIOR);return r||this.reportResult(t,e,n),r},Ii.prototype.getInvalidLocation=function(){return this._invalidLocation},Ii.prototype.interfaces_=function(){return[]},Ii.prototype.getClass=function(){return Ii},Ii.hasLocation=function(t,e){for(var n=0;n<3;n++)if(t[n]===e)return!0;return!1},Ii.computeBoundaryDistanceTolerance=function(t,e){return Math.min(Yr.computeSizeBasedSnapTolerance(t),Yr.computeSizeBasedSnapTolerance(e))},Ii.isValid=function(t,e,n,r){return new Ii(t,e,r).isValid(n)},Oi.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(Ii,Oi);var Ri=function t(e){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=t.extractFactory(e),this._inputGeoms=e};Ri.prototype.extractElements=function(t,e){if(null===t)return null;for(var n=0;n<t.getNumGeometries();n++){var r=t.getGeometryN(n);this._skipEmpty&&r.isEmpty()||e.add(r)}},Ri.prototype.combine=function(){for(var t=new wt,e=this._inputGeoms.iterator();e.hasNext();){var n=e.next();this.extractElements(n,t)}return 0===t.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(t)},Ri.prototype.interfaces_=function(){return[]},Ri.prototype.getClass=function(){return Ri},Ri.combine=function(){if(1===arguments.length)return new Ri(arguments[0]).combine();if(2===arguments.length){var t=arguments[0],e=arguments[1];return new Ri(Ri.createList(t,e)).combine()}if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];return new Ri(Ri.createList(n,r,i)).combine()}},Ri.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},Ri.createList=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new wt;return n.add(t),n.add(e),n}if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2],s=new wt;return s.add(r),s.add(i),s.add(o),s}};var Li=function(){this._inputPolys=null,this._geomFactory=null;var t=arguments[0];this._inputPolys=t,null===this._inputPolys&&(this._inputPolys=new wt)},ki={STRTREE_NODE_CAPACITY:{configurable:!0}};Li.prototype.reduceToGeometries=function(t){for(var e=new wt,n=t.iterator();n.hasNext();){var r=n.next(),i=null;I(r,xt)?i=this.unionTree(r):r instanceof ct&&(i=r),e.add(i)}return e},Li.prototype.extractByEnvelope=function(t,e,n){for(var r=new wt,i=0;i<e.getNumGeometries();i++){var o=e.getGeometryN(i);o.getEnvelopeInternal().intersects(t)?r.add(o):n.add(o)}return this._geomFactory.buildGeometry(r)},Li.prototype.unionOptimized=function(t,e){var n=t.getEnvelopeInternal(),r=e.getEnvelopeInternal();if(!n.intersects(r))return Ri.combine(t,e);if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var i=n.intersection(r);return this.unionUsingEnvelopeIntersection(t,e,i)},Li.prototype.union=function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new sn(Li.STRTREE_NODE_CAPACITY),e=this._inputPolys.iterator();e.hasNext();){var n=e.next();t.insert(n.getEnvelopeInternal(),n)}this._inputPolys=null;var r=t.itemsTree();return this.unionTree(r)},Li.prototype.binaryUnion=function(){if(1===arguments.length){var t=arguments[0];return this.binaryUnion(t,0,t.size())}if(3===arguments.length){var e=arguments[0],n=arguments[1],r=arguments[2];if(r-n<=1){var i=Li.getGeometry(e,n);return this.unionSafe(i,null)}if(r-n==2)return this.unionSafe(Li.getGeometry(e,n),Li.getGeometry(e,n+1));var o=Math.trunc((r+n)/2),s=this.binaryUnion(e,n,o),a=this.binaryUnion(e,o,r);return this.unionSafe(s,a)}},Li.prototype.repeatedUnion=function(t){for(var e=null,n=t.iterator();n.hasNext();){var r=n.next();e=null===e?r.copy():e.union(r)}return e},Li.prototype.unionSafe=function(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)},Li.prototype.unionActual=function(t,e){return Li.restrictToPolygons(t.union(e))},Li.prototype.unionTree=function(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)},Li.prototype.unionUsingEnvelopeIntersection=function(t,e,n){var r=new wt,i=this.extractByEnvelope(n,t,r),o=this.extractByEnvelope(n,e,r),s=this.unionActual(i,o);return r.add(s),Ri.combine(r)},Li.prototype.bufferUnion=function(){if(1===arguments.length){var t=arguments[0];return t.get(0).getFactory().buildGeometry(t).buffer(0)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().createGeometryCollection([e,n]).buffer(0)}},Li.prototype.interfaces_=function(){return[]},Li.prototype.getClass=function(){return Li},Li.restrictToPolygons=function(t){if(I(t,Kt))return t;var e=wr.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon(Ae.toPolygonArray(e))},Li.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)},Li.union=function(t){return new Li(t).union()},ki.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(Li,ki);var Di=function(){};Di.prototype.interfaces_=function(){return[]},Di.prototype.getClass=function(){return Di},Di.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Ti.createEmptyResult(Ti.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),oi.overlayOp(t,e,Ti.UNION)},t.GeoJSONReader=we,t.GeoJSONWriter=Ee,t.OverlayOp=Ti,t.UnionOp=Di,t.BufferOp=gr,Object.defineProperty(t,"__esModule",{value:!0})}(e)},4235:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r.DW,WebMercatorViewport:()=>r.DW,addMetersToLngLat:()=>r.eG,altitudeToFovy:()=>r.Lu,fitBounds:()=>r.Xg,flyToViewport:()=>r.if,fovyToAltitude:()=>r.sj,getBounds:()=>r.zX,getDistanceScales:()=>r.ro,getFlyToDuration:()=>r.up,getMeterZoom:()=>r.Bf,getProjectionMatrix:()=>r.c7,getProjectionParameters:()=>r.wl,getViewMatrix:()=>r.lf,lngLatToWorld:()=>r.w5,normalizeViewportProps:()=>r.QA,pixelsToWorld:()=>r.CT,scaleToZoom:()=>r.sO,worldToLngLat:()=>r.es,worldToPixels:()=>r.aW,zoomToScale:()=>r.EO});var r=n(7682)},9521:()=>{},9125:()=>{},7579:()=>{},5307:()=>{},4942:(t,e,n)=>{"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,{Z:()=>r})}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={id:r,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";var t={};n.r(t),n.d(t,{areaFactors:()=>qn,bearingToAzimuth:()=>ur,convertArea:()=>fr,convertLength:()=>pr,degreesToRadians:()=>hr,earthRadius:()=>Vn,factors:()=>Gn,feature:()=>Wn,featureCollection:()=>tr,geometry:()=>Hn,geometryCollection:()=>ir,isNumber:()=>dr,isObject:()=>gr,lengthToDegrees:()=>lr,lengthToRadians:()=>ar,lineString:()=>Kn,lineStrings:()=>Jn,multiLineString:()=>er,multiPoint:()=>nr,multiPolygon:()=>rr,point:()=>Xn,points:()=>$n,polygon:()=>Yn,polygons:()=>Qn,radiansToDegrees:()=>cr,radiansToLength:()=>sr,round:()=>or,unitsFactors:()=>Zn,validateBBox:()=>mr,validateId:()=>Ar});var e={};n.r(e),n.d(e,{coordAll:()=>Er,coordEach:()=>yr,coordReduce:()=>_r,featureEach:()=>xr,featureReduce:()=>wr,findPoint:()=>kr,findSegment:()=>Lr,flattenEach:()=>Pr,flattenReduce:()=>Mr,geomEach:()=>Sr,geomReduce:()=>Tr,lineEach:()=>Or,lineReduce:()=>Rr,propEach:()=>vr,propReduce:()=>br,segmentEach:()=>Cr,segmentReduce:()=>Ir});var r={};n.r(r),n.d(r,{collectionOf:()=>Vr,containsNumber:()=>zr,featureOf:()=>Ur,geojsonType:()=>jr,getCoord:()=>Fr,getCoords:()=>Br,getGeom:()=>Gr,getType:()=>Zr});var i={};n.r(i),n.d(i,{toMercator:()=>Vu,toWgs84:()=>Gu});var o={};n.r(o),n.d(o,{randomLineString:()=>Yu,randomPoint:()=>Xu,randomPolygon:()=>$u,randomPosition:()=>Hu});var s={};n.r(s),n.d(s,{applyFilter:()=>rc,clusterEach:()=>tc,clusterReduce:()=>ec,createBins:()=>nc,filterProperties:()=>oc,getCluster:()=>Ju,propertiesContainsFilter:()=>ic});var a={};n.r(a),n.d(a,{along:()=>Fo,angle:()=>ku,applyFilter:()=>rc,area:()=>Lo,areaFactors:()=>qn,bbox:()=>Nr,bboxClip:()=>Cs,bboxPolygon:()=>eo,bearing:()=>so,bearingToAngle:()=>ur,bearingToAzimuth:()=>ur,bezier:()=>Ki,bezierSpline:()=>Ki,booleanClockwise:()=>Vs,booleanContains:()=>gl,booleanCrosses:()=>xl,booleanDisjoint:()=>dl,booleanEqual:()=>Sl,booleanIntersects:()=>Tl,booleanOverlap:()=>El,booleanParallel:()=>Ll,booleanPointInPolygon:()=>ni,booleanPointOnLine:()=>Vo,booleanWithin:()=>qo,buffer:()=>dc,center:()=>lo,centerMean:()=>Cu,centerMedian:()=>Ou,centerOfMass:()=>co,centroid:()=>uo,circle:()=>oo,cleanCoords:()=>Ui,clone:()=>di,clusterEach:()=>tc,clusterReduce:()=>ec,clusters:()=>s,clustersDbscan:()=>Ml,clustersKmeans:()=>Il,collect:()=>Ni,collectionOf:()=>Vr,combine:()=>ho,concave:()=>ki,containsNumber:()=>zr,convertArea:()=>fr,convertDistance:()=>pr,convertLength:()=>pr,convex:()=>ei,coordAll:()=>Er,coordEach:()=>yr,coordReduce:()=>_r,createBins:()=>nc,degrees2radians:()=>hr,degreesToRadians:()=>hr,destination:()=>io,difference:()=>ac,dissolve:()=>Ac,distance:()=>oi,distanceToDegrees:()=>lr,distanceToRadians:()=>ar,distanceWeight:()=>zu,earthRadius:()=>Vn,ellipse:()=>Mu,envelope:()=>no,explode:()=>po,factors:()=>Gn,feature:()=>Wn,featureCollection:()=>tr,featureEach:()=>xr,featureOf:()=>Ur,featureReduce:()=>wr,filterProperties:()=>oc,findPoint:()=>kr,findSegment:()=>Lr,flatten:()=>Xo,flattenEach:()=>Pr,flattenReduce:()=>Mr,flip:()=>Fi,geojsonType:()=>jr,geomEach:()=>Sr,geomReduce:()=>Tr,geometry:()=>Hn,geometryCollection:()=>ir,getCluster:()=>Ju,getCoord:()=>Fr,getCoords:()=>Br,getGeom:()=>Gr,getType:()=>Zr,greatCircle:()=>ps,helpers:()=>t,hexGrid:()=>vc,inside:()=>ni,interpolate:()=>Tc,intersect:()=>mc,invariant:()=>r,isNumber:()=>dr,isObject:()=>gr,isobands:()=>Xa,isolines:()=>Jr,kinks:()=>Co,length:()=>Bo,lengthToDegrees:()=>lr,lengthToRadians:()=>ar,lineArc:()=>ys,lineChunk:()=>$o,lineDistance:()=>Bo,lineEach:()=>Or,lineIntersect:()=>bo,lineOffset:()=>nl,lineOverlap:()=>Ls,lineReduce:()=>Rr,lineSegment:()=>yo,lineSlice:()=>zo,lineSliceAlong:()=>jo,lineSplit:()=>As,lineString:()=>Kn,lineStringToPolygon:()=>Ss,lineStrings:()=>Jn,lineToPolygon:()=>Ss,mask:()=>wc,meta:()=>e,midpoint:()=>ao,moranIndex:()=>ju,multiLineString:()=>er,multiPoint:()=>nr,multiPolygon:()=>rr,nearest:()=>Ao,nearestPoint:()=>Ao,nearestPointOnLine:()=>xo,nearestPointToLine:()=>Po,planepoint:()=>Mo,point:()=>Xn,pointGrid:()=>Wo,pointOnFeature:()=>Oo,pointOnLine:()=>xo,pointOnSurface:()=>Oo,pointToLineDistance:()=>To,points:()=>$n,pointsWithinPolygon:()=>ii,polygon:()=>Yn,polygonSmooth:()=>Fu,polygonTangents:()=>Us,polygonToLine:()=>vs,polygonToLineString:()=>vs,polygonize:()=>cl,polygons:()=>Qn,projection:()=>i,propEach:()=>vr,propReduce:()=>br,propertiesContainsFilter:()=>ic,radians2degrees:()=>cr,radiansToDegrees:()=>cr,radiansToDistance:()=>sr,radiansToLength:()=>sr,random:()=>o,randomLineString:()=>Yu,randomPoint:()=>Xu,randomPolygon:()=>$u,randomPosition:()=>Hu,rewind:()=>Ws,rhumbBearing:()=>Fs,rhumbDestination:()=>Bs,rhumbDistance:()=>wo,round:()=>or,sample:()=>to,sector:()=>Ds,segmentEach:()=>Cr,segmentReduce:()=>Ir,shortestPath:()=>jl,simplify:()=>$i,square:()=>ro,squareGrid:()=>Ec,standardDeviationalEllipse:()=>Lu,tag:()=>Ji,tesselate:()=>mo,tin:()=>si,toMercator:()=>Vu,toWgs84:()=>Gu,transformRotate:()=>$a,transformScale:()=>Qa,transformTranslate:()=>Ka,triangleGrid:()=>Sc,truncate:()=>Ho,union:()=>gc,unitsFactors:()=>Zn,unkinkPolygon:()=>os,validateBBox:()=>mr,validateId:()=>Ar,voronoi:()=>Tu,within:()=>ii});var l=n(7294),u=n(3935),c=n(5697),h=n.n(c),p=n(3452);const f="undefined"!=typeof window?l.useLayoutEffect:l.useEffect;function d(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}var g=n(4897),m=n(4185);function A(t){return t?"function"==typeof t?(0,l.createElement)(g.Z,{},t):Array.isArray(t)?t.map(A):t.type===l.Fragment?A(t.props.children):(d(t.type,g.Z),t):t}const y={position:"absolute",zIndex:-1};function _(t,e){return t?"function"==typeof t?t(e):Array.isArray(t)?t.map((t=>_(t,e))):function(t){const e=t&&t.type,n=e&&e.defaultProps;return n&&n.mapStyle}(t)?(e.style=y,(0,l.cloneElement)(t,e)):function(t){const e=t&&t.type;return e&&e.deckGLViewProps}(t)?(0,l.cloneElement)(t,e):t:t}const v={mixBlendMode:null};function b(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}const x=(0,l.forwardRef)(((t,e)=>{const n=(0,l.useRef)({}).current,[r,i]=(0,l.useState)(0);n.forceUpdate=i;const o=(0,l.useRef)(null),s=(0,l.useRef)(null),a=(0,l.useMemo)((()=>function({children:t,layers:e,views:n}){const r=[],i=[],o={};return l.Children.forEach(A(t),(t=>{if(t){const e=t.type;if(d(e,m.Z)){const n=function(t,e){const n={},r=t.defaultProps||{};for(const t in e)r[t]!==e[t]&&(n[t]=e[t]);return new t(n)}(e,t.props);i.push(n)}else r.push(t);if(e!==g.Z&&d(e,g.Z)&&t.props.id){const n=new e(t.props);o[n.id]=n}}})),Object.keys(o).length>0&&(Array.isArray(n)?n.forEach((t=>{o[t.id]=t})):n&&(o[n.id]=n),n=Object.values(o)),{layers:e=i.length>0?[...i,...e]:e,children:r,views:n}}(t)),[t.layers,t.views,t.children]);let u=!0;const c=e=>u&&t.viewState?(n.viewStateUpdateRequested=e,null):(n.viewStateUpdateRequested=null,t.onViewStateChange(e)),h=e=>{u?n.interactionStateUpdateRequested=e:(n.interactionStateUpdateRequested=null,t.onInteractionStateChange(e))},y=(0,l.useMemo)((()=>{const e={...t,style:null,width:"100%",height:"100%",layers:a.layers,views:a.views,onViewStateChange:c,onInteractionStateChange:h};return n.deck&&n.deck.setProps(e),e}),[t]);(0,l.useEffect)((()=>(n.deck=function(t,e){const n=new(e.Deck||p.Z)({...e,style:null,width:"100%",height:"100%",_customRender:e=>{t.redrawReason=e;const r=n.viewManager.getViewports();t.lastRenderedViewports!==r?t.forceUpdate((t=>t+1)):b(t)}});return n}(n,{...y,parent:o.current,canvas:s.current}),()=>n.deck.finalize())),[]),f((()=>{b(n);const{viewStateUpdateRequested:t,interactionStateUpdateRequested:e}=n;t&&c(t),e&&h(e)})),(0,l.useImperativeHandle)(e,(()=>function(t){const e={pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)};return Object.defineProperty(e,"deck",{get:()=>t.deck}),e}(n)),[]);const{viewManager:x}=n.deck||{},w=x&&x.getViewports(),{ContextProvider:E,width:S,height:T,id:P,style:M}=t,{containerStyle:C,canvasStyle:I}=(0,l.useMemo)((()=>function({width:t,height:e,style:n}){const r={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},i={left:0,top:0};if(n)for(const t in n)t in v?i[t]=n[t]:r[t]=n[t];return{containerStyle:r,canvasStyle:i}}({width:S,height:T,style:M})),[S,T,M]);if(!n.viewStateUpdateRequested&&n.lastRenderedViewports===w||n.version!==r){n.lastRenderedViewports=w,n.version=r;const t=function({children:t,deck:e,ContextProvider:n}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const i={},o=r.views[0].id;for(const e of t){let t=o,n=e;d(e.type,g.Z)&&(t=e.props.id||o,n=e.props.children);const s=r.getViewport(t),a=r.getViewState(t);if(s){const{x:e,y:r,width:o,height:l}=s;n=_(n,{x:e,y:r,width:o,height:l,viewport:s,viewState:a}),i[t]||(i[t]={viewport:s,children:[]}),i[t].children.push(n)}}return Object.keys(i).map((t=>{const{viewport:r,children:o}=i[t],{x:s,y:a,width:u,height:c}=r,h={position:"absolute",left:s,top:a,width:u,height:c},p="view-".concat(t),f=(0,l.createElement)("div",{key:p,id:p,style:h},...o);if(n){const i={viewport:r,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:n=>{n.viewId=t,e._onViewStateChange(n)}};return(0,l.createElement)(n,{key:p,value:i},f)}return f}))}({children:a.children,deck:n.deck,ContextProvider:E}),e=(0,l.createElement)("canvas",{key:"canvas",id:P||"deckgl-overlay",ref:s,style:I});n.control=(0,l.createElement)("div",{id:"".concat(P||"deckgl","-wrapper"),ref:o,style:C},[e,t])}return u=!1,n.control}));x.propTypes=p.Z.getPropTypes(h()),x.defaultProps=p.Z.defaultProps;const w=x;function E(){return E=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},E.apply(this,arguments)}function S(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function T(t,e){if(t){if("string"==typeof t)return S(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(t,e):void 0}}var P=n(4942);function M(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);s=!0);}catch(t){a=!0,i=t}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return o}}(t,e)||T(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var C=n(4235),I=function(){if("undefined"!=typeof Map)return Map;function t(t,e){var n=-1;return t.some((function(t,r){return t[0]===e&&(n=r,!0)})),n}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var n=t(this.__entries__,e),r=this.__entries__[n];return r&&r[1]},e.prototype.set=function(e,n){var r=t(this.__entries__,e);~r?this.__entries__[r][1]=n:this.__entries__.push([e,n])},e.prototype.delete=function(e){var n=this.__entries__,r=t(n,e);~r&&n.splice(r,1)},e.prototype.has=function(e){return!!~t(this.__entries__,e)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,e){void 0===e&&(e=null);for(var n=0,r=this.__entries__;n<r.length;n++){var i=r[n];t.call(e,i[1],i[0])}},e}()}(),O="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,R=void 0!==n.g&&n.g.Math===Math?n.g:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),L="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(R):function(t){return setTimeout((function(){return t(Date.now())}),1e3/60)},k=["top","right","bottom","left","width","height","size","weight"],D="undefined"!=typeof MutationObserver,N=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(t,e){var n=!1,r=!1,i=0;function o(){n&&(n=!1,t()),r&&a()}function s(){L(o)}function a(){var t=Date.now();if(n){if(t-i<2)return;r=!0}else n=!0,r=!1,setTimeout(s,20);i=t}return a}(this.refresh.bind(this))}return t.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},t.prototype.removeObserver=function(t){var e=this.observers_,n=e.indexOf(t);~n&&e.splice(n,1),!e.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},t.prototype.updateObservers_=function(){var t=this.observers_.filter((function(t){return t.gatherActive(),t.hasActive()}));return t.forEach((function(t){return t.broadcastActive()})),t.length>0},t.prototype.connect_=function(){O&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),D?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){O&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(t){var e=t.propertyName,n=void 0===e?"":e;k.some((function(t){return!!~n.indexOf(t)}))&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),F=function(t,e){for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];Object.defineProperty(t,i,{value:e[i],enumerable:!1,writable:!1,configurable:!0})}return t},B=function(t){return t&&t.ownerDocument&&t.ownerDocument.defaultView||R},z=Z(0,0,0,0);function j(t){return parseFloat(t)||0}function U(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.reduce((function(e,n){return e+j(t["border-"+n+"-width"])}),0)}var V="undefined"!=typeof SVGGraphicsElement?function(t){return t instanceof B(t).SVGGraphicsElement}:function(t){return t instanceof B(t).SVGElement&&"function"==typeof t.getBBox};function G(t){return O?V(t)?function(t){var e=t.getBBox();return Z(0,0,e.width,e.height)}(t):function(t){var e=t.clientWidth,n=t.clientHeight;if(!e&&!n)return z;var r=B(t).getComputedStyle(t),i=function(t){for(var e={},n=0,r=["top","right","bottom","left"];n<r.length;n++){var i=r[n],o=t["padding-"+i];e[i]=j(o)}return e}(r),o=i.left+i.right,s=i.top+i.bottom,a=j(r.width),l=j(r.height);if("border-box"===r.boxSizing&&(Math.round(a+o)!==e&&(a-=U(r,"left","right")+o),Math.round(l+s)!==n&&(l-=U(r,"top","bottom")+s)),!function(t){return t===B(t).document.documentElement}(t)){var u=Math.round(a+o)-e,c=Math.round(l+s)-n;1!==Math.abs(u)&&(a-=u),1!==Math.abs(c)&&(l-=c)}return Z(i.left,i.top,a,l)}(t):z}function Z(t,e,n,r){return{x:t,y:e,width:n,height:r}}var q=function(){function t(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=Z(0,0,0,0),this.target=t}return t.prototype.isActive=function(){var t=G(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},t}(),W=function(t,e){var n=function(t){var e=t.x,n=t.y,r=t.width,i=t.height,o="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,s=Object.create(o.prototype);return F(s,{x:e,y:n,width:r,height:i,top:n,right:e+r,bottom:i+n,left:e}),s}(e);F(this,{target:t,contentRect:n})},H=function(){function t(t,e,n){if(this.activeObservations_=[],this.observations_=new I,"function"!=typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=e,this.callbackCtx_=n}return t.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof B(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)||(e.set(t,new q(t)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof B(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)&&(e.delete(t),e.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach((function(e){e.isActive()&&t.activeObservations_.push(e)}))},t.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,e=this.activeObservations_.map((function(t){return new W(t.target,t.broadcastRect())}));this.callback_.call(t,e,t),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),X="undefined"!=typeof WeakMap?new WeakMap:new I,$=function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=N.getInstance(),r=new H(e,n,this);X.set(this,r)};["observe","unobserve","disconnect"].forEach((function(t){$.prototype[t]=function(){var e;return(e=X.get(this))[t].apply(e,arguments)}}));const Y=void 0!==R.ResizeObserver?R.ResizeObserver:$;function Q(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function K(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function J(t,e,n){return e&&K(t.prototype,e),n&&K(t,n),t}"undefined"!=typeof window?window:n.g,void 0!==n.g?n.g:window;var tt="undefined"!=typeof document?document:{};function et(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function nt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?et(Object(n),!0).forEach((function(e){(0,P.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function rt(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return it(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?it(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function it(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var ot=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function st(t){if(!t)return null;if("string"==typeof t)return t;t.toJS&&(t=t.toJS());var e,n={},r=rt(t.layers);try{for(r.s();!(e=r.n()).done;){var i=e.value;n[i.id]=i}}catch(t){r.e(t)}finally{r.f()}var o=t.layers.map((function(t){var e=n[t.ref],r=null;if("interactive"in t&&delete(r=nt({},t)).interactive,e){delete(r=r||nt({},t)).ref;var i,o=rt(ot);try{for(o.s();!(i=o.n()).done;){var s=i.value;s in e&&(r[s]=e[s])}}catch(t){o.e(t)}finally{o.f()}}return r||t}));return nt(nt({},t),{},{layers:o})}var at={container:c.object,gl:c.object,mapboxApiAccessToken:c.string,mapboxApiUrl:c.string,attributionControl:c.bool,preserveDrawingBuffer:c.bool,reuseMaps:c.bool,transformRequest:c.func,mapOptions:c.object,mapStyle:c.oneOfType([c.string,c.object]),preventStyleDiffing:c.bool,visible:c.bool,asyncRender:c.bool,onLoad:c.func,onError:c.func,width:c.number,height:c.number,viewState:c.object,longitude:c.number,latitude:c.number,zoom:c.number,bearing:c.number,pitch:c.number,altitude:c.number},lt={container:tt.body,mapboxApiAccessToken:function(){var t=null;if("undefined"!=typeof window&&window.location){var e=window.location.search.match(/access_token=([^&\/]*)/);t=e&&e[1]}return t||"undefined"==typeof process||(t=t||"MISSING_ENV_VAR".MapboxAccessToken||"MISSING_ENV_VAR".REACT_APP_MAPBOX_ACCESS_TOKEN),t||"no-token"}(),mapboxApiUrl:"https://api.mapbox.com",preserveDrawingBuffer:!1,attributionControl:!0,reuseMaps:!1,mapOptions:{},mapStyle:"mapbox://styles/mapbox/light-v8",preventStyleDiffing:!1,visible:!0,asyncRender:!1,onLoad:function(){},onError:function(t){t&&console.error(t.error)},width:0,height:0,longitude:0,latitude:0,zoom:0,bearing:0,pitch:0,altitude:1.5};function ut(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"component";t.debug&&c.checkPropTypes(at,t,"prop",e)}var ct=function(){function t(e){var n=this;if(Q(this,t),(0,P.Z)(this,"props",lt),(0,P.Z)(this,"width",0),(0,P.Z)(this,"height",0),(0,P.Z)(this,"_fireLoadEvent",(function(){n.props.onLoad({type:"load",target:n._map})})),(0,P.Z)(this,"_handleError",(function(t){n.props.onError(t)})),!e.mapboxgl)throw new Error("Mapbox not available");this.mapboxgl=e.mapboxgl,t.initialized||(t.initialized=!0,this._checkStyleSheet(this.mapboxgl.version)),this._initialize(e)}return J(t,[{key:"finalize",value:function(){return this._destroy(),this}},{key:"setProps",value:function(t){return this._update(this.props,t),this}},{key:"redraw",value:function(){var t=this._map;t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}},{key:"getMap",value:function(){return this._map}},{key:"_reuse",value:function(e){this._map=t.savedMap;var n=this._map.getContainer(),r=e.container;for(r.classList.add("mapboxgl-map");n.childNodes.length>0;)r.appendChild(n.childNodes[0]);this._map._container=r,t.savedMap=null,e.mapStyle&&this._map.setStyle(st(e.mapStyle),{diff:!1}),this._map.isStyleLoaded()?this._fireLoadEvent():this._map.once("styledata",this._fireLoadEvent)}},{key:"_create",value:function(e){if(e.reuseMaps&&t.savedMap)this._reuse(e);else{if(e.gl){var n=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=function(){return HTMLCanvasElement.prototype.getContext=n,e.gl}}var r={container:e.container,center:[0,0],zoom:8,pitch:0,bearing:0,maxZoom:24,style:st(e.mapStyle),interactive:!1,trackResize:!1,attributionControl:e.attributionControl,preserveDrawingBuffer:e.preserveDrawingBuffer};e.transformRequest&&(r.transformRequest=e.transformRequest),this._map=new this.mapboxgl.Map(Object.assign({},r,e.mapOptions)),this._map.once("load",this._fireLoadEvent),this._map.on("error",this._handleError)}return this}},{key:"_destroy",value:function(){this._map&&(this.props.reuseMaps&&!t.savedMap?(t.savedMap=this._map,this._map.off("load",this._fireLoadEvent),this._map.off("error",this._handleError),this._map.off("styledata",this._fireLoadEvent)):this._map.remove(),this._map=null)}},{key:"_initialize",value:function(t){var e=this;ut(t=Object.assign({},lt,t),"Mapbox"),this.mapboxgl.accessToken=t.mapboxApiAccessToken||lt.mapboxApiAccessToken,this.mapboxgl.baseApiUrl=t.mapboxApiUrl,this._create(t);var n=t.container;Object.defineProperty(n,"offsetWidth",{get:function(){return e.width}}),Object.defineProperty(n,"clientWidth",{get:function(){return e.width}}),Object.defineProperty(n,"offsetHeight",{get:function(){return e.height}}),Object.defineProperty(n,"clientHeight",{get:function(){return e.height}});var r=this._map.getCanvas();r&&(r.style.outline="none"),this._updateMapViewport({},t),this._updateMapSize({},t),this.props=t}},{key:"_update",value:function(t,e){if(this._map){ut(e=Object.assign({},this.props,e),"Mapbox");var n=this._updateMapViewport(t,e),r=this._updateMapSize(t,e);this._updateMapStyle(t,e),e.asyncRender||!n&&!r||this.redraw(),this.props=e}}},{key:"_updateMapStyle",value:function(t,e){t.mapStyle!==e.mapStyle&&this._map.setStyle(st(e.mapStyle),{diff:!e.preventStyleDiffing})}},{key:"_updateMapSize",value:function(t,e){var n=t.width!==e.width||t.height!==e.height;return n&&(this.width=e.width,this.height=e.height,this._map.resize()),n}},{key:"_updateMapViewport",value:function(t,e){var n=this._getViewState(t),r=this._getViewState(e),i=r.latitude!==n.latitude||r.longitude!==n.longitude||r.zoom!==n.zoom||r.pitch!==n.pitch||r.bearing!==n.bearing||r.altitude!==n.altitude;return i&&(this._map.jumpTo(this._viewStateToMapboxProps(r)),r.altitude!==n.altitude&&(this._map.transform.altitude=r.altitude)),i}},{key:"_getViewState",value:function(t){var e=t.viewState||t,n=e.longitude,r=e.latitude,i=e.zoom,o=e.pitch,s=void 0===o?0:o,a=e.bearing,l=void 0===a?0:a,u=e.altitude;return{longitude:n,latitude:r,zoom:i,pitch:s,bearing:l,altitude:void 0===u?1.5:u}}},{key:"_checkStyleSheet",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0.47.0";if(void 0!==tt)try{var e=tt.createElement("div");e.className="mapboxgl-map",e.style.display="none",tt.body.appendChild(e);var n="static"!==window.getComputedStyle(e).position;if(!n){var r=tt.createElement("link");r.setAttribute("rel","stylesheet"),r.setAttribute("type","text/css"),r.setAttribute("href","https://api.tiles.mapbox.com/mapbox-gl-js/v".concat(t,"/mapbox-gl.css")),tt.head.appendChild(r)}}catch(t){}}},{key:"_viewStateToMapboxProps",value:function(t){return{center:[t.longitude,t.latitude],zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}}}]),t}();(0,P.Z)(ct,"initialized",!1),(0,P.Z)(ct,"propTypes",at),(0,P.Z)(ct,"defaultProps",lt),(0,P.Z)(ct,"savedMap",null);var ht=n(6158),pt=n.n(ht);function ft(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function dt(t,e){if(t===e)return!0;if(ft(t)&&ft(e)){if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!dt(t[n],e[n]))return!1;return!0}return Math.abs(t-e)<=1e-7}function gt(t,e,n){return Math.max(e,Math.min(n,t))}function mt(t,e,n){return ft(t)?t.map((function(t,r){return mt(t,e[r],n)})):n*e+(1-n)*t}function At(t,e){if(!t)throw new Error(e||"react-map-gl: assertion failed.")}function yt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function _t(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?yt(Object(n),!0).forEach((function(e){(0,P.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):yt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var vt={minZoom:0,maxZoom:24,minPitch:0,maxPitch:85},bt=function(){function t(e){var n=e.width,r=e.height,i=e.latitude,o=e.longitude,s=e.zoom,a=e.bearing,l=void 0===a?0:a,u=e.pitch,c=void 0===u?0:u,h=e.altitude,p=void 0===h?1.5:h,f=e.maxZoom,d=void 0===f?vt.maxZoom:f,g=e.minZoom,m=void 0===g?vt.minZoom:g,A=e.maxPitch,y=void 0===A?vt.maxPitch:A,_=e.minPitch,v=void 0===_?vt.minPitch:_,b=e.transitionDuration,x=e.transitionEasing,w=e.transitionInterpolator,E=e.transitionInterruption,S=e.startPanLngLat,T=e.startZoomLngLat,P=e.startRotatePos,M=e.startBearing,C=e.startPitch,I=e.startZoom;Q(this,t),At(Number.isFinite(n),"`width` must be supplied"),At(Number.isFinite(r),"`height` must be supplied"),At(Number.isFinite(o),"`longitude` must be supplied"),At(Number.isFinite(i),"`latitude` must be supplied"),At(Number.isFinite(s),"`zoom` must be supplied"),this._viewportProps=this._applyConstraints({width:n,height:r,latitude:i,longitude:o,zoom:s,bearing:l,pitch:c,altitude:p,maxZoom:d,minZoom:m,maxPitch:y,minPitch:v,transitionDuration:b,transitionEasing:x,transitionInterpolator:w,transitionInterruption:E}),this._state={startPanLngLat:S,startZoomLngLat:T,startRotatePos:P,startBearing:M,startPitch:C,startZoom:I}}return J(t,[{key:"getViewportProps",value:function(){return this._viewportProps}},{key:"getState",value:function(){return this._state}},{key:"panStart",value:function(t){var e=t.pos;return this._getUpdatedMapState({startPanLngLat:this._unproject(e)})}},{key:"pan",value:function(t){var e=t.pos,n=t.startPos,r=this._state.startPanLngLat||this._unproject(n);if(!r)return this;var i=M(this._calculateNewLngLat({startPanLngLat:r,pos:e}),2),o=i[0],s=i[1];return this._getUpdatedMapState({longitude:o,latitude:s})}},{key:"panEnd",value:function(){return this._getUpdatedMapState({startPanLngLat:null})}},{key:"rotateStart",value:function(t){var e=t.pos;return this._getUpdatedMapState({startRotatePos:e,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}},{key:"rotate",value:function(t){var e,n=t.pos,r=t.deltaAngleX,i=void 0===r?0:r,o=t.deltaAngleY,s=void 0===o?0:o,a=this._state,l=a.startRotatePos,u=a.startBearing,c=a.startPitch;return Number.isFinite(u)&&Number.isFinite(c)?(e=n?this._calculateNewPitchAndBearing(_t(_t({},this._getRotationParams(n,l)),{},{startBearing:u,startPitch:c})):{bearing:u+i,pitch:c+s},this._getUpdatedMapState(e)):this}},{key:"rotateEnd",value:function(){return this._getUpdatedMapState({startBearing:null,startPitch:null})}},{key:"zoomStart",value:function(t){var e=t.pos;return this._getUpdatedMapState({startZoomLngLat:this._unproject(e),startZoom:this._viewportProps.zoom})}},{key:"zoom",value:function(t){var e=t.pos,n=t.startPos,r=t.scale;At(r>0,"`scale` must be a positive number");var i=this._state,o=i.startZoom,s=i.startZoomLngLat;Number.isFinite(o)||(o=this._viewportProps.zoom,s=this._unproject(n)||this._unproject(e)),At(s,"`startZoomLngLat` prop is required for zoom behavior to calculate where to position the map.");var a=this._calculateNewZoom({scale:r,startZoom:o||0}),l=M(new C.default(Object.assign({},this._viewportProps,{zoom:a})).getMapCenterByLngLatPosition({lngLat:s,pos:e}),2),u=l[0],c=l[1];return this._getUpdatedMapState({zoom:a,longitude:u,latitude:c})}},{key:"zoomEnd",value:function(){return this._getUpdatedMapState({startZoomLngLat:null,startZoom:null})}},{key:"_getUpdatedMapState",value:function(e){return new t(Object.assign({},this._viewportProps,this._state,e))}},{key:"_applyConstraints",value:function(t){var e=t.maxZoom,n=t.minZoom,r=t.zoom;t.zoom=gt(r,n,e);var i=t.maxPitch,o=t.minPitch,s=t.pitch;return t.pitch=gt(s,o,i),Object.assign(t,(0,C.normalizeViewportProps)(t)),t}},{key:"_unproject",value:function(t){var e=new C.default(this._viewportProps);return t&&e.unproject(t)}},{key:"_calculateNewLngLat",value:function(t){var e=t.startPanLngLat,n=t.pos;return new C.default(this._viewportProps).getMapCenterByLngLatPosition({lngLat:e,pos:n})}},{key:"_calculateNewZoom",value:function(t){var e=t.scale,n=t.startZoom,r=this._viewportProps,i=r.maxZoom,o=r.minZoom;return gt(n+Math.log2(e),o,i)}},{key:"_calculateNewPitchAndBearing",value:function(t){var e=t.deltaScaleX,n=t.deltaScaleY,r=t.startBearing,i=t.startPitch;n=gt(n,-1,1);var o=this._viewportProps,s=o.minPitch,a=o.maxPitch,l=i;return n>0?l=i+n*(a-i):n<0&&(l=i-n*(s-i)),{pitch:l,bearing:r+180*e}}},{key:"_getRotationParams",value:function(t,e){var n=t[0]-e[0],r=t[1]-e[1],i=t[1],o=e[1],s=this._viewportProps,a=s.width,l=s.height,u=n/a,c=0;return r>0?Math.abs(l-o)>5&&(c=r/(o-l)*1.2):r<0&&o>5&&(c=1-i/o),{deltaScaleX:u,deltaScaleY:c=Math.min(1,Math.max(-1,c))}}}]),t}();function xt(t){return t[0].toLowerCase()+t.slice(1)}function wt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Et(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?wt(Object(n),!0).forEach((function(e){(0,P.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):wt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var St=(0,l.createContext)({viewport:null,map:null,container:null,onViewportChange:null,onViewStateChange:null,eventManager:null}),Tt=St.Provider;St.Provider=function(t){var e=t.value,n=t.children,r=M((0,l.useState)(null),2),i=r[0],o=r[1],s=(0,l.useContext)(St);return e=Et(Et({setMap:o},s),{},{map:s&&s.map||i},e),l.createElement(Tt,{value:e},n)};const Pt=St,Mt="undefined"!=typeof window?l.useLayoutEffect:l.useEffect;function Ct(t,e){var n=e.longitude,r=e.latitude;return t&&t.queryTerrainElevation&&t.queryTerrainElevation([n,r])||0}function It(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ot(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?It(Object(n),!0).forEach((function(e){(0,P.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):It(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Rt="A valid API access token is required to use Mapbox data";function Lt(t){var e=t.map,n=t.props,r=t.width,i=t.height,o=Ot(Ot(Ot({},n),n.viewState),{},{width:r,height:i});return o.position=[0,0,Ct(e,o)],new C.default(o)}var kt={position:"absolute",width:"100%",height:"100%",overflow:"hidden"},Dt=Object.assign({},ct.propTypes,{width:c.oneOfType([c.number,c.string]),height:c.oneOfType([c.number,c.string]),onResize:c.func,disableTokenWarning:c.bool,visible:c.bool,className:c.string,style:c.object,visibilityConstraints:c.object}),Nt=Object.assign({},ct.defaultProps,{disableTokenWarning:!1,visible:!0,onResize:function(){},className:"",style:null,visibilityConstraints:vt});function Ft(){return l.createElement("div",{key:"warning",id:"no-token-warning",style:{position:"absolute",left:0,top:0}},l.createElement("h3",{key:"header"},Rt),l.createElement("div",{key:"text"},"For information on setting up your basemap, read"),l.createElement("a",{key:"link",href:"https://visgl.github.io/react-map-gl/docs/get-started/mapbox-tokens"},"Note on Map Tokens"))}var Bt=(0,l.forwardRef)((function(t,e){var n=M((0,l.useState)(!0),2),r=n[0],i=n[1],o=M((0,l.useState)({width:0,height:0}),2),s=o[0],a=o[1],u=(0,l.useRef)(null),c=(0,l.useRef)(null),h=(0,l.useRef)(null),p=(0,l.useRef)(null),f=(0,l.useContext)(Pt);Mt((function(){if(Bt.supported()){var e=new ct(Ot(Ot(Ot({},t),s),{},{mapboxgl:pt(),container:c.current,onError:function(e){401===(e.error&&e.error.status||e.status)&&r&&(console.error(Rt),i(!1)),t.onError(e)}}));u.current=e,f&&f.setMap&&f.setMap(e.getMap());var n=new Y((function(e){if(e[0].contentRect){var n=e[0].contentRect,r=n.width,i=n.height;a({width:r,height:i}),t.onResize({width:r,height:i})}}));return n.observe(h.current),function(){e.finalize(),u.current=null,n.disconnect()}}}),[]),Mt((function(){u.current&&u.current.setProps(Ot(Ot({},t),s))}));var d=u.current&&u.current.getMap();(0,l.useImperativeHandle)(e,(function(){return function(t){return{getMap:function(){return t.current&&t.current.getMap()},queryRenderedFeatures:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.current&&t.current.getMap();return r&&r.queryRenderedFeatures(e,n)}}}(u)}),[]);var g=(0,l.useCallback)((function(t){var e=t.target;e===p.current&&e.scrollTo(0,0)}),[]),m=d&&l.createElement(Tt,{value:Ot(Ot({},f),{},{viewport:f.viewport||Lt(Ot({map:d,props:t},s)),map:d,container:f.container||h.current})},l.createElement("div",{key:"map-overlays",className:"overlays",ref:p,style:kt,onScroll:g},t.children)),A=t.className,y=t.width,_=t.height,v=t.style,b=t.visibilityConstraints,x=Object.assign({position:"relative"},v,{width:y,height:_}),w=t.visible&&function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vt;for(var n in e){var r=n.slice(0,3),i=xt(n.slice(3));if("min"===r&&t[i]<e[n])return!1;if("max"===r&&t[i]>e[n])return!1}return!0}(t.viewState||t,b),E=Object.assign({},kt,{visibility:w?"inherit":"hidden"});return l.createElement("div",{key:"map-container",ref:h,style:x},l.createElement("div",{key:"map-mapbox",ref:c,style:E,className:A}),m,!r&&!t.disableTokenWarning&&l.createElement(Ft,null))}));Bt.supported=function(){return pt()&&pt().supported()},Bt.propTypes=Dt,Bt.defaultProps=Nt;const zt=Bt;function jt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Ut=function(){function t(){Q(this,t),(0,P.Z)(this,"propNames",[])}return J(t,[{key:"arePropsEqual",value:function(t,e){var n,r=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return jt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}(this.propNames||[]);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!dt(t[i],e[i]))return!1}}catch(t){r.e(t)}finally{r.f()}return!0}},{key:"initializeProps",value:function(t,e){return{start:t,end:e}}},{key:"interpolateProps",value:function(t,e,n){At(!1,"interpolateProps is not implemented")}},{key:"getDuration",value:function(t,e){return e.transitionDuration}}]),t}();function Vt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Gt(t,e){return Gt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Gt(t,e)}function Zt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gt(t,e)}function qt(t){return qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qt(t)}function Wt(t,e){if(e&&("object"===qt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Vt(t)}function Ht(t){return Ht=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ht(t)}var Xt={longitude:1,bearing:1};function $t(t){return Number.isFinite(t)||Array.isArray(t)}function Yt(t,e,n){return function(t){return t in Xt}(t)&&Math.abs(n-e)>180&&(n=n<0?n+360:n-360),n}function Qt(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Kt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Kt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function Kt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Jt=["longitude","latitude","zoom","bearing","pitch"],te=["latitude","longitude","zoom","width","height"],ee=["bearing","pitch"],ne={speed:1.2,curve:1.414};function re(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return ie(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ie(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function ie(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}!function(t){Zt(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=Ht(e);if(n){var i=Ht(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return Wt(this,t)});function i(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Q(this,i),t=r.call(this),(0,P.Z)(Vt(t),"propNames",Jt),t.props=Object.assign({},ne,e),t}J(i,[{key:"initializeProps",value:function(t,e){var n,r={},i={},o=Qt(te);try{for(o.s();!(n=o.n()).done;){var s=n.value,a=t[s],l=e[s];At($t(a)&&$t(l),"".concat(s," must be supplied for transition")),r[s]=a,i[s]=Yt(s,a,l)}}catch(t){o.e(t)}finally{o.f()}var u,c=Qt(ee);try{for(c.s();!(u=c.n()).done;){var h=u.value,p=t[h]||0,f=e[h]||0;r[h]=p,i[h]=Yt(h,p,f)}}catch(t){c.e(t)}finally{c.f()}return{start:r,end:i}}},{key:"interpolateProps",value:function(t,e,n){var r,i=(0,C.flyToViewport)(t,e,n,this.props),o=Qt(ee);try{for(o.s();!(r=o.n()).done;){var s=r.value;i[s]=mt(t[s],e[s],n)}}catch(t){o.e(t)}finally{o.f()}return i}},{key:"getDuration",value:function(t,e){var n=e.transitionDuration;return"auto"===n&&(n=(0,C.getFlyToDuration)(t,e,this.props)),n}}])}(Ut);var oe=["longitude","latitude","zoom","bearing","pitch"],se=function(t){Zt(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=Ht(e);if(n){var i=Ht(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return Wt(this,t)});function i(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Q(this,i),t=r.call(this),Array.isArray(e)&&(e={transitionProps:e}),t.propNames=e.transitionProps||oe,e.around&&(t.around=e.around),t}return J(i,[{key:"initializeProps",value:function(t,e){var n={},r={};if(this.around){n.around=this.around;var i=new C.default(t).unproject(this.around);Object.assign(r,e,{around:new C.default(e).project(i),aroundLngLat:i})}var o,s=re(this.propNames);try{for(s.s();!(o=s.n()).done;){var a=o.value,l=t[a],u=e[a];At($t(l)&&$t(u),"".concat(a," must be supplied for transition")),n[a]=l,r[a]=Yt(a,l,u)}}catch(t){s.e(t)}finally{s.f()}return{start:n,end:r}}},{key:"interpolateProps",value:function(t,e,n){var r,i={},o=re(this.propNames);try{for(o.s();!(r=o.n()).done;){var s=r.value;i[s]=mt(t[s],e[s],n)}}catch(t){o.e(t)}finally{o.f()}if(e.around){var a=M(new C.default(Object.assign({},e,i)).getMapCenterByLngLatPosition({lngLat:e.aroundLngLat,pos:mt(t.around,e.around,n)}),2),l=a[0],u=a[1];i.longitude=l,i.latitude=u}return i}}]),i}(Ut),ae=function(){},le={transitionDuration:0,transitionEasing:function(t){return t},transitionInterpolator:new se,transitionInterruption:1,onTransitionStart:ae,onTransitionInterrupt:ae,onTransitionEnd:ae},ue=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Q(this,t),(0,P.Z)(this,"_animationFrame",null),(0,P.Z)(this,"_onTransitionFrame",(function(){e._animationFrame=requestAnimationFrame(e._onTransitionFrame),e._updateViewport()})),this.props=null,this.onViewportChange=n.onViewportChange||ae,this.onStateChange=n.onStateChange||ae,this.time=n.getTime||Date.now}return J(t,[{key:"getViewportInTransition",value:function(){return this._animationFrame?this.state.propsInTransition:null}},{key:"processViewportChange",value:function(t){var e=this.props;if(this.props=t,!e||this._shouldIgnoreViewportChange(e,t))return!1;if(this._isTransitionEnabled(t)){var n=Object.assign({},e),r=Object.assign({},t);if(this._isTransitionInProgress()&&(e.onTransitionInterrupt(),2===this.state.interruption?Object.assign(n,this.state.endProps):Object.assign(n,this.state.propsInTransition),4===this.state.interruption)){var i=this.time(),o=(i-this.state.startTime)/this.state.duration;r.transitionDuration=this.state.duration-(i-this.state.startTime),r.transitionEasing=function(t,e){var n=t(e);return function(r){return 1/(1-n)*(t(r*(1-e)+e)-n)}}(this.state.easing,o),r.transitionInterpolator=n.transitionInterpolator}return r.onTransitionStart(),this._triggerTransition(n,r),!0}return this._isTransitionInProgress()&&(e.onTransitionInterrupt(),this._endTransition()),!1}},{key:"_isTransitionInProgress",value:function(){return Boolean(this._animationFrame)}},{key:"_isTransitionEnabled",value:function(t){var e=t.transitionDuration,n=t.transitionInterpolator;return(e>0||"auto"===e)&&Boolean(n)}},{key:"_isUpdateDueToCurrentTransition",value:function(t){return!!this.state.propsInTransition&&this.state.interpolator.arePropsEqual(t,this.state.propsInTransition)}},{key:"_shouldIgnoreViewportChange",value:function(t,e){return!t||(this._isTransitionInProgress()?3===this.state.interruption||this._isUpdateDueToCurrentTransition(e):!this._isTransitionEnabled(e)||e.transitionInterpolator.arePropsEqual(t,e))}},{key:"_triggerTransition",value:function(t,e){At(this._isTransitionEnabled(e)),this._animationFrame&&cancelAnimationFrame(this._animationFrame);var n=e.transitionInterpolator,r=n.getDuration?n.getDuration(t,e):e.transitionDuration;if(0!==r){var i=e.transitionInterpolator.initializeProps(t,e),o={inTransition:!0,isZooming:t.zoom!==e.zoom,isPanning:t.longitude!==e.longitude||t.latitude!==e.latitude,isRotating:t.bearing!==e.bearing||t.pitch!==e.pitch};this.state={duration:r,easing:e.transitionEasing,interpolator:e.transitionInterpolator,interruption:e.transitionInterruption,startTime:this.time(),startProps:i.start,endProps:i.end,animation:null,propsInTransition:{}},this._onTransitionFrame(),this.onStateChange(o)}}},{key:"_endTransition",value:function(){this._animationFrame&&(cancelAnimationFrame(this._animationFrame),this._animationFrame=null),this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1})}},{key:"_updateViewport",value:function(){var t=this.time(),e=this.state,n=e.startTime,r=e.duration,i=e.easing,o=e.interpolator,s=e.startProps,a=e.endProps,l=!1,u=(t-n)/r;u>=1&&(u=1,l=!0),u=i(u);var c=o.interpolateProps(s,a,u),h=new bt(Object.assign({},this.props,c));this.state.propsInTransition=h.getViewportProps(),this.onViewportChange(this.state.propsInTransition,this.props),l&&(this._endTransition(),this.props.onTransitionEnd())}}]),t}();(0,P.Z)(ue,"defaultProps",le);var ce=n(2317);function he(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function pe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?he(Object(n),!0).forEach((function(e){(0,P.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):he(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var fe={transitionDuration:0},de={transitionDuration:300,transitionEasing:function(t){return t},transitionInterpolator:new se,transitionInterruption:1},ge=300,me=function(t){return 1-(1-t)*(1-t)},Ae=["wheel"],ye=["panstart","panmove","panend"],_e=["pinchstart","pinchmove","pinchend"],ve=["tripanstart","tripanmove","tripanend"],be=["doubletap"],xe=["keydown"],we=function(){function t(){var e=this;Q(this,t),(0,P.Z)(this,"events",[]),(0,P.Z)(this,"scrollZoom",!0),(0,P.Z)(this,"dragPan",!0),(0,P.Z)(this,"dragRotate",!0),(0,P.Z)(this,"doubleClickZoom",!0),(0,P.Z)(this,"touchZoom",!0),(0,P.Z)(this,"touchRotate",!1),(0,P.Z)(this,"keyboard",!0),(0,P.Z)(this,"_interactionState",{isDragging:!1}),(0,P.Z)(this,"_events",{}),(0,P.Z)(this,"_setInteractionState",(function(t){Object.assign(e._interactionState,t),e.onStateChange&&e.onStateChange(e._interactionState)})),(0,P.Z)(this,"_onTransition",(function(t,n){e.onViewportChange(t,e._interactionState,n)})),this.handleEvent=this.handleEvent.bind(this),this._transitionManager=new ue({onViewportChange:this._onTransition,onStateChange:this._setInteractionState})}return J(t,[{key:"handleEvent",value:function(t){this.mapState=this.getMapState();var e=this._eventStartBlocked;switch(t.type){case"panstart":return!e&&this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return!e&&this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"tripanstart":return!e&&this._onTriplePanStart(t);case"tripanmove":return this._onTriplePan(t);case"tripanend":return this._onTriplePanEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}},{key:"getCenter",value:function(t){var e=t.offsetCenter;return[e.x,e.y]}},{key:"isFunctionKeyPressed",value:function(t){var e=t.srcEvent;return Boolean(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}},{key:"blockEvents",value:function(t){var e=this,n=setTimeout((function(){e._eventStartBlocked===n&&(e._eventStartBlocked=null)}),t);this._eventStartBlocked=n}},{key:"updateViewport",value:function(t,e,n){var r=this.mapState instanceof bt?this.mapState.getViewportProps():this.mapState,i=pe(pe({},t.getViewportProps()),e),o=Object.keys(i).some((function(t){return r[t]!==i[t]}));this._state=t.getState(),this._setInteractionState(n),o&&this.onViewportChange(i,this._interactionState,r)}},{key:"getMapState",value:function(t){return new bt(pe(pe(pe({},this.mapStateProps),this._state),t))}},{key:"isDragging",value:function(){return this._interactionState.isDragging}},{key:"setOptions",value:function(t){var e=t.onViewportChange,n=t.onStateChange,r=t.eventManager,i=void 0===r?this.eventManager:r,o=t.isInteractive,s=void 0===o||o,a=t.scrollZoom,l=void 0===a?this.scrollZoom:a,u=t.dragPan,c=void 0===u?this.dragPan:u,h=t.dragRotate,p=void 0===h?this.dragRotate:h,f=t.doubleClickZoom,d=void 0===f?this.doubleClickZoom:f,g=t.touchZoom,m=void 0===g?this.touchZoom:g,A=t.touchRotate,y=void 0===A?this.touchRotate:A,_=t.keyboard,v=void 0===_?this.keyboard:_;this.onViewportChange=e,this.onStateChange=n;var b=this.mapStateProps||{},x=b.height!==t.height||b.width!==t.width;this.mapStateProps=t,x&&(this.mapState=b,this.updateViewport(new bt(t))),this._transitionManager.processViewportChange(t),this.eventManager!==i&&(this.eventManager=i,this._events={},this.toggleEvents(this.events,!0)),this.toggleEvents(Ae,s&&Boolean(l)),this.toggleEvents(ye,s&&Boolean(c||p)),this.toggleEvents(_e,s&&Boolean(m||y)),this.toggleEvents(ve,s&&Boolean(y)),this.toggleEvents(be,s&&Boolean(d)),this.toggleEvents(xe,s&&Boolean(v)),this.scrollZoom=l,this.dragPan=c,this.dragRotate=p,this.doubleClickZoom=d,this.touchZoom=m,this.touchRotate=y,this.keyboard=v}},{key:"toggleEvents",value:function(t,e){var n=this;this.eventManager&&t.forEach((function(t){n._events[t]!==e&&(n._events[t]=e,e?n.eventManager.on(t,n.handleEvent):n.eventManager.off(t,n.handleEvent))}))}},{key:"_onPanStart",value:function(t){var e=this.getCenter(t);this._panRotate=this.isFunctionKeyPressed(t)||t.rightButton;var n=this._panRotate?this.mapState.rotateStart({pos:e}):this.mapState.panStart({pos:e});return this.updateViewport(n,fe,{isDragging:!0}),!0}},{key:"_onPan",value:function(t){return!!this.isDragging()&&(this._panRotate?this._onPanRotate(t):this._onPanMove(t))}},{key:"_onPanEnd",value:function(t){return!!this.isDragging()&&(this._panRotate?this._onPanRotateEnd(t):this._onPanMoveEnd(t))}},{key:"_onPanMove",value:function(t){if(!this.dragPan)return!1;var e=this.getCenter(t),n=this.mapState.pan({pos:e});return this.updateViewport(n,fe,{isPanning:!0}),!0}},{key:"_onPanMoveEnd",value:function(t){if(this.dragPan){var e=this.dragPan.inertia,n=void 0===e?ge:e;if(n&&t.velocity){var r=this.getCenter(t),i=[r[0]+t.velocityX*n/2,r[1]+t.velocityY*n/2],o=this.mapState.pan({pos:i}).panEnd();return this.updateViewport(o,pe(pe({},de),{},{transitionDuration:n,transitionEasing:me}),{isDragging:!1,isPanning:!0}),!0}}var s=this.mapState.panEnd();return this.updateViewport(s,null,{isDragging:!1,isPanning:!1}),!0}},{key:"_onPanRotate",value:function(t){if(!this.dragRotate)return!1;var e=this.getCenter(t),n=this.mapState.rotate({pos:e});return this.updateViewport(n,fe,{isRotating:!0}),!0}},{key:"_onPanRotateEnd",value:function(t){if(this.dragRotate){var e=this.dragRotate.inertia,n=void 0===e?ge:e;if(n&&t.velocity){var r=this.getCenter(t),i=[r[0]+t.velocityX*n/2,r[1]+t.velocityY*n/2],o=this.mapState.rotate({pos:i}).rotateEnd();return this.updateViewport(o,pe(pe({},de),{},{transitionDuration:n,transitionEasing:me}),{isDragging:!1,isRotating:!0}),!0}}var s=this.mapState.panEnd();return this.updateViewport(s,null,{isDragging:!1,isRotating:!1}),!0}},{key:"_onWheel",value:function(t){if(!this.scrollZoom)return!1;var e=this.scrollZoom,n=e.speed,r=void 0===n?.01:n,i=e.smooth,o=void 0!==i&&i;t.preventDefault();var s=this.getCenter(t),a=t.delta,l=2/(1+Math.exp(-Math.abs(a*r)));a<0&&0!==l&&(l=1/l);var u=this.mapState.zoom({pos:s,scale:l});return u.getViewportProps().zoom!==this.mapStateProps.zoom&&(this.updateViewport(u,pe(pe({},de),{},{transitionInterpolator:new se({around:s}),transitionDuration:o?250:1}),{isPanning:!0,isZooming:!0}),!0)}},{key:"_onPinchStart",value:function(t){var e=this.getCenter(t),n=this.mapState.zoomStart({pos:e}).rotateStart({pos:e});return this._startPinchRotation=t.rotation,this._lastPinchEvent=t,this.updateViewport(n,fe,{isDragging:!0}),!0}},{key:"_onPinch",value:function(t){if(!this.isDragging())return!1;if(!this.touchZoom&&!this.touchRotate)return!1;var e=this.mapState;if(this.touchZoom){var n=t.scale,r=this.getCenter(t);e=e.zoom({pos:r,scale:n})}if(this.touchRotate){var i=t.rotation;e=e.rotate({deltaAngleX:this._startPinchRotation-i})}return this.updateViewport(e,fe,{isDragging:!0,isPanning:Boolean(this.touchZoom),isZooming:Boolean(this.touchZoom),isRotating:Boolean(this.touchRotate)}),this._lastPinchEvent=t,!0}},{key:"_onPinchEnd",value:function(t){if(!this.isDragging())return!1;if(this.touchZoom){var e=this.touchZoom.inertia,n=void 0===e?ge:e,r=this._lastPinchEvent;if(n&&r&&t.scale!==r.scale){var i=this.getCenter(t),o=this.mapState.rotateEnd(),s=Math.log2(t.scale),a=(s-Math.log2(r.scale))/(t.deltaTime-r.deltaTime),l=Math.pow(2,s+a*n/2);return o=o.zoom({pos:i,scale:l}).zoomEnd(),this.updateViewport(o,pe(pe({},de),{},{transitionInterpolator:new se({around:i}),transitionDuration:n,transitionEasing:me}),{isDragging:!1,isPanning:Boolean(this.touchZoom),isZooming:Boolean(this.touchZoom),isRotating:!1}),this.blockEvents(n),!0}}var u=this.mapState.zoomEnd().rotateEnd();return this._state.startPinchRotation=0,this.updateViewport(u,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1}),this._startPinchRotation=null,this._lastPinchEvent=null,!0}},{key:"_onTriplePanStart",value:function(t){var e=this.getCenter(t),n=this.mapState.rotateStart({pos:e});return this.updateViewport(n,fe,{isDragging:!0}),!0}},{key:"_onTriplePan",value:function(t){if(!this.isDragging())return!1;if(!this.touchRotate)return!1;var e=this.getCenter(t);e[0]-=t.deltaX;var n=this.mapState.rotate({pos:e});return this.updateViewport(n,fe,{isRotating:!0}),!0}},{key:"_onTriplePanEnd",value:function(t){if(!this.isDragging())return!1;if(this.touchRotate){var e=this.touchRotate.inertia,n=void 0===e?ge:e;if(n&&t.velocityY){var r=this.getCenter(t),i=[r[0],r[1]+=t.velocityY*n/2],o=this.mapState.rotate({pos:i});return this.updateViewport(o,pe(pe({},de),{},{transitionDuration:n,transitionEasing:me}),{isDragging:!1,isRotating:!0}),this.blockEvents(n),!1}}var s=this.mapState.rotateEnd();return this.updateViewport(s,null,{isDragging:!1,isRotating:!1}),!0}},{key:"_onDoubleTap",value:function(t){if(!this.doubleClickZoom)return!1;var e=this.getCenter(t),n=this.isFunctionKeyPressed(t),r=this.mapState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(r,Object.assign({},de,{transitionInterpolator:new se({around:e})}),{isZooming:!0}),!0}},{key:"_onKeyDown",value:function(t){if(!this.keyboard)return!1;var e,n=this.isFunctionKeyPressed(t),r=this.keyboard,i=r.zoomSpeed,o=void 0===i?2:i,s=r.moveSpeed,a=void 0===s?100:s,l=r.rotateSpeedX,u=void 0===l?15:l,c=r.rotateSpeedY,h=void 0===c?10:c,p=this.mapStateProps;switch(t.srcEvent.keyCode){case 189:e=n?this.getMapState({zoom:p.zoom-Math.log2(o)-1}):this.getMapState({zoom:p.zoom-Math.log2(o)});break;case 187:e=n?this.getMapState({zoom:p.zoom+Math.log2(o)+1}):this.getMapState({zoom:p.zoom+Math.log2(o)});break;case 37:e=n?this.getMapState({bearing:p.bearing-u}):this.mapState.pan({pos:[a,0],startPos:[0,0]});break;case 39:e=n?this.getMapState({bearing:p.bearing+u}):this.mapState.pan({pos:[-a,0],startPos:[0,0]});break;case 38:e=n?this.getMapState({pitch:p.pitch+h}):this.mapState.pan({pos:[0,a],startPos:[0,0]});break;case 40:e=n?this.getMapState({pitch:p.pitch-h}):this.mapState.pan({pos:[0,-a],startPos:[0,0]});break;default:return!1}return this.updateViewport(e,de)}}]),t}();function Ee(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Se(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ee(Object(n),!0).forEach((function(e){(0,P.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Te=Object.assign({},zt.propTypes,{maxZoom:c.number,minZoom:c.number,maxPitch:c.number,minPitch:c.number,onViewStateChange:c.func,onViewportChange:c.func,onInteractionStateChange:c.func,transitionDuration:c.oneOfType([c.number,c.string]),transitionInterpolator:c.object,transitionInterruption:c.number,transitionEasing:c.func,onTransitionStart:c.func,onTransitionInterrupt:c.func,onTransitionEnd:c.func,scrollZoom:c.oneOfType([c.bool,c.object]),dragPan:c.oneOfType([c.bool,c.object]),dragRotate:c.oneOfType([c.bool,c.object]),doubleClickZoom:c.bool,touchZoom:c.oneOfType([c.bool,c.object]),touchRotate:c.oneOfType([c.bool,c.object]),keyboard:c.oneOfType([c.bool,c.object]),onHover:c.func,onClick:c.func,onDblClick:c.func,onContextMenu:c.func,onMouseDown:c.func,onMouseMove:c.func,onMouseUp:c.func,onTouchStart:c.func,onTouchMove:c.func,onTouchEnd:c.func,onMouseEnter:c.func,onMouseLeave:c.func,onMouseOut:c.func,onWheel:c.func,touchAction:c.string,eventRecognizerOptions:c.object,clickRadius:c.number,interactiveLayerIds:c.array,getCursor:c.func,controller:c.instanceOf(we)}),Pe=Object.assign({},zt.defaultProps,vt,ue.defaultProps,{onViewStateChange:null,onViewportChange:null,onClick:null,onNativeClick:null,onHover:null,onContextMenu:function(t){return t.preventDefault()},scrollZoom:!0,dragPan:!0,dragRotate:!0,doubleClickZoom:!0,touchZoom:!0,touchRotate:!1,keyboard:!0,touchAction:"none",eventRecognizerOptions:{},clickRadius:0,getCursor:function(t){var e=t.isDragging,n=t.isHovering;return e?"grabbing":n?"pointer":"grab"}});function Me(t){if(t.lngLat||!t.offsetCenter)return t;var e=t.offsetCenter,n=e.x,r=e.y;if(!Number.isFinite(n)||!Number.isFinite(r))return t;var i=[n,r];t.point=i;var o=this.viewport,s=o.unproject(i,{targetZ:o.meterOffset[2]});return t.lngLat=[s[0],s[1]],t}function Ce(t){var e=this.map;if(!e||!t)return null;var n={},r=this.props.clickRadius;this.props.interactiveLayerIds&&(n.layers=this.props.interactiveLayerIds);try{return e.queryRenderedFeatures(r?[[t[0]-r,t[1]+r],[t[0]+r,t[1]-r]]:t,n)}catch(t){return null}}function Ie(t,e){var n=this.props[t];n&&n(Me.call(this,e))}function Oe(t){Ie.call(this,"touch"===t.pointerType?"onTouchStart":"onMouseDown",t)}function Re(t){Ie.call(this,"touch"===t.pointerType?"onTouchEnd":"onMouseUp",t)}function Le(t){if(Ie.call(this,"touch"===t.pointerType?"onTouchMove":"onMouseMove",t),!this.state.isDragging){var e,n=this.props,r=n.onHover,i=n.interactiveLayerIds;t=Me.call(this,t),(i||r)&&(e=Ce.call(this,t.point));var o=Boolean(i&&e&&e.length>0),s=o&&!this.state.isHovering,a=!o&&this.state.isHovering;(r||s)&&(t.features=e,r&&r(t)),s&&Ie.call(this,"onMouseEnter",t),a&&Ie.call(this,"onMouseLeave",t),(s||a)&&this.setState({isHovering:o})}}function ke(t){var e=this.props,n=e.onClick,r=e.onNativeClick,i=e.onDblClick,o=e.doubleClickZoom,s=[],a=i||o;switch(t.type){case"anyclick":s.push(r),a||s.push(n);break;case"click":a&&s.push(n)}(s=s.filter(Boolean)).length&&((t=Me.call(this,t)).features=Ce.call(this,t.point),s.forEach((function(e){return e(t)})))}var De=(0,l.forwardRef)((function(t,e){var n=(0,l.useContext)(Pt),r=(0,l.useMemo)((function(){return t.controller||new we}),[]),i=(0,l.useMemo)((function(){return new ce.Q(null,{touchAction:t.touchAction,recognizerOptions:t.eventRecognizerOptions})}),[]),o=(0,l.useRef)(null),s=(0,l.useRef)(null),a=(0,l.useRef)({width:0,height:0,state:{isHovering:!1,isDragging:!1}}).current;a.props=t,a.map=s.current&&s.current.getMap(),a.setState=function(e){a.state=Se(Se({},a.state),e),o.current.style.cursor=t.getCursor(a.state)};var u,c,h=!0,p=function(t,e,n){if(h)u=[t,e,n];else{var r=a.props,i=r.onViewStateChange,o=r.onViewportChange;Object.defineProperty(t,"position",{get:function(){return[0,0,Ct(a.map,t)]}}),i&&i({viewState:t,interactionState:e,oldViewState:n}),o&&o(t,e,n)}};(0,l.useImperativeHandle)(e,(function(){return function(t){return{getMap:t.current&&t.current.getMap,queryRenderedFeatures:t.current&&t.current.queryRenderedFeatures}}(s)}),[]);var f=(0,l.useMemo)((function(){return Se(Se({},n),{},{eventManager:i,container:n.container||o.current})}),[n,o.current]);f.onViewportChange=p,f.viewport=n.viewport||Lt(a),a.viewport=f.viewport;var d=function(t){var e=t.isDragging,n=void 0!==e&&e;if(n!==a.state.isDragging&&a.setState({isDragging:n}),h)c=t;else{var r=a.props.onInteractionStateChange;r&&r(t)}},g=function(){a.width&&a.height&&r.setOptions(Se(Se(Se({},a.props),a.props.viewState),{},{isInteractive:Boolean(a.props.onViewStateChange||a.props.onViewportChange),onViewportChange:p,onStateChange:d,eventManager:i,width:a.width,height:a.height}))};(0,l.useEffect)((function(){return i.setElement(o.current),i.on({pointerdown:Oe.bind(a),pointermove:Le.bind(a),pointerup:Re.bind(a),pointerleave:Ie.bind(a,"onMouseOut"),click:ke.bind(a),anyclick:ke.bind(a),dblclick:Ie.bind(a,"onDblClick"),wheel:Ie.bind(a,"onWheel"),contextmenu:Ie.bind(a,"onContextMenu")}),function(){i.destroy()}}),[]),Mt((function(){var t;u&&p.apply(void 0,function(t){if(Array.isArray(t))return S(t)}(t=u)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||T(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c&&d(c)})),g();var m=t.width,A=t.height,y=t.style,_=t.getCursor,v=(0,l.useMemo)((function(){return Se(Se({position:"relative"},y),{},{width:m,height:A,cursor:_(a.state)})}),[y,m,A,_,a.state]);return u&&a._child||(a._child=l.createElement(Tt,{value:f},l.createElement("div",{key:"event-canvas",ref:o,style:v},l.createElement(zt,E({},t,{width:"100%",height:"100%",style:null,onResize:function(t){var e=t.width,n=t.height;a.width=e,a.height=n,g(),a.props.onResize({width:e,height:n})},ref:s}))))),h=!1,a._child}));De.supported=zt.supported,De.propTypes=Te,De.defaultProps=Pe;c.string.isRequired,c.string;function Ne(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}c.oneOf(["fill","line","symbol","circle","fill-extrusion","raster","background","heatmap","hillshade","sky"]).isRequired,c.string,c.string,c.string;var Fe={captureScroll:!1,captureDrag:!0,captureClick:!0,captureDoubleClick:!0,capturePointerMove:!1},Be={captureScroll:c.bool,captureDrag:c.bool,captureClick:c.bool,captureDoubleClick:c.bool,capturePointerMove:c.bool};function ze(t){var e=t.containerRef.current,n=t.context.eventManager;if(e&&n){var r={wheel:function(e){var n=t.props;n.captureScroll&&e.stopPropagation(),n.onScroll&&n.onScroll(e,t)},panstart:function(e){var n=t.props;n.captureDrag&&e.stopPropagation(),n.onDragStart&&n.onDragStart(e,t)},anyclick:function(e){var n=t.props;n.captureClick&&e.stopPropagation(),n.onNativeClick&&n.onNativeClick(e,t)},click:function(e){var n=t.props;n.captureClick&&e.stopPropagation(),n.onClick&&n.onClick(e,t)},dblclick:function(e){var n=t.props;n.captureDoubleClick&&e.stopPropagation(),n.onDoubleClick&&n.onDoubleClick(e,t)},pointermove:function(e){var n=t.props;n.capturePointerMove&&e.stopPropagation(),n.onPointerMove&&n.onPointerMove(e,t)}};return n.watch(r,e),function(){n.off(r)}}}function je(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=(0,l.useContext)(Pt),n=(0,l.useRef)(null),r=(0,l.useRef)({props:t,state:{},context:e,containerRef:n}),i=r.current;return i.props=t,i.context=e,(0,l.useEffect)((function(){return ze(i)}),[e.eventManager]),i}function Ue(t){var e=t.instance,n=je(t),r=n.context,i=n.containerRef;return e._context=r,e._containerRef=i,e._render()}var Ve=function(t){Zt(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=Ht(e);if(n){var i=Ht(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return Wt(this,t)});function i(){var t;Q(this,i);for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return t=r.call.apply(r,[this].concat(n)),(0,P.Z)(Vt(t),"_context",{}),(0,P.Z)(Vt(t),"_containerRef",(0,l.createRef)()),(0,P.Z)(Vt(t),"_onScroll",(function(t){})),(0,P.Z)(Vt(t),"_onDragStart",(function(t){})),(0,P.Z)(Vt(t),"_onDblClick",(function(t){})),(0,P.Z)(Vt(t),"_onClick",(function(t){})),(0,P.Z)(Vt(t),"_onPointerMove",(function(t){})),t}return J(i,[{key:"_render",value:function(){throw new Error("_render() not implemented")}},{key:"render",value:function(){return l.createElement(Ue,E({instance:this},this.props,{onScroll:this._onScroll,onDragStart:this._onDragStart,onDblClick:this._onDblClick,onClick:this._onClick,onPointerMove:this._onPointerMove}))}}]),i}(l.PureComponent);function Ge(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ze(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ge(Object(n),!0).forEach((function(e){(0,P.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ge(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}(0,P.Z)(Ve,"propTypes",Be),(0,P.Z)(Ve,"defaultProps",Fe);var qe=Object.assign({},Be,{draggable:c.bool,onDrag:c.func,onDragEnd:c.func,onDragStart:c.func,offsetLeft:c.number,offsetTop:c.number}),We=Object.assign({},Fe,{draggable:!1,offsetLeft:0,offsetTop:0});function He(t){var e=t.offsetCenter;return[e.x,e.y]}function Xe(t,e,n,r){var i=t[0]+e[0]-n.offsetLeft,o=t[1]+e[1]-n.offsetTop;return r.viewport.unproject([i,o])}function $e(t,e){var n=e.props,r=e.callbacks,i=e.state,o=e.context,s=e.containerRef;if(n.draggable){t.stopPropagation();var a=He(t),l=function(t,e){var n=t.center,r=n.x,i=n.y;if(e){var o=e.getBoundingClientRect();return[o.left-r,o.top-i]}return null}(t,s.current);if(i.setDragPos(a),i.setDragOffset(l),r.onDragStart&&l){var u=Object.assign({},t);u.lngLat=Xe(a,l,n,o),r.onDragStart(u)}}}var Ye="undefined"!=typeof window&&window.devicePixelRatio||1,Qe=function(t){return Math.round(t*Ye)/Ye},Ke=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x";if(null===t)return e;var r="x"===n?t.offsetWidth:t.offsetHeight;return Qe(e/100*r)/r*100},Je=Object.assign({},qe,{className:c.string,longitude:c.number.isRequired,latitude:c.number.isRequired}),tn=Object.assign({},We,{className:""});function en(t){var e=function(t){var e=M((0,l.useState)(null),2),n=e[0],r=e[1],i=M((0,l.useState)(null),2),o=i[0],s=i[1],a=je(Ze(Ze({},t),{},{onDragStart:$e}));return a.callbacks=t,a.state.dragPos=n,a.state.setDragPos=r,a.state.dragOffset=o,a.state.setDragOffset=s,(0,l.useEffect)((function(){return function(t){var e=t.context.eventManager;if(e&&t.state.dragPos){var n={panmove:function(e){return function(t,e){var n=e.props,r=e.callbacks,i=e.state,o=e.context;t.stopPropagation();var s=He(t);i.setDragPos(s);var a=i.dragOffset;if(r.onDrag&&a){var l=Object.assign({},t);l.lngLat=Xe(s,a,n,o),r.onDrag(l)}}(e,t)},panend:function(e){return function(t,e){var n=e.props,r=e.callbacks,i=e.state,o=e.context;t.stopPropagation();var s=i.dragPos,a=i.dragOffset;if(i.setDragPos(null),i.setDragOffset(null),r.onDragEnd&&s&&a){var l=Object.assign({},t);l.lngLat=Xe(s,a,n,o),r.onDragEnd(l)}}(e,t)},pancancel:function(e){return n=e,r=t.state,n.stopPropagation(),r.setDragPos(null),void r.setDragOffset(null);var n,r}};return e.watch(n),function(){e.off(n)}}}(a)}),[a.context.eventManager,Boolean(n)]),a}(t),n=e.state,r=e.containerRef,i=t.children,o=t.className,s=t.draggable,a=n.dragPos,u=function(t){var e=t.props,n=t.state,r=t.context,i=e.longitude,o=e.latitude,s=e.offsetLeft,a=e.offsetTop,l=n.dragPos,u=n.dragOffset,c=r.viewport,h=r.map;if(l&&u)return[l[0]+u[0],l[1]+u[1]];var p=Ct(h,{longitude:i,latitude:o}),f=M(c.project([i,o,p]),2),d=f[0],g=f[1];return[d+=s,g+=a]}(e),c=M(u,2),h=c[0],p=c[1],f="translate(".concat(Qe(h),"px, ").concat(Qe(p),"px)"),d=s?a?"grabbing":"grab":"auto",g=(0,l.useMemo)((function(){var t={position:"absolute",left:0,top:0,transform:f,cursor:d};return l.createElement("div",{className:"mapboxgl-marker ".concat(o),ref:e.containerRef,style:t},i)}),[i,o]),m=r.current;return m&&(m.style.transform=f,m.style.cursor=d),g}en.defaultProps=tn,en.propTypes=Je,l.memo(en);var nn={top:{x:.5,y:0},"top-left":{x:0,y:0},"top-right":{x:1,y:0},bottom:{x:.5,y:1},"bottom-left":{x:0,y:1},"bottom-right":{x:1,y:1},left:{x:0,y:.5},right:{x:1,y:.5}},rn=Object.keys(nn),on=Object.assign({},Be,{className:c.string,longitude:c.number.isRequired,latitude:c.number.isRequired,altitude:c.number,offsetLeft:c.number,offsetTop:c.number,tipSize:c.number,closeButton:c.bool,closeOnClick:c.bool,anchor:c.oneOf(Object.keys(nn)),dynamicPosition:c.bool,sortByDepth:c.bool,onClose:c.func}),sn=Object.assign({},Fe,{className:"",offsetLeft:0,offsetTop:0,tipSize:10,anchor:"bottom",dynamicPosition:!0,sortByDepth:!1,closeButton:!0,closeOnClick:!0,onClose:function(){}});function an(t){var e=(0,l.useRef)(null),n=je(t),r=n.context,i=n.containerRef,o=M((0,l.useState)(!1),2)[1];(0,l.useEffect)((function(){o(!0)}),[e.current]),(0,l.useEffect)((function(){if(r.eventManager&&t.closeOnClick){var e=function(){return n.props.onClose()};return r.eventManager.on("anyclick",e),function(){r.eventManager.off("anyclick",e)}}}),[r.eventManager,t.closeOnClick]);var s=r.viewport,a=r.map,u=t.className,c=t.longitude,h=t.latitude,p=t.tipSize,f=t.closeButton,d=t.children,g=t.altitude;void 0===g&&(g=Ct(a,{longitude:c,latitude:h}));var m=s.project([c,h,g]),A=function(t,e,n,r){var i=M(r,2),o=i[0],s=i[1],a=t.anchor,l=t.dynamicPosition,u=t.tipSize;return n&&l?function(t){var e=t.x,n=t.y,r=t.width,i=t.height,o=t.selfWidth,s=t.selfHeight,a=t.anchor,l=t.padding,u=void 0===l?0:l,c=nn[a],h=c.x,p=c.y,f=n-p*s,d=f+s,g=Math.max(0,u-f)+Math.max(0,d-i+u);if(g>0){var m=p,A=g;for(p=0;p<=1;p+=.5)d=(f=n-p*s)+s,(g=Math.max(0,u-f)+Math.max(0,d-i+u))<A&&(A=g,m=p);p=m}var y=.5;.5===p&&(h=Math.floor(h),y=1);var _=e-h*o,v=_+o,b=Math.max(0,u-_)+Math.max(0,v-r+u);if(b>0){var x=h,w=b;for(h=0;h<=1;h+=y)v=(_=e-h*o)+o,(b=Math.max(0,u-_)+Math.max(0,v-r+u))<w&&(w=b,x=h);h=x}return rn.find((function(t){var e=nn[t];return e.x===h&&e.y===p}))||a}({x:o,y:s,anchor:a,padding:u,width:e.width,height:e.height,selfWidth:n.clientWidth,selfHeight:n.clientHeight}):a}(t,s,e.current,m),y=function(t,e,n,r,i){var o=M(r,3),s=o[0],a=o[1],l=o[2],u=t.offsetLeft,c=t.offsetTop,h=t.sortByDepth,p=nn[i],f=s+u,d=a+c,g=Ke(n,100*-p.x),m=Ke(n,100*-p.y,"y"),A={position:"absolute",transform:"\n      translate(".concat(g,"%, ").concat(m,"%)\n      translate(").concat(Qe(f),"px, ").concat(Qe(d),"px)\n    "),display:void 0,zIndex:void 0};return h?(l>1||l<-1||s<0||s>e.width||a<0||a>e.height?A.display="none":A.zIndex=Math.floor((1-l)/2*1e5),A):A}(t,s,i.current,m,A),_=(0,l.useCallback)((function(t){n.props.onClose();var e=n.context.eventManager;e&&e.once("click",(function(t){return t.stopPropagation()}),t.target)}),[]);return l.createElement("div",{className:"mapboxgl-popup mapboxgl-popup-anchor-".concat(A," ").concat(u),style:y,ref:i},l.createElement("div",{key:"tip",className:"mapboxgl-popup-tip",style:{borderWidth:p}}),l.createElement("div",{key:"content",ref:e,className:"mapboxgl-popup-content"},f&&l.createElement("button",{key:"close-button",className:"mapboxgl-popup-close-button",type:"button",onClick:_},""),d))}function ln(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}an.propTypes=on,an.defaultProps=sn,l.memo(an);var un=Object.assign({},Be,{toggleLabel:c.string,className:c.string,style:c.object,compact:c.bool,customAttribution:c.oneOfType([c.string,c.arrayOf(c.string)])}),cn=Object.assign({},Fe,{className:"",toggleLabel:"Toggle Attribution"});function hn(t){var e=je(t),n=e.context,r=e.containerRef,i=(0,l.useRef)(null),o=M((0,l.useState)(!1),2),s=o[0],a=o[1];(0,l.useEffect)((function(){var e;return n.map&&(e=function(t,e,n,r){var i=new(pt().AttributionControl)(t);return i._map=e,i._container=n,i._innerContainer=r,i._updateAttributions(),i._updateEditLink(),e.on("styledata",i._updateData),e.on("sourcedata",i._updateData),i}({customAttribution:t.customAttribution},n.map,r.current,i.current)),function(){return e&&function(t){t._map.off("styledata",t._updateData),t._map.off("sourcedata",t._updateData)}(e)}}),[n.map]);var u=void 0===t.compact?n.viewport.width<=640:t.compact;(0,l.useEffect)((function(){!u&&s&&a(!1)}),[u]);var c=(0,l.useCallback)((function(){return a((function(t){return!t}))}),[]),h=(0,l.useMemo)((function(){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ln(Object(n),!0).forEach((function(e){(0,P.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ln(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({position:"absolute"},t.style)}),[t.style]);return l.createElement("div",{style:h,className:t.className},l.createElement("div",{ref:r,"aria-pressed":s,className:"mapboxgl-ctrl mapboxgl-ctrl-attrib ".concat(u?"mapboxgl-compact":""," ").concat(s?"mapboxgl-compact-show":"")},l.createElement("button",{type:"button",className:"mapboxgl-ctrl-attrib-button",title:t.toggleLabel,onClick:c}),l.createElement("div",{ref:i,className:"mapboxgl-ctrl-attrib-inner",role:"list"})))}function pn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}hn.propTypes=un,hn.defaultProps=cn,l.memo(hn);var fn,dn=Object.assign({},Be,{className:c.string,style:c.object,container:c.object,label:c.string}),gn=Object.assign({},Fe,{className:"",container:null,label:"Toggle fullscreen"});function mn(t){var e=je(t),n=e.context,r=e.containerRef,i=M((0,l.useState)(!1),2),o=i[0],s=i[1],a=M((0,l.useState)(!1),2),u=a[0],c=a[1],h=M((0,l.useState)(null),2),p=h[0],f=h[1];(0,l.useEffect)((function(){var t=new(pt().FullscreenControl);f(t),c(t._checkFullscreenSupport());var e=function(){var e=!t._fullscreen;t._fullscreen=e,s(e)};return tt.addEventListener(t._fullscreenchange,e),function(){tt.removeEventListener(t._fullscreenchange,e)}}),[]);var d=(0,l.useMemo)((function(){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?pn(Object(n),!0).forEach((function(e){(0,P.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({position:"absolute"},t.style)}),[t.style]);if(!u)return null;var g=t.className,m=t.label,A=o?"shrink":"fullscreen";return l.createElement("div",{style:d,className:g},l.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:r},l.createElement("button",{key:A,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(A),type:"button",title:m,onClick:function(){p&&(p._container=t.container||n.container,p._onClickFullscreen())}},l.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))))}function An(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}mn.propTypes=dn,mn.defaultProps=gn,l.memo(mn);var yn=function(){},_n=Object.assign({},Be,{className:c.string,style:c.object,label:c.string,disabledLabel:c.string,auto:c.bool,positionOptions:c.object,fitBoundsOptions:c.object,trackUserLocation:c.bool,showUserLocation:c.bool,showAccuracyCircle:c.bool,onViewStateChange:c.func,onViewportChange:c.func,onGeolocate:c.func}),vn=Object.assign({},Fe,{className:"",label:"Find My Location",disabledLabel:"Location Not Available",auto:!1,positionOptions:{enableHighAccuracy:!1,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0,showAccuracyCircle:!0,onGeolocate:function(){}});function bn(t){var e=je(t),n=e.context,r=e.containerRef,i=(0,l.useRef)(null),o=M((0,l.useState)(null),2),s=o[0],a=o[1],u=M((0,l.useState)(!1),2),c=u[0],h=u[1];(0,l.useEffect)((function(){var r;return n.map&&(void 0!==fn?Promise.resolve(fn):void 0!==window.navigator.permissions?window.navigator.permissions.query({name:"geolocation"}).then((function(t){return fn="denied"!==t.state})):(fn=Boolean(window.navigator.geolocation),Promise.resolve(fn))).then((function(o){h(o),i.current&&(r=function(t,e,n){var r=new(pt().GeolocateControl)(e);r._container=tt.createElement("div"),r._map={on:function(){},_getUIString:function(){return""}},r._setupUI(!0),r._map=t.map,r._geolocateButton=n;var i=t.eventManager;return r.options.trackUserLocation&&i&&i.on("panstart",(function(){"ACTIVE_LOCK"===r._watchState&&(r._watchState="BACKGROUND",n.classList.add("mapboxgl-ctrl-geolocate-background"),n.classList.remove("mapboxgl-ctrl-geolocate-active"))})),r.on("geolocate",e.onGeolocate),r}(n,t,i.current),r._updateCamera=function(t){return function(t,e){var n=e.context,r=e.props,i=function(t){var e=new(pt().LngLat)(t.coords.longitude,t.coords.latitude),n=t.coords.accuracy,r=e.toBounds(n);return[[r._ne.lng,r._ne.lat],[r._sw.lng,r._sw.lat]]}(t),o=n.viewport.fitBounds(i,r.fitBoundsOptions),s=o.longitude,a=o.latitude,l=o.zoom,u=Object.assign({},n.viewport,{longitude:s,latitude:a,zoom:l}),c=new bt(u),h=Object.assign({},c.getViewportProps(),de),p=r.onViewportChange||n.onViewportChange||yn;(r.onViewStateChange||n.onViewStateChange||yn)({viewState:h}),p(h)}(t,e)},a(r))})),function(){r&&r._clearWatch()}}),[n.map]);var p=(0,l.useCallback)((function(){s&&(s.options=e.props,s.trigger())}),[s]);(0,l.useEffect)((function(){t.auto&&p()}),[s,t.auto]),(0,l.useEffect)((function(){s&&s._onZoom()}),[n.viewport.zoom]);var f=t.className,d=t.label,g=t.disabledLabel,m=t.trackUserLocation,A=(0,l.useMemo)((function(){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?An(Object(n),!0).forEach((function(e){(0,P.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):An(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({position:"absolute"},t.style)}),[t.style]);return l.createElement("div",{style:A,className:f},l.createElement("div",{key:"geolocate-control",className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:r},l.createElement("button",{key:"geolocate",className:"mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",ref:i,disabled:!c,"aria-pressed":!m,type:"button",title:c?d:g,"aria-label":c?d:g,onClick:p},l.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))))}function xn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}bn.propTypes=_n,bn.defaultProps=vn,l.memo(bn);var wn=function(){},En=Object.assign({},Be,{className:c.string,style:c.object,onViewStateChange:c.func,onViewportChange:c.func,showCompass:c.bool,showZoom:c.bool,zoomInLabel:c.string,zoomOutLabel:c.string,compassLabel:c.string}),Sn=Object.assign({},Fe,{className:"",showCompass:!0,showZoom:!0,zoomInLabel:"Zoom In",zoomOutLabel:"Zoom Out",compassLabel:"Reset North"});function Tn(t,e,n){var r=t.viewport,i=new bt(Object.assign({},r,n)),o=Object.assign({},i.getViewportProps(),de),s=e.onViewportChange||t.onViewportChange||wn;(e.onViewStateChange||t.onViewStateChange||wn)({viewState:o}),s(o)}function Pn(t,e,n,r){return l.createElement("button",{key:t,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(t),type:"button",title:e,onClick:n},r||l.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))}function Mn(t){var e=je(t),n=e.context,r=e.containerRef,i=t.className,o=t.showCompass,s=t.showZoom,a=t.zoomInLabel,u=t.zoomOutLabel,c=t.compassLabel,h=(0,l.useMemo)((function(){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?xn(Object(n),!0).forEach((function(e){(0,P.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({position:"absolute"},t.style)}),[t.style]);return l.createElement("div",{style:h,className:i},l.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:r},s&&Pn("zoom-in",a,(function(){Tn(n,t,{zoom:n.viewport.zoom+1})})),s&&Pn("zoom-out",u,(function(){Tn(n,t,{zoom:n.viewport.zoom-1})})),o&&Pn("compass",c,(function(){Tn(n,t,{bearing:0,pitch:0})}),function(t){var e=(0,l.useMemo)((function(){return t.map?function(t,e){for(var n=(t||"").split(".").map(Number),r="1.6.0".split(".").map(Number),i=0;i<3;i++){var o=n[i]||0,s=r[i]||0;if(o<s)return-1;if(o>s)return 1}return 0}(t.map.version)>=0?2:1:2}),[t.map]),n=t.viewport.bearing,r={transform:"rotate(".concat(-n,"deg)")};return 2===e?l.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true",style:r}):l.createElement("span",{className:"mapboxgl-ctrl-compass-arrow",style:r})}(n))))}function Cn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}Mn.propTypes=En,Mn.defaultProps=Sn,l.memo(Mn);var In=Object.assign({},Be,{className:c.string,style:c.object,maxWidth:c.number,unit:c.oneOf(["imperial","metric","nautical"])}),On=Object.assign({},Fe,{className:"",maxWidth:100,unit:"metric"});function Rn(t){var e=je(t),n=e.context,r=e.containerRef,i=M((0,l.useState)(null),2),o=i[0],s=i[1];(0,l.useEffect)((function(){if(n.map){var t=new(pt().ScaleControl);t._map=n.map,t._container=r.current,s(t)}}),[n.map]),o&&(o.options=t,o._onMove());var a=(0,l.useMemo)((function(){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Cn(Object(n),!0).forEach((function(e){(0,P.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Cn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({position:"absolute"},t.style)}),[t.style]);return l.createElement("div",{style:a,className:t.className},l.createElement("div",{ref:r,className:"mapboxgl-ctrl mapboxgl-ctrl-scale"}))}Rn.propTypes=In,Rn.defaultProps=On,l.memo(Rn);var Ln="undefined"!=typeof window&&window.devicePixelRatio||1,kn=Object.assign({},Be,{redraw:c.func.isRequired});function Dn(t){var e=je(t),n=e.context,r=e.containerRef,i=M((0,l.useState)(null),2),o=i[0],s=i[1];(0,l.useEffect)((function(){s(r.current.getContext("2d"))}),[]);var a=n.viewport,u=n.isDragging;return o&&(o.save(),o.scale(Ln,Ln),t.redraw({width:a.width,height:a.height,ctx:o,isDragging:u,project:a.project,unproject:a.unproject}),o.restore()),l.createElement("canvas",{ref:r,width:a.width*Ln,height:a.height*Ln,style:{width:"".concat(a.width,"px"),height:"".concat(a.height,"px"),position:"absolute",left:0,top:0}})}function Nn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}Dn.propTypes=kn,Dn.defaultProps={captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1,capturePointerMove:!1};var Fn=Object.assign({},Be,{redraw:c.func.isRequired,style:c.object});function Bn(t){var e=je(t),n=e.context,r=e.containerRef,i=n.viewport,o=n.isDragging,s=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Nn(Object(n),!0).forEach((function(e){(0,P.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Nn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({position:"absolute",left:0,top:0,width:i.width,height:i.height},t.style);return l.createElement("div",{ref:r,style:s},t.redraw({width:i.width,height:i.height,isDragging:o,project:i.project,unproject:i.unproject}))}function zn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}Bn.propTypes=Fn,Bn.defaultProps={captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1,capturePointerMove:!1};var jn=Object.assign({},Be,{redraw:c.func.isRequired,style:c.object});function Un(t){var e=je(t),n=e.context,r=e.containerRef,i=n.viewport,o=n.isDragging,s=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?zn(Object(n),!0).forEach((function(e){(0,P.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):zn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({position:"absolute",left:0,top:0},t.style);return l.createElement("svg",{width:i.width,height:i.height,ref:r,style:s},t.redraw({width:i.width,height:i.height,isDragging:o,project:i.project,unproject:i.unproject}))}Un.propTypes=jn,Un.defaultProps={captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1,capturePointerMove:!1},pt()&&pt().setRTLTextPlugin;var Vn=6371008.8,Gn={centimeters:100*Vn,centimetres:100*Vn,degrees:Vn/111325,feet:3.28084*Vn,inches:39.37*Vn,kilometers:Vn/1e3,kilometres:Vn/1e3,meters:Vn,metres:Vn,miles:Vn/1609.344,millimeters:1e3*Vn,millimetres:1e3*Vn,nauticalmiles:Vn/1852,radians:1,yards:1.0936*Vn},Zn={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/Vn,yards:1.0936133},qn={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function Wn(t,e,n){void 0===n&&(n={});var r={type:"Feature"};return(0===n.id||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function Hn(t,e,n){switch(void 0===n&&(n={}),t){case"Point":return Xn(e).geometry;case"LineString":return Kn(e).geometry;case"Polygon":return Yn(e).geometry;case"MultiPoint":return nr(e).geometry;case"MultiLineString":return er(e).geometry;case"MultiPolygon":return rr(e).geometry;default:throw new Error(t+" is invalid")}}function Xn(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!dr(t[0])||!dr(t[1]))throw new Error("coordinates must contain numbers");return Wn({type:"Point",coordinates:t},e,n)}function $n(t,e,n){return void 0===n&&(n={}),tr(t.map((function(t){return Xn(t,e)})),n)}function Yn(t,e,n){void 0===n&&(n={});for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<o[o.length-1].length;s++)if(o[o.length-1][s]!==o[0][s])throw new Error("First and last Position are not equivalent.")}return Wn({type:"Polygon",coordinates:t},e,n)}function Qn(t,e,n){return void 0===n&&(n={}),tr(t.map((function(t){return Yn(t,e)})),n)}function Kn(t,e,n){if(void 0===n&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return Wn({type:"LineString",coordinates:t},e,n)}function Jn(t,e,n){return void 0===n&&(n={}),tr(t.map((function(t){return Kn(t,e)})),n)}function tr(t,e){void 0===e&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function er(t,e,n){return void 0===n&&(n={}),Wn({type:"MultiLineString",coordinates:t},e,n)}function nr(t,e,n){return void 0===n&&(n={}),Wn({type:"MultiPoint",coordinates:t},e,n)}function rr(t,e,n){return void 0===n&&(n={}),Wn({type:"MultiPolygon",coordinates:t},e,n)}function ir(t,e,n){return void 0===n&&(n={}),Wn({type:"GeometryCollection",geometries:t},e,n)}function or(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n}function sr(t,e){void 0===e&&(e="kilometers");var n=Gn[e];if(!n)throw new Error(e+" units is invalid");return t*n}function ar(t,e){void 0===e&&(e="kilometers");var n=Gn[e];if(!n)throw new Error(e+" units is invalid");return t/n}function lr(t,e){return cr(ar(t,e))}function ur(t){var e=t%360;return e<0&&(e+=360),e}function cr(t){return t%(2*Math.PI)*180/Math.PI}function hr(t){return t%360*Math.PI/180}function pr(t,e,n){if(void 0===e&&(e="kilometers"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("length must be a positive number");return sr(ar(t,e),n)}function fr(t,e,n){if(void 0===e&&(e="meters"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("area must be a positive number");var r=qn[e];if(!r)throw new Error("invalid original units");var i=qn[n];if(!i)throw new Error("invalid final units");return t/r*i}function dr(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function gr(t){return!!t&&t.constructor===Object}function mr(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!dr(t))throw new Error("bbox must only contain numbers")}))}function Ar(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}function yr(t,e,n){if(null!==t)for(var r,i,o,s,a,l,u,c,h=0,p=0,f=t.type,d="FeatureCollection"===f,g="Feature"===f,m=d?t.features.length:1,A=0;A<m;A++){a=(c=!!(u=d?t.features[A].geometry:g?t.geometry:t)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var y=0;y<a;y++){var _=0,v=0;if(null!==(s=c?u.geometries[y]:u)){l=s.coordinates;var b=s.type;switch(h=!n||"Polygon"!==b&&"MultiPolygon"!==b?0:1,b){case null:break;case"Point":if(!1===e(l,p,A,_,v))return!1;p++,_++;break;case"LineString":case"MultiPoint":for(r=0;r<l.length;r++){if(!1===e(l[r],p,A,_,v))return!1;p++,"MultiPoint"===b&&_++}"LineString"===b&&_++;break;case"Polygon":case"MultiLineString":for(r=0;r<l.length;r++){for(i=0;i<l[r].length-h;i++){if(!1===e(l[r][i],p,A,_,v))return!1;p++}"MultiLineString"===b&&_++,"Polygon"===b&&v++}"Polygon"===b&&_++;break;case"MultiPolygon":for(r=0;r<l.length;r++){for(v=0,i=0;i<l[r].length;i++){for(o=0;o<l[r][i].length-h;o++){if(!1===e(l[r][i][o],p,A,_,v))return!1;p++}v++}_++}break;case"GeometryCollection":for(r=0;r<s.geometries.length;r++)if(!1===yr(s.geometries[r],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function _r(t,e,n,r){var i=n;return yr(t,(function(t,r,o,s,a){i=0===r&&void 0===n?t:e(i,t,r,o,s,a)}),r),i}function vr(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length&&!1!==e(t.features[n].properties,n);n++);break;case"Feature":e(t.properties,0)}}function br(t,e,n){var r=n;return vr(t,(function(t,i){r=0===i&&void 0===n?t:e(r,t,i)})),r}function xr(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length&&!1!==e(t.features[n],n);n++);}function wr(t,e,n){var r=n;return xr(t,(function(t,i){r=0===i&&void 0===n?t:e(r,t,i)})),r}function Er(t){var e=[];return yr(t,(function(t){e.push(t)})),e}function Sr(t,e){var n,r,i,o,s,a,l,u,c,h,p=0,f="FeatureCollection"===t.type,d="Feature"===t.type,g=f?t.features.length:1;for(n=0;n<g;n++){for(a=f?t.features[n].geometry:d?t.geometry:t,u=f?t.features[n].properties:d?t.properties:{},c=f?t.features[n].bbox:d?t.bbox:void 0,h=f?t.features[n].id:d?t.id:void 0,s=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,i=0;i<s;i++)if(null!==(o=l?a.geometries[i]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,p,u,c,h))return!1;break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(!1===e(o.geometries[r],p,u,c,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,p,u,c,h))return!1;p++}}function Tr(t,e,n){var r=n;return Sr(t,(function(t,i,o,s,a){r=0===i&&void 0===n?t:e(r,t,i,o,s,a)})),r}function Pr(t,e){Sr(t,(function(t,n,r,i,o){var s,a=null===t?null:t.type;switch(a){case null:case"Point":case"LineString":case"Polygon":return!1!==e(Wn(t,r,{bbox:i,id:o}),n,0)&&void 0}switch(a){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon"}for(var l=0;l<t.coordinates.length;l++){var u=t.coordinates[l];if(!1===e(Wn({type:s,coordinates:u},r),n,l))return!1}}))}function Mr(t,e,n){var r=n;return Pr(t,(function(t,i,o){r=0===i&&0===o&&void 0===n?t:e(r,t,i,o)})),r}function Cr(t,e){Pr(t,(function(t,n,r){var i=0;if(t.geometry){var o=t.geometry.type;if("Point"!==o&&"MultiPoint"!==o){var s,a=0,l=0,u=0;return!1!==yr(t,(function(o,c,h,p,f){if(void 0===s||n>a||p>l||f>u)return s=o,a=n,l=p,u=f,void(i=0);var d=Kn([s,o],t.properties);if(!1===e(d,n,r,f,i))return!1;i++,s=o}))&&void 0}}}))}function Ir(t,e,n){var r=n,i=!1;return Cr(t,(function(t,o,s,a,l){r=!1===i&&void 0===n?t:e(r,t,o,s,a,l),i=!0})),r}function Or(t,e){if(!t)throw new Error("geojson is required");Pr(t,(function(t,n,r){if(null!==t.geometry){var i=t.geometry.type,o=t.geometry.coordinates;switch(i){case"LineString":if(!1===e(t,n,r,0,0))return!1;break;case"Polygon":for(var s=0;s<o.length;s++)if(!1===e(Kn(o[s],t.properties),n,r,s))return!1}}}))}function Rr(t,e,n){var r=n;return Or(t,(function(t,i,o,s){r=0===i&&void 0===n?t:e(r,t,i,o,s)})),r}function Lr(t,e){if(!gr(e=e||{}))throw new Error("options is invalid");var n,r=e.featureIndex||0,i=e.multiFeatureIndex||0,o=e.geometryIndex||0,s=e.segmentIndex||0,a=e.properties;switch(t.type){case"FeatureCollection":r<0&&(r=t.features.length+r),a=a||t.features[r].properties,n=t.features[r].geometry;break;case"Feature":a=a||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var l=n.coordinates;switch(n.type){case"Point":case"MultiPoint":return null;case"LineString":return s<0&&(s=l.length+s-1),Kn([l[s],l[s+1]],a,e);case"Polygon":return o<0&&(o=l.length+o),s<0&&(s=l[o].length+s-1),Kn([l[o][s],l[o][s+1]],a,e);case"MultiLineString":return i<0&&(i=l.length+i),s<0&&(s=l[i].length+s-1),Kn([l[i][s],l[i][s+1]],a,e);case"MultiPolygon":return i<0&&(i=l.length+i),o<0&&(o=l[i].length+o),s<0&&(s=l[i][o].length-s-1),Kn([l[i][o][s],l[i][o][s+1]],a,e)}throw new Error("geojson is invalid")}function kr(t,e){if(!gr(e=e||{}))throw new Error("options is invalid");var n,r=e.featureIndex||0,i=e.multiFeatureIndex||0,o=e.geometryIndex||0,s=e.coordIndex||0,a=e.properties;switch(t.type){case"FeatureCollection":r<0&&(r=t.features.length+r),a=a||t.features[r].properties,n=t.features[r].geometry;break;case"Feature":a=a||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var l=n.coordinates;switch(n.type){case"Point":return Xn(l,a,e);case"MultiPoint":return i<0&&(i=l.length+i),Xn(l[i],a,e);case"LineString":return s<0&&(s=l.length+s),Xn(l[s],a,e);case"Polygon":return o<0&&(o=l.length+o),s<0&&(s=l[o].length+s),Xn(l[o][s],a,e);case"MultiLineString":return i<0&&(i=l.length+i),s<0&&(s=l[i].length+s),Xn(l[i][s],a,e);case"MultiPolygon":return i<0&&(i=l.length+i),o<0&&(o=l[i].length+o),s<0&&(s=l[i][o].length-s),Xn(l[i][o][s],a,e)}throw new Error("geojson is invalid")}function Dr(t){var e=[1/0,1/0,-1/0,-1/0];return yr(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}Dr.default=Dr;const Nr=Dr;function Fr(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Br(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function zr(t){if(t.length>1&&dr(t[0])&&dr(t[1]))return!0;if(Array.isArray(t[0])&&t[0].length)return zr(t[0]);throw new Error("coordinates must only contain numbers")}function jr(t,e,n){if(!e||!n)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.type)}function Ur(t,e,n){if(!t)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)}function Vr(t,e,n){if(!t)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+n+", FeatureCollection required");for(var r=0,i=t.features;r<i.length;r++){var o=i[r];if(!o||"Feature"!==o.type||!o.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!o.geometry||o.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+o.geometry.type)}}function Gr(t){return"Feature"===t.type?t.geometry:t}function Zr(t,e){return"FeatureCollection"===t.type?"FeatureCollection":"GeometryCollection"===t.type?"GeometryCollection":"Feature"===t.type&&null!==t.geometry?t.geometry.type:t.type}var qr=n(7418),Wr={successCallback:null,verbose:!1},Hr={};function Xr(t,e,n){n=n||{};for(var r=Object.keys(Wr),i=0;i<r.length;i++){var o=r[i],s=n[o];s=null!=s?s:Wr[o],Hr[o]=s}Hr.verbose&&console.log("MarchingSquaresJS-isoContours: computing isocontour for "+e);var a,l,u,c=(a=function(t,e){for(var n=t.length-1,r=t[0].length-1,i={rows:n,cols:r,cells:[]},o=0;o<n;++o){i.cells[o]=[];for(var s=0;s<r;++s){var a=0,l=t[o+1][s],u=t[o+1][s+1],c=t[o][s+1],h=t[o][s];if(!(isNaN(l)||isNaN(u)||isNaN(c)||isNaN(h))){a|=l>=e?8:0,a|=u>=e?4:0,a|=c>=e?2:0;var p,f,d,g,m=!1;if(5==(a|=h>=e?1:0)||10===a){var A=(l+u+c+h)/4;5===a&&A<e?(a=10,m=!0):10===a&&A<e&&(a=5,m=!0)}0!==a&&15!==a&&(p=f=d=g=.5,1===a?(d=1-$r(e,l,h),f=1-$r(e,c,h)):2===a?(f=$r(e,h,c),g=1-$r(e,u,c)):3===a?(d=1-$r(e,l,h),g=1-$r(e,u,c)):4===a?(p=$r(e,l,u),g=$r(e,c,u)):5===a?(p=$r(e,l,u),g=$r(e,c,u),f=1-$r(e,c,h),d=1-$r(e,l,h)):6===a?(f=$r(e,h,c),p=$r(e,l,u)):7===a?(d=1-$r(e,l,h),p=$r(e,l,u)):8===a?(d=$r(e,h,l),p=1-$r(e,u,l)):9===a?(f=1-$r(e,c,h),p=1-$r(e,u,l)):10===a?(p=1-$r(e,u,l),g=1-$r(e,u,c),f=$r(e,h,c),d=$r(e,h,l)):11===a?(p=1-$r(e,u,l),g=1-$r(e,u,c)):12===a?(d=$r(e,h,l),g=$r(e,c,u)):13===a?(f=1-$r(e,c,h),g=$r(e,c,u)):14===a?(d=$r(e,h,l),f=$r(e,h,c)):console.log("MarchingSquaresJS-isoContours: Illegal cval detected: "+a),i.cells[o][s]={cval:a,flipped:m,top:p,right:g,bottom:f,left:d})}}}return i}(t,e),l=[],u=0,a.cells.forEach((function(t,e){t.forEach((function(t,n){if(void 0!==t&&5!==(p=t).cval&&10!==p.cval&&!Yr(t)){var r=function(t,e,n){var r,i,o=t.length,s=[],a=[0,0,1,1,0,0,0,0,-1,0,1,1,-1,0,-1,0],l=[0,-1,0,0,1,1,1,1,0,-1,0,0,0,-1,0,0],u=["none","bottom","right","right","top","top","top","top","left","bottom","right","right","left","bottom","left","none"],c=t[e][n],h=c.cval,p=["none","left","bottom","left","right","none","bottom","left","top","top","none","top","right","right","bottom","none"][h],f=Kr(c,p);s.push([n+f[0],e+f[1]]),f=Kr(c,p=u[h]),s.push([n+f[0],e+f[1]]),Qr(c);for(var d=n+a[h],g=e+l[h],m=h;d>=0&&g>=0&&g<o&&(d!=n||g!=e)&&void 0!==(c=t[g][d]);){if(0===(h=c.cval)||15===h)return{path:s,info:"mergeable"};p=u[h],r=a[h],i=l[h],5!==h&&10!==h||(5===h?c.flipped?-1===l[m]?(p="left",r=-1,i=0):(p="right",r=1,i=0):-1===a[m]&&(p="bottom",r=0,i=-1):10===h&&(c.flipped?-1===a[m]?(p="top",r=0,i=1):(p="bottom",r=0,i=-1):1===l[m]&&(p="left",r=-1,i=0))),f=Kr(c,p),s.push([d+f[0],g+f[1]]),Qr(c),d+=r,g+=i,m=h}return{path:s,info:"closed"}}(a.cells,e,n),i=!1;if("mergeable"===r.info)for(var o=r.path[r.path.length-1][0],s=r.path[r.path.length-1][1],c=u-1;c>=0;c--)if(Math.abs(l[c][0][0]-o)<=1e-7&&Math.abs(l[c][0][1]-s)<=1e-7){for(var h=r.path.length-2;h>=0;--h)l[c].unshift(r.path[h]);i=!0;break}i||(l[u++]=r.path)}var p}))})),l);return"function"==typeof Hr.successCallback&&Hr.successCallback(c),c}function $r(t,e,n){return(t-e)/(n-e)}function Yr(t){return 0===t.cval||15===t.cval}function Qr(t){Yr(t)||5===t.cval||10===t.cval||(t.cval=15)}function Kr(t,e){return"top"===e?[t.top,1]:"bottom"===e?[t.bottom,0]:"right"===e?[1,t.right]:"left"===e?[0,t.left]:void 0}const Jr=function(t,e,n){if(!gr(n=n||{}))throw new Error("options is invalid");var r=n.zProperty||"elevation",i=n.commonProperties||{},o=n.breaksProperties||[];if(Vr(t,"Point","Input must contain Points"),!e)throw new Error("breaks is required");if(!Array.isArray(e))throw new Error("breaks must be an Array");if(!gr(i))throw new Error("commonProperties must be an Object");if(!Array.isArray(o))throw new Error("breaksProperties must be an Array");var s=function(t,e){if(!gr(e=e||{}))throw new Error("options is invalid");var n=e.zProperty||"elevation",r=e.flip,i=e.flags;Vr(t,"Point","input must contain Points");for(var o=function(t,e){var n={};return xr(t,(function(t){var e=Br(t)[1];n[e]||(n[e]=[]),n[e].push(t)})),Object.keys(n).map((function(t){return n[t].sort((function(t,e){return Br(t)[0]-Br(e)[0]}))})).sort((function(t,n){return e?Br(t[0])[1]-Br(n[0])[1]:Br(n[0])[1]-Br(t[0])[1]}))}(t,r),s=[],a=0;a<o.length;a++){for(var l=o[a],u=[],c=0;c<l.length;c++){var h=l[c];h.properties[n]?u.push(h.properties[n]):u.push(0),!0===i&&(h.properties.matrixPosition=[a,c])}s.push(u)}return s}(t,{zProperty:r,flip:!0}),a=function(t,e,n,r,i){for(var o=[],s=1;s<e.length;s++){var a=+e[s],l=qr({},r,i[s]);l[n]=a;var u=er(Xr(t,a),l);o.push(u)}return o}(s,e,r,i,o),l=function(t,e,n){var r=Nr(n),i=r[2]-r[0],o=r[3]-r[1],s=r[0],a=r[1],l=e[0].length-1,u=e.length-1,c=i/l,h=o/u,p=function(t){t[0]=t[0]*c+s,t[1]=t[1]*h+a};return t.forEach((function(t){yr(t,p)})),t}(a,s,t);return tr(l)};var ti=n(2273);function ei(t,e){void 0===e&&(e={}),e.concavity=e.concavity||1/0;var n=[];if(yr(t,(function(t){n.push([t[0],t[1]])})),!n.length)return null;var r=ti(n,e.concavity);return r.length>3?Yn([r]):null}function ni(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var r=Fr(t),i=Gr(e),o=i.type,s=e.bbox,a=i.coordinates;if(s&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(r,s))return!1;"Polygon"===o&&(a=[a]);for(var l=!1,u=0;u<a.length&&!l;u++)if(ri(r,a[u][0],n.ignoreBoundary)){for(var c=!1,h=1;h<a[u].length&&!c;)ri(r,a[u][h],!n.ignoreBoundary)&&(c=!0),h++;c||(l=!0)}return l}function ri(t,e,n){var r=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var i=0,o=e.length-1;i<e.length;o=i++){var s=e[i][0],a=e[i][1],l=e[o][0],u=e[o][1];if(t[1]*(s-l)+a*(l-t[0])+u*(t[0]-s)==0&&(s-t[0])*(l-t[0])<=0&&(a-t[1])*(u-t[1])<=0)return!n;a>t[1]!=u>t[1]&&t[0]<(l-s)*(t[1]-a)/(u-a)+s&&(r=!r)}return r}const ii=function(t,e){var n=[];return xr(t,(function(t){var r=!1;if("Point"===t.geometry.type)Sr(e,(function(e){ni(t,e)&&(r=!0)})),r&&n.push(t);else{if("MultiPoint"!==t.geometry.type)throw new Error("Input geometry must be a Point or MultiPoint");var i=[];Sr(e,(function(e){yr(t,(function(t){ni(t,e)&&(r=!0,i.push(t))}))})),r&&n.push(nr(i))}})),tr(n)},oi=function(t,e,n){void 0===n&&(n={});var r=Fr(t),i=Fr(e),o=hr(i[1]-r[1]),s=hr(i[0]-r[0]),a=hr(r[1]),l=hr(i[1]),u=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(a)*Math.cos(l);return sr(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),n.units)};function si(t,e){var n=!1;return tr(function(t){if(t.length<3)return[];t.sort(li);for(var e,n,r,i,o,s,a=t.length-1,l=t[a].x,u=t[0].x,c=t[a].y,h=c;a--;)t[a].y<c&&(c=t[a].y),t[a].y>h&&(h=t[a].y);var p,f=u-l,d=h-c,g=f>d?f:d,m=.5*(u+l),A=.5*(h+c),y=[new ai({__sentinel:!0,x:m-20*g,y:A-g},{__sentinel:!0,x:m,y:A+20*g},{__sentinel:!0,x:m+20*g,y:A-g})],_=[],v=[];for(a=t.length;a--;){for(v.length=0,p=y.length;p--;)(f=t[a].x-y[p].x)>0&&f*f>y[p].r?(_.push(y[p]),y.splice(p,1)):f*f+(d=t[a].y-y[p].y)*d>y[p].r||(v.push(y[p].a,y[p].b,y[p].b,y[p].c,y[p].c,y[p].a),y.splice(p,1));for(ui(v),p=v.length;p;)n=v[--p],e=v[--p],r=t[a],i=n.x-e.x,o=n.y-e.y,s=2*(i*(r.y-n.y)-o*(r.x-n.x)),Math.abs(s)>1e-12&&y.push(new ai(e,n,r))}for(Array.prototype.push.apply(_,y),a=_.length;a--;)(_[a].a.__sentinel||_[a].b.__sentinel||_[a].c.__sentinel)&&_.splice(a,1);return _}(t.features.map((function(t){var r={x:t.geometry.coordinates[0],y:t.geometry.coordinates[1]};return e?r.z=t.properties[e]:3===t.geometry.coordinates.length&&(n=!0,r.z=t.geometry.coordinates[2]),r}))).map((function(t){var e=[t.a.x,t.a.y],r=[t.b.x,t.b.y],i=[t.c.x,t.c.y],o={};return n?(e.push(t.a.z),r.push(t.b.z),i.push(t.c.z)):o={a:t.a.z,b:t.b.z,c:t.c.z},Yn([[e,r,i,e]],o)})))}var ai=function(t,e,n){this.a=t,this.b=e,this.c=n;var r,i,o=e.x-t.x,s=e.y-t.y,a=n.x-t.x,l=n.y-t.y,u=o*(t.x+e.x)+s*(t.y+e.y),c=a*(t.x+n.x)+l*(t.y+n.y),h=2*(o*(n.y-e.y)-s*(n.x-e.x));this.x=(l*u-s*c)/h,this.y=(o*c-a*u)/h,r=this.x-t.x,i=this.y-t.y,this.r=r*r+i*i};function li(t,e){return e.x-t.x}function ui(t){var e,n,r,i,o,s=t.length;t:for(;s;)for(n=t[--s],e=t[--s],r=s;r;)if(o=t[--r],e===(i=t[--r])&&n===o||e===o&&n===i){t.splice(s,2),t.splice(r,2),s-=2;continue t}}function ci(t){var e={type:"Feature"};return Object.keys(t).forEach((function(n){switch(n){case"type":case"properties":case"geometry":return;default:e[n]=t[n]}})),e.properties=hi(t.properties),e.geometry=pi(t.geometry),e}function hi(t){var e={};return t?(Object.keys(t).forEach((function(n){var r=t[n];"object"==typeof r?null===r?e[n]=null:Array.isArray(r)?e[n]=r.map((function(t){return t})):e[n]=hi(r):e[n]=r})),e):e}function pi(t){var e={type:t.type};return t.bbox&&(e.bbox=t.bbox),"GeometryCollection"===t.type?(e.geometries=t.geometries.map((function(t){return pi(t)})),e):(e.coordinates=fi(t.coordinates),e)}function fi(t){var e=t;return"object"!=typeof e[0]?e.slice():e.map((function(t){return fi(t)}))}const di=function(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return ci(t);case"FeatureCollection":return function(t){var e={type:"FeatureCollection"};return Object.keys(t).forEach((function(n){switch(n){case"type":case"features":return;default:e[n]=t[n]}})),e.features=t.features.map((function(t){return ci(t)})),e}(t);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return pi(t);default:throw new Error("unknown GeoJSON type")}};function gi(t){return t[0].toString()+","+t[1].toString()}function mi(t){return t}function Ai(t,e){var n=function(t){if(null==t)return mi;var e,n,r=t.scale[0],i=t.scale[1],o=t.translate[0],s=t.translate[1];return function(t,a){a||(e=n=0);var l=2,u=t.length,c=new Array(u);for(c[0]=(e+=t[0])*r+o,c[1]=(n+=t[1])*i+s;l<u;)c[l]=t[l],++l;return c}}(t.transform),r=t.arcs;function i(t,e){e.length&&e.pop();for(var i=r[t<0?~t:t],o=0,s=i.length;o<s;++o)e.push(n(i[o],o));t<0&&function(t,e){for(var n,r=t.length,i=r-e;i<--r;)n=t[i],t[i++]=t[r],t[r]=n}(e,s)}function o(t){return n(t)}function s(t){for(var e=[],n=0,r=t.length;n<r;++n)i(t[n],e);return e.length<2&&e.push(e[0]),e}function a(t){for(var e=s(t);e.length<4;)e.push(e[0]);return e}function l(t){return t.map(a)}return function t(e){var n,r=e.type;switch(r){case"GeometryCollection":return{type:r,geometries:e.geometries.map(t)};case"Point":n=o(e.coordinates);break;case"MultiPoint":n=e.coordinates.map(o);break;case"LineString":n=s(e.arcs);break;case"MultiLineString":n=e.arcs.map(s);break;case"Polygon":n=l(e.arcs);break;case"MultiPolygon":n=e.arcs.map(l);break;default:return null}return{type:r,coordinates:n}}(e)}function yi(t,e){var n={},r=[],i=[];function o(t){t.forEach((function(e){e.forEach((function(e){(n[e=e<0?~e:e]||(n[e]=[])).push(t)}))})),r.push(t)}function s(e){return function(t){for(var e,n=-1,r=t.length,i=t[r-1],o=0;++n<r;)e=i,i=t[n],o+=e[0]*i[1]-e[1]*i[0];return Math.abs(o)}(Ai(t,{type:"Polygon",arcs:[e]}).coordinates[0])}return e.forEach((function t(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"Polygon":o(e.arcs);break;case"MultiPolygon":e.arcs.forEach(o)}})),r.forEach((function(t){if(!t._){var e=[],r=[t];for(t._=1,i.push(e);t=r.pop();)e.push(t),t.forEach((function(t){t.forEach((function(t){n[t<0?~t:t].forEach((function(t){t._||(t._=1,r.push(t))}))}))}))}})),r.forEach((function(t){delete t._})),{type:"MultiPolygon",arcs:i.map((function(e){var r,i=[];if(e.forEach((function(t){t.forEach((function(t){t.forEach((function(t){n[t<0?~t:t].length<2&&i.push(t)}))}))})),(r=(i=function(t,e){var n={},r={},i={},o=[],s=-1;function a(t,e){for(var r in t){var i=t[r];delete e[i.start],delete i.start,delete i.end,i.forEach((function(t){n[t<0?~t:t]=1})),o.push(i)}}return e.forEach((function(n,r){var i,o=t.arcs[n<0?~n:n];o.length<3&&!o[1][0]&&!o[1][1]&&(i=e[++s],e[s]=n,e[r]=i)})),e.forEach((function(e){var n,o,s=function(e){var n,r=t.arcs[e<0?~e:e],i=r[0];return t.transform?(n=[0,0],r.forEach((function(t){n[0]+=t[0],n[1]+=t[1]}))):n=r[r.length-1],e<0?[n,i]:[i,n]}(e),a=s[0],l=s[1];if(n=i[a])if(delete i[n.end],n.push(e),n.end=l,o=r[l]){delete r[o.start];var u=o===n?n:n.concat(o);r[u.start=n.start]=i[u.end=o.end]=u}else r[n.start]=i[n.end]=n;else if(n=r[l])if(delete r[n.start],n.unshift(e),n.start=a,o=i[a]){delete i[o.end];var c=o===n?n:o.concat(n);r[c.start=o.start]=i[c.end=n.end]=c}else r[n.start]=i[n.end]=n;else r[(n=[e]).start=a]=i[n.end=l]=n})),a(i,r),a(r,i),e.forEach((function(t){n[t<0?~t:t]||o.push([t])})),o}(t,i)).length)>1)for(var o,a,l=1,u=s(i[0]);l<r;++l)(o=s(i[l]))>u&&(a=i[0],i[0]=i[l],i[l]=a,u=o);return i})).filter((function(t){return t.length>0}))}}var _i=Object.prototype.hasOwnProperty;function vi(t,e,n,r,i,o){3===arguments.length&&(r=o=Array,i=null);for(var s=new r(t=1<<Math.max(4,Math.ceil(Math.log(t)/Math.LN2))),a=new o(t),l=t-1,u=0;u<t;++u)s[u]=i;function c(r,o){for(var u=e(r)&l,c=s[u],h=0;c!=i;){if(n(c,r))return a[u]=o;if(++h>=t)throw new Error("full hashmap");c=s[u=u+1&l]}return s[u]=r,a[u]=o,o}function h(r,o){for(var u=e(r)&l,c=s[u],h=0;c!=i;){if(n(c,r))return a[u];if(++h>=t)throw new Error("full hashmap");c=s[u=u+1&l]}return s[u]=r,a[u]=o,o}function p(r,o){for(var u=e(r)&l,c=s[u],h=0;c!=i;){if(n(c,r))return a[u];if(++h>=t)break;c=s[u=u+1&l]}return o}function f(){for(var t=[],e=0,n=s.length;e<n;++e){var r=s[e];r!=i&&t.push(r)}return t}return{set:c,maybeSet:h,get:p,keys:f}}function bi(t,e){return t[0]===e[0]&&t[1]===e[1]}var xi=new ArrayBuffer(16),wi=new Float64Array(xi),Ei=new Uint32Array(xi);function Si(t){wi[0]=t[0],wi[1]=t[1];var e=Ei[0]^Ei[1];return 2147483647&(e<<5^e>>7^Ei[2]^Ei[3])}function Ti(t,e,n){for(var r,i=e+(n---e>>1);e<i;++e,--n)r=t[e],t[e]=t[n],t[n]=r}function Pi(t){var e={type:"GeometryCollection",geometries:t.features.map(Mi)};return null!=t.bbox&&(e.bbox=t.bbox),e}function Mi(t){var e,n=Ci(t.geometry);for(e in null!=t.id&&(n.id=t.id),null!=t.bbox&&(n.bbox=t.bbox),t.properties){n.properties=t.properties;break}return n}function Ci(t){if(null==t)return{type:null};var e="GeometryCollection"===t.type?{type:"GeometryCollection",geometries:t.geometries.map(Ci)}:"Point"===t.type||"MultiPoint"===t.type?{type:t.type,coordinates:t.coordinates}:{type:t.type,arcs:t.coordinates};return null!=t.bbox&&(e.bbox=t.bbox),e}function Ii(t,e){var n=function(t){var e=1/0,n=1/0,r=-1/0,i=-1/0;function o(t){null!=t&&_i.call(s,t.type)&&s[t.type](t)}var s={GeometryCollection:function(t){t.geometries.forEach(o)},Point:function(t){a(t.coordinates)},MultiPoint:function(t){t.coordinates.forEach(a)},LineString:function(t){l(t.arcs)},MultiLineString:function(t){t.arcs.forEach(l)},Polygon:function(t){t.arcs.forEach(l)},MultiPolygon:function(t){t.arcs.forEach(u)}};function a(t){var o=t[0],s=t[1];o<e&&(e=o),o>r&&(r=o),s<n&&(n=s),s>i&&(i=s)}function l(t){t.forEach(a)}function u(t){t.forEach(l)}for(var c in t)o(t[c]);return r>=e&&i>=n?[e,n,r,i]:void 0}(t=function(t){var e,n,r={};for(e in t)r[e]=null==(n=t[e])?{type:null}:("FeatureCollection"===n.type?Pi:"Feature"===n.type?Mi:Ci)(n);return r}(t)),r=e>0&&n&&function(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=o-r?(n-1)/(o-r):1,l=s-i?(n-1)/(s-i):1;function u(t){return[Math.round((t[0]-r)*a),Math.round((t[1]-i)*l)]}function c(t,e){for(var n,o,s,u,c,h=-1,p=0,f=t.length,d=new Array(f);++h<f;)n=t[h],u=Math.round((n[0]-r)*a),c=Math.round((n[1]-i)*l),u===o&&c===s||(d[p++]=[o=u,s=c]);for(d.length=p;p<e;)p=d.push([d[0][0],d[0][1]]);return d}function h(t){return c(t,2)}function p(t){return c(t,4)}function f(t){return t.map(p)}function d(t){null!=t&&_i.call(g,t.type)&&g[t.type](t)}var g={GeometryCollection:function(t){t.geometries.forEach(d)},Point:function(t){t.coordinates=u(t.coordinates)},MultiPoint:function(t){t.coordinates=t.coordinates.map(u)},LineString:function(t){t.arcs=h(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(h)},Polygon:function(t){t.arcs=f(t.arcs)},MultiPolygon:function(t){t.arcs=t.arcs.map(f)}};for(var m in t)d(t[m]);return{scale:[1/a,1/l],translate:[r,i]}}(t,n,e),i=function(t){var e,n,r,i,o=t.coordinates,s=t.lines,a=t.rings,l=s.length+a.length;for(delete t.lines,delete t.rings,r=0,i=s.length;r<i;++r)for(e=s[r];e=e.next;)++l;for(r=0,i=a.length;r<i;++r)for(n=a[r];n=n.next;)++l;var u=vi(2*l*1.4,Si,bi),c=t.arcs=[];for(r=0,i=s.length;r<i;++r){e=s[r];do{h(e)}while(e=e.next)}for(r=0,i=a.length;r<i;++r)if((n=a[r]).next)do{h(n)}while(n=n.next);else p(n);function h(t){var e,n,r,i,s,a,l,h;if(r=u.get(e=o[t[0]]))for(l=0,h=r.length;l<h;++l)if(f(i=r[l],t))return t[0]=i[0],void(t[1]=i[1]);if(s=u.get(n=o[t[1]]))for(l=0,h=s.length;l<h;++l)if(d(a=s[l],t))return t[1]=a[0],void(t[0]=a[1]);r?r.push(t):u.set(e,[t]),s?s.push(t):u.set(n,[t]),c.push(t)}function p(t){var e,n,r,i,s;if(n=u.get(o[t[0]]))for(i=0,s=n.length;i<s;++i){if(g(r=n[i],t))return t[0]=r[0],void(t[1]=r[1]);if(m(r,t))return t[0]=r[1],void(t[1]=r[0])}if(n=u.get(e=o[t[0]+A(t)]))for(i=0,s=n.length;i<s;++i){if(g(r=n[i],t))return t[0]=r[0],void(t[1]=r[1]);if(m(r,t))return t[0]=r[1],void(t[1]=r[0])}n?n.push(t):u.set(e,[t]),c.push(t)}function f(t,e){var n=t[0],r=e[0],i=t[1];if(n-i!=r-e[1])return!1;for(;n<=i;++n,++r)if(!bi(o[n],o[r]))return!1;return!0}function d(t,e){var n=t[0],r=e[0],i=t[1],s=e[1];if(n-i!=r-s)return!1;for(;n<=i;++n,--s)if(!bi(o[n],o[s]))return!1;return!0}function g(t,e){var n=t[0],r=e[0],i=t[1]-n;if(i!==e[1]-r)return!1;for(var s=A(t),a=A(e),l=0;l<i;++l)if(!bi(o[n+(l+s)%i],o[r+(l+a)%i]))return!1;return!0}function m(t,e){var n=t[0],r=e[0],i=t[1],s=e[1],a=i-n;if(a!==s-r)return!1;for(var l=A(t),u=a-A(e),c=0;c<a;++c)if(!bi(o[n+(c+l)%a],o[s-(c+u)%a]))return!1;return!0}function A(t){for(var e=t[0],n=t[1],r=e,i=r,s=o[r];++r<n;){var a=o[r];(a[0]<s[0]||a[0]===s[0]&&a[1]<s[1])&&(i=r,s=a)}return i-e}return t}(function(t){var e,n,r,i,o,s,a,l=function(t){var e,n,r,i,o=t.coordinates,s=t.lines,a=t.rings,l=function(){for(var t=vi(1.4*o.length,b,x,Int32Array,-1,Int32Array),e=new Int32Array(o.length),n=0,r=o.length;n<r;++n)e[n]=t.maybeSet(n,n);return e}(),u=new Int32Array(o.length),c=new Int32Array(o.length),h=new Int32Array(o.length),p=new Int8Array(o.length),f=0;for(e=0,n=o.length;e<n;++e)u[e]=c[e]=h[e]=-1;for(e=0,n=s.length;e<n;++e){var d=s[e],g=d[0],m=d[1];for(r=l[g],i=l[++g],++f,p[r]=1;++g<=m;)v(e,r,r=i,i=l[g]);++f,p[i]=1}for(e=0,n=o.length;e<n;++e)u[e]=-1;for(e=0,n=a.length;e<n;++e){var A=a[e],y=A[0]+1,_=A[1];for(v(e,l[_-1],r=l[y-1],i=l[y]);++y<=_;)v(e,r,r=i,i=l[y])}function v(t,e,n,r){if(u[n]!==t){u[n]=t;var i=c[n];if(i>=0){var o=h[n];i===e&&o===r||i===r&&o===e||(++f,p[n]=1)}else c[n]=e,h[n]=r}}function b(t){return Si(o[t])}function x(t,e){return bi(o[t],o[e])}u=c=h=null;var w,E=function(t,e,n,r,i){3===arguments.length&&(r=Array,i=null);for(var o=new r(t=1<<Math.max(4,Math.ceil(Math.log(t)/Math.LN2))),s=t-1,a=0;a<t;++a)o[a]=i;function l(r){for(var a=e(r)&s,l=o[a],u=0;l!=i;){if(n(l,r))return!0;if(++u>=t)throw new Error("full hashset");l=o[a=a+1&s]}return o[a]=r,!0}function u(r){for(var a=e(r)&s,l=o[a],u=0;l!=i;){if(n(l,r))return!0;if(++u>=t)break;l=o[a=a+1&s]}return!1}function c(){for(var t=[],e=0,n=o.length;e<n;++e){var r=o[e];r!=i&&t.push(r)}return t}return{add:l,has:u,values:c}}(1.4*f,Si,bi);for(e=0,n=o.length;e<n;++e)p[w=l[e]]&&E.add(o[w]);return E}(t),u=t.coordinates,c=t.lines,h=t.rings;for(n=0,r=c.length;n<r;++n)for(var p=c[n],f=p[0],d=p[1];++f<d;)l.has(u[f])&&(e={0:f,1:p[1]},p[1]=f,p=p.next=e);for(n=0,r=h.length;n<r;++n)for(var g=h[n],m=g[0],A=m,y=g[1],_=l.has(u[m]);++A<y;)l.has(u[A])&&(_?(e={0:A,1:g[1]},g[1]=A,g=g.next=e):(a=y-A,Ti(i=u,o=m,s=y),Ti(i,o,o+a),Ti(i,o+a,s),u[y]=u[m],_=!0,A=m));return t}(function(t){var e=-1,n=[],r=[],i=[];function o(t){t&&_i.call(s,t.type)&&s[t.type](t)}var s={GeometryCollection:function(t){t.geometries.forEach(o)},LineString:function(t){t.arcs=a(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(a)},Polygon:function(t){t.arcs=t.arcs.map(l)},MultiPolygon:function(t){t.arcs=t.arcs.map(u)}};function a(t){for(var r=0,o=t.length;r<o;++r)i[++e]=t[r];var s={0:e-o+1,1:e};return n.push(s),s}function l(t){for(var n=0,o=t.length;n<o;++n)i[++e]=t[n];var s={0:e-o+1,1:e};return r.push(s),s}function u(t){return t.map(l)}for(var c in t)o(t[c]);return{type:"Topology",coordinates:i,lines:n,rings:r,objects:t}}(t))),o=i.coordinates,s=vi(1.4*i.arcs.length,Oi,Ri);function a(t){t&&_i.call(l,t.type)&&l[t.type](t)}t=i.objects,i.bbox=n,i.arcs=i.arcs.map((function(t,e){return s.set(t,e),o.slice(t[0],t[1]+1)})),delete i.coordinates,o=null;var l={GeometryCollection:function(t){t.geometries.forEach(a)},LineString:function(t){t.arcs=u(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(u)},Polygon:function(t){t.arcs=t.arcs.map(u)},MultiPolygon:function(t){t.arcs=t.arcs.map(c)}};function u(t){var e=[];do{var n=s.get(t);e.push(t[0]<t[1]?n:~n)}while(t=t.next);return e}function c(t){return t.map(u)}for(var h in t)a(t[h]);return r&&(i.transform=r,i.arcs=function(t){for(var e=-1,n=t.length;++e<n;){for(var r,i,o=t[e],s=0,a=1,l=o.length,u=o[0],c=u[0],h=u[1];++s<l;)r=(u=o[s])[0],i=u[1],r===c&&i===h||(o[a++]=[r-c,i-h],c=r,h=i);1===a&&(o[a++]=[0,0]),o.length=a}return t}(i.arcs)),i}function Oi(t){var e,n=t[0],r=t[1];return r<n&&(e=n,n=r,r=e),n+31*r}function Ri(t,e){var n,r=t[0],i=t[1],o=e[0],s=e[1];return i<r&&(n=r,r=i,i=n),s<o&&(n=o,o=s,s=n),r===o&&i===s}const Li=function(t,e){if(void 0===e&&(e={}),!gr(e=e||{}))throw new Error("options is invalid");var n=e.mutate;if("FeatureCollection"!==Zr(t))throw new Error("geojson must be a FeatureCollection");if(!t.features.length)throw new Error("geojson is empty");!1!==n&&void 0!==n||(t=di(t));var r=function(t){var e={};Pr(t,(function(t){e[t.geometry.type]=!0}));var n=Object.keys(e);return 1===n.length?n[0]:null}(t);if(!r)throw new Error("geojson must be homogenous");var i=t;switch(r){case"LineString":return function(t,e){if(void 0===e&&(e={}),!gr(e=e||{}))throw new Error("options is invalid");var n=e.mutate;if("FeatureCollection"!==Zr(t))throw new Error("geojson must be a FeatureCollection");if(!t.features.length)throw new Error("geojson is empty");!1!==n&&void 0!==n||(t=di(t));var r=[],i=Rr(t,(function(t,e){return function(t,e){var n,r=t.geometry.coordinates,i=e.geometry.coordinates,o=gi(r[0]),s=gi(r[r.length-1]),a=gi(i[0]),l=gi(i[i.length-1]);if(o===l)n=i.concat(r.slice(1));else if(a===s)n=r.concat(i.slice(1));else if(o===a)n=r.slice(1).reverse().concat(i);else{if(s!==l)return null;n=r.concat(i.reverse().slice(1))}return Kn(n)}(t,e)||(r.push(t),e)}));return i&&r.push(i),r.length?1===r.length?r[0]:er(r.map((function(t){return t.coordinates}))):null}(i,e);case"Polygon":return function(t,e){if(void 0===e&&(e={}),"FeatureCollection"!==Zr(t))throw new Error("geojson must be a FeatureCollection");if(!t.features.length)throw new Error("geojson is empty");!1!==e.mutate&&void 0!==e.mutate||(t=di(t));var n=[];Pr(t,(function(t){n.push(t.geometry)}));var r=Ii({geoms:ir(n).geometry}),i=function(t){return Ai(t,yi.apply(this,arguments))}(r,r.objects.geoms.geometries);return i}(i,e);default:throw new Error(r+" is not supported")}},ki=function(t,e){void 0===e&&(e={});var n=e.maxEdge||1/0,r=function(t){var e=[],n={};return xr(t,(function(t){if(t.geometry){var r=t.geometry.coordinates.join("-");Object.prototype.hasOwnProperty.call(n,r)||(e.push(t),n[r]=!0)}})),tr(e)}(t),i=si(r);if(i.features=i.features.filter((function(t){var r=t.geometry.coordinates[0][0],i=t.geometry.coordinates[0][1],o=t.geometry.coordinates[0][2],s=oi(r,i,e),a=oi(i,o,e),l=oi(r,o,e);return s<=n&&a<=n&&l<=n})),i.features.length<1)return null;var o=Li(i);return 1===o.coordinates.length&&(o.coordinates=o.coordinates[0],o.type="Polygon"),Wn(o)};var Di=n(67);const Ni=function(t,e,n,r){var i=Di(6),o=e.features.map((function(t){var e;return{minX:t.geometry.coordinates[0],minY:t.geometry.coordinates[1],maxX:t.geometry.coordinates[0],maxY:t.geometry.coordinates[1],property:null===(e=t.properties)||void 0===e?void 0:e[n]}}));return i.load(o),t.features.forEach((function(t){t.properties||(t.properties={});var e=Nr(t),n=i.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}),o=[];n.forEach((function(e){ni([e.minX,e.minY],t)&&o.push(e.property)})),t.properties[r]=o})),t},Fi=function(t,e){if(!gr(e=e||{}))throw new Error("options is invalid");var n=e.mutate;if(!t)throw new Error("geojson is required");return!1!==n&&void 0!==n||(t=di(t)),yr(t,(function(t){var e=t[0],n=t[1];t[0]=n,t[1]=e})),t};function Bi(t){var e=Br(t);if(2===e.length&&!zi(e[0],e[1]))return e;var n=[],r=e.length-1,i=n.length;n.push(e[0]);for(var o=1;o<r;o++){var s=n[n.length-1];e[o][0]===s[0]&&e[o][1]===s[1]||(n.push(e[o]),(i=n.length)>2&&ji(n[i-3],n[i-1],n[i-2])&&n.splice(n.length-2,1))}if(n.push(e[e.length-1]),i=n.length,zi(e[0],e[e.length-1])&&i<4)throw new Error("invalid polygon");return ji(n[i-3],n[i-1],n[i-2])&&n.splice(n.length-2,1),n}function zi(t,e){return t[0]===e[0]&&t[1]===e[1]}function ji(t,e,n){var r=n[0],i=n[1],o=t[0],s=t[1],a=e[0],l=e[1],u=a-o,c=l-s;return 0==(r-o)*c-(i-s)*u&&(Math.abs(u)>=Math.abs(c)?u>0?o<=r&&r<=a:a<=r&&r<=o:c>0?s<=i&&i<=l:l<=i&&i<=s)}const Ui=function(t,e){void 0===e&&(e={});var n="object"==typeof e?e.mutate:e;if(!t)throw new Error("geojson is required");var r=Zr(t),i=[];switch(r){case"LineString":i=Bi(t);break;case"MultiLineString":case"Polygon":Br(t).forEach((function(t){i.push(Bi(t))}));break;case"MultiPolygon":Br(t).forEach((function(t){var e=[];t.forEach((function(t){e.push(Bi(t))})),i.push(e)}));break;case"Point":return t;case"MultiPoint":var o={};Br(t).forEach((function(t){var e=t.join("-");Object.prototype.hasOwnProperty.call(o,e)||(i.push(t),o[e]=!0)}));break;default:throw new Error(r+" geometry not supported")}return t.coordinates?!0===n?(t.coordinates=i,t):{type:r,coordinates:i}:!0===n?(t.geometry.coordinates=i,t):Wn({type:r,coordinates:i},t.properties,{bbox:t.bbox,id:t.id})};function Vi(t,e,n){var r=e.x,i=e.y,o=n.x-r,s=n.y-i;if(0!==o||0!==s){var a=((t.x-r)*o+(t.y-i)*s)/(o*o+s*s);a>1?(r=n.x,i=n.y):a>0&&(r+=o*a,i+=s*a)}return(o=t.x-r)*o+(s=t.y-i)*s}function Gi(t,e,n,r,i){for(var o,s=r,a=e+1;a<n;a++){var l=Vi(t[a],t[e],t[n]);l>s&&(o=a,s=l)}s>r&&(o-e>1&&Gi(t,e,o,r,i),i.push(t[o]),n-o>1&&Gi(t,o,n,r,i))}function Zi(t,e){var n=t.length-1,r=[t[0]];return Gi(t,0,n,e,r),r.push(t[n]),r}function qi(t,e,n){if(t.length<=2)return t;var r=void 0!==e?e*e:1;return t=n?t:function(t,e){for(var n,r,i,o,s,a=t[0],l=[a],u=1,c=t.length;u<c;u++)i=a,void 0,void 0,(o=(r=n=t[u]).x-i.x)*o+(s=r.y-i.y)*s>e&&(l.push(n),a=n);return a!==n&&l.push(n),l}(t,r),Zi(t,r)}function Wi(t,e,n){return qi(t.map((function(t){return{x:t[0],y:t[1],z:t[2]}})),e,n).map((function(t){return t.z?[t.x,t.y,t.z]:[t.x,t.y]}))}function Hi(t,e,n){return t.map((function(t){var r=t.map((function(t){return{x:t[0],y:t[1]}}));if(r.length<4)throw new Error("invalid polygon");for(var i=qi(r,e,n).map((function(t){return[t.x,t.y]}));!Xi(i);)i=qi(r,e-=.01*e,n).map((function(t){return[t.x,t.y]}));return i[i.length-1][0]===i[0][0]&&i[i.length-1][1]===i[0][1]||i.push(i[0]),i}))}function Xi(t){return!(t.length<3||3===t.length&&t[2][0]===t[0][0]&&t[2][1]===t[0][1])}const $i=function(t,e){if(!gr(e=e||{}))throw new Error("options is invalid");var n=void 0!==e.tolerance?e.tolerance:1,r=e.highQuality||!1,i=e.mutate||!1;if(!t)throw new Error("geojson is required");if(n&&n<0)throw new Error("invalid tolerance");return!0!==i&&(t=di(t)),Sr(t,(function(t){!function(t,e,n){var r=t.type;if("Point"===r||"MultiPoint"===r)return t;Ui(t,!0);var i=t.coordinates;switch(r){case"LineString":t.coordinates=Wi(i,e,n);break;case"MultiLineString":t.coordinates=i.map((function(t){return Wi(t,e,n)}));break;case"Polygon":t.coordinates=Hi(i,e,n);break;case"MultiPolygon":t.coordinates=i.map((function(t){return Hi(t,e,n)}))}}(t,n,r)})),t};var Yi=function(){function t(t){this.points=t.points||[],this.duration=t.duration||1e4,this.sharpness=t.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=t.stepLength||60,this.length=this.points.length,this.delay=0;for(var e=0;e<this.length;e++)this.points[e].z=this.points[e].z||0;for(e=0;e<this.length-1;e++){var n=this.points[e],r=this.points[e+1];this.centers.push({x:(n.x+r.x)/2,y:(n.y+r.y)/2,z:(n.z+r.z)/2})}for(this.controls.push([this.points[0],this.points[0]]),e=0;e<this.centers.length-1;e++){var i=this.points[e+1].x-(this.centers[e].x+this.centers[e+1].x)/2,o=this.points[e+1].y-(this.centers[e].y+this.centers[e+1].y)/2,s=this.points[e+1].z-(this.centers[e].y+this.centers[e+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e].x+i),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e].y+o),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e].z+s)},{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e+1].x+i),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e+1].y+o),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e+1].z+s)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}return t.prototype.cacheSteps=function(t){var e=[],n=this.pos(0);e.push(0);for(var r=0;r<this.duration;r+=10){var i=this.pos(r);Math.sqrt((i.x-n.x)*(i.x-n.x)+(i.y-n.y)*(i.y-n.y)+(i.z-n.z)*(i.z-n.z))>t&&(e.push(r),n=i)}return e},t.prototype.vector=function(t){var e=this.pos(t+10),n=this.pos(t-10);return{angle:180*Math.atan2(e.y-n.y,e.x-n.x)/3.14,speed:Math.sqrt((n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y)+(n.z-e.z)*(n.z-e.z))}},t.prototype.pos=function(t){var e=t-this.delay;e<0&&(e=0),e>this.duration&&(e=this.duration-1);var n=e/this.duration;if(n>=1)return this.points[this.length-1];var r=Math.floor((this.points.length-1)*n);return function(t,e,n,r,i){var o=function(t){var e=t*t;return[e*t,3*e*(1-t),3*t*(1-t)*(1-t),(1-t)*(1-t)*(1-t)]}(t);return{x:i.x*o[0]+r.x*o[1]+n.x*o[2]+e.x*o[3],y:i.y*o[0]+r.y*o[1]+n.y*o[2]+e.y*o[3],z:i.z*o[0]+r.z*o[1]+n.z*o[2]+e.z*o[3]}}((this.length-1)*n-r,this.points[r],this.controls[r][1],this.controls[r+1][0],this.points[r+1])},t}();const Qi=Yi,Ki=function(t,e){void 0===e&&(e={});for(var n=e.resolution||1e4,r=e.sharpness||.85,i=[],o=Gr(t).coordinates.map((function(t){return{x:t[0],y:t[1]}})),s=new Qi({duration:n,points:o,sharpness:r}),a=function(t){var e=s.pos(t);Math.floor(t/100)%2==0&&i.push([e.x,e.y])},l=0;l<s.duration;l+=10)a(l);return a(s.duration),Kn(i,e.properties)},Ji=function(t,e,n,r){return t=di(t),e=di(e),xr(t,(function(t){t.properties||(t.properties={}),xr(e,(function(e){void 0===t.properties[r]&&ni(t,e)&&(t.properties[r]=e.properties[n])}))})),t},to=function(t,e){if(!t)throw new Error("featurecollection is required");if(null==e)throw new Error("num is required");if("number"!=typeof e)throw new Error("num must be a number");return tr(function(t,e){for(var n,r,i=t.slice(0),o=t.length,s=o-e;o-- >s;)n=i[r=Math.floor((o+1)*Math.random())],i[r]=i[o],i[o]=n;return i.slice(s)}(t.features,e))};function eo(t,e){void 0===e&&(e={});var n=Number(t[0]),r=Number(t[1]),i=Number(t[2]),o=Number(t[3]);if(6===t.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var s=[n,r];return Yn([[s,[i,r],[i,o],[n,o],s]],e.properties,{bbox:t,id:e.id})}const no=function(t){return eo(Nr(t))},ro=function(t){var e=t[0],n=t[1],r=t[2],i=t[3];if(oi(t.slice(0,2),[r,n])>=oi(t.slice(0,2),[e,i])){var o=(n+i)/2;return[e,o-(r-e)/2,r,o+(r-e)/2]}var s=(e+r)/2;return[s-(i-n)/2,n,s+(i-n)/2,i]};function io(t,e,n,r){void 0===r&&(r={});var i=Fr(t),o=hr(i[0]),s=hr(i[1]),a=hr(n),l=ar(e,r.units),u=Math.asin(Math.sin(s)*Math.cos(l)+Math.cos(s)*Math.sin(l)*Math.cos(a));return Xn([cr(o+Math.atan2(Math.sin(a)*Math.sin(l)*Math.cos(s),Math.cos(l)-Math.sin(s)*Math.sin(u))),cr(u)],r.properties)}const oo=function(t,e,n){void 0===n&&(n={});for(var r=n.steps||64,i=n.properties?n.properties:!Array.isArray(t)&&"Feature"===t.type&&t.properties?t.properties:{},o=[],s=0;s<r;s++)o.push(io(t,e,-360*s/r,n).geometry.coordinates);return o.push(o[0]),Yn([o],i)};function so(t,e,n){if(void 0===n&&(n={}),!0===n.final)return function(t,e){var n=so(e,t);return(n+180)%360}(t,e);var r=Fr(t),i=Fr(e),o=hr(r[0]),s=hr(i[0]),a=hr(r[1]),l=hr(i[1]),u=Math.sin(s-o)*Math.cos(l),c=Math.cos(a)*Math.sin(l)-Math.sin(a)*Math.cos(l)*Math.cos(s-o);return cr(Math.atan2(u,c))}const ao=function(t,e){return io(t,oi(t,e)/2,so(t,e))},lo=function(t,e){void 0===e&&(e={});var n=Nr(t);return Xn([(n[0]+n[2])/2,(n[1]+n[3])/2],e.properties,e)},uo=function(t,e){void 0===e&&(e={});var n=0,r=0,i=0;return yr(t,(function(t){n+=t[0],r+=t[1],i++}),!0),Xn([n/i,r/i],e.properties)},co=function t(e,n){switch(void 0===n&&(n={}),Zr(e)){case"Point":return Xn(Fr(e),n.properties);case"Polygon":var r=[];yr(e,(function(t){r.push(t)}));var i,o,s,a,l,u,c,h,p=uo(e,{properties:n.properties}),f=p.geometry.coordinates,d=0,g=0,m=0,A=r.map((function(t){return[t[0]-f[0],t[1]-f[1]]}));for(i=0;i<r.length-1;i++)a=(o=A[i])[0],u=o[1],l=(s=A[i+1])[0],m+=h=a*(c=s[1])-l*u,d+=(a+l)*h,g+=(u+c)*h;if(0===m)return p;var y=1/(.5*m*6);return Xn([f[0]+y*d,f[1]+y*g],n.properties);default:var _=ei(e);return _?t(_,{properties:n.properties}):uo(e,{properties:n.properties})}},ho=function(t){var e={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}};return xr(t,(function(t){var n,r,i,o;switch(null===(o=t.geometry)||void 0===o?void 0:o.type){case"Point":e.MultiPoint.coordinates.push(t.geometry.coordinates),e.MultiPoint.properties.push(t.properties);break;case"MultiPoint":(n=e.MultiPoint.coordinates).push.apply(n,t.geometry.coordinates),e.MultiPoint.properties.push(t.properties);break;case"LineString":e.MultiLineString.coordinates.push(t.geometry.coordinates),e.MultiLineString.properties.push(t.properties);break;case"MultiLineString":(r=e.MultiLineString.coordinates).push.apply(r,t.geometry.coordinates),e.MultiLineString.properties.push(t.properties);break;case"Polygon":e.MultiPolygon.coordinates.push(t.geometry.coordinates),e.MultiPolygon.properties.push(t.properties);break;case"MultiPolygon":(i=e.MultiPolygon.coordinates).push.apply(i,t.geometry.coordinates),e.MultiPolygon.properties.push(t.properties)}})),tr(Object.keys(e).filter((function(t){return e[t].coordinates.length})).sort().map((function(t){return Wn({type:t,coordinates:e[t].coordinates},{collectedProperties:e[t].properties})})))},po=function(t){var e=[];return"FeatureCollection"===t.type?xr(t,(function(t){yr(t,(function(n){e.push(Xn(n,t.properties))}))})):yr(t,(function(n){e.push(Xn(n,t.properties))})),tr(e)};var fo=n(9187);function go(t){var e=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[i][o][s]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n}(t),n=fo(e.vertices,e.holes,2),r=[],i=[];n.forEach((function(t,r){var o=n[r];i.push([e.vertices[2*o],e.vertices[2*o+1]])}));for(var o=0;o<i.length;o+=3){var s=i.slice(o,o+3);s.push(i[o]),r.push(Yn([s]))}return r}const mo=function(t){if(!t.geometry||"Polygon"!==t.geometry.type&&"MultiPolygon"!==t.geometry.type)throw new Error("input must be a Polygon or MultiPolygon");var e={type:"FeatureCollection",features:[]};return"Polygon"===t.geometry.type?e.features=go(t.geometry.coordinates):t.geometry.coordinates.forEach((function(t){e.features=e.features.concat(go(t))})),e},Ao=function(t,e){if(!t)throw new Error("targetPoint is required");if(!e)throw new Error("points is required");var n,r=1/0,i=0;return xr(e,(function(e,n){var o=oi(t,e);o<r&&(i=n,r=o)})),(n=di(e.features[i])).properties.featureIndex=i,n.properties.distanceToPoint=r,n},yo=function(t){if(!t)throw new Error("geojson is required");var e=[];return Pr(t,(function(t){!function(t,e){var n=[],r=t.geometry;if(null!==r){switch(r.type){case"Polygon":n=Br(r);break;case"LineString":n=[Br(r)]}n.forEach((function(n){var r=function(t,e){var n=[];return t.reduce((function(t,r){var i,o,s,a,l,u,c=Kn([t,r],e);return c.bbox=(o=r,s=(i=t)[0],a=i[1],[s<(l=o[0])?s:l,a<(u=o[1])?a:u,s>l?s:l,a>u?a:u]),n.push(c),r})),n}(n,t.properties);r.forEach((function(t){t.id=e.length,e.push(t)}))}))}}(t,e)})),tr(e)};var _o=n(1787);function vo(t,e){var n=Br(t),r=Br(e);if(2!==n.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==r.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var i=n[0][0],o=n[0][1],s=n[1][0],a=n[1][1],l=r[0][0],u=r[0][1],c=r[1][0],h=r[1][1],p=(h-u)*(s-i)-(c-l)*(a-o);if(0===p)return null;var f=((c-l)*(o-u)-(h-u)*(i-l))/p,d=((s-i)*(o-u)-(a-o)*(i-l))/p;return f>=0&&f<=1&&d>=0&&d<=1?Xn([i+f*(s-i),o+f*(a-o)]):null}const bo=function(t,e){var n={},r=[];if("LineString"===t.type&&(t=Wn(t)),"LineString"===e.type&&(e=Wn(e)),"Feature"===t.type&&"Feature"===e.type&&null!==t.geometry&&null!==e.geometry&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length){var i=vo(t,e);return i&&r.push(i),tr(r)}var o=_o();return o.load(yo(e)),xr(yo(t),(function(t){xr(o.search(t),(function(e){var i=vo(t,e);if(i){var o=Br(i).join(",");n[o]||(n[o]=!0,r.push(i))}}))})),tr(r)},xo=function(t,e,n){void 0===n&&(n={});var r=Xn([1/0,1/0],{dist:1/0}),i=0;return Pr(t,(function(t){for(var o=Br(t),s=0;s<o.length-1;s++){var a=Xn(o[s]);a.properties.dist=oi(e,a,n);var l=Xn(o[s+1]);l.properties.dist=oi(e,l,n);var u=oi(a,l,n),c=Math.max(a.properties.dist,l.properties.dist),h=so(a,l),p=io(e,c,h+90,n),f=io(e,c,h-90,n),d=bo(Kn([p.geometry.coordinates,f.geometry.coordinates]),Kn([a.geometry.coordinates,l.geometry.coordinates])),g=null;d.features.length>0&&((g=d.features[0]).properties.dist=oi(e,g,n),g.properties.location=i+oi(a,g,n)),a.properties.dist<r.properties.dist&&((r=a).properties.index=s,r.properties.location=i),l.properties.dist<r.properties.dist&&((r=l).properties.index=s+1,r.properties.location=i+u),g&&g.properties.dist<r.properties.dist&&((r=g).properties.index=s),i+=u}})),r},wo=function(t,e,n){void 0===n&&(n={});var r=Fr(t),i=Fr(e);i[0]+=i[0]-r[0]>180?-360:r[0]-i[0]>180?360:0;var o=function(t,e,n){var r=n=void 0===n?Vn:Number(n),i=t[1]*Math.PI/180,o=e[1]*Math.PI/180,s=o-i,a=Math.abs(e[0]-t[0])*Math.PI/180;a>Math.PI&&(a-=2*Math.PI);var l=Math.log(Math.tan(o/2+Math.PI/4)/Math.tan(i/2+Math.PI/4)),u=Math.abs(l)>1e-11?s/l:Math.cos(i);return Math.sqrt(s*s+u*u*a*a)*r}(r,i);return pr(o,"meters",n.units)};function Eo(t,e){return t[0]*e[0]+t[1]*e[1]}function So(t,e,n){return"planar"===n.method?wo(t,e,n):oi(t,e,n)}const To=function(t,e,n){if(void 0===n&&(n={}),n.method||(n.method="geodesic"),n.units||(n.units="kilometers"),!t)throw new Error("pt is required");if(Array.isArray(t)?t=Xn(t):"Point"===t.type?t=Wn(t):Ur(t,"Point","point"),!e)throw new Error("line is required");Array.isArray(e)?e=Kn(e):"LineString"===e.type?e=Wn(e):Ur(e,"LineString","line");var r=1/0,i=t.geometry.coordinates;return Cr(e,(function(t){var e=t.geometry.coordinates[0],o=t.geometry.coordinates[1],s=function(t,e,n,r){var i=[n[0]-e[0],n[1]-e[1]],o=Eo([t[0]-e[0],t[1]-e[1]],i);if(o<=0)return So(t,e,{method:r.method,units:"degrees"});var s=Eo(i,i);if(s<=o)return So(t,n,{method:r.method,units:"degrees"});var a=o/s;return So(t,[e[0]+a*i[0],e[1]+a*i[1]],{method:r.method,units:"degrees"})}(i,e,o,n);s<r&&(r=s)})),pr(r,"degrees",n.units)},Po=function(t,e,n){void 0===n&&(n={});var r=n.units,i=n.properties||{},o=function(t){var e=[];switch(t.geometry?t.geometry.type:t.type){case"GeometryCollection":return Sr(t,(function(t){"Point"===t.type&&e.push({type:"Feature",properties:{},geometry:t})})),{type:"FeatureCollection",features:e};case"FeatureCollection":return t.features=t.features.filter((function(t){return"Point"===t.geometry.type})),t;default:throw new Error("points must be a Point Collection")}}(t);if(!o.features.length)throw new Error("points must contain features");if(!e)throw new Error("line is required");if("LineString"!==Zr(e))throw new Error("line must be a LineString");var s=1/0,a=null;return xr(o,(function(t){var n=To(t,e,{units:r});n<s&&(s=n,a=t)})),a&&(a.properties=qr({dist:s},a.properties,i)),a},Mo=function(t,e){var n=Fr(t),r=Gr(e).coordinates[0];if(r.length<4)throw new Error("OuterRing of a Polygon must have 4 or more Positions.");var i=e.properties||{},o=i.a,s=i.b,a=i.c,l=n[0],u=n[1],c=r[0][0],h=r[0][1],p=void 0!==o?o:r[0][2],f=r[1][0],d=r[1][1],g=void 0!==s?s:r[1][2],m=r[2][0],A=r[2][1],y=void 0!==a?a:r[2][2];return(y*(l-c)*(u-d)+p*(l-f)*(u-A)+g*(l-m)*(u-h)-g*(l-c)*(u-A)-y*(l-f)*(u-h)-p*(l-m)*(u-d))/((l-c)*(u-d)+(l-f)*(u-A)+(l-m)*(u-h)-(l-c)*(u-A)-(l-f)*(u-h)-(l-m)*(u-d))};function Co(t){var e,n,r={type:"FeatureCollection",features:[]};if("LineString"===(n="Feature"===t.type?t.geometry:t).type)e=[n.coordinates];else if("MultiLineString"===n.type)e=n.coordinates;else if("MultiPolygon"===n.type)e=[].concat.apply([],n.coordinates);else{if("Polygon"!==n.type)throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");e=n.coordinates}return e.forEach((function(t){e.forEach((function(e){for(var n=0;n<t.length-1;n++)for(var i=n;i<e.length-1;i++){if(t===e){if(1===Math.abs(n-i))continue;if(0===n&&i===t.length-2&&t[n][0]===t[t.length-1][0]&&t[n][1]===t[t.length-1][1])continue}var o=(s=t[n][0],a=t[n][1],l=t[n+1][0],u=t[n+1][1],c=e[i][0],h=e[i][1],p=e[i+1][0],f=e[i+1][1],d=void 0,g=void 0,m=void 0,A=void 0,y=void 0,y={x:null,y:null,onLine1:!1,onLine2:!1},0==(d=(f-h)*(l-s)-(p-c)*(u-a))?null!==y.x&&null!==y.y&&y:(A=(l-s)*(g=a-h)-(u-a)*(m=s-c),g=((p-c)*g-(f-h)*m)/d,m=A/d,y.x=s+g*(l-s),y.y=a+g*(u-a),g>=0&&g<=1&&(y.onLine1=!0),m>=0&&m<=1&&(y.onLine2=!0),!(!y.onLine1||!y.onLine2)&&[y.x,y.y]));o&&r.features.push(Xn([o[0],o[1]]))}var s,a,l,u,c,h,p,f,d,g,m,A,y}))})),r}function Io(t,e,n,r,i,o){return Math.sqrt((i-n)*(i-n)+(o-r)*(o-r))===Math.sqrt((t-n)*(t-n)+(e-r)*(e-r))+Math.sqrt((i-t)*(i-t)+(o-e)*(o-e))}const Oo=function(t){for(var e=function(t){return"FeatureCollection"!==t.type?"Feature"!==t.type?tr([Wn(t)]):tr([t]):t}(t),n=lo(e),r=!1,i=0;!r&&i<e.features.length;){var o,s=e.features[i].geometry,a=!1;if("Point"===s.type)n.geometry.coordinates[0]===s.coordinates[0]&&n.geometry.coordinates[1]===s.coordinates[1]&&(r=!0);else if("MultiPoint"===s.type){var l=!1;for(o=0;!l&&o<s.coordinates.length;)n.geometry.coordinates[0]===s.coordinates[o][0]&&n.geometry.coordinates[1]===s.coordinates[o][1]&&(r=!0,l=!0),o++}else if("LineString"===s.type)for(o=0;!a&&o<s.coordinates.length-1;)Io(n.geometry.coordinates[0],n.geometry.coordinates[1],s.coordinates[o][0],s.coordinates[o][1],s.coordinates[o+1][0],s.coordinates[o+1][1])&&(a=!0,r=!0),o++;else if("MultiLineString"===s.type)for(var u=0;u<s.coordinates.length;){a=!1,o=0;for(var c=s.coordinates[u];!a&&o<c.length-1;)Io(n.geometry.coordinates[0],n.geometry.coordinates[1],c[o][0],c[o][1],c[o+1][0],c[o+1][1])&&(a=!0,r=!0),o++;u++}else"Polygon"!==s.type&&"MultiPolygon"!==s.type||ni(n,s)&&(r=!0);i++}if(r)return n;var h=tr([]);for(i=0;i<e.features.length;i++)h.features=h.features.concat(po(e.features[i]).features);return Xn(Ao(n,h).geometry.coordinates)};var Ro=6378137;function Lo(t){return Tr(t,(function(t,e){return t+function(t){var e,n=0;switch(t.type){case"Polygon":return ko(t.coordinates);case"MultiPolygon":for(e=0;e<t.coordinates.length;e++)n+=ko(t.coordinates[e]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(e)}),0)}function ko(t){var e=0;if(t&&t.length>0){e+=Math.abs(Do(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(Do(t[n]))}return e}function Do(t){var e,n,r,i,o,s,a=0,l=t.length;if(l>2){for(s=0;s<l;s++)s===l-2?(r=l-2,i=l-1,o=0):s===l-1?(r=l-1,i=0,o=1):(r=s,i=s+1,o=s+2),e=t[r],n=t[i],a+=(No(t[o][0])-No(e[0]))*Math.sin(No(n[1]));a=a*Ro*Ro/2}return a}function No(t){return t*Math.PI/180}function Fo(t,e,n){void 0===n&&(n={});for(var r=Gr(t).coordinates,i=0,o=0;o<r.length&&!(e>=i&&o===r.length-1);o++){if(i>=e){var s=e-i;if(s){var a=so(r[o],r[o-1])-180;return io(r[o],s,a,n)}return Xn(r[o])}i+=oi(r[o],r[o+1],n)}return Xn(r[r.length-1])}function Bo(t,e){return void 0===e&&(e={}),Ir(t,(function(t,n){var r=n.geometry.coordinates;return t+oi(r[0],r[1],e)}),0)}const zo=function(t,e,n){var r=Br(n);if("LineString"!==Zr(n))throw new Error("line must be a LineString");for(var i,o=xo(n,t),s=xo(n,e),a=[(i=o.properties.index<=s.properties.index?[o,s]:[s,o])[0].geometry.coordinates],l=i[0].properties.index+1;l<i[1].properties.index+1;l++)a.push(r[l]);return a.push(i[1].geometry.coordinates),Kn(a,n.properties)},jo=function(t,e,n,r){if(!gr(r=r||{}))throw new Error("options is invalid");var i,o=[];if("Feature"===t.type)i=t.geometry.coordinates;else{if("LineString"!==t.type)throw new Error("input must be a LineString Feature or Geometry");i=t.coordinates}for(var s,a,l,u=i.length,c=0,h=0;h<i.length&&!(e>=c&&h===i.length-1);h++){if(c>e&&0===o.length){if(!(s=e-c))return o.push(i[h]),Kn(o);a=so(i[h],i[h-1])-180,l=io(i[h],s,a,r),o.push(l.geometry.coordinates)}if(c>=n)return(s=n-c)?(a=so(i[h],i[h-1])-180,l=io(i[h],s,a,r),o.push(l.geometry.coordinates),Kn(o)):(o.push(i[h]),Kn(o));if(c>=e&&o.push(i[h]),h===i.length-1)return Kn(o);c+=oi(i[h],i[h+1],r)}if(c<e&&i.length===u)throw new Error("Start position is beyond line");var p=i[i.length-1];return Kn([p,p])};function Uo(t,e,n,r,i){var o=n[0],s=n[1],a=t[0],l=t[1],u=e[0],c=e[1],h=u-a,p=c-l,f=(n[0]-a)*p-(n[1]-l)*h;if(null!==i){if(Math.abs(f)>i)return!1}else if(0!==f)return!1;return r?"start"===r?Math.abs(h)>=Math.abs(p)?h>0?a<o&&o<=u:u<=o&&o<a:p>0?l<s&&s<=c:c<=s&&s<l:"end"===r?Math.abs(h)>=Math.abs(p)?h>0?a<=o&&o<u:u<o&&o<=a:p>0?l<=s&&s<c:c<s&&s<=l:"both"===r&&(Math.abs(h)>=Math.abs(p)?h>0?a<o&&o<u:u<o&&o<a:p>0?l<s&&s<c:c<s&&s<l):Math.abs(h)>=Math.abs(p)?h>0?a<=o&&o<=u:u<=o&&o<=a:p>0?l<=s&&s<=c:c<=s&&s<=l}const Vo=function(t,e,n){void 0===n&&(n={});for(var r=Fr(t),i=Br(e),o=0;o<i.length-1;o++){var s=!1;if(n.ignoreEndVertices&&(0===o&&(s="start"),o===i.length-2&&(s="end"),0===o&&o+1===i.length-1&&(s="both")),Uo(i[o],i[o+1],r,s,void 0===n.epsilon?null:n.epsilon))return!0}return!1};function Go(t,e){return!(t[0]>e[0]||t[2]<e[2]||t[1]>e[1]||t[3]<e[3])}function Zo(t,e){return t[0]===e[0]&&t[1]===e[1]}const qo=function(t,e){var n=Gr(t),r=Gr(e),i=n.type,o=r.type;switch(i){case"Point":switch(o){case"MultiPoint":return function(t,e){var n,r=!1;for(n=0;n<e.coordinates.length;n++)if(Zo(e.coordinates[n],t.coordinates)){r=!0;break}return r}(n,r);case"LineString":return Vo(n,r,{ignoreEndVertices:!0});case"Polygon":case"MultiPolygon":return ni(n,r,{ignoreBoundary:!0});default:throw new Error("feature2 "+o+" geometry not supported")}case"MultiPoint":switch(o){case"MultiPoint":return function(t,e){for(var n=0;n<t.coordinates.length;n++){for(var r=!1,i=0;i<e.coordinates.length;i++)Zo(t.coordinates[n],e.coordinates[i])&&(r=!0);if(!r)return!1}return!0}(n,r);case"LineString":return function(t,e){for(var n=!1,r=0;r<t.coordinates.length;r++){if(!Vo(t.coordinates[r],e))return!1;n||(n=Vo(t.coordinates[r],e,{ignoreEndVertices:!0}))}return n}(n,r);case"Polygon":case"MultiPolygon":return function(t,e){for(var n=!0,r=!1,i=0;i<t.coordinates.length;i++){if(!(r=ni(t.coordinates[1],e))){n=!1;break}r=ni(t.coordinates[1],e,{ignoreBoundary:!0})}return n&&r}(n,r);default:throw new Error("feature2 "+o+" geometry not supported")}case"LineString":switch(o){case"LineString":return function(t,e){for(var n=0;n<t.coordinates.length;n++)if(!Vo(t.coordinates[n],e))return!1;return!0}(n,r);case"Polygon":case"MultiPolygon":return function(t,e){var n,r;if(!Go(Nr(e),Nr(t)))return!1;for(var i=!1,o=0;o<t.coordinates.length-1;o++){if(!ni(t.coordinates[o],e))return!1;i||(i=ni(t.coordinates[o],e,{ignoreBoundary:!0})),i||(i=ni((n=t.coordinates[o],r=t.coordinates[o+1],[(n[0]+r[0])/2,(n[1]+r[1])/2]),e,{ignoreBoundary:!0}))}return i}(n,r);default:throw new Error("feature2 "+o+" geometry not supported")}case"Polygon":switch(o){case"Polygon":case"MultiPolygon":return function(t,e){var n=Nr(t);if(!Go(Nr(e),n))return!1;for(var r=0;r<t.coordinates[0].length;r++)if(!ni(t.coordinates[0][r],e))return!1;return!0}(n,r);default:throw new Error("feature2 "+o+" geometry not supported")}default:throw new Error("feature1 "+i+" geometry not supported")}},Wo=function(t,e,n){void 0===n&&(n={}),n.mask&&!n.units&&(n.units="kilometers");for(var r=[],i=t[0],o=t[1],s=t[2],a=t[3],l=e/oi([i,o],[s,o],n)*(s-i),u=e/oi([i,o],[i,a],n)*(a-o),c=s-i,h=a-o,p=Math.floor(c/l),f=(h-Math.floor(h/u)*u)/2,d=i+(c-p*l)/2;d<=s;){for(var g=o+f;g<=a;){var m=Xn([d,g],n.properties);n.mask?qo(m,n.mask)&&r.push(m):r.push(m),g+=u}d+=l}return tr(r)},Ho=function(t,e){void 0===e&&(e={});var n=e.precision,r=e.coordinates,i=e.mutate;if(n=null==n||isNaN(n)?6:n,r=null==r||isNaN(r)?3:r,!t)throw new Error("<geojson> is required");if("number"!=typeof n)throw new Error("<precision> must be a number");if("number"!=typeof r)throw new Error("<coordinates> must be a number");!1!==i&&void 0!==i||(t=JSON.parse(JSON.stringify(t)));var o=Math.pow(10,n);return yr(t,(function(t){!function(t,e,n){t.length>n&&t.splice(n,t.length);for(var r=0;r<t.length;r++)t[r]=Math.round(t[r]*e)/e}(t,o,r)})),t},Xo=function(t){if(!t)throw new Error("geojson is required");var e=[];return Pr(t,(function(t){e.push(t)})),tr(e)},$o=function(t,e,n){if(!gr(n=n||{}))throw new Error("options is invalid");var r=n.units,i=n.reverse;if(!t)throw new Error("geojson is required");if(e<=0)throw new Error("segmentLength must be greater than 0");var o=[];return Pr(t,(function(t){i&&(t.geometry.coordinates=t.geometry.coordinates.reverse()),function(t,e,n,r){var i=Bo(t,{units:n});if(i<=e)return r(t);var o=i/e;Number.isInteger(o)||(o=Math.floor(o)+1);for(var s=0;s<o;s++)r(jo(t,e*s,e*(s+1),{units:n}))}(t,e,r,(function(t){o.push(t)}))})),tr(o)};var Yo=n(4860);function Qo(t,e){if(!t||!e)return!1;if(t.length!==e.length)return!1;for(var n=0,r=t.length;n<r;n++)if(t[n]instanceof Array&&e[n]instanceof Array){if(!Qo(t[n],e[n]))return!1}else if(t[n]!==e[n])return!1;return!0}function Ko(t){if("Feature"!=t.type)throw new Error("The input must a geojson object of type Feature");if(void 0===t.geometry||null==t.geometry)throw new Error("The input must a geojson object with a non-empty geometry");if("Polygon"!=t.geometry.type)throw new Error("The input must be a geojson Polygon");for(var e=t.geometry.coordinates.length,n=[],r=0;r<e;r++){var i=t.geometry.coordinates[r];rs(i[0],i[i.length-1])||i.push(i[0]),n.push.apply(n,i.slice(0,i.length-1))}if(!function(t){for(var e={},n=1,r=0,i=t.length;r<i;++r){if(Object.prototype.hasOwnProperty.call(e,t[r])){n=0;break}e[t[r]]=1}return n}(n))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var o=n.length,s=function(t,e,n){if("Polygon"!==t.geometry.type)throw new Error("The input feature must be a Polygon");void 0===n&&(n=1);var r=t.geometry.coordinates,i=[],o={};if(n){for(var s=[],a=0;a<r.length;a++)for(var l=0;l<r[a].length-1;l++)s.push(g(a,l));var u=Yo();u.load(s)}for(var c=0;c<r.length;c++)for(var h=0;h<r[c].length-1;h++)if(n)u.search(g(c,h)).forEach((function(t){var e=t.ring,n=t.edge;d(c,h,e,n)}));else for(var p=0;p<r.length;p++)for(var f=0;f<r[p].length-1;f++)d(c,h,p,f);return e||(i={type:"Feature",geometry:{type:"MultiPoint",coordinates:i}}),i;function d(t,n,s,a){var l,u,c=r[t][n],h=r[t][n+1],p=r[s][a],f=r[s][a+1],d=function(t,e,n,r){if(Qo(t,n)||Qo(t,r)||Qo(e,n)||Qo(r,n))return null;var i=t[0],o=t[1],s=e[0],a=e[1],l=n[0],u=n[1],c=r[0],h=r[1],p=(i-s)*(u-h)-(o-a)*(l-c);return 0===p?null:[((i*a-o*s)*(l-c)-(i-s)*(l*h-u*c))/p,((i*a-o*s)*(u-h)-(o-a)*(l*h-u*c))/p]}(c,h,p,f);if(null!==d&&(l=h[0]!==c[0]?(d[0]-c[0])/(h[0]-c[0]):(d[1]-c[1])/(h[1]-c[1]),u=f[0]!==p[0]?(d[0]-p[0])/(f[0]-p[0]):(d[1]-p[1])/(f[1]-p[1]),!(l>=1||l<=0||u>=1||u<=0))){var g=d,m=!o[g];m&&(o[g]=!0),e?i.push(e(d,t,n,c,h,l,s,a,p,f,u,m)):i.push(d)}}function g(t,e){var n,i,o,s,a=r[t][e],l=r[t][e+1];return a[0]<l[0]?(n=a[0],i=l[0]):(n=l[0],i=a[0]),a[1]<l[1]?(o=a[1],s=l[1]):(o=l[1],s=a[1]),{minX:n,minY:o,maxX:i,maxY:s,ring:t,edge:e}}}(t,(function(t,e,n,r,i,o,s,a,l,u,c,h){return[t,e,n,r,i,o,s,a,l,u,c,h]})),a=s.length;if(0==a){var l=[];for(r=0;r<e;r++)l.push(Yn([t.geometry.coordinates[r]],{parent:-1,winding:ns(t.geometry.coordinates[r])}));var u=tr(l);return N(),F(),u}var c=[],h=[];for(r=0;r<e;r++){c.push([]);for(var p=0;p<t.geometry.coordinates[r].length-1;p++)c[r].push([new Jo(t.geometry.coordinates[r][is(p+1,t.geometry.coordinates[r].length-1)],1,[r,p],[r,is(p+1,t.geometry.coordinates[r].length-1)],void 0)]),h.push(new ts(t.geometry.coordinates[r][p],[r,is(p-1,t.geometry.coordinates[r].length-1)],[r,p],void 0,void 0,!1,!0))}for(r=0;r<a;r++)c[s[r][1]][s[r][2]].push(new Jo(s[r][0],s[r][5],[s[r][1],s[r][2]],[s[r][6],s[r][7]],void 0)),s[r][11]&&h.push(new ts(s[r][0],[s[r][1],s[r][2]],[s[r][6],s[r][7]],void 0,void 0,!0,!0));var f=h.length;for(r=0;r<c.length;r++)for(p=0;p<c[r].length;p++)c[r][p].sort((function(t,e){return t.param<e.param?-1:1}));var d=[];for(r=0;r<f;r++)d.push({minX:h[r].coord[0],minY:h[r].coord[1],maxX:h[r].coord[0],maxY:h[r].coord[1],index:r});var g=Yo();for(g.load(d),r=0;r<c.length;r++)for(p=0;p<c[r].length;p++)for(var m=0;m<c[r][p].length;m++){y=m==c[r][p].length-1?c[r][is(p+1,t.geometry.coordinates[r].length-1)][0].coord:c[r][p][m+1].coord;var A=g.search({minX:y[0],minY:y[1],maxX:y[0],maxY:y[1]})[0];c[r][p][m].nxtIsectAlongEdgeIn=A.index}for(r=0;r<c.length;r++)for(p=0;p<c[r].length;p++)for(m=0;m<c[r][p].length;m++){var y=c[r][p][m].coord,_=(A=g.search({minX:y[0],minY:y[1],maxX:y[0],maxY:y[1]})[0]).index;_<o?h[_].nxtIsectAlongRingAndEdge2=c[r][p][m].nxtIsectAlongEdgeIn:rs(h[_].ringAndEdge1,c[r][p][m].ringAndEdgeIn)?h[_].nxtIsectAlongRingAndEdge1=c[r][p][m].nxtIsectAlongEdgeIn:h[_].nxtIsectAlongRingAndEdge2=c[r][p][m].nxtIsectAlongEdgeIn}var v=[];for(r=0,p=0;p<e;p++){var b=r;for(m=0;m<t.geometry.coordinates[p].length-1;m++)h[r].coord[0]<h[b].coord[0]&&(b=r),r++;var x=h[b].nxtIsectAlongRingAndEdge2;for(m=0;m<h.length;m++)if(h[m].nxtIsectAlongRingAndEdge1==b||h[m].nxtIsectAlongRingAndEdge2==b){var w=m;break}var E=es([h[w].coord,h[b].coord,h[x].coord],!0)?1:-1;v.push({isect:b,parent:-1,winding:E})}for(v.sort((function(t,e){return h[t.isect].coord>h[e.isect].coord?-1:1})),l=[];v.length>0;){var S=v.pop(),T=S.isect,P=S.parent,M=S.winding,C=l.length,I=[h[T].coord],O=T;if(h[T].ringAndEdge1Walkable)var R=h[T].ringAndEdge1,L=h[T].nxtIsectAlongRingAndEdge1;else R=h[T].ringAndEdge2,L=h[T].nxtIsectAlongRingAndEdge2;for(;!rs(h[T].coord,h[L].coord);){I.push(h[L].coord);var k=void 0;for(r=0;r<v.length;r++)if(v[r].isect==L){k=r;break}if(null!=k&&v.splice(k,1),rs(R,h[L].ringAndEdge1)){if(R=h[L].ringAndEdge2,h[L].ringAndEdge2Walkable=!1,h[L].ringAndEdge1Walkable){var D={isect:L};es([h[O].coord,h[L].coord,h[h[L].nxtIsectAlongRingAndEdge2].coord],1==M)?(D.parent=P,D.winding=-M):(D.parent=C,D.winding=M),v.push(D)}O=L,L=h[L].nxtIsectAlongRingAndEdge2}else R=h[L].ringAndEdge1,h[L].ringAndEdge1Walkable=!1,h[L].ringAndEdge2Walkable&&(D={isect:L},es([h[O].coord,h[L].coord,h[h[L].nxtIsectAlongRingAndEdge1].coord],1==M)?(D.parent=P,D.winding=-M):(D.parent=C,D.winding=M),v.push(D)),O=L,L=h[L].nxtIsectAlongRingAndEdge1}I.push(h[L].coord),l.push(Yn([I],{index:C,parent:P,winding:M,netWinding:void 0}))}function N(){for(var t=[],e=0;e<u.features.length;e++)-1==u.features[e].properties.parent&&t.push(e);if(t.length>1)for(e=0;e<t.length;e++){for(var n=-1,r=0;r<u.features.length;r++)t[e]!=r&&ni(u.features[t[e]].geometry.coordinates[0][0],u.features[r],{ignoreBoundary:!0})&&Lo(u.features[r])<1/0&&(n=r);u.features[t[e]].properties.parent=n}}function F(){for(var t=0;t<u.features.length;t++)if(-1==u.features[t].properties.parent){var e=u.features[t].properties.winding;u.features[t].properties.netWinding=e,B(t,e)}}function B(t,e){for(var n=0;n<u.features.length;n++)if(u.features[n].properties.parent==t){var r=e+u.features[n].properties.winding;u.features[n].properties.netWinding=r,B(n,r)}}return u=tr(l),N(),F(),u}var Jo=function(t,e,n,r,i){this.coord=t,this.param=e,this.ringAndEdgeIn=n,this.ringAndEdgeOut=r,this.nxtIsectAlongEdgeIn=i},ts=function(t,e,n,r,i,o,s){this.coord=t,this.ringAndEdge1=e,this.ringAndEdge2=n,this.nxtIsectAlongRingAndEdge1=r,this.nxtIsectAlongRingAndEdge2=i,this.ringAndEdge1Walkable=o,this.ringAndEdge2Walkable=s};function es(t,e){if(void 0===e&&(e=!0),3!=t.length)throw new Error("This function requires an array of three points [x,y]");return(t[1][0]-t[0][0])*(t[2][1]-t[0][1])-(t[1][1]-t[0][1])*(t[2][0]-t[0][0])>=0==e}function ns(t){for(var e=0,n=0;n<t.length-1;n++)t[n][0]<t[e][0]&&(e=n);if(es([t[is(e-1,t.length-1)],t[e],t[is(e+1,t.length-1)]],!0))var r=1;else r=-1;return r}function rs(t,e){if(!t||!e)return!1;if(t.length!=e.length)return!1;for(var n=0,r=t.length;n<r;n++)if(t[n]instanceof Array&&e[n]instanceof Array){if(!rs(t[n],e[n]))return!1}else if(t[n]!=e[n])return!1;return!0}function is(t,e){return(t%e+e)%e}const os=function(t){var e=[];return Pr(t,(function(t){"Polygon"===t.geometry.type&&xr(Ko(t),(function(n){e.push(Yn(n.geometry.coordinates,t.properties))}))})),tr(e)};var ss=Math.PI/180,as=180/Math.PI,ls=function(t,e){this.lon=t,this.lat=e,this.x=ss*t,this.y=ss*e};ls.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)},ls.prototype.antipode=function(){var t=-1*this.lat,e=this.lon<0?180+this.lon:-1*(180-this.lon);return new ls(e,t)};var us=function(){this.coords=[],this.length=0};us.prototype.move_to=function(t){this.length++,this.coords.push(t)};var cs=function(t){this.properties=t||{},this.geometries=[]};cs.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(1===this.geometries.length)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var t=[],e=0;e<this.geometries.length;e++)t.push(this.geometries[e].coords);return{geometry:{type:"MultiLineString",coordinates:t},type:"Feature",properties:this.properties}},cs.prototype.wkt=function(){for(var t="",e="LINESTRING(",n=function(t){e+=t[0]+" "+t[1]+","},r=0;r<this.geometries.length;r++){if(0===this.geometries[r].coords.length)return"LINESTRING(empty)";this.geometries[r].coords.forEach(n),t+=e.substring(0,e.length-1)+")"}return t};var hs=function(t,e,n){if(!t||void 0===t.x||void 0===t.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!e||void 0===e.x||void 0===e.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new ls(t.x,t.y),this.end=new ls(e.x,e.y),this.properties=n||{};var r=this.start.x-this.end.x,i=this.start.y-this.end.y,o=Math.pow(Math.sin(i/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(r/2),2);if(this.g=2*Math.asin(Math.sqrt(o)),this.g===Math.PI)throw new Error("it appears "+t.view()+" and "+e.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+t+" and "+e)};hs.prototype.interpolate=function(t){var e=Math.sin((1-t)*this.g)/Math.sin(this.g),n=Math.sin(t*this.g)/Math.sin(this.g),r=e*Math.cos(this.start.y)*Math.cos(this.start.x)+n*Math.cos(this.end.y)*Math.cos(this.end.x),i=e*Math.cos(this.start.y)*Math.sin(this.start.x)+n*Math.cos(this.end.y)*Math.sin(this.end.x),o=e*Math.sin(this.start.y)+n*Math.sin(this.end.y),s=as*Math.atan2(o,Math.sqrt(Math.pow(r,2)+Math.pow(i,2)));return[as*Math.atan2(i,r),s]},hs.prototype.Arc=function(t,e){var n=[];if(!t||t<=2)n.push([this.start.lon,this.start.lat]),n.push([this.end.lon,this.end.lat]);else for(var r=1/(t-1),i=0;i<t;++i){var o=r*i,s=this.interpolate(o);n.push(s)}for(var a=!1,l=0,u=e&&e.offset?e.offset:10,c=180-u,h=-180+u,p=360-u,f=1;f<n.length;++f){var d=n[f-1][0],g=n[f][0],m=Math.abs(g-d);m>p&&(g>c&&d<h||d>c&&g<h)?a=!0:m>l&&(l=m)}var A=[];if(a&&l<u){var y=[];A.push(y);for(var _=0;_<n.length;++_){var v=parseFloat(n[_][0]);if(_>0&&Math.abs(v-n[_-1][0])>p){var b=parseFloat(n[_-1][0]),x=parseFloat(n[_-1][1]),w=parseFloat(n[_][0]),E=parseFloat(n[_][1]);if(b>-180&&b<h&&180===w&&_+1<n.length&&n[_-1][0]>-180&&n[_-1][0]<h){y.push([-180,n[_][1]]),_++,y.push([n[_][0],n[_][1]]);continue}if(b>c&&b<180&&-180===w&&_+1<n.length&&n[_-1][0]>c&&n[_-1][0]<180){y.push([180,n[_][1]]),_++,y.push([n[_][0],n[_][1]]);continue}if(b<h&&w>c){var S=b;b=w,w=S;var T=x;x=E,E=T}if(b>c&&w<h&&(w+=360),b<=180&&w>=180&&b<w){var P=(180-b)/(w-b),M=P*E+(1-P)*x;y.push([n[_-1][0]>c?180:-180,M]),(y=[]).push([n[_-1][0]>c?-180:180,M]),A.push(y)}else y=[],A.push(y);y.push([v,n[_][1]])}else y.push([n[_][0],n[_][1]])}}else{var C=[];A.push(C);for(var I=0;I<n.length;++I)C.push([n[I][0],n[I][1]])}for(var O=new cs(this.properties),R=0;R<A.length;++R){var L=new us;O.geometries.push(L);for(var k=A[R],D=0;D<k.length;++D)L.move_to(k[D])}return O};const ps=function(t,e,n){if("object"!=typeof(n=n||{}))throw new Error("options is invalid");var r=n.properties,i=n.npoints,o=n.offset;return t=Fr(t),e=Fr(e),r=r||{},i=i||100,o=o||10,new hs({x:t[0],y:t[1]},{x:e[0],y:e[1]},r).Arc(i,{offset:o}).json()};function fs(t,e){var n=[],r=_o();return Pr(e,(function(e){if(n.forEach((function(t,e){t.id=e})),n.length){var i=r.search(e);if(i.features.length){var o=gs(e,i);n=n.filter((function(t){return t.id!==o.id})),r.remove(o),xr(ds(o,e),(function(t){n.push(t),r.insert(t)}))}}else(n=ds(t,e).features).forEach((function(t){t.bbox||(t.bbox=ro(Nr(t)))})),r.load(tr(n))})),tr(n)}function ds(t,e){var n=[],r=Br(t)[0],i=Br(t)[t.geometry.coordinates.length-1];if(ms(r,Fr(e))||ms(i,Fr(e)))return tr([t]);var o=_o(),s=yo(t);o.load(s);var a=o.search(e);if(!a.features.length)return tr([t]);var l=gs(e,a),u=wr(s,(function(t,r,i){var o=Br(r)[1],s=Fr(e);return i===l.id?(t.push(s),n.push(Kn(t)),ms(s,o)?[s]:[s,o]):(t.push(o),t)}),[r]);return u.length>1&&n.push(Kn(u)),tr(n)}function gs(t,e){if(!e.features.length)throw new Error("lines must contain features");if(1===e.features.length)return e.features[0];var n,r=1/0;return xr(e,(function(e){var i=xo(e,t).properties.dist;i<r&&(n=e,r=i)})),n}function ms(t,e){return t[0]===e[0]&&t[1]===e[1]}const As=function(t,e){if(!t)throw new Error("line is required");if(!e)throw new Error("splitter is required");var n=Zr(t),r=Zr(e);if("LineString"!==n)throw new Error("line must be LineString");if("FeatureCollection"===r)throw new Error("splitter cannot be a FeatureCollection");if("GeometryCollection"===r)throw new Error("splitter cannot be a GeometryCollection");var i=Ho(e,{precision:7});switch(r){case"Point":return ds(t,i);case"MultiPoint":return fs(t,i);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return fs(t,bo(t,i))}};function ys(t,e,n,r,i){void 0===i&&(i={});var o=i.steps||64,s=_s(n),a=_s(r),l=Array.isArray(t)||"Feature"!==t.type?{}:t.properties;if(s===a)return Kn(oo(t,e,i).geometry.coordinates[0],l);for(var u=s,c=s<a?a:a+360,h=u,p=[],f=0;h<c;)p.push(io(t,e,h,i).geometry.coordinates),h=u+360*++f/o;return h>c&&p.push(io(t,e,c,i).geometry.coordinates),Kn(p,l)}function _s(t){var e=t%360;return e<0&&(e+=360),e}function vs(t,e){void 0===e&&(e={});var n=Gr(t);switch(e.properties||"Feature"!==t.type||(e.properties=t.properties),n.type){case"Polygon":return bs(n,e);case"MultiPolygon":return function(t,e){void 0===e&&(e={});var n=Gr(t).coordinates,r=e.properties?e.properties:"Feature"===t.type?t.properties:{},i=[];return n.forEach((function(t){i.push(xs(t,r))})),tr(i)}(n,e);default:throw new Error("invalid poly")}}function bs(t,e){return void 0===e&&(e={}),xs(Gr(t).coordinates,e.properties?e.properties:"Feature"===t.type?t.properties:{})}function xs(t,e){return t.length>1?er(t,e):Kn(t[0],e)}function ws(t,e,n,r){e=e||("Feature"===t.type?t.properties:{});var i=Gr(t),o=i.coordinates,s=i.type;if(!o.length)throw new Error("line must contain coordinates");switch(s){case"LineString":return n&&(o=Es(o)),Yn([o],e);case"MultiLineString":var a=[],l=0;return o.forEach((function(t){if(n&&(t=Es(t)),r){var e=function(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.abs(e-r)*Math.abs(n-i)}(Nr(Kn(t)));e>l?(a.unshift(t),l=e):a.push(t)}else a.push(t)})),Yn(a,e);default:throw new Error("geometry type "+s+" is not supported")}}function Es(t){var e=t[0],n=e[0],r=e[1],i=t[t.length-1],o=i[0],s=i[1];return n===o&&r===s||t.push(e),t}const Ss=function(t,e){var n,r,i;void 0===e&&(e={});var o=e.properties,s=null===(n=e.autoComplete)||void 0===n||n,a=null===(r=e.orderCoords)||void 0===r||r;if(null!==(i=e.mutate)&&void 0!==i&&i||(t=di(t)),"FeatureCollection"===t.type){var l=[];return t.features.forEach((function(t){l.push(Br(ws(t,{},s,a)))})),rr(l,o)}return ws(t,o,s,a)};function Ts(t,e){var n,r,i,o,s,a,l;for(r=1;r<=8;r*=2){for(n=[],o=!(Ms(i=t[t.length-1],e)&r),s=0;s<t.length;s++)(l=!(Ms(a=t[s],e)&r))!==o&&n.push(Ps(i,a,r,e)),l&&n.push(a),i=a,o=l;if(!(t=n).length)break}return n}function Ps(t,e,n,r){return 8&n?[t[0]+(e[0]-t[0])*(r[3]-t[1])/(e[1]-t[1]),r[3]]:4&n?[t[0]+(e[0]-t[0])*(r[1]-t[1])/(e[1]-t[1]),r[1]]:2&n?[r[2],t[1]+(e[1]-t[1])*(r[2]-t[0])/(e[0]-t[0])]:1&n?[r[0],t[1]+(e[1]-t[1])*(r[0]-t[0])/(e[0]-t[0])]:null}function Ms(t,e){var n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function Cs(t,e){var n=Gr(t),r=n.type,i="Feature"===t.type?t.properties:{},o=n.coordinates;switch(r){case"LineString":case"MultiLineString":var s=[];return"LineString"===r&&(o=[o]),o.forEach((function(t){!function(t,e,n){var r,i,o,s,a,l=t.length,u=Ms(t[0],e),c=[];for(n||(n=[]),r=1;r<l;r++){for(s=t[r-1],i=o=Ms(a=t[r],e);;){if(!(u|i)){c.push(s),i!==o?(c.push(a),r<l-1&&(n.push(c),c=[])):r===l-1&&c.push(a);break}if(u&i)break;u?u=Ms(s=Ps(s,a,u,e),e):i=Ms(a=Ps(s,a,i,e),e)}u=o}c.length&&n.push(c)}(t,e,s)})),1===s.length?Kn(s[0],i):er(s,i);case"Polygon":return Yn(Is(o,e),i);case"MultiPolygon":return rr(o.map((function(t){return Is(t,e)})),i);default:throw new Error("geometry "+r+" not supported")}}function Is(t,e){for(var n=[],r=0,i=t;r<i.length;r++){var o=Ts(i[r],e);o.length>0&&(o[0][0]===o[o.length-1][0]&&o[0][1]===o[o.length-1][1]||o.push(o[0]),o.length>=4&&n.push(o))}return n}var Os=n(251);function Rs(t,e){var n=Br(e),r=Br(t),i=r[0],o=r[r.length-1],s=t.geometry.coordinates;return Os(n[0],i)?s.unshift(n[1]):Os(n[0],o)?s.push(n[1]):Os(n[1],i)?s.unshift(n[0]):Os(n[1],o)&&s.push(n[0]),t}const Ls=function(t,e,n){if(void 0===n&&(n={}),!gr(n=n||{}))throw new Error("options is invalid");var r,i=n.tolerance||0,o=[],s=_o(),a=yo(t);return s.load(a),Cr(e,(function(t){var e=!1;t&&(xr(s.search(t),(function(n){if(!1===e){var o=Br(t).sort(),s=Br(n).sort();Os(o,s)||(0===i?Vo(o[0],n)&&Vo(o[1],n):xo(n,o[0]).properties.dist<=i&&xo(n,o[1]).properties.dist<=i)?(e=!0,r=r?Rs(r,t):t):(0===i?Vo(s[0],t)&&Vo(s[1],t):xo(t,s[0]).properties.dist<=i&&xo(t,s[1]).properties.dist<=i)&&(r=r?Rs(r,n):n)}})),!1===e&&r&&(o.push(r),r=void 0))})),r&&o.push(r),tr(o)};function ks(t){var e=t%360;return e<0&&(e+=360),e}const Ds=function(t,e,n,r,i){if(!gr(i=i||{}))throw new Error("options is invalid");var o=i.properties;if(!t)throw new Error("center is required");if(null==n)throw new Error("bearing1 is required");if(null==r)throw new Error("bearing2 is required");if(!e)throw new Error("radius is required");if("object"!=typeof i)throw new Error("options must be an object");if(ks(n)===ks(r))return oo(t,e,i);var s=Br(t),a=ys(t,e,n,r,i),l=[[s]];return yr(a,(function(t){l[0].push(t)})),l[0].push(s),Yn(l,o)};function Ns(t,e){var n=hr(t[1]),r=hr(e[1]),i=hr(e[0]-t[0]);i>Math.PI&&(i-=2*Math.PI),i<-Math.PI&&(i+=2*Math.PI);var o=Math.log(Math.tan(r/2+Math.PI/4)/Math.tan(n/2+Math.PI/4));return(cr(Math.atan2(i,o))+360)%360}const Fs=function(t,e,n){var r;return void 0===n&&(n={}),(r=n.final?Ns(Fr(e),Fr(t)):Ns(Fr(t),Fr(e)))>180?-(360-r):r},Bs=function(t,e,n,r){void 0===r&&(r={});var i=e<0,o=pr(Math.abs(e),r.units,"meters");i&&(o=-Math.abs(o));var s=Fr(t),a=function(t,e,n,r){var i=e/(r=void 0===r?Vn:Number(r)),o=t[0]*Math.PI/180,s=hr(t[1]),a=hr(n),l=i*Math.cos(a),u=s+l;Math.abs(u)>Math.PI/2&&(u=u>0?Math.PI-u:-Math.PI-u);var c=Math.log(Math.tan(u/2+Math.PI/4)/Math.tan(s/2+Math.PI/4)),h=Math.abs(c)>1e-11?l/c:Math.cos(s);return[(180*(o+i*Math.sin(a)/h)/Math.PI+540)%360-180,180*u/Math.PI]}(s,o,n);return a[0]+=a[0]-s[0]>180?-360:s[0]-a[0]>180?360:0,Xn(a,r.properties)};function zs(t,e,n,r,i,o){for(var s=0;s<t.length;s++){var a=t[s],l=t[s+1];s===t.length-1&&(l=t[0]),r=js(a,l,e),n<=0&&r>0?js(e,a,i)<0||(i=a):n>0&&r<=0&&(js(e,a,o)>0||(o=a)),n=r}return[i,o]}function js(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(n[0]-t[0])*(e[1]-t[1])}const Us=function(t,e){var n,r,i,o,s=Br(t),a=Br(e),l=Nr(e),u=0,c=null;switch(s[0]>l[0]&&s[0]<l[2]&&s[1]>l[1]&&s[1]<l[3]&&(u=(c=Ao(t,po(e))).properties.featureIndex),Zr(e)){case"Polygon":n=a[0][u],r=a[0][0],null!==c&&c.geometry.coordinates[1]<s[1]&&(r=a[0][u]),o=js(a[0][0],a[0][a[0].length-1],s);var h=zs(a[0],s,o,i,n,r);n=h[0],r=h[1];break;case"MultiPolygon":for(var p=0,f=0,d=0,g=0;g<a[0].length;g++){p=g;for(var m=!1,A=0;A<a[0][g].length;A++){if(f=A,d===u){m=!0;break}d++}if(m)break}n=a[0][p][f],r=a[0][p][f],o=js(a[0][0][0],a[0][0][a[0][0].length-1],s),a.forEach((function(t){var e=zs(t[0],s,o,i,n,r);n=e[0],r=e[1]}))}return tr([Xn(n),Xn(r)])};function Vs(t){for(var e,n,r=Br(t),i=0,o=1;o<r.length;)e=n||r[0],i+=((n=r[o])[0]-e[0])*(n[1]+e[1]),o++;return i>0}function Gs(t,e){switch("Feature"===t.type?t.geometry.type:t.type){case"GeometryCollection":return Sr(t,(function(t){Gs(t,e)})),t;case"LineString":return Zs(Br(t),e),t;case"Polygon":return qs(Br(t),e),t;case"MultiLineString":return Br(t).forEach((function(t){Zs(t,e)})),t;case"MultiPolygon":return Br(t).forEach((function(t){qs(t,e)})),t;case"Point":case"MultiPoint":return t}}function Zs(t,e){Vs(t)===e&&t.reverse()}function qs(t,e){Vs(t[0])!==e&&t[0].reverse();for(var n=1;n<t.length;n++)Vs(t[n])===e&&t[n].reverse()}const Ws=function(t,e){if(!gr(e=e||{}))throw new Error("options is invalid");var n=e.reverse||!1,r=e.mutate||!1;if(!t)throw new Error("<geojson> is required");if("boolean"!=typeof n)throw new Error("<reverse> must be a boolean");if("boolean"!=typeof r)throw new Error("<mutate> must be a boolean");!1===r&&(t=di(t));var i=[];switch(t.type){case"GeometryCollection":return Sr(t,(function(t){Gs(t,n)})),t;case"FeatureCollection":return xr(t,(function(t){xr(Gs(t,n),(function(t){i.push(t)}))})),tr(i)}return Gs(t,n)};var Hs={successCallback:null,verbose:!1,polygons:!1},Xs={};function $s(t,e,n,r){r=r||{};for(var i=Object.keys(Hs),o=0;o<i.length;o++){var s=i[o],a=r[s];a=null!=a?a:Hs[s],Xs[s]=a}Xs.verbose&&console.log("MarchingSquaresJS-isoBands: computing isobands for ["+e+":"+(e+n)+"]");var l,u=function(t,e,n){for(var r=t.length-1,i=t[0].length-1,o={rows:r,cols:i,cells:[]},s=e+Math.abs(n),a=0;a<r;++a){o.cells[a]=[];for(var l=0;l<i;++l){var u=0,c=t[a+1][l],h=t[a+1][l+1],p=t[a][l+1],f=t[a][l];if(!(isNaN(c)||isNaN(h)||isNaN(p)||isNaN(f))){u|=c<e?0:c>s?128:64,u|=h<e?0:h>s?32:16,u|=p<e?0:p>s?8:4;var d=+(u|=f<e?0:f>s?2:1),g=0;if(17===u||18===u||33===u||34===u||38===u||68===u||72===u||98===u||102===u||132===u||136===u||137===u||152===u||153===u){var m=(c+h+p+f)/4;g=m>s?2:m<e?0:1,34===u?1===g?u=35:0===g&&(u=136):136===u?1===g?(u=35,g=4):0===g&&(u=34):17===u?1===g?(u=155,g=4):0===g&&(u=153):68===u?1===g?(u=103,g=4):0===g&&(u=102):153===u?1===g&&(u=155):102===u?1===g&&(u=103):152===u?g<2&&(u=156,g=1):137===u?g<2&&(u=139,g=1):98===u?g<2&&(u=99,g=1):38===u?g<2&&(u=39,g=1):18===u?g>0?(u=156,g=4):u=152:33===u?g>0?(u=139,g=4):u=137:72===u?g>0?(u=99,g=4):u=98:132===u&&(g>0?(u=39,g=4):u=38)}if(0!=u&&170!=u){var A,y,_,v,b,x,w,E;A=y=_=v=b=x=w=E=.5;var S=[];1===u?(_=1-za(e,p,f),E=1-za(e,c,f),S.push(La[u])):169===u?(_=za(s,f,p),E=za(s,f,c),S.push(La[u])):4===u?(x=1-za(e,h,p),v=za(e,f,p),S.push(Oa[u])):166===u?(x=za(s,p,h),v=1-za(s,p,f),S.push(Oa[u])):16===u?(b=za(e,p,h),y=za(e,c,h),S.push(Ia[u])):154===u?(b=1-za(s,h,p),y=1-za(s,h,c),S.push(Ia[u])):64===u?(w=za(e,f,c),A=1-za(e,h,c),S.push(Da[u])):106===u?(w=1-za(s,c,f),A=za(s,c,h),S.push(Da[u])):168===u?(v=za(s,f,p),_=za(e,f,p),E=za(e,f,c),w=za(s,f,c),S.push(Ra[u]),S.push(La[u])):2===u?(v=1-za(e,p,f),_=1-za(s,p,f),E=1-za(s,c,f),w=1-za(e,c,f),S.push(Ra[u]),S.push(La[u])):162===u?(b=za(s,p,h),x=za(e,p,h),v=1-za(e,p,f),_=1-za(s,p,f),S.push(Ra[u]),S.push(La[u])):8===u?(b=1-za(e,h,p),x=1-za(s,h,p),v=za(s,f,p),_=za(e,f,p),S.push(Ia[u]),S.push(Oa[u])):138===u?(b=1-za(e,h,p),x=1-za(s,h,p),A=1-za(s,h,c),y=1-za(e,h,c),S.push(Ia[u]),S.push(Oa[u])):32===u?(b=za(s,p,h),x=za(e,p,h),A=za(e,c,h),y=za(s,c,h),S.push(Ia[u]),S.push(Oa[u])):42===u?(E=1-za(s,c,f),w=1-za(e,c,f),A=za(e,c,h),y=za(s,c,h),S.push(ka[u]),S.push(Da[u])):128===u&&(E=za(e,f,c),w=za(s,f,c),A=1-za(s,h,c),y=1-za(e,h,c),S.push(ka[u]),S.push(Da[u])),5===u?(x=1-za(e,h,p),E=1-za(e,c,f),S.push(Oa[u])):165===u?(x=za(s,p,h),E=za(s,f,c),S.push(Oa[u])):20===u?(v=za(e,f,p),y=za(e,c,h),S.push(Ra[u])):150===u?(v=1-za(s,p,f),y=1-za(s,h,c),S.push(Ra[u])):80===u?(b=za(e,p,h),w=za(e,f,c),S.push(Ia[u])):90===u?(b=1-za(s,h,p),w=1-za(s,c,f),S.push(Ia[u])):65===u?(_=1-za(e,p,f),A=1-za(e,h,c),S.push(La[u])):105===u?(_=za(s,f,p),A=za(s,c,h),S.push(La[u])):160===u?(b=za(s,p,h),x=za(e,p,h),E=za(e,f,c),w=za(s,f,c),S.push(Ia[u]),S.push(Oa[u])):10===u?(b=1-za(e,h,p),x=1-za(s,h,p),E=1-za(s,c,f),w=1-za(e,c,f),S.push(Ia[u]),S.push(Oa[u])):130===u?(v=1-za(e,p,f),_=1-za(s,p,f),A=1-za(s,h,c),y=1-za(e,h,c),S.push(Ra[u]),S.push(La[u])):40===u?(v=za(s,f,p),_=za(e,f,p),A=za(e,c,h),y=za(s,c,h),S.push(Ra[u]),S.push(La[u])):101===u?(x=za(s,p,h),A=za(s,c,h),S.push(Oa[u])):69===u?(x=1-za(e,h,p),A=1-za(e,h,c),S.push(Oa[u])):149===u?(E=za(s,f,c),y=1-za(s,h,c),S.push(ka[u])):21===u?(E=1-za(e,c,f),y=za(e,c,h),S.push(ka[u])):86===u?(v=1-za(s,p,f),w=1-za(s,c,f),S.push(Ra[u])):84===u?(v=za(e,f,p),w=za(e,f,c),S.push(Ra[u])):89===u?(b=1-za(s,h,p),_=za(s,f,p),S.push(La[u])):81===u?(b=za(e,p,h),_=1-za(e,p,f),S.push(La[u])):96===u?(b=za(s,p,h),x=za(e,p,h),w=za(e,f,c),A=za(s,c,h),S.push(Ia[u]),S.push(Oa[u])):74===u?(b=1-za(e,h,p),x=1-za(s,h,p),w=1-za(s,c,f),A=1-za(e,h,c),S.push(Ia[u]),S.push(Oa[u])):24===u?(b=1-za(s,h,p),v=za(s,f,p),_=za(e,f,p),y=za(e,c,h),S.push(Ia[u]),S.push(La[u])):146===u?(b=za(e,p,h),v=1-za(e,p,f),_=1-za(s,p,f),y=1-za(s,h,c),S.push(Ia[u]),S.push(La[u])):6===u?(x=1-za(e,h,p),v=1-za(s,p,f),E=1-za(s,c,f),w=1-za(e,c,f),S.push(Oa[u]),S.push(Ra[u])):164===u?(x=za(s,p,h),v=za(e,f,p),E=za(e,f,c),w=za(s,f,c),S.push(Oa[u]),S.push(Ra[u])):129===u?(_=1-za(e,p,f),E=za(s,f,c),A=1-za(s,h,c),y=1-za(e,h,c),S.push(La[u]),S.push(ka[u])):41===u?(_=za(s,f,p),E=1-za(e,c,f),A=za(e,c,h),y=za(s,c,h),S.push(La[u]),S.push(ka[u])):66===u?(v=1-za(e,p,f),_=1-za(s,p,f),w=1-za(s,c,f),A=1-za(e,h,c),S.push(Ra[u]),S.push(La[u])):104===u?(v=za(s,f,p),_=za(e,f,p),w=za(e,f,c),A=za(s,c,h),S.push(La[u]),S.push(Na[u])):144===u?(b=za(e,p,h),E=za(e,f,c),w=za(s,f,c),y=1-za(s,h,c),S.push(Ia[u]),S.push(Da[u])):26===u?(b=1-za(s,h,p),E=1-za(s,c,f),w=1-za(e,c,f),y=za(e,c,h),S.push(Ia[u]),S.push(Da[u])):36===u?(x=za(s,p,h),v=za(e,f,p),A=za(e,c,h),y=za(s,c,h),S.push(Oa[u]),S.push(Ra[u])):134===u?(x=1-za(e,h,p),v=1-za(s,p,f),A=1-za(s,h,c),y=1-za(e,h,c),S.push(Oa[u]),S.push(Ra[u])):9===u?(b=1-za(e,h,p),x=1-za(s,h,p),_=za(s,f,p),E=1-za(e,c,f),S.push(Ia[u]),S.push(Oa[u])):161===u?(b=za(s,p,h),x=za(e,p,h),_=1-za(e,p,f),E=za(s,f,c),S.push(Ia[u]),S.push(Oa[u])):37===u?(x=za(s,p,h),E=1-za(e,c,f),A=za(e,c,h),y=za(s,c,h),S.push(Oa[u]),S.push(ka[u])):133===u?(x=1-za(e,h,p),E=za(s,f,c),A=1-za(s,h,c),y=1-za(e,h,c),S.push(Oa[u]),S.push(ka[u])):148===u?(v=za(e,f,p),E=za(e,f,c),w=za(s,f,c),y=1-za(s,h,c),S.push(Ra[u]),S.push(Da[u])):22===u?(v=1-za(s,p,f),E=1-za(s,c,f),w=1-za(e,c,f),y=za(e,c,h),S.push(Ra[u]),S.push(Da[u])):82===u?(b=za(e,p,h),v=1-za(e,p,f),_=1-za(s,p,f),w=1-za(s,c,f),S.push(Ia[u]),S.push(La[u])):88===u?(b=1-za(s,h,p),v=za(s,f,p),_=za(e,f,p),w=za(e,f,c),S.push(Ia[u]),S.push(La[u])):73===u?(b=1-za(e,h,p),x=1-za(s,h,p),_=za(s,f,p),A=1-za(e,h,c),S.push(Ia[u]),S.push(Oa[u])):97===u?(b=za(s,p,h),x=za(e,p,h),_=1-za(e,p,f),A=za(s,c,h),S.push(Ia[u]),S.push(Oa[u])):145===u?(b=za(e,p,h),_=1-za(e,p,f),E=za(s,f,c),y=1-za(s,h,c),S.push(Ia[u]),S.push(ka[u])):25===u?(b=1-za(s,h,p),_=za(s,f,p),E=1-za(e,c,f),y=za(e,c,h),S.push(Ia[u]),S.push(ka[u])):70===u?(x=1-za(e,h,p),v=1-za(s,p,f),w=1-za(s,c,f),A=1-za(e,h,c),S.push(Oa[u]),S.push(Ra[u])):100===u?(x=za(s,p,h),v=za(e,f,p),w=za(e,f,c),A=za(s,c,h),S.push(Oa[u]),S.push(Ra[u])):34===u?(0===g?(b=1-za(e,h,p),x=1-za(s,h,p),v=za(s,f,p),_=za(e,f,p),E=za(e,f,c),w=za(s,f,c),A=1-za(s,h,c),y=1-za(e,h,c)):(b=za(s,p,h),x=za(e,p,h),v=1-za(e,p,f),_=1-za(s,p,f),E=1-za(s,c,f),w=1-za(e,c,f),A=za(e,c,h),y=za(s,c,h)),S.push(Ia[u]),S.push(Oa[u]),S.push(ka[u]),S.push(Da[u])):35===u?(4===g?(b=1-za(e,h,p),x=1-za(s,h,p),v=za(s,f,p),_=za(e,f,p),E=za(e,f,c),w=za(s,f,c),A=1-za(s,h,c),y=1-za(e,h,c)):(b=za(s,p,h),x=za(e,p,h),v=1-za(e,p,f),_=1-za(s,p,f),E=1-za(s,c,f),w=1-za(e,c,f),A=za(e,c,h),y=za(s,c,h)),S.push(Ia[u]),S.push(Oa[u]),S.push(La[u]),S.push(Da[u])):136===u?(0===g?(b=za(s,p,h),x=za(e,p,h),v=1-za(e,p,f),_=1-za(s,p,f),E=1-za(s,c,f),w=1-za(e,c,f),A=za(e,c,h),y=za(s,c,h)):(b=1-za(e,h,p),x=1-za(s,h,p),v=za(s,f,p),_=za(e,f,p),E=za(e,f,c),w=za(s,f,c),A=1-za(s,h,c),y=1-za(e,h,c)),S.push(Ia[u]),S.push(Oa[u]),S.push(ka[u]),S.push(Da[u])):153===u?(0===g?(b=za(e,p,h),_=1-za(e,p,f),E=1-za(e,c,f),y=za(e,c,h)):(b=1-za(s,h,p),_=za(s,f,p),E=za(s,f,c),y=1-za(s,h,c)),S.push(Ia[u]),S.push(La[u])):102===u?(0===g?(x=1-za(e,h,p),v=za(e,f,p),w=za(e,f,c),A=1-za(e,h,c)):(x=za(s,p,h),v=1-za(s,p,f),w=1-za(s,c,f),A=za(s,c,h)),S.push(Oa[u]),S.push(Da[u])):155===u?(4===g?(b=za(e,p,h),_=1-za(e,p,f),E=1-za(e,c,f),y=za(e,c,h)):(b=1-za(s,h,p),_=za(s,f,p),E=za(s,f,c),y=1-za(s,h,c)),S.push(Ia[u]),S.push(ka[u])):103===u?(4===g?(x=1-za(e,h,p),v=za(e,f,p),w=za(e,f,c),A=1-za(e,h,c)):(x=za(s,p,h),v=1-za(s,p,f),w=1-za(s,c,f),A=za(s,c,h)),S.push(Oa[u]),S.push(Ra[u])):152===u?(0===g?(b=za(e,p,h),v=1-za(e,p,f),_=1-za(s,p,f),E=1-za(s,c,f),w=1-za(e,c,f),y=za(e,c,h)):(b=1-za(s,h,p),v=za(s,f,p),_=za(e,f,p),E=za(e,f,c),w=za(s,f,c),y=1-za(s,h,c)),S.push(Ia[u]),S.push(Ra[u]),S.push(La[u])):156===u?(4===g?(b=za(e,p,h),v=1-za(e,p,f),_=1-za(s,p,f),E=1-za(s,c,f),w=1-za(e,c,f),y=za(e,c,h)):(b=1-za(s,h,p),v=za(s,f,p),_=za(e,f,p),E=za(e,f,c),w=za(s,f,c),y=1-za(s,h,c)),S.push(Ia[u]),S.push(La[u]),S.push(Da[u])):137===u?(0===g?(b=za(s,p,h),x=za(e,p,h),_=1-za(e,p,f),E=1-za(e,c,f),A=za(e,c,h),y=za(s,c,h)):(b=1-za(e,h,p),x=1-za(s,h,p),_=za(s,f,p),E=za(s,f,c),A=1-za(s,h,c),y=1-za(e,h,c)),S.push(Ia[u]),S.push(Oa[u]),S.push(La[u])):139===u?(4===g?(b=za(s,p,h),x=za(e,p,h),_=1-za(e,p,f),E=1-za(e,c,f),A=za(e,c,h),y=za(s,c,h)):(b=1-za(e,h,p),x=1-za(s,h,p),_=za(s,f,p),E=za(s,f,c),A=1-za(s,h,c),y=1-za(e,h,c)),S.push(Ia[u]),S.push(Oa[u]),S.push(ka[u])):98===u?(0===g?(b=1-za(e,h,p),x=1-za(s,h,p),v=za(s,f,p),_=za(e,f,p),w=za(e,f,c),A=1-za(e,h,c)):(b=za(s,p,h),x=za(e,p,h),v=1-za(e,p,f),_=1-za(s,p,f),w=1-za(s,c,f),A=za(s,c,h)),S.push(Ia[u]),S.push(Oa[u]),S.push(Da[u])):99===u?(4===g?(b=1-za(e,h,p),x=1-za(s,h,p),v=za(s,f,p),_=za(e,f,p),w=za(e,f,c),A=1-za(e,h,c)):(b=za(s,p,h),x=za(e,p,h),v=1-za(e,p,f),_=1-za(s,p,f),w=1-za(s,c,f),A=za(s,c,h)),S.push(Ia[u]),S.push(Oa[u]),S.push(La[u])):38===u?(0===g?(x=1-za(e,h,p),v=za(e,f,p),E=za(e,f,c),w=za(s,f,c),A=1-za(s,h,c),y=1-za(e,h,c)):(x=za(s,p,h),v=1-za(s,p,f),E=1-za(s,c,f),w=1-za(e,c,f),A=za(e,c,h),y=za(s,c,h)),S.push(Oa[u]),S.push(ka[u]),S.push(Da[u])):39===u?(4===g?(x=1-za(e,h,p),v=za(e,f,p),E=za(e,f,c),w=za(s,f,c),A=1-za(s,h,c),y=1-za(e,h,c)):(x=za(s,p,h),v=1-za(s,p,f),E=1-za(s,c,f),w=1-za(e,c,f),A=za(e,c,h),y=za(s,c,h)),S.push(Oa[u]),S.push(Ra[u]),S.push(Da[u])):85===u&&(b=1,x=0,v=1,_=0,E=0,w=1,A=0,y=1),(A<0||A>1||y<0||y>1||b<0||b>1||v<0||v>1||E<0||E>1||w<0||w>1)&&console.log("MarchingSquaresJS-isoBands: "+u+" "+d+" "+c+","+h+","+p+","+f+" "+g+" "+A+" "+y+" "+b+" "+x+" "+v+" "+_+" "+E+" "+w),o.cells[a][l]={cval:u,cval_real:d,flipped:g,topleft:A,topright:y,righttop:b,rightbottom:x,bottomright:v,bottomleft:_,leftbottom:E,lefttop:w,edges:S}}}}}return o}(t,e,n);return Xs.polygons?(Xs.verbose&&console.log("MarchingSquaresJS-isoBands: returning single polygons for each grid cell"),l=function(t){var e=[],n=0;return t.cells.forEach((function(t,r){t.forEach((function(t,i){if(void 0!==t){var o=Ba[t.cval](t);"object"==typeof o&&ja(o)?"object"==typeof o[0]&&ja(o[0])?"object"==typeof o[0][0]&&ja(o[0][0])?o.forEach((function(t){t.forEach((function(t){t[0]+=i,t[1]+=r})),e[n++]=t})):(o.forEach((function(t){t[0]+=i,t[1]+=r})),e[n++]=o):console.log("MarchingSquaresJS-isoBands: bandcell polygon with malformed coordinates"):console.log("MarchingSquaresJS-isoBands: bandcell polygon with null coordinates")}}))})),e}(u)):(Xs.verbose&&console.log("MarchingSquaresJS-isoBands: returning polygon paths for entire data grid"),l=function(t){for(var e=[],n=t.rows,r=t.cols,i=[],o=0;o<n;o++)for(var s=0;s<r;s++)if(void 0!==t.cells[o][s]&&t.cells[o][s].edges.length>0){var a=Va(t.cells[o][s]),l=null,u=s,c=o;null!==a&&i.push([a.p[0]+u,a.p[1]+c]);do{if(null===(l=Ga(t.cells[c][u],a.x,a.y,a.o)))break;if(i.push([l.p[0]+u,l.p[1]+c]),u+=l.x,a=l,(c+=l.y)<0||c>=n||u<0||u>=r||void 0===t.cells[c][u]){var h=Ua(t,u-=l.x,c-=l.y,l.x,l.y,l.o);if(null===h)break;h.path.forEach((function(t){i.push(t)})),u=h.i,c=h.j,a=h}}while(void 0!==t.cells[c][u]&&t.cells[c][u].edges.length>0);e.push(i),i=[],t.cells[o][s].edges.length>0&&s--}return e}(u)),"function"==typeof Xs.successCallback&&Xs.successCallback(l),l}var Ys=64,Qs=16,Ks=[],Js=[],ta=[],ea=[],na=[],ra=[],ia=[],oa=[],sa=[],aa=[],la=[],ua=[],ca=[],ha=[],pa=[],fa=[],da=[],ga=[],ma=[],Aa=[],ya=[],_a=[],va=[],ba=[];ia[85]=aa[85]=-1,oa[85]=la[85]=0,sa[85]=ua[85]=1,ma[85]=_a[85]=1,Aa[85]=va[85]=0,ya[85]=ba[85]=1,Ks[85]=ea[85]=0,Js[85]=na[85]=-1,ta[85]=pa[85]=0,fa[85]=ca[85]=0,da[85]=ha[85]=1,ra[85]=ga[85]=1,_a[1]=_a[169]=0,va[1]=va[169]=-1,ba[1]=ba[169]=0,ca[1]=ca[169]=-1,ha[1]=ha[169]=0,pa[1]=pa[169]=0,aa[4]=aa[166]=0,la[4]=la[166]=-1,ua[4]=ua[166]=1,fa[4]=fa[166]=1,da[4]=da[166]=0,ga[4]=ga[166]=0,ia[16]=ia[154]=0,oa[16]=oa[154]=1,sa[16]=sa[154]=1,ea[16]=ea[154]=1,na[16]=na[154]=0,ra[16]=ra[154]=1,ma[64]=ma[106]=0,Aa[64]=Aa[106]=1,ya[64]=ya[106]=0,Ks[64]=Ks[106]=-1,Js[64]=Js[106]=0,ta[64]=ta[106]=1,ma[2]=ma[168]=0,Aa[2]=Aa[168]=-1,ya[2]=ya[168]=1,_a[2]=_a[168]=0,va[2]=va[168]=-1,ba[2]=ba[168]=0,ca[2]=ca[168]=-1,ha[2]=ha[168]=0,pa[2]=pa[168]=0,fa[2]=fa[168]=-1,da[2]=da[168]=0,ga[2]=ga[168]=1,ia[8]=ia[162]=0,oa[8]=oa[162]=-1,sa[8]=sa[162]=0,aa[8]=aa[162]=0,la[8]=la[162]=-1,ua[8]=ua[162]=1,ca[8]=ca[162]=1,ha[8]=ha[162]=0,pa[8]=pa[162]=1,fa[8]=fa[162]=1,da[8]=da[162]=0,ga[8]=ga[162]=0,ia[32]=ia[138]=0,oa[32]=oa[138]=1,sa[32]=sa[138]=1,aa[32]=aa[138]=0,la[32]=la[138]=1,ua[32]=ua[138]=0,Ks[32]=Ks[138]=1,Js[32]=Js[138]=0,ta[32]=ta[138]=0,ea[32]=ea[138]=1,na[32]=na[138]=0,ra[32]=ra[138]=1,_a[128]=_a[42]=0,va[128]=va[42]=1,ba[128]=ba[42]=1,ma[128]=ma[42]=0,Aa[128]=Aa[42]=1,ya[128]=ya[42]=0,Ks[128]=Ks[42]=-1,Js[128]=Js[42]=0,ta[128]=ta[42]=1,ea[128]=ea[42]=-1,na[128]=na[42]=0,ra[128]=ra[42]=0,aa[5]=aa[165]=-1,la[5]=la[165]=0,ua[5]=ua[165]=0,_a[5]=_a[165]=1,va[5]=va[165]=0,ba[5]=ba[165]=0,fa[20]=fa[150]=0,da[20]=da[150]=1,ga[20]=ga[150]=1,ea[20]=ea[150]=0,na[20]=na[150]=-1,ra[20]=ra[150]=1,ia[80]=ia[90]=-1,oa[80]=oa[90]=0,sa[80]=sa[90]=1,ma[80]=ma[90]=1,Aa[80]=Aa[90]=0,ya[80]=ya[90]=1,ca[65]=ca[105]=0,ha[65]=ha[105]=1,pa[65]=pa[105]=0,Ks[65]=Ks[105]=0,Js[65]=Js[105]=-1,ta[65]=ta[105]=0,ia[160]=ia[10]=-1,oa[160]=oa[10]=0,sa[160]=sa[10]=1,aa[160]=aa[10]=-1,la[160]=la[10]=0,ua[160]=ua[10]=0,_a[160]=_a[10]=1,va[160]=va[10]=0,ba[160]=ba[10]=0,ma[160]=ma[10]=1,Aa[160]=Aa[10]=0,ya[160]=ya[10]=1,fa[130]=fa[40]=0,da[130]=da[40]=1,ga[130]=ga[40]=1,ca[130]=ca[40]=0,ha[130]=ha[40]=1,pa[130]=pa[40]=0,Ks[130]=Ks[40]=0,Js[130]=Js[40]=-1,ta[130]=ta[40]=0,ea[130]=ea[40]=0,na[130]=na[40]=-1,ra[130]=ra[40]=1,aa[37]=aa[133]=0,la[37]=la[133]=1,ua[37]=ua[133]=1,_a[37]=_a[133]=0,va[37]=va[133]=1,ba[37]=ba[133]=0,Ks[37]=Ks[133]=-1,Js[37]=Js[133]=0,ta[37]=ta[133]=0,ea[37]=ea[133]=1,na[37]=na[133]=0,ra[37]=ra[133]=0,fa[148]=fa[22]=-1,da[148]=da[22]=0,ga[148]=ga[22]=0,_a[148]=_a[22]=0,va[148]=va[22]=-1,ba[148]=ba[22]=1,ma[148]=ma[22]=0,Aa[148]=Aa[22]=1,ya[148]=ya[22]=1,ea[148]=ea[22]=-1,na[148]=na[22]=0,ra[148]=ra[22]=1,ia[82]=ia[88]=0,oa[82]=oa[88]=-1,sa[82]=sa[88]=1,fa[82]=fa[88]=1,da[82]=da[88]=0,ga[82]=ga[88]=1,ca[82]=ca[88]=-1,ha[82]=ha[88]=0,pa[82]=pa[88]=1,ma[82]=ma[88]=0,Aa[82]=Aa[88]=-1,ya[82]=ya[88]=0,ia[73]=ia[97]=0,oa[73]=oa[97]=1,sa[73]=sa[97]=0,aa[73]=aa[97]=0,la[73]=la[97]=-1,ua[73]=ua[97]=0,ca[73]=ca[97]=1,ha[73]=ha[97]=0,pa[73]=pa[97]=0,Ks[73]=Ks[97]=1,Js[73]=Js[97]=0,ta[73]=ta[97]=1,ia[145]=ia[25]=0,oa[145]=oa[25]=-1,sa[145]=sa[25]=0,ca[145]=ca[25]=1,ha[145]=ha[25]=0,pa[145]=pa[25]=1,_a[145]=_a[25]=0,va[145]=va[25]=1,ba[145]=ba[25]=1,ea[145]=ea[25]=-1,na[145]=na[25]=0,ra[145]=ra[25]=0,aa[70]=aa[100]=0,la[70]=la[100]=1,ua[70]=ua[100]=0,fa[70]=fa[100]=-1,da[70]=da[100]=0,ga[70]=ga[100]=1,ma[70]=ma[100]=0,Aa[70]=Aa[100]=-1,ya[70]=ya[100]=1,Ks[70]=Ks[100]=1,Js[70]=Js[100]=0,ta[70]=ta[100]=0,aa[101]=aa[69]=0,la[101]=la[69]=1,ua[101]=ua[69]=0,Ks[101]=Ks[69]=1,Js[101]=Js[69]=0,ta[101]=ta[69]=0,_a[149]=_a[21]=0,va[149]=va[21]=1,ba[149]=ba[21]=1,ea[149]=ea[21]=-1,na[149]=na[21]=0,ra[149]=ra[21]=0,fa[86]=fa[84]=-1,da[86]=da[84]=0,ga[86]=ga[84]=1,ma[86]=ma[84]=0,Aa[86]=Aa[84]=-1,ya[86]=ya[84]=1,ia[89]=ia[81]=0,oa[89]=oa[81]=-1,sa[89]=sa[81]=0,ca[89]=ca[81]=1,ha[89]=ha[81]=0,pa[89]=pa[81]=1,ia[96]=ia[74]=0,oa[96]=oa[74]=1,sa[96]=sa[74]=0,aa[96]=aa[74]=-1,la[96]=la[74]=0,ua[96]=ua[74]=1,ma[96]=ma[74]=1,Aa[96]=Aa[74]=0,ya[96]=ya[74]=0,Ks[96]=Ks[74]=1,Js[96]=Js[74]=0,ta[96]=ta[74]=1,ia[24]=ia[146]=0,oa[24]=oa[146]=-1,sa[24]=sa[146]=1,fa[24]=fa[146]=1,da[24]=da[146]=0,ga[24]=ga[146]=1,ca[24]=ca[146]=0,ha[24]=ha[146]=1,pa[24]=pa[146]=1,ea[24]=ea[146]=0,na[24]=na[146]=-1,ra[24]=ra[146]=0,aa[6]=aa[164]=-1,la[6]=la[164]=0,ua[6]=ua[164]=1,fa[6]=fa[164]=-1,da[6]=da[164]=0,ga[6]=ga[164]=0,_a[6]=_a[164]=0,va[6]=va[164]=-1,ba[6]=ba[164]=1,ma[6]=ma[164]=1,Aa[6]=Aa[164]=0,ya[6]=ya[164]=0,ca[129]=ca[41]=0,ha[129]=ha[41]=1,pa[129]=pa[41]=1,_a[129]=_a[41]=0,va[129]=va[41]=1,ba[129]=ba[41]=0,Ks[129]=Ks[41]=-1,Js[129]=Js[41]=0,ta[129]=ta[41]=0,ea[129]=ea[41]=0,na[129]=na[41]=-1,ra[129]=ra[41]=0,fa[66]=fa[104]=0,da[66]=da[104]=1,ga[66]=ga[104]=0,ca[66]=ca[104]=-1,ha[66]=ha[104]=0,pa[66]=pa[104]=1,ma[66]=ma[104]=0,Aa[66]=Aa[104]=-1,ya[66]=ya[104]=0,Ks[66]=Ks[104]=0,Js[66]=Js[104]=-1,ta[66]=ta[104]=1,ia[144]=ia[26]=-1,oa[144]=oa[26]=0,sa[144]=sa[26]=0,_a[144]=_a[26]=1,va[144]=va[26]=0,ba[144]=ba[26]=1,ma[144]=ma[26]=0,Aa[144]=Aa[26]=1,ya[144]=ya[26]=1,ea[144]=ea[26]=-1,na[144]=na[26]=0,ra[144]=ra[26]=1,aa[36]=aa[134]=0,la[36]=la[134]=1,ua[36]=ua[134]=1,fa[36]=fa[134]=0,da[36]=da[134]=1,ga[36]=ga[134]=0,Ks[36]=Ks[134]=0,Js[36]=Js[134]=-1,ta[36]=ta[134]=1,ea[36]=ea[134]=1,na[36]=na[134]=0,ra[36]=ra[134]=0,ia[9]=ia[161]=-1,oa[9]=oa[161]=0,sa[9]=sa[161]=0,aa[9]=aa[161]=0,la[9]=la[161]=-1,ua[9]=ua[161]=0,ca[9]=ca[161]=1,ha[9]=ha[161]=0,pa[9]=pa[161]=0,_a[9]=_a[161]=1,va[9]=va[161]=0,ba[9]=ba[161]=1,ia[136]=0,oa[136]=1,sa[136]=1,aa[136]=0,la[136]=1,ua[136]=0,fa[136]=-1,da[136]=0,ga[136]=1,ca[136]=-1,ha[136]=0,pa[136]=0,_a[136]=0,va[136]=-1,ba[136]=0,ma[136]=0,Aa[136]=-1,ya[136]=1,Ks[136]=1,Js[136]=0,ta[136]=0,ea[136]=1,na[136]=0,ra[136]=1,ia[34]=0,oa[34]=-1,sa[34]=0,aa[34]=0,la[34]=-1,ua[34]=1,fa[34]=1,da[34]=0,ga[34]=0,ca[34]=1,ha[34]=0,pa[34]=1,_a[34]=0,va[34]=1,ba[34]=1,ma[34]=0,Aa[34]=1,ya[34]=0,Ks[34]=-1,Js[34]=0,ta[34]=1,ea[34]=-1,na[34]=0,ra[34]=0,ia[35]=0,oa[35]=1,sa[35]=1,aa[35]=0,la[35]=-1,ua[35]=1,fa[35]=1,da[35]=0,ga[35]=0,ca[35]=-1,ha[35]=0,pa[35]=0,_a[35]=0,va[35]=-1,ba[35]=0,ma[35]=0,Aa[35]=1,ya[35]=0,Ks[35]=-1,Js[35]=0,ta[35]=1,ea[35]=1,na[35]=0,ra[35]=1,ia[153]=0,oa[153]=1,sa[153]=1,ca[153]=-1,ha[153]=0,pa[153]=0,_a[153]=0,va[153]=-1,ba[153]=0,ea[153]=1,na[153]=0,ra[153]=1,aa[102]=0,la[102]=-1,ua[102]=1,fa[102]=1,da[102]=0,ga[102]=0,ma[102]=0,Aa[102]=1,ya[102]=0,Ks[102]=-1,Js[102]=0,ta[102]=1,ia[155]=0,oa[155]=-1,sa[155]=0,ca[155]=1,ha[155]=0,pa[155]=1,_a[155]=0,va[155]=1,ba[155]=1,ea[155]=-1,na[155]=0,ra[155]=0,aa[103]=0,la[103]=1,ua[103]=0,fa[103]=-1,da[103]=0,ga[103]=1,ma[103]=0,Aa[103]=-1,ya[103]=1,Ks[103]=1,Js[103]=0,ta[103]=0,ia[152]=0,oa[152]=1,sa[152]=1,fa[152]=-1,da[152]=0,ga[152]=1,ca[152]=-1,ha[152]=0,pa[152]=0,_a[152]=0,va[152]=-1,ba[152]=0,ma[152]=0,Aa[152]=-1,ya[152]=1,ea[152]=1,na[152]=0,ra[152]=1,ia[156]=0,oa[156]=-1,sa[156]=1,fa[156]=1,da[156]=0,ga[156]=1,ca[156]=-1,ha[156]=0,pa[156]=0,_a[156]=0,va[156]=-1,ba[156]=0,ma[156]=0,Aa[156]=1,ya[156]=1,ea[156]=-1,na[156]=0,ra[156]=1,ia[137]=0,oa[137]=1,sa[137]=1,aa[137]=0,la[137]=1,ua[137]=0,ca[137]=-1,ha[137]=0,pa[137]=0,_a[137]=0,va[137]=-1,ba[137]=0,Ks[137]=1,Js[137]=0,ta[137]=0,ea[137]=1,na[137]=0,ra[137]=1,ia[139]=0,oa[139]=1,sa[139]=1,aa[139]=0,la[139]=-1,ua[139]=0,ca[139]=1,ha[139]=0,pa[139]=0,_a[139]=0,va[139]=1,ba[139]=0,Ks[139]=-1,Js[139]=0,ta[139]=0,ea[139]=1,na[139]=0,ra[139]=1,ia[98]=0,oa[98]=-1,sa[98]=0,aa[98]=0,la[98]=-1,ua[98]=1,fa[98]=1,da[98]=0,ga[98]=0,ca[98]=1,ha[98]=0,pa[98]=1,ma[98]=0,Aa[98]=1,ya[98]=0,Ks[98]=-1,Js[98]=0,ta[98]=1,ia[99]=0,oa[99]=1,sa[99]=0,aa[99]=0,la[99]=-1,ua[99]=1,fa[99]=1,da[99]=0,ga[99]=0,ca[99]=-1,ha[99]=0,pa[99]=1,ma[99]=0,Aa[99]=-1,ya[99]=0,Ks[99]=1,Js[99]=0,ta[99]=1,aa[38]=0,la[38]=-1,ua[38]=1,fa[38]=1,da[38]=0,ga[38]=0,_a[38]=0,va[38]=1,ba[38]=1,ma[38]=0,Aa[38]=1,ya[38]=0,Ks[38]=-1,Js[38]=0,ta[38]=1,ea[38]=-1,na[38]=0,ra[38]=0,aa[39]=0,la[39]=1,ua[39]=1,fa[39]=-1,da[39]=0,ga[39]=0,_a[39]=0,va[39]=-1,ba[39]=1,ma[39]=0,Aa[39]=1,ya[39]=0,Ks[39]=-1,Js[39]=0,ta[39]=1,ea[39]=1,na[39]=0,ra[39]=0;var xa=function(t){return[[t.bottomleft,0],[0,0],[0,t.leftbottom]]},wa=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0]]},Ea=function(t){return[[t.topright,1],[1,1],[1,t.righttop]]},Sa=function(t){return[[0,t.lefttop],[0,1],[t.topleft,1]]},Ta=function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop]]},Pa=function(t){return[[t.bottomright,0],[t.bottomleft,0],[1,t.righttop],[1,t.rightbottom]]},Ma=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.topleft,1],[t.topright,1]]},Ca=function(t){return[[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},Ia=[],Oa=[],Ra=[],La=[],ka=[],Da=[],Na=[],Fa=[];La[1]=ka[1]=18,La[169]=ka[169]=18,Ra[4]=Oa[4]=12,Ra[166]=Oa[166]=12,Ia[16]=Fa[16]=4,Ia[154]=Fa[154]=4,Da[64]=Na[64]=22,Da[106]=Na[106]=22,Ra[2]=Da[2]=17,La[2]=ka[2]=18,Ra[168]=Da[168]=17,La[168]=ka[168]=18,Ia[8]=La[8]=9,Oa[8]=Ra[8]=12,Ia[162]=La[162]=9,Oa[162]=Ra[162]=12,Ia[32]=Fa[32]=4,Oa[32]=Na[32]=1,Ia[138]=Fa[138]=4,Oa[138]=Na[138]=1,ka[128]=Fa[128]=21,Da[128]=Na[128]=22,ka[42]=Fa[42]=21,Da[42]=Na[42]=22,Oa[5]=ka[5]=14,Oa[165]=ka[165]=14,Ra[20]=Fa[20]=6,Ra[150]=Fa[150]=6,Ia[80]=Da[80]=11,Ia[90]=Da[90]=11,La[65]=Na[65]=3,La[105]=Na[105]=3,Ia[160]=Da[160]=11,Oa[160]=ka[160]=14,Ia[10]=Da[10]=11,Oa[10]=ka[10]=14,Ra[130]=Fa[130]=6,La[130]=Na[130]=3,Ra[40]=Fa[40]=6,La[40]=Na[40]=3,Oa[101]=Na[101]=1,Oa[69]=Na[69]=1,ka[149]=Fa[149]=21,ka[21]=Fa[21]=21,Ra[86]=Da[86]=17,Ra[84]=Da[84]=17,Ia[89]=La[89]=9,Ia[81]=La[81]=9,Ia[96]=Na[96]=0,Oa[96]=Da[96]=15,Ia[74]=Na[74]=0,Oa[74]=Da[74]=15,Ia[24]=Ra[24]=8,La[24]=Fa[24]=7,Ia[146]=Ra[146]=8,La[146]=Fa[146]=7,Oa[6]=Da[6]=15,Ra[6]=ka[6]=16,Oa[164]=Da[164]=15,Ra[164]=ka[164]=16,La[129]=Fa[129]=7,ka[129]=Na[129]=20,La[41]=Fa[41]=7,ka[41]=Na[41]=20,Ra[66]=Na[66]=2,La[66]=Da[66]=19,Ra[104]=Na[104]=2,La[104]=Da[104]=19,Ia[144]=ka[144]=10,Da[144]=Fa[144]=23,Ia[26]=ka[26]=10,Da[26]=Fa[26]=23,Oa[36]=Fa[36]=5,Ra[36]=Na[36]=2,Oa[134]=Fa[134]=5,Ra[134]=Na[134]=2,Ia[9]=ka[9]=10,Oa[9]=La[9]=13,Ia[161]=ka[161]=10,Oa[161]=La[161]=13,Oa[37]=Fa[37]=5,ka[37]=Na[37]=20,Oa[133]=Fa[133]=5,ka[133]=Na[133]=20,Ra[148]=ka[148]=16,Da[148]=Fa[148]=23,Ra[22]=ka[22]=16,Da[22]=Fa[22]=23,Ia[82]=Ra[82]=8,La[82]=Da[82]=19,Ia[88]=Ra[88]=8,La[88]=Da[88]=19,Ia[73]=Na[73]=0,Oa[73]=La[73]=13,Ia[97]=Na[97]=0,Oa[97]=La[97]=13,Ia[145]=La[145]=9,ka[145]=Fa[145]=21,Ia[25]=La[25]=9,ka[25]=Fa[25]=21,Oa[70]=Na[70]=1,Ra[70]=Da[70]=17,Oa[100]=Na[100]=1,Ra[100]=Da[100]=17,Ia[34]=La[34]=9,Oa[34]=Ra[34]=12,ka[34]=Fa[34]=21,Da[34]=Na[34]=22,Ia[136]=Fa[136]=4,Oa[136]=Na[136]=1,Ra[136]=Da[136]=17,La[136]=ka[136]=18,Ia[35]=Fa[35]=4,Oa[35]=Ra[35]=12,La[35]=ka[35]=18,Da[35]=Na[35]=22,Ia[153]=Fa[153]=4,La[153]=ka[153]=18,Oa[102]=Ra[102]=12,Da[102]=Na[102]=22,Ia[155]=La[155]=9,ka[155]=Fa[155]=23,Oa[103]=Na[103]=1,Ra[103]=Da[103]=17,Ia[152]=Fa[152]=4,Ra[152]=Da[152]=17,La[152]=ka[152]=18,Ia[156]=Ra[156]=8,La[156]=ka[156]=18,Da[156]=Fa[156]=23,Ia[137]=Fa[137]=4,Oa[137]=Na[137]=1,La[137]=ka[137]=18,Ia[139]=Fa[139]=4,Oa[139]=La[139]=13,ka[139]=Na[139]=20,Ia[98]=La[98]=9,Oa[98]=Ra[98]=12,Da[98]=Na[98]=22,Ia[99]=Na[99]=0,Oa[99]=Ra[99]=12,La[99]=Da[99]=19,Oa[38]=Ra[38]=12,ka[38]=Fa[38]=21,Da[38]=Na[38]=22,Oa[39]=Fa[39]=5,Ra[39]=ka[39]=16,Da[39]=Na[39]=22;var Ba=[];function za(t,e,n){return(t-e)/(n-e)}function ja(t){return t.constructor.toString().indexOf("Array")>-1}function Ua(t,e,n,r,i,o){for(var s=t.cells[n][e],a=s.cval_real,l=e+r,u=n+i,c=[],h=!1;!h;){if(void 0===t.cells[u]||void 0===t.cells[u][l])if(u-=i,l-=r,a=(s=t.cells[u][l]).cval_real,-1===i)if(0===o)if(1&a)c.push([l,u]),r=-1,i=0,o=0;else{if(!(4&a)){c.push([l+s.bottomright,u]),r=0,i=1,o=1,h=!0;break}c.push([l+1,u]),r=1,i=0,o=0}else{if(!(1&a)){if(4&a){c.push([l+s.bottomright,u]),r=0,i=1,o=1,h=!0;break}c.push([l+s.bottomleft,u]),r=0,i=1,o=0,h=!0;break}c.push([l,u]),r=-1,i=0,o=0}else if(1===i)if(0===o){if(!(a&Qs)){if(a&Ys){c.push([l+s.topleft,u+1]),r=0,i=-1,o=0,h=!0;break}c.push([l+s.topright,u+1]),r=0,i=-1,o=1,h=!0;break}c.push([l+1,u+1]),r=1,i=0,o=1}else c.push([l+1,u+1]),r=1,i=0,o=1;else if(-1===r)if(0===o){if(!(a&Ys)){if(1&a){c.push([l,u+s.leftbottom]),r=1,i=0,o=0,h=!0;break}c.push([l,u+s.lefttop]),r=1,i=0,o=1,h=!0;break}c.push([l,u+1]),r=0,i=1,o=0}else{if(!(a&Ys)){console.log("MarchingSquaresJS-isoBands: wtf");break}c.push([l,u+1]),r=0,i=1,o=0}else{if(1!==r){console.log("MarchingSquaresJS-isoBands: we came from nowhere!");break}if(0===o){if(!(4&a)){c.push([l+1,u+s.rightbottom]),r=-1,i=0,o=0,h=!0;break}c.push([l+1,u]),r=0,i=-1,o=1}else{if(!(4&a)){if(a&Qs){c.push([l+1,u+s.righttop]),r=-1,i=0,o=1;break}c.push([l+1,u+s.rightbottom]),r=-1,i=0,o=0,h=!0;break}c.push([l+1,u]),r=0,i=-1,o=1}}else if(a=(s=t.cells[u][l]).cval_real,-1===r)if(0===o)if(void 0!==t.cells[u-1]&&void 0!==t.cells[u-1][l])r=0,i=-1,o=1;else{if(!(1&a)){c.push([l+s.bottomright,u]),r=0,i=1,o=1,h=!0;break}c.push([l,u])}else{if(!(a&Ys)){console.log("MarchingSquaresJS-isoBands: found entry from top at "+l+","+u);break}console.log("MarchingSquaresJS-isoBands: proceeding in x-direction!")}else if(1===r){if(0===o){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==t.cells[u+1]&&void 0!==t.cells[u+1][l])r=0,i=1,o=0;else{if(!(a&Qs)){c.push([l+s.topleft,u+1]),r=0,i=-1,o=0,h=!0;break}c.push([l+1,u+1]),r=1,i=0,o=1}}else if(-1===i){if(1!==o){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==t.cells[u][l+1])r=1,i=0,o=1;else{if(!(4&a)){c.push([l+1,u+s.righttop]),r=-1,i=0,o=1,h=!0;break}c.push([l+1,u]),r=0,i=-1,o=1}}else{if(1!==i){console.log("MarchingSquaresJS-isoBands: where did we came from???");break}if(0!==o){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==t.cells[u][l-1])r=-1,i=0,o=0;else{if(!(a&Ys)){c.push([l,u+s.leftbottom]),r=1,i=0,o=0,h=!0;break}c.push([l,u+1]),r=0,i=1,o=0}}if(u+=i,(l+=r)===e&&u===n)break}return{path:c,i:l,j:u,x:r,y:i,o}}function Va(t){if(t.edges.length>0){var e=t.edges[t.edges.length-1],n=t.cval_real;switch(e){case 0:return n&Qs?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[t.topleft,1],x:0,y:-1,o:0};case 1:return 4&n?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 2:return 4&n?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[t.topleft,1],x:0,y:-1,o:0};case 3:return 1&n?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 4:return n&Qs?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[t.topright,1],x:0,y:-1,o:1};case 5:return 4&n?{p:[t.topright,1],x:0,y:-1,o:1}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 6:return 4&n?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[t.topright,1],x:0,y:-1,o:1};case 7:return 1&n?{p:[t.topright,1],x:0,y:-1,o:1}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 8:return 4&n?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[1,t.righttop],x:-1,y:0,o:1};case 9:return 1&n?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 10:return 1&n?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[1,t.righttop],x:-1,y:0,o:1};case 11:return n&Ys?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[0,t.lefttop],x:1,y:0,o:1};case 12:return 4&n?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 13:return 1&n?{p:[1,t.rightbottom],x:-1,y:0,o:0}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 14:return 1&n?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 15:return n&Ys?{p:[1,t.rightbottom],x:-1,y:0,o:0}:{p:[0,t.lefttop],x:1,y:0,o:1};case 16:return 4&n?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[0,t.leftbottom],x:1,y:0,o:0};case 17:return n&Ys?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[0,t.lefttop],x:1,y:0,o:1};case 18:return 1&n?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 19:return n&Ys?{p:[t.bottomleft,0],x:0,y:1,o:0}:{p:[0,t.lefttop],x:1,y:0,o:1};case 20:return n&Ys?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[0,t.leftbottom],x:1,y:0,o:0};case 21:return n&Qs?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[t.topright,1],x:0,y:-1,o:1};case 22:return n&Ys?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[0,t.lefttop],x:1,y:0,o:1};case 23:return n&Qs?{p:[0,t.lefttop],x:1,y:0,o:1}:{p:[t.topright,1],x:0,y:-1,o:1};default:console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(t)}}return null}function Ga(t,e,n,r){var i,o,s,a,l,u=t.cval;switch(e){case-1:0===r?(i=Oa[u],s=aa[u],a=la[u],l=ua[u]):(i=Ia[u],s=ia[u],a=oa[u],l=sa[u]);break;case 1:0===r?(i=ka[u],s=_a[u],a=va[u],l=ba[u]):(i=Da[u],s=ma[u],a=Aa[u],l=ya[u]);break;default:switch(n){case-1:0===r?(i=Na[u],s=Ks[u],a=Js[u],l=ta[u]):(i=Fa[u],s=ea[u],a=na[u],l=ra[u]);break;case 1:0===r?(i=La[u],s=ca[u],a=ha[u],l=pa[u]):(i=Ra[u],s=fa[u],a=da[u],l=ga[u])}}if(o=t.edges.indexOf(i),void 0===t.edges[o])return null;switch(function(t,e){delete t.edges[e];for(var n=e+1;n<t.edges.length;n++)t.edges[n-1]=t.edges[n];t.edges.pop()}(t,o),u=t.cval_real,i){case 0:u&Qs?(e=t.topleft,n=1):(e=1,n=t.righttop);break;case 1:4&u?(e=1,n=t.rightbottom):(e=t.topleft,n=1);break;case 2:4&u?(e=t.topleft,n=1):(e=t.bottomright,n=0);break;case 3:1&u?(e=t.bottomleft,n=0):(e=t.topleft,n=1);break;case 4:u&Qs?(e=t.topright,n=1):(e=1,n=t.righttop);break;case 5:4&u?(e=1,n=t.rightbottom):(e=t.topright,n=1);break;case 6:4&u?(e=t.topright,n=1):(e=t.bottomright,n=0);break;case 7:1&u?(e=t.bottomleft,n=0):(e=t.topright,n=1);break;case 8:4&u?(e=1,n=t.righttop):(e=t.bottomright,n=0);break;case 9:1&u?(e=t.bottomleft,n=0):(e=1,n=t.righttop);break;case 10:1&u?(e=1,n=t.righttop):(e=0,n=t.leftbottom);break;case 11:u&Ys?(e=0,n=t.lefttop):(e=1,n=t.righttop);break;case 12:4&u?(e=1,n=t.rightbottom):(e=t.bottomright,n=0);break;case 13:1&u?(e=t.bottomleft,n=0):(e=1,n=t.rightbottom);break;case 14:1&u?(e=1,n=t.rightbottom):(e=0,n=t.leftbottom);break;case 15:u&Ys?(e=0,n=t.lefttop):(e=1,n=t.rightbottom);break;case 16:4&u?(e=0,n=t.leftbottom):(e=t.bottomright,n=0);break;case 17:u&Ys?(e=0,n=t.lefttop):(e=t.bottomright,n=0);break;case 18:1&u?(e=t.bottomleft,n=0):(e=0,n=t.leftbottom);break;case 19:u&Ys?(e=0,n=t.lefttop):(e=t.bottomleft,n=0);break;case 20:u&Ys?(e=0,n=t.leftbottom):(e=t.topleft,n=1);break;case 21:u&Qs?(e=t.topright,n=1):(e=0,n=t.leftbottom);break;case 22:u&Ys?(e=0,n=t.lefttop):(e=t.topleft,n=1);break;case 23:u&Qs?(e=t.topright,n=1):(e=0,n=t.lefttop);break;default:return console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(t),null}return void 0!==e&&void 0!==n&&void 0!==s&&void 0!==a&&void 0!==l||(console.log("MarchingSquaresJS-isoBands: undefined value!"),console.log(t),console.log(e+" "+n+" "+s+" "+a+" "+l)),{p:[e,n],x:s,y:a,o:l}}function Za(t){var e=[],n=[];t.forEach((function(t){var r=Lo(Yn([t]));n.push(r),e.push({ring:t,area:r})})),n.sort((function(t,e){return e-t}));var r=[];return n.forEach((function(t){for(var n=0;n<e.length;n++)if(e[n].area===t){r.push(e[n].ring),e.splice(n,1);break}})),r}function qa(t){for(var e=t.map((function(t){return{lrCoordinates:t,grouped:!1}})),n=[];!Ha(e);)for(var r=0;r<e.length;r++)if(!e[r].grouped){var i=[];i.push(e[r].lrCoordinates),e[r].grouped=!0;for(var o=Yn([e[r].lrCoordinates]),s=r+1;s<e.length;s++)e[s].grouped||Wa(Yn([e[s].lrCoordinates]),o)&&(i.push(e[s].lrCoordinates),e[s].grouped=!0);n.push(i)}return n}function Wa(t,e){for(var n=po(t),r=0;r<n.features.length;r++)if(!ni(n.features[r],e))return!1;return!0}function Ha(t){for(var e=0;e<t.length;e++)if(!1===t[e].grouped)return!1;return!0}Ba[1]=Ba[169]=xa,Ba[4]=Ba[166]=wa,Ba[16]=Ba[154]=Ea,Ba[64]=Ba[106]=Sa,Ba[168]=Ba[2]=Ta,Ba[162]=Ba[8]=Pa,Ba[138]=Ba[32]=Ma,Ba[42]=Ba[128]=Ca,Ba[5]=Ba[165]=function(t){return[[0,0],[0,t.leftbottom],[1,t.rightbottom],[1,0]]},Ba[20]=Ba[150]=function(t){return[[1,0],[t.bottomright,0],[t.topright,1],[1,1]]},Ba[80]=Ba[90]=function(t){return[[1,1],[1,t.righttop],[0,t.lefttop],[0,1]]},Ba[65]=Ba[105]=function(t){return[[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},Ba[160]=Ba[10]=function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.leftbottom],[0,t.lefttop]]},Ba[130]=Ba[40]=function(t){return[[t.topleft,1],[t.topright,1],[t.bottomright,0],[t.bottomleft,0]]},Ba[85]=function(){return[[0,0],[0,1],[1,1],[1,0]]},Ba[101]=Ba[69]=function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,1],[t.topleft,1]]},Ba[149]=Ba[21]=function(t){return[[t.topright,1],[1,1],[1,0],[0,0],[0,t.leftbottom]]},Ba[86]=Ba[84]=function(t){return[[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[1,1]]},Ba[89]=Ba[81]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,1]]},Ba[96]=Ba[74]=function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.lefttop],[0,1],[t.topleft,1]]},Ba[24]=Ba[146]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[t.topright,1]]},Ba[6]=Ba[164]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop]]},Ba[129]=Ba[41]=function(t){return[[t.topright,1],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1]]},Ba[66]=Ba[104]=function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},Ba[144]=Ba[26]=function(t){return[[1,1],[1,t.righttop],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},Ba[36]=Ba[134]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[t.topleft,1],[t.topright,1]]},Ba[9]=Ba[161]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom]]},Ba[37]=Ba[133]=function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},Ba[148]=Ba[22]=function(t){return[[1,1],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},Ba[82]=Ba[88]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1]]},Ba[73]=Ba[97]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},Ba[145]=Ba[25]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},Ba[70]=Ba[100]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},Ba[34]=function(t){return[Ca(t),Pa(t)]},Ba[35]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},Ba[136]=function(t){return[Ma(t),Ta(t)]},Ba[153]=function(t){return[Ea(t),xa(t)]},Ba[102]=function(t){return[wa(t),Sa(t)]},Ba[155]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},Ba[103]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},Ba[152]=function(t){return[Ea(t),Ta(t)]},Ba[156]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},Ba[137]=function(t){return[Ma(t),xa(t)]},Ba[139]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},Ba[98]=function(t){return[Pa(t),Sa(t)]},Ba[99]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},Ba[38]=function(t){return[wa(t),Ca(t)]},Ba[39]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]};const Xa=function(t,e,n){if(!gr(n=n||{}))throw new Error("options is invalid");var r=n.zProperty||"elevation",i=n.commonProperties||{},o=n.breaksProperties||[];if(Vr(t,"Point","Input must contain Points"),!e)throw new Error("breaks is required");if(!Array.isArray(e))throw new Error("breaks is not an Array");if(!gr(i))throw new Error("commonProperties is not an Object");if(!Array.isArray(o))throw new Error("breaksProperties is not an Array");var s=function(t,e){if(!gr(e=e||{}))throw new Error("options is invalid");var n=e.zProperty||"elevation",r=e.flip,i=e.flags;Vr(t,"Point","input must contain Points");for(var o=function(t,e){var n={};return xr(t,(function(t){var e=Br(t)[1];n[e]||(n[e]=[]),n[e].push(t)})),Object.keys(n).map((function(t){return n[t].sort((function(t,e){return Br(t)[0]-Br(e)[0]}))})).sort((function(t,n){return e?Br(t[0])[1]-Br(n[0])[1]:Br(n[0])[1]-Br(t[0])[1]}))}(t,r),s=[],a=0;a<o.length;a++){for(var l=o[a],u=[],c=0;c<l.length;c++){var h=l[c];h.properties[n]?u.push(h.properties[n]):u.push(0),!0===i&&(h.properties.matrixPosition=[a,c])}s.push(u)}return s}(t,{zProperty:r,flip:!0}),a=function(t,e,n){for(var r=[],i=1;i<e.length;i++){var o=+e[i-1],s=+e[i],a=qa(Za($s(t,o,s-o))),l={};l.groupedRings=a,l[n]=o+"-"+s,r.push(l)}return r}(s,e,r);return a=function(t,e,n){var r=Nr(n),i=r[2]-r[0],o=r[3]-r[1],s=r[0],a=r[1],l=e[0].length-1,u=e.length-1,c=i/l,h=o/u,p=function(t){t[0]=t[0]*c+s,t[1]=t[1]*h+a};return t.forEach((function(t){t.groupedRings.forEach((function(t){t.forEach((function(t){t.forEach(p)}))}))})),t}(a,s,t),tr(a.map((function(t,e){if(o[e]&&!gr(o[e]))throw new Error("Each mappedProperty is required to be an Object");var n=qr({},i,o[e]);return n[r]=t[r],rr(t.groupedRings,n)})))},$a=function(t,e,n){if(!gr(n=n||{}))throw new Error("options is invalid");var r=n.pivot,i=n.mutate;if(!t)throw new Error("geojson is required");if(null==e||isNaN(e))throw new Error("angle is required");return 0===e||(r||(r=uo(t)),!1!==i&&void 0!==i||(t=di(t)),yr(t,(function(t){var n=Fs(r,t)+e,i=wo(r,t),o=Br(Bs(r,i,n));t[0]=o[0],t[1]=o[1]}))),t};function Ya(t,e,n){var r="Point"===Zr(t);return n=function(t,e){if(null==e&&(e="centroid"),Array.isArray(e)||"object"==typeof e)return Fr(e);var n=t.bbox?t.bbox:Nr(t),r=n[0],i=n[1],o=n[2],s=n[3];switch(e){case"sw":case"southwest":case"westsouth":case"bottomleft":return Xn([r,i]);case"se":case"southeast":case"eastsouth":case"bottomright":return Xn([o,i]);case"nw":case"northwest":case"westnorth":case"topleft":return Xn([r,s]);case"ne":case"northeast":case"eastnorth":case"topright":return Xn([o,s]);case"center":return lo(t);case void 0:case null:case"centroid":return uo(t);default:throw new Error("invalid origin")}}(t,n),1===e||r||yr(t,(function(t){var r=wo(n,t),i=Fs(n,t),o=Br(Bs(n,r*e,i));t[0]=o[0],t[1]=o[1],3===t.length&&(t[2]*=e)})),t}const Qa=function(t,e,n){if(!gr(n=n||{}))throw new Error("options is invalid");var r=n.origin,i=n.mutate;if(!t)throw new Error("geojson required");if("number"!=typeof e||0===e)throw new Error("invalid factor");var o=Array.isArray(r)||"object"==typeof r;return!0!==i&&(t=di(t)),"FeatureCollection"!==t.type||o?Ya(t,e,r):(xr(t,(function(n,i){t.features[i]=Ya(n,e,r)})),t)},Ka=function(t,e,n,r){if(!gr(r=r||{}))throw new Error("options is invalid");var i=r.units,o=r.zTranslation,s=r.mutate;if(!t)throw new Error("geojson is required");if(null==e||isNaN(e))throw new Error("distance is required");if(o&&"number"!=typeof o&&isNaN(o))throw new Error("zTranslation is not a number");if(o=void 0!==o?o:0,0===e&&0===o)return t;if(null==n||isNaN(n))throw new Error("direction is required");return e<0&&(e=-e,n+=180),!1!==s&&void 0!==s||(t=di(t)),yr(t,(function(t){var r=Br(Bs(t,e,n,{units:i}));t[0]=r[0],t[1]=r[1],o&&3===t.length&&(t[2]+=o)})),t};function Ja(t){var e=t[0],n=t[1];return[n[0]-e[0],n[1]-e[1]]}function tl(t,e){return t[0]*e[1]-e[0]*t[1]}function el(t,e,n){var r=[],i=lr(e,n),o=Br(t),s=[];return o.forEach((function(t,e){if(e!==o.length-1){var n=(h=t,p=o[e+1],f=i,d=Math.sqrt((h[0]-p[0])*(h[0]-p[0])+(h[1]-p[1])*(h[1]-p[1])),g=h[0]+f*(p[1]-h[1])/d,m=p[0]+f*(p[1]-h[1])/d,[[g,h[1]+f*(h[0]-p[0])/d],[m,p[1]+f*(h[0]-p[0])/d]]);if(r.push(n),e>0){var a=r[e-1],l=!function(t,e){return 0===tl(Ja(t),Ja(e))}(u=n,c=a)&&function(t,e){var n,r,i=t[0],o=Ja(t),s=e[0],a=Ja(e),l=tl(o,a),u=function(t,e){return[t[0]+e[0],t[1]+e[1]]}(i,function(t,e){return[t*e[0],t*e[1]]}(tl((r=i,[(n=s)[0]-r[0],n[1]-r[1]]),a)/l,o));return u}(u,c);!1!==l&&(a[1]=l,n[0]=l),s.push(a[0]),e===o.length-2&&(s.push(n[0]),s.push(n[1]))}2===o.length&&(s.push(n[0]),s.push(n[1]))}var u,c,h,p,f,d,g,m})),Kn(s,t.properties)}const nl=function(t,e,n){if(!gr(n=n||{}))throw new Error("options is invalid");var r=n.units;if(!t)throw new Error("geojson is required");if(null==e||isNaN(e))throw new Error("distance is required");var i=Zr(t),o=t.properties;switch(i){case"LineString":return el(t,e,r);case"MultiLineString":var s=[];return Pr(t,(function(t){s.push(el(t,e,r).geometry.coordinates)})),er(s,o);default:throw new Error("geometry "+i+" is not supported")}};function rl(t,e,n){var r,i=e[0]-t[0],o=e[1]-t[1],s=n[0]-e[0];return((r=i*(n[1]-e[1])-s*o)>0)-(r<0)||+r}function il(t,e){return e.geometry.coordinates[0].every((function(e){return ni(Xn(e),t)}))}const ol=function(){function t(e){this.id=t.buildId(e),this.coordinates=e,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1}return t.buildId=function(t){return t.join(",")},t.prototype.removeInnerEdge=function(t){this.innerEdges=this.innerEdges.filter((function(e){return e.from.id!==t.from.id}))},t.prototype.removeOuterEdge=function(t){this.outerEdges=this.outerEdges.filter((function(e){return e.to.id!==t.to.id}))},t.prototype.addOuterEdge=function(t){this.outerEdges.push(t),this.outerEdgesSorted=!1},t.prototype.sortOuterEdges=function(){var t=this;this.outerEdgesSorted||(this.outerEdges.sort((function(e,n){var r=e.to,i=n.to;if(r.coordinates[0]-t.coordinates[0]>=0&&i.coordinates[0]-t.coordinates[0]<0)return 1;if(r.coordinates[0]-t.coordinates[0]<0&&i.coordinates[0]-t.coordinates[0]>=0)return-1;if(r.coordinates[0]-t.coordinates[0]==0&&i.coordinates[0]-t.coordinates[0]==0)return r.coordinates[1]-t.coordinates[1]>=0||i.coordinates[1]-t.coordinates[1]>=0?r.coordinates[1]-i.coordinates[1]:i.coordinates[1]-r.coordinates[1];var o=rl(t.coordinates,r.coordinates,i.coordinates);return o<0?1:o>0?-1:Math.pow(r.coordinates[0]-t.coordinates[0],2)+Math.pow(r.coordinates[1]-t.coordinates[1],2)-(Math.pow(i.coordinates[0]-t.coordinates[0],2)+Math.pow(i.coordinates[1]-t.coordinates[1],2))})),this.outerEdgesSorted=!0)},t.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},t.prototype.getOuterEdge=function(t){return this.sortOuterEdges(),this.outerEdges[t]},t.prototype.addInnerEdge=function(t){this.innerEdges.push(t)},t}(),sl=function(){function t(t,e){this.from=t,this.to=e,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)}return t.prototype.getSymetric=function(){return this.symetric||(this.symetric=new t(this.to,this.from),this.symetric.symetric=this),this.symetric},t.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)},t.prototype.isEqual=function(t){return this.from.id===t.from.id&&this.to.id===t.to.id},t.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},t.prototype.toLineString=function(){return Kn([this.from.coordinates,this.to.coordinates])},t.prototype.compareTo=function(t){return rl(t.from.coordinates,t.to.coordinates,this.to.coordinates)},t}(),al=function(){function t(){this.edges=[],this.polygon=void 0,this.envelope=void 0}return t.prototype.push=function(t){this.edges.push(t),this.polygon=this.envelope=void 0},t.prototype.get=function(t){return this.edges[t]},Object.defineProperty(t.prototype,"length",{get:function(){return this.edges.length},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.edges.forEach(t)},t.prototype.map=function(t){return this.edges.map(t)},t.prototype.some=function(t){return this.edges.some(t)},t.prototype.isValid=function(){return!0},t.prototype.isHole=function(){var t=this,e=this.edges.reduce((function(e,n,r){return n.from.coordinates[1]>t.edges[e].from.coordinates[1]&&(e=r),e}),0),n=(0===e?this.length:e)-1,r=(e+1)%this.length,i=rl(this.edges[n].from.coordinates,this.edges[e].from.coordinates,this.edges[r].from.coordinates);return 0===i?this.edges[n].from.coordinates[0]>this.edges[r].from.coordinates[0]:i>0},t.prototype.toMultiPoint=function(){return nr(this.edges.map((function(t){return t.from.coordinates})))},t.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var t=this.edges.map((function(t){return t.from.coordinates}));return t.push(this.edges[0].from.coordinates),this.polygon=Yn([t])},t.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=no(this.toPolygon())},t.findEdgeRingContaining=function(t,e){var n,r,i=t.getEnvelope();return e.forEach((function(e){var o,s,a,l,u,c,h=e.getEnvelope();if(r&&(n=r.getEnvelope()),s=i,a=(o=h).geometry.coordinates[0].map((function(t){return t[0]})),l=o.geometry.coordinates[0].map((function(t){return t[1]})),u=s.geometry.coordinates[0].map((function(t){return t[0]})),c=s.geometry.coordinates[0].map((function(t){return t[1]})),(Math.max.apply(null,a)!==Math.max.apply(null,u)||Math.max.apply(null,l)!==Math.max.apply(null,c)||Math.min.apply(null,a)!==Math.min.apply(null,u)||Math.min.apply(null,l)!==Math.min.apply(null,c))&&il(h,i)){for(var p=t.map((function(t){return t.from.coordinates})),f=void 0,d=function(t){e.some((function(e){return n=t,r=e.from.coordinates,n[0]===r[0]&&n[1]===r[1];var n,r}))||(f=t)},g=0,m=p;g<m.length;g++)d(m[g]);f&&e.inside(Xn(f))&&(r&&!il(n,h)||(r=e))}})),r},t.prototype.inside=function(t){return ni(t,this.toPolygon())},t}();var ll=function(){function t(){this.edges=[],this.nodes={}}return t.fromGeoJson=function(e){!function(t){if(!t)throw new Error("No geojson passed");if("FeatureCollection"!==t.type&&"GeometryCollection"!==t.type&&"MultiLineString"!==t.type&&"LineString"!==t.type&&"Feature"!==t.type)throw new Error("Invalid input type '"+t.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}(e);var n=new t;return Pr(e,(function(t){Ur(t,"LineString","Graph::fromGeoJson"),_r(t,(function(t,e){if(t){var r=n.getNode(t),i=n.getNode(e);n.addEdge(r,i)}return e}))})),n},t.prototype.getNode=function(t){var e=ol.buildId(t),n=this.nodes[e];return n||(n=this.nodes[e]=new ol(t)),n},t.prototype.addEdge=function(t,e){var n=new sl(t,e),r=n.getSymetric();this.edges.push(n),this.edges.push(r)},t.prototype.deleteDangles=function(){var t=this;Object.keys(this.nodes).map((function(e){return t.nodes[e]})).forEach((function(e){return t._removeIfDangle(e)}))},t.prototype._removeIfDangle=function(t){var e=this;if(t.innerEdges.length<=1){var n=t.getOuterEdges().map((function(t){return t.to}));this.removeNode(t),n.forEach((function(t){return e._removeIfDangle(t)}))}},t.prototype.deleteCutEdges=function(){var t=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach((function(e){e.label===e.symetric.label&&(t.removeEdge(e.symetric),t.removeEdge(e))}))},t.prototype._computeNextCWEdges=function(t){var e=this;void 0===t?Object.keys(this.nodes).forEach((function(t){return e._computeNextCWEdges(e.nodes[t])})):t.getOuterEdges().forEach((function(e,n){t.getOuterEdge((0===n?t.getOuterEdges().length:n)-1).symetric.next=e}))},t.prototype._computeNextCCWEdges=function(t,e){for(var n,r,i=t.getOuterEdges(),o=i.length-1;o>=0;--o){var s=i[o],a=s.symetric,l=void 0,u=void 0;s.label===e&&(l=s),a.label===e&&(u=a),l&&u&&(u&&(r=u),l&&(r&&(r.next=l,r=void 0),n||(n=l)))}r&&(r.next=n)},t.prototype._findLabeledEdgeRings=function(){var t=[],e=0;return this.edges.forEach((function(n){if(!(n.label>=0)){t.push(n);var r=n;do{r.label=e,r=r.next}while(!n.isEqual(r));e++}})),t},t.prototype.getEdgeRings=function(){var t=this;this._computeNextCWEdges(),this.edges.forEach((function(t){t.label=void 0})),this._findLabeledEdgeRings().forEach((function(e){t._findIntersectionNodes(e).forEach((function(n){t._computeNextCCWEdges(n,e.label)}))}));var e=[];return this.edges.forEach((function(n){n.ring||e.push(t._findEdgeRing(n))})),e},t.prototype._findIntersectionNodes=function(t){var e=[],n=t,r=function(){var r=0;n.from.getOuterEdges().forEach((function(e){e.label===t.label&&++r})),r>1&&e.push(n.from),n=n.next};do{r()}while(!t.isEqual(n));return e},t.prototype._findEdgeRing=function(t){var e=t,n=new al;do{n.push(e),e.ring=n,e=e.next}while(!t.isEqual(e));return n},t.prototype.removeNode=function(t){var e=this;t.getOuterEdges().forEach((function(t){return e.removeEdge(t)})),t.innerEdges.forEach((function(t){return e.removeEdge(t)})),delete this.nodes[t.id]},t.prototype.removeEdge=function(t){this.edges=this.edges.filter((function(e){return!e.isEqual(t)})),t.deleteEdge()},t}();const ul=ll;function cl(t){var e=ul.fromGeoJson(t);e.deleteDangles(),e.deleteCutEdges();var n=[],r=[];return e.getEdgeRings().filter((function(t){return t.isValid()})).forEach((function(t){t.isHole()?n.push(t):r.push(t)})),n.forEach((function(t){al.findEdgeRingContaining(t,r)&&r.push(t)})),tr(r.map((function(t){return t.toPolygon()})))}function hl(t,e){for(var n=0;n<t.coordinates.length-1;n++)if(fl(t.coordinates[n],t.coordinates[n+1],e.coordinates))return!0;return!1}function pl(t,e){for(var n=0,r=e.coordinates;n<r.length;n++)if(ni(r[n],t))return!0;return bo(e,vs(t)).features.length>0}function fl(t,e,n){var r=n[0]-t[0],i=n[1]-t[1],o=e[0]-t[0],s=e[1]-t[1];return 0==r*s-i*o&&(Math.abs(o)>=Math.abs(s)?o>0?t[0]<=n[0]&&n[0]<=e[0]:e[0]<=n[0]&&n[0]<=t[0]:s>0?t[1]<=n[1]&&n[1]<=e[1]:e[1]<=n[1]&&n[1]<=t[1])}const dl=function(t,e){var n=!0;return Pr(t,(function(t){Pr(e,(function(e){if(!1===n)return!1;n=function(t,e){switch(t.type){case"Point":switch(e.type){case"Point":return n=t.coordinates,r=e.coordinates,!(n[0]===r[0]&&n[1]===r[1]);case"LineString":return!hl(e,t);case"Polygon":return!ni(t,e)}break;case"LineString":switch(e.type){case"Point":return!hl(t,e);case"LineString":return!(bo(t,e).features.length>0);case"Polygon":return!pl(e,t)}break;case"Polygon":switch(e.type){case"Point":return!ni(e,t);case"LineString":return!pl(t,e);case"Polygon":return!function(t,e){for(var n=0,r=t.coordinates[0];n<r.length;n++)if(ni(r[n],e))return!0;for(var i=0,o=e.coordinates[0];i<o.length;i++)if(ni(o[i],t))return!0;return bo(vs(t),vs(e)).features.length>0}(e,t)}}var n,r;return!1}(t.geometry,e.geometry)}))})),n};function gl(t,e){var n=Gr(t),r=Gr(e),i=n.type,o=r.type,s=n.coordinates,a=r.coordinates;switch(i){case"Point":if("Point"===o)return Al(s,a);throw new Error("feature2 "+o+" geometry not supported");case"MultiPoint":switch(o){case"Point":return function(t,e){var n,r=!1;for(n=0;n<t.coordinates.length;n++)if(Al(t.coordinates[n],e.coordinates)){r=!0;break}return r}(n,r);case"MultiPoint":return function(t,e){for(var n=0,r=e.coordinates;n<r.length;n++){for(var i=r[n],o=!1,s=0,a=t.coordinates;s<a.length;s++)if(Al(i,a[s])){o=!0;break}if(!o)return!1}return!0}(n,r);default:throw new Error("feature2 "+o+" geometry not supported")}case"LineString":switch(o){case"Point":return Vo(r,n,{ignoreEndVertices:!0});case"LineString":return function(t,e){for(var n=!1,r=0,i=e.coordinates;r<i.length;r++){var o=i[r];if(Vo({type:"Point",coordinates:o},t,{ignoreEndVertices:!0})&&(n=!0),!Vo({type:"Point",coordinates:o},t,{ignoreEndVertices:!1}))return!1}return n}(n,r);case"MultiPoint":return function(t,e){for(var n=!1,r=0,i=e.coordinates;r<i.length;r++){var o=i[r];if(Vo(o,t,{ignoreEndVertices:!0})&&(n=!0),!Vo(o,t))return!1}return!!n}(n,r);default:throw new Error("feature2 "+o+" geometry not supported")}case"Polygon":switch(o){case"Point":return ni(r,n,{ignoreBoundary:!0});case"LineString":return function(t,e){var n,r,i=!1,o=0;if(!ml(Nr(t),Nr(e)))return!1;for(;o<e.coordinates.length-1;o++)if(ni({type:"Point",coordinates:(n=e.coordinates[o],r=e.coordinates[o+1],[(n[0]+r[0])/2,(n[1]+r[1])/2])},t,{ignoreBoundary:!0})){i=!0;break}return i}(n,r);case"Polygon":return function(t,e){if("Feature"===t.type&&null===t.geometry)return!1;if("Feature"===e.type&&null===e.geometry)return!1;if(!ml(Nr(t),Nr(e)))return!1;for(var n=0,r=Gr(e).coordinates;n<r.length;n++)for(var i=0,o=r[n];i<o.length;i++)if(!ni(o[i],t))return!1;return!0}(n,r);case"MultiPoint":return function(t,e){for(var n=0,r=e.coordinates;n<r.length;n++)if(!ni(r[n],t,{ignoreBoundary:!0}))return!1;return!0}(n,r);default:throw new Error("feature2 "+o+" geometry not supported")}default:throw new Error("feature1 "+i+" geometry not supported")}}function ml(t,e){return!(t[0]>e[0]||t[2]<e[2]||t[1]>e[1]||t[3]<e[3])}function Al(t,e){return t[0]===e[0]&&t[1]===e[1]}function yl(t,e){for(var n=!1,r=!1,i=t.coordinates.length,o=0;o<i&&!n&&!r;){for(var s=0;s<e.coordinates.length-1;s++){var a=!0;0!==s&&s!==e.coordinates.length-2||(a=!1),bl(e.coordinates[s],e.coordinates[s+1],t.coordinates[o],a)?n=!0:r=!0}o++}return n&&r}function _l(t,e){var n=bs(e);return bo(t,n).features.length>0}function vl(t,e){for(var n=!1,r=!1,i=t.coordinates.length,o=0;o<i&&(!n||!r);o++)ni(Xn(t.coordinates[o]),e)?n=!0:r=!0;return r&&n}function bl(t,e,n,r){var i=n[0]-t[0],o=n[1]-t[1],s=e[0]-t[0],a=e[1]-t[1];return 0==i*a-o*s&&(r?Math.abs(s)>=Math.abs(a)?s>0?t[0]<=n[0]&&n[0]<=e[0]:e[0]<=n[0]&&n[0]<=t[0]:a>0?t[1]<=n[1]&&n[1]<=e[1]:e[1]<=n[1]&&n[1]<=t[1]:Math.abs(s)>=Math.abs(a)?s>0?t[0]<n[0]&&n[0]<e[0]:e[0]<n[0]&&n[0]<t[0]:a>0?t[1]<n[1]&&n[1]<e[1]:e[1]<n[1]&&n[1]<t[1])}const xl=function(t,e){var n=Gr(t),r=Gr(e),i=n.type,o=r.type;switch(i){case"MultiPoint":switch(o){case"LineString":return yl(n,r);case"Polygon":return vl(n,r);default:throw new Error("feature2 "+o+" geometry not supported")}case"LineString":switch(o){case"MultiPoint":return yl(r,n);case"LineString":return function(t,e){if(bo(t,e).features.length>0)for(var n=0;n<t.coordinates.length-1;n++)for(var r=0;r<e.coordinates.length-1;r++){var i=!0;if(0!==r&&r!==e.coordinates.length-2||(i=!1),bl(t.coordinates[n],t.coordinates[n+1],e.coordinates[r],i))return!0}return!1}(n,r);case"Polygon":return _l(n,r);default:throw new Error("feature2 "+o+" geometry not supported")}case"Polygon":switch(o){case"MultiPoint":return vl(r,n);case"LineString":return _l(r,n);default:throw new Error("feature2 "+o+" geometry not supported")}default:throw new Error("feature1 "+i+" geometry not supported")}};var wl=n(9657);function El(t,e){var n=Gr(t),r=Gr(e),i=n.type,o=r.type;if("MultiPoint"===i&&"MultiPoint"!==o||("LineString"===i||"MultiLineString"===i)&&"LineString"!==o&&"MultiLineString"!==o||("Polygon"===i||"MultiPolygon"===i)&&"Polygon"!==o&&"MultiPolygon"!==o)throw new Error("features must be of the same type");if("Point"===i)throw new Error("Point geometry not supported");if(new wl({precision:6}).compare(t,e))return!1;var s=0;switch(i){case"MultiPoint":for(var a=0;a<n.coordinates.length;a++)for(var l=0;l<r.coordinates.length;l++){var u=n.coordinates[a],c=r.coordinates[l];if(u[0]===c[0]&&u[1]===c[1])return!0}return!1;case"LineString":case"MultiLineString":Cr(t,(function(t){Cr(e,(function(e){Ls(t,e).features.length&&s++}))}));break;case"Polygon":case"MultiPolygon":Cr(t,(function(t){Cr(e,(function(e){bo(t,e).features.length&&s++}))}))}return s>0}const Sl=function(t,e){return Gr(t).type===Gr(e).type&&new wl({precision:6}).compare(Ui(t),Ui(e))};function Tl(t,e){var n=!1;return Pr(t,(function(t){Pr(e,(function(e){if(!0===n)return!0;n=!dl(t.geometry,e.geometry)}))})),n}var Pl=n(2606);const Ml=function(t,e,n){void 0===n&&(n={}),!0!==n.mutate&&(t=di(t)),n.minPoints=n.minPoints||3;var r=new Pl.DBSCAN,i=r.run(Er(t),pr(e,n.units),n.minPoints,oi),o=-1;return i.forEach((function(e){o++,e.forEach((function(e){var n=t.features[e];n.properties||(n.properties={}),n.properties.cluster=o,n.properties.dbscan="core"}))})),r.noise.forEach((function(e){var n=t.features[e];n.properties||(n.properties={}),n.properties.cluster?n.properties.dbscan="edge":n.properties.dbscan="noise"})),t};var Cl=n(1160);const Il=function(t,e){void 0===e&&(e={});var n=t.features.length;e.numberOfClusters=e.numberOfClusters||Math.round(Math.sqrt(n/2)),e.numberOfClusters>n&&(e.numberOfClusters=n),!0!==e.mutate&&(t=di(t));var r=Er(t),i=r.slice(0,e.numberOfClusters),o=Cl(r,e.numberOfClusters,i),s={};return o.centroids.forEach((function(t,e){s[e]=t})),xr(t,(function(t,e){var n=o.idxs[e];t.properties.cluster=n,t.properties.centroid=s[n]})),t};function Ol(t,e){return ur(Fs(t[0],t[1]))===ur(Fs(e[0],e[1]))}function Rl(t,e){if(t.geometry&&t.geometry.type)return t.geometry.type;if(t.type)return t.type;throw new Error("Invalid GeoJSON object for "+e)}const Ll=function(t,e){if(!t)throw new Error("line1 is required");if(!e)throw new Error("line2 is required");if("LineString"!==Rl(t,"line1"))throw new Error("line1 must be a LineString");if("LineString"!==Rl(e,"line2"))throw new Error("line2 must be a LineString");for(var n=yo(Ui(t)).features,r=yo(Ui(e)).features,i=0;i<n.length;i++){var o=n[i].geometry.coordinates;if(!r[i])break;if(!Ol(o,r[i].geometry.coordinates))return!1}return!0};function kl(t){for(var e=t,n=[];e.parent;)n.unshift(e),e=e.parent;return n}var Dl={search:function(t,e,n,r){t.cleanDirty();var i=(r=r||{}).heuristic||Dl.heuristics.manhattan,o=r.closest||!1,s=new Bl((function(t){return t.f})),a=e;for(e.h=i(e,n),s.push(e);s.size()>0;){var l=s.pop();if(l===n)return kl(l);l.closed=!0;for(var u=t.neighbors(l),c=0,h=u.length;c<h;++c){var p=u[c];if(!p.closed&&!p.isWall()){var f=l.g+p.getCost(l),d=p.visited;(!d||f<p.g)&&(p.visited=!0,p.parent=l,p.h=p.h||i(p,n),p.g=f,p.f=p.g+p.h,t.markDirty(p),o&&(p.h<a.h||p.h===a.h&&p.g<a.g)&&(a=p),d?s.rescoreElement(p):s.push(p))}}}return o?kl(a):[]},heuristics:{manhattan:function(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)},diagonal:function(t,e){var n=Math.sqrt(2),r=Math.abs(e.x-t.x),i=Math.abs(e.y-t.y);return 1*(r+i)+(n-2)*Math.min(r,i)}},cleanNode:function(t){t.f=0,t.g=0,t.h=0,t.visited=!1,t.closed=!1,t.parent=null}};function Nl(t,e){e=e||{},this.nodes=[],this.diagonal=!!e.diagonal,this.grid=[];for(var n=0;n<t.length;n++){this.grid[n]=[];for(var r=0,i=t[n];r<i.length;r++){var o=new Fl(n,r,i[r]);this.grid[n][r]=o,this.nodes.push(o)}}this.init()}function Fl(t,e,n){this.x=t,this.y=e,this.weight=n}function Bl(t){this.content=[],this.scoreFunction=t}function zl(t,e){for(var n=0;n<e.features.length;n++)if(ni(t,e.features[n]))return!0;return!1}Nl.prototype.init=function(){this.dirtyNodes=[];for(var t=0;t<this.nodes.length;t++)Dl.cleanNode(this.nodes[t])},Nl.prototype.cleanDirty=function(){for(var t=0;t<this.dirtyNodes.length;t++)Dl.cleanNode(this.dirtyNodes[t]);this.dirtyNodes=[]},Nl.prototype.markDirty=function(t){this.dirtyNodes.push(t)},Nl.prototype.neighbors=function(t){var e=[],n=t.x,r=t.y,i=this.grid;return i[n-1]&&i[n-1][r]&&e.push(i[n-1][r]),i[n+1]&&i[n+1][r]&&e.push(i[n+1][r]),i[n]&&i[n][r-1]&&e.push(i[n][r-1]),i[n]&&i[n][r+1]&&e.push(i[n][r+1]),this.diagonal&&(i[n-1]&&i[n-1][r-1]&&e.push(i[n-1][r-1]),i[n+1]&&i[n+1][r-1]&&e.push(i[n+1][r-1]),i[n-1]&&i[n-1][r+1]&&e.push(i[n-1][r+1]),i[n+1]&&i[n+1][r+1]&&e.push(i[n+1][r+1])),e},Nl.prototype.toString=function(){for(var t,e,n,r,i=[],o=this.grid,s=0,a=o.length;s<a;s++){for(t=[],n=0,r=(e=o[s]).length;n<r;n++)t.push(e[n].weight);i.push(t.join(" "))}return i.join("\n")},Fl.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},Fl.prototype.getCost=function(t){return t&&t.x!==this.x&&t.y!==this.y?1.41421*this.weight:this.weight},Fl.prototype.isWall=function(){return 0===this.weight},Bl.prototype={push:function(t){this.content.push(t),this.sinkDown(this.content.length-1)},pop:function(){var t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.bubbleUp(0)),t},remove:function(t){var e=this.content.indexOf(t),n=this.content.pop();e!==this.content.length-1&&(this.content[e]=n,this.scoreFunction(n)<this.scoreFunction(t)?this.sinkDown(e):this.bubbleUp(e))},size:function(){return this.content.length},rescoreElement:function(t){this.sinkDown(this.content.indexOf(t))},sinkDown:function(t){for(var e=this.content[t];t>0;){var n=(t+1>>1)-1,r=this.content[n];if(!(this.scoreFunction(e)<this.scoreFunction(r)))break;this.content[n]=e,this.content[t]=r,t=n}},bubbleUp:function(t){for(var e=this.content.length,n=this.content[t],r=this.scoreFunction(n);;){var i,o=t+1<<1,s=o-1,a=null;if(s<e){var l=this.content[s];(i=this.scoreFunction(l))<r&&(a=s)}if(o<e){var u=this.content[o];this.scoreFunction(u)<(null===a?r:i)&&(a=o)}if(null===a)break;this.content[t]=this.content[a],this.content[a]=n,t=a}}};const jl=function(t,e,n){if(!gr(n=n||{}))throw new Error("options is invalid");var r=n.resolution,i=n.minDistance,o=n.obstacles||tr([]);if(!t)throw new Error("start is required");if(!e)throw new Error("end is required");if(r&&!dr(r)||r<=0)throw new Error("options.resolution must be a number, greater than 0");if(i)throw new Error("options.minDistance is not yet implemented");var s=Fr(t),a=Fr(e);switch(t=Xn(s),e=Xn(a),Zr(o)){case"FeatureCollection":if(0===o.features.length)return Kn([s,a]);break;case"Polygon":o=tr([Wn(Gr(o))]);break;default:throw new Error("invalid obstacles")}var l=o;l.features.push(t),l.features.push(e);var u=Nr(Qa(eo(Nr(l)),1.15));r||(r=oi([u[0],u[1]],[u[2],u[1]],n)/100),l.features.pop(),l.features.pop();for(var c=u[0],h=u[1],p=u[2],f=u[3],d=r/oi([c,h],[p,h],n)*(p-c),g=r/oi([c,h],[c,f],n)*(f-h),m=p-c,A=f-h,y=Math.floor(m/d),_=Math.floor(A/g),v=(m-y*d)/2,b=[],x=[],w=[],E=[],S=1/0,T=1/0,P=f-(A-_*g)/2,M=0;P>=h;){for(var C=[],I=[],O=c+v,R=0;O<=p;){var L=Xn([O,P]),k=zl(L,o);C.push(k?0:1),I.push(O+"|"+P);var D=oi(L,t);!k&&D<S&&(S=D,w={x:R,y:M});var N=oi(L,e);!k&&N<T&&(T=N,E={x:R,y:M}),O+=d,R++}x.push(C),b.push(I),P-=g,M++}var F=new Nl(x,{diagonal:!0}),B=F.grid[w.y][w.x],z=F.grid[E.y][E.x],j=Dl.search(F,B,z),U=[s];return j.forEach((function(t){var e=b[t.x][t.y].split("|");U.push([+e[0],+e[1]])})),U.push(a),Ui(Kn(U))};function Ul(t){return function(){return t}}function Vl(t){return t[0]}function Gl(t){return t[1]}function Zl(){this._=null}function ql(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function Wl(t,e){var n=e,r=e.R,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function Hl(t,e){var n=e,r=e.L,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function Xl(t){for(;t.L;)t=t.L;return t}Zl.prototype={constructor:Zl,insert:function(t,e){var n,r,i;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=Xl(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(r=n.U).L?(i=r.R)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.R&&(Wl(this,n),n=(t=n).U),n.C=!1,r.C=!0,Hl(this,r)):(i=r.L)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.L&&(Hl(this,n),n=(t=n).U),n.C=!1,r.C=!0,Wl(this,r)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,r,i=t.U,o=t.L,s=t.R;if(n=o?s?Xl(s):o:s,i?i.L===t?i.L=n:i.R=n:this._=n,o&&s?(r=n.C,n.C=t.C,n.L=o,o.U=n,n!==s?(i=n.U,n.U=t.U,t=n.R,i.L=t,n.R=s,s.U=n):(n.U=i,i=n,t=n.R)):(r=t.C,t=n),t&&(t.U=i),!r)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===i.L){if((e=i.R).C&&(e.C=!1,i.C=!0,Wl(this,i),e=i.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,Hl(this,e),e=i.R),e.C=i.C,i.C=e.R.C=!1,Wl(this,i),t=this._;break}}else if((e=i.L).C&&(e.C=!1,i.C=!0,Hl(this,i),e=i.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,Wl(this,e),e=i.L),e.C=i.C,i.C=e.L.C=!1,Hl(this,i),t=this._;break}e.C=!0,t=i,i=i.U}while(!t.C);t&&(t.C=!1)}}};const $l=Zl;function Yl(t,e,n,r){var i=[null,null],o=vu.push(i)-1;return i.left=t,i.right=e,n&&Kl(i,t,e,n),r&&Kl(i,e,t,r),yu[t.index].halfedges.push(o),yu[e.index].halfedges.push(o),i}function Ql(t,e,n){var r=[e,n];return r.left=t,r}function Kl(t,e,n,r){t[0]||t[1]?t.left===n?t[1]=r:t[0]=r:(t[0]=r,t.left=e,t.right=n)}function Jl(t,e,n,r,i){var o,s=t[0],a=t[1],l=s[0],u=s[1],c=0,h=1,p=a[0]-l,f=a[1]-u;if(o=e-l,p||!(o>0)){if(o/=p,p<0){if(o<c)return;o<h&&(h=o)}else if(p>0){if(o>h)return;o>c&&(c=o)}if(o=r-l,p||!(o<0)){if(o/=p,p<0){if(o>h)return;o>c&&(c=o)}else if(p>0){if(o<c)return;o<h&&(h=o)}if(o=n-u,f||!(o>0)){if(o/=f,f<0){if(o<c)return;o<h&&(h=o)}else if(f>0){if(o>h)return;o>c&&(c=o)}if(o=i-u,f||!(o<0)){if(o/=f,f<0){if(o>h)return;o>c&&(c=o)}else if(f>0){if(o<c)return;o<h&&(h=o)}return!(c>0||h<1)||(c>0&&(t[0]=[l+c*p,u+c*f]),h<1&&(t[1]=[l+h*p,u+h*f]),!0)}}}}}function tu(t,e,n,r,i){var o=t[1];if(o)return!0;var s,a,l=t[0],u=t.left,c=t.right,h=u[0],p=u[1],f=c[0],d=c[1],g=(h+f)/2,m=(p+d)/2;if(d===p){if(g<e||g>=r)return;if(h>f){if(l){if(l[1]>=i)return}else l=[g,n];o=[g,i]}else{if(l){if(l[1]<n)return}else l=[g,i];o=[g,n]}}else if(a=m-(s=(h-f)/(d-p))*g,s<-1||s>1)if(h>f){if(l){if(l[1]>=i)return}else l=[(n-a)/s,n];o=[(i-a)/s,i]}else{if(l){if(l[1]<n)return}else l=[(i-a)/s,i];o=[(n-a)/s,n]}else if(p<d){if(l){if(l[0]>=r)return}else l=[e,s*e+a];o=[r,s*r+a]}else{if(l){if(l[0]<e)return}else l=[r,s*r+a];o=[e,s*e+a]}return t[0]=l,t[1]=o,!0}function eu(t,e){var n=t.site,r=e.left,i=e.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=e[1],i=e[0]):(r=e[0],i=e[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function nu(t,e){return e[+(e.left!==t.site)]}function ru(t,e){return e[+(e.left===t.site)]}var iu,ou=[];function su(){ql(this),this.x=this.y=this.arc=this.site=this.cy=null}function au(t){var e=t.P,n=t.N;if(e&&n){var r=e.site,i=t.site,o=n.site;if(r!==o){var s=i[0],a=i[1],l=r[0]-s,u=r[1]-a,c=o[0]-s,h=o[1]-a,p=2*(l*h-u*c);if(!(p>=-xu)){var f=l*l+u*u,d=c*c+h*h,g=(h*f-u*d)/p,m=(l*d-c*f)/p,A=ou.pop()||new su;A.arc=t,A.site=i,A.x=g+s,A.y=(A.cy=m+a)+Math.sqrt(g*g+m*m),t.circle=A;for(var y=null,_=_u._;_;)if(A.y<_.y||A.y===_.y&&A.x<=_.x){if(!_.L){y=_.P;break}_=_.L}else{if(!_.R){y=_;break}_=_.R}_u.insert(y,A),y||(iu=A)}}}}function lu(t){var e=t.circle;e&&(e.P||(iu=e.N),_u.remove(e),ou.push(e),ql(e),t.circle=null)}var uu=[];function cu(){ql(this),this.edge=this.site=this.circle=null}function hu(t){var e=uu.pop()||new cu;return e.site=t,e}function pu(t){lu(t),Au.remove(t),uu.push(t),ql(t)}function fu(t){var e=t.circle,n=e.x,r=e.cy,i=[n,r],o=t.P,s=t.N,a=[t];pu(t);for(var l=o;l.circle&&Math.abs(n-l.circle.x)<bu&&Math.abs(r-l.circle.cy)<bu;)o=l.P,a.unshift(l),pu(l),l=o;a.unshift(l),lu(l);for(var u=s;u.circle&&Math.abs(n-u.circle.x)<bu&&Math.abs(r-u.circle.cy)<bu;)s=u.N,a.push(u),pu(u),u=s;a.push(u),lu(u);var c,h=a.length;for(c=1;c<h;++c)u=a[c],l=a[c-1],Kl(u.edge,l.site,u.site,i);l=a[0],(u=a[h-1]).edge=Yl(l.site,u.site,null,i),au(l),au(u)}function du(t){for(var e,n,r,i,o=t[0],s=t[1],a=Au._;a;)if((r=gu(a,s)-o)>bu)a=a.L;else{if(!((i=o-mu(a,s))>bu)){r>-bu?(e=a.P,n=a):i>-bu?(e=a,n=a.N):e=n=a;break}if(!a.R){e=a;break}a=a.R}!function(t){yu[t.index]={site:t,halfedges:[]}}(t);var l=hu(t);if(Au.insert(e,l),e||n){if(e===n)return lu(e),n=hu(e.site),Au.insert(l,n),l.edge=n.edge=Yl(e.site,l.site),au(e),void au(n);if(n){lu(e),lu(n);var u=e.site,c=u[0],h=u[1],p=t[0]-c,f=t[1]-h,d=n.site,g=d[0]-c,m=d[1]-h,A=2*(p*m-f*g),y=p*p+f*f,_=g*g+m*m,v=[(m*y-f*_)/A+c,(p*_-g*y)/A+h];Kl(n.edge,u,d,v),l.edge=Yl(u,t,null,v),n.edge=Yl(t,d,null,v),au(e),au(n)}else l.edge=Yl(e.site,l.site)}}function gu(t,e){var n=t.site,r=n[0],i=n[1],o=i-e;if(!o)return r;var s=t.P;if(!s)return-1/0;var a=(n=s.site)[0],l=n[1],u=l-e;if(!u)return a;var c=a-r,h=1/o-1/u,p=c/u;return h?(-p+Math.sqrt(p*p-2*h*(c*c/(-2*u)-l+u/2+i-o/2)))/h+r:(r+a)/2}function mu(t,e){var n=t.N;if(n)return gu(n,e);var r=t.site;return r[1]===e?r[0]:1/0}var Au,yu,_u,vu,bu=1e-6,xu=1e-12;function wu(t,e){return e[1]-t[1]||e[0]-t[0]}function Eu(t,e){var n,r,i,o=t.sort(wu).pop();for(vu=[],yu=new Array(t.length),Au=new $l,_u=new $l;;)if(i=iu,o&&(!i||o[1]<i.y||o[1]===i.y&&o[0]<i.x))o[0]===n&&o[1]===r||(du(o),n=o[0],r=o[1]),o=t.pop();else{if(!i)break;fu(i.arc)}if(function(){for(var t,e,n,r,i=0,o=yu.length;i<o;++i)if((t=yu[i])&&(r=(e=t.halfedges).length)){var s=new Array(r),a=new Array(r);for(n=0;n<r;++n)s[n]=n,a[n]=eu(t,vu[e[n]]);for(s.sort((function(t,e){return a[e]-a[t]})),n=0;n<r;++n)a[n]=e[s[n]];for(n=0;n<r;++n)e[n]=a[n]}}(),e){var s=+e[0][0],a=+e[0][1],l=+e[1][0],u=+e[1][1];!function(t,e,n,r){for(var i,o=vu.length;o--;)tu(i=vu[o],t,e,n,r)&&Jl(i,t,e,n,r)&&(Math.abs(i[0][0]-i[1][0])>bu||Math.abs(i[0][1]-i[1][1])>bu)||delete vu[o]}(s,a,l,u),function(t,e,n,r){var i,o,s,a,l,u,c,h,p,f,d,g,m=yu.length,A=!0;for(i=0;i<m;++i)if(o=yu[i]){for(s=o.site,a=(l=o.halfedges).length;a--;)vu[l[a]]||l.splice(a,1);for(a=0,u=l.length;a<u;)d=(f=ru(o,vu[l[a]]))[0],g=f[1],h=(c=nu(o,vu[l[++a%u]]))[0],p=c[1],(Math.abs(d-h)>bu||Math.abs(g-p)>bu)&&(l.splice(a,0,vu.push(Ql(s,f,Math.abs(d-t)<bu&&r-g>bu?[t,Math.abs(h-t)<bu?p:r]:Math.abs(g-r)<bu&&n-d>bu?[Math.abs(p-r)<bu?h:n,r]:Math.abs(d-n)<bu&&g-e>bu?[n,Math.abs(h-n)<bu?p:e]:Math.abs(g-e)<bu&&d-t>bu?[Math.abs(p-e)<bu?h:t,e]:null))-1),++u);u&&(A=!1)}if(A){var y,_,v,b=1/0;for(i=0,A=null;i<m;++i)(o=yu[i])&&(v=(y=(s=o.site)[0]-t)*y+(_=s[1]-e)*_)<b&&(b=v,A=o);if(A){var x=[t,e],w=[t,r],E=[n,r],S=[n,e];A.halfedges.push(vu.push(Ql(s=A.site,x,w))-1,vu.push(Ql(s,w,E))-1,vu.push(Ql(s,E,S))-1,vu.push(Ql(s,S,x))-1)}}for(i=0;i<m;++i)(o=yu[i])&&(o.halfedges.length||delete yu[i])}(s,a,l,u)}this.edges=vu,this.cells=yu,Au=_u=vu=yu=null}function Su(t){return(t=t.slice()).push(t[0]),Yn([t])}Eu.prototype={constructor:Eu,polygons:function(){var t=this.edges;return this.cells.map((function(e){var n=e.halfedges.map((function(n){return nu(e,t[n])}));return n.data=e.site.data,n}))},triangles:function(){var t=[],e=this.edges;return this.cells.forEach((function(n,r){if(o=(i=n.halfedges).length)for(var i,o,s,a,l,u,c=n.site,h=-1,p=e[i[o-1]],f=p.left===c?p.right:p.left;++h<o;)s=f,f=(p=e[i[h]]).left===c?p.right:p.left,s&&f&&r<s.index&&r<f.index&&(l=s,u=f,((a=c)[0]-u[0])*(l[1]-a[1])-(a[0]-l[0])*(u[1]-a[1])<0)&&t.push([c.data,s.data,f.data])})),t},links:function(){return this.edges.filter((function(t){return t.right})).map((function(t){return{source:t.left.data,target:t.right.data}}))},find:function(t,e,n){for(var r,i,o=this,s=o._found||0,a=o.cells.length;!(i=o.cells[s]);)if(++s>=a)return null;var l=t-i.site[0],u=e-i.site[1],c=l*l+u*u;do{i=o.cells[r=s],s=null,i.halfedges.forEach((function(n){var r=o.edges[n],a=r.left;if(a!==i.site&&a||(a=r.right)){var l=t-a[0],u=e-a[1],h=l*l+u*u;h<c&&(c=h,s=a.index)}}))}while(null!==s);return o._found=r,null==n||c<=n*n?i.site:null}};const Tu=function(t,e){if(!gr(e=e||{}))throw new Error("options is invalid");var n=e.bbox||[-180,-85,180,85];if(!t)throw new Error("points is required");if(!Array.isArray(n))throw new Error("bbox is invalid");return Vr(t,"Point","points"),tr(function(){var t=Vl,e=Gl,n=null;function r(r){return new Eu(r.map((function(n,i){var o=[Math.round(t(n,i,r)/bu)*bu,Math.round(e(n,i,r)/bu)*bu];return o.index=i,o.data=n,o})),n)}return r.polygons=function(t){return r(t).polygons()},r.links=function(t){return r(t).links()},r.triangles=function(t){return r(t).triangles()},r.x=function(e){return arguments.length?(t="function"==typeof e?e:Ul(+e),r):t},r.y=function(t){return arguments.length?(e="function"==typeof t?t:Ul(+t),r):e},r.extent=function(t){return arguments.length?(n=null==t?null:[[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]],r):n&&[[n[0][0],n[0][1]],[n[1][0],n[1][1]]]},r.size=function(t){return arguments.length?(n=null==t?null:[[0,0],[+t[0],+t[1]]],r):n&&[n[1][0]-n[0][0],n[1][1]-n[0][1]]},r}().x((function(t){return t.geometry.coordinates[0]})).y((function(t){return t.geometry.coordinates[1]})).extent([[n[0],n[1]],[n[2],n[3]]]).polygons(t.features).map(Su))};function Pu(t){var e=t*Math.PI/180;return Math.tan(e)}const Mu=function(t,e,n,r){var i=(r=r||{}).steps||64,o=r.units||"kilometers",s=r.angle||0,a=r.pivot||t,l=r.properties||t.properties||{};if(!t)throw new Error("center is required");if(!e)throw new Error("xSemiAxis is required");if(!n)throw new Error("ySemiAxis is required");if(!gr(r))throw new Error("options must be an object");if(!dr(i))throw new Error("steps must be a number");if(!dr(s))throw new Error("angle must be a number");var u=Fr(t);if("degrees"===o)var c=hr(s);else e=Bs(t,e,90,{units:o}),n=Bs(t,n,0,{units:o}),e=Fr(e)[0]-u[0],n=Fr(n)[1]-u[1];for(var h=[],p=0;p<i;p+=1){var f=-360*p/i,d=e*n/Math.sqrt(Math.pow(n,2)+Math.pow(e,2)*Math.pow(Pu(f),2)),g=e*n/Math.sqrt(Math.pow(e,2)+Math.pow(n,2)/Math.pow(Pu(f),2));if(f<-90&&f>=-270&&(d=-d),f<-180&&f>=-360&&(g=-g),"degrees"===o){var m=d*Math.cos(c)+g*Math.sin(c),A=g*Math.cos(c)-d*Math.sin(c);d=m,g=A}h.push([d+u[0],g+u[1]])}return h.push(h[0]),"degrees"===o?Yn([h],l):$a(Yn([h],l),s,{pivot:a})},Cu=function(t,e){void 0===e&&(e={});var n=0,r=0,i=0;return Sr(t,(function(t,o,s){var a=e.weight?null==s?void 0:s[e.weight]:void 0;if(!dr(a=null==a?1:a))throw new Error("weight value must be a number for feature index "+o);(a=Number(a))>0&&yr(t,(function(t){n+=t[0]*a,r+=t[1]*a,i+=a}))})),Xn([n/i,r/i],e.properties,e)};function Iu(t,e,n,r,i){var o=r.tolerance||.001,s=0,a=0,l=0,u=0;if(xr(n,(function(e){var n,r=null===(n=e.properties)||void 0===n?void 0:n.weight,i=null==r?1:r;if(!dr(i=Number(i)))throw new Error("weight value must be a number");if(i>0){u+=1;var o=i*oi(e,t);0===o&&(o=1);var c=i/o;s+=e.geometry.coordinates[0]*c,a+=e.geometry.coordinates[1]*c,l+=c}})),u<1)throw new Error("no features to measure");var c=s/l,h=a/l;return 1===u||0===i||Math.abs(c-e[0])<o&&Math.abs(h-e[1])<o?Xn([c,h],{medianCandidates:r.medianCandidates}):(r.medianCandidates.push([c,h]),Iu([c,h],t,n,r,i-1))}const Ou=function(t,e){if(void 0===e&&(e={}),!gr(e=e||{}))throw new Error("options is invalid");var n=e.counter||10;if(!dr(n))throw new Error("counter must be a number");var r=e.weight,i=Cu(t,{weight:e.weight}),o=tr([]);xr(t,(function(t){var e;o.features.push(uo(t,{properties:{weight:null===(e=t.properties)||void 0===e?void 0:e[r]}}))}));var s={tolerance:e.tolerance,medianCandidates:[]};return Iu(i.geometry.coordinates,[0,0],o,s,n)};function Ru(t,e){return{x:t[0]-e[0],y:t[1]-e[1]}}const Lu=function(t,e){if(!gr(e=e||{}))throw new Error("options is invalid");var n=e.steps||64,r=e.weight,i=e.properties||{};if(!dr(n))throw new Error("steps must be a number");if(!gr(i))throw new Error("properties must be a number");var o=Er(t).length,s=Cu(t,{weight:r}),a=0,l=0,u=0;xr(t,(function(t){var e=t.properties[r]||1,n=Ru(Br(t),Br(s));a+=Math.pow(n.x,2)*e,l+=Math.pow(n.y,2)*e,u+=n.x*n.y*e}));var c=a-l,h=Math.sqrt(Math.pow(c,2)+4*Math.pow(u,2)),p=2*u,f=Math.atan((c+h)/p),d=180*f/Math.PI,g=0,m=0,A=0;xr(t,(function(t){var e=t.properties[r]||1,n=Ru(Br(t),Br(s));g+=Math.pow(n.x*Math.cos(f)-n.y*Math.sin(f),2)*e,m+=Math.pow(n.x*Math.sin(f)+n.y*Math.cos(f),2)*e,A+=e}));var y=Math.sqrt(2*g/A),_=Math.sqrt(2*m/A),v=Mu(s,y,_,{units:"degrees",angle:d,steps:n,properties:i}),b=ii(t,tr([v])),x={meanCenterCoordinates:Br(s),semiMajorAxis:y,semiMinorAxis:_,numberOfFeatures:o,angle:d,percentageWithinEllipse:100*Er(b).length/o};return v.properties.standardDeviationalEllipse=x,v},ku=function(t,e,n,r){if(void 0===r&&(r={}),!gr(r))throw new Error("options is invalid");if(!t)throw new Error("startPoint is required");if(!e)throw new Error("midPoint is required");if(!n)throw new Error("endPoint is required");var i=t,o=e,s=n,a=ur(!0!==r.mercator?so(i,o):Fs(i,o)),l=ur(!0!==r.mercator?so(s,o):Fs(s,o)),u=Math.abs(a-l);return!0===r.explementary?360-u:u};function Du(t,e){var n=0,r=0;yr(t,(function(i,o,s,a,l){l>n&&(n=l,r=o,e.push([]));var u=o-r,c=t.coordinates[l][u+1],h=i[0],p=i[1],f=c[0],d=c[1];e[l].push([.75*h+.25*f,.75*p+.25*d]),e[l].push([.25*h+.75*f,.25*p+.75*d])}),!0),e.forEach((function(t){t.push(t[0])}))}function Nu(t,e){var n=0,r=0,i=0;yr(t,(function(o,s,a,l,u){l>i&&(i=l,r=s,e.push([[]])),u>n&&(n=u,r=s,e[l].push([]));var c=s-r,h=t.coordinates[l][u][c+1],p=o[0],f=o[1],d=h[0],g=h[1];e[l][u].push([.75*p+.25*d,.75*f+.25*g]),e[l][u].push([.25*p+.75*d,.25*f+.75*g])}),!0),e.forEach((function(t){t.forEach((function(t){t.push(t[0])}))}))}const Fu=function(t,e){var n=[],r=e.iterations||1;if(!t)throw new Error("inputPolys is required");return Sr(t,(function(t,e,i){var o,s,a;switch(t.type){case"Polygon":o=[[]];for(var l=0;l<r;l++)a=[[]],s=t,l>0&&(s=Yn(o).geometry),Du(s,a),o=a.slice(0);n.push(Yn(o,i));break;case"MultiPolygon":o=[[[]]];for(var u=0;u<r;u++)a=[[[]]],s=t,u>0&&(s=rr(o).geometry),Nu(s,a),o=a.slice(0);n.push(rr(o,i));break;default:throw new Error("geometry is invalid, must be Polygon or MultiPolygon")}})),tr(n)};function Bu(t,e,n){void 0===n&&(n=2);var r=Fr(t),i=Fr(e),o=r[0]-i[0],s=r[1]-i[1];return 1===n?Math.abs(o)+Math.abs(s):Math.pow(Math.pow(o,n)+Math.pow(s,n),1/n)}function zu(t,e){var n=(e=e||{}).threshold||1e4,r=e.p||2,i=e.binary||!1,o=e.alpha||-1,s=e.standardization||!1,a=[];xr(t,(function(t){a.push(uo(t))}));for(var l=[],u=0;u<a.length;u++)l[u]=[];for(u=0;u<a.length;u++)for(var c=u;c<a.length;c++){u===c&&(l[u][c]=0);var h=Bu(a[u],a[c],r);l[u][c]=h,l[c][u]=h}for(u=0;u<a.length;u++)for(c=0;c<a.length;c++)0!==(h=l[u][c])&&(l[u][c]=i?h<=n?1:0:h<=n?Math.pow(h,o):0);if(s)for(u=0;u<a.length;u++){var p=l[u].reduce((function(t,e){return t+e}),0);for(c=0;c<a.length;c++)l[u][c]=l[u][c]/p}return l}function ju(t,e){var n=e.inputField,r=e.threshold||1e5,i=e.p||2,o=e.binary||!1,s=zu(t,{alpha:e.alpha||-1,binary:o,p:i,standardization:e.standardization||!0,threshold:r}),a=[];xr(t,(function(t){var e=t.properties||{};a.push(e[n])}));for(var l=Uu(a),u=function(t){for(var e=Uu(t),n=0,r=0,i=t;r<i.length;r++){var o=i[r];n+=Math.pow(o-e,2)}return n/t.length}(a),c=0,h=0,p=0,f=0,d=s.length,g=0;g<d;g++){for(var m=0,A=0;A<d;A++)c+=s[g][A]*(a[g]-l)*(a[A]-l),h+=s[g][A],p+=Math.pow(s[g][A]+s[A][g],2),m+=s[g][A]+s[A][g];f+=Math.pow(m,2)}var y=c/h/u,_=-1/(d-1),v=(d*d*(p*=.5)-d*f+h*h*3)/((d-1)*(d+1)*(h*h))-_*_,b=Math.sqrt(v);return{expectedMoranIndex:_,moranIndex:y,stdNorm:b,zNorm:(y-_)/b}}function Uu(t){for(var e=0,n=0,r=t;n<r.length;n++)e+=r[n];return e/t.length}function Vu(t,e){return void 0===e&&(e={}),Zu(t,"mercator",e)}function Gu(t,e){return void 0===e&&(e={}),Zu(t,"wgs84",e)}function Zu(t,e,n){void 0===n&&(n={});var r=(n=n||{}).mutate;if(!t)throw new Error("geojson is required");return Array.isArray(t)&&dr(t[0])?t="mercator"===e?qu(t):Wu(t):(!0!==r&&(t=di(t)),yr(t,(function(t){var n="mercator"===e?qu(t):Wu(t);t[0]=n[0],t[1]=n[1]}))),t}function qu(t){var e,n=Math.PI/180,r=6378137,i=20037508.342789244,o=[r*(Math.abs(t[0])<=180?t[0]:t[0]-360*((e=t[0])<0?-1:e>0?1:0))*n,r*Math.log(Math.tan(.25*Math.PI+.5*t[1]*n))];return o[0]>i&&(o[0]=i),o[0]<-i&&(o[0]=-i),o[1]>i&&(o[1]=i),o[1]<-i&&(o[1]=-i),o}function Wu(t){var e=180/Math.PI,n=6378137;return[t[0]*e/n,(.5*Math.PI-2*Math.atan(Math.exp(-t[1]/n)))*e]}function Hu(t){return Array.isArray(t)?Ku(t):t&&t.bbox?Ku(t.bbox):[360*Qu(),180*Qu()]}function Xu(t,e){void 0===e&&(e={}),null==t&&(t=1);for(var n=[],r=0;r<t;r++)n.push(Xn(Hu(e.bbox)));return tr(n)}function $u(t,e){void 0===e&&(e={}),null==t&&(t=1),dr(e.num_vertices)&&void 0!==e.num_vertices||(e.num_vertices=10),dr(e.max_radial_length)&&void 0!==e.max_radial_length||(e.max_radial_length=10);for(var n=[],r=function(t){var r,i=[],o=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}(Array(e.num_vertices+1)).map(Math.random);o.forEach((function(t,e,n){n[e]=e>0?t+n[e-1]:t})),o.forEach((function(t){t=2*t*Math.PI/o[o.length-1];var n=Math.random();i.push([n*(e.max_radial_length||10)*Math.sin(t),n*(e.max_radial_length||10)*Math.cos(t)])})),i[i.length-1]=i[0],i=i.map((r=Hu(e.bbox),function(t){return[t[0]+r[0],t[1]+r[1]]})),n.push(Yn([i]))},i=0;i<t;i++)r();return tr(n)}function Yu(t,e){if(void 0===e&&(e={}),!gr(e=e||{}))throw new Error("options is invalid");var n=e.bbox,r=e.num_vertices,i=e.max_length,o=e.max_rotation;null==t&&(t=1),(!dr(r)||void 0===r||r<2)&&(r=10),dr(i)&&void 0!==i||(i=1e-4),dr(o)&&void 0!==o||(o=Math.PI/8);for(var s=[],a=0;a<t;a++){for(var l=[Hu(n)],u=0;u<r-1;u++){var c=(0===u?2*Math.random()*Math.PI:Math.tan((l[u][1]-l[u-1][1])/(l[u][0]-l[u-1][0])))+(Math.random()-.5)*o*2,h=Math.random()*i;l.push([l[u][0]+h*Math.cos(c),l[u][1]+h*Math.sin(c)])}s.push(Kn(l))}return tr(s)}function Qu(){return Math.random()-.5}function Ku(t){return[Math.random()*(t[2]-t[0])+t[0],Math.random()*(t[3]-t[1])+t[1]]}function Ju(t,e){if(!t)throw new Error("geojson is required");if("FeatureCollection"!==t.type)throw new Error("geojson must be a FeatureCollection");if(null==e)throw new Error("filter is required");var n=[];return xr(t,(function(t){rc(t.properties,e)&&n.push(t)})),tr(n)}function tc(t,e,n){if(!t)throw new Error("geojson is required");if("FeatureCollection"!==t.type)throw new Error("geojson must be a FeatureCollection");if(null==e)throw new Error("property is required");for(var r=nc(t,e),i=Object.keys(r),o=0;o<i.length;o++){for(var s=i[o],a=r[s],l=[],u=0;u<a.length;u++)l.push(t.features[a[u]]);n(tr(l),s,o)}}function ec(t,e,n,r){var i=r;return tc(t,e,(function(t,e,o){i=0===o&&void 0===r?t:n(i,t,e,o)})),i}function nc(t,e){var n={};return xr(t,(function(t,r){var i=t.properties||{};if(Object.prototype.hasOwnProperty.call(i,String(e))){var o=i[e];Object.prototype.hasOwnProperty.call(n,o)?n[o].push(r):n[o]=[r]}})),n}function rc(t,e){if(void 0===t)return!1;var n=typeof e;if("number"===n||"string"===n)return Object.prototype.hasOwnProperty.call(t,e);if(Array.isArray(e)){for(var r=0;r<e.length;r++)if(!rc(t,e[r]))return!1;return!0}return ic(t,e)}function ic(t,e){for(var n=Object.keys(e),r=0;r<n.length;r++){var i=n[r];if(t[i]!==e[i])return!1}return!0}function oc(t,e){if(!e)return{};if(!e.length)return{};for(var n={},r=0;r<e.length;r++){var i=e[r];Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n}var sc=n(2676);const ac=function(t,e){var n=Gr(t),r=Gr(e),i=t.properties||{},o=sc.difference(n.coordinates,r.coordinates);return 0===o.length?null:1===o.length?Yn(o[0],i):rr(o,i)};var lc=n(675),uc=n(1621);function cc(t,e,n,r){var i=t.properties||{},o="Feature"===t.type?t.geometry:t;if("GeometryCollection"===o.type){var s=[];return Sr(t,(function(t){var i=cc(t,e,n,r);i&&s.push(i)})),tr(s)}var a=function(t){var e=lo(t).geometry.coordinates,n=[-e[0],-e[1]];return(0,uc.geoAzimuthalEquidistant)().rotate(n).scale(Vn)}(o),l={type:o.type,coordinates:pc(o.coordinates,a)},u=(new lc.GeoJSONReader).read(l),c=sr(ar(e,n),"meters"),h=lc.BufferOp.bufferOp(u,c,r);if(!hc((h=(new lc.GeoJSONWriter).write(h)).coordinates))return Wn({type:h.type,coordinates:fc(h.coordinates,a)},i)}function hc(t){return Array.isArray(t[0])?hc(t[0]):isNaN(t[0])}function pc(t,e){return"object"!=typeof t[0]?e(t):t.map((function(t){return pc(t,e)}))}function fc(t,e){return"object"!=typeof t[0]?e.invert(t):t.map((function(t){return fc(t,e)}))}const dc=function(t,e,n){var r=(n=n||{}).units||"kilometers",i=n.steps||8;if(!t)throw new Error("geojson is required");if("object"!=typeof n)throw new Error("options must be an object");if("number"!=typeof i)throw new Error("steps must be an number");if(void 0===e)throw new Error("radius is required");if(i<=0)throw new Error("steps must be greater than 0");var o=[];switch(t.type){case"GeometryCollection":return Sr(t,(function(t){var n=cc(t,e,r,i);n&&o.push(n)})),tr(o);case"FeatureCollection":return xr(t,(function(t){var n=cc(t,e,r,i);n&&xr(n,(function(t){t&&o.push(t)}))})),tr(o)}return cc(t,e,r,i)},gc=function(t,e,n){void 0===n&&(n={});var r=Gr(t),i=Gr(e),o=sc.union(r.coordinates,i.coordinates);return 0===o.length?null:1===o.length?Yn(o[0],n.properties):rr(o,n.properties)};function mc(t,e,n){void 0===n&&(n={});var r=Gr(t),i=Gr(e),o=sc.intersection(r.coordinates,i.coordinates);return 0===o.length?null:1===o.length?Yn(o[0],n.properties):rr(o,n.properties)}const Ac=function(t,e){if(!gr(e=e||{}))throw new Error("options is invalid");var n=e.propertyName;Vr(t,"Polygon","dissolve");var r=[];if(!e.propertyName)return Xo(rr(sc.union.apply(null,t.features.map((function(t){return t.geometry.coordinates})))));var i={};xr(t,(function(t){Object.prototype.hasOwnProperty.call(i,t.properties[n])||(i[t.properties[n]]=[]),i[t.properties[n]].push(t)}));for(var o=Object.keys(i),s=0;s<o.length;s++){var a=rr(sc.union.apply(null,i[o[s]].map((function(t){return t.geometry.coordinates}))));a.properties[n]=o[s],r.push(a)}return Xo(tr(r))};function yc(t,e,n,r,i,o){for(var s=[],a=0;a<6;a++){var l=t[0]+e*i[a],u=t[1]+n*o[a];s.push([l,u])}return s.push(s[0].slice()),Yn([s],r)}function _c(t,e,n,r,i,o){for(var s=[],a=0;a<6;a++){var l=[];l.push(t),l.push([t[0]+e*i[a],t[1]+n*o[a]]),l.push([t[0]+e*i[(a+1)%6],t[1]+n*o[(a+1)%6]]),l.push(t),s.push(Yn([l],r))}return s}const vc=function(t,e,n){void 0===n&&(n={});var r=JSON.stringify(n.properties||{}),i=t[0],o=t[1],s=t[2],a=t[3],l=(o+a)/2,u=(i+s)/2,c=2*e/oi([i,l],[s,l],n)*(s-i),h=2*e/oi([u,o],[u,a],n)*(a-o),p=c/2,f=2*p,d=Math.sqrt(3)/2*h,g=s-i,m=a-o,A=3/4*f,y=d,_=(g-f)/(f-p/2),v=Math.floor(_),b=(v*A-p/2-g)/2-p/2+A/2,x=Math.floor((m-d)/d),w=(m-x*d)/2,E=x*d-m>d/2;E&&(w-=d/4);for(var S=[],T=[],P=0;P<6;P++){var M=2*Math.PI/6*P;S.push(Math.cos(M)),T.push(Math.sin(M))}for(var C=[],I=0;I<=v;I++)for(var O=0;O<=x;O++){var R=I%2==1;if(!(0===O&&R||0===O&&E)){var L=I*A+i-b,k=O*y+o+w;if(R&&(k-=d/2),!0===n.triangles)_c([L,k],c/2,h/2,JSON.parse(r),S,T).forEach((function(t){n.mask?mc(n.mask,t)&&C.push(t):C.push(t)}));else{var D=yc([L,k],c/2,h/2,JSON.parse(r),S,T);n.mask?mc(n.mask,D)&&C.push(D):C.push(D)}}}return tr(C)};function bc(t){return rr(t)}function xc(t){return Yn(t&&t.geometry.coordinates||[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]])}const wc=function(t,e){var n,r=xc(e);return("FeatureCollection"===t.type?bc(2===(n=t).features.length?sc.union(n.features[0].geometry.coordinates,n.features[1].geometry.coordinates):sc.union.apply(sc,n.features.map((function(t){return t.geometry.coordinates})))):bc(sc.union(t.geometry.coordinates))).geometry.coordinates.forEach((function(t){r.geometry.coordinates.push(t[0])})),r};function Ec(t,e,n){return void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={});for(var i=[],o=t[0],s=t[1],a=t[2],l=t[3],u=e/oi([o,s],[a,s],r)*(a-o),c=n/oi([o,s],[o,l],r)*(l-s),h=a-o,p=l-s,f=Math.floor(h/u),d=Math.floor(p/c),g=(p-d*c)/2,m=o+(h-f*u)/2,A=0;A<f;A++){for(var y=s+g,_=0;_<d;_++){var v=Yn([[[m,y],[m,y+c],[m+u,y+c],[m+u,y],[m,y]]],r.properties);r.mask?Tl(r.mask,v)&&i.push(v):i.push(v),y+=c}m+=u}return tr(i)}(t,e,e,n)}const Sc=function(t,e,n){void 0===n&&(n={});for(var r=[],i=e/oi([t[0],t[1]],[t[2],t[1]],n)*(t[2]-t[0]),o=e/oi([t[0],t[1]],[t[0],t[3]],n)*(t[3]-t[1]),s=0,a=t[0];a<=t[2];){for(var l=0,u=t[1];u<=t[3];){var c=null,h=null;s%2==0&&l%2==0?(c=Yn([[[a,u],[a,u+o],[a+i,u],[a,u]]],n.properties),h=Yn([[[a,u+o],[a+i,u+o],[a+i,u],[a,u+o]]],n.properties)):s%2==0&&l%2==1?(c=Yn([[[a,u],[a+i,u+o],[a+i,u],[a,u]]],n.properties),h=Yn([[[a,u],[a,u+o],[a+i,u+o],[a,u]]],n.properties)):l%2==0&&s%2==1?(c=Yn([[[a,u],[a,u+o],[a+i,u+o],[a,u]]],n.properties),h=Yn([[[a,u],[a+i,u+o],[a+i,u],[a,u]]],n.properties)):l%2==1&&s%2==1&&(c=Yn([[[a,u],[a,u+o],[a+i,u],[a,u]]],n.properties),h=Yn([[[a,u+o],[a+i,u+o],[a+i,u],[a,u+o]]],n.properties)),n.mask?(mc(n.mask,c)&&r.push(c),mc(n.mask,h)&&r.push(h)):(r.push(c),r.push(h)),u+=o,l++}s++,a+=i}return tr(r)},Tc=function(t,e,n){if("object"!=typeof(n=n||{}))throw new Error("options is invalid");var r=n.gridType,i=n.property,o=n.weight;if(!t)throw new Error("points is required");if(Vr(t,"Point","input must contain Points"),!e)throw new Error("cellSize is required");if(void 0!==o&&"number"!=typeof o)throw new Error("weight must be a number");i=i||"elevation",r=r||"square",o=o||1;var s,a=Nr(t);switch(r){case"point":case"points":s=Wo(a,e,n);break;case"square":case"squares":s=Ec(a,e,n);break;case"hex":case"hexes":s=vc(a,e,n);break;case"triangle":case"triangles":s=Sc(a,e,n);break;default:throw new Error("invalid gridType")}var l=[];return xr(s,(function(e){var s=0,a=0;xr(t,(function(t){var l,u="point"===r?e:uo(e),c=oi(u,t,n);if(void 0!==i&&(l=t.properties[i]),void 0===l&&(l=t.geometry.coordinates[2]),void 0===l)throw new Error("zValue is missing");0===c&&(s=l);var h=1/Math.pow(c,o);a+=h,s+=h*l}));var u=di(e);u.properties[i]=s/a,l.push(u)})),tr(l)};function Pc(t){return null!==t&&"object"==typeof t&&t.constructor===Object}function Mc(t,e,n={clone:!0}){const r=n.clone?E({},t):t;return Pc(t)&&Pc(e)&&Object.keys(e).forEach((i=>{"__proto__"!==i&&(Pc(e[i])&&i in t&&Pc(t[i])?r[i]=Mc(t[i],e[i],n):r[i]=e[i])})),r}const Cc=["values","unit","step"],Ic={borderRadius:4},Oc={xs:0,sm:600,md:900,lg:1200,xl:1536},Rc={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${Oc[t]}px)`};function Lc(t,e,n){const r=t.theme||{};if(Array.isArray(e)){const t=r.breakpoints||Rc;return e.reduce(((r,i,o)=>(r[t.up(t.keys[o])]=n(e[o]),r)),{})}if("object"==typeof e){const t=r.breakpoints||Rc;return Object.keys(e).reduce(((r,i)=>{if(-1!==Object.keys(t.values||Oc).indexOf(i))r[t.up(i)]=n(e[i],i);else{const t=i;r[t]=e[t]}return r}),{})}return n(e)}function kc(t){let e="https://mui.com/production-error/?code="+t;for(let t=1;t<arguments.length;t+=1)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified MUI error #"+t+"; visit "+e+" for the full message."}function Dc(t){if("string"!=typeof t)throw new Error(kc(7));return t.charAt(0).toUpperCase()+t.slice(1)}function Nc(t,e){return e&&"string"==typeof e?e.split(".").reduce(((t,e)=>t&&t[e]?t[e]:null),t):null}function Fc(t,e,n,r=n){let i;return i="function"==typeof t?t(n):Array.isArray(t)?t[n]||r:Nc(t,n)||r,e&&(i=e(i)),i}const Bc=function(t){const{prop:e,cssProperty:n=t.prop,themeKey:r,transform:i}=t,o=t=>{if(null==t[e])return null;const o=t[e],s=Nc(t.theme,r)||{};return Lc(t,o,(t=>{let r=Fc(s,i,t);return t===r&&"string"==typeof t&&(r=Fc(s,i,`${e}${"default"===t?"":Dc(t)}`,t)),!1===n?r:{[n]:r}}))};return o.propTypes={},o.filterProps=[e],o},zc=function(t,e){return e?Mc(t,e,{clone:!1}):t},jc={m:"margin",p:"padding"},Uc={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},Vc={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Gc=function(t){const e={};return t=>(void 0===e[t]&&(e[t]=(t=>{if(t.length>2){if(!Vc[t])return[t];t=Vc[t]}const[e,n]=t.split(""),r=jc[e],i=Uc[n]||"";return Array.isArray(i)?i.map((t=>r+t)):[r+i]})(t)),e[t])}(),Zc=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],qc=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],Wc=[...Zc,...qc];function Hc(t,e,n,r){const i=Nc(t,e)||n;return"number"==typeof i?t=>"string"==typeof t?t:i*t:Array.isArray(i)?t=>"string"==typeof t?t:i[t]:"function"==typeof i?i:()=>{}}function Xc(t){return Hc(t,"spacing",8)}function $c(t,e){if("string"==typeof e||null==e)return e;const n=t(Math.abs(e));return e>=0?n:"number"==typeof n?-n:`-${n}`}function Yc(t,e){const n=Xc(t.theme);return Object.keys(t).map((r=>function(t,e,n,r){if(-1===e.indexOf(n))return null;const i=function(t,e){return n=>t.reduce(((t,r)=>(t[r]=$c(e,n),t)),{})}(Gc(n),r);return Lc(t,t[n],i)}(t,e,r,n))).reduce(zc,{})}function Qc(t){return Yc(t,Zc)}function Kc(t){return Yc(t,qc)}function Jc(t){return Yc(t,Wc)}Qc.propTypes={},Qc.filterProps=Zc,Kc.propTypes={},Kc.filterProps=qc,Jc.propTypes={},Jc.filterProps=Wc;const th=Jc,eh=["breakpoints","palette","spacing","shape"],nh=function(t={},...e){const{breakpoints:n={},palette:r={},spacing:i,shape:o={}}=t,s=Ne(t,eh),a=function(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5}=t,i=Ne(t,Cc),o=Object.keys(e);function s(t){return`@media (min-width:${"number"==typeof e[t]?e[t]:t}${n})`}function a(t,i){const s=o.indexOf(i);return`@media (min-width:${"number"==typeof e[t]?e[t]:t}${n}) and (max-width:${(-1!==s&&"number"==typeof e[o[s]]?e[o[s]]:i)-r/100}${n})`}return E({keys:o,values:e,up:s,down:function(t){return`@media (max-width:${("number"==typeof e[t]?e[t]:t)-r/100}${n})`},between:a,only:function(t){return o.indexOf(t)+1<o.length?a(t,o[o.indexOf(t)+1]):s(t)},unit:n},i)}(n),l=function(t=8){if(t.mui)return t;const e=Xc({spacing:t}),n=(...t)=>(0===t.length?[1]:t).map((t=>{const n=e(t);return"number"==typeof n?`${n}px`:n})).join(" ");return n.mui=!0,n}(i);let u=Mc({breakpoints:a,direction:"ltr",components:{},palette:E({mode:"light"},r),spacing:l,shape:E({},Ic,o)},s);return u=e.reduce(((t,e)=>Mc(t,e)),u),u};function rh(t,e=0,n=1){return Math.min(Math.max(e,t),n)}function ih(t){if(t.type)return t;if("#"===t.charAt(0))return ih(function(t){t=t.substr(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let n=t.match(e);return n&&1===n[0].length&&(n=n.map((t=>t+t))),n?`rgb${4===n.length?"a":""}(${n.map(((t,e)=>e<3?parseInt(t,16):Math.round(parseInt(t,16)/255*1e3)/1e3)).join(", ")})`:""}(t));const e=t.indexOf("("),n=t.substring(0,e);if(-1===["rgb","rgba","hsl","hsla","color"].indexOf(n))throw new Error(kc(9,t));let r,i=t.substring(e+1,t.length-1);if("color"===n){if(i=i.split(" "),r=i.shift(),4===i.length&&"/"===i[3].charAt(0)&&(i[3]=i[3].substr(1)),-1===["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(r))throw new Error(kc(10,r))}else i=i.split(",");return i=i.map((t=>parseFloat(t))),{type:n,values:i,colorSpace:r}}function oh(t){const{type:e,colorSpace:n}=t;let{values:r}=t;return-1!==e.indexOf("rgb")?r=r.map(((t,e)=>e<3?parseInt(t,10):t)):-1!==e.indexOf("hsl")&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),r=-1!==e.indexOf("color")?`${n} ${r.join(" ")}`:`${r.join(", ")}`,`${e}(${r})`}function sh(t){let e="hsl"===(t=ih(t)).type?ih(function(t){t=ih(t);const{values:e}=t,n=e[0],r=e[1]/100,i=e[2]/100,o=r*Math.min(i,1-i),s=(t,e=(t+n/30)%12)=>i-o*Math.max(Math.min(e-3,9-e,1),-1);let a="rgb";const l=[Math.round(255*s(0)),Math.round(255*s(8)),Math.round(255*s(4))];return"hsla"===t.type&&(a+="a",l.push(e[3])),oh({type:a,values:l})}(t)).values:t.values;return e=e.map((e=>("color"!==t.type&&(e/=255),e<=.03928?e/12.92:((e+.055)/1.055)**2.4))),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function ah(t,e){return t=ih(t),e=rh(e),"rgb"!==t.type&&"hsl"!==t.type||(t.type+="a"),"color"===t.type?t.values[3]=`/${e}`:t.values[3]=e,oh(t)}const lh={black:"#000",white:"#fff"},uh={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},ch="#f3e5f5",hh="#ce93d8",ph="#ba68c8",fh="#ab47bc",dh="#9c27b0",gh="#7b1fa2",mh="#e57373",Ah="#ef5350",yh="#f44336",_h="#d32f2f",vh="#c62828",bh="#ffb74d",xh="#ffa726",wh="#ff9800",Eh="#f57c00",Sh="#e65100",Th="#e3f2fd",Ph="#90caf9",Mh="#42a5f5",Ch="#1976d2",Ih="#1565c0",Oh="#4fc3f7",Rh="#29b6f6",Lh="#03a9f4",kh="#0288d1",Dh="#01579b",Nh="#81c784",Fh="#66bb6a",Bh="#4caf50",zh="#388e3c",jh="#2e7d32",Uh="#1b5e20",Vh=["mode","contrastThreshold","tonalOffset"],Gh={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:lh.white,default:lh.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},Zh={text:{primary:lh.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:lh.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function qh(t,e,n,r){const i=r.light||r,o=r.dark||1.5*r;t[e]||(t.hasOwnProperty(n)?t[e]=t[n]:"light"===e?t.light=function(t,e){if(t=ih(t),e=rh(e),-1!==t.type.indexOf("hsl"))t.values[2]+=(100-t.values[2])*e;else if(-1!==t.type.indexOf("rgb"))for(let n=0;n<3;n+=1)t.values[n]+=(255-t.values[n])*e;else if(-1!==t.type.indexOf("color"))for(let n=0;n<3;n+=1)t.values[n]+=(1-t.values[n])*e;return oh(t)}(t.main,i):"dark"===e&&(t.dark=function(t,e){if(t=ih(t),e=rh(e),-1!==t.type.indexOf("hsl"))t.values[2]*=1-e;else if(-1!==t.type.indexOf("rgb")||-1!==t.type.indexOf("color"))for(let n=0;n<3;n+=1)t.values[n]*=1-e;return oh(t)}(t.main,o)))}const Wh=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"],Hh={textTransform:"uppercase"},Xh='"Roboto", "Helvetica", "Arial", sans-serif';function $h(t,e){const n="function"==typeof e?e(t):e,{fontFamily:r=Xh,fontSize:i=14,fontWeightLight:o=300,fontWeightRegular:s=400,fontWeightMedium:a=500,fontWeightBold:l=700,htmlFontSize:u=16,allVariants:c,pxToRem:h}=n,p=Ne(n,Wh),f=i/14,d=h||(t=>t/u*f+"rem"),g=(t,e,n,i,o)=>{return E({fontFamily:r,fontWeight:t,fontSize:d(e),lineHeight:n},r===Xh?{letterSpacing:(s=i/e,Math.round(1e5*s)/1e5+"em")}:{},o,c);var s},m={h1:g(o,96,1.167,-1.5),h2:g(o,60,1.2,-.5),h3:g(s,48,1.167,0),h4:g(s,34,1.235,.25),h5:g(s,24,1.334,0),h6:g(a,20,1.6,.15),subtitle1:g(s,16,1.75,.15),subtitle2:g(a,14,1.57,.1),body1:g(s,16,1.5,.15),body2:g(s,14,1.43,.15),button:g(a,14,1.75,.4,Hh),caption:g(s,12,1.66,.4),overline:g(s,12,2.66,1,Hh)};return Mc(E({htmlFontSize:u,pxToRem:d,fontFamily:r,fontSize:i,fontWeightLight:o,fontWeightRegular:s,fontWeightMedium:a,fontWeightBold:l},m),p,{clone:!1})}function Yh(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,0.2)`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,0.14)`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,0.12)`].join(",")}const Qh=["none",Yh(0,2,1,-1,0,1,1,0,0,1,3,0),Yh(0,3,1,-2,0,2,2,0,0,1,5,0),Yh(0,3,3,-2,0,3,4,0,0,1,8,0),Yh(0,2,4,-1,0,4,5,0,0,1,10,0),Yh(0,3,5,-1,0,5,8,0,0,1,14,0),Yh(0,3,5,-1,0,6,10,0,0,1,18,0),Yh(0,4,5,-2,0,7,10,1,0,2,16,1),Yh(0,5,5,-3,0,8,10,1,0,3,14,2),Yh(0,5,6,-3,0,9,12,1,0,3,16,2),Yh(0,6,6,-3,0,10,14,1,0,4,18,3),Yh(0,6,7,-4,0,11,15,1,0,4,20,3),Yh(0,7,8,-4,0,12,17,2,0,5,22,4),Yh(0,7,8,-4,0,13,19,2,0,5,24,4),Yh(0,7,9,-4,0,14,21,2,0,5,26,4),Yh(0,8,9,-5,0,15,22,2,0,6,28,5),Yh(0,8,10,-5,0,16,24,2,0,6,30,5),Yh(0,8,11,-5,0,17,26,2,0,6,32,5),Yh(0,9,11,-5,0,18,28,2,0,7,34,6),Yh(0,9,12,-6,0,19,29,2,0,7,36,6),Yh(0,10,13,-6,0,20,31,3,0,8,38,7),Yh(0,10,13,-6,0,21,33,3,0,8,40,7),Yh(0,10,14,-6,0,22,35,3,0,8,42,7),Yh(0,11,14,-7,0,23,36,3,0,9,44,8),Yh(0,11,15,-7,0,24,38,3,0,9,46,8)],Kh=["duration","easing","delay"],Jh={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},tp={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function ep(t){return`${Math.round(t)}ms`}function np(t){if(!t)return 0;const e=t/36;return Math.round(10*(4+15*e**.25+e/5))}function rp(t){const e=E({},Jh,t.easing),n=E({},tp,t.duration);return E({getAutoHeightDuration:np,create:(t=["all"],r={})=>{const{duration:i=n.standard,easing:o=e.easeInOut,delay:s=0}=r;return Ne(r,Kh),(Array.isArray(t)?t:[t]).map((t=>`${t} ${"string"==typeof i?i:ep(i)} ${o} ${"string"==typeof s?s:ep(s)}`)).join(",")}},t,{easing:e,duration:n})}const ip={mobileStepper:1e3,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},op=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];const sp=function(t={},...e){const{mixins:n={},palette:r={},transitions:i={},typography:o={}}=t,s=Ne(t,op),a=function(t){const{mode:e="light",contrastThreshold:n=3,tonalOffset:r=.2}=t,i=Ne(t,Vh),o=t.primary||function(t="light"){return"dark"===t?{main:Ph,light:Th,dark:Mh}:{main:Ch,light:Mh,dark:Ih}}(e),s=t.secondary||function(t="light"){return"dark"===t?{main:hh,light:ch,dark:fh}:{main:dh,light:ph,dark:gh}}(e),a=t.error||function(t="light"){return"dark"===t?{main:yh,light:mh,dark:_h}:{main:_h,light:Ah,dark:vh}}(e),l=t.info||function(t="light"){return"dark"===t?{main:Rh,light:Oh,dark:kh}:{main:kh,light:Lh,dark:Dh}}(e),u=t.success||function(t="light"){return"dark"===t?{main:Fh,light:Nh,dark:zh}:{main:jh,light:Bh,dark:Uh}}(e),c=t.warning||function(t="light"){return"dark"===t?{main:xh,light:bh,dark:Eh}:{main:"#ED6C02",light:wh,dark:Sh}}(e);function h(t){const e=function(t,e){const n=sh(t),r=sh(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}(t,Zh.text.primary)>=n?Zh.text.primary:Gh.text.primary;return e}const p=({color:t,name:e,mainShade:n=500,lightShade:i=300,darkShade:o=700})=>{if(!(t=E({},t)).main&&t[n]&&(t.main=t[n]),!t.hasOwnProperty("main"))throw new Error(kc(11,e?` (${e})`:"",n));if("string"!=typeof t.main)throw new Error(kc(12,e?` (${e})`:"",JSON.stringify(t.main)));return qh(t,"light",i,r),qh(t,"dark",o,r),t.contrastText||(t.contrastText=h(t.main)),t},f={dark:Zh,light:Gh};return Mc(E({common:lh,mode:e,primary:p({color:o,name:"primary"}),secondary:p({color:s,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:p({color:a,name:"error"}),warning:p({color:c,name:"warning"}),info:p({color:l,name:"info"}),success:p({color:u,name:"success"}),grey:uh,contrastThreshold:n,getContrastText:h,augmentColor:p,tonalOffset:r},f[e]),i)}(r),l=nh(t);let u=Mc(l,{mixins:(c=l.breakpoints,l.spacing,h=n,E({toolbar:{minHeight:56,[`${c.up("xs")} and (orientation: landscape)`]:{minHeight:48},[c.up("sm")]:{minHeight:64}}},h)),palette:a,shadows:Qh.slice(),typography:$h(a,o),transitions:rp(i),zIndex:E({},ip)});var c,h;return u=Mc(u,s),u=e.reduce(((t,e)=>Mc(t,e)),u),u},ap=l.createContext(null);function lp(){return l.useContext(ap)}const up="function"==typeof Symbol&&Symbol.for?Symbol.for("mui.nested"):"__THEME_NESTED__";var cp=n(5893);const hp=function(t){const{children:e,theme:n}=t,r=lp(),i=l.useMemo((()=>{const t=null===r?n:function(t,e){return"function"==typeof e?e(t):E({},t,e)}(r,n);return null!=t&&(t[up]=null!==r),t}),[n,r]);return(0,cp.jsx)(ap.Provider,{value:i,children:e})};var pp=function(){function t(t){var e=this;this._insertTag=function(t){var n;n=0===e.tags.length?e.prepend?e.container.firstChild:e.before:e.tags[e.tags.length-1].nextSibling,e.container.insertBefore(t,n),e.tags.push(t)},this.isSpeedy=void 0===t.speedy||t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.before=null}var e=t.prototype;return e.hydrate=function(t){t.forEach(this._insertTag)},e.insert=function(t){this.ctr%(this.isSpeedy?65e3:1)==0&&this._insertTag(function(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),void 0!==t.nonce&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}(this));var e=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}(e);try{n.insertRule(t,n.cssRules.length)}catch(t){}}else e.appendChild(document.createTextNode(t));this.ctr++},e.flush=function(){this.tags.forEach((function(t){return t.parentNode.removeChild(t)})),this.tags=[],this.ctr=0},t}(),fp=Math.abs,dp=String.fromCharCode;function gp(t){return t.trim()}function mp(t,e,n){return t.replace(e,n)}function Ap(t,e){return t.indexOf(e)}function yp(t,e){return 0|t.charCodeAt(e)}function _p(t,e,n){return t.slice(e,n)}function vp(t){return t.length}function bp(t){return t.length}function xp(t,e){return e.push(t),t}var wp=1,Ep=1,Sp=0,Tp=0,Pp=0,Mp="";function Cp(t,e,n,r,i,o,s){return{value:t,root:e,parent:n,type:r,props:i,children:o,line:wp,column:Ep,length:s,return:""}}function Ip(t,e,n){return Cp(t,e.root,e.parent,n,e.props,e.children,0)}function Op(){return Pp=Tp>0?yp(Mp,--Tp):0,Ep--,10===Pp&&(Ep=1,wp--),Pp}function Rp(){return Pp=Tp<Sp?yp(Mp,Tp++):0,Ep++,10===Pp&&(Ep=1,wp++),Pp}function Lp(){return yp(Mp,Tp)}function kp(){return Tp}function Dp(t,e){return _p(Mp,t,e)}function Np(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Fp(t){return wp=Ep=1,Sp=vp(Mp=t),Tp=0,[]}function Bp(t){return Mp="",t}function zp(t){return gp(Dp(Tp-1,Vp(91===t?t+2:40===t?t+1:t)))}function jp(t){for(;(Pp=Lp())&&Pp<33;)Rp();return Np(t)>2||Np(Pp)>3?"":" "}function Up(t,e){for(;--e&&Rp()&&!(Pp<48||Pp>102||Pp>57&&Pp<65||Pp>70&&Pp<97););return Dp(t,kp()+(e<6&&32==Lp()&&32==Rp()))}function Vp(t){for(;Rp();)switch(Pp){case t:return Tp;case 34:case 39:return Vp(34===t||39===t?t:Pp);case 40:41===t&&Vp(t);break;case 92:Rp()}return Tp}function Gp(t,e){for(;Rp()&&t+Pp!==57&&(t+Pp!==84||47!==Lp()););return"/*"+Dp(e,Tp-1)+"*"+dp(47===t?t:Rp())}function Zp(t){for(;!Np(Lp());)Rp();return Dp(t,Tp)}var qp="-ms-",Wp="-moz-",Hp="-webkit-",Xp="comm",$p="rule",Yp="decl";function Qp(t,e){for(var n="",r=bp(t),i=0;i<r;i++)n+=e(t[i],i,t,e)||"";return n}function Kp(t,e,n,r){switch(t.type){case"@import":case Yp:return t.return=t.return||t.value;case Xp:return"";case $p:t.value=t.props.join(",")}return vp(n=Qp(t.children,r))?t.return=t.value+"{"+n+"}":""}function Jp(t,e){switch(function(t,e){return(((e<<2^yp(t,0))<<2^yp(t,1))<<2^yp(t,2))<<2^yp(t,3)}(t,e)){case 5103:return Hp+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Hp+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return Hp+t+Wp+t+qp+t+t;case 6828:case 4268:return Hp+t+qp+t+t;case 6165:return Hp+t+qp+"flex-"+t+t;case 5187:return Hp+t+mp(t,/(\w+).+(:[^]+)/,"-webkit-box-$1$2-ms-flex-$1$2")+t;case 5443:return Hp+t+qp+"flex-item-"+mp(t,/flex-|-self/,"")+t;case 4675:return Hp+t+qp+"flex-line-pack"+mp(t,/align-content|flex-|-self/,"")+t;case 5548:return Hp+t+qp+mp(t,"shrink","negative")+t;case 5292:return Hp+t+qp+mp(t,"basis","preferred-size")+t;case 6060:return Hp+"box-"+mp(t,"-grow","")+Hp+t+qp+mp(t,"grow","positive")+t;case 4554:return Hp+mp(t,/([^-])(transform)/g,"$1-webkit-$2")+t;case 6187:return mp(mp(mp(t,/(zoom-|grab)/,Hp+"$1"),/(image-set)/,Hp+"$1"),t,"")+t;case 5495:case 3959:return mp(t,/(image-set\([^]*)/,Hp+"$1$`$1");case 4968:return mp(mp(t,/(.+:)(flex-)?(.*)/,"-webkit-box-pack:$3-ms-flex-pack:$3"),/s.+-b[^;]+/,"justify")+Hp+t+t;case 4095:case 3583:case 4068:case 2532:return mp(t,/(.+)-inline(.+)/,Hp+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(vp(t)-1-e>6)switch(yp(t,e+1)){case 109:if(45!==yp(t,e+4))break;case 102:return mp(t,/(.+:)(.+)-([^]+)/,"$1-webkit-$2-$3$1"+Wp+(108==yp(t,e+3)?"$3":"$2-$3"))+t;case 115:return~Ap(t,"stretch")?Jp(mp(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(115!==yp(t,e+1))break;case 6444:switch(yp(t,vp(t)-3-(~Ap(t,"!important")&&10))){case 107:return mp(t,":",":"+Hp)+t;case 101:return mp(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Hp+(45===yp(t,14)?"inline-":"")+"box$3$1"+Hp+"$2$3$1"+qp+"$2box$3")+t}break;case 5936:switch(yp(t,e+11)){case 114:return Hp+t+qp+mp(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return Hp+t+qp+mp(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return Hp+t+qp+mp(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return Hp+t+qp+t+t}return t}function tf(t){return Bp(ef("",null,null,null,[""],t=Fp(t),0,[0],t))}function ef(t,e,n,r,i,o,s,a,l){for(var u=0,c=0,h=s,p=0,f=0,d=0,g=1,m=1,A=1,y=0,_="",v=i,b=o,x=r,w=_;m;)switch(d=y,y=Rp()){case 34:case 39:case 91:case 40:w+=zp(y);break;case 9:case 10:case 13:case 32:w+=jp(d);break;case 92:w+=Up(kp()-1,7);continue;case 47:switch(Lp()){case 42:case 47:xp(rf(Gp(Rp(),kp()),e,n),l);break;default:w+="/"}break;case 123*g:a[u++]=vp(w)*A;case 125*g:case 59:case 0:switch(y){case 0:case 125:m=0;case 59+c:f>0&&vp(w)-h&&xp(f>32?of(w+";",r,n,h-1):of(mp(w," ","")+";",r,n,h-2),l);break;case 59:w+=";";default:if(xp(x=nf(w,e,n,u,c,i,a,_,v=[],b=[],h),o),123===y)if(0===c)ef(w,e,x,x,v,o,h,a,b);else switch(p){case 100:case 109:case 115:ef(t,x,x,r&&xp(nf(t,x,x,0,0,i,a,_,i,v=[],h),b),i,b,h,a,r?v:b);break;default:ef(w,x,x,x,[""],b,h,a,b)}}u=c=f=0,g=A=1,_=w="",h=s;break;case 58:h=1+vp(w),f=d;default:if(g<1)if(123==y)--g;else if(125==y&&0==g++&&125==Op())continue;switch(w+=dp(y),y*g){case 38:A=c>0?1:(w+="\f",-1);break;case 44:a[u++]=(vp(w)-1)*A,A=1;break;case 64:45===Lp()&&(w+=zp(Rp())),p=Lp(),c=vp(_=w+=Zp(kp())),y++;break;case 45:45===d&&2==vp(w)&&(g=0)}}return o}function nf(t,e,n,r,i,o,s,a,l,u,c){for(var h=i-1,p=0===i?o:[""],f=bp(p),d=0,g=0,m=0;d<r;++d)for(var A=0,y=_p(t,h+1,h=fp(g=s[d])),_=t;A<f;++A)(_=gp(g>0?p[A]+" "+y:mp(y,/&\f/g,p[A])))&&(l[m++]=_);return Cp(t,e,n,0===i?$p:a,l,u,c)}function rf(t,e,n){return Cp(t,e,n,Xp,dp(Pp),_p(t,2,-2),0)}function of(t,e,n,r){return Cp(t,e,n,Yp,_p(t,0,r),_p(t,r+1,-1),r)}var sf=new WeakMap,af=function(t){if("rule"===t.type&&t.parent&&t.length){for(var e=t.value,n=t.parent,r=t.column===n.column&&t.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==t.props.length||58===e.charCodeAt(0)||sf.get(n))&&!r){sf.set(t,!0);for(var i=[],o=function(t,e){return Bp(function(t,e){var n=-1,r=44;do{switch(Np(r)){case 0:38===r&&12===Lp()&&(e[n]=1),t[n]+=Zp(Tp-1);break;case 2:t[n]+=zp(r);break;case 4:if(44===r){t[++n]=58===Lp()?"&\f":"",e[n]=t[n].length;break}default:t[n]+=dp(r)}}while(r=Rp());return t}(Fp(t),e))}(e,i),s=n.props,a=0,l=0;a<o.length;a++)for(var u=0;u<s.length;u++,l++)t.props[l]=i[a]?o[a].replace(/&\f/g,s[u]):s[u]+" "+o[a]}}},lf=function(t){if("decl"===t.type){var e=t.value;108===e.charCodeAt(0)&&98===e.charCodeAt(2)&&(t.return="",t.value="")}},uf=[function(t,e,n,r){if(!t.return)switch(t.type){case Yp:t.return=Jp(t.value,t.length);break;case"@keyframes":return Qp([Ip(mp(t.value,"@","@"+Hp),t,"")],r);case $p:if(t.length)return function(t,e){return t.map(e).join("")}(t.props,(function(e){switch(function(t,e){return(t=/(::plac\w+|:read-\w+)/.exec(t))?t[0]:t}(e)){case":read-only":case":read-write":return Qp([Ip(mp(e,/:(read-\w+)/,":-moz-$1"),t,"")],r);case"::placeholder":return Qp([Ip(mp(e,/:(plac\w+)/,":-webkit-input-$1"),t,""),Ip(mp(e,/:(plac\w+)/,":-moz-$1"),t,""),Ip(mp(e,/:(plac\w+)/,qp+"input-$1"),t,"")],r)}return""}))}}];const cf=function(t){var e=t.key;if("css"===e){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,(function(t){-1!==t.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(t),t.setAttribute("data-s",""))}))}var r,i,o=t.stylisPlugins||uf,s={},a=[];r=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+e+' "]'),(function(t){for(var e=t.getAttribute("data-emotion").split(" "),n=1;n<e.length;n++)s[e[n]]=!0;a.push(t)}));var l,u,c,h,p=[Kp,(h=function(t){l.insert(t)},function(t){t.root||(t=t.return)&&h(t)})],f=(u=[af,lf].concat(o,p),c=bp(u),function(t,e,n,r){for(var i="",o=0;o<c;o++)i+=u[o](t,e,n,r)||"";return i});i=function(t,e,n,r){l=n,Qp(tf(t?t+"{"+e.styles+"}":e.styles),f),r&&(d.inserted[e.name]=!0)};var d={key:e,sheet:new pp({key:e,container:r,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend}),nonce:t.nonce,inserted:s,registered:{},insert:i};return d.sheet.hydrate(a),d},hf=function(t){for(var e,n=0,r=0,i=t.length;i>=4;++r,i-=4)e=1540483477*(65535&(e=255&t.charCodeAt(r)|(255&t.charCodeAt(++r))<<8|(255&t.charCodeAt(++r))<<16|(255&t.charCodeAt(++r))<<24))+(59797*(e>>>16)<<16),n=1540483477*(65535&(e^=e>>>24))+(59797*(e>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(i){case 3:n^=(255&t.charCodeAt(r+2))<<16;case 2:n^=(255&t.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&t.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)},pf={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},ff=function(t){var e=Object.create(null);return function(n){return void 0===e[n]&&(e[n]=t(n)),e[n]}};var df=/[A-Z]|^ms/g,gf=/_EMO_([^_]+?)_([^]*?)_EMO_/g,mf=function(t){return 45===t.charCodeAt(1)},Af=function(t){return null!=t&&"boolean"!=typeof t},yf=ff((function(t){return mf(t)?t:t.replace(df,"-$&").toLowerCase()})),_f=function(t,e){switch(t){case"animation":case"animationName":if("string"==typeof e)return e.replace(gf,(function(t,e,n){return bf={name:e,styles:n,next:bf},e}))}return 1===pf[t]||mf(t)||"number"!=typeof e||0===e?e:e+"px"};function vf(t,e,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return bf={name:n.name,styles:n.styles,next:bf},n.name;if(void 0!==n.styles){var r=n.next;if(void 0!==r)for(;void 0!==r;)bf={name:r.name,styles:r.styles,next:bf},r=r.next;return n.styles+";"}return function(t,e,n){var r="";if(Array.isArray(n))for(var i=0;i<n.length;i++)r+=vf(t,e,n[i])+";";else for(var o in n){var s=n[o];if("object"!=typeof s)null!=e&&void 0!==e[s]?r+=o+"{"+e[s]+"}":Af(s)&&(r+=yf(o)+":"+_f(o,s)+";");else if(!Array.isArray(s)||"string"!=typeof s[0]||null!=e&&void 0!==e[s[0]]){var a=vf(t,e,s);switch(o){case"animation":case"animationName":r+=yf(o)+":"+a+";";break;default:r+=o+"{"+a+"}"}}else for(var l=0;l<s.length;l++)Af(s[l])&&(r+=yf(o)+":"+_f(o,s[l])+";")}return r}(t,e,n);case"function":if(void 0!==t){var i=bf,o=n(t);return bf=i,vf(t,e,o)}}if(null==e)return n;var s=e[n];return void 0!==s?s:n}var bf,xf=/label:\s*([^\s;\n{]+)\s*(;|$)/g,wf=function(t,e,n){if(1===t.length&&"object"==typeof t[0]&&null!==t[0]&&void 0!==t[0].styles)return t[0];var r=!0,i="";bf=void 0;var o=t[0];null==o||void 0===o.raw?(r=!1,i+=vf(n,e,o)):i+=o[0];for(var s=1;s<t.length;s++)i+=vf(n,e,t[s]),r&&(i+=o[s]);xf.lastIndex=0;for(var a,l="";null!==(a=xf.exec(i));)l+="-"+a[1];return{name:hf(i)+l,styles:i,next:bf}},Ef=(Object.prototype.hasOwnProperty,(0,l.createContext)("undefined"!=typeof HTMLElement?cf({key:"css"}):null));Ef.Provider;var Sf=function(t){return(0,l.forwardRef)((function(e,n){var r=(0,l.useContext)(Ef);return t(e,r,n)}))},Tf=(0,l.createContext)({});const Pf=nh(),Mf=function(t=Pf){return function(t=null){const e=lp();return e&&(n=e,0!==Object.keys(n).length)?e:t;var n}(t)};function Cf(t){const e=Mf();return(0,cp.jsx)(Tf.Provider,{value:"object"==typeof e?e:{},children:t.children})}const If=function(t){const{children:e,theme:n}=t;return(0,cp.jsx)(hp,{theme:n,children:(0,cp.jsx)(Cf,{children:e})})};function Of(t){var e,n,r="";if("string"==typeof t||"number"==typeof t)r+=t;else if("object"==typeof t)if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=Of(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function Rf(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=Of(t))&&(r&&(r+=" "),r+=e);return r}function Lf(t,e,n){const r={};return Object.keys(t).forEach((i=>{r[i]=t[i].reduce(((t,r)=>(r&&(n&&n[r]&&t.push(n[r]),t.push(e(r))),t)),[]).join(" ")})),r}var kf=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/;function Df(t,e,n){var r="";return n.split(" ").forEach((function(n){void 0!==t[n]?e.push(t[n]+";"):r+=n+" "})),r}var Nf=function(t,e,n){var r=t.key+"-"+e.name;if(!1===n&&void 0===t.registered[r]&&(t.registered[r]=e.styles),void 0===t.inserted[e.name]){var i=e;do{t.insert(e===i?"."+r:"",i,t.sheet,!0),i=i.next}while(void 0!==i)}},Ff=ff((function(t){return kf.test(t)||111===t.charCodeAt(0)&&110===t.charCodeAt(1)&&t.charCodeAt(2)<91})),Bf=function(t){return"theme"!==t},zf=function(t){return"string"==typeof t&&t.charCodeAt(0)>96?Ff:Bf},jf=function(t,e,n){var r;if(e){var i=e.shouldForwardProp;r=t.__emotion_forwardProp&&i?function(e){return t.__emotion_forwardProp(e)&&i(e)}:i}return"function"!=typeof r&&n&&(r=t.__emotion_forwardProp),r};var Uf=function t(e,n){var r,i,o=e.__emotion_real===e,s=o&&e.__emotion_base||e;void 0!==n&&(r=n.label,i=n.target);var a=jf(e,n,o),u=a||zf(s),c=!u("as");return function(){var h=arguments,p=o&&void 0!==e.__emotion_styles?e.__emotion_styles.slice(0):[];if(void 0!==r&&p.push("label:"+r+";"),null==h[0]||void 0===h[0].raw)p.push.apply(p,h);else{p.push(h[0][0]);for(var f=h.length,d=1;d<f;d++)p.push(h[d],h[0][d])}var g=Sf((function(t,e,n){var r=c&&t.as||s,o="",h=[],f=t;if(null==t.theme){for(var d in f={},t)f[d]=t[d];f.theme=(0,l.useContext)(Tf)}"string"==typeof t.className?o=Df(e.registered,h,t.className):null!=t.className&&(o=t.className+" ");var g=wf(p.concat(h),e.registered,f);Nf(e,g,"string"==typeof r),o+=e.key+"-"+g.name,void 0!==i&&(o+=" "+i);var m=c&&void 0===a?zf(r):u,A={};for(var y in t)c&&"as"===y||m(y)&&(A[y]=t[y]);return A.className=o,A.ref=n,(0,l.createElement)(r,A)}));return g.displayName=void 0!==r?r:"Styled("+("string"==typeof s?s:s.displayName||s.name||"Component")+")",g.defaultProps=e.defaultProps,g.__emotion_real=g,g.__emotion_base=s,g.__emotion_styles=p,g.__emotion_forwardProp=a,Object.defineProperty(g,"toString",{value:function(){return"."+i}}),g.withComponent=function(e,r){return t(e,E({},n,r,{shouldForwardProp:jf(g,r,!0)})).apply(void 0,p)},g}}.bind();["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(t){Uf[t]=Uf(t)}));const Vf=Uf;function Gf(t,e){return Vf(t,e)}const Zf=function(...t){const e=t.reduce(((t,e)=>(e.filterProps.forEach((n=>{t[n]=e})),t)),{}),n=t=>Object.keys(t).reduce(((n,r)=>e[r]?zc(n,e[r](t)):n),{});return n.propTypes={},n.filterProps=t.reduce(((t,e)=>t.concat(e.filterProps)),[]),n};function qf(t){return"number"!=typeof t?t:`${t}px solid`}const Wf=Bc({prop:"border",themeKey:"borders",transform:qf}),Hf=Bc({prop:"borderTop",themeKey:"borders",transform:qf}),Xf=Bc({prop:"borderRight",themeKey:"borders",transform:qf}),$f=Bc({prop:"borderBottom",themeKey:"borders",transform:qf}),Yf=Bc({prop:"borderLeft",themeKey:"borders",transform:qf}),Qf=Bc({prop:"borderColor",themeKey:"palette"}),Kf=Bc({prop:"borderTopColor",themeKey:"palette"}),Jf=Bc({prop:"borderRightColor",themeKey:"palette"}),td=Bc({prop:"borderBottomColor",themeKey:"palette"}),ed=Bc({prop:"borderLeftColor",themeKey:"palette"}),nd=t=>{if(void 0!==t.borderRadius&&null!==t.borderRadius){const e=Hc(t.theme,"shape.borderRadius",4),n=t=>({borderRadius:$c(e,t)});return Lc(t,t.borderRadius,n)}return null};nd.propTypes={},nd.filterProps=["borderRadius"];const rd=Zf(Wf,Hf,Xf,$f,Yf,Qf,Kf,Jf,td,ed,nd),id=Zf(Bc({prop:"displayPrint",cssProperty:!1,transform:t=>({"@media print":{display:t}})}),Bc({prop:"display"}),Bc({prop:"overflow"}),Bc({prop:"textOverflow"}),Bc({prop:"visibility"}),Bc({prop:"whiteSpace"})),od=Zf(Bc({prop:"flexBasis"}),Bc({prop:"flexDirection"}),Bc({prop:"flexWrap"}),Bc({prop:"justifyContent"}),Bc({prop:"alignItems"}),Bc({prop:"alignContent"}),Bc({prop:"order"}),Bc({prop:"flex"}),Bc({prop:"flexGrow"}),Bc({prop:"flexShrink"}),Bc({prop:"alignSelf"}),Bc({prop:"justifyItems"}),Bc({prop:"justifySelf"})),sd=t=>{if(void 0!==t.gap&&null!==t.gap){const e=Hc(t.theme,"spacing",8),n=t=>({gap:$c(e,t)});return Lc(t,t.gap,n)}return null};sd.propTypes={},sd.filterProps=["gap"];const ad=t=>{if(void 0!==t.columnGap&&null!==t.columnGap){const e=Hc(t.theme,"spacing",8),n=t=>({columnGap:$c(e,t)});return Lc(t,t.columnGap,n)}return null};ad.propTypes={},ad.filterProps=["columnGap"];const ld=t=>{if(void 0!==t.rowGap&&null!==t.rowGap){const e=Hc(t.theme,"spacing",8),n=t=>({rowGap:$c(e,t)});return Lc(t,t.rowGap,n)}return null};ld.propTypes={},ld.filterProps=["rowGap"];const ud=Zf(sd,ad,ld,Bc({prop:"gridColumn"}),Bc({prop:"gridRow"}),Bc({prop:"gridAutoFlow"}),Bc({prop:"gridAutoColumns"}),Bc({prop:"gridAutoRows"}),Bc({prop:"gridTemplateColumns"}),Bc({prop:"gridTemplateRows"}),Bc({prop:"gridTemplateAreas"}),Bc({prop:"gridArea"})),cd=Zf(Bc({prop:"position"}),Bc({prop:"zIndex",themeKey:"zIndex"}),Bc({prop:"top"}),Bc({prop:"right"}),Bc({prop:"bottom"}),Bc({prop:"left"})),hd=Zf(Bc({prop:"color",themeKey:"palette"}),Bc({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette"}),Bc({prop:"backgroundColor",themeKey:"palette"})),pd=Bc({prop:"boxShadow",themeKey:"shadows"});function fd(t){return t<=1&&0!==t?100*t+"%":t}const dd=Bc({prop:"width",transform:fd}),gd=t=>{if(void 0!==t.maxWidth&&null!==t.maxWidth){const e=e=>{var n,r,i;return{maxWidth:(null==(n=t.theme)||null==(r=n.breakpoints)||null==(i=r.values)?void 0:i[e])||Oc[e]||fd(e)}};return Lc(t,t.maxWidth,e)}return null};gd.filterProps=["maxWidth"];const md=Bc({prop:"minWidth",transform:fd}),Ad=Bc({prop:"height",transform:fd}),yd=Bc({prop:"maxHeight",transform:fd}),_d=Bc({prop:"minHeight",transform:fd}),vd=(Bc({prop:"size",cssProperty:"width",transform:fd}),Bc({prop:"size",cssProperty:"height",transform:fd}),Zf(dd,gd,md,Ad,yd,_d,Bc({prop:"boxSizing"}))),bd=Bc({prop:"fontFamily",themeKey:"typography"}),xd=Bc({prop:"fontSize",themeKey:"typography"}),wd=Bc({prop:"fontStyle",themeKey:"typography"}),Ed=Bc({prop:"fontWeight",themeKey:"typography"}),Sd=Bc({prop:"letterSpacing"}),Td=Bc({prop:"lineHeight"}),Pd=Bc({prop:"textAlign"}),Md=Zf(Bc({prop:"typography",cssProperty:!1,themeKey:"typography"}),bd,xd,wd,Ed,Sd,Td,Pd),Cd={borders:rd.filterProps,display:id.filterProps,flexbox:od.filterProps,grid:ud.filterProps,positions:cd.filterProps,palette:hd.filterProps,shadows:pd.filterProps,sizing:vd.filterProps,spacing:th.filterProps,typography:Md.filterProps},Id={borders:rd,display:id,flexbox:od,grid:ud,positions:cd,palette:hd,shadows:pd,sizing:vd,spacing:th,typography:Md},Od=Object.keys(Cd).reduce(((t,e)=>(Cd[e].forEach((n=>{t[n]=Id[e]})),t)),{}),Rd=function(t,e,n){const r={[t]:e,theme:n},i=Od[t];return i?i(r):{[t]:e}};function Ld(t){const{sx:e,theme:n={}}=t||{};if(!e)return null;if("function"==typeof e)return e(n);if("object"!=typeof e)return e;const r=function(t={}){var e;return(null==t||null==(e=t.keys)?void 0:e.reduce(((e,n)=>(e[t.up(n)]={},e)),{}))||{}}(n.breakpoints),i=Object.keys(r);let o=r;return Object.keys(e).forEach((t=>{const r="function"==typeof(i=e[t])?i(n):i;var i;if("object"==typeof r)if(Od[t])o=zc(o,Rd(t,r,n));else{const e=Lc({theme:n},r,(e=>({[t]:e})));!function(...t){const e=t.reduce(((t,e)=>t.concat(Object.keys(e))),[]),n=new Set(e);return t.every((t=>n.size===Object.keys(t).length))}(e,r)?o=zc(o,e):o[t]=Ld({sx:r,theme:n})}else o=zc(o,Rd(t,r,n))})),s=o,i.reduce(((t,e)=>{const n=t[e];return 0===Object.keys(n).length&&delete t[e],t}),s);var s}Ld.filterProps=["sx"];const kd=Ld,Dd=["variant"];function Nd(t){return 0===t.length}function Fd(t){const{variant:e}=t,n=Ne(t,Dd);let r=e||"";return Object.keys(n).sort().forEach((e=>{r+="color"===e?Nd(r)?t[e]:Dc(t[e]):`${Nd(r)?e:Dc(e)}${Dc(t[e].toString())}`})),r}const Bd=["name","slot","skipVariantsResolver","skipSx","overridesResolver"],zd=["theme"],jd=["theme"];function Ud(t){return 0===Object.keys(t).length}function Vd(t){return"ownerState"!==t&&"theme"!==t&&"sx"!==t&&"as"!==t}const Gd=nh(),Zd=sp(),qd=t=>Vd(t)&&"classes"!==t,Wd=Vd,Hd=function(t={}){const{defaultTheme:e=Gd,rootShouldForwardProp:n=Vd,slotShouldForwardProp:r=Vd}=t;return(t,i={})=>{const{name:o,slot:s,skipVariantsResolver:a,skipSx:l,overridesResolver:u}=i,c=Ne(i,Bd),h=void 0!==a?a:s&&"Root"!==s||!1,p=l||!1;let f=Vd;"Root"===s?f=n:s&&(f=r);const d=Gf(t,E({shouldForwardProp:f,label:void 0},c));return(t,...n)=>{const r=n?n.map((t=>"function"==typeof t?n=>{let{theme:r}=n,i=Ne(n,zd);return t(E({theme:Ud(r)?e:r},i))}:t)):[];let i=t;o&&u&&r.push((t=>{const n=Ud(t.theme)?e:t.theme,r=((t,e)=>e.components&&e.components[t]&&e.components[t].styleOverrides?e.components[t].styleOverrides:null)(o,n);return r?u(t,r):null})),o&&!h&&r.push((t=>{const n=Ud(t.theme)?e:t.theme;return((t,e,n,r)=>{var i,o;const{ownerState:s={}}=t,a=[],l=null==n||null==(i=n.components)||null==(o=i[r])?void 0:o.variants;return l&&l.forEach((n=>{let r=!0;Object.keys(n.props).forEach((e=>{s[e]!==n.props[e]&&t[e]!==n.props[e]&&(r=!1)})),r&&a.push(e[Fd(n.props)])})),a})(t,((t,e)=>{let n=[];e&&e.components&&e.components[t]&&e.components[t].variants&&(n=e.components[t].variants);const r={};return n.forEach((t=>{const e=Fd(t.props);r[e]=t.style})),r})(o,n),n,o)})),p||r.push((t=>{const n=Ud(t.theme)?e:t.theme;return kd(E({},t,{theme:n}))}));const s=r.length-n.length;if(Array.isArray(t)&&s>0){const e=new Array(s).fill("");i=[...t,...e],i.raw=[...t.raw,...e]}else"function"==typeof t&&(i=n=>{let{theme:r}=n,i=Ne(n,jd);return t(E({theme:Ud(r)?e:r},i))});return d(i,...r)}}}({defaultTheme:Zd,rootShouldForwardProp:qd}),Xd=Hd;function $d({props:t,name:e}){return function({props:t,name:e,defaultTheme:n}){const r=function(t){const{theme:e,name:n,props:r}=t;if(!(e&&e.components&&e.components[n]&&e.components[n].defaultProps))return r;const i=E({},r),o=e.components[n].defaultProps;let s;for(s in o)void 0===i[s]&&(i[s]=o[s]);return i}({theme:Mf(n),name:e,props:t});return r}({props:t,name:e,defaultTheme:Zd})}const Yd={active:"Mui-active",checked:"Mui-checked",completed:"Mui-completed",disabled:"Mui-disabled",error:"Mui-error",expanded:"Mui-expanded",focused:"Mui-focused",focusVisible:"Mui-focusVisible",required:"Mui-required",selected:"Mui-selected"};function Qd(t,e){return Yd[e]||`${t}-${e}`}function Kd(t,e){const n={};return e.forEach((e=>{n[e]=Qd(t,e)})),n}function Jd(t){return Qd("MuiPaper",t)}Kd("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const tg=["className","component","elevation","square","variant"],eg=t=>{let e;return e=t<1?5.11916*t**2:4.5*Math.log(t+1)+2,(e/100).toFixed(2)},ng=Xd("div",{name:"MuiPaper",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],!n.square&&e.rounded,"elevation"===n.variant&&e[`elevation${n.elevation}`]]}})((({theme:t,ownerState:e})=>E({backgroundColor:t.palette.background.paper,color:t.palette.text.primary,transition:t.transitions.create("box-shadow")},!e.square&&{borderRadius:t.shape.borderRadius},"outlined"===e.variant&&{border:`1px solid ${t.palette.divider}`},"elevation"===e.variant&&E({boxShadow:t.shadows[e.elevation]},"dark"===t.palette.mode&&{backgroundImage:`linear-gradient(${ah("#fff",eg(e.elevation))}, ${ah("#fff",eg(e.elevation))})`})))),rg=l.forwardRef((function(t,e){const n=$d({props:t,name:"MuiPaper"}),{className:r,component:i="div",elevation:o=1,square:s=!1,variant:a="elevation"}=n,l=Ne(n,tg),u=E({},n,{component:i,elevation:o,square:s,variant:a}),c=(t=>{const{square:e,elevation:n,variant:r,classes:i}=t;return Lf({root:["root",r,!e&&"rounded","elevation"===r&&`elevation${n}`]},Jd,i)})(u);return(0,cp.jsx)(ng,E({as:i,ownerState:u,className:Rf(c.root,r),ref:e},l))}));function ig(t){return Qd("MuiCard",t)}Kd("MuiCard",["root"]);const og=["className","raised"],sg=Xd(rg,{name:"MuiCard",slot:"Root",overridesResolver:(t,e)=>e.root})((()=>({overflow:"hidden"}))),ag=l.forwardRef((function(t,e){const n=$d({props:t,name:"MuiCard"}),{className:r,raised:i=!1}=n,o=Ne(n,og),s=E({},n,{raised:i}),a=(t=>{const{classes:e}=t;return Lf({root:["root"]},ig,e)})(s);return(0,cp.jsx)(sg,E({className:Rf(a.root,r),elevation:i?8:void 0,ref:e,ownerState:s},o))})),lg=["sx"];function ug(t){const{sx:e}=t,n=Ne(t,lg),{systemProps:r,otherProps:i}=(t=>{const e={systemProps:{},otherProps:{}};return Object.keys(t).forEach((n=>{Od[n]?e.systemProps[n]=t[n]:e.otherProps[n]=t[n]})),e})(n);return E({},i,{sx:E({},r,e)})}const cg=["className","component"],hg=function(t={}){const{defaultTheme:e}=t,n=Gf("div")(kd),r=l.forwardRef((function(t,r){const i=Mf(e),o=ug(t),{className:s,component:a="div"}=o,l=Ne(o,cg);return(0,cp.jsx)(n,E({as:a,ref:r,className:Rf(s,"MuiBox-root"),theme:i},l))}));return r}({defaultTheme:sp()}),pg=hg;function fg(t){return Qd("MuiCardContent",t)}Kd("MuiCardContent",["root"]);const dg=["className","component"],gg=Xd("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(t,e)=>e.root})((()=>({padding:16,"&:last-child":{paddingBottom:24}}))),mg=l.forwardRef((function(t,e){const n=$d({props:t,name:"MuiCardContent"}),{className:r,component:i="div"}=n,o=Ne(n,dg),s=E({},n,{component:i}),a=(t=>{const{classes:e}=t;return Lf({root:["root"]},fg,e)})(s);return(0,cp.jsx)(gg,E({as:i,className:Rf(a.root,r),ownerState:s,ref:e},o))})),Ag=Dc;function yg(t){return Qd("MuiTypography",t)}Kd("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const _g=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],vg=Xd("span",{name:"MuiTypography",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.variant&&e[n.variant],"inherit"!==n.align&&e[`align${Ag(n.align)}`],n.noWrap&&e.noWrap,n.gutterBottom&&e.gutterBottom,n.paragraph&&e.paragraph]}})((({theme:t,ownerState:e})=>E({margin:0},e.variant&&t.typography[e.variant],"inherit"!==e.align&&{textAlign:e.align},e.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},e.gutterBottom&&{marginBottom:"0.35em"},e.paragraph&&{marginBottom:16}))),bg={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},xg={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},wg=l.forwardRef((function(t,e){const n=$d({props:t,name:"MuiTypography"}),r=(t=>xg[t]||t)(n.color),i=ug(E({},n,{color:r})),{align:o="inherit",className:s,component:a,gutterBottom:l=!1,noWrap:u=!1,paragraph:c=!1,variant:h="body1",variantMapping:p=bg}=i,f=Ne(i,_g),d=E({},i,{align:o,color:r,className:s,component:a,gutterBottom:l,noWrap:u,paragraph:c,variant:h,variantMapping:p}),g=a||(c?"p":p[h]||bg[h])||"span",m=(t=>{const{align:e,gutterBottom:n,noWrap:r,paragraph:i,variant:o,classes:s}=t;return Lf({root:["root",o,"inherit"!==t.align&&`align${Ag(e)}`,n&&"gutterBottom",r&&"noWrap",i&&"paragraph"]},yg,s)})(d);return(0,cp.jsx)(vg,E({as:g,ref:e,ownerState:d,className:Rf(m.root,s)},f))})),Eg=function(t){return"string"==typeof t};function Sg({props:t,states:e,muiFormControl:n}){return e.reduce(((e,r)=>(e[r]=t[r],n&&void 0===t[r]&&(e[r]=n[r]),e)),{})}const Tg=l.createContext();function Pg(){return l.useContext(Tg)}function Mg(){return Mf(Zd)}function Cg(t,e){"function"==typeof t?t(e):t&&(t.current=e)}function Ig(t,e){return l.useMemo((()=>null==t&&null==e?null:n=>{Cg(t,n),Cg(e,n)}),[t,e])}const Og=Ig,Rg="undefined"!=typeof window?l.useLayoutEffect:l.useEffect,Lg=Rg,kg=function(t,e=166){let n;function r(...r){clearTimeout(n),n=setTimeout((()=>{t.apply(this,r)}),e)}return r.clear=()=>{clearTimeout(n)},r};function Dg(t){return t&&t.ownerDocument||document}function Ng(t){return Dg(t).defaultView||window}const Fg=Ng,Bg=["onChange","maxRows","minRows","style","value"];function zg(t,e){return parseInt(t[e],10)||0}const jg={visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"},Ug=l.forwardRef((function(t,e){const{onChange:n,maxRows:r,minRows:i=1,style:o,value:s}=t,a=Ne(t,Bg),{current:u}=l.useRef(null!=s),c=l.useRef(null),h=Og(e,c),p=l.useRef(null),f=l.useRef(0),[d,g]=l.useState({}),m=l.useCallback((()=>{const e=c.current,n=Fg(e).getComputedStyle(e);if("0px"===n.width)return;const o=p.current;o.style.width=n.width,o.value=e.value||t.placeholder||"x","\n"===o.value.slice(-1)&&(o.value+=" ");const s=n["box-sizing"],a=zg(n,"padding-bottom")+zg(n,"padding-top"),l=zg(n,"border-bottom-width")+zg(n,"border-top-width"),u=o.scrollHeight;o.value="x";const h=o.scrollHeight;let d=u;i&&(d=Math.max(Number(i)*h,d)),r&&(d=Math.min(Number(r)*h,d)),d=Math.max(d,h);const m=d+("border-box"===s?a+l:0),A=Math.abs(d-u)<=1;g((t=>f.current<20&&(m>0&&Math.abs((t.outerHeightStyle||0)-m)>1||t.overflow!==A)?(f.current+=1,{overflow:A,outerHeightStyle:m}):t))}),[r,i,t.placeholder]);return l.useEffect((()=>{const t=kg((()=>{f.current=0,m()})),e=Fg(c.current);let n;return e.addEventListener("resize",t),"undefined"!=typeof ResizeObserver&&(n=new ResizeObserver(t),n.observe(c.current)),()=>{t.clear(),e.removeEventListener("resize",t),n&&n.disconnect()}}),[m]),Lg((()=>{m()})),l.useEffect((()=>{f.current=0}),[s]),(0,cp.jsxs)(l.Fragment,{children:[(0,cp.jsx)("textarea",E({value:s,onChange:t=>{f.current=0,u||m(),n&&n(t)},ref:h,rows:i,style:E({height:d.outerHeightStyle,overflow:d.overflow?"hidden":null},o)},a)),(0,cp.jsx)("textarea",{"aria-hidden":!0,className:t.className,readOnly:!0,ref:p,tabIndex:-1,style:E({},jg,o,{padding:0})})]})})),Vg=Ug;n(8679);var Gg=Sf((function(t,e){var n=t.styles,r=wf([n],void 0,(0,l.useContext)(Tf)),i=(0,l.useRef)();return(0,l.useLayoutEffect)((function(){var t=e.key+"-global",n=new pp({key:t,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),o=!1,s=document.querySelector('style[data-emotion="'+t+" "+r.name+'"]');return e.sheet.tags.length&&(n.before=e.sheet.tags[0]),null!==s&&(o=!0,s.setAttribute("data-emotion",t),n.hydrate([s])),i.current=[n,o],function(){n.flush()}}),[e]),(0,l.useLayoutEffect)((function(){var t=i.current,n=t[0];if(t[1])t[1]=!1;else{if(void 0!==r.next&&Nf(e,r.next,!0),n.tags.length){var o=n.tags[n.tags.length-1].nextElementSibling;n.before=o,n.flush()}e.insert("",r,n,!1)}}),[e,r.name]),null}));function Zg(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return wf(e)}var qg=function(){var t=Zg.apply(void 0,arguments),e="animation-"+t.name;return{name:e,styles:"@keyframes "+e+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}};function Wg(t){const{styles:e,defaultTheme:n={}}=t,r="function"==typeof e?t=>{return e(null==(r=t)||0===Object.keys(r).length?n:t);var r}:e;return(0,cp.jsx)(Gg,{styles:r})}const Hg=function(t){return(0,cp.jsx)(Wg,E({},t,{defaultTheme:Zd}))};function Xg(t){return null!=t&&!(Array.isArray(t)&&0===t.length)}function $g(t,e=!1){return t&&(Xg(t.value)&&""!==t.value||e&&Xg(t.defaultValue)&&""!==t.defaultValue)}function Yg(t){return Qd("MuiInputBase",t)}const Qg=Kd("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),Kg=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","startAdornment","type","value"],Jg=(t,e)=>{const{ownerState:n}=t;return[e.root,n.formControl&&e.formControl,n.startAdornment&&e.adornedStart,n.endAdornment&&e.adornedEnd,n.error&&e.error,"small"===n.size&&e.sizeSmall,n.multiline&&e.multiline,n.color&&e[`color${Ag(n.color)}`],n.fullWidth&&e.fullWidth,n.hiddenLabel&&e.hiddenLabel]},tm=(t,e)=>{const{ownerState:n}=t;return[e.input,"small"===n.size&&e.inputSizeSmall,n.multiline&&e.inputMultiline,"search"===n.type&&e.inputTypeSearch,n.startAdornment&&e.inputAdornedStart,n.endAdornment&&e.inputAdornedEnd,n.hiddenLabel&&e.inputHiddenLabel]},em=Xd("div",{name:"MuiInputBase",slot:"Root",overridesResolver:Jg})((({theme:t,ownerState:e})=>E({},t.typography.body1,{color:t.palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${Qg.disabled}`]:{color:t.palette.text.disabled,cursor:"default"}},e.multiline&&E({padding:"4px 0 5px"},"small"===e.size&&{paddingTop:1}),e.fullWidth&&{width:"100%"}))),nm=Xd("input",{name:"MuiInputBase",slot:"Input",overridesResolver:tm})((({theme:t,ownerState:e})=>{const n="light"===t.palette.mode,r={color:"currentColor",opacity:n?.42:.5,transition:t.transitions.create("opacity",{duration:t.transitions.duration.shorter})},i={opacity:"0 !important"},o={opacity:n?.42:.5};return E({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":r,"&::-moz-placeholder":r,"&:-ms-input-placeholder":r,"&::-ms-input-placeholder":r,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${Qg.formControl} &`]:{"&::-webkit-input-placeholder":i,"&::-moz-placeholder":i,"&:-ms-input-placeholder":i,"&::-ms-input-placeholder":i,"&:focus::-webkit-input-placeholder":o,"&:focus::-moz-placeholder":o,"&:focus:-ms-input-placeholder":o,"&:focus::-ms-input-placeholder":o},[`&.${Qg.disabled}`]:{opacity:1,WebkitTextFillColor:t.palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},"small"===e.size&&{paddingTop:1},e.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},"search"===e.type&&{MozAppearance:"textfield",WebkitAppearance:"textfield"})})),rm=(0,cp.jsx)(Hg,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),im=l.forwardRef((function(t,e){const n=$d({props:t,name:"MuiInputBase"}),{"aria-describedby":r,autoComplete:i,autoFocus:o,className:s,components:a={},componentsProps:u={},defaultValue:c,disabled:h,endAdornment:p,fullWidth:f=!1,id:d,inputComponent:g="input",inputProps:m={},inputRef:A,maxRows:y,minRows:_,multiline:v=!1,name:b,onBlur:x,onChange:w,onClick:S,onFocus:T,onKeyDown:P,onKeyUp:M,placeholder:C,readOnly:I,renderSuffix:O,rows:R,startAdornment:L,type:k="text",value:D}=n,N=Ne(n,Kg),F=Mg(),B=null!=m.value?m.value:D,{current:z}=l.useRef(null!=B),j=l.useRef(),U=l.useCallback((t=>{}),[]),V=Og(m.ref,U),G=Og(A,V),Z=Og(j,G),[q,W]=l.useState(!1),H=Pg(),X=Sg({props:n,muiFormControl:H,states:["color","disabled","error","hiddenLabel","size","required","filled"]});X.focused=H?H.focused:q,l.useEffect((()=>{!H&&h&&q&&(W(!1),x&&x())}),[H,h,q,x]);const $=H&&H.onFilled,Y=H&&H.onEmpty,Q=l.useCallback((t=>{$g(t)?$&&$():Y&&Y()}),[$,Y]);Lg((()=>{z&&Q({value:B})}),[B,Q,z]),l.useEffect((()=>{Q(j.current)}),[]);let K=g,J=m;v&&"input"===K&&(J=E(R?{type:void 0,minRows:R,maxRows:R}:{type:void 0,maxRows:y,minRows:_},J),K=Vg),l.useEffect((()=>{H&&H.setAdornedStart(Boolean(L))}),[H,L]);const tt=E({},n,{color:X.color||"primary",disabled:X.disabled,endAdornment:p,error:X.error,focused:X.focused,formControl:H,fullWidth:f,hiddenLabel:X.hiddenLabel,multiline:v,size:X.size,startAdornment:L,type:k}),et=(t=>{const{classes:e,color:n,disabled:r,error:i,endAdornment:o,focused:s,formControl:a,fullWidth:l,hiddenLabel:u,multiline:c,size:h,startAdornment:p,type:f}=t;return Lf({root:["root",`color${Ag(n)}`,r&&"disabled",i&&"error",l&&"fullWidth",s&&"focused",a&&"formControl","small"===h&&"sizeSmall",c&&"multiline",p&&"adornedStart",o&&"adornedEnd",u&&"hiddenLabel"],input:["input",r&&"disabled","search"===f&&"inputTypeSearch",c&&"inputMultiline","small"===h&&"inputSizeSmall",u&&"inputHiddenLabel",p&&"inputAdornedStart",o&&"inputAdornedEnd"]},Yg,e)})(tt),nt=a.Root||em,rt=u.root||{},it=a.Input||nm;return J=E({},J,u.input),(0,cp.jsxs)(l.Fragment,{children:[rm,(0,cp.jsxs)(nt,E({},rt,!Eg(nt)&&{ownerState:E({},tt,rt.ownerState),theme:F},{ref:e,onClick:t=>{j.current&&t.currentTarget===t.target&&j.current.focus(),S&&S(t)}},N,{className:Rf(et.root,rt.className,s),children:[L,(0,cp.jsx)(Tg.Provider,{value:null,children:(0,cp.jsx)(it,E({ownerState:tt,"aria-invalid":X.error,"aria-describedby":r,autoComplete:i,autoFocus:o,defaultValue:c,disabled:X.disabled,id:d,onAnimationStart:t=>{Q("mui-auto-fill-cancel"===t.animationName?j.current:{value:"x"})},name:b,placeholder:C,readOnly:I,required:X.required,rows:R,value:B,onKeyDown:P,onKeyUp:M,type:k},J,!Eg(it)&&{as:K,ownerState:E({},tt,J.ownerState),theme:F},{ref:Z,className:Rf(et.input,J.className,m.className),onBlur:t=>{x&&x(t),m.onBlur&&m.onBlur(t),H&&H.onBlur?H.onBlur(t):W(!1)},onChange:(t,...e)=>{if(!z){const e=t.target||j.current;if(null==e)throw new Error(kc(1));Q({value:e.value})}m.onChange&&m.onChange(t,...e),w&&w(t,...e)},onFocus:t=>{X.disabled?t.stopPropagation():(T&&T(t),m.onFocus&&m.onFocus(t),H&&H.onFocus?H.onFocus(t):W(!0))}}))}),p,O?O(E({},X,{startAdornment:L})):null]}))]})})),om=im;function sm(t){return Qd("MuiInput",t)}const am=Kd("MuiInput",["root","formControl","focused","disabled","colorSecondary","underline","error","sizeSmall","multiline","fullWidth","input","inputSizeSmall","inputMultiline","inputTypeSearch"]),lm=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","type"],um=Xd(em,{shouldForwardProp:t=>qd(t)||"classes"===t,name:"MuiInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[...Jg(t,e),!n.disableUnderline&&e.underline]}})((({theme:t,ownerState:e})=>{const n="light"===t.palette.mode?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return E({position:"relative"},e.formControl&&{"label + &":{marginTop:16}},!e.disableUnderline&&{"&:after":{borderBottom:`2px solid ${t.palette[e.color].main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${am.focused}:after`]:{transform:"scaleX(1)"},[`&.${am.error}:after`]:{borderBottomColor:t.palette.error.main,transform:"scaleX(1)"},"&:before":{borderBottom:`1px solid ${n}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${am.disabled}):before`]:{borderBottom:`2px solid ${t.palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${n}`}},[`&.${am.disabled}:before`]:{borderBottomStyle:"dotted"}})})),cm=Xd(nm,{name:"MuiInput",slot:"Input",overridesResolver:tm})({}),hm=l.forwardRef((function(t,e){const n=$d({props:t,name:"MuiInput"}),{disableUnderline:r,components:i={},componentsProps:o,fullWidth:s=!1,inputComponent:a="input",multiline:l=!1,type:u="text"}=n,c=Ne(n,lm),h=(t=>{const{classes:e,disableUnderline:n}=t;return E({},e,Lf({root:["root",!n&&"underline"],input:["input"]},sm,e))})(n),p={root:{ownerState:{disableUnderline:r}}},f=o?Mc(o,p):p;return(0,cp.jsx)(om,E({components:E({Root:um,Input:cm},i),componentsProps:f,fullWidth:s,inputComponent:a,multiline:l,ref:e,type:u},c,{classes:h}))}));hm.muiName="Input";const pm=hm;function fm(t){return Qd("MuiFilledInput",t)}const dm=Kd("MuiFilledInput",["root","colorSecondary","underline","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","hiddenLabel","input","inputSizeSmall","inputHiddenLabel","inputMultiline","inputAdornedStart","inputAdornedEnd"]),gm=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","type"],mm=Xd(em,{shouldForwardProp:t=>qd(t)||"classes"===t,name:"MuiFilledInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[...Jg(t,e),!n.disableUnderline&&e.underline]}})((({theme:t,ownerState:e})=>{const n="light"===t.palette.mode,r=n?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",i=n?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)";return E({position:"relative",backgroundColor:i,borderTopLeftRadius:t.shape.borderRadius,borderTopRightRadius:t.shape.borderRadius,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),"&:hover":{backgroundColor:n?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)","@media (hover: none)":{backgroundColor:i}},[`&.${dm.focused}`]:{backgroundColor:i},[`&.${dm.disabled}`]:{backgroundColor:n?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)"}},!e.disableUnderline&&{"&:after":{borderBottom:`2px solid ${t.palette[e.color].main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${dm.focused}:after`]:{transform:"scaleX(1)"},[`&.${dm.error}:after`]:{borderBottomColor:t.palette.error.main,transform:"scaleX(1)"},"&:before":{borderBottom:`1px solid ${r}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${dm.disabled}):before`]:{borderBottom:`1px solid ${t.palette.text.primary}`},[`&.${dm.disabled}:before`]:{borderBottomStyle:"dotted"}},e.startAdornment&&{paddingLeft:12},e.endAdornment&&{paddingRight:12},e.multiline&&E({padding:"25px 12px 8px"},"small"===e.size&&{paddingTop:21,paddingBottom:4},e.hiddenLabel&&{paddingTop:16,paddingBottom:17}))})),Am=Xd(nm,{name:"MuiFilledInput",slot:"Input",overridesResolver:tm})((({theme:t,ownerState:e})=>E({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12,"&:-webkit-autofill":{WebkitBoxShadow:"light"===t.palette.mode?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:"light"===t.palette.mode?null:"#fff",caretColor:"light"===t.palette.mode?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},"small"===e.size&&{paddingTop:21,paddingBottom:4},e.hiddenLabel&&{paddingTop:16,paddingBottom:17},e.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0},e.startAdornment&&{paddingLeft:0},e.endAdornment&&{paddingRight:0},e.hiddenLabel&&"small"===e.size&&{paddingTop:8,paddingBottom:9}))),ym=l.forwardRef((function(t,e){const n=$d({props:t,name:"MuiFilledInput"}),{components:r={},componentsProps:i,fullWidth:o=!1,inputComponent:s="input",multiline:a=!1,type:l="text"}=n,u=Ne(n,gm),c=E({},n,{fullWidth:o,inputComponent:s,multiline:a,type:l}),h=(t=>{const{classes:e,disableUnderline:n}=t;return E({},e,Lf({root:["root",!n&&"underline"],input:["input"]},fm,e))})(n),p={root:{ownerState:c},input:{ownerState:c}},f=i?Mc(i,p):p;return(0,cp.jsx)(om,E({components:E({Root:mm,Input:Am},r),componentsProps:f,fullWidth:o,inputComponent:s,multiline:a,ref:e,type:l},u,{classes:h}))}));ym.muiName="Input";const _m=ym,vm=["children","classes","className","label","notched"],bm=Xd("fieldset")({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),xm=Xd("legend",{skipSx:!0})((({ownerState:t,theme:e})=>E({},void 0===t.label&&{padding:0,lineHeight:"11px",transition:e.transitions.create("width",{duration:150,easing:e.transitions.easing.easeOut})},void 0!==t.label&&E({display:"block",width:"auto",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:e.transitions.create("max-width",{duration:50,easing:e.transitions.easing.easeOut}),"& > span":{paddingLeft:5,paddingRight:5,display:"inline-block"}},t.notched&&{maxWidth:"100%",transition:e.transitions.create("max-width",{duration:100,easing:e.transitions.easing.easeOut,delay:50})}))));function wm(t){return Qd("MuiOutlinedInput",t)}const Em=Kd("MuiOutlinedInput",["root","colorSecondary","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","notchedOutline","input","inputSizeSmall","inputMultiline","inputAdornedStart","inputAdornedEnd"]),Sm=["components","fullWidth","inputComponent","label","multiline","notched","type"],Tm=Xd(em,{shouldForwardProp:t=>qd(t)||"classes"===t,name:"MuiOutlinedInput",slot:"Root",overridesResolver:Jg})((({theme:t,ownerState:e})=>{const n="light"===t.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return E({position:"relative",borderRadius:t.shape.borderRadius,[`&:hover .${Em.notchedOutline}`]:{borderColor:t.palette.text.primary},"@media (hover: none)":{[`&:hover .${Em.notchedOutline}`]:{borderColor:n}},[`&.${Em.focused} .${Em.notchedOutline}`]:{borderColor:t.palette[e.color].main,borderWidth:2},[`&.${Em.error} .${Em.notchedOutline}`]:{borderColor:t.palette.error.main},[`&.${Em.disabled} .${Em.notchedOutline}`]:{borderColor:t.palette.action.disabled}},e.startAdornment&&{paddingLeft:14},e.endAdornment&&{paddingRight:14},e.multiline&&E({padding:"16.5px 14px"},"small"===e.size&&{padding:"8.5px 14px"}))})),Pm=Xd((function(t){const{className:e,label:n,notched:r}=t,i=Ne(t,vm),o=E({},t,{notched:r,label:n});return(0,cp.jsx)(bm,E({"aria-hidden":!0,className:e,ownerState:o},i,{children:(0,cp.jsx)(xm,{ownerState:o,children:n?(0,cp.jsx)("span",{children:n}):(0,cp.jsx)("span",{className:"notranslate",dangerouslySetInnerHTML:{__html:"&#8203;"}})})}))}),{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(t,e)=>e.notchedOutline})((({theme:t})=>({borderColor:"light"===t.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}))),Mm=Xd(nm,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:tm})((({theme:t,ownerState:e})=>E({padding:"16.5px 14px","&:-webkit-autofill":{WebkitBoxShadow:"light"===t.palette.mode?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:"light"===t.palette.mode?null:"#fff",caretColor:"light"===t.palette.mode?null:"#fff",borderRadius:"inherit"}},"small"===e.size&&{padding:"8.5px 14px"},e.multiline&&{padding:0},e.startAdornment&&{paddingLeft:0},e.endAdornment&&{paddingRight:0}))),Cm=l.forwardRef((function(t,e){const n=$d({props:t,name:"MuiOutlinedInput"}),{components:r={},fullWidth:i=!1,inputComponent:o="input",label:s,multiline:a=!1,notched:l,type:u="text"}=n,c=Ne(n,Sm),h=(t=>{const{classes:e}=t;return E({},e,Lf({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},wm,e))})(n);return(0,cp.jsx)(om,E({components:E({Root:Tm,Input:Mm},r),renderSuffix:t=>(0,cp.jsx)(Pm,{className:h.notchedOutline,label:s,notched:void 0!==l?l:Boolean(t.startAdornment||t.filled||t.focused)}),fullWidth:i,inputComponent:o,multiline:a,ref:e,type:u},c,{classes:E({},h,{notchedOutline:null})}))}));Cm.muiName="Input";const Im=Cm;function Om(t){return Qd("MuiFormLabel",t)}const Rm=Kd("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),Lm=["children","className","color","component","disabled","error","filled","focused","required"],km=Xd("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:({ownerState:t},e)=>E({},e.root,"secondary"===t.color&&e.colorSecondary,t.filled&&e.filled)})((({theme:t,ownerState:e})=>E({color:t.palette.text.secondary},t.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",[`&.${Rm.focused}`]:{color:t.palette[e.color].main},[`&.${Rm.disabled}`]:{color:t.palette.text.disabled},[`&.${Rm.error}`]:{color:t.palette.error.main}}))),Dm=Xd("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(t,e)=>e.asterisk})((({theme:t})=>({[`&.${Rm.error}`]:{color:t.palette.error.main}}))),Nm=l.forwardRef((function(t,e){const n=$d({props:t,name:"MuiFormLabel"}),{children:r,className:i,component:o="label"}=n,s=Ne(n,Lm),a=Sg({props:n,muiFormControl:Pg(),states:["color","required","focused","disabled","error","filled"]}),l=E({},n,{color:a.color||"primary",component:o,disabled:a.disabled,error:a.error,filled:a.filled,focused:a.focused,required:a.required}),u=(t=>{const{classes:e,color:n,focused:r,disabled:i,error:o,filled:s,required:a}=t;return Lf({root:["root",`color${Ag(n)}`,i&&"disabled",o&&"error",s&&"filled",r&&"focused",a&&"required"],asterisk:["asterisk",o&&"error"]},Om,e)})(l);return(0,cp.jsxs)(km,E({as:o,ownerState:l,className:Rf(u.root,i),ref:e},s,{children:[r,a.required&&(0,cp.jsxs)(Dm,{ownerState:l,"aria-hidden":!0,className:u.asterisk,children:["","*"]})]}))}));function Fm(t){return Qd("MuiInputLabel",t)}Kd("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const Bm=["disableAnimation","margin","shrink","variant"],zm=Xd(Nm,{shouldForwardProp:t=>qd(t)||"classes"===t,name:"MuiInputLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[{[`& .${Rm.asterisk}`]:e.asterisk},e.root,n.formControl&&e.formControl,"small"===n.size&&e.sizeSmall,n.shrink&&e.shrink,!n.disableAnimation&&e.animated,e[n.variant]]}})((({theme:t,ownerState:e})=>E({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},e.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},"small"===e.size&&{transform:"translate(0, 17px) scale(1)"},e.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!e.disableAnimation&&{transition:t.transitions.create(["color","transform","max-width"],{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut})},"filled"===e.variant&&E({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},"small"===e.size&&{transform:"translate(12px, 13px) scale(1)"},e.shrink&&E({transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},"small"===e.size&&{transform:"translate(12px, 4px) scale(0.75)"})),"outlined"===e.variant&&E({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},"small"===e.size&&{transform:"translate(14px, 9px) scale(1)"},e.shrink&&{maxWidth:"calc(133% - 24px)",transform:"translate(14px, -9px) scale(0.75)"})))),jm=l.forwardRef((function(t,e){const n=$d({name:"MuiInputLabel",props:t}),{disableAnimation:r=!1,shrink:i}=n,o=Ne(n,Bm),s=Pg();let a=i;void 0===a&&s&&(a=s.filled||s.focused||s.adornedStart);const l=Sg({props:n,muiFormControl:s,states:["size","variant","required"]}),u=E({},n,{disableAnimation:r,formControl:s,shrink:a,size:l.size,variant:l.variant,required:l.required}),c=(t=>{const{classes:e,formControl:n,size:r,shrink:i,disableAnimation:o,variant:s,required:a}=t;return E({},e,Lf({root:["root",n&&"formControl",!o&&"animated",i&&"shrink","small"===r&&"sizeSmall",s],asterisk:[a&&"asterisk"]},Fm,e))})(u);return(0,cp.jsx)(zm,E({"data-shrink":a,ownerState:u,ref:e},o,{classes:c}))})),Um=function(t,e){return l.isValidElement(t)&&-1!==e.indexOf(t.type.muiName)};function Vm(t){return Qd("MuiFormControl",t)}Kd("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const Gm=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],Zm=Xd("div",{name:"MuiFormControl",slot:"Root",overridesResolver:({ownerState:t},e)=>E({},e.root,e[`margin${Ag(t.margin)}`],t.fullWidth&&e.fullWidth)})((({ownerState:t})=>E({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},"normal"===t.margin&&{marginTop:16,marginBottom:8},"dense"===t.margin&&{marginTop:8,marginBottom:4},t.fullWidth&&{width:"100%"}))),qm=l.forwardRef((function(t,e){const n=$d({props:t,name:"MuiFormControl"}),{children:r,className:i,color:o="primary",component:s="div",disabled:a=!1,error:u=!1,focused:c,fullWidth:h=!1,hiddenLabel:p=!1,margin:f="none",required:d=!1,size:g="medium",variant:m="outlined"}=n,A=Ne(n,Gm),y=E({},n,{color:o,component:s,disabled:a,error:u,fullWidth:h,hiddenLabel:p,margin:f,required:d,size:g,variant:m}),_=(t=>{const{classes:e,margin:n,fullWidth:r}=t;return Lf({root:["root","none"!==n&&`margin${Ag(n)}`,r&&"fullWidth"]},Vm,e)})(y),[v,b]=l.useState((()=>{let t=!1;return r&&l.Children.forEach(r,(e=>{if(!Um(e,["Input","Select"]))return;const n=Um(e,["Select"])?e.props.input:e;n&&n.props.startAdornment&&(t=!0)})),t})),[x,w]=l.useState((()=>{let t=!1;return r&&l.Children.forEach(r,(e=>{Um(e,["Input","Select"])&&$g(e.props,!0)&&(t=!0)})),t})),[S,T]=l.useState(!1);a&&S&&T(!1);const P=void 0===c||a?S:c,M=l.useCallback((()=>{w(!0)}),[]),C={adornedStart:v,setAdornedStart:b,color:o,disabled:a,error:u,filled:x,focused:P,fullWidth:h,hiddenLabel:p,size:g,onBlur:()=>{T(!1)},onEmpty:l.useCallback((()=>{w(!1)}),[]),onFilled:M,onFocus:()=>{T(!0)},registerEffect:void 0,required:d,variant:m};return(0,cp.jsx)(Tg.Provider,{value:C,children:(0,cp.jsx)(Zm,E({as:s,ownerState:y,className:Rf(_.root,i),ref:e},A,{children:r}))})})),Wm=qm;function Hm(t){return Qd("MuiFormHelperText",t)}const Xm=Kd("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]),$m=["children","className","component","disabled","error","filled","focused","margin","required","variant"],Ym=Xd("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.size&&e[`size${Ag(n.size)}`],n.contained&&e.contained,n.filled&&e.filled]}})((({theme:t,ownerState:e})=>E({color:t.palette.text.secondary},t.typography.caption,{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${Xm.disabled}`]:{color:t.palette.text.disabled},[`&.${Xm.error}`]:{color:t.palette.error.main}},"small"===e.size&&{marginTop:4},e.contained&&{marginLeft:14,marginRight:14}))),Qm=l.forwardRef((function(t,e){const n=$d({props:t,name:"MuiFormHelperText"}),{children:r,className:i,component:o="p"}=n,s=Ne(n,$m),a=Sg({props:n,muiFormControl:Pg(),states:["variant","size","disabled","error","filled","focused","required"]}),l=E({},n,{component:o,contained:"filled"===a.variant||"outlined"===a.variant,variant:a.variant,size:a.size,disabled:a.disabled,error:a.error,filled:a.filled,focused:a.focused,required:a.required}),u=(t=>{const{classes:e,contained:n,size:r,disabled:i,error:o,filled:s,focused:a,required:l}=t;return Lf({root:["root",i&&"disabled",o&&"error",r&&`size${Ag(r)}`,n&&"contained",a&&"focused",s&&"filled",l&&"required"]},Hm,e)})(l);return(0,cp.jsx)(Ym,E({as:o,ownerState:l,className:Rf(u.root,i),ref:e},s,{children:" "===r?(0,cp.jsx)("span",{className:"notranslate",dangerouslySetInnerHTML:{__html:"&#8203;"}}):r}))}));n(6607);const Km=Dg,Jm=l.createContext({});function tA(t){return Qd("MuiList",t)}Kd("MuiList",["root","padding","dense","subheader"]);const eA=["children","className","component","dense","disablePadding","subheader"],nA=Xd("ul",{name:"MuiList",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.disablePadding&&e.padding,n.dense&&e.dense,n.subheader&&e.subheader]}})((({ownerState:t})=>E({listStyle:"none",margin:0,padding:0,position:"relative"},!t.disablePadding&&{paddingTop:8,paddingBottom:8},t.subheader&&{paddingTop:0}))),rA=l.forwardRef((function(t,e){const n=$d({props:t,name:"MuiList"}),{children:r,className:i,component:o="ul",dense:s=!1,disablePadding:a=!1,subheader:u}=n,c=Ne(n,eA),h=l.useMemo((()=>({dense:s})),[s]),p=E({},n,{component:o,dense:s,disablePadding:a}),f=(t=>{const{classes:e,disablePadding:n,dense:r,subheader:i}=t;return Lf({root:["root",!n&&"padding",r&&"dense",i&&"subheader"]},tA,e)})(p);return(0,cp.jsx)(Jm.Provider,{value:h,children:(0,cp.jsxs)(nA,E({as:o,className:Rf(f.root,i),ref:e,ownerState:p},c,{children:[u,r]}))})}));function iA(t){const e=t.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}const oA=iA,sA=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function aA(t,e,n){return t===e?t.firstChild:e&&e.nextElementSibling?e.nextElementSibling:n?null:t.firstChild}function lA(t,e,n){return t===e?n?t.firstChild:t.lastChild:e&&e.previousElementSibling?e.previousElementSibling:n?null:t.lastChild}function uA(t,e){if(void 0===e)return!0;let n=t.innerText;return void 0===n&&(n=t.textContent),n=n.trim().toLowerCase(),0!==n.length&&(e.repeating?n[0]===e.keys[0]:0===n.indexOf(e.keys.join("")))}function cA(t,e,n,r,i,o){let s=!1,a=i(t,e,!!e&&n);for(;a;){if(a===t.firstChild){if(s)return!1;s=!0}const e=!r&&(a.disabled||"true"===a.getAttribute("aria-disabled"));if(a.hasAttribute("tabindex")&&uA(a,o)&&!e)return a.focus(),!0;a=i(t,a,n)}return!1}const hA=l.forwardRef((function(t,e){const{actions:n,autoFocus:r=!1,autoFocusItem:i=!1,children:o,className:s,disabledItemsFocusable:a=!1,disableListWrap:u=!1,onKeyDown:c,variant:h="selectedMenu"}=t,p=Ne(t,sA),f=l.useRef(null),d=l.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});Lg((()=>{r&&f.current.focus()}),[r]),l.useImperativeHandle(n,(()=>({adjustStyleForScrollbar:(t,e)=>{const n=!f.current.style.width;if(t.clientHeight<f.current.clientHeight&&n){const n=`${oA(Km(t))}px`;f.current.style["rtl"===e.direction?"paddingLeft":"paddingRight"]=n,f.current.style.width=`calc(100% + ${n})`}return f.current}})),[]);const g=Og(f,e);let m=-1;l.Children.forEach(o,((t,e)=>{l.isValidElement(t)&&(t.props.disabled||("selectedMenu"===h&&t.props.selected||-1===m)&&(m=e))}));const A=l.Children.map(o,((t,e)=>{if(e===m){const e={};return i&&(e.autoFocus=!0),void 0===t.props.tabIndex&&"selectedMenu"===h&&(e.tabIndex=0),l.cloneElement(t,e)}return t}));return(0,cp.jsx)(rA,E({role:"menu",ref:g,className:s,onKeyDown:t=>{const e=f.current,n=t.key,r=Km(e).activeElement;if("ArrowDown"===n)t.preventDefault(),cA(e,r,u,a,aA);else if("ArrowUp"===n)t.preventDefault(),cA(e,r,u,a,lA);else if("Home"===n)t.preventDefault(),cA(e,null,u,a,aA);else if("End"===n)t.preventDefault(),cA(e,null,u,a,lA);else if(1===n.length){const i=d.current,o=n.toLowerCase(),s=performance.now();i.keys.length>0&&(s-i.lastTime>500?(i.keys=[],i.repeating=!0,i.previousKeyMatched=!0):i.repeating&&o!==i.keys[0]&&(i.repeating=!1)),i.lastTime=s,i.keys.push(o);const l=r&&!i.repeating&&uA(r,i);i.previousKeyMatched&&(l||cA(e,r,!1,a,aA,i))?t.preventDefault():i.previousKeyMatched=!1}c&&c(t)},tabIndex:r?0:-1},p,{children:A}))})),pA=hA;function fA(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,Gt(t,e)}const dA=l.createContext(null);var gA="unmounted",mA="exited",AA="entering",yA="entered",_A="exiting",vA=function(t){function e(e,n){var r;r=t.call(this,e,n)||this;var i,o=n&&!n.isMounting?e.enter:e.appear;return r.appearStatus=null,e.in?o?(i=mA,r.appearStatus=AA):i=yA:i=e.unmountOnExit||e.mountOnEnter?gA:mA,r.state={status:i},r.nextCallback=null,r}fA(e,t),e.getDerivedStateFromProps=function(t,e){return t.in&&e.status===gA?{status:mA}:null};var n=e.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(t){var e=null;if(t!==this.props){var n=this.state.status;this.props.in?n!==AA&&n!==yA&&(e=AA):n!==AA&&n!==yA||(e=_A)}this.updateStatus(!1,e)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var t,e,n,r=this.props.timeout;return t=e=n=r,null!=r&&"number"!=typeof r&&(t=r.exit,e=r.enter,n=void 0!==r.appear?r.appear:e),{exit:t,enter:e,appear:n}},n.updateStatus=function(t,e){void 0===t&&(t=!1),null!==e?(this.cancelNextCallback(),e===AA?this.performEnter(t):this.performExit()):this.props.unmountOnExit&&this.state.status===mA&&this.setState({status:gA})},n.performEnter=function(t){var e=this,n=this.props.enter,r=this.context?this.context.isMounting:t,i=this.props.nodeRef?[r]:[u.findDOMNode(this),r],o=i[0],s=i[1],a=this.getTimeouts(),l=r?a.appear:a.enter;t||n?(this.props.onEnter(o,s),this.safeSetState({status:AA},(function(){e.props.onEntering(o,s),e.onTransitionEnd(l,(function(){e.safeSetState({status:yA},(function(){e.props.onEntered(o,s)}))}))}))):this.safeSetState({status:yA},(function(){e.props.onEntered(o)}))},n.performExit=function(){var t=this,e=this.props.exit,n=this.getTimeouts(),r=this.props.nodeRef?void 0:u.findDOMNode(this);e?(this.props.onExit(r),this.safeSetState({status:_A},(function(){t.props.onExiting(r),t.onTransitionEnd(n.exit,(function(){t.safeSetState({status:mA},(function(){t.props.onExited(r)}))}))}))):this.safeSetState({status:mA},(function(){t.props.onExited(r)}))},n.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(t,e){e=this.setNextCallback(e),this.setState(t,e)},n.setNextCallback=function(t){var e=this,n=!0;return this.nextCallback=function(r){n&&(n=!1,e.nextCallback=null,t(r))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},n.onTransitionEnd=function(t,e){this.setNextCallback(e);var n=this.props.nodeRef?this.props.nodeRef.current:u.findDOMNode(this),r=null==t&&!this.props.addEndListener;if(n&&!r){if(this.props.addEndListener){var i=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],o=i[0],s=i[1];this.props.addEndListener(o,s)}null!=t&&setTimeout(this.nextCallback,t)}else setTimeout(this.nextCallback,0)},n.render=function(){var t=this.state.status;if(t===gA)return null;var e=this.props,n=e.children,r=(e.in,e.mountOnEnter,e.unmountOnExit,e.appear,e.enter,e.exit,e.timeout,e.addEndListener,e.onEnter,e.onEntering,e.onEntered,e.onExit,e.onExiting,e.onExited,e.nodeRef,Ne(e,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return l.createElement(dA.Provider,{value:null},"function"==typeof n?n(t,r):l.cloneElement(l.Children.only(n),r))},e}(l.Component);function bA(){}vA.contextType=dA,vA.propTypes={},vA.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:bA,onEntering:bA,onEntered:bA,onExit:bA,onExiting:bA,onExited:bA},vA.UNMOUNTED=gA,vA.EXITED=mA,vA.ENTERING=AA,vA.ENTERED=yA,vA.EXITING=_A;const xA=vA,wA=t=>t.scrollTop;function EA(t,e){var n,r;const{timeout:i,easing:o,style:s={}}=t;return{duration:null!=(n=s.transitionDuration)?n:"number"==typeof i?i:i[e.mode]||0,easing:null!=(r=s.transitionTimingFunction)?r:"object"==typeof o?o[e.mode]:o,delay:s.transitionDelay}}const SA=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function TA(t){return`scale(${t}, ${t**2})`}const PA={entering:{opacity:1,transform:TA(1)},entered:{opacity:1,transform:"none"}},MA=l.forwardRef((function(t,e){const{addEndListener:n,appear:r=!0,children:i,easing:o,in:s,onEnter:a,onEntered:u,onEntering:c,onExit:h,onExited:p,onExiting:f,style:d,timeout:g="auto",TransitionComponent:m=xA}=t,A=Ne(t,SA),y=l.useRef(),_=l.useRef(),v=Mg(),b=l.useRef(null),x=Og(i.ref,e),w=Og(b,x),S=t=>e=>{if(t){const n=b.current;void 0===e?t(n):t(n,e)}},T=S(c),P=S(((t,e)=>{wA(t);const{duration:n,delay:r,easing:i}=EA({style:d,timeout:g,easing:o},{mode:"enter"});let s;"auto"===g?(s=v.transitions.getAutoHeightDuration(t.clientHeight),_.current=s):s=n,t.style.transition=[v.transitions.create("opacity",{duration:s,delay:r}),v.transitions.create("transform",{duration:.666*s,delay:r,easing:i})].join(","),a&&a(t,e)})),M=S(u),C=S(f),I=S((t=>{const{duration:e,delay:n,easing:r}=EA({style:d,timeout:g,easing:o},{mode:"exit"});let i;"auto"===g?(i=v.transitions.getAutoHeightDuration(t.clientHeight),_.current=i):i=e,t.style.transition=[v.transitions.create("opacity",{duration:i,delay:n}),v.transitions.create("transform",{duration:.666*i,delay:n||.333*i,easing:r})].join(","),t.style.opacity="0",t.style.transform=TA(.75),h&&h(t)})),O=S(p);return l.useEffect((()=>()=>{clearTimeout(y.current)}),[]),(0,cp.jsx)(m,E({appear:r,in:s,nodeRef:b,onEnter:P,onEntered:M,onEntering:T,onExit:I,onExited:O,onExiting:C,addEndListener:t=>{"auto"===g&&(y.current=setTimeout(t,_.current||0)),n&&n(b.current,t)},timeout:"auto"===g?null:g},A,{children:(t,e)=>l.cloneElement(i,E({style:E({opacity:0,transform:TA(.75),visibility:"exited"!==t||s?void 0:"hidden"},PA[t],d,i.props.style),ref:w},e))}))}));MA.muiSupportAuto=!0;const CA=MA;function IA(t){const e=l.useRef(t);return Rg((()=>{e.current=t})),l.useCallback(((...t)=>(0,e.current)(...t)),[])}function OA(...t){return t.reduce(((t,e)=>null==e?t:function(...n){t.apply(this,n),e.apply(this,n)}),(()=>{}))}const RA=l.forwardRef((function(t,e){const{children:n,container:r,disablePortal:i=!1}=t,[o,s]=l.useState(null),a=Ig(l.isValidElement(n)?n.ref:null,e);return Rg((()=>{i||s(function(t){return"function"==typeof t?t():t}(r)||document.body)}),[r,i]),Rg((()=>{if(o&&!i)return Cg(e,o),()=>{Cg(e,null)}}),[e,o,i]),i?l.isValidElement(n)?l.cloneElement(n,{ref:a}):n:o?u.createPortal(n,o):o}));function LA(t,e){e?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden")}function kA(t){return parseInt(Ng(t).getComputedStyle(t).paddingRight,10)||0}function DA(t,e,n,r=[],i){const o=[e,n,...r],s=["TEMPLATE","SCRIPT","STYLE"];[].forEach.call(t.children,(t=>{-1===o.indexOf(t)&&-1===s.indexOf(t.tagName)&&LA(t,i)}))}function NA(t,e){let n=-1;return t.some(((t,r)=>!!e(t)&&(n=r,!0))),n}const FA=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function BA(t){const e=[],n=[];return Array.from(t.querySelectorAll(FA)).forEach(((t,r)=>{const i=function(t){const e=parseInt(t.getAttribute("tabindex"),10);return Number.isNaN(e)?"true"===t.contentEditable||("AUDIO"===t.nodeName||"VIDEO"===t.nodeName||"DETAILS"===t.nodeName)&&null===t.getAttribute("tabindex")?0:t.tabIndex:e}(t);-1!==i&&function(t){return!(t.disabled||"INPUT"===t.tagName&&"hidden"===t.type||function(t){if("INPUT"!==t.tagName||"radio"!==t.type)return!1;if(!t.name)return!1;const e=e=>t.ownerDocument.querySelector(`input[type="radio"]${e}`);let n=e(`[name="${t.name}"]:checked`);return n||(n=e(`[name="${t.name}"]`)),n!==t}(t))}(t)&&(0===i?e.push(t):n.push({documentOrder:r,tabIndex:i,node:t}))})),n.sort(((t,e)=>t.tabIndex===e.tabIndex?t.documentOrder-e.documentOrder:t.tabIndex-e.tabIndex)).map((t=>t.node)).concat(e)}function zA(){return!0}const jA=function(t){const{children:e,disableAutoFocus:n=!1,disableEnforceFocus:r=!1,disableRestoreFocus:i=!1,getTabbable:o=BA,isEnabled:s=zA,open:a}=t,u=l.useRef(),c=l.useRef(null),h=l.useRef(null),p=l.useRef(null),f=l.useRef(null),d=l.useRef(!1),g=l.useRef(null),m=Ig(e.ref,g),A=l.useRef(null);l.useEffect((()=>{a&&g.current&&(d.current=!n)}),[n,a]),l.useEffect((()=>{if(!a||!g.current)return;const t=Dg(g.current);return g.current.contains(t.activeElement)||(g.current.hasAttribute("tabIndex")||g.current.setAttribute("tabIndex",-1),d.current&&g.current.focus()),()=>{i||(p.current&&p.current.focus&&(u.current=!0,p.current.focus()),p.current=null)}}),[a]),l.useEffect((()=>{if(!a||!g.current)return;const t=Dg(g.current),e=e=>{const{current:n}=g;if(null!==n)if(t.hasFocus()&&!r&&s()&&!u.current){if(!n.contains(t.activeElement)){if(e&&f.current!==e.target||t.activeElement!==f.current)f.current=null;else if(null!==f.current)return;if(!d.current)return;let r=[];if(t.activeElement!==c.current&&t.activeElement!==h.current||(r=o(g.current)),r.length>0){var i,a;const t=Boolean((null==(i=A.current)?void 0:i.shiftKey)&&"Tab"===(null==(a=A.current)?void 0:a.key)),e=r[0],n=r[r.length-1];t?n.focus():e.focus()}else n.focus()}}else u.current=!1},n=e=>{A.current=e,!r&&s()&&"Tab"===e.key&&t.activeElement===g.current&&e.shiftKey&&(u.current=!0,h.current.focus())};t.addEventListener("focusin",e),t.addEventListener("keydown",n,!0);const i=setInterval((()=>{"BODY"===t.activeElement.tagName&&e()}),50);return()=>{clearInterval(i),t.removeEventListener("focusin",e),t.removeEventListener("keydown",n,!0)}}),[n,r,i,s,a,o]);const y=t=>{null===p.current&&(p.current=t.relatedTarget),d.current=!0};return(0,cp.jsxs)(l.Fragment,{children:[(0,cp.jsx)("div",{tabIndex:0,onFocus:y,ref:c,"data-test":"sentinelStart"}),l.cloneElement(e,{ref:m,onFocus:t=>{null===p.current&&(p.current=t.relatedTarget),d.current=!0,f.current=t.target;const n=e.props.onFocus;n&&n(t)}}),(0,cp.jsx)("div",{tabIndex:0,onFocus:y,ref:h,"data-test":"sentinelEnd"})]})};function UA(t){return Qd("MuiModal",t)}Kd("MuiModal",["root","hidden"]);const VA=["BackdropComponent","BackdropProps","children","classes","className","closeAfterTransition","component","components","componentsProps","container","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","manager","onBackdropClick","onClose","onKeyDown","open","theme","onTransitionEnter","onTransitionExited"],GA=new class{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(t,e){let n=this.modals.indexOf(t);if(-1!==n)return n;n=this.modals.length,this.modals.push(t),t.modalRef&&LA(t.modalRef,!1);const r=function(t){const e=[];return[].forEach.call(t.children,(t=>{"true"===t.getAttribute("aria-hidden")&&e.push(t)})),e}(e);DA(e,t.mount,t.modalRef,r,!0);const i=NA(this.containers,(t=>t.container===e));return-1!==i?(this.containers[i].modals.push(t),n):(this.containers.push({modals:[t],container:e,restore:null,hiddenSiblings:r}),n)}mount(t,e){const n=NA(this.containers,(e=>-1!==e.modals.indexOf(t))),r=this.containers[n];r.restore||(r.restore=function(t,e){const n=[],r=t.container;if(!e.disableScrollLock){if(function(t){const e=Dg(t);return e.body===t?Ng(t).innerWidth>e.documentElement.clientWidth:t.scrollHeight>t.clientHeight}(r)){const t=iA(Dg(r));n.push({value:r.style.paddingRight,property:"padding-right",el:r}),r.style.paddingRight=`${kA(r)+t}px`;const e=Dg(r).querySelectorAll(".mui-fixed");[].forEach.call(e,(e=>{n.push({value:e.style.paddingRight,property:"padding-right",el:e}),e.style.paddingRight=`${kA(e)+t}px`}))}const t=r.parentElement,e=Ng(r),i="HTML"===(null==t?void 0:t.nodeName)&&"scroll"===e.getComputedStyle(t).overflowY?t:r;n.push({value:i.style.overflow,property:"overflow",el:i},{value:i.style.overflowX,property:"overflow-x",el:i},{value:i.style.overflowY,property:"overflow-y",el:i}),i.style.overflow="hidden"}return()=>{n.forEach((({value:t,el:e,property:n})=>{t?e.style.setProperty(n,t):e.style.removeProperty(n)}))}}(r,e))}remove(t){const e=this.modals.indexOf(t);if(-1===e)return e;const n=NA(this.containers,(e=>-1!==e.modals.indexOf(t))),r=this.containers[n];if(r.modals.splice(r.modals.indexOf(t),1),this.modals.splice(e,1),0===r.modals.length)r.restore&&r.restore(),t.modalRef&&LA(t.modalRef,!0),DA(r.container,t.mount,t.modalRef,r.hiddenSiblings,!1),this.containers.splice(n,1);else{const t=r.modals[r.modals.length-1];t.modalRef&&LA(t.modalRef,!1)}return e}isTopModal(t){return this.modals.length>0&&this.modals[this.modals.length-1]===t}},ZA=l.forwardRef((function(t,e){const{BackdropComponent:n,BackdropProps:r,children:i,classes:o,className:s,closeAfterTransition:a=!1,component:u="div",components:c={},componentsProps:h={},container:p,disableAutoFocus:f=!1,disableEnforceFocus:d=!1,disableEscapeKeyDown:g=!1,disablePortal:m=!1,disableRestoreFocus:A=!1,disableScrollLock:y=!1,hideBackdrop:_=!1,keepMounted:v=!1,manager:b=GA,onBackdropClick:x,onClose:w,onKeyDown:S,open:T,theme:P,onTransitionEnter:M,onTransitionExited:C}=t,I=Ne(t,VA),[O,R]=l.useState(!0),L=l.useRef({}),k=l.useRef(null),D=l.useRef(null),N=Ig(D,e),F=function(t){return!!t.children&&t.children.props.hasOwnProperty("in")}(t),B=()=>(L.current.modalRef=D.current,L.current.mountNode=k.current,L.current),z=()=>{b.mount(B(),{disableScrollLock:y}),D.current.scrollTop=0},j=IA((()=>{const t=function(t){return"function"==typeof t?t():t}(p)||Dg(k.current).body;b.add(B(),t),D.current&&z()})),U=l.useCallback((()=>b.isTopModal(B())),[b]),V=IA((t=>{k.current=t,t&&(T&&U()?z():LA(D.current,!0))})),G=l.useCallback((()=>{b.remove(B())}),[b]);l.useEffect((()=>()=>{G()}),[G]),l.useEffect((()=>{T?j():F&&a||G()}),[T,G,F,a,j]);const Z=E({},t,{classes:o,closeAfterTransition:a,disableAutoFocus:f,disableEnforceFocus:d,disableEscapeKeyDown:g,disablePortal:m,disableRestoreFocus:A,disableScrollLock:y,exited:O,hideBackdrop:_,keepMounted:v}),q=(t=>{const{open:e,exited:n,classes:r}=t;return Lf({root:["root",!e&&n&&"hidden"]},UA,r)})(Z);if(!v&&!T&&(!F||O))return null;const W={};void 0===i.props.tabIndex&&(W.tabIndex="-1"),F&&(W.onEnter=OA((()=>{R(!1),M&&M()}),i.props.onEnter),W.onExited=OA((()=>{R(!0),C&&C(),a&&G()}),i.props.onExited));const H=c.Root||u,X=h.root||{};return(0,cp.jsx)(RA,{ref:V,container:p,disablePortal:m,children:(0,cp.jsxs)(H,E({role:"presentation"},X,!Eg(H)&&{as:u,ownerState:E({},Z,X.ownerState),theme:P},I,{ref:N,onKeyDown:t=>{S&&S(t),"Escape"===t.key&&U()&&(g||(t.stopPropagation(),w&&w(t,"escapeKeyDown")))},className:Rf(q.root,X.className,s),children:[!_&&n?(0,cp.jsx)(n,E({open:T,onClick:t=>{t.target===t.currentTarget&&(x&&x(t),w&&w(t,"backdropClick"))}},r)):null,(0,cp.jsx)(jA,{disableEnforceFocus:d,disableAutoFocus:f,disableRestoreFocus:A,isEnabled:U,open:T,children:l.cloneElement(i,W)})]}))})})),qA=ZA;function WA(t){return Qd("MuiBackdrop",t)}Kd("MuiBackdrop",["root","invisible"]);const HA=["classes","className","invisible","component","components","componentsProps","theme"],XA=l.forwardRef((function(t,e){const{classes:n,className:r,invisible:i=!1,component:o="div",components:s={},componentsProps:a={},theme:l}=t,u=Ne(t,HA),c=E({},t,{classes:n,invisible:i}),h=(t=>{const{classes:e,invisible:n}=t;return Lf({root:["root",n&&"invisible"]},WA,e)})(c),p=s.Root||o,f=a.root||{};return(0,cp.jsx)(p,E({"aria-hidden":!0},f,!Eg(p)&&{as:o,ownerState:E({},c,f.ownerState),theme:l},{ref:e},u,{className:Rf(h.root,f.className,r)}))})),$A=XA,YA=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],QA={entering:{opacity:1},entered:{opacity:1}},KA={enter:tp.enteringScreen,exit:tp.leavingScreen},JA=l.forwardRef((function(t,e){const{addEndListener:n,appear:r=!0,children:i,easing:o,in:s,onEnter:a,onEntered:u,onEntering:c,onExit:h,onExited:p,onExiting:f,style:d,timeout:g=KA,TransitionComponent:m=xA}=t,A=Ne(t,YA),y=Mg(),_=l.useRef(null),v=Og(i.ref,e),b=Og(_,v),x=t=>e=>{if(t){const n=_.current;void 0===e?t(n):t(n,e)}},w=x(c),S=x(((t,e)=>{wA(t);const n=EA({style:d,timeout:g,easing:o},{mode:"enter"});t.style.webkitTransition=y.transitions.create("opacity",n),t.style.transition=y.transitions.create("opacity",n),a&&a(t,e)})),T=x(u),P=x(f),M=x((t=>{const e=EA({style:d,timeout:g,easing:o},{mode:"exit"});t.style.webkitTransition=y.transitions.create("opacity",e),t.style.transition=y.transitions.create("opacity",e),h&&h(t)})),C=x(p);return(0,cp.jsx)(m,E({appear:r,in:s,nodeRef:_,onEnter:S,onEntered:T,onEntering:w,onExit:M,onExited:C,onExiting:P,addEndListener:t=>{n&&n(_.current,t)},timeout:g},A,{children:(t,e)=>l.cloneElement(i,E({style:E({opacity:0,visibility:"exited"!==t||s?void 0:"hidden"},QA[t],d,i.props.style),ref:b},e))}))})),ty=JA,ey=["children","components","componentsProps","className","invisible","open","transitionDuration","TransitionComponent"],ny=Xd("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.invisible&&e.invisible]}})((({ownerState:t})=>E({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},t.invisible&&{backgroundColor:"transparent"}))),ry=l.forwardRef((function(t,e){var n;const r=$d({props:t,name:"MuiBackdrop"}),{children:i,components:o={},componentsProps:s={},className:a,invisible:l=!1,open:u,transitionDuration:c,TransitionComponent:h=ty}=r,p=Ne(r,ey),f=(t=>{const{classes:e}=t;return e})(E({},r,{invisible:l}));return(0,cp.jsx)(h,E({in:u,timeout:c},p,{children:(0,cp.jsx)($A,{className:a,invisible:l,components:E({Root:ny},o),componentsProps:{root:E({},s.root,(!o.Root||!Eg(o.Root))&&{ownerState:E({},null==(n=s.root)?void 0:n.ownerState)})},classes:f,ref:e,children:i})}))})),iy=["BackdropComponent","closeAfterTransition","children","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted"],oy=Xd("div",{name:"MuiModal",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.open&&n.exited&&e.hidden]}})((({theme:t,ownerState:e})=>E({position:"fixed",zIndex:t.zIndex.modal,right:0,bottom:0,top:0,left:0},!e.open&&e.exited&&{visibility:"hidden"}))),sy=Xd(ry,{name:"MuiModal",slot:"Backdrop",overridesResolver:(t,e)=>e.backdrop})({zIndex:-1}),ay=l.forwardRef((function(t,e){var n;const r=$d({name:"MuiModal",props:t}),{BackdropComponent:i=sy,closeAfterTransition:o=!1,children:s,components:a={},componentsProps:u={},disableAutoFocus:c=!1,disableEnforceFocus:h=!1,disableEscapeKeyDown:p=!1,disablePortal:f=!1,disableRestoreFocus:d=!1,disableScrollLock:g=!1,hideBackdrop:m=!1,keepMounted:A=!1}=r,y=Ne(r,iy),[_,v]=l.useState(!0),b={closeAfterTransition:o,disableAutoFocus:c,disableEnforceFocus:h,disableEscapeKeyDown:p,disablePortal:f,disableRestoreFocus:d,disableScrollLock:g,hideBackdrop:m,keepMounted:A},x=E({},r,b,{exited:_}).classes;return(0,cp.jsx)(qA,E({components:E({Root:oy},a),componentsProps:{root:E({},u.root,(!a.Root||!Eg(a.Root))&&{ownerState:E({},null==(n=u.root)?void 0:n.ownerState)})},BackdropComponent:i,onTransitionEnter:()=>v(!1),onTransitionExited:()=>v(!0),ref:e},y,{classes:x},b,{children:s}))}));function ly(t){return Qd("MuiPopover",t)}Kd("MuiPopover",["root","paper"]);const uy=["onEntering"],cy=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps"];function hy(t,e){let n=0;return"number"==typeof e?n=e:"center"===e?n=t.height/2:"bottom"===e&&(n=t.height),n}function py(t,e){let n=0;return"number"==typeof e?n=e:"center"===e?n=t.width/2:"right"===e&&(n=t.width),n}function fy(t){return[t.horizontal,t.vertical].map((t=>"number"==typeof t?`${t}px`:t)).join(" ")}function dy(t){return"function"==typeof t?t():t}const gy=Xd(ay,{name:"MuiPopover",slot:"Root",overridesResolver:(t,e)=>e.root})({}),my=Xd(rg,{name:"MuiPopover",slot:"Paper",overridesResolver:(t,e)=>e.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),Ay=l.forwardRef((function(t,e){const n=$d({props:t,name:"MuiPopover"}),{action:r,anchorEl:i,anchorOrigin:o={vertical:"top",horizontal:"left"},anchorPosition:s,anchorReference:a="anchorEl",children:u,className:c,container:h,elevation:p=8,marginThreshold:f=16,open:d,PaperProps:g={},transformOrigin:m={vertical:"top",horizontal:"left"},TransitionComponent:A=CA,transitionDuration:y="auto",TransitionProps:{onEntering:_}={}}=n,v=Ne(n.TransitionProps,uy),b=Ne(n,cy),x=l.useRef(),w=Og(x,g.ref),S=E({},n,{anchorOrigin:o,anchorReference:a,elevation:p,marginThreshold:f,PaperProps:g,transformOrigin:m,TransitionComponent:A,transitionDuration:y,TransitionProps:v}),T=(t=>{const{classes:e}=t;return Lf({root:["root"],paper:["paper"]},ly,e)})(S),P=l.useCallback((()=>{if("anchorPosition"===a)return s;const t=dy(i),e=(t&&1===t.nodeType?t:Km(x.current).body).getBoundingClientRect();return{top:e.top+hy(e,o.vertical),left:e.left+py(e,o.horizontal)}}),[i,o.horizontal,o.vertical,s,a]),M=l.useCallback((t=>({vertical:hy(t,m.vertical),horizontal:py(t,m.horizontal)})),[m.horizontal,m.vertical]),C=l.useCallback((t=>{const e={width:t.offsetWidth,height:t.offsetHeight},n=M(e);if("none"===a)return{top:null,left:null,transformOrigin:fy(n)};const r=P();let o=r.top-n.vertical,s=r.left-n.horizontal;const l=o+e.height,u=s+e.width,c=Fg(dy(i)),h=c.innerHeight-f,p=c.innerWidth-f;if(o<f){const t=o-f;o-=t,n.vertical+=t}else if(l>h){const t=l-h;o-=t,n.vertical+=t}if(s<f){const t=s-f;s-=t,n.horizontal+=t}else if(u>p){const t=u-p;s-=t,n.horizontal+=t}return{top:`${Math.round(o)}px`,left:`${Math.round(s)}px`,transformOrigin:fy(n)}}),[i,a,P,M,f]),I=l.useCallback((()=>{const t=x.current;if(!t)return;const e=C(t);null!==e.top&&(t.style.top=e.top),null!==e.left&&(t.style.left=e.left),t.style.transformOrigin=e.transformOrigin}),[C]);l.useEffect((()=>{d&&I()})),l.useImperativeHandle(r,(()=>d?{updatePosition:()=>{I()}}:null),[d,I]),l.useEffect((()=>{if(!d)return;const t=kg((()=>{I()})),e=Fg(i);return e.addEventListener("resize",t),()=>{t.clear(),e.removeEventListener("resize",t)}}),[i,d,I]);let O=y;"auto"!==y||A.muiSupportAuto||(O=void 0);const R=h||(i?Km(dy(i)).body:void 0);return(0,cp.jsx)(gy,E({BackdropProps:{invisible:!0},className:Rf(T.root,c),container:R,open:d,ref:e,ownerState:S},b,{children:(0,cp.jsx)(A,E({appear:!0,in:d,onEntering:(t,e)=>{_&&_(t,e),I()},timeout:O},v,{children:(0,cp.jsx)(my,E({elevation:p},g,{ref:w,className:Rf(T.paper,g.className),children:u}))}))}))}));function yy(t){return Qd("MuiMenu",t)}Kd("MuiMenu",["root","paper","list"]);const _y=["onEntering"],vy=["autoFocus","children","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant"],by={vertical:"top",horizontal:"right"},xy={vertical:"top",horizontal:"left"},wy=Xd(Ay,{shouldForwardProp:t=>qd(t)||"classes"===t,name:"MuiMenu",slot:"Root",overridesResolver:(t,e)=>e.root})({}),Ey=Xd(rg,{name:"MuiMenu",slot:"Paper",overridesResolver:(t,e)=>e.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),Sy=Xd(pA,{name:"MuiMenu",slot:"List",overridesResolver:(t,e)=>e.list})({outline:0}),Ty=l.forwardRef((function(t,e){const n=$d({props:t,name:"MuiMenu"}),{autoFocus:r=!0,children:i,disableAutoFocusItem:o=!1,MenuListProps:s={},onClose:a,open:u,PaperProps:c={},PopoverClasses:h,transitionDuration:p="auto",TransitionProps:{onEntering:f}={},variant:d="selectedMenu"}=n,g=Ne(n.TransitionProps,_y),m=Ne(n,vy),A=Mg(),y="rtl"===A.direction,_=E({},n,{autoFocus:r,disableAutoFocusItem:o,MenuListProps:s,onEntering:f,PaperProps:c,transitionDuration:p,TransitionProps:g,variant:d}),v=(t=>{const{classes:e}=t;return Lf({root:["root"],paper:["paper"],list:["list"]},yy,e)})(_),b=r&&!o&&u,x=l.useRef(null);let w=-1;return l.Children.map(i,((t,e)=>{l.isValidElement(t)&&(t.props.disabled||("selectedMenu"===d&&t.props.selected||-1===w)&&(w=e))})),(0,cp.jsx)(wy,E({classes:h,onClose:a,anchorOrigin:{vertical:"bottom",horizontal:y?"right":"left"},transformOrigin:y?by:xy,PaperProps:E({component:Ey},c,{classes:E({},c.classes,{root:v.paper})}),className:v.root,open:u,ref:e,transitionDuration:p,TransitionProps:E({onEntering:(t,e)=>{x.current&&x.current.adjustStyleForScrollbar(t,A),f&&f(t,e)}},g),ownerState:_},m,{children:(0,cp.jsx)(Sy,E({onKeyDown:t=>{"Tab"===t.key&&(t.preventDefault(),a&&a(t,"tabKeyDown"))},actions:x,autoFocus:r&&(-1===w||o),autoFocusItem:b,variant:d},s,{className:Rf(v.list,s.className),children:i}))}))})),Py=Ty;function My(t){return Qd("MuiNativeSelect",t)}const Cy=Kd("MuiNativeSelect",["root","select","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput"]),Iy=["className","disabled","IconComponent","inputRef","variant"],Oy=({ownerState:t,theme:e})=>E({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":{backgroundColor:"light"===e.palette.mode?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)",borderRadius:0},"&::-ms-expand":{display:"none"},[`&.${Cy.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:e.palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},"filled"===t.variant&&{"&&&":{paddingRight:32}},"outlined"===t.variant&&{borderRadius:e.shape.borderRadius,"&:focus":{borderRadius:e.shape.borderRadius},"&&&":{paddingRight:32}}),Ry=Xd("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:qd,overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.select,e[n.variant]]}})(Oy),Ly=({ownerState:t,theme:e})=>E({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:e.palette.action.active,[`&.${Cy.disabled}`]:{color:e.palette.action.disabled}},t.open&&{transform:"rotate(180deg)"},"filled"===t.variant&&{right:7},"outlined"===t.variant&&{right:7}),ky=Xd("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.icon,n.variant&&e[`icon${Ag(n.variant)}`],n.open&&e.iconOpen]}})(Ly),Dy=l.forwardRef((function(t,e){const{className:n,disabled:r,IconComponent:i,inputRef:o,variant:s="standard"}=t,a=Ne(t,Iy),u=E({},t,{disabled:r,variant:s}),c=(t=>{const{classes:e,variant:n,disabled:r,open:i}=t;return Lf({select:["select",n,r&&"disabled"],icon:["icon",`icon${Ag(n)}`,i&&"iconOpen",r&&"disabled"]},My,e)})(u);return(0,cp.jsxs)(l.Fragment,{children:[(0,cp.jsx)(Ry,E({ownerState:u,className:Rf(c.select,n),disabled:r,ref:o||e},a)),t.multiple?null:(0,cp.jsx)(ky,{as:i,ownerState:u,className:c.icon})]})}));function Ny(t){return Qd("MuiSelect",t)}const Fy=Kd("MuiSelect",["root","select","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput"]),By=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultValue","disabled","displayEmpty","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],zy=Xd("div",{name:"MuiSelect",slot:"Select",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[{[`&.${Fy.select}`]:e.select},{[`&.${Fy.select}`]:e[n.variant]}]}})(Oy,{[`&.${Fy.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),jy=Xd("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.icon,n.variant&&e[`icon${Ag(n.variant)}`],n.open&&e.iconOpen]}})(Ly),Uy=Xd("input",{shouldForwardProp:t=>Wd(t)&&"classes"!==t,name:"MuiSelect",slot:"NativeInput",overridesResolver:(t,e)=>e.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function Vy(t,e){return"object"==typeof e&&null!==e?t===e:String(t)===String(e)}function Gy(t){return null==t||"string"==typeof t&&!t.trim()}const Zy=l.forwardRef((function(t,e){const{"aria-describedby":n,"aria-label":r,autoFocus:i,autoWidth:o,children:s,className:a,defaultValue:u,disabled:c,displayEmpty:h,IconComponent:p,inputRef:f,labelId:d,MenuProps:g={},multiple:m,name:A,onBlur:y,onChange:_,onClose:v,onFocus:b,onOpen:x,open:w,readOnly:S,renderValue:T,SelectDisplayProps:P={},tabIndex:M,value:C,variant:I="standard"}=t,O=Ne(t,By),[R,L]=function({controlled:t,default:e,name:n,state:r="value"}){const{current:i}=l.useRef(void 0!==t),[o,s]=l.useState(e);return[i?t:o,l.useCallback((t=>{i||s(t)}),[])]}({controlled:C,default:u,name:"Select"}),k=l.useRef(null),D=l.useRef(null),[N,F]=l.useState(null),{current:B}=l.useRef(null!=w),[z,j]=l.useState(),[U,V]=l.useState(!1),G=Og(e,f),Z=l.useCallback((t=>{D.current=t,t&&F(t)}),[]);l.useImperativeHandle(G,(()=>({focus:()=>{D.current.focus()},node:k.current,value:R})),[R]),l.useEffect((()=>{i&&D.current.focus()}),[i]),l.useEffect((()=>{const t=Km(D.current).getElementById(d);if(t){const e=()=>{getSelection().isCollapsed&&D.current.focus()};return t.addEventListener("click",e),()=>{t.removeEventListener("click",e)}}}),[d]);const q=(t,e)=>{t?x&&x(e):v&&v(e),B||(j(o?null:N.clientWidth),V(t))},W=l.Children.toArray(s),H=t=>e=>{let n;if(e.currentTarget.hasAttribute("tabindex")){if(m){n=Array.isArray(R)?R.slice():[];const e=R.indexOf(t.props.value);-1===e?n.push(t.props.value):n.splice(e,1)}else n=t.props.value;if(t.props.onClick&&t.props.onClick(e),R!==n&&(L(n),_)){const r=e.nativeEvent||e,i=new r.constructor(r.type,r);Object.defineProperty(i,"target",{writable:!0,value:{value:n,name:A}}),_(i,t)}m||q(!1,e)}},X=null!==N&&(B?w:U);let $,Y;delete O["aria-invalid"];const Q=[];let K=!1,J=!1;($g({value:R})||h)&&(T?$=T(R):K=!0);const tt=W.map((t=>{if(!l.isValidElement(t))return null;let e;if(m){if(!Array.isArray(R))throw new Error(kc(2));e=R.some((e=>Vy(e,t.props.value))),e&&K&&Q.push(t.props.children)}else e=Vy(R,t.props.value),e&&K&&(Y=t.props.children);return e&&(J=!0),l.cloneElement(t,{"aria-selected":e?"true":void 0,onClick:H(t),onKeyUp:e=>{" "===e.key&&e.preventDefault(),t.props.onKeyUp&&t.props.onKeyUp(e)},role:"option",selected:e,value:void 0,"data-value":t.props.value})}));K&&($=m?Q.join(", "):Y);let et,nt=z;!o&&B&&N&&(nt=N.clientWidth),et=void 0!==M?M:c?null:0;const rt=P.id||(A?`mui-component-select-${A}`:void 0),it=E({},t,{variant:I,value:R,open:X}),ot=(t=>{const{classes:e,variant:n,disabled:r,open:i}=t;return Lf({select:["select",n,r&&"disabled"],icon:["icon",`icon${Ag(n)}`,i&&"iconOpen",r&&"disabled"],nativeInput:["nativeInput"]},Ny,e)})(it);return(0,cp.jsxs)(l.Fragment,{children:[(0,cp.jsx)(zy,E({ref:Z,tabIndex:et,role:"button","aria-disabled":c?"true":void 0,"aria-expanded":X?"true":"false","aria-haspopup":"listbox","aria-label":r,"aria-labelledby":[d,rt].filter(Boolean).join(" ")||void 0,"aria-describedby":n,onKeyDown:t=>{S||-1!==[" ","ArrowUp","ArrowDown","Enter"].indexOf(t.key)&&(t.preventDefault(),q(!0,t))},onMouseDown:c||S?null:t=>{0===t.button&&(t.preventDefault(),D.current.focus(),q(!0,t))},onBlur:t=>{!X&&y&&(Object.defineProperty(t,"target",{writable:!0,value:{value:R,name:A}}),y(t))},onFocus:b},P,{ownerState:it,className:Rf(ot.select,a,P.className),id:rt,children:Gy($)?(0,cp.jsx)("span",{className:"notranslate",dangerouslySetInnerHTML:{__html:"&#8203;"}}):$})),(0,cp.jsx)(Uy,E({value:Array.isArray(R)?R.join(","):R,name:A,ref:k,"aria-hidden":!0,onChange:t=>{const e=W.map((t=>t.props.value)).indexOf(t.target.value);if(-1===e)return;const n=W[e];L(n.props.value),_&&_(t,n)},tabIndex:-1,disabled:c,className:ot.nativeInput,autoFocus:i,ownerState:it},O)),(0,cp.jsx)(jy,{as:p,className:ot.icon,ownerState:it}),(0,cp.jsx)(Py,E({id:`menu-${A||""}`,anchorEl:N,open:X,onClose:t=>{q(!1,t)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},g,{MenuListProps:E({"aria-labelledby":d,role:"listbox",disableListWrap:!0},g.MenuListProps),PaperProps:E({},g.PaperProps,{style:E({minWidth:nt},null!=g.PaperProps?g.PaperProps.style:null)}),children:tt}))]})})),qy=Zy;function Wy(t){return Qd("MuiSvgIcon",t)}Kd("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const Hy=["children","className","color","component","fontSize","htmlColor","titleAccess","viewBox"],Xy=Xd("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,"inherit"!==n.color&&e[`color${Ag(n.color)}`],e[`fontSize${Ag(n.fontSize)}`]]}})((({theme:t,ownerState:e})=>{var n,r;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:"currentColor",flexShrink:0,transition:t.transitions.create("fill",{duration:t.transitions.duration.shorter}),fontSize:{inherit:"inherit",small:t.typography.pxToRem(20),medium:t.typography.pxToRem(24),large:t.typography.pxToRem(35)}[e.fontSize],color:null!=(n=null==(r=t.palette[e.color])?void 0:r.main)?n:{action:t.palette.action.active,disabled:t.palette.action.disabled,inherit:void 0}[e.color]}})),$y=l.forwardRef((function(t,e){const n=$d({props:t,name:"MuiSvgIcon"}),{children:r,className:i,color:o="inherit",component:s="svg",fontSize:a="medium",htmlColor:l,titleAccess:u,viewBox:c="0 0 24 24"}=n,h=Ne(n,Hy),p=E({},n,{color:o,component:s,fontSize:a,viewBox:c}),f=(t=>{const{color:e,fontSize:n,classes:r}=t;return Lf({root:["root","inherit"!==e&&`color${Ag(e)}`,`fontSize${Ag(n)}`]},Wy,r)})(p);return(0,cp.jsxs)(Xy,E({as:s,className:Rf(f.root,i),ownerState:p,focusable:"false",viewBox:c,color:l,"aria-hidden":!u||void 0,role:u?"img":void 0,ref:e},h,{children:[r,u?(0,cp.jsx)("title",{children:u}):null]}))}));$y.muiName="SvgIcon";const Yy=$y,Qy=function(t,e){const n=(e,n)=>(0,cp.jsx)(Yy,E({"data-testid":"ArrowDropDownIcon",ref:n},e,{children:t}));return n.muiName=Yy.muiName,l.memo(l.forwardRef(n))}((0,cp.jsx)("path",{d:"M7 10l5 5 5-5z"}));var Ky,Jy;const t_=["autoWidth","children","classes","className","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],e_=["root"],n_=l.forwardRef((function(t,e){const n=$d({name:"MuiSelect",props:t}),{autoWidth:r=!1,children:i,classes:o={},className:s,displayEmpty:a=!1,IconComponent:u=Qy,id:c,input:h,inputProps:p,label:f,labelId:d,MenuProps:g,multiple:m=!1,native:A=!1,onClose:y,onOpen:_,open:v,renderValue:b,SelectDisplayProps:x,variant:w="outlined"}=n,S=Ne(n,t_),T=A?Dy:qy,P=Sg({props:n,muiFormControl:Pg(),states:["variant"]}).variant||w,M=h||{standard:Ky||(Ky=(0,cp.jsx)(pm,{})),outlined:(0,cp.jsx)(Im,{label:f}),filled:Jy||(Jy=(0,cp.jsx)(_m,{}))}[P],C=(t=>{const{classes:e}=t;return Lf({root:["root"]},Ny,e)})(E({},n,{classes:o})),I=Ne(o,e_),O=Og(e,M.ref);return l.cloneElement(M,E({inputComponent:T,inputProps:E({children:i,IconComponent:u,variant:P,type:void 0,multiple:m},A?{id:c}:{autoWidth:r,displayEmpty:a,labelId:d,MenuProps:g,onClose:y,onOpen:_,open:v,renderValue:b,SelectDisplayProps:E({id:c},x)},p,{classes:p?Mc(I,p.classes):I},h?h.props.inputProps:{})},m&&A&&"outlined"===P?{notched:!0}:{},{ref:O,className:Rf(C.root,M.props.className,s)},S))}));n_.muiName="Select";const r_=n_;function i_(t){return Qd("MuiTextField",t)}Kd("MuiTextField",["root"]);const o_=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","type","value","variant"],s_={standard:pm,filled:_m,outlined:Im},a_=Xd(Wm,{name:"MuiTextField",slot:"Root",overridesResolver:(t,e)=>e.root})({}),l_=l.forwardRef((function(t,e){const n=$d({props:t,name:"MuiTextField"}),{autoComplete:r,autoFocus:i=!1,children:o,className:s,color:a="primary",defaultValue:u,disabled:c=!1,error:h=!1,FormHelperTextProps:p,fullWidth:f=!1,helperText:d,id:g,InputLabelProps:m,inputProps:A,InputProps:y,inputRef:_,label:v,maxRows:b,minRows:x,multiline:w=!1,name:S,onBlur:T,onChange:P,onFocus:M,placeholder:C,required:I=!1,rows:O,select:R=!1,SelectProps:L,type:k,value:D,variant:N="outlined"}=n,F=Ne(n,o_),B=E({},n,{autoFocus:i,color:a,disabled:c,error:h,fullWidth:f,multiline:w,required:I,select:R,variant:N}),z=(t=>{const{classes:e}=t;return Lf({root:["root"]},i_,e)})(B),j={};if("outlined"===N&&(m&&void 0!==m.shrink&&(j.notched=m.shrink),v)){var U;const t=null!=(U=null==m?void 0:m.required)?U:I;j.label=(0,cp.jsxs)(l.Fragment,{children:[v,t&&"*"]})}R&&(L&&L.native||(j.id=void 0),j["aria-describedby"]=void 0);const V=d&&g?`${g}-helper-text`:void 0,G=v&&g?`${g}-label`:void 0,Z=s_[N],q=(0,cp.jsx)(Z,E({"aria-describedby":V,autoComplete:r,autoFocus:i,defaultValue:u,fullWidth:f,multiline:w,name:S,rows:O,maxRows:b,minRows:x,type:k,value:D,id:g,inputRef:_,onBlur:T,onChange:P,onFocus:M,placeholder:C,inputProps:A},j,y));return(0,cp.jsxs)(a_,E({className:Rf(z.root,s),disabled:c,error:h,fullWidth:f,ref:e,required:I,color:a,variant:N,ownerState:B},F,{children:[v&&(0,cp.jsx)(jm,E({htmlFor:g,id:G},m,{children:v})),R?(0,cp.jsx)(r_,E({"aria-describedby":V,id:g,labelId:G,value:D,input:q},L,{children:o})):q,d&&(0,cp.jsx)(Qm,E({id:V},p,{children:d}))]}))})),u_=(0,l.memo)((t=>{const{geojson:e}=t;if(!e)return null;const n=e.features.length>0?JSON.stringify(e,null,"\t"):"";return l.createElement(ag,{variant:"outlined",sx:{width:300,height:206,marginBottom:1}},l.createElement(mg,null,l.createElement(wg,{sx:{fontSize:14},color:"text.secondary",gutterBottom:!0},"GeoJSON"),l.createElement(l_,{sx:{width:"100%",height:"200px"},rows:5,placeholder:"GeoJOSN",multiline:!0,value:n})))})),c_=IA;let h_=!0,p_=!1,f_=null;const d_={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function g_(t){t.metaKey||t.altKey||t.ctrlKey||(h_=!0)}function m_(){h_=!1}function A_(){"hidden"===this.visibilityState&&p_&&(h_=!0)}const y_=function(){const t=l.useCallback((t=>{var e;null!=t&&((e=t.ownerDocument).addEventListener("keydown",g_,!0),e.addEventListener("mousedown",m_,!0),e.addEventListener("pointerdown",m_,!0),e.addEventListener("touchstart",m_,!0),e.addEventListener("visibilitychange",A_,!0))}),[]),e=l.useRef(!1);return{isFocusVisibleRef:e,onFocus:function(t){return!!function(t){const{target:e}=t;try{return e.matches(":focus-visible")}catch(t){}return h_||function(t){const{type:e,tagName:n}=t;return!("INPUT"!==n||!d_[e]||t.readOnly)||"TEXTAREA"===n&&!t.readOnly||!!t.isContentEditable}(e)}(t)&&(e.current=!0,!0)},onBlur:function(){return!!e.current&&(p_=!0,window.clearTimeout(f_),f_=window.setTimeout((()=>{p_=!1}),100),e.current=!1,!0)},ref:t}};function __(t,e){var n=Object.create(null);return t&&l.Children.map(t,(function(t){return t})).forEach((function(t){n[t.key]=function(t){return e&&(0,l.isValidElement)(t)?e(t):t}(t)})),n}function v_(t,e,n){return null!=n[e]?n[e]:t.props[e]}function b_(t,e,n){var r=__(t.children),i=function(t,e){function n(n){return n in e?e[n]:t[n]}t=t||{},e=e||{};var r,i=Object.create(null),o=[];for(var s in t)s in e?o.length&&(i[s]=o,o=[]):o.push(s);var a={};for(var l in e){if(i[l])for(r=0;r<i[l].length;r++){var u=i[l][r];a[i[l][r]]=n(u)}a[l]=n(l)}for(r=0;r<o.length;r++)a[o[r]]=n(o[r]);return a}(e,r);return Object.keys(i).forEach((function(o){var s=i[o];if((0,l.isValidElement)(s)){var a=o in e,u=o in r,c=e[o],h=(0,l.isValidElement)(c)&&!c.props.in;!u||a&&!h?u||!a||h?u&&a&&(0,l.isValidElement)(c)&&(i[o]=(0,l.cloneElement)(s,{onExited:n.bind(null,s),in:c.props.in,exit:v_(s,"exit",t),enter:v_(s,"enter",t)})):i[o]=(0,l.cloneElement)(s,{in:!1}):i[o]=(0,l.cloneElement)(s,{onExited:n.bind(null,s),in:!0,exit:v_(s,"exit",t),enter:v_(s,"enter",t)})}})),i}var x_=Object.values||function(t){return Object.keys(t).map((function(e){return t[e]}))},w_=function(t){function e(e,n){var r,i=(r=t.call(this,e,n)||this).handleExited.bind(Vt(r));return r.state={contextValue:{isMounting:!0},handleExited:i,firstRender:!0},r}fA(e,t);var n=e.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(t,e){var n,r,i=e.children,o=e.handleExited;return{children:e.firstRender?(n=t,r=o,__(n.children,(function(t){return(0,l.cloneElement)(t,{onExited:r.bind(null,t),in:!0,appear:v_(t,"appear",n),enter:v_(t,"enter",n),exit:v_(t,"exit",n)})}))):b_(t,i,o),firstRender:!1}},n.handleExited=function(t,e){var n=__(this.props.children);t.key in n||(t.props.onExited&&t.props.onExited(e),this.mounted&&this.setState((function(e){var n=E({},e.children);return delete n[t.key],{children:n}})))},n.render=function(){var t=this.props,e=t.component,n=t.childFactory,r=Ne(t,["component","childFactory"]),i=this.state.contextValue,o=x_(this.state.children).map(n);return delete r.appear,delete r.enter,delete r.exit,null===e?l.createElement(dA.Provider,{value:i},o):l.createElement(dA.Provider,{value:i},l.createElement(e,r,o))},e}(l.Component);w_.propTypes={},w_.defaultProps={component:"div",childFactory:function(t){return t}};const E_=w_,S_=Kd("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),T_=["center","classes","className"];let P_,M_,C_,I_,O_=t=>t;const R_=qg(P_||(P_=O_`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),L_=qg(M_||(M_=O_`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),k_=qg(C_||(C_=O_`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),D_=Xd("span",{name:"MuiTouchRipple",slot:"Root",skipSx:!0})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),N_=Xd((function(t){const{className:e,classes:n,pulsate:r=!1,rippleX:i,rippleY:o,rippleSize:s,in:a,onExited:u,timeout:c}=t,[h,p]=l.useState(!1),f=Rf(e,n.ripple,n.rippleVisible,r&&n.ripplePulsate),d={width:s,height:s,top:-s/2+o,left:-s/2+i},g=Rf(n.child,h&&n.childLeaving,r&&n.childPulsate);return a||h||p(!0),l.useEffect((()=>{if(!a&&null!=u){const t=setTimeout(u,c);return()=>{clearTimeout(t)}}}),[u,a,c]),(0,cp.jsx)("span",{className:f,style:d,children:(0,cp.jsx)("span",{className:g})})}),{name:"MuiTouchRipple",slot:"Ripple"})(I_||(I_=O_`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),S_.rippleVisible,R_,550,(({theme:t})=>t.transitions.easing.easeInOut),S_.ripplePulsate,(({theme:t})=>t.transitions.duration.shorter),S_.child,S_.childLeaving,L_,550,(({theme:t})=>t.transitions.easing.easeInOut),S_.childPulsate,k_,(({theme:t})=>t.transitions.easing.easeInOut)),F_=l.forwardRef((function(t,e){const n=$d({props:t,name:"MuiTouchRipple"}),{center:r=!1,classes:i={},className:o}=n,s=Ne(n,T_),[a,u]=l.useState([]),c=l.useRef(0),h=l.useRef(null);l.useEffect((()=>{h.current&&(h.current(),h.current=null)}),[a]);const p=l.useRef(!1),f=l.useRef(null),d=l.useRef(null),g=l.useRef(null);l.useEffect((()=>()=>{clearTimeout(f.current)}),[]);const m=l.useCallback((t=>{const{pulsate:e,rippleX:n,rippleY:r,rippleSize:o,cb:s}=t;u((t=>[...t,(0,cp.jsx)(N_,{classes:{ripple:Rf(i.ripple,S_.ripple),rippleVisible:Rf(i.rippleVisible,S_.rippleVisible),ripplePulsate:Rf(i.ripplePulsate,S_.ripplePulsate),child:Rf(i.child,S_.child),childLeaving:Rf(i.childLeaving,S_.childLeaving),childPulsate:Rf(i.childPulsate,S_.childPulsate)},timeout:550,pulsate:e,rippleX:n,rippleY:r,rippleSize:o},c.current)])),c.current+=1,h.current=s}),[i]),A=l.useCallback(((t={},e={},n)=>{const{pulsate:i=!1,center:o=r||e.pulsate,fakeElement:s=!1}=e;if("mousedown"===t.type&&p.current)return void(p.current=!1);"touchstart"===t.type&&(p.current=!0);const a=s?null:g.current,l=a?a.getBoundingClientRect():{width:0,height:0,left:0,top:0};let u,c,h;if(o||0===t.clientX&&0===t.clientY||!t.clientX&&!t.touches)u=Math.round(l.width/2),c=Math.round(l.height/2);else{const{clientX:e,clientY:n}=t.touches?t.touches[0]:t;u=Math.round(e-l.left),c=Math.round(n-l.top)}if(o)h=Math.sqrt((2*l.width**2+l.height**2)/3),h%2==0&&(h+=1);else{const t=2*Math.max(Math.abs((a?a.clientWidth:0)-u),u)+2,e=2*Math.max(Math.abs((a?a.clientHeight:0)-c),c)+2;h=Math.sqrt(t**2+e**2)}t.touches?null===d.current&&(d.current=()=>{m({pulsate:i,rippleX:u,rippleY:c,rippleSize:h,cb:n})},f.current=setTimeout((()=>{d.current&&(d.current(),d.current=null)}),80)):m({pulsate:i,rippleX:u,rippleY:c,rippleSize:h,cb:n})}),[r,m]),y=l.useCallback((()=>{A({},{pulsate:!0})}),[A]),_=l.useCallback(((t,e)=>{if(clearTimeout(f.current),"touchend"===t.type&&d.current)return d.current(),d.current=null,void(f.current=setTimeout((()=>{_(t,e)})));d.current=null,u((t=>t.length>0?t.slice(1):t)),h.current=e}),[]);return l.useImperativeHandle(e,(()=>({pulsate:y,start:A,stop:_})),[y,A,_]),(0,cp.jsx)(D_,E({className:Rf(i.root,S_.root,o),ref:g},s,{children:(0,cp.jsx)(E_,{component:null,exit:!0,children:a})}))})),B_=F_;function z_(t){return Qd("MuiButtonBase",t)}const j_=Kd("MuiButtonBase",["root","disabled","focusVisible"]),U_=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","type"],V_=Xd("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(t,e)=>e.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${j_.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),G_=l.forwardRef((function(t,e){const n=$d({props:t,name:"MuiButtonBase"}),{action:r,centerRipple:i=!1,children:o,className:s,component:a="button",disabled:u=!1,disableRipple:c=!1,disableTouchRipple:h=!1,focusRipple:p=!1,LinkComponent:f="a",onBlur:d,onClick:g,onContextMenu:m,onDragLeave:A,onFocus:y,onFocusVisible:_,onKeyDown:v,onKeyUp:b,onMouseDown:x,onMouseLeave:w,onMouseUp:S,onTouchEnd:T,onTouchMove:P,onTouchStart:M,tabIndex:C=0,TouchRippleProps:I,type:O}=n,R=Ne(n,U_),L=l.useRef(null),k=l.useRef(null),{isFocusVisibleRef:D,onFocus:N,onBlur:F,ref:B}=y_(),[z,j]=l.useState(!1);function U(t,e,n=h){return c_((r=>(e&&e(r),!n&&k.current&&k.current[t](r),!0)))}u&&z&&j(!1),l.useImperativeHandle(r,(()=>({focusVisible:()=>{j(!0),L.current.focus()}})),[]),l.useEffect((()=>{z&&p&&!c&&k.current.pulsate()}),[c,p,z]);const V=U("start",x),G=U("stop",m),Z=U("stop",A),q=U("stop",S),W=U("stop",(t=>{z&&t.preventDefault(),w&&w(t)})),H=U("start",M),X=U("stop",T),$=U("stop",P),Y=U("stop",(t=>{F(t),!1===D.current&&j(!1),d&&d(t)}),!1),Q=c_((t=>{L.current||(L.current=t.currentTarget),N(t),!0===D.current&&(j(!0),_&&_(t)),y&&y(t)})),K=()=>{const t=L.current;return a&&"button"!==a&&!("A"===t.tagName&&t.href)},J=l.useRef(!1),tt=c_((t=>{p&&!J.current&&z&&k.current&&" "===t.key&&(J.current=!0,k.current.stop(t,(()=>{k.current.start(t)}))),t.target===t.currentTarget&&K()&&" "===t.key&&t.preventDefault(),v&&v(t),t.target===t.currentTarget&&K()&&"Enter"===t.key&&!u&&(t.preventDefault(),g&&g(t))})),et=c_((t=>{p&&" "===t.key&&k.current&&z&&!t.defaultPrevented&&(J.current=!1,k.current.stop(t,(()=>{k.current.pulsate(t)}))),b&&b(t),g&&t.target===t.currentTarget&&K()&&" "===t.key&&!t.defaultPrevented&&g(t)}));let nt=a;"button"===nt&&(R.href||R.to)&&(nt=f);const rt={};"button"===nt?(rt.type=void 0===O?"button":O,rt.disabled=u):(R.href||R.to||(rt.role="button"),u&&(rt["aria-disabled"]=u));const it=Og(B,L),ot=Og(e,it),[st,at]=l.useState(!1);l.useEffect((()=>{at(!0)}),[]);const lt=st&&!c&&!u,ut=E({},n,{centerRipple:i,component:a,disabled:u,disableRipple:c,disableTouchRipple:h,focusRipple:p,tabIndex:C,focusVisible:z}),ct=(t=>{const{disabled:e,focusVisible:n,focusVisibleClassName:r,classes:i}=t,o=Lf({root:["root",e&&"disabled",n&&"focusVisible"]},z_,i);return n&&r&&(o.root+=` ${r}`),o})(ut);return(0,cp.jsxs)(V_,E({as:nt,className:Rf(ct.root,s),ownerState:ut,onBlur:Y,onClick:g,onContextMenu:G,onFocus:Q,onKeyDown:tt,onKeyUp:et,onMouseDown:V,onMouseLeave:W,onMouseUp:q,onDragLeave:Z,onTouchEnd:X,onTouchMove:$,onTouchStart:H,ref:ot,tabIndex:u?-1:C,type:O},rt,R,{children:[o,lt?(0,cp.jsx)(B_,E({ref:k,center:i},I)):null]}))})),Z_=G_,q_=Kd("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),W_=Kd("MuiListItemIcon",["root","alignItemsFlexStart"]),H_=Kd("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]);function X_(t){return Qd("MuiMenuItem",t)}const $_=Kd("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),Y_=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex"],Q_=Xd(Z_,{shouldForwardProp:t=>qd(t)||"classes"===t,name:"MuiMenuItem",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.dense&&e.dense,n.divider&&e.divider,!n.disableGutters&&e.gutters]}})((({theme:t,ownerState:e})=>E({},t.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!e.disableGutters&&{paddingLeft:16,paddingRight:16},e.divider&&{borderBottom:`1px solid ${t.palette.divider}`,backgroundClip:"padding-box"},{"&:hover":{textDecoration:"none",backgroundColor:t.palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${$_.selected}`]:{backgroundColor:ah(t.palette.primary.main,t.palette.action.selectedOpacity),[`&.${$_.focusVisible}`]:{backgroundColor:ah(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},[`&.${$_.selected}:hover`]:{backgroundColor:ah(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:ah(t.palette.primary.main,t.palette.action.selectedOpacity)}},[`&.${$_.focusVisible}`]:{backgroundColor:t.palette.action.focus},[`&.${$_.disabled}`]:{opacity:t.palette.action.disabledOpacity},[`& + .${q_.root}`]:{marginTop:t.spacing(1),marginBottom:t.spacing(1)},[`& + .${q_.inset}`]:{marginLeft:52},[`& .${H_.root}`]:{marginTop:0,marginBottom:0},[`& .${H_.inset}`]:{paddingLeft:36},[`& .${W_.root}`]:{minWidth:36}},!e.dense&&{[t.breakpoints.up("sm")]:{minHeight:"auto"}},e.dense&&E({minHeight:36},t.typography.body2,{[`& .${W_.root} svg`]:{fontSize:"1.25rem"}})))),K_=l.forwardRef((function(t,e){const n=$d({props:t,name:"MuiMenuItem"}),{autoFocus:r=!1,component:i="li",dense:o=!1,divider:s=!1,disableGutters:a=!1,focusVisibleClassName:u,role:c="menuitem",tabIndex:h}=n,p=Ne(n,Y_),f=l.useContext(Jm),d={dense:o||f.dense||!1,disableGutters:a},g=l.useRef(null);Lg((()=>{r&&g.current&&g.current.focus()}),[r]);const m=E({},n,{dense:d.dense,divider:s,disableGutters:a}),A=(t=>{const{disabled:e,dense:n,divider:r,disableGutters:i,selected:o,classes:s}=t;return E({},s,Lf({root:["root",n&&"dense",e&&"disabled",!i&&"gutters",r&&"divider",o&&"selected"]},X_,s))})(n),y=Og(g,e);let _;return n.disabled||(_=void 0!==h?h:-1),(0,cp.jsx)(Jm.Provider,{value:d,children:(0,cp.jsx)(Q_,E({ref:y,role:c,tabIndex:_,component:i,focusVisibleClassName:Rf(A.focusVisible,u)},p,{ownerState:m,classes:A}))})})),J_=(0,l.memo)((t=>{const{Selectors:e,value:n,setValue:r}=t;return l.createElement(mg,null,l.createElement(wg,{sx:{fontSize:14},color:"text.secondary",gutterBottom:!0},"Select Grid Type"),l.createElement(Wm,{sx:{},variant:"filled"},l.createElement(r_,{value:n,onChange:t=>{r(t.target.value)}},e.map((t=>l.createElement(K_,{key:t.label,value:t.value},t.label))))))})),tv=(0,l.memo)((t=>{const{defaultValue:e,setValue:n}=t;return l.createElement(mg,null,l.createElement(wg,{sx:{fontSize:14},color:"text.secondary",gutterBottom:!0},"CellSize"),l.createElement(Wm,{sx:{width:"10ch"},variant:"filled"},l.createElement(l_,{variant:"filled",id:"outlined-number",type:"number",label:"km",defaultValue:e,inputProps:{min:"0.1",max:"100",step:"0.1"},InputLabelProps:{shrink:!0},onChange:t=>{n(t.target.value)}})))}));var ev=n(1688);const nv=[];function rv(t){const{editGeojson:e,setEditGeojson:n}=t;return new ev.nk({id:"edit-layer",data:e,filled:!1,stroked:!1,mode:ev.By,selectedFeatureIndexes:nv,onEdit:t=>{const{updatedData:e}=t;e.features.length>1&&(e.features=[e.features[1]]),n((t=>e))}})}var iv=n(9026);function ov(t){const{gridGeojson:e,gridCellSize:n}=t;return new iv.Z({id:"geojson-layer",data:e,pickable:!0,stroked:!0,filled:!0,extruded:!1,pointType:"circle",lineWidthScale:1,lineWidthMinPixels:1,pointRadiusScale:40,getPointRadius:10*n,getFillColor:[160,160,180,200],getLineColor:[0,0,0,255],getLineWidth:1})}const sv=sp({palette:{mode:"dark"}}),av={latitude:35.73202612464274,longitude:137.53268402693763,zoom:7.5,minZoom:6},lv=[{label:"pointGrid",value:"pointGrid"},{label:"squareGrid",value:"squareGrid"},{label:"hexGrid",value:"hexGrid"},{label:"triangleGrid",value:"triangleGrid"}],uv=function({data:t}){const[e,n]=(0,l.useState)(av),[r,i]=(0,l.useState)({type:"FeatureCollection",features:[]}),[o,s]=(0,l.useState)({type:"FeatureCollection",features:[]}),[u,c]=(0,l.useState)("pointGrid"),[h,p]=(0,l.useState)(5);return(0,l.useEffect)((()=>{const t=Nr(r),e=a[u](t,h);s((()=>e))}),[r,u,h]),l.createElement("div",null,l.createElement(w,{initialViewState:e,controller:!0,layers:[rv({editGeojson:r,setEditGeojson:i}),ov({gridGeojson:o,gridCellSize:h})]},l.createElement(zt,{mapStyle:"mapbox://styles/shimizu/cjophihsq4qye2snwwz0i2pfa",mapboxApiAccessToken:"pk.eyJ1Ijoic2hpbWl6dSIsImEiOiJjajNsYW5qN2owMDQxMnducnRpdnZ3MW45In0.Sc-wkWbKtTc_wEk7AeuHxw"})),l.createElement(If,{theme:sv},l.createElement(pg,{sx:{position:"absolute",top:20,left:10}},l.createElement(ag,{sx:{display:"flex",width:"100%"},variant:"outlined"},l.createElement(J_,{Selectors:lv,value:u,setValue:c}),l.createElement(tv,{defaultValue:h,setValue:p}))),l.createElement(pg,{sx:{position:"absolute",bottom:20,right:10}},l.createElement(u_,{geojson:o}))))};var cv=n(3379),hv=n.n(cv),pv=n(7795),fv=n.n(pv),dv=n(569),gv=n.n(dv),mv=n(3565),Av=n.n(mv),yv=n(9216),_v=n.n(yv),vv=n(4589),bv=n.n(vv),xv=n(4120),wv={};function Ev(){return l.createElement(uv,null)}wv.styleTagTransform=bv(),wv.setAttributes=Av(),wv.insert=gv().bind(null,"head"),wv.domAPI=fv(),wv.insertStyleElement=_v(),hv()(xv.Z,wv),xv.Z&&xv.Z.locals&&xv.Z.locals,u.render(l.createElement(Ev,null),document.getElementById("app"))})()})();
//# sourceMappingURL=app.js.map